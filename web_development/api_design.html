<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Api Design - My Notes</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon-de23e50b.svg">
        <link rel="shortcut icon" href="../favicon-8114d1fc.png">
        <link rel="stylesheet" href="../css/variables-8adf115d.css">
        <link rel="stylesheet" href="../css/general-2459343d.css">
        <link rel="stylesheet" href="../css/chrome-9dfbd86b.css">
        <link rel="stylesheet" href="../css/print-9e4910d8.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../fonts/fonts-9644e21d.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="mdbook-highlight-css" href="../highlight-493f70e1.css">
        <link rel="stylesheet" id="mdbook-tomorrow-night-css" href="../tomorrow-night-4c0ae647.css">
        <link rel="stylesheet" id="mdbook-ayu-highlight-css" href="../ayu-highlight-3fdfc3ac.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../searchindex-ccaedc6f.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc-da6337af.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="mdbook-body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="mdbook-sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("mdbook-sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="mdbook-sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="mdbook-sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="mdbook-page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="mdbook-menu-bar-hover-placeholder"></div>
                <div id="mdbook-menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="mdbook-sidebar-toggle" class="icon-button" for="mdbook-sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="mdbook-sidebar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"/></svg></span>
                        </label>
                        <button id="mdbook-theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="mdbook-theme-list">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M371.3 367.1c27.3-3.9 51.9-19.4 67.2-42.9L600.2 74.1c12.6-19.5 9.4-45.3-7.6-61.2S549.7-4.4 531.1 9.6L294.4 187.2c-24 18-38.2 46.1-38.4 76.1L371.3 367.1zm-19.6 25.4l-116-104.4C175.9 290.3 128 339.6 128 400c0 3.9 .2 7.8 .6 11.6c1.8 17.5-10.2 36.4-27.8 36.4H96c-17.7 0-32 14.3-32 32s14.3 32 32 32H240c61.9 0 112-50.1 112-112c0-2.5-.1-5-.2-7.5z"/></svg></span>
                        </button>
                        <ul id="mdbook-theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-ayu">Ayu</button></li>
                        </ul>
                        <button id="mdbook-search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="mdbook-searchbar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352c79.5 0 144-64.5 144-144s-64.5-144-144-144S64 128.5 64 208s64.5 144 144 144z"/></svg></span>
                        </button>
                    </div>

                    <h1 class="menu-title">My Notes</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <span class=fa-svg id="print-button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M128 0C92.7 0 64 28.7 64 64v96h64V64H354.7L384 93.3V160h64V93.3c0-17-6.7-33.3-18.7-45.3L400 18.7C388 6.7 371.7 0 354.7 0H128zM384 352v32 64H128V384 368 352H384zm64 32h32c17.7 0 32-14.3 32-32V256c0-35.3-28.7-64-64-64H64c-35.3 0-64 28.7-64 64v96c0 17.7 14.3 32 32 32H64v64c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V384zm-16-88c-13.3 0-24-10.7-24-24s10.7-24 24-24s24 10.7 24 24s-10.7 24-24 24z"/></svg></span>
                        </a>

                    </div>
                </div>

                <div id="mdbook-search-wrapper" class="hidden">
                    <form id="mdbook-searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="mdbook-searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="mdbook-searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <span class=fa-svg id="fa-spin"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M304 48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zm0 416c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM48 304c26.5 0 48-21.5 48-48s-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48zm464-48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM142.9 437c18.7-18.7 18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zm0-294.2c18.7-18.7 18.7-49.1 0-67.9S93.7 56.2 75 75s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zM369.1 437c18.7 18.7 49.1 18.7 67.9 0s18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9z"/></svg></span>
                            </div>
                        </div>
                    </form>
                    <div id="mdbook-searchresults-outer" class="searchresults-outer hidden">
                        <div id="mdbook-searchresults-header" class="searchresults-header"></div>
                        <ul id="mdbook-searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('mdbook-sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('mdbook-sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#mdbook-sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="mdbook-content" class="content">
                    <main>
                        <h1 id="api-design-guide"><a class="header" href="#api-design-guide">API Design Guide</a></h1>
<h2 id="table-of-contents"><a class="header" href="#table-of-contents">Table of Contents</a></h2>
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#restful-principles-deep-dive">RESTful Principles Deep Dive</a></li>
<li><a href="#resource-naming-conventions">Resource Naming Conventions</a></li>
<li><a href="#http-methods-usage">HTTP Methods Usage</a></li>
<li><a href="#http-status-codes">HTTP Status Codes</a></li>
<li><a href="#api-versioning-strategies">API Versioning Strategies</a></li>
<li><a href="#pagination-strategies">Pagination Strategies</a></li>
<li><a href="#filtering-and-sorting">Filtering and Sorting</a></li>
<li><a href="#rate-limiting">Rate Limiting</a></li>
<li><a href="#error-handling">Error Handling</a></li>
<li><a href="#authentication-and-authorization">Authentication and Authorization</a></li>
<li><a href="#hateoas-principles">HATEOAS Principles</a></li>
<li><a href="#api-documentation">API Documentation</a></li>
<li><a href="#idempotency">Idempotency</a></li>
<li><a href="#caching-strategies">Caching Strategies</a></li>
<li><a href="#webhooks-vs-polling">Webhooks vs Polling</a></li>
<li><a href="#graphql-vs-rest-trade-offs">GraphQL vs REST Trade-offs</a></li>
<li><a href="#grpc-use-cases">gRPC Use Cases</a></li>
<li><a href="#api-gateway-patterns">API Gateway Patterns</a></li>
<li><a href="#backward-compatibility">Backward Compatibility</a></li>
<li><a href="#deprecation-strategies">Deprecation Strategies</a></li>
<li><a href="#best-practices-summary">Best Practices Summary</a></li>
</ul>
<hr>
<h2 id="introduction"><a class="header" href="#introduction">Introduction</a></h2>
<p>API (Application Programming Interface) design is a critical aspect of modern software development. A well-designed API is intuitive, consistent, maintainable, and provides a great developer experience. This guide covers comprehensive best practices for designing robust, scalable, and user-friendly APIs.</p>
<h3 id="what-makes-a-good-api"><a class="header" href="#what-makes-a-good-api">What Makes a Good API?</a></h3>
<p><strong>1. Intuitive and Consistent</strong></p>
<ul>
<li>Easy to understand and predict</li>
<li>Follows established conventions</li>
<li>Consistent naming and structure</li>
</ul>
<p><strong>2. Well-Documented</strong></p>
<ul>
<li>Clear, comprehensive documentation</li>
<li>Code examples in multiple languages</li>
<li>Interactive API explorers</li>
</ul>
<p><strong>3. Versioned</strong></p>
<ul>
<li>Backward compatible when possible</li>
<li>Clear versioning strategy</li>
<li>Deprecation policies</li>
</ul>
<p><strong>4. Secure</strong></p>
<ul>
<li>Proper authentication and authorization</li>
<li>Rate limiting and abuse prevention</li>
<li>Input validation and sanitization</li>
</ul>
<p><strong>5. Performant</strong></p>
<ul>
<li>Efficient data retrieval</li>
<li>Proper caching mechanisms</li>
<li>Pagination for large datasets</li>
</ul>
<p><strong>6. Developer-Friendly</strong></p>
<ul>
<li>Helpful error messages</li>
<li>Consistent response formats</li>
<li>SDKs and libraries</li>
</ul>
<hr>
<h2 id="restful-principles-deep-dive"><a class="header" href="#restful-principles-deep-dive">RESTful Principles Deep Dive</a></h2>
<p>REST (Representational State Transfer) is an architectural style for designing networked applications. It relies on a stateless, client-server protocol, typically HTTP.</p>
<h3 id="six-constraints-of-rest"><a class="header" href="#six-constraints-of-rest">Six Constraints of REST</a></h3>
<h4 id="1-client-server-architecture"><a class="header" href="#1-client-server-architecture">1. Client-Server Architecture</a></h4>
<p><strong>Principle:</strong> Separation of concerns between client and server.</p>
<pre><code>Client (UI/Presentation)  ←→  Server (Data/Business Logic)
</code></pre>
<p><strong>Benefits:</strong></p>
<ul>
<li>Independent evolution of client and server</li>
<li>Improved scalability through separation</li>
<li>Multiple clients can use the same API</li>
</ul>
<p><strong>Example:</strong></p>
<pre><code class="language-javascript">// Client (React)
const fetchUser = async (userId) =&gt; {
  const response = await fetch(`/api/users/${userId}`);
  return response.json();
};

// Server (Express)
app.get('/api/users/:id', (req, res) =&gt; {
  const user = database.getUser(req.params.id);
  res.json(user);
});
</code></pre>
<h4 id="2-stateless"><a class="header" href="#2-stateless">2. Stateless</a></h4>
<p><strong>Principle:</strong> Each request contains all information needed to understand and process it.</p>
<pre><code>❌ Stateful (Bad):
Request 1: Login user → Server stores session
Request 2: Get profile → Server uses stored session

✅ Stateless (Good):
Request 1: Login → Return token
Request 2: Get profile (with token) → Server validates token
</code></pre>
<p><strong>Implementation:</strong></p>
<pre><code class="language-javascript">// Client includes authentication in every request
const headers = {
  'Authorization': `Bearer ${accessToken}`,
  'Content-Type': 'application/json'
};

fetch('/api/profile', { headers })
  .then(res =&gt; res.json());

// Server validates each request independently
app.get('/api/profile', authenticateToken, (req, res) =&gt; {
  // Each request is self-contained
  const user = getUserFromToken(req.token);
  res.json(user);
});
</code></pre>
<p><strong>Benefits:</strong></p>
<ul>
<li>Scalability: No server-side session storage</li>
<li>Reliability: No session state to lose</li>
<li>Visibility: Complete request information</li>
</ul>
<h4 id="3-cacheable"><a class="header" href="#3-cacheable">3. Cacheable</a></h4>
<p><strong>Principle:</strong> Responses must define themselves as cacheable or non-cacheable.</p>
<pre><code class="language-http">HTTP/1.1 200 OK
Cache-Control: max-age=3600, public
ETag: "33a64df551425fcc55e4d42a148795d9f25f89d4"
Last-Modified: Wed, 15 Nov 2023 12:00:00 GMT

{
  "id": 123,
  "name": "John Doe"
}
</code></pre>
<p><strong>Implementation:</strong></p>
<pre><code class="language-javascript">// Server sets cache headers
app.get('/api/users/:id', (req, res) =&gt; {
  const user = database.getUser(req.params.id);

  // Cache for 1 hour
  res.set('Cache-Control', 'public, max-age=3600');
  res.set('ETag', generateETag(user));
  res.json(user);
});

// Client respects cache headers
const response = await fetch('/api/users/123');
// Browser automatically caches based on headers
</code></pre>
<p><strong>Benefits:</strong></p>
<ul>
<li>Reduced server load</li>
<li>Improved performance</li>
<li>Lower latency</li>
</ul>
<h4 id="4-uniform-interface"><a class="header" href="#4-uniform-interface">4. Uniform Interface</a></h4>
<p><strong>Principle:</strong> Consistent, standardized interface between client and server.</p>
<p><strong>Four Sub-Constraints:</strong></p>
<p><strong>a) Resource Identification</strong></p>
<pre><code>✅ Good: /users/123
✅ Good: /orders/456/items/789
❌ Bad: /getUserById?id=123
</code></pre>
<p><strong>b) Resource Manipulation Through Representations</strong></p>
<pre><code class="language-json">GET /users/123
{
  "id": 123,
  "name": "John Doe",
  "email": "john@example.com"
}

PUT /users/123
{
  "name": "John Smith",
  "email": "john.smith@example.com"
}
</code></pre>
<p><strong>c) Self-Descriptive Messages</strong></p>
<pre><code class="language-http">POST /users HTTP/1.1
Content-Type: application/json
Accept: application/json

{
  "name": "Jane Doe",
  "email": "jane@example.com"
}
</code></pre>
<p><strong>d) HATEOAS (Hypermedia As The Engine Of Application State)</strong></p>
<pre><code class="language-json">{
  "id": 123,
  "name": "John Doe",
  "links": {
    "self": "/users/123",
    "posts": "/users/123/posts",
    "friends": "/users/123/friends"
  }
}
</code></pre>
<h4 id="5-layered-system"><a class="header" href="#5-layered-system">5. Layered System</a></h4>
<p><strong>Principle:</strong> Client cannot tell if connected directly to end server or intermediary.</p>
<pre><code>Client → Load Balancer → API Gateway → Cache Layer → Application Server → Database
</code></pre>
<p><strong>Benefits:</strong></p>
<ul>
<li>Security through encapsulation</li>
<li>Load balancing</li>
<li>Shared caches</li>
<li>Legacy system encapsulation</li>
</ul>
<p><strong>Example:</strong></p>
<pre><code class="language-javascript">// Client doesn't know about intermediary layers
fetch('https://api.example.com/users')
  .then(res =&gt; res.json());

// Request might go through:
// 1. CDN
// 2. Load balancer
// 3. API gateway
// 4. Application server
// 5. Database server
</code></pre>
<h4 id="6-code-on-demand-optional"><a class="header" href="#6-code-on-demand-optional">6. Code on Demand (Optional)</a></h4>
<p><strong>Principle:</strong> Server can extend client functionality by transferring executable code.</p>
<p><strong>Example:</strong></p>
<pre><code class="language-html">&lt;!-- Server sends JavaScript to client --&gt;
&lt;script src="https://api.example.com/widget.js"&gt;&lt;/script&gt;

&lt;!-- Client executes server-provided code --&gt;
&lt;div id="widget"&gt;&lt;/div&gt;
</code></pre>
<p><strong>Note:</strong> This constraint is optional and rarely used in modern API design.</p>
<hr>
<h2 id="resource-naming-conventions"><a class="header" href="#resource-naming-conventions">Resource Naming Conventions</a></h2>
<p>Resource naming is critical for API usability. Good names make APIs intuitive and self-documenting.</p>
<h3 id="general-principles"><a class="header" href="#general-principles">General Principles</a></h3>
<h4 id="1-use-nouns-not-verbs"><a class="header" href="#1-use-nouns-not-verbs">1. Use Nouns, Not Verbs</a></h4>
<pre><code>✅ Good:
GET    /users
POST   /users
GET    /users/123
PUT    /users/123
DELETE /users/123

❌ Bad:
GET    /getUsers
POST   /createUser
GET    /getUserById/123
PUT    /updateUser/123
DELETE /deleteUser/123
</code></pre>
<h4 id="2-use-plural-nouns-for-collections"><a class="header" href="#2-use-plural-nouns-for-collections">2. Use Plural Nouns for Collections</a></h4>
<pre><code>✅ Good:
GET /users          # Collection
GET /users/123      # Single resource
GET /orders         # Collection
GET /orders/456     # Single resource

❌ Bad:
GET /user
GET /user/123
</code></pre>
<p><strong>Reasoning:</strong> Consistency and predictability. Plural form works for both collection and individual resources.</p>
<h4 id="3-use-lowercase-and-hyphens"><a class="header" href="#3-use-lowercase-and-hyphens">3. Use Lowercase and Hyphens</a></h4>
<pre><code>✅ Good:
/user-profiles
/order-items
/api-keys

❌ Bad:
/userProfiles      (camelCase)
/UserProfiles      (PascalCase)
/user_profiles     (snake_case - acceptable but less common)
</code></pre>
<p><strong>Exception:</strong> Some teams prefer snake_case for consistency with backend languages (Python, Ruby).</p>
<h4 id="4-use-forward-slashes-for-hierarchy"><a class="header" href="#4-use-forward-slashes-for-hierarchy">4. Use Forward Slashes for Hierarchy</a></h4>
<pre><code>✅ Good:
/users/123/orders
/users/123/orders/456
/users/123/orders/456/items

Structure represents relationship:
User 123 → Orders → Order 456 → Items
</code></pre>
<h4 id="5-avoid-trailing-slashes"><a class="header" href="#5-avoid-trailing-slashes">5. Avoid Trailing Slashes</a></h4>
<pre><code>✅ Good: /users
❌ Bad:  /users/
</code></pre>
<p><strong>Implementation:</strong></p>
<pre><code class="language-javascript">// Redirect trailing slashes
app.use((req, res, next) =&gt; {
  if (req.path.endsWith('/') &amp;&amp; req.path.length &gt; 1) {
    const query = req.url.slice(req.path.length);
    res.redirect(301, req.path.slice(0, -1) + query);
  } else {
    next();
  }
});
</code></pre>
<h3 id="resource-relationships"><a class="header" href="#resource-relationships">Resource Relationships</a></h3>
<h4 id="1-nested-resources-parent-child"><a class="header" href="#1-nested-resources-parent-child">1. Nested Resources (Parent-Child)</a></h4>
<pre><code>GET /users/123/posts           # Posts belonging to user 123
GET /users/123/posts/456       # Post 456 of user 123
GET /orders/789/items          # Items in order 789
GET /teams/5/members           # Members of team 5
</code></pre>
<p><strong>When to Use:</strong></p>
<ul>
<li>Clear parent-child relationship</li>
<li>Child rarely exists independently</li>
<li>Limited nesting depth (2-3 levels max)</li>
</ul>
<h4 id="2-independent-resources-with-filters"><a class="header" href="#2-independent-resources-with-filters">2. Independent Resources with Filters</a></h4>
<pre><code>GET /posts?userId=123          # Alternative to /users/123/posts
GET /comments?postId=456       # Alternative to /posts/456/comments
GET /items?orderId=789         # Alternative to /orders/789/items
</code></pre>
<p><strong>When to Use:</strong></p>
<ul>
<li>Resource can exist independently</li>
<li>Multiple filtering options needed</li>
<li>Avoiding deep nesting</li>
</ul>
<h4 id="3-many-to-many-relationships"><a class="header" href="#3-many-to-many-relationships">3. Many-to-Many Relationships</a></h4>
<pre><code># Users and teams (many-to-many)
GET /users/123/teams           # Teams for user 123
GET /teams/5/members           # Members of team 5

# Alternative: Membership resource
GET /memberships?userId=123    # Memberships for user 123
GET /memberships?teamId=5      # Memberships in team 5
POST /memberships              # Create membership
{
  "userId": 123,
  "teamId": 5,
  "role": "admin"
}
</code></pre>
<h3 id="special-endpoints"><a class="header" href="#special-endpoints">Special Endpoints</a></h3>
<h4 id="1-actions-that-dont-fit-crud"><a class="header" href="#1-actions-that-dont-fit-crud">1. Actions That Don’t Fit CRUD</a></h4>
<p>When an action doesn’t map to standard CRUD operations, use a verb as a resource:</p>
<pre><code>POST /users/123/activate       # Activate user
POST /orders/456/cancel        # Cancel order
POST /invoices/789/send        # Send invoice
POST /passwords/reset          # Reset password
</code></pre>
<p><strong>Alternative Approach (More RESTful):</strong></p>
<pre><code># Use resource state change
PATCH /users/123
{ "status": "active" }

PATCH /orders/456
{ "status": "cancelled" }

# Use sub-resources
POST /users/123/password-resets
POST /invoices/789/email-deliveries
</code></pre>
<h4 id="2-search-and-complex-queries"><a class="header" href="#2-search-and-complex-queries">2. Search and Complex Queries</a></h4>
<pre><code>GET /search?q=john&amp;type=users
GET /users/search?name=john&amp;age=25
POST /users/search              # Complex search with body
{
  "filters": {
    "age": { "min": 25, "max": 35 },
    "city": "New York",
    "skills": ["JavaScript", "Python"]
  }
}
</code></pre>
<h4 id="3-batch-operations"><a class="header" href="#3-batch-operations">3. Batch Operations</a></h4>
<pre><code>POST /users/batch
{
  "operation": "delete",
  "ids": [1, 2, 3, 4, 5]
}

PATCH /users/bulk-update
{
  "updates": [
    { "id": 1, "status": "active" },
    { "id": 2, "status": "inactive" }
  ]
}
</code></pre>
<h3 id="naming-examples-by-domain"><a class="header" href="#naming-examples-by-domain">Naming Examples by Domain</a></h3>
<h4 id="e-commerce"><a class="header" href="#e-commerce">E-commerce</a></h4>
<pre><code>/products
/products/123
/products/123/reviews
/products/123/images
/categories
/categories/electronics
/categories/electronics/products
/carts
/carts/456/items
/orders
/orders/789
/orders/789/items
/orders/789/shipments
/customers
/customers/123/addresses
/customers/123/payment-methods
</code></pre>
<h4 id="social-media"><a class="header" href="#social-media">Social Media</a></h4>
<pre><code>/users
/users/123
/users/123/posts
/users/123/followers
/users/123/following
/posts
/posts/456
/posts/456/comments
/posts/456/likes
/posts/456/shares
/hashtags
/hashtags/trending
/messages
/conversations
/conversations/789/messages
</code></pre>
<h4 id="project-management"><a class="header" href="#project-management">Project Management</a></h4>
<pre><code>/projects
/projects/123
/projects/123/tasks
/projects/123/members
/tasks
/tasks/456
/tasks/456/comments
/tasks/456/attachments
/teams
/teams/789
/teams/789/projects
/teams/789/members
/milestones
/timesheets
</code></pre>
<hr>
<h2 id="http-methods-usage"><a class="header" href="#http-methods-usage">HTTP Methods Usage</a></h2>
<p>HTTP methods (verbs) define the type of operation to perform on a resource.</p>
<h3 id="standard-crud-operations"><a class="header" href="#standard-crud-operations">Standard CRUD Operations</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Operation</th><th>HTTP Method</th><th>Example</th><th>Idempotent</th><th>Safe</th></tr>
</thead>
<tbody>
<tr><td>Create</td><td>POST</td><td>POST /users</td><td>No</td><td>No</td></tr>
<tr><td>Read</td><td>GET</td><td>GET /users/123</td><td>Yes</td><td>Yes</td></tr>
<tr><td>Update (full)</td><td>PUT</td><td>PUT /users/123</td><td>Yes</td><td>No</td></tr>
<tr><td>Update (partial)</td><td>PATCH</td><td>PATCH /users/123</td><td>No</td><td>No</td></tr>
<tr><td>Delete</td><td>DELETE</td><td>DELETE /users/123</td><td>Yes</td><td>No</td></tr>
</tbody>
</table>
</div>
<p><strong>Idempotent:</strong> Multiple identical requests have the same effect as a single request
<strong>Safe:</strong> Request doesn’t modify server state</p>
<h3 id="get---retrieve-resources"><a class="header" href="#get---retrieve-resources">GET - Retrieve Resources</a></h3>
<p><strong>Purpose:</strong> Retrieve resource representation without side effects.</p>
<p><strong>Characteristics:</strong></p>
<ul>
<li>Safe: Doesn’t modify state</li>
<li>Idempotent: Same result every time</li>
<li>Cacheable: Responses can be cached</li>
</ul>
<pre><code class="language-http">GET /users HTTP/1.1
Host: api.example.com

HTTP/1.1 200 OK
Content-Type: application/json
Cache-Control: max-age=3600

[
  { "id": 1, "name": "John" },
  { "id": 2, "name": "Jane" }
]
</code></pre>
<pre><code class="language-http">GET /users/123 HTTP/1.1
Host: api.example.com

HTTP/1.1 200 OK
Content-Type: application/json

{
  "id": 123,
  "name": "John Doe",
  "email": "john@example.com"
}
</code></pre>
<p><strong>Query Parameters:</strong></p>
<pre><code class="language-http">GET /users?page=2&amp;limit=20&amp;sort=name&amp;filter=active HTTP/1.1
</code></pre>
<p><strong>Implementation:</strong></p>
<pre><code class="language-javascript">// Express.js
app.get('/users', async (req, res) =&gt; {
  const { page = 1, limit = 20, sort, filter } = req.query;

  const users = await database.getUsers({
    page: parseInt(page),
    limit: parseInt(limit),
    sort,
    filter
  });

  res.json(users);
});

app.get('/users/:id', async (req, res) =&gt; {
  const user = await database.getUser(req.params.id);

  if (!user) {
    return res.status(404).json({ error: 'User not found' });
  }

  res.json(user);
});
</code></pre>
<p><strong>Best Practices:</strong></p>
<ul>
<li>Never use GET for operations with side effects</li>
<li>Use query parameters for filtering, sorting, pagination</li>
<li>Support conditional requests (ETag, If-Modified-Since)</li>
<li>Implement proper caching headers</li>
</ul>
<h3 id="post---create-resources"><a class="header" href="#post---create-resources">POST - Create Resources</a></h3>
<p><strong>Purpose:</strong> Create new resources.</p>
<p><strong>Characteristics:</strong></p>
<ul>
<li>Not safe: Modifies state</li>
<li>Not idempotent: Multiple requests create multiple resources</li>
<li>Response often includes Location header</li>
</ul>
<pre><code class="language-http">POST /users HTTP/1.1
Host: api.example.com
Content-Type: application/json

{
  "name": "John Doe",
  "email": "john@example.com"
}

HTTP/1.1 201 Created
Location: /users/123
Content-Type: application/json

{
  "id": 123,
  "name": "John Doe",
  "email": "john@example.com",
  "createdAt": "2023-11-15T10:00:00Z"
}
</code></pre>
<p><strong>Implementation:</strong></p>
<pre><code class="language-javascript">app.post('/users', async (req, res) =&gt; {
  // Validate input
  const errors = validateUser(req.body);
  if (errors.length &gt; 0) {
    return res.status(400).json({ errors });
  }

  // Create user
  const user = await database.createUser(req.body);

  // Return 201 with Location header
  res.status(201)
    .location(`/users/${user.id}`)
    .json(user);
});
</code></pre>
<p><strong>Use Cases:</strong></p>
<ul>
<li>Creating new resources</li>
<li>Submitting forms</li>
<li>Triggering operations</li>
<li>Uploading files</li>
</ul>
<p><strong>POST vs PUT for Creation:</strong></p>
<pre><code>POST /users              → Server generates ID (e.g., /users/123)
PUT /users/john-doe      → Client specifies ID
</code></pre>
<h3 id="put---replace-resources"><a class="header" href="#put---replace-resources">PUT - Replace Resources</a></h3>
<p><strong>Purpose:</strong> Replace entire resource or create if doesn’t exist.</p>
<p><strong>Characteristics:</strong></p>
<ul>
<li>Not safe: Modifies state</li>
<li>Idempotent: Multiple identical requests have same effect</li>
<li>Requires full resource representation</li>
</ul>
<pre><code class="language-http">PUT /users/123 HTTP/1.1
Host: api.example.com
Content-Type: application/json

{
  "name": "John Smith",
  "email": "john.smith@example.com",
  "age": 30,
  "city": "New York"
}

HTTP/1.1 200 OK
Content-Type: application/json

{
  "id": 123,
  "name": "John Smith",
  "email": "john.smith@example.com",
  "age": 30,
  "city": "New York",
  "updatedAt": "2023-11-15T10:00:00Z"
}
</code></pre>
<p><strong>Implementation:</strong></p>
<pre><code class="language-javascript">app.put('/users/:id', async (req, res) =&gt; {
  const { id } = req.params;

  // Validate full resource
  const errors = validateUser(req.body);
  if (errors.length &gt; 0) {
    return res.status(400).json({ errors });
  }

  // Check if resource exists
  const exists = await database.userExists(id);

  // Replace resource
  const user = await database.replaceUser(id, req.body);

  // Return 200 if updated, 201 if created
  res.status(exists ? 200 : 201).json(user);
});
</code></pre>
<p><strong>Important:</strong></p>
<ul>
<li>Client must send complete resource</li>
<li>Missing fields will be removed</li>
<li>Use PATCH for partial updates</li>
</ul>
<h3 id="patch---partial-update"><a class="header" href="#patch---partial-update">PATCH - Partial Update</a></h3>
<p><strong>Purpose:</strong> Partially modify a resource.</p>
<p><strong>Characteristics:</strong></p>
<ul>
<li>Not safe: Modifies state</li>
<li>Not necessarily idempotent (depends on implementation)</li>
<li>Accepts partial representation</li>
</ul>
<pre><code class="language-http">PATCH /users/123 HTTP/1.1
Host: api.example.com
Content-Type: application/json

{
  "email": "new.email@example.com"
}

HTTP/1.1 200 OK
Content-Type: application/json

{
  "id": 123,
  "name": "John Doe",
  "email": "new.email@example.com",
  "age": 30,
  "city": "New York",
  "updatedAt": "2023-11-15T10:00:00Z"
}
</code></pre>
<p><strong>JSON Patch (RFC 6902):</strong></p>
<pre><code class="language-http">PATCH /users/123 HTTP/1.1
Content-Type: application/json-patch+json

[
  { "op": "replace", "path": "/email", "value": "new@example.com" },
  { "op": "add", "path": "/phone", "value": "+1234567890" },
  { "op": "remove", "path": "/age" }
]
</code></pre>
<p><strong>Implementation:</strong></p>
<pre><code class="language-javascript">app.patch('/users/:id', async (req, res) =&gt; {
  const { id } = req.params;

  // Check if user exists
  const user = await database.getUser(id);
  if (!user) {
    return res.status(404).json({ error: 'User not found' });
  }

  // Validate partial update
  const errors = validatePartialUser(req.body);
  if (errors.length &gt; 0) {
    return res.status(400).json({ errors });
  }

  // Update specific fields
  const updatedUser = await database.updateUser(id, req.body);

  res.json(updatedUser);
});
</code></pre>
<p><strong>PATCH vs PUT:</strong></p>
<pre><code>PUT /users/123          → Must send complete resource
PATCH /users/123        → Send only fields to update
</code></pre>
<h3 id="delete---remove-resources"><a class="header" href="#delete---remove-resources">DELETE - Remove Resources</a></h3>
<p><strong>Purpose:</strong> Delete a resource.</p>
<p><strong>Characteristics:</strong></p>
<ul>
<li>Not safe: Modifies state</li>
<li>Idempotent: Deleting same resource multiple times has same effect</li>
<li>May return 204 No Content or 200 OK with body</li>
</ul>
<pre><code class="language-http">DELETE /users/123 HTTP/1.1
Host: api.example.com

HTTP/1.1 204 No Content
</code></pre>
<p><strong>With Response Body:</strong></p>
<pre><code class="language-http">DELETE /users/123 HTTP/1.1

HTTP/1.1 200 OK
Content-Type: application/json

{
  "message": "User deleted successfully",
  "deletedAt": "2023-11-15T10:00:00Z"
}
</code></pre>
<p><strong>Implementation:</strong></p>
<pre><code class="language-javascript">app.delete('/users/:id', async (req, res) =&gt; {
  const { id } = req.params;

  // Check if user exists
  const user = await database.getUser(id);
  if (!user) {
    return res.status(404).json({ error: 'User not found' });
  }

  // Delete user
  await database.deleteUser(id);

  // Return 204 No Content or 200 with message
  res.status(204).send();
  // OR
  // res.status(200).json({ message: 'User deleted' });
});
</code></pre>
<p><strong>Soft Delete:</strong></p>
<pre><code class="language-javascript">app.delete('/users/:id', async (req, res) =&gt; {
  await database.updateUser(id, {
    deletedAt: new Date(),
    status: 'deleted'
  });

  res.status(204).send();
});
</code></pre>
<h3 id="other-http-methods"><a class="header" href="#other-http-methods">Other HTTP Methods</a></h3>
<h4 id="head---retrieve-headers-only"><a class="header" href="#head---retrieve-headers-only">HEAD - Retrieve Headers Only</a></h4>
<pre><code class="language-http">HEAD /users/123 HTTP/1.1

HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 256
Last-Modified: Wed, 15 Nov 2023 10:00:00 GMT
</code></pre>
<p><strong>Use Cases:</strong></p>
<ul>
<li>Check if resource exists</li>
<li>Get metadata without downloading body</li>
<li>Verify cache freshness</li>
</ul>
<h4 id="options---describe-communication-options"><a class="header" href="#options---describe-communication-options">OPTIONS - Describe Communication Options</a></h4>
<pre><code class="language-http">OPTIONS /users HTTP/1.1

HTTP/1.1 200 OK
Allow: GET, POST, OPTIONS
Access-Control-Allow-Methods: GET, POST, OPTIONS
Access-Control-Allow-Headers: Content-Type, Authorization
</code></pre>
<p><strong>Use Cases:</strong></p>
<ul>
<li>CORS preflight requests</li>
<li>Discover supported methods</li>
</ul>
<hr>
<h2 id="http-status-codes"><a class="header" href="#http-status-codes">HTTP Status Codes</a></h2>
<p>Status codes communicate the result of an HTTP request. Proper status codes improve API usability and debugging.</p>
<h3 id="status-code-ranges"><a class="header" href="#status-code-ranges">Status Code Ranges</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Range</th><th>Category</th><th>Meaning</th></tr>
</thead>
<tbody>
<tr><td>1xx</td><td>Informational</td><td>Request received, continuing process</td></tr>
<tr><td>2xx</td><td>Success</td><td>Request successfully received, understood, accepted</td></tr>
<tr><td>3xx</td><td>Redirection</td><td>Further action needed to complete request</td></tr>
<tr><td>4xx</td><td>Client Error</td><td>Request contains bad syntax or cannot be fulfilled</td></tr>
<tr><td>5xx</td><td>Server Error</td><td>Server failed to fulfill valid request</td></tr>
</tbody>
</table>
</div>
<h3 id="2xx-success"><a class="header" href="#2xx-success">2xx Success</a></h3>
<h4 id="200-ok"><a class="header" href="#200-ok">200 OK</a></h4>
<p><strong>Usage:</strong> General success for GET, PUT, PATCH, DELETE (with body).</p>
<pre><code class="language-http">GET /users/123
HTTP/1.1 200 OK

{
  "id": 123,
  "name": "John Doe"
}
</code></pre>
<h4 id="201-created"><a class="header" href="#201-created">201 Created</a></h4>
<p><strong>Usage:</strong> Resource successfully created (POST, sometimes PUT).</p>
<pre><code class="language-http">POST /users
HTTP/1.1 201 Created
Location: /users/123

{
  "id": 123,
  "name": "John Doe"
}
</code></pre>
<p><strong>Best Practice:</strong> Include Location header with new resource URL.</p>
<h4 id="202-accepted"><a class="header" href="#202-accepted">202 Accepted</a></h4>
<p><strong>Usage:</strong> Request accepted but processing not complete (async operations).</p>
<pre><code class="language-http">POST /reports/generate
HTTP/1.1 202 Accepted

{
  "message": "Report generation started",
  "statusUrl": "/reports/status/abc123"
}
</code></pre>
<h4 id="204-no-content"><a class="header" href="#204-no-content">204 No Content</a></h4>
<p><strong>Usage:</strong> Success but no content to return (DELETE, PUT, PATCH).</p>
<pre><code class="language-http">DELETE /users/123
HTTP/1.1 204 No Content
</code></pre>
<p><strong>Note:</strong> No response body.</p>
<h3 id="3xx-redirection"><a class="header" href="#3xx-redirection">3xx Redirection</a></h3>
<h4 id="301-moved-permanently"><a class="header" href="#301-moved-permanently">301 Moved Permanently</a></h4>
<p><strong>Usage:</strong> Resource permanently moved to new URL.</p>
<pre><code class="language-http">GET /users/123
HTTP/1.1 301 Moved Permanently
Location: /v2/users/123
</code></pre>
<h4 id="302-found--307-temporary-redirect"><a class="header" href="#302-found--307-temporary-redirect">302 Found / 307 Temporary Redirect</a></h4>
<p><strong>Usage:</strong> Resource temporarily at different URL.</p>
<pre><code class="language-http">GET /users/123
HTTP/1.1 307 Temporary Redirect
Location: /users/temp/123
</code></pre>
<h4 id="304-not-modified"><a class="header" href="#304-not-modified">304 Not Modified</a></h4>
<p><strong>Usage:</strong> Cached version is still valid.</p>
<pre><code class="language-http">GET /users/123
If-None-Match: "33a64df551425fcc55e4d42a148795d9f25f89d4"

HTTP/1.1 304 Not Modified
ETag: "33a64df551425fcc55e4d42a148795d9f25f89d4"
</code></pre>
<h3 id="4xx-client-errors"><a class="header" href="#4xx-client-errors">4xx Client Errors</a></h3>
<h4 id="400-bad-request"><a class="header" href="#400-bad-request">400 Bad Request</a></h4>
<p><strong>Usage:</strong> Invalid request syntax or parameters.</p>
<pre><code class="language-http">POST /users
{
  "email": "invalid-email"
}

HTTP/1.1 400 Bad Request
{
  "error": "Validation failed",
  "details": {
    "email": "Invalid email format"
  }
}
</code></pre>
<p><strong>When to Use:</strong></p>
<ul>
<li>Invalid JSON</li>
<li>Missing required fields</li>
<li>Invalid field values</li>
<li>Malformed parameters</li>
</ul>
<h4 id="401-unauthorized"><a class="header" href="#401-unauthorized">401 Unauthorized</a></h4>
<p><strong>Usage:</strong> Authentication required or failed.</p>
<pre><code class="language-http">GET /users/123
HTTP/1.1 401 Unauthorized
WWW-Authenticate: Bearer realm="api"

{
  "error": "Authentication required",
  "message": "Please provide a valid access token"
}
</code></pre>
<p><strong>Note:</strong> Despite the name, this means “unauthenticated”.</p>
<h4 id="403-forbidden"><a class="header" href="#403-forbidden">403 Forbidden</a></h4>
<p><strong>Usage:</strong> Authenticated but not authorized.</p>
<pre><code class="language-http">DELETE /users/123
Authorization: Bearer valid-token

HTTP/1.1 403 Forbidden
{
  "error": "Insufficient permissions",
  "message": "You don't have permission to delete this user"
}
</code></pre>
<p><strong>401 vs 403:</strong></p>
<pre><code>401: You need to log in
403: You're logged in, but you can't do this
</code></pre>
<h4 id="404-not-found"><a class="header" href="#404-not-found">404 Not Found</a></h4>
<p><strong>Usage:</strong> Resource doesn’t exist.</p>
<pre><code class="language-http">GET /users/999
HTTP/1.1 404 Not Found

{
  "error": "Resource not found",
  "message": "User with ID 999 does not exist"
}
</code></pre>
<h4 id="405-method-not-allowed"><a class="header" href="#405-method-not-allowed">405 Method Not Allowed</a></h4>
<p><strong>Usage:</strong> HTTP method not supported for resource.</p>
<pre><code class="language-http">POST /users/123
HTTP/1.1 405 Method Not Allowed
Allow: GET, PUT, PATCH, DELETE

{
  "error": "Method not allowed",
  "message": "POST is not supported for this resource. Use PUT or PATCH to update."
}
</code></pre>
<h4 id="409-conflict"><a class="header" href="#409-conflict">409 Conflict</a></h4>
<p><strong>Usage:</strong> Request conflicts with current state.</p>
<pre><code class="language-http">POST /users
{
  "email": "existing@example.com"
}

HTTP/1.1 409 Conflict
{
  "error": "User already exists",
  "message": "A user with this email already exists"
}
</code></pre>
<p><strong>Use Cases:</strong></p>
<ul>
<li>Duplicate resource</li>
<li>Version conflict</li>
<li>Business rule violation</li>
</ul>
<h4 id="422-unprocessable-entity"><a class="header" href="#422-unprocessable-entity">422 Unprocessable Entity</a></h4>
<p><strong>Usage:</strong> Valid syntax but semantic errors.</p>
<pre><code class="language-http">POST /users
{
  "age": -5,
  "email": "valid@example.com"
}

HTTP/1.1 422 Unprocessable Entity
{
  "error": "Validation failed",
  "details": {
    "age": "Age must be a positive number"
  }
}
</code></pre>
<p><strong>400 vs 422:</strong></p>
<pre><code>400: Syntax error (invalid JSON, wrong type)
422: Semantic error (valid JSON, invalid business logic)
</code></pre>
<h4 id="429-too-many-requests"><a class="header" href="#429-too-many-requests">429 Too Many Requests</a></h4>
<p><strong>Usage:</strong> Rate limit exceeded.</p>
<pre><code class="language-http">GET /users
HTTP/1.1 429 Too Many Requests
Retry-After: 60

{
  "error": "Rate limit exceeded",
  "message": "Too many requests. Please try again in 60 seconds."
}
</code></pre>
<h3 id="5xx-server-errors"><a class="header" href="#5xx-server-errors">5xx Server Errors</a></h3>
<h4 id="500-internal-server-error"><a class="header" href="#500-internal-server-error">500 Internal Server Error</a></h4>
<p><strong>Usage:</strong> Generic server error.</p>
<pre><code class="language-http">GET /users/123
HTTP/1.1 500 Internal Server Error

{
  "error": "Internal server error",
  "message": "An unexpected error occurred",
  "requestId": "abc123"
}
</code></pre>
<p><strong>Best Practice:</strong> Log detailed error, return generic message to client.</p>
<h4 id="502-bad-gateway"><a class="header" href="#502-bad-gateway">502 Bad Gateway</a></h4>
<p><strong>Usage:</strong> Invalid response from upstream server.</p>
<pre><code class="language-http">GET /users
HTTP/1.1 502 Bad Gateway

{
  "error": "Bad gateway",
  "message": "Error communicating with database"
}
</code></pre>
<h4 id="503-service-unavailable"><a class="header" href="#503-service-unavailable">503 Service Unavailable</a></h4>
<p><strong>Usage:</strong> Server temporarily unavailable.</p>
<pre><code class="language-http">GET /users
HTTP/1.1 503 Service Unavailable
Retry-After: 300

{
  "error": "Service unavailable",
  "message": "Server is under maintenance. Please try again in 5 minutes."
}
</code></pre>
<h4 id="504-gateway-timeout"><a class="header" href="#504-gateway-timeout">504 Gateway Timeout</a></h4>
<p><strong>Usage:</strong> Upstream server timeout.</p>
<pre><code class="language-http">GET /reports/large
HTTP/1.1 504 Gateway Timeout

{
  "error": "Gateway timeout",
  "message": "Request took too long to process"
}
</code></pre>
<h3 id="status-code-decision-tree"><a class="header" href="#status-code-decision-tree">Status Code Decision Tree</a></h3>
<pre><code>Request received
├─ Valid request?
│  ├─ No → 400 Bad Request
│  └─ Yes
│     ├─ Authenticated?
│     │  ├─ No → 401 Unauthorized
│     │  └─ Yes
│     │     ├─ Authorized?
│     │     │  ├─ No → 403 Forbidden
│     │     │  └─ Yes
│     │     │     ├─ Resource exists?
│     │     │     │  ├─ No → 404 Not Found
│     │     │     │  └─ Yes
│     │     │     │     ├─ Method allowed?
│     │     │     │     │  ├─ No → 405 Method Not Allowed
│     │     │     │     │  └─ Yes
│     │     │     │     │     ├─ Business logic valid?
│     │     │     │     │     │  ├─ No → 422 Unprocessable Entity / 409 Conflict
│     │     │     │     │     │  └─ Yes
│     │     │     │     │     │     ├─ Server error?
│     │     │     │     │     │     │  ├─ Yes → 500 Internal Server Error
│     │     │     │     │     │     │  └─ No → 200 OK / 201 Created / 204 No Content
</code></pre>
<h3 id="implementation-example"><a class="header" href="#implementation-example">Implementation Example</a></h3>
<pre><code class="language-javascript">const express = require('express');
const app = express();

app.get('/users/:id', async (req, res, next) =&gt; {
  try {
    // Validate ID format
    if (!isValidId(req.params.id)) {
      return res.status(400).json({
        error: 'Invalid ID format'
      });
    }

    // Check authentication
    if (!req.headers.authorization) {
      return res.status(401).json({
        error: 'Authentication required'
      });
    }

    // Verify token
    const user = await verifyToken(req.headers.authorization);
    if (!user) {
      return res.status(401).json({
        error: 'Invalid token'
      });
    }

    // Get resource
    const targetUser = await database.getUser(req.params.id);
    if (!targetUser) {
      return res.status(404).json({
        error: 'User not found'
      });
    }

    // Check authorization
    if (!canAccessUser(user, targetUser)) {
      return res.status(403).json({
        error: 'Insufficient permissions'
      });
    }

    // Success
    res.status(200).json(targetUser);

  } catch (error) {
    // Server error
    console.error('Error:', error);
    res.status(500).json({
      error: 'Internal server error',
      requestId: req.id
    });
  }
});

app.post('/users', async (req, res) =&gt; {
  // Validate input
  const errors = validateUser(req.body);
  if (errors.length &gt; 0) {
    return res.status(422).json({
      error: 'Validation failed',
      details: errors
    });
  }

  // Check for duplicates
  const existing = await database.findUserByEmail(req.body.email);
  if (existing) {
    return res.status(409).json({
      error: 'User already exists'
    });
  }

  // Create user
  const user = await database.createUser(req.body);

  res.status(201)
    .location(`/users/${user.id}`)
    .json(user);
});
</code></pre>
<hr>
<h2 id="api-versioning-strategies"><a class="header" href="#api-versioning-strategies">API Versioning Strategies</a></h2>
<p>API versioning allows you to evolve your API while maintaining backward compatibility for existing clients.</p>
<h3 id="why-version-apis"><a class="header" href="#why-version-apis">Why Version APIs?</a></h3>
<ul>
<li><strong>Breaking Changes:</strong> Modify response structure, rename fields, change behavior</li>
<li><strong>Backward Compatibility:</strong> Support old clients while adding new features</li>
<li><strong>Gradual Migration:</strong> Give clients time to upgrade</li>
<li><strong>Multiple Client Versions:</strong> Mobile apps can’t force immediate updates</li>
</ul>
<h3 id="versioning-strategies"><a class="header" href="#versioning-strategies">Versioning Strategies</a></h3>
<h4 id="1-url-path-versioning"><a class="header" href="#1-url-path-versioning">1. URL Path Versioning</a></h4>
<p><strong>Most Common Approach</strong></p>
<pre><code>https://api.example.com/v1/users
https://api.example.com/v2/users
https://api.example.com/v3/users
</code></pre>
<p><strong>Pros:</strong></p>
<ul>
<li>Simple and explicit</li>
<li>Easy to route and cache</li>
<li>Clear in URLs and documentation</li>
<li>Browser-friendly</li>
</ul>
<p><strong>Cons:</strong></p>
<ul>
<li>URLs change between versions</li>
<li>Can lead to URL bloat</li>
</ul>
<p><strong>Implementation:</strong></p>
<pre><code class="language-javascript">const express = require('express');
const app = express();

// Version 1
app.get('/v1/users/:id', (req, res) =&gt; {
  const user = getUserV1(req.params.id);
  res.json({
    id: user.id,
    name: user.name,
    email: user.email
  });
});

// Version 2 - added phone field
app.get('/v2/users/:id', (req, res) =&gt; {
  const user = getUserV2(req.params.id);
  res.json({
    id: user.id,
    fullName: user.name,  // renamed field
    email: user.email,
    phone: user.phone     // new field
  });
});

// Version 3 - restructured response
app.get('/v3/users/:id', (req, res) =&gt; {
  const user = getUserV3(req.params.id);
  res.json({
    user: {
      id: user.id,
      profile: {
        fullName: user.name,
        email: user.email,
        phone: user.phone
      },
      metadata: {
        createdAt: user.createdAt,
        updatedAt: user.updatedAt
      }
    }
  });
});
</code></pre>
<p><strong>Best Practices:</strong></p>
<pre><code>✅ Use major versions only: v1, v2, v3
✅ Include version in base path: /v1/
❌ Avoid minor versions in URL: /v1.2/users
</code></pre>
<h4 id="2-header-versioning"><a class="header" href="#2-header-versioning">2. Header Versioning</a></h4>
<p><strong>Custom Header</strong></p>
<pre><code class="language-http">GET /users/123 HTTP/1.1
Host: api.example.com
API-Version: 2
</code></pre>
<p><strong>Accept Header (Content Negotiation)</strong></p>
<pre><code class="language-http">GET /users/123 HTTP/1.1
Host: api.example.com
Accept: application/vnd.example.v2+json
</code></pre>
<p><strong>Pros:</strong></p>
<ul>
<li>Clean URLs</li>
<li>Better adherence to REST principles</li>
<li>Supports multiple versioning dimensions</li>
</ul>
<p><strong>Cons:</strong></p>
<ul>
<li>Less visible</li>
<li>Harder to test (can’t just paste URL in browser)</li>
<li>More complex routing</li>
</ul>
<p><strong>Implementation:</strong></p>
<pre><code class="language-javascript">// Custom header versioning
app.use((req, res, next) =&gt; {
  req.apiVersion = req.headers['api-version'] || '1';
  next();
});

app.get('/users/:id', (req, res) =&gt; {
  const user = getUser(req.params.id);

  if (req.apiVersion === '1') {
    res.json({
      id: user.id,
      name: user.name,
      email: user.email
    });
  } else if (req.apiVersion === '2') {
    res.json({
      id: user.id,
      fullName: user.name,
      email: user.email,
      phone: user.phone
    });
  }
});

// Accept header versioning
app.get('/users/:id', (req, res) =&gt; {
  const user = getUser(req.params.id);
  const accept = req.headers.accept;

  if (accept.includes('vnd.example.v2+json')) {
    res.json({ /* v2 format */ });
  } else {
    res.json({ /* v1 format */ });
  }
});
</code></pre>
<h4 id="3-query-parameter-versioning"><a class="header" href="#3-query-parameter-versioning">3. Query Parameter Versioning</a></h4>
<pre><code>https://api.example.com/users?version=2
https://api.example.com/users?v=2
https://api.example.com/users?api-version=2
</code></pre>
<p><strong>Pros:</strong></p>
<ul>
<li>Simple to implement</li>
<li>Easy to test</li>
<li>Flexible</li>
</ul>
<p><strong>Cons:</strong></p>
<ul>
<li>Mixes versioning with filtering parameters</li>
<li>Less clean than URL path versioning</li>
<li>Not RESTful</li>
</ul>
<p><strong>Implementation:</strong></p>
<pre><code class="language-javascript">app.get('/users/:id', (req, res) =&gt; {
  const version = req.query.version || '1';
  const user = getUser(req.params.id);

  const formatters = {
    '1': formatUserV1,
    '2': formatUserV2,
    '3': formatUserV3
  };

  const formatter = formatters[version] || formatters['1'];
  res.json(formatter(user));
});
</code></pre>
<h4 id="4-content-negotiation-media-type"><a class="header" href="#4-content-negotiation-media-type">4. Content Negotiation (Media Type)</a></h4>
<pre><code class="language-http">GET /users/123 HTTP/1.1
Accept: application/vnd.example.user.v2+json
</code></pre>
<p><strong>Pros:</strong></p>
<ul>
<li>RESTful approach</li>
<li>Standard HTTP mechanism</li>
<li>Can version individual resources</li>
</ul>
<p><strong>Cons:</strong></p>
<ul>
<li>Complex</li>
<li>Less intuitive</li>
<li>Harder to debug</li>
</ul>
<h3 id="version-management-strategies"><a class="header" href="#version-management-strategies">Version Management Strategies</a></h3>
<h4 id="default-version"><a class="header" href="#default-version">Default Version</a></h4>
<pre><code class="language-javascript">// Default to latest stable version
app.use((req, res, next) =&gt; {
  if (!req.path.startsWith('/v')) {
    return res.redirect(`/v2${req.path}`);
  }
  next();
});

// Or serve default version directly
app.get('/users/:id', (req, res) =&gt; {
  // Default to v2
  req.apiVersion = '2';
  // Handle request...
});
</code></pre>
<h4 id="version-sunsetdeprecation"><a class="header" href="#version-sunsetdeprecation">Version Sunset/Deprecation</a></h4>
<pre><code class="language-http">GET /v1/users/123 HTTP/1.1

HTTP/1.1 200 OK
Sunset: Sat, 31 Dec 2023 23:59:59 GMT
Deprecation: true
Link: &lt;/v2/users/123&gt;; rel="successor-version"
Warning: 299 - "API version 1 is deprecated and will be removed on Dec 31, 2023"

{
  "id": 123,
  "name": "John Doe"
}
</code></pre>
<p><strong>Implementation:</strong></p>
<pre><code class="language-javascript">app.use('/v1/*', (req, res, next) =&gt; {
  res.set({
    'Sunset': 'Sat, 31 Dec 2023 23:59:59 GMT',
    'Deprecation': 'true',
    'Warning': '299 - "API version 1 is deprecated"'
  });
  next();
});
</code></pre>
<h3 id="versioning-best-practices"><a class="header" href="#versioning-best-practices">Versioning Best Practices</a></h3>
<h4 id="1-version-the-entire-api"><a class="header" href="#1-version-the-entire-api">1. Version the Entire API</a></h4>
<pre><code>✅ /v1/users, /v1/orders, /v1/products (consistent)
❌ /v1/users, /v2/orders, /users/products (inconsistent)
</code></pre>
<h4 id="2-make-non-breaking-changes-when-possible"><a class="header" href="#2-make-non-breaking-changes-when-possible">2. Make Non-Breaking Changes When Possible</a></h4>
<p><strong>Non-Breaking Changes:</strong></p>
<ul>
<li>Adding new endpoints</li>
<li>Adding optional fields to requests</li>
<li>Adding fields to responses</li>
<li>Adding optional query parameters</li>
</ul>
<p><strong>Breaking Changes:</strong></p>
<ul>
<li>Removing fields from responses</li>
<li>Renaming fields</li>
<li>Changing field types</li>
<li>Changing validation rules</li>
<li>Removing endpoints</li>
</ul>
<pre><code class="language-javascript">// Non-breaking: Adding optional field
// Version 1
{ "name": "John" }

// Version 1 (updated)
{ "name": "John", "phone": "123" }  // phone is optional

// Breaking: Renaming field
// Version 1
{ "name": "John" }

// Version 2 (requires new version)
{ "fullName": "John" }
</code></pre>
<h4 id="3-support-multiple-versions"><a class="header" href="#3-support-multiple-versions">3. Support Multiple Versions</a></h4>
<pre><code class="language-javascript">const v1Routes = require('./routes/v1');
const v2Routes = require('./routes/v2');
const v3Routes = require('./routes/v3');

app.use('/v1', v1Routes);
app.use('/v2', v2Routes);
app.use('/v3', v3Routes);
</code></pre>
<h4 id="4-document-version-differences"><a class="header" href="#4-document-version-differences">4. Document Version Differences</a></h4>
<pre><code class="language-markdown"># API Versions

## Version 3 (Current)
- Restructured user response
- Added pagination metadata
- Breaking: Changed date format to ISO 8601

## Version 2 (Deprecated - Sunset: Dec 31, 2023)
- Added phone field
- Renamed `name` to `fullName`

## Version 1 (Deprecated - Sunset: Dec 31, 2023)
- Initial version
</code></pre>
<h3 id="migration-example"><a class="header" href="#migration-example">Migration Example</a></h3>
<p><strong>Version 1 → Version 2 Migration</strong></p>
<pre><code class="language-javascript">// v1/users.js
router.get('/:id', async (req, res) =&gt; {
  const user = await db.getUser(req.params.id);
  res.json({
    id: user.id,
    name: user.name,
    email: user.email,
    created: user.createdAt.getTime()  // timestamp
  });
});

// v2/users.js
router.get('/:id', async (req, res) =&gt; {
  const user = await db.getUser(req.params.id);
  res.json({
    id: user.id,
    fullName: user.name,              // renamed
    email: user.email,
    phone: user.phone,                // added
    createdAt: user.createdAt.toISOString()  // changed format
  });
});

// Migration helper for clients
router.get('/:id/migrate', async (req, res) =&gt; {
  const user = await db.getUser(req.params.id);
  res.json({
    v1: {
      id: user.id,
      name: user.name,
      email: user.email,
      created: user.createdAt.getTime()
    },
    v2: {
      id: user.id,
      fullName: user.name,
      email: user.email,
      phone: user.phone,
      createdAt: user.createdAt.toISOString()
    },
    migration: {
      'name → fullName': 'Field renamed',
      'phone': 'New field added',
      'created → createdAt': 'Format changed to ISO 8601'
    }
  });
});
</code></pre>
<hr>
<h2 id="pagination-strategies"><a class="header" href="#pagination-strategies">Pagination Strategies</a></h2>
<p>Pagination is essential for APIs that return large datasets. It improves performance, reduces bandwidth, and provides better user experience.</p>
<h3 id="why-paginate"><a class="header" href="#why-paginate">Why Paginate?</a></h3>
<ul>
<li><strong>Performance:</strong> Avoid loading entire dataset into memory</li>
<li><strong>Bandwidth:</strong> Reduce data transfer</li>
<li><strong>User Experience:</strong> Faster response times</li>
<li><strong>Database Load:</strong> Reduce query complexity</li>
</ul>
<h3 id="pagination-strategies-1"><a class="header" href="#pagination-strategies-1">Pagination Strategies</a></h3>
<h4 id="1-offset-based-pagination"><a class="header" href="#1-offset-based-pagination">1. Offset-Based Pagination</a></h4>
<p><strong>Most Common Approach</strong></p>
<pre><code>GET /users?limit=20&amp;offset=40
GET /users?page=3&amp;per_page=20
</code></pre>
<p><strong>Response:</strong></p>
<pre><code class="language-json">{
  "data": [
    { "id": 41, "name": "User 41" },
    { "id": 42, "name": "User 42" },
    ...
  ],
  "pagination": {
    "total": 1000,
    "page": 3,
    "perPage": 20,
    "totalPages": 50,
    "hasNext": true,
    "hasPrev": true
  }
}
</code></pre>
<p><strong>Implementation:</strong></p>
<pre><code class="language-javascript">app.get('/users', async (req, res) =&gt; {
  const page = parseInt(req.query.page) || 1;
  const perPage = parseInt(req.query.per_page) || 20;
  const offset = (page - 1) * perPage;

  // Get paginated data
  const users = await db.query(
    'SELECT * FROM users LIMIT $1 OFFSET $2',
    [perPage, offset]
  );

  // Get total count
  const total = await db.query('SELECT COUNT(*) FROM users');
  const totalUsers = parseInt(total.rows[0].count);
  const totalPages = Math.ceil(totalUsers / perPage);

  res.json({
    data: users.rows,
    pagination: {
      total: totalUsers,
      page,
      perPage,
      totalPages,
      hasNext: page &lt; totalPages,
      hasPrev: page &gt; 1
    }
  });
});
</code></pre>
<p><strong>Pros:</strong></p>
<ul>
<li>Simple to implement</li>
<li>Easy to jump to specific page</li>
<li>Shows total count and pages</li>
</ul>
<p><strong>Cons:</strong></p>
<ul>
<li>Performance degrades with large offsets</li>
<li>Inconsistent results if data changes during pagination</li>
<li>Expensive COUNT(*) queries</li>
</ul>
<p><strong>Performance Issue:</strong></p>
<pre><code class="language-sql">-- Fast
SELECT * FROM users LIMIT 20 OFFSET 0;

-- Slow (must scan 1,000,000 rows)
SELECT * FROM users LIMIT 20 OFFSET 1000000;
</code></pre>
<h4 id="2-cursor-based-pagination"><a class="header" href="#2-cursor-based-pagination">2. Cursor-Based Pagination</a></h4>
<p><strong>Best for Real-Time Data</strong></p>
<pre><code>GET /users?limit=20
GET /users?limit=20&amp;cursor=eyJpZCI6MTIzfQ==
</code></pre>
<p><strong>Response:</strong></p>
<pre><code class="language-json">{
  "data": [
    { "id": 124, "name": "User 124" },
    { "id": 125, "name": "User 125" },
    ...
  ],
  "pagination": {
    "nextCursor": "eyJpZCI6MTQzfQ==",
    "hasMore": true
  }
}
</code></pre>
<p><strong>Implementation:</strong></p>
<pre><code class="language-javascript">app.get('/users', async (req, res) =&gt; {
  const limit = parseInt(req.query.limit) || 20;
  const cursor = req.query.cursor
    ? JSON.parse(Buffer.from(req.query.cursor, 'base64').toString())
    : null;

  // Build query
  let query = 'SELECT * FROM users';
  let params = [limit + 1];  // Fetch one extra to check if more exist

  if (cursor) {
    query += ' WHERE id &gt; $2';
    params.push(cursor.id);
  }

  query += ' ORDER BY id ASC LIMIT $1';

  const users = await db.query(query, params);
  const hasMore = users.rows.length &gt; limit;

  // Remove extra item if exists
  if (hasMore) {
    users.rows.pop();
  }

  // Create next cursor
  let nextCursor = null;
  if (hasMore &amp;&amp; users.rows.length &gt; 0) {
    const lastUser = users.rows[users.rows.length - 1];
    nextCursor = Buffer.from(
      JSON.stringify({ id: lastUser.id })
    ).toString('base64');
  }

  res.json({
    data: users.rows,
    pagination: {
      nextCursor,
      hasMore
    }
  });
});
</code></pre>
<p><strong>Pros:</strong></p>
<ul>
<li>Consistent performance (no offset)</li>
<li>Handles real-time data well</li>
<li>No missing/duplicate items during pagination</li>
</ul>
<p><strong>Cons:</strong></p>
<ul>
<li>Can’t jump to specific page</li>
<li>No total count</li>
<li>More complex implementation</li>
</ul>
<p><strong>When to Use:</strong></p>
<ul>
<li>Infinite scroll</li>
<li>Real-time feeds</li>
<li>Large datasets</li>
<li>Chat messages</li>
</ul>
<h4 id="3-keyset-pagination"><a class="header" href="#3-keyset-pagination">3. Keyset Pagination</a></h4>
<p><strong>Variation of Cursor-Based</strong></p>
<pre><code>GET /users?limit=20&amp;after_id=123
GET /posts?limit=20&amp;after_date=2023-11-15T10:00:00Z
</code></pre>
<p><strong>Implementation:</strong></p>
<pre><code class="language-javascript">app.get('/posts', async (req, res) =&gt; {
  const limit = parseInt(req.query.limit) || 20;
  const afterDate = req.query.after_date;

  let query = 'SELECT * FROM posts';
  const params = [limit + 1];

  if (afterDate) {
    query += ' WHERE created_at &lt; $2';
    params.push(afterDate);
  }

  query += ' ORDER BY created_at DESC LIMIT $1';

  const posts = await db.query(query, params);
  const hasMore = posts.rows.length &gt; limit;

  if (hasMore) {
    posts.rows.pop();
  }

  res.json({
    data: posts.rows,
    pagination: {
      hasMore,
      nextAfterDate: hasMore
        ? posts.rows[posts.rows.length - 1].created_at
        : null
    }
  });
});
</code></pre>
<p><strong>Pros:</strong></p>
<ul>
<li>Human-readable cursor</li>
<li>Efficient database queries</li>
<li>Predictable performance</li>
</ul>
<p><strong>Cons:</strong></p>
<ul>
<li>Requires indexed column</li>
<li>Can’t jump to specific page</li>
</ul>
<h3 id="link-header-pagination-github-style"><a class="header" href="#link-header-pagination-github-style">Link Header Pagination (GitHub Style)</a></h3>
<pre><code class="language-http">GET /users?page=3&amp;per_page=20 HTTP/1.1

HTTP/1.1 200 OK
Link: &lt;https://api.example.com/users?page=1&amp;per_page=20&gt;; rel="first",
      &lt;https://api.example.com/users?page=2&amp;per_page=20&gt;; rel="prev",
      &lt;https://api.example.com/users?page=4&amp;per_page=20&gt;; rel="next",
      &lt;https://api.example.com/users?page=50&amp;per_page=20&gt;; rel="last"

[
  { "id": 41, "name": "User 41" },
  ...
]
</code></pre>
<p><strong>Implementation:</strong></p>
<pre><code class="language-javascript">app.get('/users', async (req, res) =&gt; {
  const page = parseInt(req.query.page) || 1;
  const perPage = parseInt(req.query.per_page) || 20;

  // Get data and total
  const users = await getUsers(page, perPage);
  const total = await getUserCount();
  const totalPages = Math.ceil(total / perPage);

  // Build Link header
  const baseUrl = `${req.protocol}://${req.get('host')}${req.path}`;
  const links = [];

  // First page
  links.push(`&lt;${baseUrl}?page=1&amp;per_page=${perPage}&gt;; rel="first"`);

  // Previous page
  if (page &gt; 1) {
    links.push(`&lt;${baseUrl}?page=${page-1}&amp;per_page=${perPage}&gt;; rel="prev"`);
  }

  // Next page
  if (page &lt; totalPages) {
    links.push(`&lt;${baseUrl}?page=${page+1}&amp;per_page=${perPage}&gt;; rel="next"`);
  }

  // Last page
  links.push(`&lt;${baseUrl}?page=${totalPages}&amp;per_page=${perPage}&gt;; rel="last"`);

  res.set('Link', links.join(', '));
  res.json(users);
});
</code></pre>
<h3 id="pagination-best-practices"><a class="header" href="#pagination-best-practices">Pagination Best Practices</a></h3>
<h4 id="1-set-default-and-maximum-limits"><a class="header" href="#1-set-default-and-maximum-limits">1. Set Default and Maximum Limits</a></h4>
<pre><code class="language-javascript">app.get('/users', (req, res) =&gt; {
  const limit = Math.min(
    parseInt(req.query.limit) || 20,  // default
    100                                // maximum
  );

  if (limit &lt; 1 || limit &gt; 100) {
    return res.status(400).json({
      error: 'Limit must be between 1 and 100'
    });
  }

  // Continue with pagination...
});
</code></pre>
<h4 id="2-include-pagination-metadata"><a class="header" href="#2-include-pagination-metadata">2. Include Pagination Metadata</a></h4>
<pre><code class="language-json">{
  "data": [...],
  "meta": {
    "total": 1000,
    "page": 3,
    "perPage": 20,
    "totalPages": 50,
    "links": {
      "first": "/users?page=1",
      "prev": "/users?page=2",
      "self": "/users?page=3",
      "next": "/users?page=4",
      "last": "/users?page=50"
    }
  }
}
</code></pre>
<h4 id="3-handle-edge-cases"><a class="header" href="#3-handle-edge-cases">3. Handle Edge Cases</a></h4>
<pre><code class="language-javascript">// Empty results
{
  "data": [],
  "pagination": {
    "total": 0,
    "page": 1,
    "perPage": 20,
    "totalPages": 0,
    "hasNext": false,
    "hasPrev": false
  }
}

// Out of range page
if (page &gt; totalPages &amp;&amp; totalPages &gt; 0) {
  return res.status(404).json({
    error: 'Page not found',
    message: `Page ${page} does not exist. Total pages: ${totalPages}`
  });
}
</code></pre>
<h4 id="4-support-sorting-with-pagination"><a class="header" href="#4-support-sorting-with-pagination">4. Support Sorting with Pagination</a></h4>
<pre><code class="language-javascript">GET /users?page=2&amp;sort=name&amp;order=asc
GET /users?page=2&amp;sort=-created_at  // minus sign for descending

app.get('/users', async (req, res) =&gt; {
  const page = parseInt(req.query.page) || 1;
  const perPage = 20;
  const sort = req.query.sort || 'id';
  const order = req.query.order === 'desc' ? 'DESC' : 'ASC';

  // Validate sort field
  const allowedSortFields = ['id', 'name', 'created_at'];
  if (!allowedSortFields.includes(sort)) {
    return res.status(400).json({ error: 'Invalid sort field' });
  }

  const users = await db.query(
    `SELECT * FROM users ORDER BY ${sort} ${order} LIMIT $1 OFFSET $2`,
    [perPage, (page - 1) * perPage]
  );

  res.json({ data: users.rows });
});
</code></pre>
<h3 id="choosing-a-pagination-strategy"><a class="header" href="#choosing-a-pagination-strategy">Choosing a Pagination Strategy</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Use Case</th><th>Strategy</th><th>Reason</th></tr>
</thead>
<tbody>
<tr><td>Admin dashboards</td><td>Offset-based</td><td>Need page numbers and total count</td></tr>
<tr><td>Social media feeds</td><td>Cursor-based</td><td>Real-time data, infinite scroll</td></tr>
<tr><td>Search results</td><td>Offset-based</td><td>Jump to specific pages</td></tr>
<tr><td>Chat messages</td><td>Cursor-based</td><td>Real-time, chronological</td></tr>
<tr><td>Reports</td><td>Offset-based</td><td>Need total count</td></tr>
<tr><td>Activity logs</td><td>Keyset</td><td>Time-based, efficient</td></tr>
</tbody>
</table>
</div>
<hr>
<h2 id="filtering-and-sorting"><a class="header" href="#filtering-and-sorting">Filtering and Sorting</a></h2>
<p>Filtering and sorting allow clients to retrieve specific subsets of data in the desired order.</p>
<h3 id="filtering"><a class="header" href="#filtering">Filtering</a></h3>
<h4 id="basic-filtering"><a class="header" href="#basic-filtering">Basic Filtering</a></h4>
<pre><code>GET /users?status=active
GET /users?role=admin&amp;status=active
GET /products?category=electronics&amp;price_min=100&amp;price_max=500
</code></pre>
<p><strong>Implementation:</strong></p>
<pre><code class="language-javascript">app.get('/users', async (req, res) =&gt; {
  const { status, role, city } = req.query;

  let query = 'SELECT * FROM users WHERE 1=1';
  const params = [];
  let paramIndex = 1;

  if (status) {
    query += ` AND status = $${paramIndex++}`;
    params.push(status);
  }

  if (role) {
    query += ` AND role = $${paramIndex++}`;
    params.push(role);
  }

  if (city) {
    query += ` AND city = $${paramIndex++}`;
    params.push(city);
  }

  const users = await db.query(query, params);
  res.json({ data: users.rows });
});
</code></pre>
<h4 id="range-filtering"><a class="header" href="#range-filtering">Range Filtering</a></h4>
<pre><code>GET /products?price_min=100&amp;price_max=500
GET /events?start_date=2023-01-01&amp;end_date=2023-12-31
GET /users?age_gte=18&amp;age_lte=65
</code></pre>
<p><strong>Implementation:</strong></p>
<pre><code class="language-javascript">app.get('/products', async (req, res) =&gt; {
  const { price_min, price_max, stock_gt, stock_lt } = req.query;

  let query = 'SELECT * FROM products WHERE 1=1';
  const params = [];
  let paramIndex = 1;

  if (price_min) {
    query += ` AND price &gt;= $${paramIndex++}`;
    params.push(parseFloat(price_min));
  }

  if (price_max) {
    query += ` AND price &lt;= $${paramIndex++}`;
    params.push(parseFloat(price_max));
  }

  if (stock_gt) {
    query += ` AND stock &gt; $${paramIndex++}`;
    params.push(parseInt(stock_gt));
  }

  if (stock_lt) {
    query += ` AND stock &lt; $${paramIndex++}`;
    params.push(parseInt(stock_lt));
  }

  const products = await db.query(query, params);
  res.json({ data: products.rows });
});
</code></pre>
<p><strong>Operators Convention:</strong></p>
<pre><code>_min, _max    → Inclusive range
_gt, _lt      → Greater than, less than
_gte, _lte    → Greater/less than or equal
_ne           → Not equal
_in           → In array
</code></pre>
<h4 id="array-filtering"><a class="header" href="#array-filtering">Array Filtering</a></h4>
<pre><code>GET /products?category=electronics,books,toys
GET /users?role_in=admin,moderator
GET /posts?tags=javascript,nodejs
</code></pre>
<p><strong>Implementation:</strong></p>
<pre><code class="language-javascript">app.get('/products', async (req, res) =&gt; {
  const { category, tags } = req.query;

  let query = 'SELECT * FROM products WHERE 1=1';
  const params = [];

  if (category) {
    const categories = category.split(',');
    query += ' AND category = ANY($1)';
    params.push(categories);
  }

  if (tags) {
    const tagList = tags.split(',');
    query += ' AND tags &amp;&amp; $2';  // PostgreSQL array overlap
    params.push(tagList);
  }

  const products = await db.query(query, params);
  res.json({ data: products.rows });
});
</code></pre>
<h4 id="searchtext-filtering"><a class="header" href="#searchtext-filtering">Search/Text Filtering</a></h4>
<pre><code>GET /users?search=john
GET /products?q=laptop
GET /posts?title_contains=api
</code></pre>
<p><strong>Implementation:</strong></p>
<pre><code class="language-javascript">app.get('/users', async (req, res) =&gt; {
  const { search } = req.query;

  if (search) {
    // Full-text search
    const users = await db.query(
      `SELECT * FROM users
       WHERE name ILIKE $1
          OR email ILIKE $1`,
      [`%${search}%`]
    );
    return res.json({ data: users.rows });
  }

  // Regular query...
});

// Advanced: Full-text search with PostgreSQL
app.get('/posts', async (req, res) =&gt; {
  const { q } = req.query;

  if (q) {
    const posts = await db.query(
      `SELECT *, ts_rank(search_vector, query) AS rank
       FROM posts, to_tsquery($1) query
       WHERE search_vector @@ query
       ORDER BY rank DESC`,
      [q.split(' ').join(' &amp; ')]
    );
    return res.json({ data: posts.rows });
  }
});
</code></pre>
<h4 id="complex-filtering-filter-query-language"><a class="header" href="#complex-filtering-filter-query-language">Complex Filtering (Filter Query Language)</a></h4>
<pre><code>GET /users?filter={"age":{"$gte":18},"city":"NYC"}
GET /products?filter={"$or":[{"category":"electronics"},{"price":{"$lt":100}}]}
</code></pre>
<p><strong>Implementation:</strong></p>
<pre><code class="language-javascript">// Using MongoDB-style query language
app.get('/users', async (req, res) =&gt; {
  const { filter } = req.query;

  if (filter) {
    try {
      const filterObj = JSON.parse(filter);
      const users = await db.collection('users').find(filterObj).toArray();
      return res.json({ data: users });
    } catch (error) {
      return res.status(400).json({ error: 'Invalid filter' });
    }
  }
});

// Custom filter builder
function buildWhereClause(filter) {
  const conditions = [];
  const params = [];
  let paramIndex = 1;

  for (const [key, value] of Object.entries(filter)) {
    if (typeof value === 'object') {
      for (const [operator, operand] of Object.entries(value)) {
        switch (operator) {
          case '$gte':
            conditions.push(`${key} &gt;= $${paramIndex++}`);
            params.push(operand);
            break;
          case '$lte':
            conditions.push(`${key} &lt;= $${paramIndex++}`);
            params.push(operand);
            break;
          case '$gt':
            conditions.push(`${key} &gt; $${paramIndex++}`);
            params.push(operand);
            break;
          case '$lt':
            conditions.push(`${key} &lt; $${paramIndex++}`);
            params.push(operand);
            break;
          case '$ne':
            conditions.push(`${key} != $${paramIndex++}`);
            params.push(operand);
            break;
          case '$in':
            conditions.push(`${key} = ANY($${paramIndex++})`);
            params.push(operand);
            break;
        }
      }
    } else {
      conditions.push(`${key} = $${paramIndex++}`);
      params.push(value);
    }
  }

  return {
    where: conditions.join(' AND '),
    params
  };
}
</code></pre>
<h3 id="sorting"><a class="header" href="#sorting">Sorting</a></h3>
<h4 id="basic-sorting"><a class="header" href="#basic-sorting">Basic Sorting</a></h4>
<pre><code>GET /users?sort=name
GET /users?sort=created_at
GET /products?sort=price
</code></pre>
<p><strong>Implementation:</strong></p>
<pre><code class="language-javascript">app.get('/users', async (req, res) =&gt; {
  const { sort = 'id', order = 'asc' } = req.query;

  // Whitelist allowed sort fields
  const allowedSortFields = ['id', 'name', 'email', 'created_at'];
  if (!allowedSortFields.includes(sort)) {
    return res.status(400).json({
      error: 'Invalid sort field',
      allowed: allowedSortFields
    });
  }

  const orderDir = order.toLowerCase() === 'desc' ? 'DESC' : 'ASC';

  const users = await db.query(
    `SELECT * FROM users ORDER BY ${sort} ${orderDir}`
  );

  res.json({ data: users.rows });
});
</code></pre>
<h4 id="multi-field-sorting"><a class="header" href="#multi-field-sorting">Multi-field Sorting</a></h4>
<pre><code>GET /users?sort=last_name,first_name
GET /products?sort=-price,name  // - prefix for descending
GET /posts?sort=pinned:desc,created_at:desc
</code></pre>
<p><strong>Implementation:</strong></p>
<pre><code class="language-javascript">app.get('/users', async (req, res) =&gt; {
  const { sort } = req.query;

  if (!sort) {
    return res.json({ data: await getAllUsers() });
  }

  const sortFields = sort.split(',');
  const orderClauses = [];
  const allowedFields = ['id', 'name', 'created_at', 'age'];

  for (const field of sortFields) {
    let fieldName = field;
    let direction = 'ASC';

    // Handle - prefix for descending
    if (field.startsWith('-')) {
      fieldName = field.substring(1);
      direction = 'DESC';
    }

    // Handle :desc/:asc suffix
    if (field.includes(':')) {
      const parts = field.split(':');
      fieldName = parts[0];
      direction = parts[1].toUpperCase();
    }

    // Validate field
    if (!allowedFields.includes(fieldName)) {
      return res.status(400).json({
        error: `Invalid sort field: ${fieldName}`
      });
    }

    orderClauses.push(`${fieldName} ${direction}`);
  }

  const users = await db.query(
    `SELECT * FROM users ORDER BY ${orderClauses.join(', ')}`
  );

  res.json({ data: users.rows });
});
</code></pre>
<h3 id="combining-filtering-sorting-and-pagination"><a class="header" href="#combining-filtering-sorting-and-pagination">Combining Filtering, Sorting, and Pagination</a></h3>
<pre><code>GET /products?category=electronics&amp;price_min=100&amp;price_max=500&amp;sort=-price&amp;page=2&amp;limit=20
</code></pre>
<p><strong>Complete Implementation:</strong></p>
<pre><code class="language-javascript">app.get('/products', async (req, res) =&gt; {
  const {
    // Filtering
    category,
    price_min,
    price_max,
    in_stock,
    // Sorting
    sort = 'id',
    order = 'asc',
    // Pagination
    page = 1,
    limit = 20
  } = req.query;

  // Build WHERE clause
  const conditions = ['1=1'];
  const params = [];
  let paramIndex = 1;

  if (category) {
    conditions.push(`category = $${paramIndex++}`);
    params.push(category);
  }

  if (price_min) {
    conditions.push(`price &gt;= $${paramIndex++}`);
    params.push(parseFloat(price_min));
  }

  if (price_max) {
    conditions.push(`price &lt;= $${paramIndex++}`);
    params.push(parseFloat(price_max));
  }

  if (in_stock === 'true') {
    conditions.push('stock &gt; 0');
  }

  const whereClause = conditions.join(' AND ');

  // Validate and build ORDER BY
  const allowedSortFields = ['id', 'name', 'price', 'created_at', 'stock'];
  if (!allowedSortFields.includes(sort)) {
    return res.status(400).json({ error: 'Invalid sort field' });
  }

  const orderDir = order.toLowerCase() === 'desc' ? 'DESC' : 'ASC';
  const orderClause = `${sort} ${orderDir}`;

  // Pagination
  const pageNum = parseInt(page);
  const limitNum = Math.min(parseInt(limit), 100);  // max 100
  const offset = (pageNum - 1) * limitNum;

  params.push(limitNum, offset);

  // Execute query
  const query = `
    SELECT * FROM products
    WHERE ${whereClause}
    ORDER BY ${orderClause}
    LIMIT $${paramIndex++} OFFSET $${paramIndex++}
  `;

  const products = await db.query(query, params);

  // Get total count for pagination
  const countQuery = `SELECT COUNT(*) FROM products WHERE ${whereClause}`;
  const totalResult = await db.query(countQuery, params.slice(0, -2));
  const total = parseInt(totalResult.rows[0].count);

  res.json({
    data: products.rows,
    meta: {
      page: pageNum,
      limit: limitNum,
      total,
      totalPages: Math.ceil(total / limitNum),
      filters: { category, price_min, price_max, in_stock },
      sort: { field: sort, order: orderDir }
    }
  });
});
</code></pre>
<h3 id="filter-and-sort-best-practices"><a class="header" href="#filter-and-sort-best-practices">Filter and Sort Best Practices</a></h3>
<h4 id="1-validate-input"><a class="header" href="#1-validate-input">1. Validate Input</a></h4>
<pre><code class="language-javascript">function validateFilter(filter) {
  const allowedFields = ['name', 'email', 'status', 'role'];
  const allowedOperators = ['$eq', '$ne', '$gt', '$gte', '$lt', '$lte', '$in'];

  for (const field of Object.keys(filter)) {
    if (!allowedFields.includes(field)) {
      throw new Error(`Invalid filter field: ${field}`);
    }

    if (typeof filter[field] === 'object') {
      for (const operator of Object.keys(filter[field])) {
        if (!allowedOperators.includes(operator)) {
          throw new Error(`Invalid operator: ${operator}`);
        }
      }
    }
  }
}
</code></pre>
<h4 id="2-prevent-sql-injection"><a class="header" href="#2-prevent-sql-injection">2. Prevent SQL Injection</a></h4>
<pre><code class="language-javascript">// ❌ BAD - SQL injection vulnerability
app.get('/users', (req, res) =&gt; {
  const { sort } = req.query;
  const query = `SELECT * FROM users ORDER BY ${sort}`;  // DANGEROUS!
  db.query(query);
});

// ✅ GOOD - Whitelist allowed fields
app.get('/users', (req, res) =&gt; {
  const { sort } = req.query;
  const allowedFields = ['id', 'name', 'created_at'];

  if (!allowedFields.includes(sort)) {
    return res.status(400).json({ error: 'Invalid sort field' });
  }

  const query = `SELECT * FROM users ORDER BY ${sort}`;  // Safe
  db.query(query);
});
</code></pre>
<h4 id="3-document-available-filters"><a class="header" href="#3-document-available-filters">3. Document Available Filters</a></h4>
<pre><code class="language-json">GET /products/filters

{
  "filters": {
    "category": {
      "type": "string",
      "description": "Product category",
      "example": "electronics"
    },
    "price_min": {
      "type": "number",
      "description": "Minimum price",
      "example": 100
    },
    "price_max": {
      "type": "number",
      "description": "Maximum price",
      "example": 500
    },
    "in_stock": {
      "type": "boolean",
      "description": "Filter by stock availability",
      "example": true
    }
  },
  "sortFields": ["id", "name", "price", "created_at", "stock"],
  "examples": [
    "/products?category=electronics&amp;price_min=100&amp;sort=-price",
    "/products?in_stock=true&amp;sort=name&amp;page=2"
  ]
}
</code></pre>
<hr>
<h2 id="rate-limiting"><a class="header" href="#rate-limiting">Rate Limiting</a></h2>
<p>Rate limiting protects APIs from abuse and ensures fair usage among clients.</p>
<h3 id="why-rate-limit"><a class="header" href="#why-rate-limit">Why Rate Limit?</a></h3>
<ul>
<li><strong>Prevent Abuse:</strong> Stop malicious users from overwhelming the API</li>
<li><strong>Ensure Fair Usage:</strong> Distribute resources equitably</li>
<li><strong>Cost Control:</strong> Manage infrastructure costs</li>
<li><strong>Quality of Service:</strong> Maintain performance for all users</li>
<li><strong>Security:</strong> Mitigate DDoS attacks</li>
</ul>
<h3 id="rate-limiting-strategies"><a class="header" href="#rate-limiting-strategies">Rate Limiting Strategies</a></h3>
<h4 id="1-fixed-window"><a class="header" href="#1-fixed-window">1. Fixed Window</a></h4>
<p><strong>Algorithm:</strong> Count requests in fixed time windows (e.g., per minute, per hour).</p>
<pre><code>Window 1: 00:00-00:59 → 100 requests allowed
Window 2: 01:00-01:59 → 100 requests allowed (counter resets)
</code></pre>
<p><strong>Pros:</strong></p>
<ul>
<li>Simple to implement</li>
<li>Low memory usage</li>
</ul>
<p><strong>Cons:</strong></p>
<ul>
<li>Burst traffic at window boundaries</li>
<li>Not smooth rate limiting</li>
</ul>
<p><strong>Implementation:</strong></p>
<pre><code class="language-javascript">const rateLimit = require('express-rate-limit');

const limiter = rateLimit({
  windowMs: 60 * 1000,  // 1 minute
  max: 100,             // max 100 requests per window
  message: {
    error: 'Too many requests',
    retryAfter: 60
  },
  standardHeaders: true,  // Return rate limit info in headers
  legacyHeaders: false
});

app.use('/api/', limiter);
</code></pre>
<p><strong>Response Headers:</strong></p>
<pre><code class="language-http">HTTP/1.1 200 OK
RateLimit-Limit: 100
RateLimit-Remaining: 75
RateLimit-Reset: 1699876800

HTTP/1.1 429 Too Many Requests
RateLimit-Limit: 100
RateLimit-Remaining: 0
RateLimit-Reset: 1699876800
Retry-After: 60

{
  "error": "Too many requests",
  "retryAfter": 60
}
</code></pre>
<h4 id="2-sliding-window"><a class="header" href="#2-sliding-window">2. Sliding Window</a></h4>
<p><strong>Algorithm:</strong> Count requests in a rolling time window.</p>
<pre><code>At 00:30: Count requests from 23:30-00:30
At 00:31: Count requests from 23:31-00:31
</code></pre>
<p><strong>Pros:</strong></p>
<ul>
<li>Smoother rate limiting</li>
<li>No burst issues</li>
</ul>
<p><strong>Cons:</strong></p>
<ul>
<li>More complex</li>
<li>Higher memory usage</li>
</ul>
<p><strong>Implementation (Redis):</strong></p>
<pre><code class="language-javascript">const Redis = require('ioredis');
const redis = new Redis();

async function slidingWindowRateLimit(userId, limit, windowMs) {
  const key = `ratelimit:${userId}`;
  const now = Date.now();
  const windowStart = now - windowMs;

  // Start transaction
  const pipeline = redis.pipeline();

  // Remove old entries
  pipeline.zremrangebyscore(key, 0, windowStart);

  // Count requests in window
  pipeline.zcard(key);

  // Add current request
  pipeline.zadd(key, now, `${now}-${Math.random()}`);

  // Set expiry
  pipeline.expire(key, Math.ceil(windowMs / 1000));

  const results = await pipeline.exec();
  const count = results[1][1];

  if (count &gt;= limit) {
    throw new Error('Rate limit exceeded');
  }

  return {
    allowed: true,
    remaining: limit - count - 1
  };
}

// Middleware
app.use(async (req, res, next) =&gt; {
  try {
    const userId = req.user?.id || req.ip;
    const result = await slidingWindowRateLimit(userId, 100, 60000);

    res.set({
      'X-RateLimit-Limit': 100,
      'X-RateLimit-Remaining': result.remaining
    });

    next();
  } catch (error) {
    res.status(429).json({
      error: 'Rate limit exceeded'
    });
  }
});
</code></pre>
<h4 id="3-token-bucket"><a class="header" href="#3-token-bucket">3. Token Bucket</a></h4>
<p><strong>Algorithm:</strong> Bucket fills with tokens at fixed rate. Each request consumes a token.</p>
<pre><code>Bucket capacity: 100 tokens
Refill rate: 10 tokens/second
Request: Consumes 1 token
</code></pre>
<p><strong>Pros:</strong></p>
<ul>
<li>Allows short bursts</li>
<li>Smooth long-term rate</li>
<li>Flexible</li>
</ul>
<p><strong>Cons:</strong></p>
<ul>
<li>Complex implementation</li>
</ul>
<p><strong>Implementation:</strong></p>
<pre><code class="language-javascript">class TokenBucket {
  constructor(capacity, refillRate) {
    this.capacity = capacity;
    this.tokens = capacity;
    this.refillRate = refillRate;  // tokens per second
    this.lastRefill = Date.now();
  }

  refill() {
    const now = Date.now();
    const timePassed = (now - this.lastRefill) / 1000;  // seconds
    const tokensToAdd = timePassed * this.refillRate;

    this.tokens = Math.min(this.capacity, this.tokens + tokensToAdd);
    this.lastRefill = now;
  }

  tryConsume(tokens = 1) {
    this.refill();

    if (this.tokens &gt;= tokens) {
      this.tokens -= tokens;
      return true;
    }

    return false;
  }

  getAvailableTokens() {
    this.refill();
    return Math.floor(this.tokens);
  }
}

// Usage
const buckets = new Map();

app.use((req, res, next) =&gt; {
  const userId = req.user?.id || req.ip;

  if (!buckets.has(userId)) {
    buckets.set(userId, new TokenBucket(100, 10));  // 100 capacity, 10/sec
  }

  const bucket = buckets.get(userId);

  if (bucket.tryConsume(1)) {
    res.set({
      'X-RateLimit-Limit': 100,
      'X-RateLimit-Remaining': bucket.getAvailableTokens()
    });
    next();
  } else {
    res.status(429).json({
      error: 'Rate limit exceeded',
      retryAfter: Math.ceil((1 - bucket.tokens) / bucket.refillRate)
    });
  }
});
</code></pre>
<h4 id="4-leaky-bucket"><a class="header" href="#4-leaky-bucket">4. Leaky Bucket</a></h4>
<p><strong>Algorithm:</strong> Requests enter bucket and leak out at constant rate.</p>
<pre><code>Bucket capacity: 100 requests
Leak rate: 10 requests/second
Incoming requests queue up
</code></pre>
<p><strong>Pros:</strong></p>
<ul>
<li>Smooth output rate</li>
<li>Good for protecting downstream services</li>
</ul>
<p><strong>Cons:</strong></p>
<ul>
<li>Requests may queue (latency)</li>
<li>Complex implementation</li>
</ul>
<h3 id="rate-limit-tiers"><a class="header" href="#rate-limit-tiers">Rate Limit Tiers</a></h3>
<h4 id="different-limits-for-different-users"><a class="header" href="#different-limits-for-different-users">Different Limits for Different Users</a></h4>
<pre><code class="language-javascript">function getRateLimit(user) {
  if (!user) {
    return { limit: 10, window: 60000 };      // Anonymous: 10/min
  }

  switch (user.tier) {
    case 'free':
      return { limit: 100, window: 60000 };   // Free: 100/min
    case 'pro':
      return { limit: 1000, window: 60000 };  // Pro: 1000/min
    case 'enterprise':
      return { limit: 10000, window: 60000 }; // Enterprise: 10000/min
    default:
      return { limit: 100, window: 60000 };
  }
}

app.use(async (req, res, next) =&gt; {
  const limits = getRateLimit(req.user);
  const userId = req.user?.id || req.ip;

  const allowed = await checkRateLimit(userId, limits.limit, limits.window);

  if (!allowed) {
    return res.status(429).json({
      error: 'Rate limit exceeded',
      tier: req.user?.tier || 'anonymous',
      limit: limits.limit
    });
  }

  res.set({
    'X-RateLimit-Limit': limits.limit,
    'X-RateLimit-Tier': req.user?.tier || 'anonymous'
  });

  next();
});
</code></pre>
<h3 id="rate-limit-by-endpoint"><a class="header" href="#rate-limit-by-endpoint">Rate Limit by Endpoint</a></h3>
<pre><code class="language-javascript">// Different limits for different endpoints
const authLimiter = rateLimit({
  windowMs: 15 * 60 * 1000,  // 15 minutes
  max: 5,                     // 5 requests
  message: 'Too many login attempts'
});

const apiLimiter = rateLimit({
  windowMs: 60 * 1000,  // 1 minute
  max: 100              // 100 requests
});

const uploadLimiter = rateLimit({
  windowMs: 60 * 60 * 1000,  // 1 hour
  max: 10                     // 10 uploads
});

app.post('/auth/login', authLimiter, loginHandler);
app.use('/api', apiLimiter);
app.post('/upload', uploadLimiter, uploadHandler);
</code></pre>
<h3 id="rate-limiting-best-practices"><a class="header" href="#rate-limiting-best-practices">Rate Limiting Best Practices</a></h3>
<h4 id="1-return-proper-headers"><a class="header" href="#1-return-proper-headers">1. Return Proper Headers</a></h4>
<pre><code class="language-http">X-RateLimit-Limit: 100
X-RateLimit-Remaining: 75
X-RateLimit-Reset: 1699876800
Retry-After: 60
</code></pre>
<pre><code class="language-javascript">res.set({
  'X-RateLimit-Limit': limit,
  'X-RateLimit-Remaining': remaining,
  'X-RateLimit-Reset': Math.ceil(resetTime / 1000),
  'Retry-After': retryAfter
});
</code></pre>
<h4 id="2-provide-clear-error-messages"><a class="header" href="#2-provide-clear-error-messages">2. Provide Clear Error Messages</a></h4>
<pre><code class="language-json">{
  "error": "Rate limit exceeded",
  "message": "You have exceeded the rate limit of 100 requests per minute",
  "limit": 100,
  "windowMs": 60000,
  "retryAfter": 45,
  "resetAt": "2023-11-15T10:00:00Z"
}
</code></pre>
<h4 id="3-document-rate-limits"><a class="header" href="#3-document-rate-limits">3. Document Rate Limits</a></h4>
<pre><code class="language-markdown"># Rate Limits

## Free Tier
- 100 requests/minute
- 5,000 requests/day

## Pro Tier
- 1,000 requests/minute
- 50,000 requests/day

## Enterprise Tier
- 10,000 requests/minute
- Unlimited daily requests

## Endpoint-Specific Limits
- POST /auth/login: 5 requests/15 minutes
- POST /upload: 10 requests/hour
</code></pre>
<h4 id="4-use-distributed-rate-limiting"><a class="header" href="#4-use-distributed-rate-limiting">4. Use Distributed Rate Limiting</a></h4>
<pre><code class="language-javascript">// Redis-based distributed rate limiting
const Redis = require('ioredis');
const redis = new Redis();

async function checkRateLimit(key, limit, window) {
  const current = await redis.incr(key);

  if (current === 1) {
    await redis.expire(key, Math.ceil(window / 1000));
  }

  return {
    allowed: current &lt;= limit,
    remaining: Math.max(0, limit - current),
    current
  };
}
</code></pre>
<hr>
<h2 id="error-handling"><a class="header" href="#error-handling">Error Handling</a></h2>
<p>Consistent, informative error handling improves API usability and debugging.</p>
<h3 id="error-response-format"><a class="header" href="#error-response-format">Error Response Format</a></h3>
<h4 id="standard-error-response"><a class="header" href="#standard-error-response">Standard Error Response</a></h4>
<pre><code class="language-json">{
  "error": {
    "code": "USER_NOT_FOUND",
    "message": "User with ID 123 was not found",
    "details": {
      "userId": 123
    },
    "timestamp": "2023-11-15T10:00:00Z",
    "path": "/users/123",
    "requestId": "abc-123-def-456"
  }
}
</code></pre>
<h4 id="implementation"><a class="header" href="#implementation">Implementation</a></h4>
<pre><code class="language-javascript">class APIError extends Error {
  constructor(code, message, statusCode = 500, details = {}) {
    super(message);
    this.code = code;
    this.statusCode = statusCode;
    this.details = details;
  }

  toJSON() {
    return {
      error: {
        code: this.code,
        message: this.message,
        details: this.details,
        timestamp: new Date().toISOString()
      }
    };
  }
}

// Error handler middleware
app.use((err, req, res, next) =&gt; {
  if (err instanceof APIError) {
    return res.status(err.statusCode).json({
      ...err.toJSON(),
      path: req.path,
      requestId: req.id
    });
  }

  // Generic error
  console.error('Unexpected error:', err);
  res.status(500).json({
    error: {
      code: 'INTERNAL_SERVER_ERROR',
      message: 'An unexpected error occurred',
      requestId: req.id
    }
  });
});

// Usage
app.get('/users/:id', async (req, res, next) =&gt; {
  const user = await db.getUser(req.params.id);

  if (!user) {
    throw new APIError(
      'USER_NOT_FOUND',
      `User with ID ${req.params.id} was not found`,
      404,
      { userId: req.params.id }
    );
  }

  res.json(user);
});
</code></pre>
<h3 id="common-error-codes"><a class="header" href="#common-error-codes">Common Error Codes</a></h3>
<pre><code class="language-javascript">const ErrorCodes = {
  // Authentication &amp; Authorization
  UNAUTHORIZED: 'UNAUTHORIZED',
  FORBIDDEN: 'FORBIDDEN',
  INVALID_TOKEN: 'INVALID_TOKEN',
  TOKEN_EXPIRED: 'TOKEN_EXPIRED',

  // Validation
  VALIDATION_ERROR: 'VALIDATION_ERROR',
  INVALID_INPUT: 'INVALID_INPUT',
  MISSING_REQUIRED_FIELD: 'MISSING_REQUIRED_FIELD',

  // Resources
  RESOURCE_NOT_FOUND: 'RESOURCE_NOT_FOUND',
  RESOURCE_ALREADY_EXISTS: 'RESOURCE_ALREADY_EXISTS',
  RESOURCE_CONFLICT: 'RESOURCE_CONFLICT',

  // Rate Limiting
  RATE_LIMIT_EXCEEDED: 'RATE_LIMIT_EXCEEDED',

  // Server Errors
  INTERNAL_SERVER_ERROR: 'INTERNAL_SERVER_ERROR',
  SERVICE_UNAVAILABLE: 'SERVICE_UNAVAILABLE',
  DATABASE_ERROR: 'DATABASE_ERROR',
  EXTERNAL_SERVICE_ERROR: 'EXTERNAL_SERVICE_ERROR'
};
</code></pre>
<h3 id="validation-errors"><a class="header" href="#validation-errors">Validation Errors</a></h3>
<pre><code class="language-json">{
  "error": {
    "code": "VALIDATION_ERROR",
    "message": "Request validation failed",
    "details": {
      "email": {
        "value": "invalid-email",
        "message": "Must be a valid email address",
        "rule": "email"
      },
      "age": {
        "value": -5,
        "message": "Must be a positive number",
        "rule": "min",
        "params": { "min": 0 }
      }
    }
  }
}
</code></pre>
<p><strong>Implementation:</strong></p>
<pre><code class="language-javascript">const Joi = require('joi');

const userSchema = Joi.object({
  name: Joi.string().required(),
  email: Joi.string().email().required(),
  age: Joi.number().min(0).max(150)
});

app.post('/users', async (req, res, next) =&gt; {
  const { error, value } = userSchema.validate(req.body, {
    abortEarly: false
  });

  if (error) {
    const details = {};
    error.details.forEach(err =&gt; {
      details[err.path[0]] = {
        value: err.context.value,
        message: err.message,
        rule: err.type
      };
    });

    return res.status(422).json({
      error: {
        code: 'VALIDATION_ERROR',
        message: 'Request validation failed',
        details
      }
    });
  }

  // Process valid data
  const user = await createUser(value);
  res.status(201).json(user);
});
</code></pre>
<h3 id="error-handling-best-practices"><a class="header" href="#error-handling-best-practices">Error Handling Best Practices</a></h3>
<h4 id="1-never-expose-internal-details"><a class="header" href="#1-never-expose-internal-details">1. Never Expose Internal Details</a></h4>
<pre><code class="language-javascript">// ❌ BAD - Exposes stack trace and internal paths
{
  "error": "Error: ENOENT: no such file or directory, open '/var/app/data/user-123.json'",
  "stack": "Error: ENOENT...\n    at Object.openSync (fs.js:476:3)\n    ..."
}

// ✅ GOOD - Generic message, log details server-side
{
  "error": {
    "code": "USER_NOT_FOUND",
    "message": "User not found",
    "requestId": "abc-123"
  }
}

// Server-side logging
console.error('File read error:', {
  error: err.message,
  stack: err.stack,
  path: filepath,
  requestId: req.id,
  userId: req.user?.id
});
</code></pre>
<h4 id="2-provide-actionable-messages"><a class="header" href="#2-provide-actionable-messages">2. Provide Actionable Messages</a></h4>
<pre><code class="language-javascript">// ❌ BAD - Vague
{
  "error": "Invalid input"
}

// ✅ GOOD - Specific and actionable
{
  "error": {
    "code": "INVALID_EMAIL",
    "message": "The email address 'user@invalid' is not valid. Please provide a valid email address (e.g., user@example.com)",
    "field": "email",
    "value": "user@invalid"
  }
}
</code></pre>
<h4 id="3-use-consistent-format"><a class="header" href="#3-use-consistent-format">3. Use Consistent Format</a></h4>
<pre><code class="language-javascript">// Always use the same structure
function formatError(code, message, statusCode, details = {}) {
  return {
    error: {
      code,
      message,
      ...(Object.keys(details).length &gt; 0 &amp;&amp; { details }),
      timestamp: new Date().toISOString()
    }
  };
}

// Validation error
res.status(422).json(formatError(
  'VALIDATION_ERROR',
  'Validation failed',
  422,
  validationErrors
));

// Not found error
res.status(404).json(formatError(
  'NOT_FOUND',
  'Resource not found',
  404
));
</code></pre>
<h4 id="4-include-request-id-for-debugging"><a class="header" href="#4-include-request-id-for-debugging">4. Include Request ID for Debugging</a></h4>
<pre><code class="language-javascript">const { v4: uuidv4 } = require('uuid');

// Add request ID middleware
app.use((req, res, next) =&gt; {
  req.id = uuidv4();
  res.set('X-Request-ID', req.id);
  next();
});

// Include in error responses
app.use((err, req, res, next) =&gt; {
  res.status(err.statusCode || 500).json({
    error: {
      code: err.code,
      message: err.message,
      requestId: req.id
    }
  });
});

// Log with request ID
console.error(`[${req.id}] Error:`, err);
</code></pre>
<h4 id="5-handle-different-error-types"><a class="header" href="#5-handle-different-error-types">5. Handle Different Error Types</a></h4>
<pre><code class="language-javascript">app.use((err, req, res, next) =&gt; {
  // Validation errors
  if (err.name === 'ValidationError') {
    return res.status(422).json(formatValidationError(err));
  }

  // Database errors
  if (err.name === 'SequelizeUniqueConstraintError') {
    return res.status(409).json({
      error: {
        code: 'DUPLICATE_ENTRY',
        message: 'A record with this value already exists',
        field: err.errors[0].path
      }
    });
  }

  // JWT errors
  if (err.name === 'JsonWebTokenError') {
    return res.status(401).json({
      error: {
        code: 'INVALID_TOKEN',
        message: 'Invalid authentication token'
      }
    });
  }

  if (err.name === 'TokenExpiredError') {
    return res.status(401).json({
      error: {
        code: 'TOKEN_EXPIRED',
        message: 'Authentication token has expired'
      }
    });
  }

  // Default
  res.status(500).json({
    error: {
      code: 'INTERNAL_SERVER_ERROR',
      message: 'An unexpected error occurred',
      requestId: req.id
    }
  });
});
</code></pre>
<hr>
<h2 id="authentication-and-authorization"><a class="header" href="#authentication-and-authorization">Authentication and Authorization</a></h2>
<p>See also: <a href="../security/oauth2.html">OAuth 2.0</a>, <a href="../security/jwt.html">JWT</a></p>
<h3 id="authentication-methods"><a class="header" href="#authentication-methods">Authentication Methods</a></h3>
<h4 id="1-api-keys"><a class="header" href="#1-api-keys">1. API Keys</a></h4>
<pre><code class="language-http">GET /users HTTP/1.1
X-API-Key: sk_live_abc123def456
</code></pre>
<p><strong>Pros:</strong></p>
<ul>
<li>Simple</li>
<li>Easy to implement</li>
<li>Good for server-to-server</li>
</ul>
<p><strong>Cons:</strong></p>
<ul>
<li>No expiration</li>
<li>Hard to rotate</li>
<li>All-or-nothing permissions</li>
</ul>
<p><strong>Implementation:</strong></p>
<pre><code class="language-javascript">app.use('/api', (req, res, next) =&gt; {
  const apiKey = req.headers['x-api-key'];

  if (!apiKey) {
    return res.status(401).json({
      error: 'API key required'
    });
  }

  const key = await db.query(
    'SELECT * FROM api_keys WHERE key = $1 AND active = true',
    [apiKey]
  );

  if (!key.rows[0]) {
    return res.status(401).json({
      error: 'Invalid API key'
    });
  }

  req.apiKey = key.rows[0];
  req.user = await db.getUser(key.rows[0].user_id);
  next();
});
</code></pre>
<h4 id="2-jwt-json-web-tokens"><a class="header" href="#2-jwt-json-web-tokens">2. JWT (JSON Web Tokens)</a></h4>
<pre><code class="language-http">GET /users HTTP/1.1
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
</code></pre>
<p><strong>Pros:</strong></p>
<ul>
<li>Stateless</li>
<li>Contains user info</li>
<li>Expiration built-in</li>
<li>Industry standard</li>
</ul>
<p><strong>Cons:</strong></p>
<ul>
<li>Can’t revoke easily</li>
<li>Token size</li>
<li>Need secure storage</li>
</ul>
<p><strong>Implementation:</strong></p>
<pre><code class="language-javascript">const jwt = require('jsonwebtoken');

// Generate token
app.post('/auth/login', async (req, res) =&gt; {
  const { email, password } = req.body;

  const user = await authenticateUser(email, password);
  if (!user) {
    return res.status(401).json({ error: 'Invalid credentials' });
  }

  const token = jwt.sign(
    {
      userId: user.id,
      email: user.email,
      role: user.role
    },
    process.env.JWT_SECRET,
    { expiresIn: '1h' }
  );

  res.json({ token, expiresIn: 3600 });
});

// Verify token middleware
function authenticateJWT(req, res, next) {
  const authHeader = req.headers.authorization;

  if (!authHeader || !authHeader.startsWith('Bearer ')) {
    return res.status(401).json({ error: 'Token required' });
  }

  const token = authHeader.substring(7);

  try {
    const payload = jwt.verify(token, process.env.JWT_SECRET);
    req.user = payload;
    next();
  } catch (error) {
    if (error.name === 'TokenExpiredError') {
      return res.status(401).json({ error: 'Token expired' });
    }
    return res.status(401).json({ error: 'Invalid token' });
  }
}

app.get('/profile', authenticateJWT, (req, res) =&gt; {
  res.json({ user: req.user });
});
</code></pre>
<h4 id="3-oauth-20"><a class="header" href="#3-oauth-20">3. OAuth 2.0</a></h4>
<p>See <a href="../security/oauth2.html">OAuth 2.0 Guide</a> for complete implementation.</p>
<h3 id="authorization"><a class="header" href="#authorization">Authorization</a></h3>
<h4 id="role-based-access-control-rbac"><a class="header" href="#role-based-access-control-rbac">Role-Based Access Control (RBAC)</a></h4>
<pre><code class="language-javascript">const roles = {
  admin: ['read', 'write', 'delete', 'manage_users'],
  moderator: ['read', 'write', 'delete'],
  user: ['read', 'write'],
  guest: ['read']
};

function authorize(...requiredPermissions) {
  return (req, res, next) =&gt; {
    const userRole = req.user?.role || 'guest';
    const userPermissions = roles[userRole] || [];

    const hasPermission = requiredPermissions.every(permission =&gt;
      userPermissions.includes(permission)
    );

    if (!hasPermission) {
      return res.status(403).json({
        error: 'Insufficient permissions',
        required: requiredPermissions,
        current: userPermissions
      });
    }

    next();
  };
}

// Usage
app.get('/posts', authenticateJWT, authorize('read'), getPosts);
app.post('/posts', authenticateJWT, authorize('write'), createPost);
app.delete('/posts/:id', authenticateJWT, authorize('delete'), deletePost);
app.get('/admin/users', authenticateJWT, authorize('manage_users'), getUsers);
</code></pre>
<h4 id="resource-based-authorization"><a class="header" href="#resource-based-authorization">Resource-Based Authorization</a></h4>
<pre><code class="language-javascript">app.delete('/posts/:id', authenticateJWT, async (req, res) =&gt; {
  const post = await db.getPost(req.params.id);

  if (!post) {
    return res.status(404).json({ error: 'Post not found' });
  }

  // Check ownership or admin role
  const canDelete = post.authorId === req.user.userId ||
                    req.user.role === 'admin';

  if (!canDelete) {
    return res.status(403).json({
      error: 'You can only delete your own posts'
    });
  }

  await db.deletePost(req.params.id);
  res.status(204).send();
});
</code></pre>
<hr>
<h2 id="hateoas-principles"><a class="header" href="#hateoas-principles">HATEOAS Principles</a></h2>
<p>HATEOAS (Hypermedia As The Engine Of Application State) is a constraint of REST that says clients interact with an application entirely through hypermedia provided dynamically by the application.</p>
<h3 id="basic-hateoas"><a class="header" href="#basic-hateoas">Basic HATEOAS</a></h3>
<pre><code class="language-json">{
  "id": 123,
  "name": "John Doe",
  "email": "john@example.com",
  "_links": {
    "self": {
      "href": "/users/123"
    },
    "posts": {
      "href": "/users/123/posts"
    },
    "followers": {
      "href": "/users/123/followers"
    },
    "following": {
      "href": "/users/123/following"
    }
  }
}
</code></pre>
<h3 id="hal-hypertext-application-language"><a class="header" href="#hal-hypertext-application-language">HAL (Hypertext Application Language)</a></h3>
<pre><code class="language-json">{
  "_links": {
    "self": { "href": "/orders/123" },
    "customer": { "href": "/customers/456" },
    "items": { "href": "/orders/123/items" }
  },
  "id": 123,
  "total": 99.99,
  "status": "pending",
  "_embedded": {
    "items": [
      {
        "_links": {
          "self": { "href": "/items/789" }
        },
        "id": 789,
        "name": "Product A",
        "price": 49.99
      }
    ]
  }
}
</code></pre>
<h3 id="implementation-1"><a class="header" href="#implementation-1">Implementation</a></h3>
<pre><code class="language-javascript">function addLinks(resource, type, req) {
  const baseUrl = `${req.protocol}://${req.get('host')}`;

  resource._links = {
    self: { href: `${baseUrl}${req.path}` }
  };

  switch (type) {
    case 'user':
      resource._links.posts = {
        href: `${baseUrl}/users/${resource.id}/posts`
      };
      resource._links.followers = {
        href: `${baseUrl}/users/${resource.id}/followers`
      };
      break;

    case 'post':
      resource._links.author = {
        href: `${baseUrl}/users/${resource.authorId}`
      };
      resource._links.comments = {
        href: `${baseUrl}/posts/${resource.id}/comments`
      };
      break;
  }

  return resource;
}

app.get('/users/:id', async (req, res) =&gt; {
  const user = await db.getUser(req.params.id);
  res.json(addLinks(user, 'user', req));
});
</code></pre>
<hr>
<h2 id="api-documentation"><a class="header" href="#api-documentation">API Documentation</a></h2>
<p>Good documentation is crucial for API adoption and developer experience.</p>
<h3 id="openapiswagger"><a class="header" href="#openapiswagger">OpenAPI/Swagger</a></h3>
<pre><code class="language-yaml">openapi: 3.0.0
info:
  title: User API
  version: 1.0.0
  description: API for managing users

paths:
  /users:
    get:
      summary: List users
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            default: 20
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/User'

    post:
      summary: Create user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateUserRequest'
      responses:
        '201':
          description: User created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
        '422':
          description: Validation error

components:
  schemas:
    User:
      type: object
      properties:
        id:
          type: integer
        name:
          type: string
        email:
          type: string

    CreateUserRequest:
      type: object
      required:
        - name
        - email
      properties:
        name:
          type: string
        email:
          type: string
          format: email
</code></pre>
<h3 id="generating-openapi-docs"><a class="header" href="#generating-openapi-docs">Generating OpenAPI Docs</a></h3>
<pre><code class="language-javascript">const swaggerJsdoc = require('swagger-jsdoc');
const swaggerUi = require('swagger-ui-express');

const options = {
  definition: {
    openapi: '3.0.0',
    info: {
      title: 'User API',
      version: '1.0.0',
    },
  },
  apis: ['./routes/*.js'],
};

const specs = swaggerJsdoc(options);
app.use('/api-docs', swaggerUi.serve, swaggerUi.setup(specs));

/**
 * @swagger
 * /users:
 *   get:
 *     summary: Retrieve users
 *     responses:
 *       200:
 *         description: List of users
 */
app.get('/users', getUsers);
</code></pre>
<hr>
<h2 id="idempotency"><a class="header" href="#idempotency">Idempotency</a></h2>
<p>Idempotent operations produce the same result regardless of how many times they’re executed.</p>
<h3 id="idempotent-methods"><a class="header" href="#idempotent-methods">Idempotent Methods</a></h3>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Method</th><th>Idempotent</th><th>Example</th></tr>
</thead>
<tbody>
<tr><td>GET</td><td>Yes</td><td>Multiple reads return same data</td></tr>
<tr><td>PUT</td><td>Yes</td><td>Replacing resource produces same state</td></tr>
<tr><td>DELETE</td><td>Yes</td><td>Deleting already-deleted resource is safe</td></tr>
<tr><td>POST</td><td>No</td><td>Multiple creates = multiple resources</td></tr>
<tr><td>PATCH</td><td>Sometimes</td><td>Depends on implementation</td></tr>
</tbody>
</table>
</div>
<h3 id="implementing-idempotency-for-post"><a class="header" href="#implementing-idempotency-for-post">Implementing Idempotency for POST</a></h3>
<pre><code class="language-javascript">const idempotencyCache = new Map();

app.post('/orders', async (req, res) =&gt; {
  const idempotencyKey = req.headers['idempotency-key'];

  if (!idempotencyKey) {
    return res.status(400).json({
      error: 'Idempotency-Key header required'
    });
  }

  // Check cache
  if (idempotencyCache.has(idempotencyKey)) {
    const cachedResponse = idempotencyCache.get(idempotencyKey);
    return res.status(cachedResponse.status).json(cachedResponse.body);
  }

  // Process request
  const order = await createOrder(req.body);

  // Cache response
  const response = { status: 201, body: order };
  idempotencyCache.set(idempotencyKey, response);

  // Expire after 24 hours
  setTimeout(() =&gt; {
    idempotencyCache.delete(idempotencyKey);
  }, 24 * 60 * 60 * 1000);

  res.status(201).json(order);
});
</code></pre>
<hr>
<h2 id="caching-strategies"><a class="header" href="#caching-strategies">Caching Strategies</a></h2>
<h3 id="etag"><a class="header" href="#etag">ETag</a></h3>
<pre><code class="language-http">GET /users/123 HTTP/1.1

HTTP/1.1 200 OK
ETag: "33a64df551425fcc55e4d42a148795d9f25f89d4"

{ "id": 123, "name": "John" }
</code></pre>
<pre><code class="language-http">GET /users/123 HTTP/1.1
If-None-Match: "33a64df551425fcc55e4d42a148795d9f25f89d4"

HTTP/1.1 304 Not Modified
</code></pre>
<h3 id="cache-control"><a class="header" href="#cache-control">Cache-Control</a></h3>
<pre><code class="language-http">HTTP/1.1 200 OK
Cache-Control: public, max-age=3600
Expires: Wed, 15 Nov 2023 11:00:00 GMT
</code></pre>
<hr>
<h2 id="webhooks-vs-polling"><a class="header" href="#webhooks-vs-polling">Webhooks vs Polling</a></h2>
<h3 id="polling"><a class="header" href="#polling">Polling</a></h3>
<pre><code class="language-javascript">// Client polls every 30 seconds
setInterval(async () =&gt; {
  const status = await fetch('/api/job/123/status');
  if (status.completed) {
    // Process result
  }
}, 30000);
</code></pre>
<h3 id="webhooks"><a class="header" href="#webhooks">Webhooks</a></h3>
<pre><code class="language-javascript">// Server notifies client when ready
app.post('/jobs', async (req, res) =&gt; {
  const job = await createJob(req.body);

  // Process asynchronously
  processJob(job.id).then(result =&gt; {
    // Notify via webhook
    fetch(req.body.webhookUrl, {
      method: 'POST',
      body: JSON.stringify({ jobId: job.id, result })
    });
  });

  res.status(202).json({ jobId: job.id });
});
</code></pre>
<hr>
<h2 id="graphql-vs-rest-trade-offs"><a class="header" href="#graphql-vs-rest-trade-offs">GraphQL vs REST Trade-offs</a></h2>
<p>See also: <a href="graphql.html">GraphQL Guide</a>, <a href="rest_apis.html">REST APIs</a></p>
<div class="table-wrapper">
<table>
<thead>
<tr><th>Aspect</th><th>REST</th><th>GraphQL</th></tr>
</thead>
<tbody>
<tr><td><strong>Endpoints</strong></td><td>Multiple</td><td>Single</td></tr>
<tr><td><strong>Data Fetching</strong></td><td>Fixed responses</td><td>Client specifies</td></tr>
<tr><td><strong>Over-fetching</strong></td><td>Common</td><td>Eliminated</td></tr>
<tr><td><strong>Under-fetching</strong></td><td>Requires multiple requests</td><td>Single request</td></tr>
<tr><td><strong>Caching</strong></td><td>Easy (HTTP)</td><td>Complex</td></tr>
<tr><td><strong>Learning Curve</strong></td><td>Low</td><td>Moderate</td></tr>
<tr><td><strong>Tooling</strong></td><td>Mature</td><td>Growing</td></tr>
</tbody>
</table>
</div>
<hr>
<h2 id="grpc-use-cases"><a class="header" href="#grpc-use-cases">gRPC Use Cases</a></h2>
<p>See also: <a href="grpc.html">gRPC Guide</a></p>
<p><strong>When to Use gRPC:</strong></p>
<ul>
<li>Microservices communication</li>
<li>Real-time streaming</li>
<li>Performance-critical applications</li>
<li>Polyglot environments</li>
</ul>
<p><strong>When to Use REST:</strong></p>
<ul>
<li>Public APIs</li>
<li>Browser clients</li>
<li>Simple CRUD operations</li>
</ul>
<hr>
<h2 id="api-gateway-patterns"><a class="header" href="#api-gateway-patterns">API Gateway Patterns</a></h2>
<p>API gateways provide a single entry point for API requests.</p>
<p><strong>Features:</strong></p>
<ul>
<li>Request routing</li>
<li>Authentication/Authorization</li>
<li>Rate limiting</li>
<li>Caching</li>
<li>Protocol translation</li>
<li>Analytics</li>
</ul>
<pre><code>Client → API Gateway → [Microservice A, Microservice B, Microservice C]
</code></pre>
<hr>
<h2 id="backward-compatibility"><a class="header" href="#backward-compatibility">Backward Compatibility</a></h2>
<p><strong>Non-Breaking Changes:</strong></p>
<ul>
<li>Adding optional fields</li>
<li>Adding new endpoints</li>
<li>Adding optional parameters</li>
</ul>
<p><strong>Breaking Changes:</strong></p>
<ul>
<li>Removing fields</li>
<li>Renaming fields</li>
<li>Changing field types</li>
<li>Removing endpoints</li>
</ul>
<hr>
<h2 id="deprecation-strategies"><a class="header" href="#deprecation-strategies">Deprecation Strategies</a></h2>
<pre><code class="language-http">HTTP/1.1 200 OK
Sunset: Sat, 31 Dec 2023 23:59:59 GMT
Deprecation: true
Link: &lt;/v2/users&gt;; rel="successor-version"
Warning: 299 - "This endpoint is deprecated"
</code></pre>
<hr>
<h2 id="best-practices-summary"><a class="header" href="#best-practices-summary">Best Practices Summary</a></h2>
<ol>
<li><strong>Use nouns for resources, not verbs</strong></li>
<li><strong>Proper HTTP methods and status codes</strong></li>
<li><strong>Versioning from day one</strong></li>
<li><strong>Comprehensive error handling</strong></li>
<li><strong>Authentication and authorization</strong></li>
<li><strong>Rate limiting</strong></li>
<li><strong>Pagination for large datasets</strong></li>
<li><strong>Caching when appropriate</strong></li>
<li><strong>Thorough documentation</strong></li>
<li><strong>Consistent response formats</strong></li>
</ol>
<hr>
<h2 id="references"><a class="header" href="#references">References</a></h2>
<ul>
<li><a href="rest_apis.html">REST APIs</a></li>
<li><a href="graphql.html">GraphQL</a></li>
<li><a href="grpc.html">gRPC</a></li>
<li><a href="../security/oauth2.html">OAuth 2.0</a></li>
<li><a href="../security/jwt.html">JWT</a></li>
<li><a href="https://restfulapi.net/">RESTful API Design</a></li>
<li><a href="https://httpstat.us/">HTTP Status Codes</a></li>
<li><a href="https://swagger.io/specification/">OpenAPI Specification</a></li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../web_development/css.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg></span>
                            </a>

                            <a rel="next prefetch" href="../web_development/frontend_performance.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg></span>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../web_development/css.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg></span>
                    </a>

                    <a rel="next prefetch" href="../web_development/frontend_performance.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg></span>
                    </a>
            </nav>

        </div>

        <template id=fa-eye><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></template>
        <template id=fa-eye-slash><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L525.6 386.7c39.6-40.6 66.4-86.1 79.9-118.4c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C465.5 68.8 400.8 32 320 32c-68.2 0-125 26.3-169.3 60.8L38.8 5.1zM223.1 149.5C248.6 126.2 282.7 112 320 112c79.5 0 144 64.5 144 144c0 24.9-6.3 48.3-17.4 68.7L408 294.5c5.2-11.8 8-24.8 8-38.5c0-53-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6c0 10.2-2.4 19.8-6.6 28.3l-90.3-70.8zm223.1 298L373 389.9c-16.4 6.5-34.3 10.1-53 10.1c-79.5 0-144-64.5-144-144c0-6.9 .5-13.6 1.4-20.2L83.1 161.5C60.3 191.2 44 220.8 34.5 243.7c-3.3 7.9-3.3 16.7 0 24.6c14.9 35.7 46.2 87.7 93 131.1C174.5 443.2 239.2 480 320 480c47.8 0 89.9-12.9 126.2-32.5z"/></svg></span></template>
        <template id=fa-copy><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M502.6 70.63l-61.25-61.25C435.4 3.371 427.2 0 418.7 0H255.1c-35.35 0-64 28.66-64 64l.0195 256C192 355.4 220.7 384 256 384h192c35.2 0 64-28.8 64-64V93.25C512 84.77 508.6 76.63 502.6 70.63zM464 320c0 8.836-7.164 16-16 16H255.1c-8.838 0-16-7.164-16-16L239.1 64.13c0-8.836 7.164-16 16-16h128L384 96c0 17.67 14.33 32 32 32h47.1V320zM272 448c0 8.836-7.164 16-16 16H63.1c-8.838 0-16-7.164-16-16L47.98 192.1c0-8.836 7.164-16 16-16H160V128H63.99c-35.35 0-64 28.65-64 64l.0098 256C.002 483.3 28.66 512 64 512h192c35.2 0 64-28.8 64-64v-32h-47.1L272 448z"/></svg></span></template>
        <template id=fa-play><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"/></svg></span></template>
        <template id=fa-clock-rotate-left><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M75 75L41 41C25.9 25.9 0 36.6 0 57.9V168c0 13.3 10.7 24 24 24H134.1c21.4 0 32.1-25.9 17-41l-30.8-30.8C155 85.5 203 64 256 64c106 0 192 86 192 192s-86 192-192 192c-40.8 0-78.6-12.7-109.7-34.4c-14.5-10.1-34.4-6.6-44.6 7.9s-6.6 34.4 7.9 44.6C151.2 495 201.7 512 256 512c141.4 0 256-114.6 256-256S397.4 0 256 0C185.3 0 121.3 28.7 75 75zm181 53c-13.3 0-24 10.7-24 24V256c0 6.4 2.5 12.5 7 17l72 72c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-65-65V152c0-13.3-10.7-24-24-24z"/></svg></span></template>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr-ef4e11c1.min.js"></script>
        <script src="../mark-09e88c2c.min.js"></script>
        <script src="../searcher-c2a407aa.js"></script>

        <script src="../clipboard-1626706a.min.js"></script>
        <script src="../highlight-abc7f01d.js"></script>
        <script src="../book-a0b12cfe.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
