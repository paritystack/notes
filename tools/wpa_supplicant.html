<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>wpa_supplicant - My Notes</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">My Notes</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="wpa_supplicant"><a class="header" href="#wpa_supplicant">wpa_supplicant</a></h1>
<p>A comprehensive guide to wpa_supplicant, the IEEE 802.11 authentication daemon for WiFi client connectivity on Linux.</p>
<h2 id="table-of-contents"><a class="header" href="#table-of-contents">Table of Contents</a></h2>
<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#configuration-files">Configuration Files</a></li>
<li><a href="#basic-usage">Basic Usage</a></li>
<li><a href="#network-configuration">Network Configuration</a></li>
<li><a href="#command-line-interface">Command-Line Interface</a></li>
<li><a href="#wpa_cli-interactive-mode">wpa_cli Interactive Mode</a></li>
<li><a href="#advanced-configuration">Advanced Configuration</a></li>
<li><a href="#security-modes">Security Modes</a></li>
<li><a href="#enterprise-wifi-8021x">Enterprise WiFi (802.1X)</a></li>
<li><a href="#p2p-wifi-direct">P2P WiFi Direct</a></li>
<li><a href="#troubleshooting">Troubleshooting</a></li>
<li><a href="#integration-with-systemd">Integration with systemd</a></li>
<li><a href="#best-practices">Best Practices</a></li>
</ul>
<hr />
<h2 id="overview"><a class="header" href="#overview">Overview</a></h2>
<p><strong>wpa_supplicant</strong> is a WPA/WPA2/WPA3 supplicant for Linux and other UNIX-like operating systems. It handles WiFi authentication and association for client stations.</p>
<h3 id="key-features"><a class="header" href="#key-features">Key Features</a></h3>
<ul>
<li>WPA/WPA2/WPA3-Personal (PSK)</li>
<li>WPA/WPA2/WPA3-Enterprise (802.1X/EAP)</li>
<li>WEP (deprecated, for legacy networks)</li>
<li>Hotspot 2.0 (Passpoint)</li>
<li>WiFi Protected Setup (WPS)</li>
<li>WiFi Direct (P2P)</li>
<li>Automatic network selection</li>
<li>Dynamic reconfiguration via control interface</li>
</ul>
<h3 id="architecture"><a class="header" href="#architecture">Architecture</a></h3>
<pre><code>┌─────────────────────────────────────┐
│        User Space                   │
│                                     │
│  ┌──────────┐      ┌──────────┐   │
│  │  wpa_cli │      │ NetworkMgr│   │
│  └────┬─────┘      └────┬──────┘   │
│       │                 │           │
│       └────┬────────────┘           │
│            │ Control socket         │
│       ┌────▼──────────────┐         │
│       │  wpa_supplicant   │         │
│       └────┬──────────────┘         │
│            │ nl80211/WEXT           │
└────────────┼─────────────────────────┘
             │
┌────────────▼─────────────────────────┐
│        Kernel Space                  │
│  ┌──────────────────────────┐        │
│  │  cfg80211 / mac80211     │        │
│  └──────────┬───────────────┘        │
│             │                        │
│  ┌──────────▼───────────────┐        │
│  │    WiFi Driver           │        │
│  └──────────┬───────────────┘        │
└─────────────┼──────────────────────────┘
              │
       ┌──────▼──────┐
       │ WiFi Hardware│
       └─────────────┘
</code></pre>
<hr />
<h2 id="installation"><a class="header" href="#installation">Installation</a></h2>
<h3 id="debianubuntu"><a class="header" href="#debianubuntu">Debian/Ubuntu</a></h3>
<pre><code class="language-bash">sudo apt-get update
sudo apt-get install wpasupplicant

# Verify installation
wpa_supplicant -v
</code></pre>
<h3 id="fedorarhelcentos"><a class="header" href="#fedorarhelcentos">Fedora/RHEL/CentOS</a></h3>
<pre><code class="language-bash">sudo dnf install wpa_supplicant

# Or for older systems
sudo yum install wpa_supplicant
</code></pre>
<h3 id="arch-linux"><a class="header" href="#arch-linux">Arch Linux</a></h3>
<pre><code class="language-bash">sudo pacman -S wpa_supplicant
</code></pre>
<h3 id="build-from-source"><a class="header" href="#build-from-source">Build from Source</a></h3>
<pre><code class="language-bash"># Download
git clone git://w1.fi/srv/git/hostap.git
cd hostap/wpa_supplicant

# Configure
cp defconfig .config
# Edit .config to enable features

# Build
make

# Install
sudo make install
</code></pre>
<hr />
<h2 id="configuration-files"><a class="header" href="#configuration-files">Configuration Files</a></h2>
<h3 id="main-configuration-file"><a class="header" href="#main-configuration-file">Main Configuration File</a></h3>
<p><strong>Location:</strong> <code>/etc/wpa_supplicant/wpa_supplicant.conf</code></p>
<p><strong>Basic structure:</strong></p>
<pre><code class="language-conf"># Global settings
ctrl_interface=/var/run/wpa_supplicant
ctrl_interface_group=netdev
update_config=1
country=US

# Network configurations
network={
    ssid="MyNetwork"
    psk="password123"
}
</code></pre>
<h3 id="file-permissions"><a class="header" href="#file-permissions">File Permissions</a></h3>
<pre><code class="language-bash"># Secure the configuration file
sudo chmod 600 /etc/wpa_supplicant/wpa_supplicant.conf
sudo chown root:root /etc/wpa_supplicant/wpa_supplicant.conf
</code></pre>
<h3 id="global-parameters"><a class="header" href="#global-parameters">Global Parameters</a></h3>
<pre><code class="language-conf"># Control interface for wpa_cli
ctrl_interface=/var/run/wpa_supplicant

# Group that can access control interface
ctrl_interface_group=netdev

# Allow wpa_supplicant to update configuration
update_config=1

# Country code (affects regulatory domain)
country=US

# AP scanning mode
# 0 = driver takes care of scanning
# 1 = wpa_supplicant controls scanning (default)
# 2 = like 1, but use security policy
ap_scan=1

# Fast reauth for 802.1X
fast_reauth=1

# Enable P2P support
p2p_disabled=0
</code></pre>
<hr />
<h2 id="basic-usage"><a class="header" href="#basic-usage">Basic Usage</a></h2>
<h3 id="starting-wpa_supplicant"><a class="header" href="#starting-wpa_supplicant">Starting wpa_supplicant</a></h3>
<pre><code class="language-bash"># Basic usage
sudo wpa_supplicant -B -i wlan0 -c /etc/wpa_supplicant/wpa_supplicant.conf

# Options:
# -B: Run in background (daemon mode)
# -i: Network interface
# -c: Configuration file
# -D: Driver (nl80211, wext, etc.) - usually auto-detected
# -d: Enable debug output
# -dd: More verbose debug
</code></pre>
<h3 id="starting-with-debug-output"><a class="header" href="#starting-with-debug-output">Starting with Debug Output</a></h3>
<pre><code class="language-bash"># Foreground with debug
sudo wpa_supplicant -i wlan0 -c /etc/wpa_supplicant/wpa_supplicant.conf -d

# Even more verbose
sudo wpa_supplicant -i wlan0 -c /etc/wpa_supplicant/wpa_supplicant.conf -dd
</code></pre>
<h3 id="stopping-wpa_supplicant"><a class="header" href="#stopping-wpa_supplicant">Stopping wpa_supplicant</a></h3>
<pre><code class="language-bash"># Find process
ps aux | grep wpa_supplicant

# Kill process
sudo killall wpa_supplicant

# Or using systemd
sudo systemctl stop wpa_supplicant@wlan0
</code></pre>
<h3 id="manual-connection-workflow"><a class="header" href="#manual-connection-workflow">Manual Connection Workflow</a></h3>
<pre><code class="language-bash"># 1. Bring interface up
sudo ip link set wlan0 up

# 2. Start wpa_supplicant
sudo wpa_supplicant -B -i wlan0 -c /etc/wpa_supplicant/wpa_supplicant.conf

# 3. Wait for connection (check with wpa_cli)
wpa_cli -i wlan0 status

# 4. Get IP address
sudo dhclient wlan0
# Or
sudo dhcpcd wlan0
</code></pre>
<hr />
<h2 id="network-configuration"><a class="header" href="#network-configuration">Network Configuration</a></h2>
<h3 id="wpawpa2-personal-psk"><a class="header" href="#wpawpa2-personal-psk">WPA/WPA2-Personal (PSK)</a></h3>
<p><strong>ASCII passphrase:</strong></p>
<pre><code class="language-conf">network={
    ssid="MyWiFi"
    psk="MyPassword123"
    key_mgmt=WPA-PSK
    priority=1
}
</code></pre>
<p><strong>Pre-computed PSK (more secure):</strong></p>
<pre><code class="language-bash"># Generate PSK hash
wpa_passphrase "MyWiFi" "MyPassword123"

# Output:
network={
    ssid="MyWiFi"
    #psk="MyPassword123"
    psk=0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef
}
</code></pre>
<p><strong>In configuration file:</strong></p>
<pre><code class="language-conf">network={
    ssid="MyWiFi"
    psk=0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef
    key_mgmt=WPA-PSK
}
</code></pre>
<h3 id="wpa3-personal-sae"><a class="header" href="#wpa3-personal-sae">WPA3-Personal (SAE)</a></h3>
<pre><code class="language-conf">network={
    ssid="MyWiFi-WPA3"
    psk="MyPassword123"
    key_mgmt=SAE
    ieee80211w=2  # Required for WPA3 (PMF)
}
</code></pre>
<h3 id="open-network-no-security"><a class="header" href="#open-network-no-security">Open Network (No Security)</a></h3>
<pre><code class="language-conf">network={
    ssid="OpenWiFi"
    key_mgmt=NONE
}
</code></pre>
<h3 id="hidden-network"><a class="header" href="#hidden-network">Hidden Network</a></h3>
<pre><code class="language-conf">network={
    ssid="HiddenSSID"
    scan_ssid=1  # Enable active scanning
    psk="password"
    key_mgmt=WPA-PSK
}
</code></pre>
<h3 id="wep-deprecated"><a class="header" href="#wep-deprecated">WEP (Deprecated)</a></h3>
<pre><code class="language-conf">network={
    ssid="OldNetwork"
    key_mgmt=NONE
    wep_key0="1234567890"
    wep_tx_keyidx=0
}
</code></pre>
<h3 id="multiple-networks-with-priority"><a class="header" href="#multiple-networks-with-priority">Multiple Networks with Priority</a></h3>
<pre><code class="language-conf"># Home network - highest priority
network={
    ssid="HomeWiFi"
    psk="homepassword"
    priority=10
}

# Work network
network={
    ssid="WorkWiFi"
    psk="workpassword"
    priority=5
}

# Coffee shop - lowest priority
network={
    ssid="CoffeeShop"
    key_mgmt=NONE
    priority=1
}
</code></pre>
<h3 id="bssid-specific-configuration"><a class="header" href="#bssid-specific-configuration">BSSID-Specific Configuration</a></h3>
<pre><code class="language-conf"># Connect only to specific AP
network={
    ssid="MyWiFi"
    bssid=00:11:22:33:44:55
    psk="password"
}
</code></pre>
<hr />
<h2 id="command-line-interface"><a class="header" href="#command-line-interface">Command-Line Interface</a></h2>
<h3 id="wpa_cli---control-interface"><a class="header" href="#wpa_cli---control-interface">wpa_cli - Control Interface</a></h3>
<p><strong>Basic commands:</strong></p>
<pre><code class="language-bash"># Show status
wpa_cli -i wlan0 status

# Scan for networks
wpa_cli -i wlan0 scan
wpa_cli -i wlan0 scan_results

# List configured networks
wpa_cli -i wlan0 list_networks

# Add network
wpa_cli -i wlan0 add_network
# Returns: 0 (network ID)

# Set network parameters
wpa_cli -i wlan0 set_network 0 ssid '"MyWiFi"'
wpa_cli -i wlan0 set_network 0 psk '"password"'

# Enable network
wpa_cli -i wlan0 enable_network 0

# Select network
wpa_cli -i wlan0 select_network 0

# Save configuration
wpa_cli -i wlan0 save_config

# Remove network
wpa_cli -i wlan0 remove_network 0

# Disconnect
wpa_cli -i wlan0 disconnect

# Reconnect
wpa_cli -i wlan0 reconnect

# Reassociate
wpa_cli -i wlan0 reassociate
</code></pre>
<h3 id="quick-connection"><a class="header" href="#quick-connection">Quick Connection</a></h3>
<pre><code class="language-bash"># One-liner to connect
wpa_cli -i wlan0 &lt;&lt;EOF
add_network
set_network 0 ssid "MyWiFi"
set_network 0 psk "password"
enable_network 0
save_config
quit
EOF
</code></pre>
<hr />
<h2 id="wpa_cli-interactive-mode"><a class="header" href="#wpa_cli-interactive-mode">wpa_cli Interactive Mode</a></h2>
<h3 id="starting-interactive-mode"><a class="header" href="#starting-interactive-mode">Starting Interactive Mode</a></h3>
<pre><code class="language-bash">wpa_cli -i wlan0
</code></pre>
<p><strong>Interactive session:</strong></p>
<pre><code>wpa_cli v2.9
Copyright (c) 2004-2019, Jouni Malinen &lt;j@w1.fi&gt; and contributors

Interactive mode

&gt; status
bssid=00:11:22:33:44:55
freq=2437
ssid=MyWiFi
id=0
mode=station
pairwise_cipher=CCMP
group_cipher=CCMP
key_mgmt=WPA2-PSK
wpa_state=COMPLETED
ip_address=192.168.1.100
address=aa:bb:cc:dd:ee:ff

&gt; scan
OK
&gt; scan_results
bssid / frequency / signal level / flags / ssid
00:11:22:33:44:55       2437    -45     [WPA2-PSK-CCMP][ESS]    MyWiFi
aa:bb:cc:dd:ee:ff       2462    -67     [WPA2-PSK-CCMP][ESS]    NeighborWiFi

&gt; quit
</code></pre>
<h3 id="common-interactive-commands"><a class="header" href="#common-interactive-commands">Common Interactive Commands</a></h3>
<pre><code>status                  - Show connection status
scan                    - Trigger network scan
scan_results            - Show scan results
list_networks           - List configured networks
select_network &lt;id&gt;     - Select network
enable_network &lt;id&gt;     - Enable network
disable_network &lt;id&gt;    - Disable network
remove_network &lt;id&gt;     - Remove network
add_network             - Add new network
set_network &lt;id&gt; &lt;var&gt; &lt;value&gt; - Set network parameter
save_config             - Save configuration
disconnect              - Disconnect from AP
reconnect               - Reconnect to AP
reassociate             - Force reassociation
terminate               - Terminate wpa_supplicant
quit                    - Exit wpa_cli
</code></pre>
<hr />
<h2 id="advanced-configuration"><a class="header" href="#advanced-configuration">Advanced Configuration</a></h2>
<h3 id="band-selection-24-ghz-vs-5-ghz"><a class="header" href="#band-selection-24-ghz-vs-5-ghz">Band Selection (2.4 GHz vs 5 GHz)</a></h3>
<pre><code class="language-conf">network={
    ssid="DualBandWiFi"
    psk="password"
    # Prefer 5 GHz
    freq_list=5180 5200 5220 5240 5260 5280 5300 5320
}
</code></pre>
<h3 id="power-saving"><a class="header" href="#power-saving">Power Saving</a></h3>
<pre><code class="language-conf"># Global setting
# 0 = CAM (Constantly Awake Mode)
# 1 = PS mode (default)
# 2 = PS mode with max power saving
power_save=1
</code></pre>
<h3 id="roaming"><a class="header" href="#roaming">Roaming</a></h3>
<pre><code class="language-conf">network={
    ssid="EnterpriseWiFi"
    psk="password"
    # Fast roaming (802.11r)
    key_mgmt=FT-PSK
    # Proactive key caching
    proactive_key_caching=1
    # BSS transition management
    bss_transition=1
}
</code></pre>
<h3 id="mac-address-randomization"><a class="header" href="#mac-address-randomization">MAC Address Randomization</a></h3>
<pre><code class="language-conf"># Per-network MAC randomization
network={
    ssid="PublicWiFi"
    key_mgmt=NONE
    mac_addr=1  # Random MAC per network
}

# Global setting
mac_addr=1
# 0 = Use permanent MAC
# 1 = Random MAC per network
# 2 = Random MAC per SSID
</code></pre>
<h3 id="ipv6"><a class="header" href="#ipv6">IPv6</a></h3>
<pre><code class="language-conf"># Disable IPv6 in wpa_supplicant
network={
    ssid="MyWiFi"
    psk="password"
    disable_ipv6=1
}
</code></pre>
<hr />
<h2 id="security-modes"><a class="header" href="#security-modes">Security Modes</a></h2>
<h3 id="wpa2-enterprise-eap-peapmschapv2"><a class="header" href="#wpa2-enterprise-eap-peapmschapv2">WPA2-Enterprise (EAP-PEAP/MSCHAPv2)</a></h3>
<pre><code class="language-conf">network={
    ssid="CorpWiFi"
    key_mgmt=WPA-EAP
    eap=PEAP
    identity="username@domain.com"
    password="userpassword"
    phase2="auth=MSCHAPV2"
    # Certificate verification
    ca_cert="/etc/ssl/certs/ca-bundle.crt"
    # Or skip verification (insecure!)
    # ca_cert="/etc/ssl/certs/ca-certificates.crt"
}
</code></pre>
<h3 id="wpa2-enterprise-eap-tls-with-certificates"><a class="header" href="#wpa2-enterprise-eap-tls-with-certificates">WPA2-Enterprise (EAP-TLS with Certificates)</a></h3>
<pre><code class="language-conf">network={
    ssid="SecureCorpWiFi"
    key_mgmt=WPA-EAP
    eap=TLS
    identity="user@company.com"
    # Client certificate
    client_cert="/etc/wpa_supplicant/client.crt"
    # Private key
    private_key="/etc/wpa_supplicant/client.key"
    # Private key password
    private_key_passwd="keypassword"
    # CA certificate
    ca_cert="/etc/wpa_supplicant/ca.crt"
}
</code></pre>
<h3 id="wpa2-enterprise-eap-ttlspap"><a class="header" href="#wpa2-enterprise-eap-ttlspap">WPA2-Enterprise (EAP-TTLS/PAP)</a></h3>
<pre><code class="language-conf">network={
    ssid="UniversityWiFi"
    key_mgmt=WPA-EAP
    eap=TTLS
    identity="student@university.edu"
    password="studentpass"
    phase2="auth=PAP"
    ca_cert="/etc/ssl/certs/ca-bundle.crt"
}
</code></pre>
<h3 id="eduroam-configuration"><a class="header" href="#eduroam-configuration">Eduroam Configuration</a></h3>
<pre><code class="language-conf">network={
    ssid="eduroam"
    key_mgmt=WPA-EAP
    eap=PEAP
    identity="username@institution.edu"
    password="password"
    phase2="auth=MSCHAPV2"
    ca_cert="/etc/ssl/certs/ca-certificates.crt"
}
</code></pre>
<hr />
<h2 id="enterprise-wifi-8021x"><a class="header" href="#enterprise-wifi-8021x">Enterprise WiFi (802.1X)</a></h2>
<h3 id="certificate-management"><a class="header" href="#certificate-management">Certificate Management</a></h3>
<pre><code class="language-bash"># Download CA certificate
wget https://your-ca.com/ca.crt -O /etc/wpa_supplicant/ca.crt

# Set permissions
sudo chmod 600 /etc/wpa_supplicant/ca.crt

# Convert certificate format if needed
openssl x509 -inform DER -in ca.der -out ca.pem
</code></pre>
<h3 id="anonymous-identity-privacy"><a class="header" href="#anonymous-identity-privacy">Anonymous Identity (Privacy)</a></h3>
<pre><code class="language-conf">network={
    ssid="CorpWiFi"
    key_mgmt=WPA-EAP
    eap=PEAP
    # Anonymous outer identity
    anonymous_identity="anonymous@company.com"
    # Real identity (inner)
    identity="realuser@company.com"
    password="password"
    phase2="auth=MSCHAPV2"
    ca_cert="/etc/wpa_supplicant/ca.crt"
}
</code></pre>
<h3 id="domain-suffix-matching"><a class="header" href="#domain-suffix-matching">Domain Suffix Matching</a></h3>
<pre><code class="language-conf">network={
    ssid="SecureWiFi"
    key_mgmt=WPA-EAP
    eap=PEAP
    identity="user@company.com"
    password="password"
    phase2="auth=MSCHAPV2"
    # Verify server domain
    domain_suffix_match="radius.company.com"
    ca_cert="/etc/wpa_supplicant/ca.crt"
}
</code></pre>
<hr />
<h2 id="p2p-wifi-direct"><a class="header" href="#p2p-wifi-direct">P2P WiFi Direct</a></h2>
<h3 id="enable-wifi-direct"><a class="header" href="#enable-wifi-direct">Enable WiFi Direct</a></h3>
<pre><code class="language-conf"># Global setting
ctrl_interface=/var/run/wpa_supplicant
p2p_disabled=0
device_name=MyDevice
device_type=1-0050F204-1
</code></pre>
<h3 id="p2p-commands"><a class="header" href="#p2p-commands">P2P Commands</a></h3>
<pre><code class="language-bash"># Start P2P mode
wpa_cli -i wlan0 p2p_find

# Stop search
wpa_cli -i wlan0 p2p_stop_find

# Connect to peer
wpa_cli -i wlan0 p2p_connect &lt;peer_mac&gt; pbc

# Group formation
wpa_cli -i wlan0 p2p_group_add

# Show peers
wpa_cli -i wlan0 p2p_peers
</code></pre>
<hr />
<h2 id="troubleshooting"><a class="header" href="#troubleshooting">Troubleshooting</a></h2>
<h3 id="check-status"><a class="header" href="#check-status">Check Status</a></h3>
<pre><code class="language-bash"># Interface status
ip link show wlan0

# wpa_supplicant status
wpa_cli -i wlan0 status

# Connection state
wpa_cli -i wlan0 status | grep wpa_state
# COMPLETED = connected
# SCANNING = scanning for networks
# ASSOCIATING = connecting
# DISCONNECTED = not connected
</code></pre>
<h3 id="debug-logging"><a class="header" href="#debug-logging">Debug Logging</a></h3>
<pre><code class="language-bash"># Run in foreground with debug
sudo killall wpa_supplicant
sudo wpa_supplicant -i wlan0 -c /etc/wpa_supplicant/wpa_supplicant.conf -dd

# Check system logs
sudo journalctl -u wpa_supplicant@wlan0 -f

# dmesg for driver issues
dmesg | grep -i wifi
dmesg | grep -i wlan
</code></pre>
<h3 id="common-issues"><a class="header" href="#common-issues">Common Issues</a></h3>
<p><strong>Authentication failure:</strong></p>
<pre><code class="language-bash"># Check password
wpa_passphrase "SSID" "password"

# Verify security mode
wpa_cli -i wlan0 scan_results
# Look for [WPA2-PSK-CCMP], [WPA3-SAE], etc.

# Check logs
sudo journalctl -u wpa_supplicant@wlan0 | grep -i "auth\|fail"
</code></pre>
<p><strong>Cannot scan networks:</strong></p>
<pre><code class="language-bash"># Check if interface is up
sudo ip link set wlan0 up

# Check rfkill
rfkill list
sudo rfkill unblock wifi

# Manual scan
sudo iw dev wlan0 scan | grep SSID
</code></pre>
<p><strong>Frequent disconnections:</strong></p>
<pre><code class="language-bash"># Check signal strength
watch -n 1 'iw dev wlan0 link'

# Disable power management
sudo iwconfig wlan0 power off

# Check logs for errors
sudo journalctl -u wpa_supplicant@wlan0 --since "10 minutes ago"
</code></pre>
<p><strong>Driver issues:</strong></p>
<pre><code class="language-bash"># Check driver
lspci -k | grep -A 3 -i network
# Or for USB
lsusb
dmesg | grep -i firmware

# Reload driver
sudo modprobe -r &lt;driver_name&gt;
sudo modprobe &lt;driver_name&gt;
</code></pre>
<hr />
<h2 id="integration-with-systemd"><a class="header" href="#integration-with-systemd">Integration with systemd</a></h2>
<h3 id="systemd-service"><a class="header" href="#systemd-service">systemd Service</a></h3>
<p><strong>Per-interface service:</strong></p>
<pre><code class="language-bash"># Start service
sudo systemctl start wpa_supplicant@wlan0

# Enable on boot
sudo systemctl enable wpa_supplicant@wlan0

# Status
sudo systemctl status wpa_supplicant@wlan0

# Restart
sudo systemctl restart wpa_supplicant@wlan0
</code></pre>
<p><strong>Service file:</strong> <code>/lib/systemd/system/wpa_supplicant@.service</code></p>
<pre><code class="language-ini">[Unit]
Description=WPA supplicant daemon (interface-specific version)
Requires=sys-subsystem-net-devices-%i.device
After=sys-subsystem-net-devices-%i.device
Before=network.target
Wants=network.target

[Service]
Type=simple
ExecStart=/sbin/wpa_supplicant -c/etc/wpa_supplicant/wpa_supplicant-%I.conf -i%I

[Install]
WantedBy=multi-user.target
</code></pre>
<h3 id="networkd-integration"><a class="header" href="#networkd-integration">networkd Integration</a></h3>
<p><strong><code>/etc/systemd/network/25-wireless.network</code>:</strong></p>
<pre><code class="language-ini">[Match]
Name=wlan0

[Network]
DHCP=yes
</code></pre>
<p><strong>Start services:</strong></p>
<pre><code class="language-bash">sudo systemctl enable systemd-networkd
sudo systemctl enable wpa_supplicant@wlan0
sudo systemctl start systemd-networkd
sudo systemctl start wpa_supplicant@wlan0
</code></pre>
<hr />
<h2 id="best-practices"><a class="header" href="#best-practices">Best Practices</a></h2>
<h3 id="security"><a class="header" href="#security">Security</a></h3>
<ol>
<li><strong>Use encrypted PSK:</strong></li>
</ol>
<pre><code class="language-bash"># Generate PSK hash instead of plaintext
wpa_passphrase "SSID" "password" | sudo tee -a /etc/wpa_supplicant/wpa_supplicant.conf
</code></pre>
<ol start="2">
<li><strong>Secure configuration file:</strong></li>
</ol>
<pre><code class="language-bash">sudo chmod 600 /etc/wpa_supplicant/wpa_supplicant.conf
</code></pre>
<ol start="3">
<li><strong>Use WPA3 when available:</strong></li>
</ol>
<pre><code class="language-conf">network={
    ssid="MyWiFi"
    psk="password"
    key_mgmt=SAE WPA-PSK  # Try WPA3, fall back to WPA2
    ieee80211w=1  # Optional PMF
}
</code></pre>
<ol start="4">
<li><strong>Verify certificates for Enterprise:</strong></li>
</ol>
<pre><code class="language-conf">network={
    ssid="CorpWiFi"
    key_mgmt=WPA-EAP
    ca_cert="/path/to/ca.crt"
    domain_suffix_match="radius.company.com"
}
</code></pre>
<h3 id="performance"><a class="header" href="#performance">Performance</a></h3>
<ol>
<li><strong>Disable unnecessary features:</strong></li>
</ol>
<pre><code class="language-conf"># Disable P2P if not needed
p2p_disabled=1

# Disable WPS
wps_disabled=1
</code></pre>
<ol start="2">
<li><strong>Optimize power saving:</strong></li>
</ol>
<pre><code class="language-conf"># For performance (disable power save)
power_save=0

# For battery (enable power save)
power_save=2
</code></pre>
<ol start="3">
<li><strong>Fast roaming:</strong></li>
</ol>
<pre><code class="language-conf">network={
    ssid="EnterpriseWiFi"
    key_mgmt=FT-PSK
    proactive_key_caching=1
}
</code></pre>
<h3 id="reliability"><a class="header" href="#reliability">Reliability</a></h3>
<ol>
<li><strong>Network priority:</strong></li>
</ol>
<pre><code class="language-conf"># Higher priority = preferred
network={
    ssid="PrimaryWiFi"
    priority=10
}
network={
    ssid="BackupWiFi"
    priority=5
}
</code></pre>
<ol start="2">
<li><strong>Automatic reconnection:</strong></li>
</ol>
<pre><code class="language-bash"># systemd handles this automatically
sudo systemctl enable wpa_supplicant@wlan0
</code></pre>
<ol start="3">
<li><strong>Monitoring:</strong></li>
</ol>
<pre><code class="language-bash"># Watch connection status
watch -n 2 'wpa_cli -i wlan0 status | grep -E "wpa_state|ssid|ip_address"'
</code></pre>
<hr />
<h2 id="summary"><a class="header" href="#summary">Summary</a></h2>
<p><strong>wpa_supplicant</strong> is the standard WiFi client for Linux:</p>
<p><strong>Basic workflow:</strong></p>
<ol>
<li>Configure networks in <code>/etc/wpa_supplicant/wpa_supplicant.conf</code></li>
<li>Start: <code>sudo wpa_supplicant -B -i wlan0 -c /etc/wpa_supplicant/wpa_supplicant.conf</code></li>
<li>Manage: <code>wpa_cli -i wlan0 &lt;command&gt;</code></li>
<li>Get IP: <code>sudo dhclient wlan0</code></li>
</ol>
<p><strong>Key commands:</strong></p>
<ul>
<li><code>wpa_passphrase</code>: Generate PSK hash</li>
<li><code>wpa_supplicant</code>: Main daemon</li>
<li><code>wpa_cli</code>: Control interface</li>
<li><code>systemctl</code>: Manage service</li>
</ul>
<p><strong>Common tasks:</strong></p>
<ul>
<li>Connect to WPA2: Set <code>ssid</code> and <code>psk</code></li>
<li>Enterprise WiFi: Configure EAP method</li>
<li>Scan networks: <code>wpa_cli scan &amp;&amp; wpa_cli scan_results</code></li>
<li>Debug: Run with <code>-dd</code> flag</li>
</ul>
<p><strong>Resources:</strong></p>
<ul>
<li><a href="https://w1.fi/wpa_supplicant/">wpa_supplicant Documentation</a></li>
<li><a href="https://wiki.archlinux.org/title/Wpa_supplicant">ArchWiki: wpa_supplicant</a></li>
<li><a href="https://help.ubuntu.com/community/WifiDocs">Ubuntu WiFi Guide</a></li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../tools/ansible.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../tools/hostapd.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../tools/ansible.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../tools/hostapd.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
