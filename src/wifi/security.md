# Wi-Fi Security

Wi-Fi security is crucial for protecting wireless networks from unauthorized access and ensuring the confidentiality and integrity of data transmitted over the air. There are several wireless security protocols and mechanisms that have been developed over the years to enhance the security of Wi-Fi networks. Here are some of the most common wireless security protocols:

### WEP (Wired Equivalent Privacy)
- **Introduced**: 1997
- **Encryption**: RC4 stream cipher
- **Key Length**: 40-bit or 104-bit
- **Notes**: WEP was the first security protocol for Wi-Fi networks, designed to provide a level of security comparable to that of a wired network. However, it has significant vulnerabilities and is considered insecure. It is no longer recommended for use.

### WPA (Wi-Fi Protected Access)
- **Introduced**: 2003
- **Encryption**: TKIP (Temporal Key Integrity Protocol)
- **Key Length**: 128-bit
- **Notes**: WPA was introduced as an interim solution to address the weaknesses of WEP. It uses TKIP to improve encryption and includes mechanisms for key management and integrity checking. While more secure than WEP, WPA has been largely replaced by WPA2.

### WPA2 (Wi-Fi Protected Access II)
- **Introduced**: 2004
- **Encryption**: AES (Advanced Encryption Standard)
- **Key Length**: 128-bit
- **Notes**: WPA2 is the most widely used Wi-Fi security protocol today. It uses AES for encryption, which is considered highly secure. WPA2 also includes support for CCMP (Counter Mode with Cipher Block Chaining Message Authentication Code Protocol) for data integrity and confidentiality. It is recommended for all modern Wi-Fi networks.

#### Technical Details

WPA2 operates in two modes: Personal (WPA2-PSK) and Enterprise (WPA2-Enterprise).

1. **WPA2-Personal (Pre-Shared Key - PSK)**:
   - Uses a pre-shared key for authentication.
   - Suitable for home and small office networks.
   - The pre-shared key is used to derive the Pairwise Transient Key (PTK), which is used for encrypting data between the client and the access point.

2. **WPA2-Enterprise**:
   - Uses 802.1X authentication with an external RADIUS server.
   - Suitable for enterprise and large networks.
   - Provides individual authentication credentials for each user.
   - Supports various Extensible Authentication Protocol (EAP) methods, such as EAP-TLS, EAP-TTLS, and PEAP.

#### Key Management

WPA2 uses a robust key management framework to ensure secure communication:

- **Pairwise Master Key (PMK)**: Derived from the pre-shared key (PSK) in WPA2-Personal or obtained through 802.1X authentication in WPA2-Enterprise.
- **Pairwise Transient Key (PTK)**: Derived from the PMK, the client MAC address, the access point MAC address, and nonces exchanged during the 4-way handshake. The PTK is used to encrypt unicast traffic between the client and the access point.
- **Group Temporal Key (GTK)**: Used to encrypt broadcast and multicast traffic. The GTK is generated by the access point and distributed to clients during the 4-way handshake.

#### 4-Way Handshake

The 4-way handshake is a crucial process in WPA2 that ensures the secure exchange of encryption keys between the client and the access point:

1. **Message 1**: The access point sends an ANonce (a random number) to the client.
2. **Message 2**: The client generates an SNonce (another random number) and uses it, along with the ANonce, to derive the PTK. The client then sends the SNonce to the access point.
3. **Message 3**: The access point uses the SNonce and ANonce to derive the PTK. It then sends the GTK (encrypted with the PTK) and a message integrity code (MIC) to the client.
4. **Message 4**: The client sends an acknowledgment to the access point, indicating that it has successfully installed the PTK and GTK.

#### Authentication and Key Management (AKM) Suites

WPA2 supports various AKM suites to provide flexibility in authentication methods:

- **PSK (Pre-Shared Key)**: Used in WPA2-Personal for simple passphrase-based authentication.
- **802.1X**: Used in WPA2-Enterprise for authentication with a RADIUS server.
- **FT (Fast Transition)**: Also known as 802.11r, used to enable fast roaming between access points without re-authentication.
- **SAE (Simultaneous Authentication of Equals)**: Introduced in WPA3 but can be used in WPA2 for enhanced security.

#### Frames in WPA2

WPA2 uses several types of frames to manage security and encryption:

- **Authentication Frames**: Used to initiate the authentication process between the client and the access point.
- **Association Frames**: Used to establish a connection between the client and the access point.
- **EAPOL (Extensible Authentication Protocol over LAN) Frames**: Used during the 4-way handshake to exchange nonces and encryption keys.
- **Data Frames**: Encrypted using the PTK for unicast traffic and the GTK for broadcast/multicast traffic.

By understanding the technical details and mechanisms of WPA2, users and network administrators can ensure robust security for their Wi-Fi networks, protecting against unauthorized access and ensuring the confidentiality and integrity of their data.


### WPA3 (Wi-Fi Protected Access III)
- **Introduced**: 2018
- **Encryption**: AES with GCMP (Galois/Counter Mode Protocol)
- **Key Length**: 128-bit or 192-bit
- **Notes**: WPA3 is the latest Wi-Fi security protocol, designed to provide enhanced security features over WPA2. It includes improvements such as Simultaneous Authentication of Equals (SAE) for stronger password-based authentication, forward secrecy to protect data even if a key is compromised, and improved protection against brute-force attacks. WPA3 is recommended for new Wi-Fi networks and devices.

#### Key Management

WPA3 introduces a more robust key management framework to enhance security:

- **Simultaneous Authentication of Equals (SAE)**: A secure key establishment protocol that replaces the pre-shared key (PSK) method used in WPA2-Personal. SAE provides protection against offline dictionary attacks and ensures forward secrecy.
- **Pairwise Master Key (PMK)**: Derived from the SAE process in WPA3-Personal or obtained through 802.1X authentication in WPA3-Enterprise.
- **Pairwise Transient Key (PTK)**: Derived from the PMK, the client MAC address, the access point MAC address, and nonces exchanged during the 4-way handshake. The PTK is used to encrypt unicast traffic between the client and the access point.
- **Group Temporal Key (GTK)**: Used to encrypt broadcast and multicast traffic. The GTK is generated by the access point and distributed to clients during the 4-way handshake.

#### 4-Way Handshake

The 4-way handshake in WPA3 is similar to WPA2 but includes enhancements for improved security:

1. **Message 1**: The access point sends an ANonce (a random number) to the client.
2. **Message 2**: The client generates an SNonce (another random number) and uses it, along with the ANonce, to derive the PTK. The client then sends the SNonce to the access point.
3. **Message 3**: The access point uses the SNonce and ANonce to derive the PTK. It then sends the GTK (encrypted with the PTK) and a message integrity code (MIC) to the client.
4. **Message 4**: The client sends an acknowledgment to the access point, indicating that it has successfully installed the PTK and GTK.

#### Authentication and Key Management (AKM) Suites

WPA3 supports various AKM suites to provide flexibility in authentication methods:

- **SAE (Simultaneous Authentication of Equals)**: Used in WPA3-Personal for secure password-based authentication.
- **802.1X**: Used in WPA3-Enterprise for authentication with a RADIUS server.
- **Suite B**: A set of cryptographic algorithms approved by the National Security Agency (NSA) for use in high-security environments. Suite B includes support for 192-bit encryption keys and elliptic curve cryptography (ECC).

#### Frames in WPA3

WPA3 uses several types of frames to manage security and encryption:

- **Authentication Frames**: Used to initiate the authentication process between the client and the access point.
- **Association Frames**: Used to establish a connection between the client and the access point.
- **EAPOL (Extensible Authentication Protocol over LAN) Frames**: Used during the 4-way handshake to exchange nonces and encryption keys.
- **Data Frames**: Encrypted using the PTK for unicast traffic and the GTK for broadcast/multicast traffic.

By understanding the technical details and mechanisms of WPA3, users and network administrators can ensure robust security for their Wi-Fi networks, protecting against unauthorized access and ensuring the confidentiality and integrity of their data.


### 802.1X (Port-Based Network Access Control)
- **Introduced**: 2001
- **Authentication**: EAP (Extensible Authentication Protocol)
- **Notes**: 802.1X is a network access control protocol that provides an authentication framework for wired and wireless networks. It is commonly used in enterprise environments to authenticate users and devices before granting access to the network. 802.1X can be used in conjunction with WPA2 and WPA3 for enhanced security.

#### Technical Details

802.1X operates at the data link layer (Layer 2) of the OSI model and uses the Extensible Authentication Protocol (EAP) to facilitate authentication. The protocol involves three main components:

1. **Supplicant**: The device (e.g., a laptop or smartphone) that requests access to the network.
2. **Authenticator**: The network device (e.g., a switch or wireless access point) that controls access to the network.
3. **Authentication Server**: The server (e.g., a RADIUS server) that validates the credentials of the supplicant.

#### Authentication Process

The 802.1X authentication process involves the following steps:

1. **Initialization**: The supplicant connects to the network and the authenticator detects the connection.
2. **EAPOL-Start**: The supplicant sends an EAPOL-Start frame to the authenticator to initiate the authentication process.
3. **EAP-Request/Identity**: The authenticator responds with an EAP-Request/Identity frame, asking the supplicant for its identity.
4. **EAP-Response/Identity**: The supplicant replies with an EAP-Response/Identity frame, providing its identity to the authenticator.
5. **RADIUS Access-Request**: The authenticator forwards the identity information to the authentication server in a RADIUS Access-Request message.
6. **RADIUS Access-Challenge**: The authentication server may respond with a RADIUS Access-Challenge message, requesting additional information (e.g., a password or token).
7. **EAP-Request/Challenge**: The authenticator forwards the challenge to the supplicant in an EAP-Request/Challenge frame.
8. **EAP-Response/Challenge**: The supplicant responds with the requested information in an EAP-Response/Challenge frame.
9. **RADIUS Access-Accept**: If the authentication server successfully validates the credentials, it sends a RADIUS Access-Accept message to the authenticator.
10. **EAP-Success**: The authenticator informs the supplicant of successful authentication with an EAP-Success frame.
11. **Port Authorization**: The authenticator grants access to the network by opening the port for the supplicant.

#### Frames in 802.1X

802.1X uses several types of frames to manage the authentication process:

- **EAPOL (Extensible Authentication Protocol over LAN) Frames**: Used for communication between the supplicant and the authenticator.
  - **EAPOL-Start**: Initiates the authentication process.
  - **EAPOL-Logoff**: Terminates the authentication session.
  - **EAPOL-Key**: Used for key management in WPA/WPA2/WPA3.
  - **EAPOL-Packet**: Carries EAP messages between the supplicant and the authenticator.

- **EAP (Extensible Authentication Protocol) Frames**: Used for communication between the supplicant and the authentication server.
  - **EAP-Request**: Sent by the authenticator to request information from the supplicant.
  - **EAP-Response**: Sent by the supplicant in response to an EAP-Request.
  - **EAP-Success**: Indicates successful authentication.
  - **EAP-Failure**: Indicates failed authentication.

#### Authentication and Key Management (AKM) Suites

802.1X supports various AKM suites to provide flexibility in authentication methods:

- **EAP-TLS (Transport Layer Security)**: Uses client and server certificates for mutual authentication.
- **EAP-TTLS (Tunneled Transport Layer Security)**: Establishes a secure tunnel using server certificates, then uses another authentication method (e.g., PAP, CHAP) within the tunnel.
- **PEAP (Protected Extensible Authentication Protocol)**: Similar to EAP-TTLS, but uses a different method for establishing the secure tunnel.
- **EAP-MSCHAPv2 (Microsoft Challenge Handshake Authentication Protocol version 2)**: Uses a password-based authentication mechanism.
- **EAP-SIM (Subscriber Identity Module)**: Uses the SIM card in mobile devices for authentication.

By understanding the technical details and mechanisms of 802.1X, users and network administrators can ensure robust security for their wired and wireless networks, protecting against unauthorized access and ensuring the confidentiality and integrity of their data.


### WPS (Wi-Fi Protected Setup)
- **Introduced**: 2007
- **Notes**: WPS is a network security standard designed to simplify the process of connecting devices to a Wi-Fi network. It allows users to connect to a network by pressing a button on the router or entering a PIN. However, WPS has known vulnerabilities and can be exploited by attackers to gain unauthorized access to the network. It is recommended to disable WPS if security is a concern.

### MAC Address Filtering
- **Notes**: MAC address filtering is a security measure that allows only devices with specific MAC addresses to connect to the Wi-Fi network. While it can provide an additional layer of security, it is not foolproof, as MAC addresses can be spoofed by attackers. It should be used in conjunction with other security measures.

### Guest Networks
- **Notes**: Many modern routers support the creation of guest networks, which provide a separate Wi-Fi network for visitors. Guest networks can be isolated from the main network, preventing guests from accessing sensitive resources. This is a useful feature for enhancing security in both home and business environments.

By understanding and implementing these Wi-Fi security protocols and mechanisms, users and network administrators can protect their wireless networks from unauthorized access and ensure the confidentiality and integrity of their data.
