<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>My Notes</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">My Notes</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="welcome-to-my-notes-site"><a class="header" href="#welcome-to-my-notes-site">Welcome to My Notes Site</a></h1>
<p>Welcome to a curated collection of notes and resources spanning a wide array of topics, from programming languages and data structures to machine learning and cloud computing. This is my personal repository of knowledge, where I document my learnings and insights across various subjects.</p>
<h2 id="table-of-contents"><a class="header" href="#table-of-contents">Table of Contents</a></h2>
<ul>
<li><a href="git/">Git</a></li>
<li><a href="programming/">Programming Languages</a></li>
<li><a href="linux/">Linux</a></li>
<li><a href="android/">Android</a></li>
<li><a href="data_structures/">Data Structures</a></li>
<li><a href="algorithms/">Algorithms</a></li>
<li><a href="security/">Security</a></li>
<li><a href="networking/">Computer Networking</a></li>
<li><a href="wifi/">Wifi</a></li>
<li><a href="machine_learning/">Machine Learning</a></li>
<li><a href="ai/">AI</a></li>
<li><a href="cloud/">Cloud</a></li>
<li><a href="finance/">Finance</a></li>
<li><a href="tools/">Tools</a></li>
<li><a href="embedded/">Embedded</a></li>
</ul>
<p>Feel free to explore the sections and delve into the topics that pique your interest. Happy learning!</p>
<p>Note: This is an evolving project, and I will continue to add more content over time. The contents may be rearranged or updated as needed.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="git-version-control"><a class="header" href="#git-version-control">Git Version Control</a></h1>
<h2 id="overview"><a class="header" href="#overview">Overview</a></h2>
<p>Git is a distributed version control system designed to handle everything from small to very large projects with speed and efficiency. Created by Linus Torvalds in 2005, Git has become the de facto standard for version control in software development.</p>
<h2 id="what-is-version-control"><a class="header" href="#what-is-version-control">What is Version Control?</a></h2>
<p>Version control is a system that records changes to files over time so that you can recall specific versions later. It allows you to:</p>
<ul>
<li>Track changes to your code</li>
<li>Collaborate with other developers</li>
<li>Revert to previous versions</li>
<li>Create branches for experimental features</li>
<li>Merge changes from multiple sources</li>
<li>Maintain a complete history of your project</li>
</ul>
<h2 id="why-git"><a class="header" href="#why-git">Why Git?</a></h2>
<ol>
<li><strong>Distributed</strong>: Every developer has a full copy of the repository</li>
<li><strong>Fast</strong>: Most operations are local</li>
<li><strong>Branching</strong>: Lightweight and powerful branching model</li>
<li><strong>Data Integrity</strong>: Cryptographic hash (SHA-1) ensures data integrity</li>
<li><strong>Staging Area</strong>: Review changes before committing</li>
<li><strong>Open Source</strong>: Free and widely supported</li>
</ol>
<h2 id="git-basics"><a class="header" href="#git-basics">Git Basics</a></h2>
<h3 id="the-three-states"><a class="header" href="#the-three-states">The Three States</a></h3>
<p>Git has three main states for your files:</p>
<ol>
<li><strong>Modified</strong>: Changed but not committed</li>
<li><strong>Staged</strong>: Marked for next commit</li>
<li><strong>Committed</strong>: Safely stored in local database</li>
</ol>
<pre><code>Working Directory -&gt; Staging Area -&gt; Git Repository
     (edit)            (stage)         (commit)
</code></pre>
<h3 id="git-workflow"><a class="header" href="#git-workflow">Git Workflow</a></h3>
<pre><code class="language-bash"># 1. Make changes in working directory
echo "Hello World" &gt; file.txt

# 2. Stage changes
git add file.txt

# 3. Commit changes
git commit -m "Add hello world file"

# 4. Push to remote repository
git push origin main
</code></pre>
<h2 id="installation-and-setup"><a class="header" href="#installation-and-setup">Installation and Setup</a></h2>
<h3 id="installation"><a class="header" href="#installation">Installation</a></h3>
<pre><code class="language-bash"># Linux (Debian/Ubuntu)
sudo apt-get update
sudo apt-get install git

# Linux (Fedora)
sudo dnf install git

# macOS (Homebrew)
brew install git

# Windows
# Download from https://git-scm.com/download/win

# Verify installation
git --version
</code></pre>
<h3 id="initial-configuration"><a class="header" href="#initial-configuration">Initial Configuration</a></h3>
<pre><code class="language-bash"># Set user name
git config --global user.name "Your Name"

# Set email
git config --global user.email "your.email@example.com"

# Set default editor
git config --global core.editor "vim"

# Set default branch name
git config --global init.defaultBranch main

# Enable color output
git config --global color.ui auto

# View all settings
git config --list

# View specific setting
git config user.name

# Edit config file directly
git config --global --edit
</code></pre>
<h2 id="basic-commands"><a class="header" href="#basic-commands">Basic Commands</a></h2>
<h3 id="creating-repositories"><a class="header" href="#creating-repositories">Creating Repositories</a></h3>
<pre><code class="language-bash"># Initialize new repository
git init

# Clone existing repository
git clone https://github.com/user/repo.git

# Clone to specific directory
git clone https://github.com/user/repo.git my-project

# Clone specific branch
git clone -b develop https://github.com/user/repo.git
</code></pre>
<h3 id="making-changes"><a class="header" href="#making-changes">Making Changes</a></h3>
<pre><code class="language-bash"># Check status
git status

# Add file to staging
git add file.txt

# Add all files
git add .

# Add all files with specific extension
git add *.js

# Interactive staging
git add -p

# Commit staged changes
git commit -m "Commit message"

# Commit with detailed message
git commit

# Stage and commit in one step
git commit -am "Message"

# Amend last commit
git commit --amend

# Amend without changing message
git commit --amend --no-edit
</code></pre>
<h3 id="viewing-history"><a class="header" href="#viewing-history">Viewing History</a></h3>
<pre><code class="language-bash"># View commit history
git log

# Compact log
git log --oneline

# Graph view
git log --graph --oneline --all

# Limit number of commits
git log -n 5

# Show commits by author
git log --author="John"

# Show commits in date range
git log --since="2 weeks ago"
git log --until="2024-01-01"

# Show file changes
git log --stat

# Show detailed changes
git log -p

# Search commit messages
git log --grep="fix"

# Show commits affecting specific file
git log -- file.txt
</code></pre>
<h3 id="viewing-changes"><a class="header" href="#viewing-changes">Viewing Changes</a></h3>
<pre><code class="language-bash"># Show unstaged changes
git diff

# Show staged changes
git diff --staged

# Show changes in specific file
git diff file.txt

# Compare branches
git diff main..feature

# Compare commits
git diff commit1 commit2

# Word-level diff
git diff --word-diff
</code></pre>
<h2 id="branching-and-merging"><a class="header" href="#branching-and-merging">Branching and Merging</a></h2>
<h3 id="branches"><a class="header" href="#branches">Branches</a></h3>
<pre><code class="language-bash"># List branches
git branch

# List all branches (including remote)
git branch -a

# Create new branch
git branch feature-name

# Switch to branch
git checkout feature-name

# Create and switch in one command
git checkout -b feature-name

# Modern syntax (Git 2.23+)
git switch feature-name
git switch -c feature-name

# Delete branch
git branch -d feature-name

# Force delete unmerged branch
git branch -D feature-name

# Rename current branch
git branch -m new-name

# Rename specific branch
git branch -m old-name new-name
</code></pre>
<h3 id="merging"><a class="header" href="#merging">Merging</a></h3>
<pre><code class="language-bash"># Merge branch into current branch
git merge feature-name

# Merge with commit message
git merge feature-name -m "Merge feature"

# Merge without fast-forward
git merge --no-ff feature-name

# Abort merge
git merge --abort

# Continue merge after resolving conflicts
git merge --continue
</code></pre>
<h3 id="handling-merge-conflicts"><a class="header" href="#handling-merge-conflicts">Handling Merge Conflicts</a></h3>
<pre><code class="language-bash"># When merge conflict occurs:

# 1. Check conflicted files
git status

# 2. Open files and resolve conflicts
#    Look for markers: &lt;&lt;&lt;&lt;&lt;&lt;&lt;, =======, &gt;&gt;&gt;&gt;&gt;&gt;&gt;

# 3. After resolving, stage files
git add resolved-file.txt

# 4. Complete merge
git commit

# Or use merge tool
git mergetool
</code></pre>
<h3 id="rebasing"><a class="header" href="#rebasing">Rebasing</a></h3>
<pre><code class="language-bash"># Rebase current branch onto main
git rebase main

# Interactive rebase (last 3 commits)
git rebase -i HEAD~3

# Continue after resolving conflicts
git rebase --continue

# Skip current commit
git rebase --skip

# Abort rebase
git rebase --abort

# Rebase options in interactive mode:
# pick   = use commit
# reword = use commit, but edit message
# edit   = use commit, but stop for amending
# squash = merge with previous commit
# drop   = remove commit
</code></pre>
<h2 id="remote-repositories"><a class="header" href="#remote-repositories">Remote Repositories</a></h2>
<h3 id="working-with-remotes"><a class="header" href="#working-with-remotes">Working with Remotes</a></h3>
<pre><code class="language-bash"># List remotes
git remote

# List remotes with URLs
git remote -v

# Add remote
git remote add origin https://github.com/user/repo.git

# Change remote URL
git remote set-url origin https://github.com/user/new-repo.git

# Remove remote
git remote remove origin

# Rename remote
git remote rename origin upstream

# Show remote info
git remote show origin
</code></pre>
<h3 id="fetching-and-pulling"><a class="header" href="#fetching-and-pulling">Fetching and Pulling</a></h3>
<pre><code class="language-bash"># Fetch from remote (doesn't merge)
git fetch origin

# Fetch all remotes
git fetch --all

# Pull (fetch + merge)
git pull origin main

# Pull with rebase
git pull --rebase origin main

# Pull specific branch
git pull origin feature-branch
</code></pre>
<h3 id="pushing"><a class="header" href="#pushing">Pushing</a></h3>
<pre><code class="language-bash"># Push to remote
git push origin main

# Push and set upstream
git push -u origin main

# Push all branches
git push --all origin

# Push tags
git push --tags

# Force push (dangerous!)
git push --force origin main

# Safer force push
git push --force-with-lease origin main

# Delete remote branch
git push origin --delete branch-name
</code></pre>
<h2 id="undoing-changes"><a class="header" href="#undoing-changes">Undoing Changes</a></h2>
<h3 id="working-directory"><a class="header" href="#working-directory">Working Directory</a></h3>
<pre><code class="language-bash"># Discard changes in file
git checkout -- file.txt

# Discard all changes
git checkout -- .

# Modern syntax
git restore file.txt
git restore .

# Remove untracked files
git clean -f

# Remove untracked files and directories
git clean -fd

# Preview what will be removed
git clean -n
</code></pre>
<h3 id="staging-area"><a class="header" href="#staging-area">Staging Area</a></h3>
<pre><code class="language-bash"># Unstage file
git reset HEAD file.txt

# Unstage all files
git reset HEAD

# Modern syntax
git restore --staged file.txt
</code></pre>
<h3 id="commits"><a class="header" href="#commits">Commits</a></h3>
<pre><code class="language-bash"># Undo last commit (keep changes)
git reset --soft HEAD~1

# Undo last commit (discard changes)
git reset --hard HEAD~1

# Undo multiple commits
git reset --hard HEAD~3

# Reset to specific commit
git reset --hard commit-hash

# Create new commit that undoes changes
git revert commit-hash

# Revert multiple commits
git revert commit1..commit3
</code></pre>
<h2 id="advanced-features"><a class="header" href="#advanced-features">Advanced Features</a></h2>
<h3 id="stashing"><a class="header" href="#stashing">Stashing</a></h3>
<pre><code class="language-bash"># Stash current changes
git stash

# Stash with message
git stash save "Work in progress"

# List stashes
git stash list

# Apply last stash
git stash apply

# Apply specific stash
git stash apply stash@{2}

# Apply and remove stash
git stash pop

# Create branch from stash
git stash branch feature-name

# Drop stash
git stash drop stash@{0}

# Clear all stashes
git stash clear

# Stash including untracked files
git stash -u
</code></pre>
<h3 id="tags"><a class="header" href="#tags">Tags</a></h3>
<pre><code class="language-bash"># List tags
git tag

# Create lightweight tag
git tag v1.0.0

# Create annotated tag
git tag -a v1.0.0 -m "Version 1.0.0"

# Tag specific commit
git tag v1.0.0 commit-hash

# Push tag to remote
git push origin v1.0.0

# Push all tags
git push --tags

# Delete local tag
git tag -d v1.0.0

# Delete remote tag
git push origin --delete v1.0.0

# Checkout tag
git checkout v1.0.0
</code></pre>
<h3 id="cherry-pick"><a class="header" href="#cherry-pick">Cherry-Pick</a></h3>
<pre><code class="language-bash"># Apply specific commit to current branch
git cherry-pick commit-hash

# Cherry-pick multiple commits
git cherry-pick commit1 commit2

# Cherry-pick without committing
git cherry-pick -n commit-hash

# Abort cherry-pick
git cherry-pick --abort
</code></pre>
<h3 id="bisect"><a class="header" href="#bisect">Bisect</a></h3>
<pre><code class="language-bash"># Start bisect session
git bisect start

# Mark current commit as bad
git bisect bad

# Mark known good commit
git bisect good commit-hash

# Git will checkout middle commit
# Test and mark as good or bad
git bisect good  # or git bisect bad

# Continue until bug is found

# End bisect session
git bisect reset
</code></pre>
<h2 id="git-workflows"><a class="header" href="#git-workflows">Git Workflows</a></h2>
<h3 id="feature-branch-workflow"><a class="header" href="#feature-branch-workflow">Feature Branch Workflow</a></h3>
<pre><code class="language-bash"># 1. Create feature branch
git checkout -b feature/new-feature

# 2. Make changes and commit
git add .
git commit -m "Implement new feature"

# 3. Push to remote
git push -u origin feature/new-feature

# 4. Create pull request (on GitHub/GitLab)

# 5. After review, merge via web interface

# 6. Update local main branch
git checkout main
git pull origin main

# 7. Delete feature branch
git branch -d feature/new-feature
git push origin --delete feature/new-feature
</code></pre>
<h3 id="gitflow-workflow"><a class="header" href="#gitflow-workflow">Gitflow Workflow</a></h3>
<pre><code class="language-bash"># Main branches: main (production), develop (integration)

# Start new feature
git checkout -b feature/feature-name develop

# Finish feature
git checkout develop
git merge --no-ff feature/feature-name
git branch -d feature/feature-name

# Start release
git checkout -b release/1.0.0 develop

# Finish release
git checkout main
git merge --no-ff release/1.0.0
git tag -a v1.0.0
git checkout develop
git merge --no-ff release/1.0.0
git branch -d release/1.0.0

# Hotfix
git checkout -b hotfix/fix-bug main
git checkout main
git merge --no-ff hotfix/fix-bug
git tag -a v1.0.1
git checkout develop
git merge --no-ff hotfix/fix-bug
git branch -d hotfix/fix-bug
</code></pre>
<h3 id="fork-and-pull-request-workflow"><a class="header" href="#fork-and-pull-request-workflow">Fork and Pull Request Workflow</a></h3>
<pre><code class="language-bash"># 1. Fork repository on GitHub

# 2. Clone your fork
git clone https://github.com/your-username/repo.git
cd repo

# 3. Add upstream remote
git remote add upstream https://github.com/original-owner/repo.git
git remote -v

# 4. Create feature branch
git checkout -b feature/my-feature

# 5. Make changes and commit
git add .
git commit -m "Add new feature"

# 6. Keep your fork updated
git fetch upstream
git checkout main
git merge upstream/main
git push origin main

# 7. Rebase your feature branch (optional but recommended)
git checkout feature/my-feature
git rebase main

# 8. Push to your fork
git push origin feature/my-feature

# 9. Create Pull Request on GitHub
#    - Navigate to original repository
#    - Click "New Pull Request"
#    - Select your fork and branch

# 10. After PR is merged, update and cleanup
git checkout main
git pull upstream main
git push origin main
git branch -d feature/my-feature
git push origin --delete feature/my-feature
</code></pre>
<h3 id="trunk-based-development"><a class="header" href="#trunk-based-development">Trunk-Based Development</a></h3>
<pre><code class="language-bash"># Work directly on main branch with short-lived feature branches

# 1. Create short-lived feature branch
git checkout -b feature/quick-fix

# 2. Make small, incremental changes
git add .
git commit -m "Implement part 1 of feature"

# 3. Keep branch up to date with main (multiple times per day)
git checkout main
git pull origin main
git checkout feature/quick-fix
git rebase main

# 4. Merge back to main quickly (within hours or 1-2 days)
git checkout main
git merge --no-ff feature/quick-fix
git push origin main

# 5. Delete feature branch
git branch -d feature/quick-fix

# Alternative: Direct commits to main (for very small changes)
git checkout main
git pull origin main
# Make small change
git add .
git commit -m "Fix typo"
git push origin main
</code></pre>
<h3 id="release-branch-workflow"><a class="header" href="#release-branch-workflow">Release Branch Workflow</a></h3>
<pre><code class="language-bash"># Create release branch from main
git checkout -b release/v2.0.0 main

# Make release-specific changes (version bumps, changelog, etc.)
git add .
git commit -m "Prepare release v2.0.0"

# Test the release branch thoroughly
# Fix any bugs found
git add .
git commit -m "Fix release bug"

# Merge to main and tag
git checkout main
git merge --no-ff release/v2.0.0
git tag -a v2.0.0 -m "Release version 2.0.0"
git push origin main
git push origin v2.0.0

# Merge release changes back to develop (if using Gitflow)
git checkout develop
git merge --no-ff release/v2.0.0

# Delete release branch
git branch -d release/v2.0.0
</code></pre>
<h2 id="daily-workflow-patterns"><a class="header" href="#daily-workflow-patterns">Daily Workflow Patterns</a></h2>
<h3 id="start-of-day"><a class="header" href="#start-of-day">Start of Day</a></h3>
<pre><code class="language-bash"># Update your local repository
git checkout main
git pull origin main

# Check what you were working on
git status
git log --oneline -5

# Resume work on feature branch
git checkout feature/my-feature
git rebase main
</code></pre>
<h3 id="during-development"><a class="header" href="#during-development">During Development</a></h3>
<pre><code class="language-bash"># Check status frequently
git status

# View changes before staging
git diff

# Stage changes selectively
git add -p  # Interactive staging

# Commit with meaningful message
git commit -m "feat: Add user authentication

Implement JWT-based authentication system with:
- Login endpoint
- Token validation middleware
- Logout functionality

Refs #123"

# Push to remote frequently
git push origin feature/my-feature

# Save work in progress without committing
git stash save "WIP: working on login form"
</code></pre>
<h3 id="before-creating-pull-request"><a class="header" href="#before-creating-pull-request">Before Creating Pull Request</a></h3>
<pre><code class="language-bash"># Make sure branch is up to date
git checkout main
git pull origin main
git checkout feature/my-feature
git rebase main

# Clean up commit history (if needed)
git rebase -i HEAD~5
# Squash, reword, or reorder commits

# Run tests
npm test  # or your test command

# Push updated branch
git push --force-with-lease origin feature/my-feature

# Create Pull Request on GitHub
</code></pre>
<h3 id="after-pull-request-review"><a class="header" href="#after-pull-request-review">After Pull Request Review</a></h3>
<pre><code class="language-bash"># Address review comments
git add .
git commit -m "Address PR feedback"

# Or amend last commit
git add .
git commit --amend --no-edit

# Force push (your PR branch)
git push --force-with-lease origin feature/my-feature
</code></pre>
<h3 id="end-of-day"><a class="header" href="#end-of-day">End of Day</a></h3>
<pre><code class="language-bash"># Commit work in progress
git add .
git commit -m "WIP: partial implementation"

# Or stash if not ready to commit
git stash save "WIP: end of day $(date)"

# Push to remote as backup
git push origin feature/my-feature
</code></pre>
<h3 id="working-with-multiple-features"><a class="header" href="#working-with-multiple-features">Working with Multiple Features</a></h3>
<pre><code class="language-bash"># Save current work
git stash

# Switch to different feature
git checkout feature/other-feature

# Work on it...
git add .
git commit -m "Update feature"

# Switch back to original feature
git checkout feature/my-feature
git stash pop
</code></pre>
<h2 id="common-workflow-scenarios"><a class="header" href="#common-workflow-scenarios">Common Workflow Scenarios</a></h2>
<h3 id="fixing-a-bug-in-production"><a class="header" href="#fixing-a-bug-in-production">Fixing a Bug in Production</a></h3>
<pre><code class="language-bash"># 1. Create hotfix branch from main
git checkout main
git pull origin main
git checkout -b hotfix/critical-bug

# 2. Fix the bug
git add .
git commit -m "fix: Resolve critical authentication bug

Fix issue where users couldn't login after password reset.

Fixes #456"

# 3. Test thoroughly
npm test

# 4. Merge to main
git checkout main
git merge --no-ff hotfix/critical-bug
git tag -a v1.0.1 -m "Hotfix release 1.0.1"

# 5. Push to production
git push origin main
git push origin v1.0.1

# 6. Merge back to develop
git checkout develop
git merge --no-ff hotfix/critical-bug

# 7. Cleanup
git branch -d hotfix/critical-bug
</code></pre>
<h3 id="syncing-fork-with-upstream"><a class="header" href="#syncing-fork-with-upstream">Syncing Fork with Upstream</a></h3>
<pre><code class="language-bash"># Add upstream if not already added
git remote add upstream https://github.com/original/repo.git

# Fetch upstream changes
git fetch upstream

# Merge upstream changes to main
git checkout main
git merge upstream/main

# Push to your fork
git push origin main

# Update your feature branch
git checkout feature/my-feature
git rebase main
</code></pre>
<h3 id="collaborating-on-a-branch"><a class="header" href="#collaborating-on-a-branch">Collaborating on a Branch</a></h3>
<pre><code class="language-bash"># Person A creates branch and pushes
git checkout -b feature/shared-feature
git add .
git commit -m "Initial implementation"
git push -u origin feature/shared-feature

# Person B clones and contributes
git fetch origin
git checkout feature/shared-feature
git add .
git commit -m "Add tests"
git push origin feature/shared-feature

# Person A pulls updates
git checkout feature/shared-feature
git pull origin feature/shared-feature
</code></pre>
<h3 id="recovering-from-mistakes"><a class="header" href="#recovering-from-mistakes">Recovering from Mistakes</a></h3>
<pre><code class="language-bash"># Undo last commit but keep changes
git reset --soft HEAD~1

# Discard all local changes
git reset --hard HEAD

# Recover deleted branch
git reflog
git checkout -b recovered-branch &lt;commit-hash&gt;

# Undo force push (if reflog available)
git reflog
git reset --hard HEAD@{n}
git push --force-with-lease

# Revert a merged PR
git revert -m 1 &lt;merge-commit-hash&gt;
git push origin main
</code></pre>
<h3 id="working-with-large-files"><a class="header" href="#working-with-large-files">Working with Large Files</a></h3>
<pre><code class="language-bash"># Install Git LFS
git lfs install

# Track large files
git lfs track "*.psd"
git lfs track "*.mp4"
git lfs track "datasets/*"

# Add .gitattributes
git add .gitattributes

# Add and commit large files
git add large-file.psd
git commit -m "Add design file"
git push origin main
</code></pre>
<h3 id="maintaining-clean-history"><a class="header" href="#maintaining-clean-history">Maintaining Clean History</a></h3>
<pre><code class="language-bash"># Squash commits before merging
git checkout feature/my-feature
git rebase -i main

# In editor, change "pick" to "squash" for commits to combine

# Rewrite commit message
git commit --amend

# Force push (only on feature branches!)
git push --force-with-lease origin feature/my-feature
</code></pre>
<h2 id="best-practices"><a class="header" href="#best-practices">Best Practices</a></h2>
<h3 id="commit-messages"><a class="header" href="#commit-messages">Commit Messages</a></h3>
<pre><code class="language-bash"># Good commit message structure:
# &lt;type&gt;: &lt;subject&gt;
# 
# &lt;body&gt;
# 
# &lt;footer&gt;

# Example:
git commit -m "feat: Add user authentication

Implement JWT-based authentication system with login and logout endpoints.
Uses bcrypt for password hashing.

Closes #123"

# Common types:
# feat:     New feature
# fix:      Bug fix
# docs:     Documentation changes
# style:    Formatting, missing semicolons, etc.
# refactor: Code restructuring
# test:     Adding tests
# chore:    Maintenance tasks
</code></pre>
<h3 id="general-best-practices"><a class="header" href="#general-best-practices">General Best Practices</a></h3>
<ol>
<li><strong>Commit Often</strong>: Make small, logical commits</li>
<li><strong>Write Clear Messages</strong>: Explain what and why</li>
<li><strong>Use Branches</strong>: Keep main stable</li>
<li><strong>Pull Before Push</strong>: Stay synchronized</li>
<li><strong>Review Before Commit</strong>: Check what you're committing</li>
<li><strong>Don't Commit Secrets</strong>: Use .gitignore for sensitive files</li>
<li><strong>Keep History Clean</strong>: Use rebase for feature branches</li>
<li><strong>Tag Releases</strong>: Mark important versions</li>
<li><strong>Backup Remote</strong>: Always have a remote backup</li>
<li><strong>Learn to Revert</strong>: Know how to undo mistakes</li>
</ol>
<h3 id="gitignore"><a class="header" href="#gitignore">.gitignore</a></h3>
<pre><code class="language-bash"># Create .gitignore file
cat &gt; .gitignore &lt;&lt; 'EOL'
# Dependencies
node_modules/
vendor/

# Environment files
.env
.env.local

# Build outputs
dist/
build/
*.log

# IDE files
.vscode/
.idea/
*.swp

# OS files
.DS_Store
Thumbs.db

# Compiled files
*.pyc
*.class
*.o
EOL

# Global gitignore
git config --global core.excludesfile ~/.gitignore_global
</code></pre>
<h2 id="troubleshooting"><a class="header" href="#troubleshooting">Troubleshooting</a></h2>
<h3 id="common-issues"><a class="header" href="#common-issues">Common Issues</a></h3>
<pre><code class="language-bash"># Undo last commit but keep changes
git reset --soft HEAD~1

# Fix wrong commit message
git commit --amend -m "Correct message"

# Recover deleted branch
git reflog
git checkout -b recovered-branch commit-hash

# Resolve "detached HEAD"
git checkout main

# Remove file from Git but keep locally
git rm --cached file.txt

# Update .gitignore for already tracked files
git rm -r --cached .
git add .
git commit -m "Update .gitignore"

# Find commit that introduced bug
git bisect start
git bisect bad
git bisect good commit-hash
</code></pre>
<h3 id="performance"><a class="header" href="#performance">Performance</a></h3>
<pre><code class="language-bash"># Clean up repository
git gc

# Aggressive cleanup
git gc --aggressive

# Prune unreachable objects
git prune

# Show repository size
git count-objects -vH
</code></pre>
<h2 id="git-aliases"><a class="header" href="#git-aliases">Git Aliases</a></h2>
<pre><code class="language-bash"># Create useful aliases
git config --global alias.co checkout
git config --global alias.br branch
git config --global alias.ci commit
git config --global alias.st status
git config --global alias.unstage 'reset HEAD --'
git config --global alias.last 'log -1 HEAD'
git config --global alias.visual 'log --graph --oneline --all'
git config --global alias.amend 'commit --amend --no-edit'

# Use aliases
git co main
git ci -m "Message"
git visual
</code></pre>
<h2 id="integration-with-github"><a class="header" href="#integration-with-github">Integration with GitHub</a></h2>
<p>GitHub adds collaboration features on top of Git. See the dedicated <a href="git/github.html">GitHub guide</a> for:</p>
<ul>
<li>Pull requests</li>
<li>Issues</li>
<li>Actions (CI/CD)</li>
<li>Pages</li>
<li>Wikis</li>
<li>Organizations and teams</li>
</ul>
<h2 id="available-resources"><a class="header" href="#available-resources">Available Resources</a></h2>
<ul>
<li><a href="git/cheatsheet.html">Git Cheat Sheet</a> - Quick reference guide</li>
<li><a href="git/commands.html">Git Commands</a> - Comprehensive command list</li>
<li><a href="git/github.html">GitHub Guide</a> - GitHub-specific features</li>
</ul>
<h2 id="learning-resources"><a class="header" href="#learning-resources">Learning Resources</a></h2>
<h3 id="documentation"><a class="header" href="#documentation">Documentation</a></h3>
<ul>
<li><a href="https://git-scm.com/doc">Official Git Documentation</a></li>
<li><a href="https://git-scm.com/book/en/v2">Pro Git Book</a> (free online)</li>
<li><a href="https://git-scm.com/docs">Git Reference</a></li>
</ul>
<h3 id="interactive-tutorials"><a class="header" href="#interactive-tutorials">Interactive Tutorials</a></h3>
<ul>
<li><a href="https://learngitbranching.js.org/">Learn Git Branching</a></li>
<li><a href="https://lab.github.com/">GitHub Learning Lab</a></li>
<li><a href="https://gitexercises.fracz.com/">Git Exercises</a></li>
</ul>
<h3 id="visualizations"><a class="header" href="#visualizations">Visualizations</a></h3>
<ul>
<li><a href="https://git-school.github.io/visualizing-git/">Visualizing Git Concepts</a></li>
<li><a href="https://nvie.com/posts/a-successful-git-branching-model/">Git Flow Diagram</a></li>
</ul>
<h2 id="quick-reference"><a class="header" href="#quick-reference">Quick Reference</a></h2>
<h3 id="daily-commands"><a class="header" href="#daily-commands">Daily Commands</a></h3>
<pre><code class="language-bash">git status                    # Check status
git add .                     # Stage all changes
git commit -m "message"       # Commit changes
git pull                      # Update from remote
git push                      # Push to remote
git log --oneline            # View history
</code></pre>
<h3 id="branching"><a class="header" href="#branching">Branching</a></h3>
<pre><code class="language-bash">git branch                    # List branches
git checkout -b feature       # Create and switch
git merge feature            # Merge branch
git branch -d feature        # Delete branch
</code></pre>
<h3 id="undoing"><a class="header" href="#undoing">Undoing</a></h3>
<pre><code class="language-bash">git reset --soft HEAD~1      # Undo commit, keep changes
git restore file.txt         # Discard file changes
git revert commit-hash       # Create revert commit
git stash                    # Save temporary changes
</code></pre>
<h3 id="remote"><a class="header" href="#remote">Remote</a></h3>
<pre><code class="language-bash">git remote -v                # List remotes
git fetch origin             # Download changes
git pull origin main         # Fetch and merge
git push origin main         # Upload changes
</code></pre>
<h2 id="next-steps"><a class="header" href="#next-steps">Next Steps</a></h2>
<ol>
<li>Practice basic commands: add, commit, push, pull</li>
<li>Learn branching and merging</li>
<li>Master undoing changes safely</li>
<li>Explore advanced features: rebase, cherry-pick, bisect</li>
<li>Set up GitHub account and create repositories</li>
<li>Contribute to open source projects</li>
<li>Learn Git workflows (Feature Branch, Gitflow)</li>
<li>Configure useful aliases and tools</li>
</ol>
<p>Remember: Git has a learning curve, but it's worth the investment. Start with the basics and gradually explore advanced features as needed.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="git-cheatsheet"><a class="header" href="#git-cheatsheet">Git Cheatsheet</a></h1>
<p>Quick reference for the most commonly used Git commands.</p>
<h2 id="setup-and-configuration"><a class="header" href="#setup-and-configuration">Setup and Configuration</a></h2>
<pre><code class="language-bash"># Initial setup
git config --global user.name "Your Name"
git config --global user.email "your.email@example.com"
git config --global core.editor "vim"
git config --global init.defaultBranch main

# View configuration
git config --list
git config user.name
</code></pre>
<h2 id="repository-creation"><a class="header" href="#repository-creation">Repository Creation</a></h2>
<pre><code class="language-bash"># Create new repository
git init

# Clone existing repository
git clone &lt;url&gt;
git clone &lt;url&gt; &lt;directory&gt;
git clone -b &lt;branch&gt; &lt;url&gt;
</code></pre>
<h2 id="daily-workflow"><a class="header" href="#daily-workflow">Daily Workflow</a></h2>
<pre><code class="language-bash"># Check status
git status
git status -s                # Short format

# Add files
git add &lt;file&gt;
git add .                    # Add all
git add -p                   # Interactive staging

# Commit changes
git commit -m "Message"
git commit -am "Message"     # Stage and commit
git commit --amend           # Modify last commit

# View history
git log
git log --oneline
git log --graph --oneline --all

# Push/Pull
git pull
git pull --rebase
git push
git push -u origin &lt;branch&gt;
</code></pre>
<h2 id="branching-1"><a class="header" href="#branching-1">Branching</a></h2>
<pre><code class="language-bash"># List branches
git branch                   # Local branches
git branch -a                # All branches
git branch -r                # Remote branches

# Create branch
git branch &lt;name&gt;
git checkout -b &lt;name&gt;       # Create and switch
git switch -c &lt;name&gt;         # Modern syntax

# Switch branches
git checkout &lt;name&gt;
git switch &lt;name&gt;
git checkout -               # Previous branch

# Delete branch
git branch -d &lt;name&gt;         # Safe delete
git branch -D &lt;name&gt;         # Force delete
git push origin --delete &lt;name&gt;  # Delete remote

# Rename branch
git branch -m &lt;new_name&gt;
</code></pre>
<h2 id="merging-and-rebasing"><a class="header" href="#merging-and-rebasing">Merging and Rebasing</a></h2>
<pre><code class="language-bash"># Merge
git merge &lt;branch&gt;
git merge --no-ff &lt;branch&gt;
git merge --squash &lt;branch&gt;
git merge --abort

# Rebase
git rebase &lt;branch&gt;
git rebase -i HEAD~3         # Interactive rebase
git rebase --continue
git rebase --abort

# Resolve conflicts
git status                   # Check conflicts
# Edit files to resolve
git add &lt;resolved_file&gt;
git commit                   # or git rebase --continue
</code></pre>
<h2 id="remote-operations"><a class="header" href="#remote-operations">Remote Operations</a></h2>
<pre><code class="language-bash"># List remotes
git remote -v

# Add/Remove remote
git remote add origin &lt;url&gt;
git remote remove &lt;name&gt;
git remote set-url origin &lt;new_url&gt;

# Fetch
git fetch
git fetch origin
git fetch --all
git fetch -p                 # Prune deleted branches

# Pull
git pull
git pull origin &lt;branch&gt;
git pull --rebase

# Push
git push
git push origin &lt;branch&gt;
git push -u origin &lt;branch&gt;
git push --tags
git push --force-with-lease  # Safer force push
</code></pre>
<h2 id="viewing-changes-1"><a class="header" href="#viewing-changes-1">Viewing Changes</a></h2>
<pre><code class="language-bash"># Show changes
git diff                     # Unstaged changes
git diff --staged            # Staged changes
git diff &lt;branch1&gt; &lt;branch2&gt;
git diff HEAD~1

# Show commits
git log
git log --oneline
git log -p                   # With patches
git log --stat               # With statistics
git log --author="Name"
git log --since="2 weeks ago"
git log --grep="pattern"

# Show commit details
git show &lt;commit&gt;
git show &lt;commit&gt;:&lt;file&gt;

# Blame
git blame &lt;file&gt;
</code></pre>
<h2 id="undoing-changes-1"><a class="header" href="#undoing-changes-1">Undoing Changes</a></h2>
<pre><code class="language-bash"># Discard changes in working directory
git restore &lt;file&gt;
git restore .
git checkout -- &lt;file&gt;       # Old syntax

# Unstage files
git restore --staged &lt;file&gt;
git reset HEAD &lt;file&gt;        # Old syntax

# Undo commits
git reset --soft HEAD~1      # Keep changes staged
git reset HEAD~1             # Keep changes unstaged
git reset --hard HEAD~1      # Discard changes
git revert &lt;commit&gt;          # Create reverting commit

# Clean untracked files
git clean -n                 # Dry run
git clean -f                 # Remove files
git clean -fd                # Remove files and directories
</code></pre>
<h2 id="stashing-1"><a class="header" href="#stashing-1">Stashing</a></h2>
<pre><code class="language-bash"># Save changes temporarily
git stash
git stash save "Message"
git stash -u                 # Include untracked

# List stashes
git stash list

# Apply stash
git stash apply
git stash apply stash@{2}
git stash pop                # Apply and remove

# Manage stashes
git stash show -p
git stash drop stash@{0}
git stash clear
</code></pre>
<h2 id="tags-1"><a class="header" href="#tags-1">Tags</a></h2>
<pre><code class="language-bash"># List tags
git tag
git tag -l "v1.*"

# Create tags
git tag &lt;name&gt;               # Lightweight
git tag -a &lt;name&gt; -m "Message"  # Annotated

# Push tags
git push origin &lt;tag&gt;
git push --tags

# Delete tags
git tag -d &lt;name&gt;
git push origin --delete &lt;name&gt;

# Checkout tag
git checkout &lt;tag&gt;
</code></pre>
<h2 id="advanced-commands"><a class="header" href="#advanced-commands">Advanced Commands</a></h2>
<pre><code class="language-bash"># Cherry-pick
git cherry-pick &lt;commit&gt;
git cherry-pick &lt;commit1&gt; &lt;commit2&gt;

# Bisect (find bug)
git bisect start
git bisect bad
git bisect good &lt;commit&gt;
# Test and mark good/bad
git bisect reset

# Reflog (recover lost commits)
git reflog
git checkout &lt;commit&gt;

# Archive
git archive --format=zip HEAD &gt; archive.zip

# Search
git grep "pattern"
git grep -n "pattern"        # With line numbers
git log -S "code"            # Commits with code
</code></pre>
<h2 id="collaboration-workflows"><a class="header" href="#collaboration-workflows">Collaboration Workflows</a></h2>
<h3 id="feature-branch-workflow-1"><a class="header" href="#feature-branch-workflow-1">Feature Branch Workflow</a></h3>
<pre><code class="language-bash"># Start new feature
git checkout -b feature/&lt;name&gt;

# Work on feature
git add .
git commit -m "Add feature"

# Push feature branch
git push -u origin feature/&lt;name&gt;

# After PR is merged
git checkout main
git pull
git branch -d feature/&lt;name&gt;
</code></pre>
<h3 id="sync-with-upstream"><a class="header" href="#sync-with-upstream">Sync with Upstream</a></h3>
<pre><code class="language-bash"># Fork workflow
git remote add upstream &lt;original_repo_url&gt;
git fetch upstream
git checkout main
git merge upstream/main
git push origin main
</code></pre>
<h3 id="hotfix-workflow"><a class="header" href="#hotfix-workflow">Hotfix Workflow</a></h3>
<pre><code class="language-bash"># Create hotfix from main
git checkout main
git checkout -b hotfix/&lt;issue&gt;

# Fix and commit
git add .
git commit -m "Fix issue"

# Merge to main and develop
git checkout main
git merge --no-ff hotfix/&lt;issue&gt;
git tag -a v1.0.1 -m "Version 1.0.1"

git checkout develop
git merge --no-ff hotfix/&lt;issue&gt;

# Cleanup
git branch -d hotfix/&lt;issue&gt;
</code></pre>
<h2 id="common-scenarios"><a class="header" href="#common-scenarios">Common Scenarios</a></h2>
<h3 id="forgot-to-create-branch"><a class="header" href="#forgot-to-create-branch">Forgot to create branch</a></h3>
<pre><code class="language-bash">git stash
git checkout -b feature/&lt;name&gt;
git stash pop
</code></pre>
<h3 id="undo-last-commit-but-keep-changes"><a class="header" href="#undo-last-commit-but-keep-changes">Undo last commit but keep changes</a></h3>
<pre><code class="language-bash">git reset --soft HEAD~1
</code></pre>
<h3 id="amend-commit-message"><a class="header" href="#amend-commit-message">Amend commit message</a></h3>
<pre><code class="language-bash">git commit --amend -m "New message"
</code></pre>
<h3 id="remove-file-from-git-but-keep-locally"><a class="header" href="#remove-file-from-git-but-keep-locally">Remove file from Git but keep locally</a></h3>
<pre><code class="language-bash">git rm --cached &lt;file&gt;
</code></pre>
<h3 id="sync-fork-with-original"><a class="header" href="#sync-fork-with-original">Sync fork with original</a></h3>
<pre><code class="language-bash">git fetch upstream
git checkout main
git merge upstream/main
git push origin main
</code></pre>
<h3 id="squash-last-n-commits"><a class="header" href="#squash-last-n-commits">Squash last N commits</a></h3>
<pre><code class="language-bash">git rebase -i HEAD~N
# Change "pick" to "squash" for commits to combine
</code></pre>
<h3 id="change-author-of-last-commit"><a class="header" href="#change-author-of-last-commit">Change author of last commit</a></h3>
<pre><code class="language-bash">git commit --amend --author="Name &lt;email&gt;"
</code></pre>
<h3 id="create-orphan-branch"><a class="header" href="#create-orphan-branch">Create orphan branch</a></h3>
<pre><code class="language-bash">git switch --orphan &lt;branch&gt;
git commit --allow-empty -m "Initial commit"
git push -u origin &lt;branch&gt;
</code></pre>
<h2 id="configuration-aliases"><a class="header" href="#configuration-aliases">Configuration Aliases</a></h2>
<pre><code class="language-bash"># Create useful aliases
git config --global alias.co checkout
git config --global alias.br branch
git config --global alias.ci commit
git config --global alias.st status
git config --global alias.unstage 'reset HEAD --'
git config --global alias.last 'log -1 HEAD'
git config --global alias.lg 'log --graph --oneline --all'
git config --global alias.amend 'commit --amend --no-edit'
</code></pre>
<h2 id="gitignore-patterns"><a class="header" href="#gitignore-patterns">.gitignore Patterns</a></h2>
<pre><code class="language-bash"># Ignore files
*.log
*.tmp
.env

# Ignore directories
node_modules/
dist/
build/

# Ignore with exceptions
*.a
!lib.a

# IDE files
.vscode/
.idea/
*.swp

# OS files
.DS_Store
Thumbs.db
</code></pre>
<h2 id="common-options"><a class="header" href="#common-options">Common Options</a></h2>
<pre><code class="language-bash"># Flags used with multiple commands
-a, --all               # All
-b, --branch            # Branch
-d, --delete            # Delete
-f, --force             # Force
-m, --message           # Message
-n, --dry-run           # Dry run
-p, --patch             # Interactive patch mode
-u, --set-upstream      # Set upstream
-v, --verbose           # Verbose output

# Common patterns
HEAD                    # Current commit
HEAD~1                  # Previous commit
HEAD~n                  # N commits ago
HEAD^                   # First parent of merge
&lt;commit&gt;                # Commit hash
&lt;branch&gt;                # Branch name
origin                  # Default remote name
main/master             # Default branch names
</code></pre>
<h2 id="emergency-commands"><a class="header" href="#emergency-commands">Emergency Commands</a></h2>
<pre><code class="language-bash"># Abort everything
git merge --abort
git rebase --abort
git cherry-pick --abort

# Recover lost work
git reflog
git checkout &lt;lost_commit&gt;
git branch recover-branch &lt;lost_commit&gt;

# Undo force push (if possible)
git reflog
git reset --hard &lt;previous_commit&gt;
git push --force-with-lease

# Remove sensitive data from history
git filter-branch --force --index-filter \
  "git rm --cached --ignore-unmatch &lt;file&gt;" \
  --prune-empty --tag-name-filter cat -- --all
</code></pre>
<h2 id="quick-reference-git-states"><a class="header" href="#quick-reference-git-states">Quick Reference: Git States</a></h2>
<pre><code>Working Directory → Staging Area → Repository → Remote
      (edit)          (add)        (commit)    (push)
</code></pre>
<h2 id="quick-reference-undoing"><a class="header" href="#quick-reference-undoing">Quick Reference: Undoing</a></h2>
<pre><code>Working Directory:    git restore &lt;file&gt;
Staging Area:         git restore --staged &lt;file&gt;
Last Commit:          git commit --amend
Previous Commits:     git revert &lt;commit&gt;
Local Branch:         git reset --hard &lt;commit&gt;
</code></pre>
<h2 id="quick-reference-branch-management"><a class="header" href="#quick-reference-branch-management">Quick Reference: Branch Management</a></h2>
<pre><code>Create:    git checkout -b &lt;name&gt;
Switch:    git switch &lt;name&gt;
Merge:     git merge &lt;name&gt;
Delete:    git branch -d &lt;name&gt;
Remote:    git push -u origin &lt;name&gt;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="git-commands-reference"><a class="header" href="#git-commands-reference">Git Commands Reference</a></h1>
<p>Comprehensive reference of Git commands organized by category.</p>
<h2 id="repository-setup"><a class="header" href="#repository-setup">Repository Setup</a></h2>
<h3 id="initialize-repository"><a class="header" href="#initialize-repository">Initialize Repository</a></h3>
<pre><code class="language-bash"># Create new Git repository
git init

# Initialize with specific branch name
git init -b main

# Create bare repository (for remote)
git init --bare
</code></pre>
<h3 id="clone-repository"><a class="header" href="#clone-repository">Clone Repository</a></h3>
<pre><code class="language-bash"># Clone repository
git clone &lt;repository_url&gt;

# Clone to specific directory
git clone &lt;repository_url&gt; &lt;directory&gt;

# Clone specific branch
git clone -b &lt;branch&gt; &lt;repository_url&gt;

# Shallow clone (limited history)
git clone --depth 1 &lt;repository_url&gt;

# Clone with submodules
git clone --recursive &lt;repository_url&gt;
</code></pre>
<h2 id="configuration"><a class="header" href="#configuration">Configuration</a></h2>
<h3 id="user-settings"><a class="header" href="#user-settings">User Settings</a></h3>
<pre><code class="language-bash"># Set user name
git config --global user.name "Your Name"

# Set user email
git config --global user.email "your.email@example.com"

# View user name
git config user.name

# View user email
git config user.email
</code></pre>
<h3 id="repository-settings"><a class="header" href="#repository-settings">Repository Settings</a></h3>
<pre><code class="language-bash"># Set local config (repository-specific)
git config user.name "Your Name"

# Set editor
git config --global core.editor "vim"

# Set default branch name
git config --global init.defaultBranch main

# Enable color output
git config --global color.ui auto

# Set merge strategy
git config --global pull.rebase false

# View all config
git config --list

# View specific config
git config &lt;key&gt;

# Edit config file
git config --global --edit
</code></pre>
<h3 id="aliases"><a class="header" href="#aliases">Aliases</a></h3>
<pre><code class="language-bash"># Create alias
git config --global alias.co checkout
git config --global alias.br branch
git config --global alias.ci commit
git config --global alias.st status
git config --global alias.last 'log -1 HEAD'
git config --global alias.visual 'log --graph --oneline --all'
</code></pre>
<h2 id="basic-operations"><a class="header" href="#basic-operations">Basic Operations</a></h2>
<h3 id="status-and-information"><a class="header" href="#status-and-information">Status and Information</a></h3>
<pre><code class="language-bash"># Show working tree status
git status

# Short status
git status -s

# Show status with branch info
git status -sb

# List all tracked files
git ls-files

# Show repository info
git remote show origin
</code></pre>
<h3 id="add-files"><a class="header" href="#add-files">Add Files</a></h3>
<pre><code class="language-bash"># Add specific file
git add &lt;file&gt;

# Add all files
git add .

# Add all files in directory
git add &lt;directory&gt;/

# Add by pattern
git add *.js

# Add interactively
git add -i

# Add patch (selective staging)
git add -p

# Add all (including deleted)
git add -A

# Add modified and deleted (not new)
git add -u
</code></pre>
<h3 id="commit-changes"><a class="header" href="#commit-changes">Commit Changes</a></h3>
<pre><code class="language-bash"># Commit staged changes
git commit -m "Commit message"

# Commit with detailed message (opens editor)
git commit

# Stage all tracked files and commit
git commit -am "Commit message"

# Amend last commit
git commit --amend

# Amend without changing message
git commit --amend --no-edit

# Amend and change author
git commit --amend --author="Name &lt;email&gt;"

# Empty commit (no changes)
git commit --allow-empty -m "Empty commit"

# Commit with specific date
git commit --date="2024-01-01" -m "Message"
</code></pre>
<h3 id="remove-and-move-files"><a class="header" href="#remove-and-move-files">Remove and Move Files</a></h3>
<pre><code class="language-bash"># Remove file from working directory and staging
git rm &lt;file&gt;

# Remove file from staging only (keep in working directory)
git rm --cached &lt;file&gt;

# Remove directory
git rm -r &lt;directory&gt;

# Move/rename file
git mv &lt;old_name&gt; &lt;new_name&gt;
</code></pre>
<h2 id="viewing-history-1"><a class="header" href="#viewing-history-1">Viewing History</a></h2>
<h3 id="log"><a class="header" href="#log">Log</a></h3>
<pre><code class="language-bash"># View commit history
git log

# Compact one-line log
git log --oneline

# Graph view
git log --graph --oneline --all

# Decorate with branch/tag names
git log --decorate

# Pretty format
git log --pretty=format:"%h - %an, %ar : %s"

# Limit number of commits
git log -n 5
git log -5

# Show commits by author
git log --author="John"

# Show commits in date range
git log --since="2 weeks ago"
git log --after="2024-01-01"
git log --until="2024-12-31"
git log --before="2024-12-31"

# Show file statistics
git log --stat

# Show detailed patch
git log -p

# Show commits affecting specific file
git log -- &lt;file&gt;

# Search commit messages
git log --grep="fix bug"

# Show commits that added/removed specific text
git log -S "function_name"

# Show commits by committer (not author)
git log --committer="John"

# Show merge commits only
git log --merges

# Show non-merge commits
git log --no-merges

# Show first parent only
git log --first-parent
</code></pre>
<h3 id="show-commit-details"><a class="header" href="#show-commit-details">Show Commit Details</a></h3>
<pre><code class="language-bash"># Show commit details
git show &lt;commit&gt;

# Show specific file at commit
git show &lt;commit&gt;:&lt;file&gt;

# Show commit statistics
git show --stat &lt;commit&gt;

# Show commit names only
git show --name-only &lt;commit&gt;

# Show commit with word diff
git show --word-diff &lt;commit&gt;
</code></pre>
<h3 id="diff"><a class="header" href="#diff">Diff</a></h3>
<pre><code class="language-bash"># Show unstaged changes
git diff

# Show staged changes
git diff --staged
git diff --cached

# Show changes in specific file
git diff &lt;file&gt;

# Compare branches
git diff &lt;branch1&gt;..&lt;branch2&gt;

# Compare commits
git diff &lt;commit1&gt; &lt;commit2&gt;

# Compare with specific commit
git diff HEAD~1

# Word-level diff
git diff --word-diff

# Show statistics only
git diff --stat

# Show file names only
git diff --name-only

# Show file names with status
git diff --name-status

# Ignore whitespace
git diff -w
git diff --ignore-all-space
</code></pre>
<h3 id="blame"><a class="header" href="#blame">Blame</a></h3>
<pre><code class="language-bash"># Show who changed each line
git blame &lt;file&gt;

# Show blame for specific lines
git blame -L 10,20 &lt;file&gt;

# Show blame with email
git blame -e &lt;file&gt;

# Ignore whitespace changes
git blame -w &lt;file&gt;
</code></pre>
<h3 id="reflog"><a class="header" href="#reflog">Reflog</a></h3>
<pre><code class="language-bash"># Show reference log (command history)
git reflog

# Show reflog for specific branch
git reflog &lt;branch&gt;

# Show reflog with dates
git reflog --date=relative

# Expire old reflog entries
git reflog expire --expire=30.days.ago --all
</code></pre>
<h2 id="branching-2"><a class="header" href="#branching-2">Branching</a></h2>
<h3 id="create-and-switch-branches"><a class="header" href="#create-and-switch-branches">Create and Switch Branches</a></h3>
<pre><code class="language-bash"># List branches
git branch

# List all branches (including remote)
git branch -a

# List remote branches
git branch -r

# Create new branch
git branch &lt;branch_name&gt;

# Create branch from specific commit
git branch &lt;branch_name&gt; &lt;commit&gt;

# Switch to branch
git checkout &lt;branch_name&gt;

# Create and switch to new branch
git checkout -b &lt;branch_name&gt;

# Create branch from specific commit and switch
git checkout -b &lt;branch_name&gt; &lt;commit&gt;

# Modern syntax (Git 2.23+)
git switch &lt;branch_name&gt;
git switch -c &lt;branch_name&gt;

# Switch to previous branch
git checkout -
git switch -
</code></pre>
<h3 id="delete-branches"><a class="header" href="#delete-branches">Delete Branches</a></h3>
<pre><code class="language-bash"># Delete local branch (safe)
git branch -d &lt;branch_name&gt;

# Force delete local branch
git branch -D &lt;branch_name&gt;

# Delete remote branch
git push origin --delete &lt;branch_name&gt;
git push origin :&lt;branch_name&gt;
</code></pre>
<h3 id="rename-branches"><a class="header" href="#rename-branches">Rename Branches</a></h3>
<pre><code class="language-bash"># Rename current branch
git branch -m &lt;new_name&gt;

# Rename specific branch
git branch -m &lt;old_name&gt; &lt;new_name&gt;

# Rename and push to remote
git branch -m &lt;new_name&gt;
git push origin -u &lt;new_name&gt;
git push origin --delete &lt;old_name&gt;
</code></pre>
<h3 id="branch-information"><a class="header" href="#branch-information">Branch Information</a></h3>
<pre><code class="language-bash"># Show branches with last commit
git branch -v

# Show merged branches
git branch --merged

# Show unmerged branches
git branch --no-merged

# Show branches containing commit
git branch --contains &lt;commit&gt;

# Track remote branch
git branch --set-upstream-to=origin/&lt;branch&gt;
git branch -u origin/&lt;branch&gt;
</code></pre>
<h2 id="merging-1"><a class="header" href="#merging-1">Merging</a></h2>
<h3 id="basic-merge"><a class="header" href="#basic-merge">Basic Merge</a></h3>
<pre><code class="language-bash"># Merge branch into current branch
git merge &lt;branch&gt;

# Merge with commit message
git merge &lt;branch&gt; -m "Merge message"

# Merge without fast-forward
git merge --no-ff &lt;branch&gt;

# Merge with fast-forward only
git merge --ff-only &lt;branch&gt;

# Squash merge (combine all commits)
git merge --squash &lt;branch&gt;

# Abort merge
git merge --abort

# Continue merge after resolving conflicts
git merge --continue
</code></pre>
<h3 id="merge-strategies"><a class="header" href="#merge-strategies">Merge Strategies</a></h3>
<pre><code class="language-bash"># Use recursive strategy (default)
git merge -s recursive &lt;branch&gt;

# Use ours strategy (keep our version)
git merge -s ours &lt;branch&gt;

# Use theirs strategy
git merge -X theirs &lt;branch&gt;

# Ignore whitespace during merge
git merge -X ignore-all-space &lt;branch&gt;
</code></pre>
<h2 id="rebasing-1"><a class="header" href="#rebasing-1">Rebasing</a></h2>
<h3 id="basic-rebase"><a class="header" href="#basic-rebase">Basic Rebase</a></h3>
<pre><code class="language-bash"># Rebase current branch onto another
git rebase &lt;branch&gt;

# Rebase onto specific commit
git rebase &lt;commit&gt;

# Continue rebase after resolving conflicts
git rebase --continue

# Skip current commit
git rebase --skip

# Abort rebase
git rebase --abort

# Rebase and preserve merges
git rebase -p &lt;branch&gt;
</code></pre>
<h3 id="interactive-rebase"><a class="header" href="#interactive-rebase">Interactive Rebase</a></h3>
<pre><code class="language-bash"># Interactive rebase last N commits
git rebase -i HEAD~3

# Interactive rebase from specific commit
git rebase -i &lt;commit&gt;

# Interactive rebase with autosquash
git rebase -i --autosquash &lt;branch&gt;

# Commands in interactive rebase:
# pick (p)   = use commit
# reword (r) = use commit, but edit message
# edit (e)   = use commit, but stop for amending
# squash (s) = merge with previous commit
# fixup (f)  = like squash, but discard message
# drop (d)   = remove commit
# exec (x)   = run shell command
</code></pre>
<h2 id="remote-operations-1"><a class="header" href="#remote-operations-1">Remote Operations</a></h2>
<h3 id="remote-management"><a class="header" href="#remote-management">Remote Management</a></h3>
<pre><code class="language-bash"># List remotes
git remote

# List remotes with URLs
git remote -v

# Add remote
git remote add &lt;name&gt; &lt;url&gt;

# Remove remote
git remote remove &lt;name&gt;
git remote rm &lt;name&gt;

# Rename remote
git remote rename &lt;old&gt; &lt;new&gt;

# Change remote URL
git remote set-url &lt;name&gt; &lt;new_url&gt;

# Show remote details
git remote show &lt;name&gt;

# Prune stale remote branches
git remote prune origin
</code></pre>
<h3 id="fetch"><a class="header" href="#fetch">Fetch</a></h3>
<pre><code class="language-bash"># Fetch from remote
git fetch

# Fetch from specific remote
git fetch &lt;remote&gt;

# Fetch specific branch
git fetch &lt;remote&gt; &lt;branch&gt;

# Fetch all remotes
git fetch --all

# Fetch and prune deleted remote branches
git fetch -p
git fetch --prune

# Fetch tags
git fetch --tags

# Dry run (show what would be fetched)
git fetch --dry-run
</code></pre>
<h3 id="pull"><a class="header" href="#pull">Pull</a></h3>
<pre><code class="language-bash"># Pull from tracked remote branch
git pull

# Pull from specific remote and branch
git pull &lt;remote&gt; &lt;branch&gt;

# Pull with rebase
git pull --rebase

# Pull with fast-forward only
git pull --ff-only

# Pull all submodules
git pull --recurse-submodules

# Pull and prune
git pull -p
</code></pre>
<h3 id="push"><a class="header" href="#push">Push</a></h3>
<pre><code class="language-bash"># Push to remote
git push

# Push to specific remote and branch
git push &lt;remote&gt; &lt;branch&gt;

# Push and set upstream
git push -u &lt;remote&gt; &lt;branch&gt;

# Push all branches
git push --all

# Push tags
git push --tags

# Push specific tag
git push &lt;remote&gt; &lt;tag&gt;

# Force push (dangerous!)
git push --force

# Safer force push (checks remote state)
git push --force-with-lease

# Delete remote branch
git push &lt;remote&gt; --delete &lt;branch&gt;

# Delete remote tag
git push &lt;remote&gt; --delete &lt;tag&gt;

# Dry run (show what would be pushed)
git push --dry-run
</code></pre>
<h2 id="undoing-changes-2"><a class="header" href="#undoing-changes-2">Undoing Changes</a></h2>
<h3 id="working-directory-1"><a class="header" href="#working-directory-1">Working Directory</a></h3>
<pre><code class="language-bash"># Discard changes in file
git checkout -- &lt;file&gt;

# Discard all changes
git checkout -- .

# Modern syntax
git restore &lt;file&gt;
git restore .

# Restore from specific commit
git restore --source=&lt;commit&gt; &lt;file&gt;

# Clean untracked files
git clean -f

# Clean untracked files and directories
git clean -fd

# Clean ignored files too
git clean -fdx

# Dry run (show what would be removed)
git clean -n
</code></pre>
<h3 id="staging-area-1"><a class="header" href="#staging-area-1">Staging Area</a></h3>
<pre><code class="language-bash"># Unstage file
git reset HEAD &lt;file&gt;

# Unstage all files
git reset HEAD

# Modern syntax
git restore --staged &lt;file&gt;
git restore --staged .
</code></pre>
<h3 id="commits-1"><a class="header" href="#commits-1">Commits</a></h3>
<pre><code class="language-bash"># Undo last commit, keep changes staged
git reset --soft HEAD~1

# Undo last commit, keep changes unstaged
git reset --mixed HEAD~1
git reset HEAD~1

# Undo last commit, discard changes
git reset --hard HEAD~1

# Reset to specific commit
git reset --hard &lt;commit&gt;

# Create new commit that undoes changes
git revert &lt;commit&gt;

# Revert merge commit
git revert -m 1 &lt;merge_commit&gt;

# Revert without committing
git revert -n &lt;commit&gt;

# Revert range of commits
git revert &lt;commit1&gt;..&lt;commit2&gt;
</code></pre>
<h2 id="stashing-2"><a class="header" href="#stashing-2">Stashing</a></h2>
<h3 id="basic-stash"><a class="header" href="#basic-stash">Basic Stash</a></h3>
<pre><code class="language-bash"># Stash current changes
git stash

# Stash with message
git stash save "Work in progress"
git stash push -m "Work in progress"

# Stash including untracked files
git stash -u
git stash --include-untracked

# Stash including ignored files
git stash -a
git stash --all

# Stash specific files
git stash push &lt;file&gt;

# Stash with patch mode
git stash -p
</code></pre>
<h3 id="managing-stashes"><a class="header" href="#managing-stashes">Managing Stashes</a></h3>
<pre><code class="language-bash"># List stashes
git stash list

# Show stash contents
git stash show
git stash show -p

# Show specific stash
git stash show stash@{1}

# Apply last stash
git stash apply

# Apply specific stash
git stash apply stash@{1}

# Apply and remove stash (pop)
git stash pop

# Pop specific stash
git stash pop stash@{1}

# Create branch from stash
git stash branch &lt;branch_name&gt;

# Drop specific stash
git stash drop stash@{1}

# Clear all stashes
git stash clear
</code></pre>
<h2 id="tags-2"><a class="header" href="#tags-2">Tags</a></h2>
<h3 id="create-tags"><a class="header" href="#create-tags">Create Tags</a></h3>
<pre><code class="language-bash"># List tags
git tag

# List tags with pattern
git tag -l "v1.*"

# Create lightweight tag
git tag &lt;tag_name&gt;

# Create annotated tag
git tag -a &lt;tag_name&gt; -m "Tag message"

# Tag specific commit
git tag &lt;tag_name&gt; &lt;commit&gt;

# Tag with specific date
git tag -a &lt;tag_name&gt; -m "Message" --date="2024-01-01"
</code></pre>
<h3 id="manage-tags"><a class="header" href="#manage-tags">Manage Tags</a></h3>
<pre><code class="language-bash"># Show tag details
git show &lt;tag_name&gt;

# Delete local tag
git tag -d &lt;tag_name&gt;

# Delete remote tag
git push origin --delete &lt;tag_name&gt;
git push origin :refs/tags/&lt;tag_name&gt;

# Push tag to remote
git push origin &lt;tag_name&gt;

# Push all tags
git push --tags

# Fetch tags from remote
git fetch --tags

# Checkout tag (creates detached HEAD)
git checkout &lt;tag_name&gt;

# Create branch from tag
git checkout -b &lt;branch_name&gt; &lt;tag_name&gt;
</code></pre>
<h2 id="advanced-operations"><a class="header" href="#advanced-operations">Advanced Operations</a></h2>
<h3 id="cherry-pick-1"><a class="header" href="#cherry-pick-1">Cherry-Pick</a></h3>
<pre><code class="language-bash"># Apply specific commit
git cherry-pick &lt;commit&gt;

# Apply multiple commits
git cherry-pick &lt;commit1&gt; &lt;commit2&gt;

# Apply commit range
git cherry-pick &lt;commit1&gt;..&lt;commit2&gt;

# Cherry-pick without committing
git cherry-pick -n &lt;commit&gt;

# Continue cherry-pick
git cherry-pick --continue

# Abort cherry-pick
git cherry-pick --abort

# Skip current commit
git cherry-pick --skip
</code></pre>
<h3 id="bisect-1"><a class="header" href="#bisect-1">Bisect</a></h3>
<pre><code class="language-bash"># Start bisect
git bisect start

# Mark current commit as bad
git bisect bad

# Mark current commit as good
git bisect good

# Mark specific commit as good
git bisect good &lt;commit&gt;

# Skip current commit
git bisect skip

# Reset bisect
git bisect reset

# Visualize bisect
git bisect visualize

# Run automated bisect
git bisect run &lt;script&gt;
</code></pre>
<h3 id="submodules"><a class="header" href="#submodules">Submodules</a></h3>
<pre><code class="language-bash"># Add submodule
git submodule add &lt;repository_url&gt; &lt;path&gt;

# Initialize submodules
git submodule init

# Update submodules
git submodule update

# Clone with submodules
git clone --recursive &lt;repository_url&gt;

# Update all submodules
git submodule update --remote

# Remove submodule
git submodule deinit &lt;path&gt;
git rm &lt;path&gt;

# Show submodule status
git submodule status

# Foreach command on all submodules
git submodule foreach &lt;command&gt;
</code></pre>
<h3 id="worktrees"><a class="header" href="#worktrees">Worktrees</a></h3>
<pre><code class="language-bash"># List worktrees
git worktree list

# Add new worktree
git worktree add &lt;path&gt; &lt;branch&gt;

# Add worktree with new branch
git worktree add -b &lt;new_branch&gt; &lt;path&gt;

# Remove worktree
git worktree remove &lt;path&gt;

# Prune worktree information
git worktree prune
</code></pre>
<h3 id="archive"><a class="header" href="#archive">Archive</a></h3>
<pre><code class="language-bash"># Create archive of repository
git archive --format=zip HEAD &gt; archive.zip

# Archive specific branch
git archive --format=tar &lt;branch&gt; &gt; archive.tar

# Archive with prefix
git archive --prefix=project/ HEAD &gt; archive.tar

# Archive specific directory
git archive HEAD &lt;directory&gt;/ &gt; archive.tar
</code></pre>
<h2 id="maintenance"><a class="header" href="#maintenance">Maintenance</a></h2>
<h3 id="repository-maintenance"><a class="header" href="#repository-maintenance">Repository Maintenance</a></h3>
<pre><code class="language-bash"># Run garbage collection
git gc

# Aggressive garbage collection
git gc --aggressive

# Prune unreachable objects
git prune

# Verify repository integrity
git fsck

# Show repository statistics
git count-objects -v

# Show repository size
git count-objects -vH
</code></pre>
<h3 id="optimization"><a class="header" href="#optimization">Optimization</a></h3>
<pre><code class="language-bash"># Repack repository
git repack

# Aggressive repack
git repack -a -d --depth=250 --window=250

# Prune old reflog entries
git reflog expire --expire=30.days.ago --all

# Remove old objects
git prune --expire=30.days.ago
</code></pre>
<h2 id="searching"><a class="header" href="#searching">Searching</a></h2>
<h3 id="grep"><a class="header" href="#grep">Grep</a></h3>
<pre><code class="language-bash"># Search for text in repository
git grep "pattern"

# Search with line numbers
git grep -n "pattern"

# Search for whole word
git grep -w "pattern"

# Search case-insensitively
git grep -i "pattern"

# Search in specific commit
git grep "pattern" &lt;commit&gt;

# Search with context
git grep -C 2 "pattern"

# Show file names only
git grep -l "pattern"

# Count matches per file
git grep -c "pattern"

# Search with AND condition
git grep -e "pattern1" --and -e "pattern2"

# Search with OR condition
git grep -e "pattern1" --or -e "pattern2"
</code></pre>
<h3 id="log-search"><a class="header" href="#log-search">Log Search</a></h3>
<pre><code class="language-bash"># Search commit messages
git log --grep="pattern"

# Search commit content
git log -S "code"

# Search with pickaxe (show diff)
git log -G "regex"

# Search author
git log --author="name"

# Search committer
git log --committer="name"
</code></pre>
<h2 id="help"><a class="header" href="#help">Help</a></h2>
<pre><code class="language-bash"># Show help for command
git help &lt;command&gt;
git &lt;command&gt; --help

# Show quick help
git &lt;command&gt; -h

# Show all commands
git help -a

# Show guides
git help -g

# Show config options
git help config
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="github"><a class="header" href="#github">GitHub</a></h1>
<p>GitHub is a web-based platform that provides hosting for Git repositories along with collaboration features, CI/CD, project management, and more.</p>
<h2 id="quick-start"><a class="header" href="#quick-start">Quick Start</a></h2>
<h3 id="ssh-setup"><a class="header" href="#ssh-setup">SSH Setup</a></h3>
<pre><code class="language-bash"># Generate SSH key
ssh-keygen -t ed25519 -C "your.email@example.com"

# Start SSH agent
eval "$(ssh-agent -s)"

# Add SSH key to agent
ssh-add ~/.ssh/id_ed25519

# Copy public key to clipboard
cat ~/.ssh/id_ed25519.pub
# Then paste in GitHub Settings → SSH and GPG keys → New SSH key
</code></pre>
<h3 id="clone-repository-1"><a class="header" href="#clone-repository-1">Clone Repository</a></h3>
<pre><code class="language-bash"># Using SSH (recommended)
git clone git@github.com:&lt;username&gt;/&lt;repository&gt;.git

# Using HTTPS
git clone https://github.com/&lt;username&gt;/&lt;repository&gt;.git

# Create new branch
git switch -c &lt;new_branch&gt;

# Push branch to remote
git push -u origin &lt;new_branch&gt;
</code></pre>
<h2 id="pull-request-workflow"><a class="header" href="#pull-request-workflow">Pull Request Workflow</a></h2>
<h3 id="creating-a-pull-request"><a class="header" href="#creating-a-pull-request">Creating a Pull Request</a></h3>
<pre><code class="language-bash"># 1. Create and switch to feature branch
git checkout -b feature/new-feature

# 2. Make changes and commit
git add .
git commit -m "feat: Add new feature"

# 3. Push branch to GitHub
git push -u origin feature/new-feature

# 4. Open browser and create PR
# Navigate to repository → Pull requests → New pull request
# Select your branch → Create pull request

# Or use GitHub CLI
gh pr create --title "Add new feature" --body "Description of changes"
</code></pre>
<h3 id="working-on-pull-request"><a class="header" href="#working-on-pull-request">Working on Pull Request</a></h3>
<pre><code class="language-bash"># After creating PR, make additional commits
git add .
git commit -m "Address feedback"
git push origin feature/new-feature

# Update PR with latest main
git checkout main
git pull origin main
git checkout feature/new-feature
git rebase main
git push --force-with-lease origin feature/new-feature

# Request review
gh pr review &lt;pr-number&gt; --request-changes --body "Please fix..."
gh pr review &lt;pr-number&gt; --approve --body "LGTM!"
</code></pre>
<h3 id="reviewing-pull-requests"><a class="header" href="#reviewing-pull-requests">Reviewing Pull Requests</a></h3>
<pre><code class="language-bash"># Check out PR locally
gh pr checkout &lt;pr-number&gt;
# Or manually:
git fetch origin pull/&lt;pr-number&gt;/head:pr-&lt;pr-number&gt;
git checkout pr-&lt;pr-number&gt;

# Test changes
npm test
npm run build

# Add review comments
gh pr review &lt;pr-number&gt; --comment --body "Looks good!"

# Approve PR
gh pr review &lt;pr-number&gt; --approve

# Request changes
gh pr review &lt;pr-number&gt; --request-changes --body "Please address..."
</code></pre>
<h3 id="merging-pull-requests"><a class="header" href="#merging-pull-requests">Merging Pull Requests</a></h3>
<pre><code class="language-bash"># Merge via GitHub CLI
gh pr merge &lt;pr-number&gt; --merge
gh pr merge &lt;pr-number&gt; --squash
gh pr merge &lt;pr-number&gt; --rebase

# Via web interface:
# - Merge commit: Preserves all commits
# - Squash and merge: Combines all commits into one
# - Rebase and merge: Adds commits to base branch

# After merging, cleanup
git checkout main
git pull origin main
git branch -d feature/new-feature
</code></pre>
<h2 id="github-issues"><a class="header" href="#github-issues">GitHub Issues</a></h2>
<h3 id="creating-issues"><a class="header" href="#creating-issues">Creating Issues</a></h3>
<pre><code class="language-bash"># Create issue via CLI
gh issue create --title "Bug: Login fails" --body "Description of bug"

# Create with labels
gh issue create --title "Feature request" --label "enhancement"

# List issues
gh issue list
gh issue list --label "bug"
gh issue list --assignee "@me"

# View issue
gh issue view &lt;issue-number&gt;
</code></pre>
<h3 id="working-with-issues"><a class="header" href="#working-with-issues">Working with Issues</a></h3>
<pre><code class="language-bash"># Assign issue
gh issue edit &lt;issue-number&gt; --add-assignee "@me"

# Add labels
gh issue edit &lt;issue-number&gt; --add-label "bug,high-priority"

# Close issue
gh issue close &lt;issue-number&gt;

# Reopen issue
gh issue reopen &lt;issue-number&gt;

# Link PR to issue (in commit or PR description)
git commit -m "Fix login bug

Fixes #123"
# Or "Closes #123", "Resolves #123"
</code></pre>
<h3 id="issue-templates"><a class="header" href="#issue-templates">Issue Templates</a></h3>
<p>Create <code>.github/ISSUE_TEMPLATE/bug_report.md</code>:</p>
<pre><code class="language-markdown">---
name: Bug Report
about: Create a report to help us improve
title: '[BUG] '
labels: bug
assignees: ''
---

**Describe the bug**
A clear and concise description of what the bug is.

**To Reproduce**
Steps to reproduce the behavior:
1. Go to '...'
2. Click on '....'
3. See error

**Expected behavior**
A clear description of what you expected to happen.

**Screenshots**
If applicable, add screenshots.

**Environment:**
- OS: [e.g. Ubuntu 22.04]
- Browser: [e.g. Chrome 120]
- Version: [e.g. v1.2.3]
</code></pre>
<h2 id="github-actions-cicd"><a class="header" href="#github-actions-cicd">GitHub Actions (CI/CD)</a></h2>
<h3 id="basic-workflow"><a class="header" href="#basic-workflow">Basic Workflow</a></h3>
<p>Create <code>.github/workflows/ci.yml</code>:</p>
<pre><code class="language-yaml">name: CI

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v3

    - name: Setup Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '18'

    - name: Install dependencies
      run: npm ci

    - name: Run tests
      run: npm test

    - name: Run linter
      run: npm run lint

    - name: Build
      run: npm run build
</code></pre>
<h3 id="action-permissions"><a class="header" href="#action-permissions">Action Permissions</a></h3>
<pre><code class="language-bash"># Enable workflow permissions
# Repository Settings → Actions → General → Workflow permissions
# Select: Read and write permissions

# Or in workflow file
permissions:
  contents: write
  pull-requests: write
  issues: write
</code></pre>
<h3 id="deployment-workflow"><a class="header" href="#deployment-workflow">Deployment Workflow</a></h3>
<p>Create <code>.github/workflows/deploy.yml</code>:</p>
<pre><code class="language-yaml">name: Deploy

on:
  push:
    branches: [ main ]
  release:
    types: [ published ]

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v3

    - name: Build
      run: npm run build

    - name: Deploy to GitHub Pages
      uses: peaceiris/actions-gh-pages@v3
      with:
        github_token: ${{ secrets.GITHUB_TOKEN }}
        publish_dir: ./build
        cname: yourdomain.com
</code></pre>
<h3 id="useful-github-actions"><a class="header" href="#useful-github-actions">Useful GitHub Actions</a></h3>
<pre><code class="language-yaml"># Test on multiple Node versions
strategy:
  matrix:
    node-version: [16, 18, 20]

# Cache dependencies
- name: Cache node modules
  uses: actions/cache@v3
  with:
    path: ~/.npm
    key: ${{ runner.os }}-node-${{ hashFiles('**/package-lock.json') }}

# Create release
- name: Create Release
  uses: actions/create-release@v1
  env:
    GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
  with:
    tag_name: ${{ github.ref }}
    release_name: Release ${{ github.ref }}

# Comment on PR
- name: Comment on PR
  uses: actions/github-script@v6
  with:
    script: |
      github.rest.issues.createComment({
        issue_number: context.issue.number,
        owner: context.repo.owner,
        repo: context.repo.repo,
        body: 'Build successful! ✅'
      })
</code></pre>
<h2 id="github-pages"><a class="header" href="#github-pages">GitHub Pages</a></h2>
<h3 id="setup-github-pages"><a class="header" href="#setup-github-pages">Setup GitHub Pages</a></h3>
<pre><code class="language-bash"># 1. Create gh-pages branch
git checkout --orphan gh-pages
git rm -rf .
echo "&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;body&gt;&lt;h1&gt;Hello World&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;" &gt; index.html
git add index.html
git commit -m "Initial GitHub Pages commit"
git push origin gh-pages

# 2. Enable in repository settings
# Settings → Pages → Source → Select branch: gh-pages, folder: /(root)

# 3. Add custom domain (optional)
echo "yourdomain.com" &gt; CNAME
git add CNAME
git commit -m "Add custom domain"
git push origin gh-pages
</code></pre>
<h3 id="deploy-with-actions"><a class="header" href="#deploy-with-actions">Deploy with Actions</a></h3>
<pre><code class="language-yaml">name: Deploy to GitHub Pages

on:
  push:
    branches: [ main ]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3

    - name: Setup Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '18'

    - name: Build
      run: |
        npm ci
        npm run build

    - name: Deploy
      uses: peaceiris/actions-gh-pages@v3
      with:
        github_token: ${{ secrets.GITHUB_TOKEN }}
        publish_dir: ./build
        cname: yourdomain.com  # Optional
</code></pre>
<h2 id="github-cli-gh"><a class="header" href="#github-cli-gh">GitHub CLI (gh)</a></h2>
<h3 id="installation-1"><a class="header" href="#installation-1">Installation</a></h3>
<pre><code class="language-bash"># macOS
brew install gh

# Linux (Debian/Ubuntu)
curl -fsSL https://cli.github.com/packages/githubcli-archive-keyring.gpg | sudo dd of=/usr/share/keyrings/githubcli-archive-keyring.gpg
echo "deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/githubcli-archive-keyring.gpg] https://cli.github.com/packages stable main" | sudo tee /etc/apt/sources.list.d/github-cli.list &gt; /dev/null
sudo apt update
sudo apt install gh

# Authenticate
gh auth login
</code></pre>
<h3 id="common-gh-commands"><a class="header" href="#common-gh-commands">Common gh Commands</a></h3>
<pre><code class="language-bash"># Repository
gh repo create &lt;name&gt;
gh repo clone &lt;repo&gt;
gh repo view
gh repo fork

# Pull Requests
gh pr create
gh pr list
gh pr view &lt;number&gt;
gh pr checkout &lt;number&gt;
gh pr merge &lt;number&gt;
gh pr diff &lt;number&gt;
gh pr review &lt;number&gt;

# Issues
gh issue create
gh issue list
gh issue view &lt;number&gt;
gh issue close &lt;number&gt;

# Releases
gh release create v1.0.0
gh release list
gh release download v1.0.0

# Workflows
gh workflow list
gh workflow run &lt;workflow&gt;
gh run list
gh run view &lt;run-id&gt;

# Gists
gh gist create &lt;file&gt;
gh gist list
</code></pre>
<h2 id="collaboration-workflows-1"><a class="header" href="#collaboration-workflows-1">Collaboration Workflows</a></h2>
<h3 id="fork-and-contribute"><a class="header" href="#fork-and-contribute">Fork and Contribute</a></h3>
<pre><code class="language-bash"># 1. Fork repository on GitHub (click Fork button)

# 2. Clone your fork
gh repo fork &lt;original-repo&gt; --clone

# 3. Add upstream remote
git remote add upstream https://github.com/original-owner/repo.git

# 4. Create feature branch
git checkout -b feature/my-contribution

# 5. Make changes and commit
git add .
git commit -m "Add feature"

# 6. Keep fork updated
git fetch upstream
git checkout main
git merge upstream/main
git push origin main

# 7. Push feature branch
git push origin feature/my-contribution

# 8. Create pull request
gh pr create --base main --head feature/my-contribution
</code></pre>
<h3 id="code-review-best-practices"><a class="header" href="#code-review-best-practices">Code Review Best Practices</a></h3>
<pre><code class="language-bash"># As PR author:
# - Keep PRs small and focused
# - Write clear description
# - Link related issues
# - Respond to feedback promptly

# As reviewer:
# - Review promptly
# - Be constructive and specific
# - Test changes locally
# - Approve or request changes

# Request specific reviewers
gh pr create --reviewer @username1,@username2

# Check PR status
gh pr status

# View PR checks
gh pr checks &lt;pr-number&gt;
</code></pre>
<h3 id="team-collaboration"><a class="header" href="#team-collaboration">Team Collaboration</a></h3>
<pre><code class="language-bash"># Protect branches
# Repository Settings → Branches → Add branch protection rule
# - Require pull request reviews
# - Require status checks to pass
# - Require branches to be up to date
# - Include administrators

# Add collaborators
# Repository Settings → Collaborators → Add people

# Use code owners (.github/CODEOWNERS)
# Require approval from code owners
* @team-name
/docs/ @docs-team
*.js @frontend-team
</code></pre>
<h2 id="project-management"><a class="header" href="#project-management">Project Management</a></h2>
<h3 id="github-projects"><a class="header" href="#github-projects">GitHub Projects</a></h3>
<pre><code class="language-bash"># Create project
gh project create --title "My Project"

# Add issues to project
gh issue create --project "My Project"

# View project
gh project view &lt;project-number&gt;
</code></pre>
<h3 id="milestones"><a class="header" href="#milestones">Milestones</a></h3>
<pre><code class="language-bash"># Create milestone
# Issues → Milestones → New milestone

# Assign issue to milestone
gh issue edit &lt;number&gt; --milestone "v1.0"

# View milestone progress
# Issues → Milestones
</code></pre>
<h2 id="security-features"><a class="header" href="#security-features">Security Features</a></h2>
<h3 id="dependabot"><a class="header" href="#dependabot">Dependabot</a></h3>
<p>Enable in Settings → Security → Dependabot:</p>
<ul>
<li>Dependabot alerts</li>
<li>Dependabot security updates</li>
<li>Dependabot version updates</li>
</ul>
<p>Create <code>.github/dependabot.yml</code>:</p>
<pre><code class="language-yaml">version: 2
updates:
  - package-ecosystem: "npm"
    directory: "/"
    schedule:
      interval: "weekly"
    open-pull-requests-limit: 10
</code></pre>
<h3 id="secret-scanning"><a class="header" href="#secret-scanning">Secret Scanning</a></h3>
<pre><code class="language-bash"># Enable in Settings → Security → Code security and analysis
# - Secret scanning
# - Secret scanning push protection

# Use secrets in workflows
steps:
  - name: Deploy
    env:
      API_KEY: ${{ secrets.API_KEY }}
    run: deploy.sh
</code></pre>
<h3 id="security-advisories"><a class="header" href="#security-advisories">Security Advisories</a></h3>
<pre><code class="language-bash"># Create security advisory
# Security → Advisories → New draft security advisory

# Report vulnerability privately
# Contact repository maintainers through security tab
</code></pre>
<h2 id="webhooks-and-api"><a class="header" href="#webhooks-and-api">Webhooks and API</a></h2>
<h3 id="setup-webhook"><a class="header" href="#setup-webhook">Setup Webhook</a></h3>
<pre><code class="language-bash"># Repository Settings → Webhooks → Add webhook
# Payload URL: https://your-server.com/webhook
# Content type: application/json
# Events: Push, Pull request, Issues, etc.
</code></pre>
<h3 id="github-api"><a class="header" href="#github-api">GitHub API</a></h3>
<pre><code class="language-bash"># Using curl
curl -H "Authorization: token YOUR_TOKEN" \
  https://api.github.com/user/repos

# Using gh CLI with API
gh api repos/&lt;owner&gt;/&lt;repo&gt;/pulls

gh api graphql -f query='
  query {
    repository(owner: "owner", name: "repo") {
      pullRequests(first: 10) {
        nodes {
          title
          number
        }
      }
    }
  }
'
</code></pre>
<h2 id="advanced-features-1"><a class="header" href="#advanced-features-1">Advanced Features</a></h2>
<h3 id="github-codespaces"><a class="header" href="#github-codespaces">GitHub Codespaces</a></h3>
<pre><code class="language-bash"># Create codespace
gh codespace create --repo &lt;repo&gt;

# List codespaces
gh codespace list

# Connect to codespace
gh codespace ssh
</code></pre>
<h3 id="github-packages"><a class="header" href="#github-packages">GitHub Packages</a></h3>
<p>Publish package:</p>
<pre><code class="language-yaml">- name: Publish to GitHub Packages
  run: npm publish
  env:
    NODE_AUTH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
</code></pre>
<h3 id="github-discussions"><a class="header" href="#github-discussions">GitHub Discussions</a></h3>
<pre><code class="language-bash"># Enable in Settings → General → Features → Discussions

# Create discussion
gh api repos/&lt;owner&gt;/&lt;repo&gt;/discussions \
  -f title="Discussion title" \
  -f body="Discussion body"
</code></pre>
<h2 id="best-practices-1"><a class="header" href="#best-practices-1">Best Practices</a></h2>
<ol>
<li><strong>Branch Protection</strong>: Enable branch protection on main/develop</li>
<li><strong>Required Reviews</strong>: Require at least one approval before merging</li>
<li><strong>Status Checks</strong>: Require CI/CD to pass before merging</li>
<li><strong>Linear History</strong>: Use squash or rebase merging for clean history</li>
<li><strong>Signed Commits</strong>: Enable commit signing for security</li>
<li><strong>Templates</strong>: Use PR and issue templates for consistency</li>
<li><strong>Labels</strong>: Use labels to categorize issues and PRs</li>
<li><strong>Milestones</strong>: Track progress with milestones</li>
<li><strong>Projects</strong>: Use GitHub Projects for project management</li>
<li><strong>Documentation</strong>: Keep README and CONTRIBUTING.md updated</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="programming-languages"><a class="header" href="#programming-languages">Programming Languages</a></h1>
<p>This section contains references and guides for various programming languages.</p>
<h2 id="available-languages"><a class="header" href="#available-languages">Available Languages</a></h2>
<ul>
<li><a href="programming/python.html">Python</a> - A high-level, interpreted programming language</li>
<li><a href="programming/c.html">C</a> - A general-purpose, procedural programming language</li>
<li><a href="programming/cpp.html">C++</a> - An extension of C with object-oriented features</li>
<li><a href="programming/javascript.html">JavaScript</a> - A scripting language for web development</li>
<li><a href="programming/typescript.html">TypeScript</a> - A strongly-typed superset of JavaScript for large-scale applications</li>
<li><a href="programming/bash.html">Bash</a> - A Unix shell and command language</li>
<li><a href="programming/java.html">Java</a> - A class-based, object-oriented programming language</li>
<li><a href="programming/go.html">Go</a> - A statically typed, compiled language with built-in concurrency</li>
<li><a href="programming/lua.html">Lua</a> - A lightweight, embeddable scripting language</li>
<li><a href="programming/rust.html">Rust</a> - A systems programming language focused on safety and performance</li>
<li><a href="programming/sql.html">SQL</a> - A domain-specific language for managing databases</li>
</ul>
<h2 id="additional-topics"><a class="header" href="#additional-topics">Additional Topics</a></h2>
<ul>
<li><a href="programming/design_patterns.html">Design Patterns</a> - Common software design patterns and best practices</li>
<li><a href="programming/interview_questions.html">Interview Questions</a> - Common programming interview questions and solutions</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="python-programming"><a class="header" href="#python-programming">Python Programming</a></h1>
<h2 id="overview-1"><a class="header" href="#overview-1">Overview</a></h2>
<p>Python is a high-level, interpreted, dynamically-typed programming language known for its simplicity and readability. It's widely used for web development, data science, machine learning, automation, and scripting.</p>
<p><strong>Key Features:</strong></p>
<ul>
<li>Clean, readable syntax emphasizing indentation</li>
<li>Dynamic typing with strong type checking</li>
<li>Extensive standard library ("batteries included")</li>
<li>Large ecosystem of third-party packages (PyPI)</li>
<li>Multi-paradigm: procedural, object-oriented, functional</li>
</ul>
<hr />
<h2 id="basic-syntax"><a class="header" href="#basic-syntax">Basic Syntax</a></h2>
<h3 id="variables-and-data-types"><a class="header" href="#variables-and-data-types">Variables and Data Types</a></h3>
<pre><code class="language-python"># Variables (no declaration needed)
x = 10              # int
y = 3.14            # float
name = "Alice"      # str
is_valid = True     # bool

# Type checking and conversion
print(type(x))      # &lt;class 'int'&gt;
num_str = str(42)   # Convert to string
num_int = int("42") # Convert to int
</code></pre>
<h3 id="print-and-string-formatting"><a class="header" href="#print-and-string-formatting">Print and String Formatting</a></h3>
<pre><code class="language-python"># Basic print
print("Hello, World!")

# f-strings (Python 3.6+)
name = "Bob"
age = 30
print(f"{name} is {age} years old")

# .format() method
print("{} is {} years old".format(name, age))

# %-formatting (older style)
print("%s is %d years old" % (name, age))
</code></pre>
<hr />
<h2 id="data-structures"><a class="header" href="#data-structures">Data Structures</a></h2>
<h3 id="lists"><a class="header" href="#lists">Lists</a></h3>
<p>Lists are mutable, ordered sequences that can contain mixed types.</p>
<pre><code class="language-python"># Creating lists
my_list = [1, 2, 3, 4, 5]
mixed = [1, "hello", 3.14, True]
empty = []

# Common operations
my_list.append(6)           # Add to end: [1, 2, 3, 4, 5, 6]
my_list.insert(0, 0)        # Insert at index: [0, 1, 2, 3, 4, 5, 6]
my_list.pop()               # Remove and return last: 6
my_list.remove(3)           # Remove first occurrence of value
element = my_list[2]        # Access by index
my_list[1] = 10             # Modify by index

# Slicing
first_three = my_list[0:3]  # [0, 1, 2]
last_two = my_list[-2:]     # Last 2 elements
reversed_list = my_list[::-1]  # Reverse

# List comprehensions
squares = [x**2 for x in range(10)]
evens = [x for x in range(20) if x % 2 == 0]

# Common methods
len(my_list)                # Length
my_list.sort()              # Sort in-place
sorted(my_list)             # Return sorted copy
my_list.reverse()           # Reverse in-place
my_list.count(2)            # Count occurrences
my_list.index(2)            # Find first index
</code></pre>
<p><strong>List Characteristics:</strong></p>
<ul>
<li>Mutable (can change)</li>
<li>Ordered (maintains insertion order)</li>
<li>Allows duplicates</li>
<li>Can be nested</li>
<li>Dynamic sizing</li>
</ul>
<h3 id="tuples"><a class="header" href="#tuples">Tuples</a></h3>
<p>Tuples are immutable, ordered sequences.</p>
<pre><code class="language-python"># Creating tuples
my_tuple = (1, 2, 3, 4, 5)
single = (42,)              # Single element needs comma
empty = ()

# Accessing elements
first = my_tuple[0]
last = my_tuple[-1]
sub = my_tuple[1:3]

# Unpacking
x, y, z = (1, 2, 3)
a, *rest, b = (1, 2, 3, 4, 5)  # a=1, rest=[2,3,4], b=5

# Named tuples
from collections import namedtuple
Point = namedtuple('Point', ['x', 'y'])
p = Point(10, 20)
print(p.x, p.y)  # 10 20
</code></pre>
<p><strong>Tuple Characteristics:</strong></p>
<ul>
<li>Immutable (cannot change)</li>
<li>Ordered</li>
<li>Faster than lists</li>
<li>Can be used as dictionary keys</li>
<li>Used for function return values</li>
</ul>
<h3 id="dictionaries"><a class="header" href="#dictionaries">Dictionaries</a></h3>
<p>Dictionaries are mutable, unordered key-value collections (ordered in Python 3.7+).</p>
<pre><code class="language-python"># Creating dictionaries
person = {
    "name": "Alice",
    "age": 30,
    "city": "NYC"
}
empty = {}
from_keys = dict.fromkeys(['a', 'b', 'c'], 0)  # {'a': 0, 'b': 0, 'c': 0}

# Accessing and modifying
name = person["name"]       # KeyError if not exists
age = person.get("age", 0)  # Returns default if not exists
person["email"] = "alice@example.com"  # Add/update
del person["city"]          # Delete key

# Methods
person.keys()               # dict_keys(['name', 'age', 'email'])
person.values()             # dict_values(['Alice', 30, 'alice@example.com'])
person.items()              # dict_items([('name', 'Alice'), ...])

# Iteration
for key in person:
    print(key, person[key])

for key, value in person.items():
    print(f"{key}: {value}")

# Dictionary comprehension
squares = {x: x**2 for x in range(5)}
# {0: 0, 1: 1, 2: 4, 3: 9, 4: 16}

# Merge dictionaries (Python 3.9+)
dict1 = {"a": 1, "b": 2}
dict2 = {"c": 3, "d": 4}
merged = dict1 | dict2
</code></pre>
<h3 id="sets"><a class="header" href="#sets">Sets</a></h3>
<p>Sets are mutable, unordered collections of unique elements.</p>
<pre><code class="language-python"># Creating sets
my_set = {1, 2, 3, 4, 5}
empty = set()  # Note: {} creates empty dict
from_list = set([1, 2, 2, 3, 3, 3])  # {1, 2, 3}

# Operations
my_set.add(6)
my_set.remove(3)        # KeyError if not exists
my_set.discard(3)       # No error if not exists
my_set.pop()            # Remove and return arbitrary element

# Set operations
a = {1, 2, 3, 4}
b = {3, 4, 5, 6}
union = a | b           # {1, 2, 3, 4, 5, 6}
intersection = a &amp; b    # {3, 4}
difference = a - b      # {1, 2}
symmetric_diff = a ^ b  # {1, 2, 5, 6}

# Set comprehension
evens = {x for x in range(10) if x % 2 == 0}
</code></pre>
<hr />
<h2 id="control-flow"><a class="header" href="#control-flow">Control Flow</a></h2>
<h3 id="if-elif-else"><a class="header" href="#if-elif-else">If-Elif-Else</a></h3>
<pre><code class="language-python">age = 18

if age &lt; 13:
    print("Child")
elif age &lt; 20:
    print("Teenager")
else:
    print("Adult")

# Ternary operator
status = "Adult" if age &gt;= 18 else "Minor"

# Check multiple conditions
if 10 &lt; age &lt; 20:
    print("Teenager")
</code></pre>
<h3 id="loops"><a class="header" href="#loops">Loops</a></h3>
<pre><code class="language-python"># For loop
for i in range(5):
    print(i)  # 0, 1, 2, 3, 4

for i in range(0, 10, 2):  # Start, stop, step
    print(i)  # 0, 2, 4, 6, 8

# Iterate over list
fruits = ["apple", "banana", "cherry"]
for fruit in fruits:
    print(fruit)

# Enumerate (get index and value)
for idx, fruit in enumerate(fruits):
    print(f"{idx}: {fruit}")

# While loop
count = 0
while count &lt; 5:
    print(count)
    count += 1

# Break and continue
for i in range(10):
    if i == 3:
        continue  # Skip 3
    if i == 7:
        break     # Stop at 7
    print(i)

# Else clause (runs if loop completes without break)
for i in range(5):
    print(i)
else:
    print("Loop completed")
</code></pre>
<hr />
<h2 id="functions"><a class="header" href="#functions">Functions</a></h2>
<h3 id="basic-functions"><a class="header" href="#basic-functions">Basic Functions</a></h3>
<pre><code class="language-python"># Simple function
def greet(name):
    return f"Hello, {name}!"

# Default arguments
def greet(name="World"):
    return f"Hello, {name}!"

# Multiple return values
def get_stats(numbers):
    return min(numbers), max(numbers), sum(numbers)/len(numbers)

minimum, maximum, average = get_stats([1, 2, 3, 4, 5])

# *args (variable positional arguments)
def sum_all(*args):
    return sum(args)

print(sum_all(1, 2, 3, 4, 5))  # 15

# **kwargs (variable keyword arguments)
def print_info(**kwargs):
    for key, value in kwargs.items():
        print(f"{key}: {value}")

print_info(name="Alice", age=30, city="NYC")

# Lambda functions
square = lambda x: x**2
add = lambda x, y: x + y

# Map, Filter, Reduce
numbers = [1, 2, 3, 4, 5]
squared = list(map(lambda x: x**2, numbers))
evens = list(filter(lambda x: x % 2 == 0, numbers))

from functools import reduce
product = reduce(lambda x, y: x * y, numbers)  # 120
</code></pre>
<h3 id="decorators"><a class="header" href="#decorators">Decorators</a></h3>
<pre><code class="language-python"># Simple decorator
def my_decorator(func):
    def wrapper(*args, **kwargs):
        print("Before function call")
        result = func(*args, **kwargs)
        print("After function call")
        return result
    return wrapper

@my_decorator
def say_hello():
    print("Hello!")

say_hello()
# Output:
# Before function call
# Hello!
# After function call

# Decorator with arguments
def repeat(times):
    def decorator(func):
        def wrapper(*args, **kwargs):
            for _ in range(times):
                result = func(*args, **kwargs)
            return result
        return wrapper
    return decorator

@repeat(3)
def greet(name):
    print(f"Hello, {name}!")

greet("Alice")  # Prints 3 times

# Common built-in decorators
class MyClass:
    @staticmethod
    def static_method():
        print("Static method")

    @classmethod
    def class_method(cls):
        print(f"Class method of {cls}")

    @property
    def value(self):
        return self._value

    @value.setter
    def value(self, val):
        self._value = val
</code></pre>
<hr />
<h2 id="object-oriented-programming"><a class="header" href="#object-oriented-programming">Object-Oriented Programming</a></h2>
<h3 id="classes-and-objects"><a class="header" href="#classes-and-objects">Classes and Objects</a></h3>
<pre><code class="language-python">class Person:
    # Class variable (shared by all instances)
    species = "Homo sapiens"

    def __init__(self, name, age):
        # Instance variables
        self.name = name
        self.age = age

    # Instance method
    def greet(self):
        return f"Hello, I'm {self.name} and I'm {self.age} years old"

    # Magic methods
    def __str__(self):
        return f"Person({self.name}, {self.age})"

    def __repr__(self):
        return f"Person('{self.name}', {self.age})"

    def __eq__(self, other):
        return self.name == other.name and self.age == other.age

# Creating objects
person1 = Person("Alice", 30)
person2 = Person("Bob", 25)

print(person1.greet())
print(str(person1))
</code></pre>
<h3 id="inheritance"><a class="header" href="#inheritance">Inheritance</a></h3>
<pre><code class="language-python"># Single inheritance
class Animal:
    def __init__(self, name):
        self.name = name

    def speak(self):
        pass

class Dog(Animal):
    def speak(self):
        return f"{self.name} says Woof!"

class Cat(Animal):
    def speak(self):
        return f"{self.name} says Meow!"

dog = Dog("Buddy")
cat = Cat("Whiskers")
print(dog.speak())  # Buddy says Woof!

# Multiple inheritance
class Flyer:
    def fly(self):
        return "Flying..."

class Swimmer:
    def swim(self):
        return "Swimming..."

class Duck(Animal, Flyer, Swimmer):
    def speak(self):
        return f"{self.name} says Quack!"

duck = Duck("Donald")
print(duck.speak())  # Donald says Quack!
print(duck.fly())    # Flying...
print(duck.swim())   # Swimming...

# super() for parent class
class Employee(Person):
    def __init__(self, name, age, employee_id):
        super().__init__(name, age)
        self.employee_id = employee_id

    def get_info(self):
        return f"{self.greet()}, ID: {self.employee_id}"
</code></pre>
<h3 id="data-classes-python-37"><a class="header" href="#data-classes-python-37">Data Classes (Python 3.7+)</a></h3>
<pre><code class="language-python">from dataclasses import dataclass, field
from typing import List

@dataclass
class Person:
    name: str
    age: int
    email: str = "unknown@example.com"  # Default value
    hobbies: List[str] = field(default_factory=list)

    def greet(self):
        return f"Hello, I'm {self.name}"

person = Person("Alice", 30)
print(person)  # Person(name='Alice', age=30, email='unknown@example.com', hobbies=[])

# Frozen (immutable) dataclass
@dataclass(frozen=True)
class Point:
    x: int
    y: int
</code></pre>
<hr />
<h2 id="common-patterns"><a class="header" href="#common-patterns">Common Patterns</a></h2>
<h3 id="singleton-pattern"><a class="header" href="#singleton-pattern">Singleton Pattern</a></h3>
<pre><code class="language-python">class Singleton:
    _instance = None

    def __new__(cls):
        if cls._instance is None:
            cls._instance = super().__new__(cls)
        return cls._instance

# All instances are the same
s1 = Singleton()
s2 = Singleton()
print(s1 is s2)  # True
</code></pre>
<h3 id="factory-pattern"><a class="header" href="#factory-pattern">Factory Pattern</a></h3>
<pre><code class="language-python">class Dog:
    def speak(self):
        return "Woof!"

class Cat:
    def speak(self):
        return "Meow!"

class AnimalFactory:
    @staticmethod
    def create_animal(animal_type):
        if animal_type == "dog":
            return Dog()
        elif animal_type == "cat":
            return Cat()
        else:
            raise ValueError(f"Unknown animal type: {animal_type}")

# Usage
animal = AnimalFactory.create_animal("dog")
print(animal.speak())  # Woof!
</code></pre>
<h3 id="context-manager-pattern"><a class="header" href="#context-manager-pattern">Context Manager Pattern</a></h3>
<pre><code class="language-python"># Custom context manager
class FileManager:
    def __init__(self, filename, mode):
        self.filename = filename
        self.mode = mode
        self.file = None

    def __enter__(self):
        self.file = open(self.filename, self.mode)
        return self.file

    def __exit__(self, exc_type, exc_val, exc_tb):
        if self.file:
            self.file.close()

# Usage
with FileManager('test.txt', 'w') as f:
    f.write('Hello, World!')

# Using contextlib
from contextlib import contextmanager

@contextmanager
def file_manager(filename, mode):
    f = open(filename, mode)
    try:
        yield f
    finally:
        f.close()

with file_manager('test.txt', 'r') as f:
    content = f.read()
</code></pre>
<h3 id="iterator-and-generator-patterns"><a class="header" href="#iterator-and-generator-patterns">Iterator and Generator Patterns</a></h3>
<pre><code class="language-python"># Iterator
class Counter:
    def __init__(self, start, end):
        self.current = start
        self.end = end

    def __iter__(self):
        return self

    def __next__(self):
        if self.current &gt; self.end:
            raise StopIteration
        current = self.current
        self.current += 1
        return current

for num in Counter(1, 5):
    print(num)  # 1, 2, 3, 4, 5

# Generator
def counter(start, end):
    while start &lt;= end:
        yield start
        start += 1

for num in counter(1, 5):
    print(num)

# Generator expressions
squares = (x**2 for x in range(10))
print(next(squares))  # 0
print(next(squares))  # 1
</code></pre>
<hr />
<h2 id="file-handling"><a class="header" href="#file-handling">File Handling</a></h2>
<pre><code class="language-python"># Reading files
with open('file.txt', 'r', encoding='utf-8') as f:
    content = f.read()          # Read entire file

with open('file.txt', 'r', encoding='utf-8') as f:
    lines = f.readlines()       # Read all lines as list

with open('file.txt', 'r', encoding='utf-8') as f:
    for line in f:              # Iterate line by line
        print(line.strip())

# Writing files
with open('file.txt', 'w', encoding='utf-8') as f:
    f.write('Hello, World!\n')

# Appending
with open('file.txt', 'a', encoding='utf-8') as f:
    f.write('New line\n')

# Binary files
with open('image.png', 'rb') as f:
    data = f.read()

# JSON files
import json

# Write JSON
data = {"name": "Alice", "age": 30}
with open('data.json', 'w', encoding='utf-8') as f:
    json.dump(data, f, indent=2)

# Read JSON
with open('data.json', 'r', encoding='utf-8') as f:
    data = json.load(f)

# CSV files
import csv

# Write CSV
with open('data.csv', 'w', newline='', encoding='utf-8') as f:
    writer = csv.writer(f)
    writer.writerow(['Name', 'Age', 'City'])
    writer.writerow(['Alice', 30, 'NYC'])

# Read CSV
with open('data.csv', 'r', encoding='utf-8') as f:
    reader = csv.reader(f)
    for row in reader:
        print(row)
</code></pre>
<hr />
<h2 id="error-handling"><a class="header" href="#error-handling">Error Handling</a></h2>
<pre><code class="language-python"># Try-except
try:
    result = 10 / 0
except ZeroDivisionError:
    print("Cannot divide by zero!")

# Multiple exceptions
try:
    value = int("abc")
except (ValueError, TypeError) as e:
    print(f"Error: {e}")

# Catch all exceptions
try:
    risky_operation()
except Exception as e:
    print(f"An error occurred: {e}")

# Finally block
try:
    f = open('file.txt', 'r')
    content = f.read()
except FileNotFoundError:
    print("File not found")
finally:
    f.close()  # Always executes

# Else block
try:
    result = 10 / 2
except ZeroDivisionError:
    print("Error")
else:
    print("Success!")  # Runs if no exception

# Raising exceptions
def validate_age(age):
    if age &lt; 0:
        raise ValueError("Age cannot be negative")
    return age

# Custom exceptions
class InvalidAgeError(Exception):
    pass

def check_age(age):
    if age &lt; 0:
        raise InvalidAgeError("Age must be positive")
</code></pre>
<hr />
<h2 id="working-with-excel-and-pandas"><a class="header" href="#working-with-excel-and-pandas">Working with Excel and Pandas</a></h2>
<pre><code class="language-python">from dataclasses import dataclass
import pandas as pd
from typing import List

@dataclass
class Person:
    name: str
    age: int
    email: str

# Load data from Excel
def load_people_from_excel(file_path: str) -&gt; List[Person]:
    df = pd.read_excel(file_path)
    return [
        Person(
            name=row['name'],
            age=row['age'],
            email=row['email']
        ) for _, row in df.iterrows()
    ]

# Usage
people = load_people_from_excel("data.xlsx")
for person in people:
    print(f"{person.name} is {person.age} years old")

# With column mapping
EXCEL_TO_CLASS_MAPPING = {
    'Full Name': 'name',
    'Person Age': 'age',
    'E-mail Address': 'email'
}

def load_with_mapping(file_path: str) -&gt; List[Person]:
    df = pd.read_excel(file_path)
    df = df.rename(columns=EXCEL_TO_CLASS_MAPPING)
    return [Person(**row) for _, row in df.iterrows()]
</code></pre>
<hr />
<h2 id="common-python-idioms"><a class="header" href="#common-python-idioms">Common Python Idioms</a></h2>
<pre><code class="language-python"># List comprehension vs map/filter
numbers = range(10)
squares = [x**2 for x in numbers]
evens = [x for x in numbers if x % 2 == 0]

# Dictionary get with default
config = {"debug": True}
log_level = config.get("log_level", "INFO")

# String joining
words = ["Hello", "World"]
sentence = " ".join(words)

# Enumerate
for idx, value in enumerate(['a', 'b', 'c']):
    print(f"{idx}: {value}")

# Zip
names = ["Alice", "Bob", "Charlie"]
ages = [25, 30, 35]
for name, age in zip(names, ages):
    print(f"{name} is {age} years old")

# Unpacking
first, *middle, last = [1, 2, 3, 4, 5]

# Swapping variables
a, b = 10, 20
a, b = b, a

# Chaining comparisons
if 0 &lt; x &lt; 10:
    print("x is between 0 and 10")

# In-place operations
numbers = [1, 2, 3]
numbers += [4, 5]  # Extend list

# any() and all()
numbers = [2, 4, 6, 8]
all_even = all(x % 2 == 0 for x in numbers)
has_even = any(x % 2 == 0 for x in numbers)
</code></pre>
<hr />
<h2 id="virtual-environments"><a class="header" href="#virtual-environments">Virtual Environments</a></h2>
<pre><code class="language-bash"># Create virtual environment
python -m venv venv

# Activate (Linux/Mac)
source venv/bin/activate

# Activate (Windows)
venv\Scripts\activate

# Install packages
pip install requests pandas numpy

# Save dependencies
pip freeze &gt; requirements.txt

# Install from requirements
pip install -r requirements.txt

# Deactivate
deactivate
</code></pre>
<hr />
<h2 id="best-practices-2"><a class="header" href="#best-practices-2">Best Practices</a></h2>
<ol>
<li>
<p><strong>Follow PEP 8</strong>: Python's style guide</p>
<ul>
<li>Use 4 spaces for indentation</li>
<li>Max line length: 79 characters</li>
<li>Use snake_case for functions and variables</li>
<li>Use PascalCase for classes</li>
</ul>
</li>
<li>
<p><strong>Use Type Hints</strong> (Python 3.5+)</p>
<pre><code class="language-python">def greet(name: str) -&gt; str:
    return f"Hello, {name}!"

from typing import List, Dict, Optional

def process_data(items: List[int]) -&gt; Dict[str, int]:
    return {"sum": sum(items), "count": len(items)}
</code></pre>
</li>
<li>
<p><strong>Use List Comprehensions</strong> for simple transformations</p>
<pre><code class="language-python"># Good
squares = [x**2 for x in range(10)]

# Avoid for complex logic
# Use regular loops instead
</code></pre>
</li>
<li>
<p><strong>Use Context Managers</strong> for resource management</p>
<pre><code class="language-python">with open('file.txt', 'r') as f:
    data = f.read()
</code></pre>
</li>
<li>
<p><strong>Use f-strings</strong> for string formatting (Python 3.6+)</p>
<pre><code class="language-python">name = "Alice"
age = 30
print(f"{name} is {age} years old")
</code></pre>
</li>
</ol>
<hr />
<h2 id="common-libraries"><a class="header" href="#common-libraries">Common Libraries</a></h2>
<ul>
<li><strong>Requests</strong>: HTTP requests</li>
<li><strong>NumPy</strong>: Numerical computing</li>
<li><strong>Pandas</strong>: Data analysis</li>
<li><strong>Matplotlib/Seaborn</strong>: Data visualization</li>
<li><strong>Flask/Django</strong>: Web frameworks</li>
<li><strong>SQLAlchemy</strong>: Database ORM</li>
<li><strong>pytest</strong>: Testing</li>
<li><strong>Beautiful Soup</strong>: Web scraping</li>
<li><strong>Pillow</strong>: Image processing</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="c-programming"><a class="header" href="#c-programming">C Programming</a></h1>
<h2 id="overview-2"><a class="header" href="#overview-2">Overview</a></h2>
<p>C is a general-purpose, procedural programming language developed by Dennis Ritchie at Bell Labs in 1972. It's widely used for system programming, embedded systems, operating systems (Unix/Linux), and applications requiring high performance and low-level memory access.</p>
<p><strong>Key Features:</strong></p>
<ul>
<li><strong>Low-level access to memory</strong> via pointers</li>
<li><strong>Efficient execution</strong> with minimal runtime overhead</li>
<li><strong>Portable</strong> across different platforms</li>
<li><strong>Rich library</strong> of functions</li>
<li><strong>Structured programming</strong> with functions and modular code</li>
<li><strong>Static typing</strong> with compile-time type checking</li>
</ul>
<h2 id="basic-syntax-1"><a class="header" href="#basic-syntax-1">Basic Syntax</a></h2>
<h3 id="program-structure"><a class="header" href="#program-structure">Program Structure</a></h3>
<pre><code class="language-c">#include &lt;stdio.h&gt;     // Preprocessor directive
#include &lt;stdlib.h&gt;

// Function prototype
int add(int a, int b);

// Main function - entry point
int main(void) {
    printf("Hello, World!\n");

    int result = add(5, 3);
    printf("5 + 3 = %d\n", result);

    return 0;  // Return success code
}

// Function definition
int add(int a, int b) {
    return a + b;
}
</code></pre>
<h3 id="comments"><a class="header" href="#comments">Comments</a></h3>
<pre><code class="language-c">// Single-line comment

/*
 * Multi-line comment
 * Spans multiple lines
 */
</code></pre>
<h2 id="data-types"><a class="header" href="#data-types">Data Types</a></h2>
<h3 id="primitive-data-types"><a class="header" href="#primitive-data-types">Primitive Data Types</a></h3>
<pre><code class="language-c">// Integer types
char c = 'A';              // 1 byte: -128 to 127
unsigned char uc = 255;    // 1 byte: 0 to 255
short s = 32000;           // 2 bytes: -32,768 to 32,767
unsigned short us = 65000; // 2 bytes: 0 to 65,535
int i = 100000;            // 4 bytes: -2,147,483,648 to 2,147,483,647
unsigned int ui = 400000;  // 4 bytes: 0 to 4,294,967,295
long l = 1000000L;         // 4 or 8 bytes (platform-dependent)
unsigned long ul = 2000000UL;
long long ll = 9223372036854775807LL;  // 8 bytes

// Floating-point types
float f = 3.14f;           // 4 bytes, ~7 decimal digits precision
double d = 3.14159265359;  // 8 bytes, ~15 decimal digits precision
long double ld = 3.14159265358979323846L;  // 10-16 bytes

// Boolean (C99 and later)
#include &lt;stdbool.h&gt;
bool flag = true;          // true or false
</code></pre>
<h3 id="size-of-data-types"><a class="header" href="#size-of-data-types">Size of Data Types</a></h3>
<pre><code class="language-c">#include &lt;stdio.h&gt;

int main(void) {
    printf("Size of char: %zu bytes\n", sizeof(char));
    printf("Size of int: %zu bytes\n", sizeof(int));
    printf("Size of float: %zu bytes\n", sizeof(float));
    printf("Size of double: %zu bytes\n", sizeof(double));
    printf("Size of pointer: %zu bytes\n", sizeof(void*));
    return 0;
}
</code></pre>
<h2 id="variables-and-constants"><a class="header" href="#variables-and-constants">Variables and Constants</a></h2>
<h3 id="variable-declaration"><a class="header" href="#variable-declaration">Variable Declaration</a></h3>
<pre><code class="language-c">int x;               // Declaration
int y = 10;          // Declaration with initialization
int a, b, c;         // Multiple declarations
int m = 5, n = 10;   // Multiple with initialization

// Variable naming rules:
// - Must start with letter or underscore
// - Can contain letters, digits, underscores
// - Case-sensitive
// - Cannot use reserved keywords
</code></pre>
<h3 id="constants"><a class="header" href="#constants">Constants</a></h3>
<pre><code class="language-c">// Using const keyword
const int MAX_SIZE = 100;
const double PI = 3.14159;

// Using #define preprocessor
#define BUFFER_SIZE 1024
#define TRUE 1
#define FALSE 0

// Enumeration constants
enum Color {
    RED,     // 0
    GREEN,   // 1
    BLUE     // 2
};

enum Status {
    SUCCESS = 0,
    ERROR = -1,
    PENDING = 1
};
</code></pre>
<h2 id="operators"><a class="header" href="#operators">Operators</a></h2>
<h3 id="arithmetic-operators"><a class="header" href="#arithmetic-operators">Arithmetic Operators</a></h3>
<pre><code class="language-c">int a = 10, b = 3;
int sum = a + b;        // Addition: 13
int diff = a - b;       // Subtraction: 7
int prod = a * b;       // Multiplication: 30
int quot = a / b;       // Division: 3 (integer division)
int rem = a % b;        // Modulus: 1

// Increment/Decrement
int x = 5;
x++;    // Post-increment: x = 6
++x;    // Pre-increment: x = 7
x--;    // Post-decrement: x = 6
--x;    // Pre-decrement: x = 5
</code></pre>
<h3 id="relational-operators"><a class="header" href="#relational-operators">Relational Operators</a></h3>
<pre><code class="language-c">int a = 5, b = 10;
int result;

result = (a == b);  // Equal to: 0 (false)
result = (a != b);  // Not equal: 1 (true)
result = (a &gt; b);   // Greater than: 0
result = (a &lt; b);   // Less than: 1
result = (a &gt;= b);  // Greater than or equal: 0
result = (a &lt;= b);  // Less than or equal: 1
</code></pre>
<h3 id="logical-operators"><a class="header" href="#logical-operators">Logical Operators</a></h3>
<pre><code class="language-c">int a = 1, b = 0;

int and_result = a &amp;&amp; b;  // Logical AND: 0
int or_result = a || b;   // Logical OR: 1
int not_result = !a;      // Logical NOT: 0
</code></pre>
<h3 id="bitwise-operators"><a class="header" href="#bitwise-operators">Bitwise Operators</a></h3>
<pre><code class="language-c">unsigned int a = 5;   // 0101 in binary
unsigned int b = 3;   // 0011 in binary

unsigned int and = a &amp; b;   // AND: 0001 (1)
unsigned int or = a | b;    // OR: 0111 (7)
unsigned int xor = a ^ b;   // XOR: 0110 (6)
unsigned int not = ~a;      // NOT: 1010 (complement)
unsigned int left = a &lt;&lt; 1; // Left shift: 1010 (10)
unsigned int right = a &gt;&gt; 1;// Right shift: 0010 (2)
</code></pre>
<h3 id="assignment-operators"><a class="header" href="#assignment-operators">Assignment Operators</a></h3>
<pre><code class="language-c">int x = 10;
x += 5;   // x = x + 5;  (15)
x -= 3;   // x = x - 3;  (12)
x *= 2;   // x = x * 2;  (24)
x /= 4;   // x = x / 4;  (6)
x %= 5;   // x = x % 5;  (1)
x &amp;= 3;   // x = x &amp; 3;
x |= 2;   // x = x | 2;
x ^= 1;   // x = x ^ 1;
x &lt;&lt;= 1;  // x = x &lt;&lt; 1;
x &gt;&gt;= 1;  // x = x &gt;&gt; 1;
</code></pre>
<h3 id="ternary-operator"><a class="header" href="#ternary-operator">Ternary Operator</a></h3>
<pre><code class="language-c">int a = 10, b = 20;
int max = (a &gt; b) ? a : b;  // max = 20

// Equivalent to:
int max;
if (a &gt; b) {
    max = a;
} else {
    max = b;
}
</code></pre>
<h2 id="control-flow-1"><a class="header" href="#control-flow-1">Control Flow</a></h2>
<h3 id="if-else-statements"><a class="header" href="#if-else-statements">if-else Statements</a></h3>
<pre><code class="language-c">int age = 18;

if (age &gt;= 18) {
    printf("Adult\n");
} else {
    printf("Minor\n");
}

// if-else if-else
int score = 85;
if (score &gt;= 90) {
    printf("Grade: A\n");
} else if (score &gt;= 80) {
    printf("Grade: B\n");
} else if (score &gt;= 70) {
    printf("Grade: C\n");
} else {
    printf("Grade: F\n");
}

// Nested if
int x = 10, y = 20;
if (x &gt; 0) {
    if (y &gt; 0) {
        printf("Both positive\n");
    }
}
</code></pre>
<h3 id="switch-statement"><a class="header" href="#switch-statement">switch Statement</a></h3>
<pre><code class="language-c">int day = 3;

switch (day) {
    case 1:
        printf("Monday\n");
        break;
    case 2:
        printf("Tuesday\n");
        break;
    case 3:
        printf("Wednesday\n");
        break;
    case 4:
        printf("Thursday\n");
        break;
    case 5:
        printf("Friday\n");
        break;
    case 6:
    case 7:
        printf("Weekend\n");
        break;
    default:
        printf("Invalid day\n");
        break;
}

// Switch with fall-through
char grade = 'B';
switch (grade) {
    case 'A':
    case 'B':
    case 'C':
        printf("Pass\n");
        break;
    case 'D':
    case 'F':
        printf("Fail\n");
        break;
    default:
        printf("Invalid grade\n");
}
</code></pre>
<h3 id="loops-1"><a class="header" href="#loops-1">Loops</a></h3>
<h4 id="for-loop"><a class="header" href="#for-loop">for Loop</a></h4>
<pre><code class="language-c">// Basic for loop
for (int i = 0; i &lt; 10; i++) {
    printf("%d ", i);
}

// Nested for loop
for (int i = 0; i &lt; 3; i++) {
    for (int j = 0; j &lt; 3; j++) {
        printf("(%d, %d) ", i, j);
    }
    printf("\n");
}

// Multiple expressions
for (int i = 0, j = 10; i &lt; 10; i++, j--) {
    printf("i=%d, j=%d\n", i, j);
}

// Infinite loop
for (;;) {
    // Loop forever (use break to exit)
    break;
}
</code></pre>
<h4 id="while-loop"><a class="header" href="#while-loop">while Loop</a></h4>
<pre><code class="language-c">int count = 0;
while (count &lt; 5) {
    printf("%d ", count);
    count++;
}

// Reading input until condition
int num;
printf("Enter positive numbers (0 to stop): ");
while (scanf("%d", &amp;num) == 1 &amp;&amp; num != 0) {
    printf("You entered: %d\n", num);
}

// Infinite loop
while (1) {
    // Loop forever
    break;
}
</code></pre>
<h4 id="do-while-loop"><a class="header" href="#do-while-loop">do-while Loop</a></h4>
<pre><code class="language-c">int num;
do {
    printf("Enter a positive number: ");
    scanf("%d", &amp;num);
} while (num &lt;= 0);

// Executes at least once
int x = 10;
do {
    printf("x = %d\n", x);
    x++;
} while (x &lt; 5);  // Condition false, but body executes once
</code></pre>
<h3 id="loop-control-statements"><a class="header" href="#loop-control-statements">Loop Control Statements</a></h3>
<pre><code class="language-c">// break - exits the loop
for (int i = 0; i &lt; 10; i++) {
    if (i == 5) break;
    printf("%d ", i);  // Prints: 0 1 2 3 4
}

// continue - skips to next iteration
for (int i = 0; i &lt; 10; i++) {
    if (i % 2 == 0) continue;
    printf("%d ", i);  // Prints: 1 3 5 7 9
}

// goto - jumps to a label (use sparingly)
int i = 0;
start:
    printf("%d ", i);
    i++;
    if (i &lt; 5) goto start;
</code></pre>
<h2 id="functions-1"><a class="header" href="#functions-1">Functions</a></h2>
<h3 id="function-declaration-and-definition"><a class="header" href="#function-declaration-and-definition">Function Declaration and Definition</a></h3>
<pre><code class="language-c">// Function prototype (declaration)
int add(int a, int b);
void greet(void);
double calculate(int x, double y);

// Function definition
int add(int a, int b) {
    return a + b;
}

void greet(void) {
    printf("Hello!\n");
    // No return statement needed for void
}

double calculate(int x, double y) {
    return x * y;
}
</code></pre>
<h3 id="function-parameters"><a class="header" href="#function-parameters">Function Parameters</a></h3>
<pre><code class="language-c">// Pass by value
void increment(int x) {
    x++;  // Only affects local copy
}

int main(void) {
    int num = 5;
    increment(num);
    printf("%d\n", num);  // Still 5
    return 0;
}

// Pass by reference (using pointers)
void increment_ref(int *x) {
    (*x)++;  // Modifies original value
}

int main(void) {
    int num = 5;
    increment_ref(&amp;num);
    printf("%d\n", num);  // Now 6
    return 0;
}
</code></pre>
<h3 id="return-values"><a class="header" href="#return-values">Return Values</a></h3>
<pre><code class="language-c">// Return single value
int square(int x) {
    return x * x;
}

// Return multiple values via pointers
void divide(int a, int b, int *quotient, int *remainder) {
    *quotient = a / b;
    *remainder = a % b;
}

int main(void) {
    int q, r;
    divide(10, 3, &amp;q, &amp;r);
    printf("10 / 3 = %d remainder %d\n", q, r);
    return 0;
}
</code></pre>
<h3 id="variadic-functions"><a class="header" href="#variadic-functions">Variadic Functions</a></h3>
<pre><code class="language-c">#include &lt;stdarg.h&gt;

// Function with variable number of arguments
int sum(int count, ...) {
    va_list args;
    va_start(args, count);

    int total = 0;
    for (int i = 0; i &lt; count; i++) {
        total += va_arg(args, int);
    }

    va_end(args);
    return total;
}

int main(void) {
    printf("Sum: %d\n", sum(3, 10, 20, 30));  // 60
    printf("Sum: %d\n", sum(5, 1, 2, 3, 4, 5));  // 15
    return 0;
}
</code></pre>
<h3 id="recursive-functions"><a class="header" href="#recursive-functions">Recursive Functions</a></h3>
<pre><code class="language-c">// Factorial
int factorial(int n) {
    if (n &lt;= 1) return 1;
    return n * factorial(n - 1);
}

// Fibonacci
int fibonacci(int n) {
    if (n &lt;= 1) return n;
    return fibonacci(n - 1) + fibonacci(n - 2);
}

// Binary search (recursive)
int binary_search(int arr[], int left, int right, int target) {
    if (left &gt; right) return -1;

    int mid = left + (right - left) / 2;
    if (arr[mid] == target) return mid;
    if (arr[mid] &gt; target) return binary_search(arr, left, mid - 1, target);
    return binary_search(arr, mid + 1, right, target);
}
</code></pre>
<h2 id="arrays"><a class="header" href="#arrays">Arrays</a></h2>
<h3 id="array-declaration-and-initialization"><a class="header" href="#array-declaration-and-initialization">Array Declaration and Initialization</a></h3>
<pre><code class="language-c">// Declaration
int numbers[5];

// Declaration with initialization
int primes[5] = {2, 3, 5, 7, 11};

// Partial initialization (rest are 0)
int values[10] = {1, 2, 3};  // {1, 2, 3, 0, 0, 0, 0, 0, 0, 0}

// Size inferred from initializer
int data[] = {10, 20, 30, 40};  // Size: 4

// Zero-initialize all elements
int zeros[100] = {0};
</code></pre>
<h3 id="accessing-array-elements"><a class="header" href="#accessing-array-elements">Accessing Array Elements</a></h3>
<pre><code class="language-c">int arr[5] = {10, 20, 30, 40, 50};

// Access elements
int first = arr[0];   // 10
int third = arr[2];   // 30

// Modify elements
arr[1] = 25;          // arr is now {10, 25, 30, 40, 50}

// Loop through array
for (int i = 0; i &lt; 5; i++) {
    printf("%d ", arr[i]);
}
</code></pre>
<h3 id="multi-dimensional-arrays"><a class="header" href="#multi-dimensional-arrays">Multi-dimensional Arrays</a></h3>
<pre><code class="language-c">// 2D array
int matrix[3][4] = {
    {1, 2, 3, 4},
    {5, 6, 7, 8},
    {9, 10, 11, 12}
};

// Access elements
int value = matrix[1][2];  // 7

// Loop through 2D array
for (int i = 0; i &lt; 3; i++) {
    for (int j = 0; j &lt; 4; j++) {
        printf("%d ", matrix[i][j]);
    }
    printf("\n");
}

// 3D array
int cube[2][3][4];
</code></pre>
<h3 id="arrays-and-pointers"><a class="header" href="#arrays-and-pointers">Arrays and Pointers</a></h3>
<pre><code class="language-c">int arr[5] = {10, 20, 30, 40, 50};

// Array name is a pointer to first element
int *ptr = arr;  // Same as &amp;arr[0]

// Pointer arithmetic
printf("%d\n", *ptr);       // 10
printf("%d\n", *(ptr + 1)); // 20
printf("%d\n", *(ptr + 2)); // 30

// Equivalent notations
arr[2] == *(arr + 2) == *(ptr + 2) == ptr[2]  // All equal 30
</code></pre>
<h3 id="passing-arrays-to-functions"><a class="header" href="#passing-arrays-to-functions">Passing Arrays to Functions</a></h3>
<pre><code class="language-c">// Array passed as pointer
void print_array(int arr[], int size) {
    for (int i = 0; i &lt; size; i++) {
        printf("%d ", arr[i]);
    }
    printf("\n");
}

// Equivalent declaration
void print_array(int *arr, int size) {
    // Same as above
}

// 2D array
void print_matrix(int rows, int cols, int matrix[rows][cols]) {
    for (int i = 0; i &lt; rows; i++) {
        for (int j = 0; j &lt; cols; j++) {
            printf("%d ", matrix[i][j]);
        }
        printf("\n");
    }
}
</code></pre>
<h2 id="pointers"><a class="header" href="#pointers">Pointers</a></h2>
<h3 id="pointer-basics"><a class="header" href="#pointer-basics">Pointer Basics</a></h3>
<pre><code class="language-c">int x = 10;
int *ptr = &amp;x;     // ptr stores address of x

printf("Value of x: %d\n", x);           // 10
printf("Address of x: %p\n", (void*)&amp;x); // Memory address
printf("Value of ptr: %p\n", (void*)ptr);// Same as &amp;x
printf("Value at ptr: %d\n", *ptr);      // 10 (dereference)

// Modify through pointer
*ptr = 20;
printf("New value of x: %d\n", x);       // 20
</code></pre>
<h3 id="pointer-arithmetic"><a class="header" href="#pointer-arithmetic">Pointer Arithmetic</a></h3>
<pre><code class="language-c">int arr[5] = {10, 20, 30, 40, 50};
int *ptr = arr;

printf("%d\n", *ptr);       // 10
printf("%d\n", *(ptr + 1)); // 20
printf("%d\n", *(ptr + 2)); // 30

ptr++;                      // Move to next element
printf("%d\n", *ptr);       // 20

ptr += 2;                   // Move 2 elements forward
printf("%d\n", *ptr);       // 40
</code></pre>
<h3 id="pointer-to-pointer"><a class="header" href="#pointer-to-pointer">Pointer to Pointer</a></h3>
<pre><code class="language-c">int x = 10;
int *ptr1 = &amp;x;
int **ptr2 = &amp;ptr1;

printf("%d\n", **ptr2);  // 10

// Modify through double pointer
**ptr2 = 20;
printf("%d\n", x);       // 20
</code></pre>
<h3 id="null-pointers"><a class="header" href="#null-pointers">Null Pointers</a></h3>
<pre><code class="language-c">int *ptr = NULL;  // Initialize to NULL

// Always check before dereferencing
if (ptr != NULL) {
    printf("%d\n", *ptr);
} else {
    printf("Pointer is NULL\n");
}
</code></pre>
<h3 id="function-pointers"><a class="header" href="#function-pointers">Function Pointers</a></h3>
<pre><code class="language-c">// Function pointer declaration
int (*func_ptr)(int, int);

int add(int a, int b) {
    return a + b;
}

int multiply(int a, int b) {
    return a * b;
}

int main(void) {
    func_ptr = add;
    printf("10 + 5 = %d\n", func_ptr(10, 5));  // 15

    func_ptr = multiply;
    printf("10 * 5 = %d\n", func_ptr(10, 5));  // 50

    return 0;
}

// Array of function pointers
int (*operations[2])(int, int) = {add, multiply};
printf("Result: %d\n", operations[0](10, 5));  // 15
</code></pre>
<h2 id="structures-structs"><a class="header" href="#structures-structs">Structures (Structs)</a></h2>
<h3 id="struct-declaration-and-initialization"><a class="header" href="#struct-declaration-and-initialization">Struct Declaration and Initialization</a></h3>
<pre><code class="language-c">// Define struct
struct Point {
    int x;
    int y;
};

// Create struct variable
struct Point p1;
p1.x = 10;
p1.y = 20;

// Initialize during declaration
struct Point p2 = {30, 40};

// Designated initializers (C99)
struct Point p3 = {.x = 50, .y = 60};
</code></pre>
<h3 id="typedef-with-structs"><a class="header" href="#typedef-with-structs">Typedef with Structs</a></h3>
<pre><code class="language-c">typedef struct {
    char name[50];
    int age;
    float gpa;
} Student;

// Now can use Student instead of struct Student
Student s1 = {"Alice", 20, 3.8};
printf("Name: %s, Age: %d, GPA: %.2f\n", s1.name, s1.age, s1.gpa);
</code></pre>
<h3 id="nested-structures"><a class="header" href="#nested-structures">Nested Structures</a></h3>
<pre><code class="language-c">typedef struct {
    int day;
    int month;
    int year;
} Date;

typedef struct {
    char name[50];
    Date birthdate;
    float salary;
} Employee;

Employee emp = {"John", {15, 8, 1990}, 50000.0};
printf("Name: %s\n", emp.name);
printf("Birthdate: %d/%d/%d\n", emp.birthdate.day,
       emp.birthdate.month, emp.birthdate.year);
</code></pre>
<h3 id="pointers-to-structures"><a class="header" href="#pointers-to-structures">Pointers to Structures</a></h3>
<pre><code class="language-c">typedef struct {
    int x;
    int y;
} Point;

Point p1 = {10, 20};
Point *ptr = &amp;p1;

// Access members through pointer
printf("x: %d, y: %d\n", (*ptr).x, (*ptr).y);

// Arrow operator (shorthand)
printf("x: %d, y: %d\n", ptr-&gt;x, ptr-&gt;y);
</code></pre>
<h3 id="arrays-of-structures"><a class="header" href="#arrays-of-structures">Arrays of Structures</a></h3>
<pre><code class="language-c">typedef struct {
    char name[30];
    int age;
} Person;

Person people[3] = {
    {"Alice", 25},
    {"Bob", 30},
    {"Charlie", 35}
};

for (int i = 0; i &lt; 3; i++) {
    printf("%s is %d years old\n", people[i].name, people[i].age);
}
</code></pre>
<h2 id="unions-and-enums"><a class="header" href="#unions-and-enums">Unions and Enums</a></h2>
<h3 id="unions"><a class="header" href="#unions">Unions</a></h3>
<pre><code class="language-c">// Union: all members share same memory location
union Data {
    int i;
    float f;
    char c;
};

union Data data;
data.i = 10;
printf("i: %d\n", data.i);

data.f = 3.14;  // Overwrites i
printf("f: %.2f\n", data.f);
printf("i: %d\n", data.i);  // Corrupted

printf("Size of union: %zu\n", sizeof(union Data));  // Size of largest member
</code></pre>
<h3 id="enumerations"><a class="header" href="#enumerations">Enumerations</a></h3>
<pre><code class="language-c">// Define enum
enum Day {
    MONDAY,    // 0
    TUESDAY,   // 1
    WEDNESDAY, // 2
    THURSDAY,  // 3
    FRIDAY,    // 4
    SATURDAY,  // 5
    SUNDAY     // 6
};

enum Day today = WEDNESDAY;

// Custom values
enum Status {
    SUCCESS = 0,
    ERROR = -1,
    PENDING = 1,
    TIMEOUT = 2
};

// Typedef with enum
typedef enum {
    RED,
    GREEN,
    BLUE
} Color;

Color favorite = BLUE;
</code></pre>
<h2 id="file-io"><a class="header" href="#file-io">File I/O</a></h2>
<h3 id="opening-and-closing-files"><a class="header" href="#opening-and-closing-files">Opening and Closing Files</a></h3>
<pre><code class="language-c">#include &lt;stdio.h&gt;

FILE *file = fopen("data.txt", "r");  // Open for reading
if (file == NULL) {
    perror("Error opening file");
    return 1;
}

// Use file...

fclose(file);  // Always close when done
</code></pre>
<p><strong>File Modes:</strong></p>
<ul>
<li><code>"r"</code> - Read (file must exist)</li>
<li><code>"w"</code> - Write (creates new or truncates existing)</li>
<li><code>"a"</code> - Append (creates new or appends to existing)</li>
<li><code>"r+"</code> - Read and write (file must exist)</li>
<li><code>"w+"</code> - Read and write (creates new or truncates)</li>
<li><code>"a+"</code> - Read and append</li>
</ul>
<h3 id="writing-to-files"><a class="header" href="#writing-to-files">Writing to Files</a></h3>
<pre><code class="language-c">// fprintf - formatted output
FILE *file = fopen("output.txt", "w");
fprintf(file, "Hello, %s!\n", "World");
fprintf(file, "Number: %d\n", 42);
fclose(file);

// fputs - write string
FILE *file = fopen("output.txt", "w");
fputs("Line 1\n", file);
fputs("Line 2\n", file);
fclose(file);

// fwrite - binary write
int numbers[] = {1, 2, 3, 4, 5};
FILE *file = fopen("data.bin", "wb");
fwrite(numbers, sizeof(int), 5, file);
fclose(file);
</code></pre>
<h3 id="reading-from-files"><a class="header" href="#reading-from-files">Reading from Files</a></h3>
<pre><code class="language-c">// fscanf - formatted input
FILE *file = fopen("input.txt", "r");
int num;
char str[50];
fscanf(file, "%d %s", &amp;num, str);
fclose(file);

// fgets - read line
FILE *file = fopen("input.txt", "r");
char line[100];
while (fgets(line, sizeof(line), file) != NULL) {
    printf("%s", line);
}
fclose(file);

// fread - binary read
int numbers[5];
FILE *file = fopen("data.bin", "rb");
fread(numbers, sizeof(int), 5, file);
fclose(file);

// fgetc - read character
FILE *file = fopen("input.txt", "r");
int ch;
while ((ch = fgetc(file)) != EOF) {
    putchar(ch);
}
fclose(file);
</code></pre>
<h3 id="file-position-functions"><a class="header" href="#file-position-functions">File Position Functions</a></h3>
<pre><code class="language-c">FILE *file = fopen("data.txt", "r");

// ftell - get current position
long pos = ftell(file);

// fseek - set position
fseek(file, 0, SEEK_SET);  // Beginning of file
fseek(file, 0, SEEK_END);  // End of file
fseek(file, 10, SEEK_CUR); // 10 bytes from current position

// rewind - reset to beginning
rewind(file);

fclose(file);
</code></pre>
<h3 id="file-error-checking"><a class="header" href="#file-error-checking">File Error Checking</a></h3>
<pre><code class="language-c">FILE *file = fopen("data.txt", "r");
if (file == NULL) {
    perror("fopen");
    return 1;
}

// Check for errors
if (ferror(file)) {
    fprintf(stderr, "Error reading file\n");
}

// Check for end of file
if (feof(file)) {
    printf("End of file reached\n");
}

fclose(file);
</code></pre>
<h2 id="preprocessor-directives"><a class="header" href="#preprocessor-directives">Preprocessor Directives</a></h2>
<h3 id="include-directive"><a class="header" href="#include-directive">#include Directive</a></h3>
<pre><code class="language-c">#include &lt;stdio.h&gt;     // System header
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;

#include "myheader.h"  // User-defined header
</code></pre>
<h3 id="define-directive"><a class="header" href="#define-directive">#define Directive</a></h3>
<pre><code class="language-c">// Constants
#define PI 3.14159
#define MAX_SIZE 1000
#define BUFFER_LEN 256

// Macros
#define SQUARE(x) ((x) * (x))
#define MAX(a, b) ((a) &gt; (b) ? (a) : (b))
#define MIN(a, b) ((a) &lt; (b) ? (a) : (b))

// Multi-line macro
#define SWAP(a, b, type) do { \
    type temp = a;            \
    a = b;                    \
    b = temp;                 \
} while(0)

// Usage
int result = SQUARE(5);  // 25
int max_val = MAX(10, 20);  // 20
</code></pre>
<h3 id="conditional-compilation"><a class="header" href="#conditional-compilation">Conditional Compilation</a></h3>
<pre><code class="language-c">#define DEBUG 1

#ifdef DEBUG
    printf("Debug mode enabled\n");
#endif

#ifndef RELEASE
    printf("Not in release mode\n");
#endif

#if DEBUG == 1
    printf("Debug level 1\n");
#elif DEBUG == 2
    printf("Debug level 2\n");
#else
    printf("Debug disabled\n");
#endif

// Prevent multiple inclusion
#ifndef MYHEADER_H
#define MYHEADER_H

// Header contents...

#endif  // MYHEADER_H
</code></pre>
<h3 id="predefined-macros"><a class="header" href="#predefined-macros">Predefined Macros</a></h3>
<pre><code class="language-c">printf("File: %s\n", __FILE__);      // Current filename
printf("Line: %d\n", __LINE__);      // Current line number
printf("Date: %s\n", __DATE__);      // Compilation date
printf("Time: %s\n", __TIME__);      // Compilation time
printf("Function: %s\n", __func__);  // Current function name (C99)
</code></pre>
<h3 id="undef-and-pragma"><a class="header" href="#undef-and-pragma">#undef and #pragma</a></h3>
<pre><code class="language-c">// Undefine a macro
#define TEMP 100
#undef TEMP

// Compiler-specific directives
#pragma once  // Alternative to include guards (non-standard)
#pragma pack(1)  // Structure packing
</code></pre>
<h2 id="common-patterns-1"><a class="header" href="#common-patterns-1">Common Patterns</a></h2>
<h3 id="error-handling-pattern"><a class="header" href="#error-handling-pattern">Error Handling Pattern</a></h3>
<pre><code class="language-c">int process_file(const char *filename) {
    FILE *file = fopen(filename, "r");
    if (file == NULL) {
        perror("fopen");
        return -1;
    }

    char *buffer = malloc(1024);
    if (buffer == NULL) {
        fclose(file);
        perror("malloc");
        return -1;
    }

    // Process file...

    // Cleanup
    free(buffer);
    fclose(file);
    return 0;
}
</code></pre>
<h3 id="generic-swap-function"><a class="header" href="#generic-swap-function">Generic Swap Function</a></h3>
<pre><code class="language-c">void swap(void *a, void *b, size_t size) {
    unsigned char *p = a;
    unsigned char *q = b;
    unsigned char temp;

    for (size_t i = 0; i &lt; size; i++) {
        temp = p[i];
        p[i] = q[i];
        q[i] = temp;
    }
}

// Usage
int x = 10, y = 20;
swap(&amp;x, &amp;y, sizeof(int));
printf("x=%d, y=%d\n", x, y);  // x=20, y=10
</code></pre>
<h3 id="linked-list-implementation"><a class="header" href="#linked-list-implementation">Linked List Implementation</a></h3>
<pre><code class="language-c">typedef struct Node {
    int data;
    struct Node *next;
} Node;

// Insert at beginning
Node* insert_front(Node *head, int data) {
    Node *new_node = malloc(sizeof(Node));
    if (new_node == NULL) return head;

    new_node-&gt;data = data;
    new_node-&gt;next = head;
    return new_node;
}

// Print list
void print_list(Node *head) {
    Node *current = head;
    while (current != NULL) {
        printf("%d -&gt; ", current-&gt;data);
        current = current-&gt;next;
    }
    printf("NULL\n");
}

// Free list
void free_list(Node *head) {
    Node *current = head;
    while (current != NULL) {
        Node *temp = current;
        current = current-&gt;next;
        free(temp);
    }
}
</code></pre>
<h3 id="command-line-arguments"><a class="header" href="#command-line-arguments">Command Line Arguments</a></h3>
<pre><code class="language-c">int main(int argc, char *argv[]) {
    printf("Program name: %s\n", argv[0]);
    printf("Number of arguments: %d\n", argc - 1);

    for (int i = 1; i &lt; argc; i++) {
        printf("Argument %d: %s\n", i, argv[i]);
    }

    return 0;
}

// Run: ./program arg1 arg2 arg3
// Output:
// Program name: ./program
// Number of arguments: 3
// Argument 1: arg1
// Argument 2: arg2
// Argument 3: arg3
</code></pre>
<h2 id="best-practices-3"><a class="header" href="#best-practices-3">Best Practices</a></h2>
<h3 id="code-organization"><a class="header" href="#code-organization">Code Organization</a></h3>
<pre><code class="language-c">// Use meaningful names
int calculate_average(int *scores, int count);  // Good
int calc(int *a, int n);                        // Avoid

// Use constants instead of magic numbers
#define MAX_STUDENTS 100
int students[MAX_STUDENTS];  // Good

int students[100];  // Avoid

// Group related code
typedef struct {
    char name[50];
    int age;
} Person;

Person create_person(const char *name, int age);
void print_person(const Person *p);
void free_person(Person *p);
</code></pre>
<h3 id="memory-management"><a class="header" href="#memory-management">Memory Management</a></h3>
<pre><code class="language-c">// Always check malloc return value
int *ptr = malloc(sizeof(int) * 100);
if (ptr == NULL) {
    fprintf(stderr, "Memory allocation failed\n");
    return -1;
}

// Always free allocated memory
free(ptr);
ptr = NULL;  // Prevent dangling pointer

// Avoid memory leaks
void bad_function() {
    int *data = malloc(sizeof(int) * 100);
    if (some_error) {
        return;  // LEAK! Forgot to free
    }
    free(data);
}

void good_function() {
    int *data = malloc(sizeof(int) * 100);
    if (data == NULL) return;

    if (some_error) {
        free(data);  // Clean up before return
        return;
    }

    free(data);
}
</code></pre>
<h3 id="buffer-safety"><a class="header" href="#buffer-safety">Buffer Safety</a></h3>
<pre><code class="language-c">// Use strncpy instead of strcpy
char dest[20];
strncpy(dest, source, sizeof(dest) - 1);
dest[sizeof(dest) - 1] = '\0';  // Ensure null termination

// Use snprintf instead of sprintf
char buffer[50];
snprintf(buffer, sizeof(buffer), "Value: %d", value);

// Check array bounds
for (int i = 0; i &lt; array_size; i++) {
    // Safe access
}
</code></pre>
<h3 id="function-design"><a class="header" href="#function-design">Function Design</a></h3>
<pre><code class="language-c">// Use const for read-only parameters
int calculate_sum(const int *arr, int size);

// Return error codes
int read_file(const char *filename, char **buffer) {
    if (filename == NULL || buffer == NULL) {
        return -1;  // Invalid parameters
    }

    FILE *file = fopen(filename, "r");
    if (file == NULL) {
        return -2;  // File open error
    }

    // Success
    return 0;
}

// Use header guards
// myheader.h
#ifndef MYHEADER_H
#define MYHEADER_H

// Declarations...

#endif
</code></pre>
<h3 id="compilation-flags"><a class="header" href="#compilation-flags">Compilation Flags</a></h3>
<pre><code class="language-bash"># Enable warnings
gcc -Wall -Wextra -Werror program.c -o program

# Debug symbols
gcc -g program.c -o program

# Optimization
gcc -O2 program.c -o program

# C standard
gcc -std=c11 program.c -o program

# Combine flags
gcc -Wall -Wextra -O2 -std=c11 program.c -o program
</code></pre>
<h2 id="difference-between-different-const-pointers"><a class="header" href="#difference-between-different-const-pointers">Difference Between Different Const Pointers</a></h2>
<p>In C programming, pointers can be declared with the <code>const</code> qualifier in different ways, leading to different types of constant pointers. Understanding these differences is crucial for writing correct and efficient code.</p>
<ol>
<li>
<p><strong>Pointer to a Constant Variable:</strong>
A pointer to a constant variable means that the value being pointed to cannot be changed through the pointer, but the pointer itself can be changed to point to another variable.</p>
<pre><code class="language-c">const int *ptr;
int a = 10;
int b = 20;
ptr = &amp;a; // Valid
*ptr = 30; // Invalid, cannot change the value of 'a' through ptr
ptr = &amp;b; // Valid, can change the pointer to point to 'b'
</code></pre>
</li>
<li>
<p><strong>Constant Pointer to a Variable:</strong>
A constant pointer to a variable means that the pointer itself cannot be changed to point to another variable, but the value being pointed to can be changed.</p>
<pre><code class="language-c">int *const ptr = &amp;a;
int a = 10;
int b = 20;
ptr = &amp;b; // Invalid, cannot change the pointer to point to 'b'
*ptr = 30; // Valid, can change the value of 'a' through ptr
</code></pre>
</li>
<li>
<p><strong>Constant Pointer to a Constant Variable:</strong>
A constant pointer to a constant variable means that neither the pointer can be changed to point to another variable nor the value being pointed to can be changed.</p>
<pre><code class="language-c">const int *const ptr = &amp;a;
int a = 10;
int b = 20;
ptr = &amp;b; // Invalid, cannot change the pointer to point to 'b'
*ptr = 30; // Invalid, cannot change the value of 'a' through ptr
</code></pre>
</li>
</ol>
<p>These different types of constant pointers provide various levels of protection and control over the data and pointers in your program, helping to prevent unintended modifications and ensuring code reliability.</p>
<h2 id="dynamic-memory-allocation"><a class="header" href="#dynamic-memory-allocation">Dynamic Memory Allocation</a></h2>
<p>Dynamic memory allocation allows you to allocate memory at runtime instead of compile time. This is essential for creating data structures of variable size.</p>
<h3 id="memory-layout"><a class="header" href="#memory-layout">Memory Layout</a></h3>
<pre><code>Stack (grows down)   |  Local variables, function parameters
                     |
                     V
=====================|======================  &lt;- Stack limit
                     ^
                     |
                     |  Free memory
                     |
                     V
=====================|======================  &lt;- Heap limit
Heap (grows up)      |  malloc, calloc, realloc allocations
                     ^
</code></pre>
<h3 id="malloc---memory-allocation"><a class="header" href="#malloc---memory-allocation">malloc() - Memory Allocation</a></h3>
<p>Allocates memory and returns a void pointer:</p>
<pre><code class="language-c">#include &lt;stdlib.h&gt;

// Allocate memory for single integer
int *ptr = (int *)malloc(sizeof(int));
if (ptr == NULL) {
    printf("Memory allocation failed\n");
    return 1;
}
*ptr = 42;
printf("Value: %d\n", *ptr);
free(ptr);
ptr = NULL;  // Good practice: set to NULL after free

// Allocate memory for array
int *arr = (int *)malloc(10 * sizeof(int));
if (arr == NULL) {
    printf("Memory allocation failed\n");
    return 1;
}
arr[0] = 100;
arr[9] = 999;
free(arr);
arr = NULL;
</code></pre>
<h3 id="calloc---contiguous-memory-allocation"><a class="header" href="#calloc---contiguous-memory-allocation">calloc() - Contiguous Memory Allocation</a></h3>
<p>Allocates memory and initializes all bytes to zero:</p>
<pre><code class="language-c">#include &lt;stdlib.h&gt;

// calloc(number_of_elements, size_of_each_element)
int *arr = (int *)calloc(10, sizeof(int));  // 10 integers, all initialized to 0
if (arr == NULL) {
    printf("Memory allocation failed\n");
    return 1;
}

for (int i = 0; i &lt; 10; i++) {
    printf("%d ", arr[i]);  // Prints: 0 0 0 0 0 0 0 0 0 0
}

free(arr);
arr = NULL;
</code></pre>
<h3 id="realloc---resize-memory"><a class="header" href="#realloc---resize-memory">realloc() - Resize Memory</a></h3>
<p>Resizes previously allocated memory block:</p>
<pre><code class="language-c">#include &lt;stdlib.h&gt;

int *arr = (int *)malloc(5 * sizeof(int));
for (int i = 0; i &lt; 5; i++) arr[i] = i;

// Resize to 10 integers
int *new_arr = (int *)realloc(arr, 10 * sizeof(int));
if (new_arr == NULL) {
    printf("Reallocation failed\n");
    free(arr);  // Original block still exists
    return 1;
}

arr = new_arr;
for (int i = 5; i &lt; 10; i++) arr[i] = i;

free(arr);
arr = NULL;
</code></pre>
<h3 id="free---deallocate-memory"><a class="header" href="#free---deallocate-memory">free() - Deallocate Memory</a></h3>
<p>Deallocates previously allocated memory:</p>
<pre><code class="language-c">#include &lt;stdlib.h&gt;

int *ptr = (int *)malloc(sizeof(int));
*ptr = 42;

// When done, free the memory
free(ptr);

// IMPORTANT: Set to NULL to avoid dangling pointer
ptr = NULL;
</code></pre>
<h3 id="memory-allocation-pattern-safe"><a class="header" href="#memory-allocation-pattern-safe">Memory Allocation Pattern (Safe)</a></h3>
<pre><code class="language-c">#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;

int main(void) {
    // 1. Declare pointer
    int *ptr;

    // 2. Allocate memory with error checking
    ptr = (int *)malloc(sizeof(int));
    if (ptr == NULL) {
        fprintf(stderr, "Memory allocation failed\n");
        return 1;
    }

    // 3. Use the memory
    *ptr = 100;
    printf("Value: %d\n", *ptr);

    // 4. Free the memory
    free(ptr);

    // 5. Set to NULL (avoid dangling pointer)
    ptr = NULL;

    return 0;
}
</code></pre>
<h3 id="dynamic-array-implementation"><a class="header" href="#dynamic-array-implementation">Dynamic Array Implementation</a></h3>
<pre><code class="language-c">#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;

typedef struct {
    int *data;
    int size;
    int capacity;
} DynamicArray;

// Create dynamic array
DynamicArray* array_create(int initial_capacity) {
    DynamicArray *arr = (DynamicArray *)malloc(sizeof(DynamicArray));
    if (arr == NULL) return NULL;

    arr-&gt;data = (int *)malloc(initial_capacity * sizeof(int));
    if (arr-&gt;data == NULL) {
        free(arr);
        return NULL;
    }

    arr-&gt;size = 0;
    arr-&gt;capacity = initial_capacity;
    return arr;
}

// Add element to array
int array_push(DynamicArray *arr, int value) {
    if (arr-&gt;size == arr-&gt;capacity) {
        // Resize: double the capacity
        int new_capacity = arr-&gt;capacity * 2;
        int *new_data = (int *)realloc(arr-&gt;data, new_capacity * sizeof(int));
        if (new_data == NULL) return -1;

        arr-&gt;data = new_data;
        arr-&gt;capacity = new_capacity;
    }

    arr-&gt;data[arr-&gt;size++] = value;
    return 0;
}

// Get element from array
int array_get(DynamicArray *arr, int index) {
    if (index &lt; 0 || index &gt;= arr-&gt;size) {
        fprintf(stderr, "Index out of bounds\n");
        return -1;
    }
    return arr-&gt;data[index];
}

// Free array
void array_free(DynamicArray *arr) {
    if (arr == NULL) return;
    free(arr-&gt;data);
    free(arr);
}

// Usage
int main(void) {
    DynamicArray *arr = array_create(10);
    if (arr == NULL) {
        fprintf(stderr, "Failed to create array\n");
        return 1;
    }

    for (int i = 0; i &lt; 20; i++) {
        array_push(arr, i * 10);
    }

    for (int i = 0; i &lt; arr-&gt;size; i++) {
        printf("%d ", array_get(arr, i));
    }

    array_free(arr);
    return 0;
}
</code></pre>
<h3 id="common-memory-errors"><a class="header" href="#common-memory-errors">Common Memory Errors</a></h3>
<h4 id="1-memory-leak-forgot-to-free"><a class="header" href="#1-memory-leak-forgot-to-free">1. Memory Leak (forgot to free)</a></h4>
<pre><code class="language-c">void memory_leak(void) {
    int *ptr = (int *)malloc(sizeof(int));
    *ptr = 42;
    // Missing: free(ptr);
    // Memory is lost when function exits
}
</code></pre>
<h4 id="2-double-free"><a class="header" href="#2-double-free">2. Double Free</a></h4>
<pre><code class="language-c">int *ptr = (int *)malloc(sizeof(int));
free(ptr);
free(ptr);  // ERROR: Undefined behavior!
</code></pre>
<h4 id="3-use-after-free-dangling-pointer"><a class="header" href="#3-use-after-free-dangling-pointer">3. Use After Free (Dangling Pointer)</a></h4>
<pre><code class="language-c">int *ptr = (int *)malloc(sizeof(int));
*ptr = 42;
free(ptr);
printf("%d\n", *ptr);  // ERROR: ptr points to freed memory!
ptr = NULL;  // Should do this after free
</code></pre>
<h4 id="4-buffer-overflow"><a class="header" href="#4-buffer-overflow">4. Buffer Overflow</a></h4>
<pre><code class="language-c">char *str = (char *)malloc(5);
strcpy(str, "Hello World");  // ERROR: Buffer overflow!
                             // "Hello World" needs 12 bytes, only allocated 5
free(str);
</code></pre>
<h4 id="5-null-pointer-dereference"><a class="header" href="#5-null-pointer-dereference">5. Null Pointer Dereference</a></h4>
<pre><code class="language-c">int *ptr = (int *)malloc(sizeof(int));
// Allocation failed
if (ptr == NULL) {
    *ptr = 42;  // ERROR: Dereferencing NULL!
}
</code></pre>
<h3 id="best-practices-for-dynamic-memory"><a class="header" href="#best-practices-for-dynamic-memory">Best Practices for Dynamic Memory</a></h3>
<pre><code class="language-c">// 1. Always check if malloc/calloc/realloc succeeded
int *ptr = (int *)malloc(sizeof(int));
if (ptr == NULL) {
    // Handle error
    return -1;
}

// 2. Use sizeof for type safety
int *arr = (int *)malloc(100 * sizeof(int));  // Good
int *arr = (int *)malloc(100 * 4);            // Avoid - hardcoded size

// 3. Free in reverse order of allocation
void *p1 = malloc(100);
void *p2 = malloc(200);
void *p3 = malloc(300);

free(p3);
free(p2);
free(p1);

// 4. Set pointer to NULL after free
free(ptr);
ptr = NULL;

// 5. Avoid memory leaks - create cleanup paths
FILE *file = fopen("data.txt", "r");
int *data = (int *)malloc(1000 * sizeof(int));

if (file == NULL) {
    free(data);  // Clean up before returning
    return -1;
}

// Process file
if (some_error) {
    fclose(file);
    free(data);  // Clean up before returning
    return -1;
}

fclose(file);
free(data);
return 0;

// 6. Use wrapper functions for consistency
void* safe_malloc(size_t size) {
    void *ptr = malloc(size);
    if (ptr == NULL) {
        fprintf(stderr, "malloc failed: requested %zu bytes\n", size);
        exit(1);  // Or handle error differently
    }
    return ptr;
}

int *arr = (int *)safe_malloc(100 * sizeof(int));
</code></pre>
<h3 id="memory-leak-detection-tools"><a class="header" href="#memory-leak-detection-tools">Memory Leak Detection Tools</a></h3>
<pre><code class="language-bash"># Valgrind - memory error detector
valgrind --leak-check=full --show-leak-kinds=all ./program

# AddressSanitizer (GCC/Clang)
gcc -fsanitize=address -g program.c -o program
./program

# Dr. Memory (Windows)
drmemory -leaks_only -- program.exe
</code></pre>
<h3 id="comparison-of-allocation-functions"><a class="header" href="#comparison-of-allocation-functions">Comparison of Allocation Functions</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Function</th><th>Initialization</th><th>Returns NULL on Fail</th><th>Use Case</th></tr></thead><tbody>
<tr><td><strong>malloc</strong></td><td>No (garbage values)</td><td>Yes</td><td>When you'll initialize manually</td></tr>
<tr><td><strong>calloc</strong></td><td>Yes (all zeros)</td><td>Yes</td><td>When you need zeroed memory</td></tr>
<tr><td><strong>realloc</strong></td><td>Preserves existing</td><td>Yes</td><td>When resizing allocations</td></tr>
</tbody></table>
</div>
<h3 id="memory-allocation-time-complexity"><a class="header" href="#memory-allocation-time-complexity">Memory Allocation Time Complexity</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Operation</th><th>Time Complexity</th><th>Space Complexity</th></tr></thead><tbody>
<tr><td><strong>malloc/calloc</strong></td><td>O(1) amortized</td><td>O(1)</td></tr>
<tr><td><strong>free</strong></td><td>O(1) amortized</td><td>O(1)</td></tr>
<tr><td><strong>realloc</strong></td><td>O(n)</td><td>O(n)</td></tr>
</tbody></table>
</div>
<h2 id="commonly-used-string-library-functions"><a class="header" href="#commonly-used-string-library-functions">Commonly Used String Library Functions</a></h2>
<p>The C standard library provides a set of functions for manipulating strings. Here are some commonly used string functions:</p>
<ol>
<li>
<p><strong>strlen</strong> - Calculate the length of a string:</p>
<pre><code class="language-c">#include &lt;string.h&gt;
size_t length = strlen("example");
</code></pre>
</li>
<li>
<p><strong>strcpy</strong> - Copy a string:</p>
<pre><code class="language-c">#include &lt;string.h&gt;
char dest[20];
strcpy(dest, "source");
</code></pre>
</li>
<li>
<p><strong>strncpy</strong> - Copy a specified number of characters from a string:</p>
<pre><code class="language-c">#include &lt;string.h&gt;
char dest[20];
strncpy(dest, "source", 5);
</code></pre>
</li>
<li>
<p><strong>strcat</strong> - Concatenate two strings:</p>
<pre><code class="language-c">#include &lt;string.h&gt;
char dest[20] = "Hello, ";
strcat(dest, "World!");
</code></pre>
</li>
<li>
<p><strong>strncat</strong> - Concatenate a specified number of characters from one string to another:</p>
<pre><code class="language-c">#include &lt;string.h&gt;
char dest[20] = "Hello, ";
strncat(dest, "World!", 3);
</code></pre>
</li>
<li>
<p><strong>strcmp</strong> - Compare two strings:</p>
<pre><code class="language-c">#include &lt;string.h&gt;
int result = strcmp("string1", "string2");
</code></pre>
</li>
<li>
<p><strong>strncmp</strong> - Compare a specified number of characters from two strings:</p>
<pre><code class="language-c">#include &lt;string.h&gt;
int result = strncmp("string1", "string2", 5);
</code></pre>
</li>
<li>
<p><strong>strchr</strong> - Find the first occurrence of a character in a string:</p>
<pre><code class="language-c">#include &lt;string.h&gt;
char *ptr = strchr("example", 'a');
</code></pre>
</li>
<li>
<p><strong>strrchr</strong> - Find the last occurrence of a character in a string:</p>
<pre><code class="language-c">#include &lt;string.h&gt;
char *ptr = strrchr("example", 'e');
</code></pre>
</li>
<li>
<p><strong>strstr</strong> - Find the first occurrence of a substring in a string:</p>
<pre><code class="language-c">#include &lt;string.h&gt;
char *ptr = strstr("example", "amp");
</code></pre>
</li>
</ol>
<p>These functions cover a variety of common use cases for string manipulation in C, making them essential tools for C programmers.</p>
<h3 id="variants-of-printf-and-scanf"><a class="header" href="#variants-of-printf-and-scanf">Variants of <code>printf</code> and <code>scanf</code></a></h3>
<p>The <code>printf</code> and <code>scanf</code> functions are commonly used for input and output in C. There are several variants of these functions that provide additional functionality.</p>
<h4 id="printf-variants"><a class="header" href="#printf-variants"><code>printf</code> Variants</a></h4>
<ol>
<li>
<p><strong><code>printf</code></strong> - Print formatted output to the standard output:</p>
<pre><code class="language-c">#include &lt;stdio.h&gt;
printf("Hello, %s!\n", "World");
</code></pre>
</li>
<li>
<p><strong><code>fprintf</code></strong> - Print formatted output to a file:</p>
<pre><code class="language-c">#include &lt;stdio.h&gt;
FILE *file = fopen("output.txt", "w");
fprintf(file, "Hello, %s!\n", "World");
fclose(file);
</code></pre>
</li>
<li>
<p><strong><code>sprintf</code></strong> - Print formatted output to a string:</p>
<pre><code class="language-c">#include &lt;stdio.h&gt;
char buffer[50];
sprintf(buffer, "Hello, %s!", "World");
</code></pre>
</li>
<li>
<p><strong><code>snprintf</code></strong> - Print formatted output to a string with a limit on the number of characters:</p>
<pre><code class="language-c">#include &lt;stdio.h&gt;
char buffer[50];
snprintf(buffer, sizeof(buffer), "Hello, %s!", "World");
</code></pre>
</li>
<li>
<p><strong><code>vprintf</code></strong> - Print formatted output using a <code>va_list</code>:</p>
<pre><code class="language-c">#include &lt;stdio.h&gt;
#include &lt;stdarg.h&gt;
void my_vprintf(const char *format, ...) {
    va_list args;
    va_start(args, format);
    vprintf(format, args);
    va_end(args);
}
</code></pre>
</li>
<li>
<p><strong><code>vfprintf</code></strong> - Print formatted output to a file using a <code>va_list</code>:</p>
<pre><code class="language-c">#include &lt;stdio.h&gt;
#include &lt;stdarg.h&gt;
void my_vfprintf(FILE *file, const char *format, ...) {
    va_list args;
    va_start(args, format);
    vfprintf(file, format, args);
    va_end(args);
}
</code></pre>
</li>
<li>
<p><strong><code>vsprintf</code></strong> - Print formatted output to a string using a <code>va_list</code>:</p>
<pre><code class="language-c">#include &lt;stdio.h&gt;
#include &lt;stdarg.h&gt;
void my_vsprintf(char *buffer, const char *format, ...) {
    va_list args;
    va_start(args, format);
    vsprintf(buffer, format, args);
    va_end(args);
}
</code></pre>
</li>
<li>
<p><strong><code>vsnprintf</code></strong> - Print formatted output to a string with a limit on the number of characters using a <code>va_list</code>:</p>
<pre><code class="language-c">#include &lt;stdio.h&gt;
#include &lt;stdarg.h&gt;
void my_vsnprintf(char *buffer, size_t size, const char *format, ...) {
    va_list args;
    va_start(args, format);
    vsnprintf(buffer, size, format, args);
    va_end(args);
}
</code></pre>
</li>
</ol>
<h4 id="scanf-variants"><a class="header" href="#scanf-variants"><code>scanf</code> Variants</a></h4>
<ol>
<li>
<p><strong><code>scanf</code></strong> - Read formatted input from the standard input:</p>
<pre><code class="language-c">#include &lt;stdio.h&gt;
int value;
scanf("%d", &amp;value);
</code></pre>
</li>
<li>
<p><strong><code>fscanf</code></strong> - Read formatted input from a file:</p>
<pre><code class="language-c">#include &lt;stdio.h&gt;
FILE *file = fopen("input.txt", "r");
int value;
fscanf(file, "%d", &amp;value);
fclose(file);
</code></pre>
</li>
<li>
<p><strong><code>sscanf</code></strong> - Read formatted input from a string:</p>
<pre><code class="language-c">#include &lt;stdio.h&gt;
const char *str = "123";
int value;
sscanf(str, "%d", &amp;value);
</code></pre>
</li>
<li>
<p><strong><code>vscanf</code></strong> - Read formatted input using a <code>va_list</code>:</p>
<pre><code class="language-c">#include &lt;stdio.h&gt;
#include &lt;stdarg.h&gt;
void my_vscanf(const char *format, ...) {
    va_list args;
    va_start(args, format);
    vscanf(format, args);
    va_end(args);
}
</code></pre>
</li>
<li>
<p><strong><code>vfscanf</code></strong> - Read formatted input from a file using a <code>va_list</code>:</p>
<pre><code class="language-c">#include &lt;stdio.h&gt;
#include &lt;stdarg.h&gt;
void my_vfscanf(FILE *file, const char *format, ...) {
    va_list args;
    va_start(args, format);
    vfscanf(file, format, args);
    va_end(args);
}
</code></pre>
</li>
<li>
<p><strong><code>vsscanf</code></strong> - Read formatted input from a string using a <code>va_list</code>:</p>
<pre><code class="language-c">#include &lt;stdio.h&gt;
#include &lt;stdarg.h&gt;
void my_vsscanf(const char *str, const char *format, ...) {
    va_list args;
    va_start(args, format);
    vsscanf(str, format, args);
    va_end(args);
}
</code></pre>
</li>
</ol>
<p>These variants of <code>printf</code> and <code>scanf</code> provide flexibility for different input and output scenarios in C programming.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="c"><a class="header" href="#c">C++</a></h1>
<h2 id="overview-3"><a class="header" href="#overview-3">Overview</a></h2>
<p>C++ is an extension of C that adds object-oriented features and other enhancements.</p>
<h2 id="key-features"><a class="header" href="#key-features">Key Features</a></h2>
<ul>
<li>Object-oriented programming</li>
<li>Generic programming support</li>
<li>Standard Template Library (STL)</li>
<li>Low-level memory manipulation</li>
<li>High performance</li>
</ul>
<h2 id="object-instantiation-patterns"><a class="header" href="#object-instantiation-patterns">Object Instantiation Patterns</a></h2>
<p>C++ provides multiple ways to create and initialize objects, each with different characteristics regarding memory management, lifetime, and performance.</p>
<h3 id="1-stack-allocation-automatic-storage"><a class="header" href="#1-stack-allocation-automatic-storage">1. <strong>Stack Allocation (Automatic Storage)</strong></a></h3>
<p>Objects created on the stack have automatic lifetime - they're destroyed when they go out of scope.</p>
<pre><code class="language-cpp">class MyClass {
public:
    int value;
    MyClass(int v) : value(v) {
        std::cout &lt;&lt; "Constructor called: " &lt;&lt; value &lt;&lt; std::endl;
    }
    ~MyClass() {
        std::cout &lt;&lt; "Destructor called: " &lt;&lt; value &lt;&lt; std::endl;
    }
};

void example() {
    MyClass obj1(10);           // Stack allocation
    MyClass obj2 = MyClass(20); // Also stack allocation
    MyClass obj3{30};           // C++11 uniform initialization

    // All objects destroyed automatically when function exits
}
</code></pre>
<p><strong>Advantages:</strong></p>
<ul>
<li>Fast allocation/deallocation</li>
<li>Automatic cleanup (RAII)</li>
<li>No memory leaks</li>
</ul>
<p><strong>Disadvantages:</strong></p>
<ul>
<li>Limited stack size</li>
<li>Objects can't outlive their scope</li>
</ul>
<h3 id="2-heap-allocation-with-newdelete"><a class="header" href="#2-heap-allocation-with-newdelete">2. <strong>Heap Allocation with new/delete</strong></a></h3>
<p>Objects created on the heap persist until explicitly deleted.</p>
<pre><code class="language-cpp">// Single object
MyClass* ptr1 = new MyClass(100);  // Allocate on heap
// Use ptr1...
delete ptr1;  // Must manually delete
ptr1 = nullptr;  // Good practice

// Array of objects
MyClass* arr = new MyClass[5];  // Default constructor for each
// Use arr...
delete[] arr;  // Must use delete[] for arrays
arr = nullptr;

// With initialization (C++11)
MyClass* ptr2 = new MyClass{200};
delete ptr2;
</code></pre>
<p><strong>Advantages:</strong></p>
<ul>
<li>Objects can outlive their scope</li>
<li>Larger available memory</li>
<li>Dynamic sizing</li>
</ul>
<p><strong>Disadvantages:</strong></p>
<ul>
<li>Manual memory management</li>
<li>Risk of memory leaks</li>
<li>Slower than stack allocation</li>
</ul>
<h3 id="3-smart-pointers-modern-c"><a class="header" href="#3-smart-pointers-modern-c">3. <strong>Smart Pointers (Modern C++)</strong></a></h3>
<p>Smart pointers provide automatic memory management for heap-allocated objects.</p>
<pre><code class="language-cpp">#include &lt;memory&gt;

// std::unique_ptr - exclusive ownership
{
    std::unique_ptr&lt;MyClass&gt; ptr1 = std::make_unique&lt;MyClass&gt;(10);
    // Automatically deleted when ptr1 goes out of scope
    // Cannot be copied, only moved

    auto ptr2 = std::make_unique&lt;MyClass&gt;(20);  // Using auto
    std::unique_ptr&lt;MyClass&gt; ptr3 = std::move(ptr2);  // Transfer ownership
    // ptr2 is now nullptr
}

// std::shared_ptr - shared ownership
{
    std::shared_ptr&lt;MyClass&gt; ptr1 = std::make_shared&lt;MyClass&gt;(30);
    {
        std::shared_ptr&lt;MyClass&gt; ptr2 = ptr1;  // Both own the object
        std::cout &lt;&lt; "Reference count: " &lt;&lt; ptr1.use_count() &lt;&lt; std::endl;  // 2
    }  // ptr2 destroyed, object still exists
    std::cout &lt;&lt; "Reference count: " &lt;&lt; ptr1.use_count() &lt;&lt; std::endl;  // 1
}  // Object deleted when last shared_ptr is destroyed

// Array with smart pointers (C++17)
auto arr = std::make_unique&lt;MyClass[]&gt;(5);
</code></pre>
<p><strong>Advantages:</strong></p>
<ul>
<li>Automatic memory management</li>
<li>Exception-safe</li>
<li>Clear ownership semantics</li>
</ul>
<p><strong>Disadvantages:</strong></p>
<ul>
<li>Slight overhead (especially shared_ptr)</li>
<li>Reference counting overhead</li>
</ul>
<h3 id="4-initialization-patterns"><a class="header" href="#4-initialization-patterns">4. <strong>Initialization Patterns</strong></a></h3>
<p>C++ offers various initialization syntaxes with different behaviors.</p>
<pre><code class="language-cpp">class Point {
public:
    int x, y;
    Point() : x(0), y(0) {}
    Point(int x, int y) : x(x), y(y) {}
};

// Default initialization
Point p1;  // Calls default constructor: Point()

// Direct initialization
Point p2(10, 20);  // Calls Point(int, int)

// Copy initialization
Point p3 = Point(30, 40);  // May involve copy/move

// List initialization (Uniform initialization - C++11)
Point p4{50, 60};        // Direct list initialization
Point p5 = {70, 80};     // Copy list initialization
auto p6 = Point{90, 100}; // With auto

// Value initialization
Point p7{};     // Zero-initializes: x=0, y=0
Point* p8 = new Point();   // Value initialization on heap

// Aggregate initialization (for POD types)
struct Data {
    int a;
    double b;
    char c;
};

Data d1 = {1, 2.5, 'x'};   // C-style
Data d2{1, 2.5, 'x'};      // C++11 style
Data d3{.a=1, .b=2.5};     // C++20 designated initializers
</code></pre>
<h3 id="5-constructor-patterns"><a class="header" href="#5-constructor-patterns">5. <strong>Constructor Patterns</strong></a></h3>
<p>Different ways to call constructors for initialization.</p>
<pre><code class="language-cpp">class Resource {
private:
    int* data;
    size_t size;

public:
    // Default constructor
    Resource() : data(nullptr), size(0) {
        std::cout &lt;&lt; "Default constructor" &lt;&lt; std::endl;
    }

    // Parameterized constructor
    Resource(size_t sz) : data(new int[sz]), size(sz) {
        std::cout &lt;&lt; "Parameterized constructor" &lt;&lt; std::endl;
    }

    // Copy constructor
    Resource(const Resource&amp; other) : size(other.size) {
        data = new int[size];
        std::copy(other.data, other.data + size, data);
        std::cout &lt;&lt; "Copy constructor" &lt;&lt; std::endl;
    }

    // Move constructor (C++11)
    Resource(Resource&amp;&amp; other) noexcept : data(other.data), size(other.size) {
        other.data = nullptr;
        other.size = 0;
        std::cout &lt;&lt; "Move constructor" &lt;&lt; std::endl;
    }

    // Destructor
    ~Resource() {
        delete[] data;
        std::cout &lt;&lt; "Destructor" &lt;&lt; std::endl;
    }
};

// Usage examples
Resource r1;                      // Default constructor
Resource r2(100);                 // Parameterized constructor
Resource r3 = r2;                 // Copy constructor
Resource r4 = std::move(r2);      // Move constructor
Resource r5(std::move(r3));       // Move constructor (explicit)
</code></pre>
<h3 id="6-factory-pattern"><a class="header" href="#6-factory-pattern">6. <strong>Factory Pattern</strong></a></h3>
<p>Using factory functions for object creation.</p>
<pre><code class="language-cpp">class Shape {
public:
    virtual void draw() = 0;
    virtual ~Shape() = default;
};

class Circle : public Shape {
    double radius;
public:
    Circle(double r) : radius(r) {}
    void draw() override { std::cout &lt;&lt; "Drawing circle" &lt;&lt; std::endl; }
};

class Rectangle : public Shape {
    double width, height;
public:
    Rectangle(double w, double h) : width(w), height(h) {}
    void draw() override { std::cout &lt;&lt; "Drawing rectangle" &lt;&lt; std::endl; }
};

// Factory function
std::unique_ptr&lt;Shape&gt; createShape(const std::string&amp; type) {
    if (type == "circle") {
        return std::make_unique&lt;Circle&gt;(5.0);
    } else if (type == "rectangle") {
        return std::make_unique&lt;Rectangle&gt;(4.0, 6.0);
    }
    return nullptr;
}

// Usage
auto shape = createShape("circle");
if (shape) {
    shape-&gt;draw();
}
</code></pre>
<h3 id="7-placement-new"><a class="header" href="#7-placement-new">7. <strong>Placement New</strong></a></h3>
<p>Constructing objects at a specific memory location.</p>
<pre><code class="language-cpp">#include &lt;new&gt;

// Pre-allocated buffer
alignas(MyClass) char buffer[sizeof(MyClass)];

// Construct object in buffer
MyClass* obj = new (buffer) MyClass(42);

// Use object
obj-&gt;value = 100;

// Must manually call destructor
obj-&gt;~MyClass();

// Common use case: memory pools
class MemoryPool {
    char buffer[1024];
public:
    template&lt;typename T, typename... Args&gt;
    T* construct(Args&amp;&amp;... args) {
        void* ptr = /* allocate from buffer */;
        return new (ptr) T(std::forward&lt;Args&gt;(args)...);
    }
};
</code></pre>
<h3 id="8-array-initialization-patterns"><a class="header" href="#8-array-initialization-patterns">8. <strong>Array Initialization Patterns</strong></a></h3>
<p>Different ways to create and initialize arrays of objects.</p>
<pre><code class="language-cpp">// Stack arrays
MyClass arr1[3];                    // Default constructor for each
MyClass arr2[3] = {MyClass(1), MyClass(2), MyClass(3)};  // Specific initialization
MyClass arr3[] = {MyClass(10), MyClass(20)};  // Size inferred

// Uniform initialization (C++11)
MyClass arr4[3] = {{1}, {2}, {3}};
MyClass arr5[3]{{1}, {2}, {3}};

// Heap arrays
MyClass* heap_arr1 = new MyClass[5];      // Default constructor
delete[] heap_arr1;

// std::array (C++11)
#include &lt;array&gt;
std::array&lt;MyClass, 3&gt; arr6 = {MyClass(1), MyClass(2), MyClass(3)};
std::array&lt;MyClass, 3&gt; arr7{MyClass(1), MyClass(2), MyClass(3)};

// std::vector (dynamic array)
#include &lt;vector&gt;
std::vector&lt;MyClass&gt; vec1;                // Empty vector
std::vector&lt;MyClass&gt; vec2(5);             // 5 default-constructed objects
std::vector&lt;MyClass&gt; vec3(5, MyClass(42)); // 5 copies of MyClass(42)
std::vector&lt;MyClass&gt; vec4{MyClass(1), MyClass(2), MyClass(3)};  // Initializer list
</code></pre>
<h3 id="9-emplace-construction"><a class="header" href="#9-emplace-construction">9. <strong>Emplace Construction</strong></a></h3>
<p>Constructing objects in-place within containers (C++11).</p>
<pre><code class="language-cpp">#include &lt;vector&gt;
#include &lt;map&gt;

std::vector&lt;MyClass&gt; vec;

// push_back creates temporary and moves/copies it
vec.push_back(MyClass(10));

// emplace_back constructs directly in the vector (more efficient)
vec.emplace_back(20);  // Constructs MyClass(20) in-place

// Similarly for maps
std::map&lt;int, MyClass&gt; myMap;
myMap.emplace(1, MyClass(100));        // Creates pair in-place
myMap.try_emplace(2, 200);             // Even better, doesn't construct if key exists

// emplace with multiple arguments
struct Person {
    std::string name;
    int age;
    Person(std::string n, int a) : name(n), age(a) {}
};

std::vector&lt;Person&gt; people;
people.emplace_back("Alice", 30);  // Constructs Person directly in vector
</code></pre>
<h3 id="10-raii-pattern-resource-acquisition-is-initialization"><a class="header" href="#10-raii-pattern-resource-acquisition-is-initialization">10. <strong>RAII Pattern (Resource Acquisition Is Initialization)</strong></a></h3>
<p>Tying resource lifetime to object lifetime.</p>
<pre><code class="language-cpp">class FileHandler {
    FILE* file;
public:
    // Resource acquired in constructor
    FileHandler(const char* filename, const char* mode) {
        file = fopen(filename, mode);
        if (!file) throw std::runtime_error("Failed to open file");
    }

    // Resource released in destructor
    ~FileHandler() {
        if (file) {
            fclose(file);
        }
    }

    // Prevent copying
    FileHandler(const FileHandler&amp;) = delete;
    FileHandler&amp; operator=(const FileHandler&amp;) = delete;

    // Allow moving
    FileHandler(FileHandler&amp;&amp; other) noexcept : file(other.file) {
        other.file = nullptr;
    }

    FILE* get() { return file; }
};

// Usage - no need to manually close file
void processFile() {
    FileHandler handler("data.txt", "r");
    // Use handler.get()...
    // File automatically closed when handler goes out of scope
}
</code></pre>
<h3 id="11-copy-elision-and-rvo-return-value-optimization"><a class="header" href="#11-copy-elision-and-rvo-return-value-optimization">11. <strong>Copy Elision and RVO (Return Value Optimization)</strong></a></h3>
<p>The compiler can optimize away unnecessary copies.</p>
<pre><code class="language-cpp">MyClass createObject() {
    MyClass obj(100);
    return obj;  // RVO: object constructed directly in caller's space
}

MyClass obj1 = createObject();  // No copy/move, direct construction (C++17 guaranteed)

// Named Return Value Optimization (NRVO)
MyClass createNamed(int value) {
    MyClass result(value);
    // ... operations on result
    return result;  // May be optimized (not guaranteed)
}
</code></pre>
<h3 id="best-practices-for-object-instantiation"><a class="header" href="#best-practices-for-object-instantiation">Best Practices for Object Instantiation</a></h3>
<ol>
<li><strong>Prefer stack allocation</strong> when possible - it's fastest and safest</li>
<li><strong>Use smart pointers</strong> instead of raw new/delete for heap allocation</li>
<li><strong>Use <code>std::make_unique</code> and <code>std::make_shared</code></strong> for creating smart pointers</li>
<li><strong>Use uniform initialization <code>{}</code></strong> to avoid most vexing parse and narrowing conversions</li>
<li><strong>Use <code>emplace</code> methods</strong> in containers for in-place construction</li>
<li><strong>Follow RAII principles</strong> for resource management</li>
<li><strong>Prefer <code>std::vector</code> and <code>std::array</code></strong> over raw arrays</li>
<li><strong>Avoid naked <code>new</code></strong> - use smart pointers or containers</li>
</ol>
<pre><code class="language-cpp">// Good practices example
void goodPractices() {
    // Stack allocation when lifetime is scoped
    MyClass local(42);

    // Smart pointers for heap allocation
    auto ptr = std::make_unique&lt;MyClass&gt;(100);

    // Uniform initialization
    MyClass obj{50};

    // Containers for collections
    std::vector&lt;MyClass&gt; vec;
    vec.emplace_back(10);
    vec.emplace_back(20);

    // RAII for resources
    std::ifstream file("data.txt");
    // File automatically closed
}
</code></pre>
<h2 id="c-strings-and-their-methods"><a class="header" href="#c-strings-and-their-methods">C++ Strings and Their Methods</a></h2>
<p>In C++, the <code>std::string</code> class provides a powerful and flexible way to handle strings. It offers a variety of methods for string manipulation, making it easier to perform common operations without dealing with low-level character arrays. Below are some of the most commonly used <code>std::string</code> methods in detail:</p>
<h3 id="1-constructors"><a class="header" href="#1-constructors">1. <strong>Constructors</strong></a></h3>
<p><code>std::string</code> offers multiple constructors to initialize strings in different ways.</p>
<pre><code class="language-cpp">#include &lt;string&gt;

// Default constructor
std::string str1;

// Constructor with a C-string
std::string str2("Hello, World!");

// Constructor with a specific number of repeated characters
std::string str3(5, 'a'); // "aaaaa"

// Copy constructor
std::string str4(str2);

// Substring constructor
std::string str5(str2, 7, 5); // "World"
</code></pre>
<h3 id="2-size-and-capacity"><a class="header" href="#2-size-and-capacity">2. <strong>Size and Capacity</strong></a></h3>
<ul>
<li><code>size()</code> / <code>length()</code>: Returns the number of characters in the string.</li>
<li><code>capacity()</code>: Returns the size of the storage space currently allocated for the string.</li>
</ul>
<pre><code class="language-cpp">std::string str = "Example";
size_t len = str.size(); // 7
size_t cap = str.capacity(); // Implementation-defined
</code></pre>
<h3 id="3-accessing-characters"><a class="header" href="#3-accessing-characters">3. <strong>Accessing Characters</strong></a></h3>
<ul>
<li><code>operator[]</code>: Accesses character at a specific index.</li>
<li><code>at()</code>: Accesses character at a specific index with bounds checking.</li>
<li><code>front()</code> / <code>back()</code>: Accesses the first and last characters.</li>
</ul>
<pre><code class="language-cpp">std::string str = "Hello";
char ch = str[1]; // 'e'
char ch_at = str.at(2); // 'l'
char first = str.front(); // 'H'
char last = str.back(); // 'o'
</code></pre>
<h3 id="4-modifiers"><a class="header" href="#4-modifiers">4. <strong>Modifiers</strong></a></h3>
<ul>
<li><code>append()</code>: Adds characters to the end of the string.</li>
<li><code>clear()</code>: Removes all characters from the string.</li>
<li><code>insert()</code>: Inserts characters at a specified position.</li>
<li><code>erase()</code>: Removes characters from a specified position.</li>
<li><code>replace()</code>: Replaces part of the string with another string.</li>
</ul>
<pre><code class="language-cpp">std::string str = "Hello";
str.append(", World!"); // "Hello, World!"
str.insert(5, " C++"); // "Hello C++, World!"
str.erase(5, 6); // "HelloWorld!"
str.replace(5, 5, " C++"); // "Hello C++!"
str.clear(); // ""
</code></pre>
<h3 id="5-substring-and-extracting"><a class="header" href="#5-substring-and-extracting">5. <strong>Substring and Extracting</strong></a></h3>
<ul>
<li><code>substr()</code>: Returns a substring starting from a specified position.</li>
</ul>
<pre><code class="language-cpp">std::string str = "Hello, World!";
std::string sub = str.substr(7, 5); // "World"
</code></pre>
<h3 id="6-finding-characters-and-substrings"><a class="header" href="#6-finding-characters-and-substrings">6. <strong>Finding Characters and Substrings</strong></a></h3>
<ul>
<li><code>find()</code>: Searches for a substring or character and returns the position.</li>
<li><code>rfind()</code>: Searches for a substring or character from the end.</li>
</ul>
<pre><code class="language-cpp">std::string str = "Hello, World!";
size_t pos = str.find("World"); // 7
size_t rpos = str.rfind('o'); // 8
</code></pre>
<h3 id="7-comparison"><a class="header" href="#7-comparison">7. <strong>Comparison</strong></a></h3>
<ul>
<li><code>compare()</code>: Compares two strings.</li>
</ul>
<pre><code class="language-cpp">std::string str1 = "apple";
std::string str2 = "banana";

int result = str1.compare(str2);
// result &lt; 0 since "apple" &lt; "banana"
</code></pre>
<h3 id="8-conversion-to-c-string"><a class="header" href="#8-conversion-to-c-string">8. <strong>Conversion to C-string</strong></a></h3>
<ul>
<li><code>c_str()</code>: Returns a C-style null-terminated string.</li>
</ul>
<pre><code class="language-cpp">std::string str = "Hello";
const char* cstr = str.c_str();
</code></pre>
<h3 id="9-iterators"><a class="header" href="#9-iterators">9. <strong>Iterators</strong></a></h3>
<p><code>std::string</code> supports iterators to traverse the string.</p>
<pre><code class="language-cpp">std::string str = "Hello";
for (std::string::iterator it = str.begin(); it != str.end(); ++it) {
    std::cout &lt;&lt; *it &lt;&lt; ' ';
}
// Output: H e l l o 
</code></pre>
<h3 id="10-emplace-and-emplace_back"><a class="header" href="#10-emplace-and-emplace_back">10. <strong>Emplace and Emplace_back</strong></a></h3>
<ul>
<li><code>emplace()</code>: Constructs and inserts a substring.</li>
<li><code>emplace_back()</code>: Appends a character to the end of the string.</li>
</ul>
<pre><code class="language-cpp">std::string str = "Hello";
str.emplace(str.size(), '!'); // "Hello!"
str.emplace_back('?'); // "Hello!?"
</code></pre>
<h3 id="11-swap"><a class="header" href="#11-swap">11. <strong>Swap</strong></a></h3>
<ul>
<li><code>swap()</code>: Swaps the contents of two strings.</li>
</ul>
<pre><code class="language-cpp">std::string str1 = "Hello";
std::string str2 = "World";
str1.swap(str2);
// str1 is now "World", str2 is now "Hello"
</code></pre>
<h3 id="12-transform"><a class="header" href="#12-transform">12. <strong>Transform</strong></a></h3>
<p>You can apply transformations to each character using algorithms.</p>
<pre><code class="language-cpp">#include &lt;algorithm&gt;

std::string str = "Hello";
std::transform(str.begin(), str.end(), str.begin(), ::toupper); // "HELLO"
</code></pre>
<h3 id="13-other-useful-methods"><a class="header" href="#13-other-useful-methods">13. <strong>Other Useful Methods</strong></a></h3>
<ul>
<li><code>empty()</code>: Checks if the string is empty.</li>
<li><code>find_first_of()</code> / <code>find_last_of()</code>: Finds the first/last occurrence of any character from a set.</li>
<li><code>find_first_not_of()</code> / <code>find_last_not_of()</code>: Finds the first/last character not in a set.</li>
</ul>
<pre><code class="language-cpp">std::string str = "Hello";
bool isEmpty = str.empty(); // false
size_t pos = str.find_first_of('e'); // 1
size_t not_pos = str.find_first_not_of('H'); // 1
</code></pre>
<h3 id="example-usage"><a class="header" href="#example-usage">Example Usage</a></h3>
<pre><code class="language-cpp">#include &lt;iostream&gt;
#include &lt;string&gt;

int main() {
    std::string greeting = "Hello";
    greeting += ", World!"; // Using operator +=
    
    std::cout &lt;&lt; greeting &lt;&lt; std::endl; // Output: Hello, World!
    
    // Find and replace
    size_t pos = greeting.find("World");
    if (pos != std::string::npos) {
        greeting.replace(pos, 5, "C++");
    }
    
    std::cout &lt;&lt; greeting &lt;&lt; std::endl; // Output: Hello, C++!
    
    return 0;
}
</code></pre>
<p>Understanding and utilizing these <code>std::string</code> methods can greatly enhance your ability to manipulate and manage text in C++ applications effectively.</p>
<h2 id="c-vectors-and-their-methods"><a class="header" href="#c-vectors-and-their-methods">C++ Vectors and Their Methods</a></h2>
<p>In C++, the <code>std::vector</code> class template provides a dynamic array that can resize itself automatically when elements are added or removed. It offers numerous methods to manipulate the data efficiently. Below are detailed explanations and examples of various <code>std::vector</code> methods:</p>
<h3 id="1-constructors-1"><a class="header" href="#1-constructors-1">1. <strong>Constructors</strong></a></h3>
<p><code>std::vector</code> offers multiple constructors to initialize vectors in different ways.</p>
<pre><code class="language-cpp">#include &lt;vector&gt;

// Default constructor
std::vector&lt;int&gt; vec1;

// Constructor with a specific size
std::vector&lt;int&gt; vec2(5); // {0, 0, 0, 0, 0}

// Constructor with a specific size and initial value
std::vector&lt;int&gt; vec3(5, 10); // {10, 10, 10, 10, 10}

// Initializer list constructor
std::vector&lt;int&gt; vec4 = {1, 2, 3, 4, 5};

// Copy constructor
std::vector&lt;int&gt; vec5(vec4);
</code></pre>
<h3 id="2-size-and-capacity-1"><a class="header" href="#2-size-and-capacity-1">2. <strong>Size and Capacity</strong></a></h3>
<ul>
<li><code>size()</code>: Returns the number of elements in the vector.</li>
<li><code>capacity()</code>: Returns the size of the storage space currently allocated for the vector, expressed in terms of elements.</li>
<li><code>empty()</code>: Checks whether the vector is empty.</li>
</ul>
<pre><code class="language-cpp">std::vector&lt;int&gt; vec = {1, 2, 3};
size_t sz = vec.size(); // 3
size_t cap = vec.capacity(); // &gt;= 3
bool isEmpty = vec.empty(); // false
</code></pre>
<h3 id="3-element-access"><a class="header" href="#3-element-access">3. <strong>Element Access</strong></a></h3>
<ul>
<li><code>operator[]</code>: Accesses element at a specific index without bounds checking.</li>
<li><code>at()</code>: Accesses element at a specific index with bounds checking.</li>
<li><code>front()</code>: Accesses the first element.</li>
<li><code>back()</code>: Accesses the last element.</li>
<li><code>data()</code>: Returns a pointer to the underlying array.</li>
</ul>
<pre><code class="language-cpp">std::vector&lt;int&gt; vec = {10, 20, 30, 40, 50};
int first = vec[0]; // 10
int third = vec.at(2); // 30
int front = vec.front(); // 10
int back = vec.back(); // 50
int* ptr = vec.data(); // Pointer to the first element
</code></pre>
<h3 id="4-modifiers-1"><a class="header" href="#4-modifiers-1">4. <strong>Modifiers</strong></a></h3>
<ul>
<li><code>push_back()</code>: Adds an element to the end of the vector.</li>
<li><code>pop_back()</code>: Removes the last element of the vector.</li>
<li><code>insert()</code>: Inserts elements at a specified position.</li>
<li><code>erase()</code>: Removes elements from a specified position or range.</li>
<li><code>clear()</code>: Removes all elements from the vector.</li>
<li><code>resize()</code>: Changes the number of elements stored.</li>
<li><code>shrink_to_fit()</code>: Reduces capacity to fit the size.</li>
</ul>
<pre><code class="language-cpp">std::vector&lt;int&gt; vec = {1, 2, 3};

// push_back
vec.push_back(4); // {1, 2, 3, 4}

// pop_back
vec.pop_back(); // {1, 2, 3}

// insert
vec.insert(vec.begin() + 1, 10); // {1, 10, 2, 3}

// erase single element
vec.erase(vec.begin() + 2); // {1, 10, 3}

// erase range
vec.erase(vec.begin(), vec.begin() + 1); // {10, 3}

// clear
vec.clear(); // {}

// resize
vec.resize(5, 100); // {100, 100, 100, 100, 100}

// shrink_to_fit
vec.shrink_to_fit();
</code></pre>
<h3 id="5-iterators"><a class="header" href="#5-iterators">5. <strong>Iterators</strong></a></h3>
<p>Vectors support iterators to traverse and manipulate elements.</p>
<ul>
<li><code>begin()</code>: Returns an iterator to the first element.</li>
<li><code>end()</code>: Returns an iterator to one past the last element.</li>
<li><code>rbegin()</code>: Returns a reverse iterator to the last element.</li>
<li><code>rend()</code>: Returns a reverse iterator to one before the first element.</li>
</ul>
<pre><code class="language-cpp">std::vector&lt;int&gt; vec = {1, 2, 3, 4, 5};

// Forward iteration
for(auto it = vec.begin(); it != vec.end(); ++it) {
    std::cout &lt;&lt; *it &lt;&lt; " ";
}

// Reverse iteration
for(auto it = vec.rbegin(); it != vec.rend(); ++it) {
    std::cout &lt;&lt; *it &lt;&lt; " ";
}
</code></pre>
<h3 id="6-algorithms-support"><a class="header" href="#6-algorithms-support">6. <strong>Algorithms Support</strong></a></h3>
<p>Vectors work seamlessly with standard algorithms from the C++ Standard Library.</p>
<pre><code class="language-cpp">#include &lt;algorithm&gt;

std::vector&lt;int&gt; vec = {5, 3, 1, 4, 2};

// Sort the vector
std::sort(vec.begin(), vec.end()); // {1, 2, 3, 4, 5}

// Reverse the vector
std::reverse(vec.begin(), vec.end()); // {5, 4, 3, 2, 1}

// Find an element
auto it = std::find(vec.begin(), vec.end(), 3);
if(it != vec.end()) {
    std::cout &lt;&lt; "Found: " &lt;&lt; *it &lt;&lt; std::endl;
}
</code></pre>
<h3 id="7-capacity-management"><a class="header" href="#7-capacity-management">7. <strong>Capacity Management</strong></a></h3>
<ul>
<li><code>reserve()</code>: Increases the capacity of the vector to a value that's greater or equal to the specified.</li>
<li><code>capacity()</code>: Explained earlier.</li>
</ul>
<pre><code class="language-cpp">std::vector&lt;int&gt; vec;
vec.reserve(100); // Reserve space for 100 elements
std::cout &lt;&lt; "Capacity: " &lt;&lt; vec.capacity() &lt;&lt; std::endl;
</code></pre>
<p>Understanding and utilizing <code>std::vector</code> and its various methods can significantly enhance the efficiency and flexibility of your C++ programs, allowing for dynamic memory management and rich data manipulation capabilities.</p>
<h3 id="4-maps"><a class="header" href="#4-maps">4. <strong>Maps</strong></a></h3>
<p>C++ provides the <code>std::map</code> container, which is an associative container that stores elements formed by a combination of a key and a value. <code>std::map</code> automatically sorts its elements by key and allows fast retrieval of individual elements based on their keys.</p>
<h4 id="constructors"><a class="header" href="#constructors">Constructors</a></h4>
<p><code>std::map</code> offers multiple constructors to initialize maps in different ways.</p>
<pre><code class="language-cpp">#include &lt;map&gt;
#include &lt;string&gt;

// Default constructor
std::map&lt;int, std::string&gt; map1;

// Initializer list constructor
std::map&lt;int, std::string&gt; map2 = {
    {1, "one"},
    {2, "two"},
    {3, "three"}
};

// Range constructor
std::vector&lt;std::pair&lt;int, std::string&gt;&gt; vec = { {4, "four"}, {5, "five"} };
std::map&lt;int, std::string&gt; map3(vec.begin(), vec.end());

// Copy constructor
std::map&lt;int, std::string&gt; map4(map2);
</code></pre>
<h4 id="size-and-capacity"><a class="header" href="#size-and-capacity">Size and Capacity</a></h4>
<ul>
<li><code>size()</code>: Returns the number of elements in the map.</li>
<li><code>empty()</code>: Checks whether the map is empty.</li>
</ul>
<pre><code class="language-cpp">std::map&lt;int, std::string&gt; map = { {1, "one"}, {2, "two"}, {3, "three"} };
size_t sz = map.size(); // 3
bool isEmpty = map.empty(); // false
</code></pre>
<h4 id="element-access"><a class="header" href="#element-access">Element Access</a></h4>
<ul>
<li><code>operator[]</code>: Accesses or inserts elements with the given key.</li>
<li><code>at()</code>: Accesses elements with bounds checking.</li>
<li><code>find()</code>: Finds an element with a specific key.</li>
<li><code>count()</code>: Returns the number of elements with a specific key.</li>
</ul>
<pre><code class="language-cpp">// Using operator[]
map[4] = "four"; // Inserts if key 4 does not exist

// Using at()
try {
    std::string value = map.at(2); // "two"
} catch(const std::out_of_range&amp; e) {
    // Handle error
}

// Using find()
auto it = map.find(3);
if(it != map.end()) {
    std::cout &lt;&lt; "Found: " &lt;&lt; it-&gt;second &lt;&lt; std::endl; // "three"
}

// Using count()
if(map.count(5)) {
    std::cout &lt;&lt; "Key 5 exists." &lt;&lt; std::endl;
} else {
    std::cout &lt;&lt; "Key 5 does not exist." &lt;&lt; std::endl;
}
</code></pre>
<h4 id="inserting-elements"><a class="header" href="#inserting-elements">Inserting Elements</a></h4>
<ul>
<li><code>insert()</code>: Inserts elements into the map.</li>
<li><code>emplace()</code>: Constructs elements in-place.</li>
</ul>
<pre><code class="language-cpp">// Using insert()
map.insert({1, "one"});
map.insert(std::pair&lt;int, std::string&gt;(2, "two"));

// Using emplace()
map.emplace(3, "three");
</code></pre>
<h4 id="deleting-elements"><a class="header" href="#deleting-elements">Deleting Elements</a></h4>
<ul>
<li><code>erase()</code>: Removes elements by key or iterator.</li>
<li><code>clear()</code>: Removes all elements from the map.</li>
</ul>
<pre><code class="language-cpp">std::map&lt;int, std::string&gt; map = { {1, "one"}, {2, "two"}, {3, "three"} };

// Erase by key
map.erase(2);

// Erase by iterator
auto itErase = map.find(3);
if(itErase != map.end()) {
    map.erase(itErase);
}

// Clear all elements
map.clear();
</code></pre>
<h4 id="iterating-through-a-map"><a class="header" href="#iterating-through-a-map">Iterating Through a Map</a></h4>
<pre><code class="language-cpp">std::map&lt;int, std::string&gt; map = { {1, "one"}, {2, "two"}, {3, "three"} };

// Using iterator
for(auto it = map.begin(); it != map.end(); ++it) {
    std::cout &lt;&lt; it-&gt;first &lt;&lt; ": " &lt;&lt; it-&gt;second &lt;&lt; std::endl;
}

// Using range-based for loop
for(const auto&amp; pair : map) {
    std::cout &lt;&lt; pair.first &lt;&lt; ": " &lt;&lt; pair.second &lt;&lt; std::endl;
}
</code></pre>
<p>Understanding and utilizing <code>std::map</code> and its various methods can greatly enhance your ability to manage key-value pairs efficiently in C++ applications.</p>
<h3 id="4-smart-pointers"><a class="header" href="#4-smart-pointers">4. <strong>Smart Pointers</strong></a></h3>
<p>Smart pointers in C++ are template classes provided by the Standard Library that facilitate automatic and exception-safe memory management. They help manage dynamically allocated objects by ensuring that resources are properly released when they are no longer needed, thus preventing memory leaks and other related issues. C++ offers several types of smart pointers, each tailored to specific use cases and ownership semantics.</p>
<h4 id="types-of-smart-pointers"><a class="header" href="#types-of-smart-pointers">Types of Smart Pointers</a></h4>
<ol>
<li><strong><code>std::unique_ptr</code></strong></li>
<li><strong><code>std::shared_ptr</code></strong></li>
<li><strong><code>std::weak_ptr</code></strong></li>
</ol>
<hr />
<h4 id="1-stdunique_ptr"><a class="header" href="#1-stdunique_ptr">1. <code>std::unique_ptr</code></a></h4>
<p><code>std::unique_ptr</code> is a smart pointer that owns and manages another object through a pointer and disposes of that object when the <code>unique_ptr</code> goes out of scope. It ensures exclusive ownership, meaning that there can be only one <code>unique_ptr</code> instance owning a particular object at any given time.</p>
<p><strong>Key Characteristics:</strong></p>
<ul>
<li><strong>Exclusive Ownership:</strong> Only one <code>std::unique_ptr</code> can own the object at a time.</li>
<li><strong>No Copying:</strong> <code>unique_ptr</code> cannot be copied to prevent multiple ownerships. However, it can be moved.</li>
<li><strong>Lightweight:</strong> Minimal overhead compared to raw pointers.</li>
</ul>
<p><strong>Usage Example:</strong></p>
<pre><code class="language-cpp">#include &lt;memory&gt;
#include &lt;iostream&gt;

int main() {
    // Creating a unique_ptr to an integer
    std::unique_ptr&lt;int&gt; ptr1(new int(10));
    std::cout &lt;&lt; "Value: " &lt;&lt; *ptr1 &lt;&lt; std::endl; // Output: Value: 10

    // Transferring ownership using std::move
    std::unique_ptr&lt;int&gt; ptr2 = std::move(ptr1);
    if (!ptr1) {
        std::cout &lt;&lt; "ptr1 is now null." &lt;&lt; std::endl;
    }
    std::cout &lt;&lt; "Value: " &lt;&lt; *ptr2 &lt;&lt; std::endl; // Output: Value: 10

    // Automatic deletion when ptr2 goes out of scope
    return 0;
}
</code></pre>
<p><strong>Common Methods:</strong></p>
<ul>
<li><strong><code>get()</code></strong>: Returns the raw pointer.</li>
<li><strong><code>release()</code></strong>: Releases ownership of the managed object and returns the pointer.</li>
<li><strong><code>reset()</code></strong>: Deletes the currently managed object and takes ownership of a new one.</li>
<li><strong><code>operator*</code> and <code>operator-&gt;</code></strong>: Dereference operators to access the managed object.</li>
</ul>
<hr />
<h4 id="2-stdshared_ptr"><a class="header" href="#2-stdshared_ptr">2. <code>std::shared_ptr</code></a></h4>
<p><code>std::shared_ptr</code> is a smart pointer that maintains shared ownership of an object through a pointer. Multiple <code>shared_ptr</code> instances can own the same object, and the object is destroyed only when the last <code>shared_ptr</code> owning it is destroyed or reset.</p>
<p><strong>Key Characteristics:</strong></p>
<ul>
<li><strong>Shared Ownership:</strong> Multiple <code>shared_ptr</code> instances can own the same object.</li>
<li><strong>Reference Counting:</strong> Keeps track of how many <code>shared_ptr</code> instances own the object.</li>
<li><strong>Thread-Safe Reference Counting:</strong> Safe to use in multi-threaded applications for reference counting operations.</li>
</ul>
<p><strong>Usage Example:</strong></p>
<pre><code class="language-cpp">#include &lt;memory&gt;
#include &lt;iostream&gt;

int main() {
    // Creating a shared_ptr to an integer
    std::shared_ptr&lt;int&gt; ptr1 = std::make_shared&lt;int&gt;(20);
    std::cout &lt;&lt; "Value: " &lt;&lt; *ptr1 &lt;&lt; ", Count: " &lt;&lt; ptr1.use_count() &lt;&lt; std::endl; // Output: Value: 20, Count: 1

    // Creating another shared_ptr sharing the same object
    std::shared_ptr&lt;int&gt; ptr2 = ptr1;
    std::cout &lt;&lt; "Value: " &lt;&lt; *ptr2 &lt;&lt; ", Count: " &lt;&lt; ptr1.use_count() &lt;&lt; std::endl; // Output: Value: 20, Count: 2

    // Resetting ptr1
    ptr1.reset();
    std::cout &lt;&lt; "ptr1 reset. Count: " &lt;&lt; ptr2.use_count() &lt;&lt; std::endl; // Output: Count: 1

    // Automatic deletion when ptr2 goes out of scope
    return 0;
}
</code></pre>
<p><strong>Common Methods:</strong></p>
<ul>
<li><strong><code>use_count()</code></strong>: Returns the number of <code>shared_ptr</code> instances sharing ownership.</li>
<li><strong><code>unique()</code></strong>: Checks if the <code>shared_ptr</code> is the only owner.</li>
<li><strong><code>reset()</code></strong>: Releases ownership of the managed object.</li>
<li><strong><code>swap()</code></strong>: Exchanges the managed object with another <code>shared_ptr</code>.</li>
</ul>
<hr />
<h4 id="3-stdweak_ptr"><a class="header" href="#3-stdweak_ptr">3. <code>std::weak_ptr</code></a></h4>
<p><code>std::weak_ptr</code> is a smart pointer that holds a non-owning ("weak") reference to an object that is managed by <code>std::shared_ptr</code>. It is used to prevent circular references that can lead to memory leaks by allowing one part of the code to observe an object without affecting its lifetime.</p>
<p><strong>Key Characteristics:</strong></p>
<ul>
<li><strong>Non-Owning:</strong> Does not contribute to the reference count.</li>
<li><strong>Avoids Circular References:</strong> Useful in scenarios like bidirectional relationships.</li>
<li><strong>Access Controlled:</strong> Must be converted to <code>std::shared_ptr</code> to access the managed object.</li>
</ul>
<p><strong>Usage Example:</strong></p>
<pre><code class="language-cpp">#include &lt;memory&gt;
#include &lt;iostream&gt;

struct Node {
    int value;
    std::shared_ptr&lt;Node&gt; next;
    std::weak_ptr&lt;Node&gt; prev; // Using weak_ptr to prevent circular reference

    Node(int val) : value(val), next(nullptr), prev() {}
};

int main() {
    auto node1 = std::make_shared&lt;Node&gt;(1);
    auto node2 = std::make_shared&lt;Node&gt;(2);

    node1-&gt;next = node2;
    node2-&gt;prev = node1; // weak_ptr does not increase reference count

    std::cout &lt;&lt; "Node1 value: " &lt;&lt; node1-&gt;value &lt;&lt; std::endl;
    std::cout &lt;&lt; "Node2 value: " &lt;&lt; node2-&gt;value &lt;&lt; std::endl;

    // Accessing the previous node
    if(auto prev = node2-&gt;prev.lock()) {
        std::cout &lt;&lt; "Node2's previous node value: " &lt;&lt; prev-&gt;value &lt;&lt; std::endl;
    } else {
        std::cout &lt;&lt; "Previous node no longer exists." &lt;&lt; std::endl;
    }

    return 0;
}
</code></pre>
<p><strong>Common Methods:</strong></p>
<ul>
<li><strong><code>lock()</code></strong>: Attempts to acquire a <code>std::shared_ptr</code> to the managed object.</li>
<li><strong><code>expired()</code></strong>: Checks if the managed object has been deleted.</li>
<li><strong><code>reset()</code></strong>: Releases the managed object reference.</li>
</ul>
<hr />
<h4 id="common-methods-across-smart-pointers"><a class="header" href="#common-methods-across-smart-pointers">Common Methods Across Smart Pointers</a></h4>
<p>While each smart pointer type has its specific methods, there are several common methods that they share:</p>
<ul>
<li>
<p><strong><code>get()</code></strong>: Returns the raw pointer managed by the smart pointer.</p>
<pre><code class="language-cpp">std::unique_ptr&lt;int&gt; ptr = std::make_unique&lt;int&gt;(100);
int* rawPtr = ptr.get();
std::cout &lt;&lt; "Raw pointer value: " &lt;&lt; *rawPtr &lt;&lt; std::endl; // Output: 100
</code></pre>
</li>
<li>
<p><strong><code>reset()</code></strong>: Releases the ownership of the managed object and optionally takes ownership of a new object.</p>
<pre><code class="language-cpp">std::shared_ptr&lt;int&gt; ptr = std::make_shared&lt;int&gt;(200);
ptr.reset(new int(300)); // Old object is deleted, ptr now owns the new object
std::cout &lt;&lt; "New value: " &lt;&lt; *ptr &lt;&lt; std::endl; // Output: 300
</code></pre>
</li>
<li>
<p><strong><code>swap()</code></strong>: Exchanges the managed objects of two smart pointers.</p>
<pre><code class="language-cpp">std::unique_ptr&lt;int&gt; ptr1 = std::make_unique&lt;int&gt;(400);
std::unique_ptr&lt;int&gt; ptr2 = std::make_unique&lt;int&gt;(500);
ptr1.swap(ptr2);
std::cout &lt;&lt; "ptr1: " &lt;&lt; *ptr1 &lt;&lt; ", ptr2: " &lt;&lt; *ptr2 &lt;&lt; std::endl; // Output: ptr1: 500, ptr2: 400
</code></pre>
</li>
<li>
<p><strong>Dereference Operators (<code>*</code> and <code>-&gt;</code>)</strong>: Access the managed object.</p>
<pre><code class="language-cpp">std::shared_ptr&lt;std::string&gt; ptr = std::make_shared&lt;std::string&gt;("Hello");
std::cout &lt;&lt; "String: " &lt;&lt; *ptr &lt;&lt; std::endl; // Output: Hello
std::cout &lt;&lt; "String length: " &lt;&lt; ptr-&gt;length() &lt;&lt; std::endl; // Output: 5
</code></pre>
</li>
</ul>
<hr />
<h4 id="best-practices-4"><a class="header" href="#best-practices-4">Best Practices</a></h4>
<ul>
<li>
<p><strong>Prefer <code>std::make_unique</code> and <code>std::make_shared</code>:</strong> These functions are exception-safe and more efficient.</p>
<pre><code class="language-cpp">auto ptr = std::make_unique&lt;MyClass&gt;();
auto sharedPtr = std::make_shared&lt;MyClass&gt;();
</code></pre>
</li>
<li>
<p><strong>Use <code>std::unique_ptr</code> When Ownership is Exclusive:</strong> It clearly signifies ownership semantics and incurs no overhead of reference counting.</p>
<pre><code class="language-cpp">std::unique_ptr&lt;Resource&gt; resource = std::make_unique&lt;Resource&gt;();
</code></pre>
</li>
<li>
<p><strong>Use <code>std::shared_ptr</code> When Ownership is Shared:</strong> Useful in scenarios where multiple parts of the program need to share access to the same resource.</p>
<pre><code class="language-cpp">std::shared_ptr&lt;Logger&gt; logger1 = std::make_shared&lt;Logger&gt;();
std::shared_ptr&lt;Logger&gt; logger2 = logger1;
</code></pre>
</li>
<li>
<p><strong>Avoid <code>std::shared_ptr</code> Unless Necessary:</strong> It introduces overhead due to reference counting. Use it only when shared ownership is required.</p>
</li>
<li>
<p><strong>Break Circular References with <code>std::weak_ptr</code>:</strong> When two objects share ownership via <code>std::shared_ptr</code>, use <code>std::weak_ptr</code> to prevent memory leaks.</p>
<pre><code class="language-cpp">struct A {
    std::shared_ptr&lt;B&gt; b_ptr;
};

struct B {
    std::weak_ptr&lt;A&gt; a_ptr; // weak_ptr breaks the circular reference
};
</code></pre>
</li>
</ul>
<hr />
<p>Understanding and effectively utilizing smart pointers is crucial for modern C++ programming. They not only simplify memory management but also enhance the safety and performance of applications by preventing common issues related to dynamic memory allocation.</p>
<h3 id="5-stdfunction-and-stdbind"><a class="header" href="#5-stdfunction-and-stdbind">5. <strong><code>std::function</code> and <code>std::bind</code></strong></a></h3>
<p><code>std::function</code> and <code>std::bind</code> are powerful utilities in the C++ Standard Library that facilitate higher-order programming by allowing functions to be treated as first-class objects. They enable the storage, modification, and invocation of functions in a flexible and generic manner, enhancing the capabilities of callback mechanisms, event handling, and functional programming paradigms in C++.</p>
<h4 id="stdfunction"><a class="header" href="#stdfunction"><code>std::function</code></a></h4>
<p><code>std::function</code> is a versatile, type-erased function wrapper that can store any callable target—such as free functions, member functions, lambda expressions, or other function objects—provided they match a specific function signature. This flexibility makes it an essential tool for designing callback interfaces and managing dynamic function invocation.</p>
<p><strong>Key Characteristics:</strong></p>
<ul>
<li><strong>Type-Erasure:</strong> Abstracts away the specific type of the callable, allowing different types of callable objects to be stored in the same <code>std::function</code> variable.</li>
<li><strong>Copyable and Assignable:</strong> <code>std::function</code> instances can be copied and assigned, enabling their use in standard containers and algorithms.</li>
<li><strong>Invoke Any Callable:</strong> Can represent free functions, member functions, lambda expressions, and function objects.</li>
</ul>
<p><strong>Basic Usage Example:</strong></p>
<pre><code class="language-cpp">#include &lt;functional&gt;
#include &lt;iostream&gt;

// A free function
int add(int a, int b) {
    return a + b;
}

int main() {
    // Storing a free function in std::function
    std::function&lt;int(int, int)&gt; func = add;
    std::cout &lt;&lt; "add(2, 3) = " &lt;&lt; func(2, 3) &lt;&lt; std::endl; // Output: 5

    // Storing a lambda expression
    std::function&lt;int(int, int)&gt; lambdaFunc = [](int a, int b) -&gt; int {
        return a * b;
    };
    std::cout &lt;&lt; "lambdaFunc(2, 3) = " &lt;&lt; lambdaFunc(2, 3) &lt;&lt; std::endl; // Output: 6

    // Storing a member function (requires binding)
    struct Calculator {
        int subtract(int a, int b) const {
            return a - b;
        }
    };

    Calculator calc;
    std::function&lt;int(int, int)&gt; memberFunc = std::bind(&amp;Calculator::subtract, &amp;calc, std::placeholders::_1, std::placeholders::_2);
    std::cout &lt;&lt; "calc.subtract(5, 3) = " &lt;&lt; memberFunc(5, 3) &lt;&lt; std::endl; // Output: 2

    return 0;
}
</code></pre>
<p><strong>Common Methods:</strong></p>
<ul>
<li><strong><code>operator()</code></strong>: Invokes the stored callable.</li>
<li><strong><code>target()</code></strong>: Retrieves a pointer to the stored callable if it matches a specific type.</li>
<li><strong><code>reset()</code></strong>: Clears the stored callable, making the <code>std::function</code> empty.</li>
</ul>
<h4 id="stdbind"><a class="header" href="#stdbind"><code>std::bind</code></a></h4>
<p><code>std::bind</code> is a utility that allows you to create a new function object by binding some or all of the arguments of an existing function to specific values. This is particularly useful for adapting functions to match desired interfaces or for creating callbacks with pre-specified arguments.</p>
<p><strong>Key Characteristics:</strong></p>
<ul>
<li><strong>Argument Binding:</strong> Fixes certain arguments of a function, producing a new function object with fewer parameters.</li>
<li><strong>Placeholders:</strong> Uses placeholders like <code>std::placeholders::_1</code> to indicate arguments that will be provided later.</li>
<li><strong>Supports Various Callables:</strong> Can bind free functions, member functions, and function objects.</li>
</ul>
<p><strong>Basic Usage Example:</strong></p>
<pre><code class="language-cpp">#include &lt;functional&gt;
#include &lt;iostream&gt;

// A free function
int multiply(int a, int b) {
    return a * b;
}

struct Calculator {
    int divide(int a, int b) const {
        if(b == 0) throw std::invalid_argument("Division by zero");
        return a / b;
    }
};

int main() {
    // Binding the first argument of multiply to 5
    auto timesFive = std::bind(multiply, 5, std::placeholders::_1);
    std::cout &lt;&lt; "multiply(5, 4) = " &lt;&lt; timesFive(4) &lt;&lt; std::endl; // Output: 20

    // Binding a member function with the object instance
    Calculator calc;
    auto divideBy = std::bind(&amp;Calculator::divide, &amp;calc, std::placeholders::_1, 2);
    std::cout &lt;&lt; "calc.divide(10, 2) = " &lt;&lt; divideBy(10) &lt;&lt; std::endl; // Output: 5

    return 0;
}
</code></pre>
<p><strong>Common Use Cases:</strong></p>
<ul>
<li><strong>Creating Callbacks:</strong> Adapting functions to match callback interfaces that require a specific signature.</li>
<li><strong>Event Handling:</strong> Binding member functions of objects to event handlers with predefined arguments.</li>
<li><strong>Functional Programming:</strong> Enabling partial application and currying of functions for more functional-style code.</li>
</ul>
<p><strong>Advanced Usage Example:</strong></p>
<pre><code class="language-cpp">#include &lt;functional&gt;
#include &lt;iostream&gt;
#include &lt;vector&gt;

class Logger {
public:
    void log(const std::string&amp; message, int level) const {
        std::cout &lt;&lt; "Level " &lt;&lt; level &lt;&lt; ": " &lt;&lt; message &lt;&lt; std::endl;
    }
};

int main() {
    Logger logger;

    // Binding the logger object and log level to create a simplified log function
    auto infoLog = std::bind(&amp;Logger::log, &amp;logger, std::placeholders::_1, 1);
    auto errorLog = std::bind(&amp;Logger::log, &amp;logger, std::placeholders::_1, 3);

    infoLog("This is an informational message."); // Output: Level 1: This is an informational message.
    errorLog("This is an error message."); // Output: Level 3: This is an error message.

    // Storing bind expressions in a std::vector of std::function
    std::vector&lt;std::function&lt;void(const std::string&amp;)&gt;&gt; logs;
    logs.push_back(infoLog);
    logs.push_back(errorLog);

    for(auto&amp; logFunc : logs) {
        logFunc("Logging through stored function.");
    }
    // Output:
    // Level 1: Logging through stored function.
    // Level 3: Logging through stored function.

    return 0;
}
</code></pre>
<p><strong>Best Practices:</strong></p>
<ul>
<li>
<p><strong>Prefer Lambda Expressions Over <code>std::bind</code>:</strong> Lambdas often provide clearer and more readable syntax compared to <code>std::bind</code>.</p>
<pre><code class="language-cpp">// Using std::bind
auto timesFive = std::bind(multiply, 5, std::placeholders::_1);

// Equivalent using a lambda
auto timesFiveLambda = [](int a) -&gt; int {
    return multiply(5, a);
};
</code></pre>
</li>
<li>
<p><strong>Use <code>std::function</code> for Flexibility:</strong> When storing or passing callable objects that may vary in type, use <code>std::function</code> to accommodate different callables.</p>
</li>
<li>
<p><strong>Avoid Unnecessary Bindings:</strong> Excessive use of <code>std::bind</code> can lead to less readable code. Assess whether a lambda or a direct function call may be more appropriate.</p>
</li>
</ul>
<p>By leveraging <code>std::function</code> and <code>std::bind</code>, developers can create more abstract, flexible, and reusable code components, facilitating sophisticated callback mechanisms and enhancing the expressive power of C++.</p>
<h2 id="c-in-competitive-programming"><a class="header" href="#c-in-competitive-programming">C++ in Competitive Programming</a></h2>
<p>Competitive programming demands not only a deep understanding of algorithms and data structures but also the ability to implement them efficiently within strict time and memory constraints. C++ is a favored language in this arena due to its performance, rich Standard Template Library (STL), and powerful language features. Below are various methods and techniques in C++ that are extensively used in competitive programming:</p>
<h3 id="1-fast-inputoutput"><a class="header" href="#1-fast-inputoutput">1. <strong>Fast Input/Output</strong></a></h3>
<p>Efficient handling of input and output can significantly reduce execution time, especially with large datasets.</p>
<ul>
<li>
<p><strong>Untie C++ Streams from C Streams:</strong></p>
<pre><code class="language-cpp">std::ios::sync_with_stdio(false);
std::cin.tie(nullptr);
</code></pre>
<p>Disabling the synchronization between C and C++ standard streams and untieing <code>cin</code> from <code>cout</code> can speed up I/O operations.</p>
</li>
<li>
<p><strong>Use of <code>scanf</code> and <code>printf</code>:</strong>
For even faster I/O, some competitors prefer using C-style I/O functions.</p>
</li>
</ul>
<h3 id="2-utilizing-the-standard-template-library-stl"><a class="header" href="#2-utilizing-the-standard-template-library-stl">2. <strong>Utilizing the Standard Template Library (STL)</strong></a></h3>
<p>The STL provides a suite of ready-to-use data structures and algorithms that can save time and reduce the likelihood of bugs.</p>
<ul>
<li>
<p><strong>Vectors (<code>std::vector</code>):</strong>
Dynamic arrays that allow for efficient random access and dynamic resizing.</p>
<pre><code class="language-cpp">std::vector&lt;int&gt; vec = {1, 2, 3};
vec.push_back(4);
</code></pre>
</li>
<li>
<p><strong>Pairs and Tuples (<code>std::pair</code>, <code>std::tuple</code>):</strong>
Useful for storing multiple related values.</p>
<pre><code class="language-cpp">std::pair&lt;int, int&gt; p = {1, 2};
std::tuple&lt;int, int, int&gt; t = {1, 2, 3};
</code></pre>
</li>
<li>
<p><strong>Sets and Maps (<code>std::set</code>, <code>std::map</code>):</strong>
Efficiently handle unique elements and key-value associations.</p>
</li>
<li>
<p><strong>Algorithms (<code>std::sort</code>, <code>std::binary_search</code>, etc.):</strong>
Implement common algorithms with optimized performance.</p>
</li>
</ul>
<h3 id="3-graph-representations-and-algorithms"><a class="header" href="#3-graph-representations-and-algorithms">3. <strong>Graph Representations and Algorithms</strong></a></h3>
<p>Graphs are a staple in competitive programming problems. Efficient representation and traversal are crucial.</p>
<ul>
<li>
<p><strong>Adjacency List:</strong></p>
<pre><code class="language-cpp">int n; // Number of nodes
std::vector&lt;std::vector&lt;int&gt;&gt; adj(n + 1);
adj[u].push_back(v);
adj[v].push_back(u); // For undirected graphs
</code></pre>
</li>
<li>
<p><strong>Depth-First Search (DFS) and Breadth-First Search (BFS):</strong>
Fundamental traversal techniques.</p>
</li>
<li>
<p><strong>Dijkstra's and Floyd-Warshall Algorithms:</strong>
For shortest path problems.</p>
</li>
</ul>
<h3 id="4-dynamic-programming-dp"><a class="header" href="#4-dynamic-programming-dp">4. <strong>Dynamic Programming (DP)</strong></a></h3>
<p>DP is essential for solving optimization problems by breaking them down into simpler subproblems.</p>
<ul>
<li>
<p><strong>Memoization and Tabulation:</strong></p>
<pre><code class="language-cpp">// Example of Fibonacci using memoization
long long fib(int n, std::vector&lt;long long&gt; &amp;dp) {
    if(n &lt;= 1) return n;
    if(dp[n] != -1) return dp[n];
    return dp[n] = fib(n-1, dp) + fib(n-2, dp);
}
</code></pre>
</li>
<li>
<p><strong>State Optimization:</strong>
Reducing space complexity by optimizing states.</p>
</li>
</ul>
<h3 id="5-greedy-algorithms"><a class="header" href="#5-greedy-algorithms">5. <strong>Greedy Algorithms</strong></a></h3>
<p>These algorithms make the locally optimal choice at each step with the hope of finding the global optimum.</p>
<ul>
<li>
<p><strong>Interval Scheduling:</strong>
Selecting the maximum number of non-overlapping intervals.</p>
</li>
<li>
<p><strong>Huffman Coding:</strong>
For efficient encoding.</p>
</li>
</ul>
<h3 id="6-bit-manipulation"><a class="header" href="#6-bit-manipulation">6. <strong>Bit Manipulation</strong></a></h3>
<p>Bitwise operations can optimize certain calculations and are useful in problems involving subsets or binary representations.</p>
<ul>
<li>
<p><strong>Common Operations:</strong></p>
<ul>
<li>Setting a bit: <code>x | (1 &lt;&lt; pos)</code></li>
<li>Clearing a bit: <code>x &amp; ~(1 &lt;&lt; pos)</code></li>
<li>Toggling a bit: <code>x ^ (1 &lt;&lt; pos)</code></li>
</ul>
</li>
<li>
<p><strong>Bitmask DP:</strong>
Using bitmasks to represent states in DP.</p>
</li>
</ul>
<h3 id="7-number-theory"><a class="header" href="#7-number-theory">7. <strong>Number Theory</strong></a></h3>
<p>Many problems involve mathematical concepts such as primes, GCD, and modular arithmetic.</p>
<ul>
<li>
<p><strong>Sieve of Eratosthenes:</strong>
For finding all prime numbers up to a certain limit.</p>
<pre><code class="language-cpp">std::vector&lt;bool&gt; is_prime(n+1, true);
is_prime[0] = is_prime[1] = false;
for(int i=2; i*i &lt;= n; ++i){
    if(is_prime[i]){
        for(int j=i*i; j&lt;=n; j+=i){
            is_prime[j] = false;
        }
    }
}
</code></pre>
</li>
<li>
<p><strong>Modular Exponentiation:</strong>
Efficiently computing large exponents under a modulus.</p>
<pre><code class="language-cpp">long long power(long long a, long long b, long long mod){
    long long res = 1;
    a %= mod;
    while(b &gt; 0){
        if(b &amp; 1) res = res * a % mod;
        a = a * a % mod;
        b &gt;&gt;= 1;
    }
    return res;
}
</code></pre>
</li>
</ul>
<h3 id="8-string-algorithms"><a class="header" href="#8-string-algorithms">8. <strong>String Algorithms</strong></a></h3>
<p>Handling and processing strings efficiently is vital in many problems.</p>
<ul>
<li>
<p><strong>KMP Algorithm:</strong>
For pattern matching with linear time complexity.</p>
</li>
<li>
<p><strong>Trie Data Structure:</strong>
Efficiently storing and searching a dynamic set of strings.</p>
</li>
</ul>
<h3 id="9-data-structures"><a class="header" href="#9-data-structures">9. <strong>Data Structures</strong></a></h3>
<p>Choosing the right data structure can make or break your solution.</p>
<ul>
<li>
<p><strong>Segment Trees and Binary Indexed Trees (Fenwick Trees):</strong>
For range queries and updates.</p>
</li>
<li>
<p><strong>Disjoint Set Union (DSU):</strong>
For efficiently handling union and find operations.</p>
<pre><code class="language-cpp">struct DSU {
    std::vector&lt;int&gt; parent;
    DSU(int n) : parent(n+1) { for(int i=0;i&lt;=n;i++) parent[i] = i; }
    int find_set(int x) { return parent[x] == x ? x : parent[x] = find_set(parent[x]); }
    void union_set(int x, int y) { parent[find_set(x)] = find_set(y); }
};
</code></pre>
</li>
<li>
<p><strong>Heaps (<code>std::priority_queue</code>):</strong>
Useful for efficiently retrieving the maximum or minimum element.</p>
</li>
</ul>
<h3 id="10-advanced-techniques"><a class="header" href="#10-advanced-techniques">10. <strong>Advanced Techniques</strong></a></h3>
<ul>
<li>
<p><strong>Meet in the Middle:</strong>
Breaking problems into two halves to reduce time complexity.</p>
</li>
<li>
<p><strong>Bitmasking and Enumeration:</strong>
Enumerating all subsets or combinations efficiently.</p>
</li>
</ul>
<h3 id="best-practices-5"><a class="header" href="#best-practices-5"><strong>Best Practices</strong></a></h3>
<ul>
<li>
<p><strong>Understand the Problem Thoroughly:</strong>
Carefully read and comprehend the problem constraints and requirements before jumping into coding.</p>
</li>
<li>
<p><strong>Practice Code Implementation:</strong>
Regularly practice implementing various algorithms and data structures to build speed and accuracy.</p>
</li>
<li>
<p><strong>Optimize and Test:</strong>
Continuously look for optimizations and thoroughly test your code against different cases to ensure correctness.</p>
</li>
<li>
<p><strong>Stay Updated:</strong>
Keep abreast of new algorithms and techniques emerging in the competitive programming community.</p>
</li>
</ul>
<p>By mastering these methods and leveraging C++'s powerful features, competitive programmers can efficiently tackle a wide array of challenging problems and excel in contests.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="javascript-programming"><a class="header" href="#javascript-programming">JavaScript Programming</a></h1>
<h2 id="overview-4"><a class="header" href="#overview-4">Overview</a></h2>
<p>JavaScript is a high-level, interpreted programming language primarily used for web development. It enables interactive web pages and is an essential part of web applications alongside HTML and CSS.</p>
<p><strong>Key Features:</strong></p>
<ul>
<li>Event-driven, functional, and imperative programming styles</li>
<li>Dynamic typing</li>
<li>Prototype-based object-orientation</li>
<li>First-class functions</li>
<li>Runs in browsers and on servers (Node.js)</li>
<li>Asynchronous programming with Promises and async/await</li>
</ul>
<hr />
<h2 id="basic-syntax-2"><a class="header" href="#basic-syntax-2">Basic Syntax</a></h2>
<h3 id="variables"><a class="header" href="#variables">Variables</a></h3>
<pre><code class="language-javascript">// var (function-scoped, avoid in modern code)
var x = 10;

// let (block-scoped, can be reassigned)
let y = 20;
y = 30;  // OK

// const (block-scoped, cannot be reassigned)
const z = 40;
// z = 50;  // ERROR!

// But const objects can be modified
const obj = { name: "Alice" };
obj.name = "Bob";  // OK
obj.age = 30;      // OK
</code></pre>
<h3 id="data-types-1"><a class="header" href="#data-types-1">Data Types</a></h3>
<pre><code class="language-javascript">// Primitives
let num = 42;                    // Number
let str = "Hello";               // String
let bool = true;                 // Boolean
let undef = undefined;           // Undefined
let nul = null;                  // Null
let sym = Symbol("id");          // Symbol (ES6)
let bigInt = 123n;               // BigInt (ES2020)

// Objects
let obj = { name: "Alice" };
let arr = [1, 2, 3];
let func = function() {};

// Type checking
typeof num;      // "number"
typeof str;      // "string"
typeof obj;      // "object"
typeof arr;      // "object" (arrays are objects)
Array.isArray(arr);  // true

// Type conversion
String(42);      // "42"
Number("42");    // 42
parseInt("42");  // 42
parseFloat("3.14");  // 3.14
Boolean(0);      // false
Boolean(1);      // true
</code></pre>
<h3 id="template-literals-es6"><a class="header" href="#template-literals-es6">Template Literals (ES6)</a></h3>
<pre><code class="language-javascript">const name = "Alice";
const age = 30;

// Template literals
const message = `Hello, ${name}! You are ${age} years old.`;

// Multi-line strings
const multiline = `
  This is a
  multi-line
  string
`;

// Tagged templates
function highlight(strings, ...values) {
  return strings.reduce((acc, str, i) =&gt; {
    return acc + str + (values[i] ? `&lt;strong&gt;${values[i]}&lt;/strong&gt;` : '');
  }, '');
}

const result = highlight`Name: ${name}, Age: ${age}`;
</code></pre>
<hr />
<h2 id="arrays-1"><a class="header" href="#arrays-1">Arrays</a></h2>
<pre><code class="language-javascript">// Creating arrays
const arr = [1, 2, 3, 4, 5];
const mixed = [1, "hello", true, null, { name: "Alice" }];
const empty = [];

// Accessing elements
const first = arr[0];        // 1
const last = arr[arr.length - 1];  // 5

// Common methods
arr.push(6);                 // Add to end: [1, 2, 3, 4, 5, 6]
arr.pop();                   // Remove from end: 6
arr.unshift(0);              // Add to start: [0, 1, 2, 3, 4, 5]
arr.shift();                 // Remove from start: 0
arr.splice(2, 1);            // Remove 1 element at index 2
arr.slice(1, 3);             // Extract [2, 3]

// Iteration methods
arr.forEach((item, index) =&gt; {
  console.log(index, item);
});

// Map (transform array)
const squares = arr.map(x =&gt; x * x);

// Filter (select elements)
const evens = arr.filter(x =&gt; x % 2 === 0);

// Reduce (aggregate)
const sum = arr.reduce((acc, val) =&gt; acc + val, 0);

// Find
const found = arr.find(x =&gt; x &gt; 3);      // First element &gt; 3
const foundIndex = arr.findIndex(x =&gt; x &gt; 3);

// Some and Every
const hasEven = arr.some(x =&gt; x % 2 === 0);     // true if any even
const allEven = arr.every(x =&gt; x % 2 === 0);    // true if all even

// Sorting
arr.sort((a, b) =&gt; a - b);   // Ascending
arr.sort((a, b) =&gt; b - a);   // Descending

// Spread operator
const arr1 = [1, 2, 3];
const arr2 = [4, 5, 6];
const combined = [...arr1, ...arr2];  // [1, 2, 3, 4, 5, 6]

// Destructuring
const [first, second, ...rest] = [1, 2, 3, 4, 5];
// first = 1, second = 2, rest = [3, 4, 5]
</code></pre>
<hr />
<h2 id="objects"><a class="header" href="#objects">Objects</a></h2>
<pre><code class="language-javascript">// Creating objects
const person = {
  name: "Alice",
  age: 30,
  greet() {
    return `Hello, I'm ${this.name}`;
  }
};

// Accessing properties
person.name;           // "Alice"
person["age"];         // 30

// Adding/modifying properties
person.email = "alice@example.com";
person.age = 31;

// Deleting properties
delete person.email;

// Object methods
Object.keys(person);       // ["name", "age", "greet"]
Object.values(person);     // ["Alice", 31, function]
Object.entries(person);    // [["name", "Alice"], ["age", 31], ...]

// Spread operator
const person2 = { ...person, city: "NYC" };

// Destructuring
const { name, age } = person;
const { name: personName, age: personAge } = person;  // Rename

// Computed property names
const key = "dynamicKey";
const obj = {
  [key]: "value"
};

// Object shorthand (ES6)
const name = "Bob";
const age = 25;
const user = { name, age };  // Same as { name: name, age: age }

// Object.assign (merge objects)
const merged = Object.assign({}, person, { city: "NYC" });

// Freeze object (immutable)
Object.freeze(person);
</code></pre>
<hr />
<h2 id="functions-2"><a class="header" href="#functions-2">Functions</a></h2>
<h3 id="function-declaration"><a class="header" href="#function-declaration">Function Declaration</a></h3>
<pre><code class="language-javascript">// Traditional function
function greet(name) {
  return `Hello, ${name}!`;
}

// Function with default parameters
function greet(name = "World") {
  return `Hello, ${name}!`;
}

// Rest parameters
function sum(...numbers) {
  return numbers.reduce((acc, val) =&gt; acc + val, 0);
}

sum(1, 2, 3, 4, 5);  // 15
</code></pre>
<h3 id="function-expressions"><a class="header" href="#function-expressions">Function Expressions</a></h3>
<pre><code class="language-javascript">// Anonymous function
const greet = function(name) {
  return `Hello, ${name}!`;
};

// Named function expression
const factorial = function fact(n) {
  return n &lt;= 1 ? 1 : n * fact(n - 1);
};
</code></pre>
<h3 id="arrow-functions-es6"><a class="header" href="#arrow-functions-es6">Arrow Functions (ES6)</a></h3>
<pre><code class="language-javascript">// Basic arrow function
const greet = (name) =&gt; {
  return `Hello, ${name}!`;
};

// Implicit return (single expression)
const greet = name =&gt; `Hello, ${name}!`;

// No parameters
const sayHello = () =&gt; "Hello!";

// Multiple parameters
const add = (a, b) =&gt; a + b;

// Arrow functions and 'this'
const person = {
  name: "Alice",
  greet: function() {
    setTimeout(() =&gt; {
      console.log(`Hello, ${this.name}`);  // 'this' refers to person
    }, 1000);
  }
};
</code></pre>
<h3 id="higher-order-functions"><a class="header" href="#higher-order-functions">Higher-Order Functions</a></h3>
<pre><code class="language-javascript">// Function that returns a function
function multiplier(factor) {
  return function(number) {
    return number * factor;
  };
}

const double = multiplier(2);
console.log(double(5));  // 10

// Function that takes a function as argument
function applyOperation(arr, operation) {
  return arr.map(operation);
}

const numbers = [1, 2, 3, 4, 5];
const squared = applyOperation(numbers, x =&gt; x * x);
</code></pre>
<h3 id="closures"><a class="header" href="#closures">Closures</a></h3>
<pre><code class="language-javascript">function createCounter() {
  let count = 0;
  return {
    increment() {
      return ++count;
    },
    decrement() {
      return --count;
    },
    getCount() {
      return count;
    }
  };
}

const counter = createCounter();
counter.increment();  // 1
counter.increment();  // 2
counter.getCount();   // 2
</code></pre>
<hr />
<h2 id="asynchronous-javascript"><a class="header" href="#asynchronous-javascript">Asynchronous JavaScript</a></h2>
<h3 id="callbacks"><a class="header" href="#callbacks">Callbacks</a></h3>
<pre><code class="language-javascript">// Traditional callback pattern
function fetchData(callback) {
  setTimeout(() =&gt; {
    callback("Data loaded");
  }, 1000);
}

fetchData((data) =&gt; {
  console.log(data);
});

// Callback hell (pyramid of doom)
getData1((data1) =&gt; {
  getData2(data1, (data2) =&gt; {
    getData3(data2, (data3) =&gt; {
      console.log(data3);
    });
  });
});
</code></pre>
<h3 id="promises"><a class="header" href="#promises">Promises</a></h3>
<pre><code class="language-javascript">// Creating a promise
const promise = new Promise((resolve, reject) =&gt; {
  setTimeout(() =&gt; {
    const success = true;
    if (success) {
      resolve("Data loaded");
    } else {
      reject("Error occurred");
    }
  }, 1000);
});

// Consuming a promise
promise
  .then(data =&gt; {
    console.log(data);
    return "Next data";
  })
  .then(nextData =&gt; {
    console.log(nextData);
  })
  .catch(error =&gt; {
    console.error(error);
  })
  .finally(() =&gt; {
    console.log("Cleanup");
  });

// Promise chaining
fetch('https://api.example.com/data')
  .then(response =&gt; response.json())
  .then(data =&gt; console.log(data))
  .catch(error =&gt; console.error(error));

// Promise.all (wait for all promises)
Promise.all([promise1, promise2, promise3])
  .then(([result1, result2, result3]) =&gt; {
    console.log(result1, result2, result3);
  });

// Promise.race (first to complete)
Promise.race([promise1, promise2])
  .then(result =&gt; console.log(result));

// Promise.allSettled (wait for all, regardless of result)
Promise.allSettled([promise1, promise2])
  .then(results =&gt; console.log(results));
</code></pre>
<h3 id="asyncawait-es2017"><a class="header" href="#asyncawait-es2017">Async/Await (ES2017)</a></h3>
<pre><code class="language-javascript">// Async function
async function fetchData() {
  try {
    const response = await fetch('https://api.example.com/data');
    const data = await response.json();
    console.log(data);
    return data;
  } catch (error) {
    console.error('Error:', error);
  }
}

// Sequential execution
async function sequential() {
  const data1 = await fetchData1();
  const data2 = await fetchData2(data1);
  const data3 = await fetchData3(data2);
  return data3;
}

// Parallel execution
async function parallel() {
  const [data1, data2, data3] = await Promise.all([
    fetchData1(),
    fetchData2(),
    fetchData3()
  ]);
  return { data1, data2, data3 };
}

// Top-level await (ES2022)
const data = await fetchData();
</code></pre>
<hr />
<h2 id="classes-and-oop"><a class="header" href="#classes-and-oop">Classes and OOP</a></h2>
<h3 id="es6-classes"><a class="header" href="#es6-classes">ES6 Classes</a></h3>
<pre><code class="language-javascript">// Basic class
class Person {
  constructor(name, age) {
    this.name = name;
    this.age = age;
  }

  greet() {
    return `Hello, I'm ${this.name}`;
  }

  // Static method
  static species() {
    return "Homo sapiens";
  }

  // Getter
  get info() {
    return `${this.name}, ${this.age}`;
  }

  // Setter
  set info(value) {
    const [name, age] = value.split(', ');
    this.name = name;
    this.age = parseInt(age);
  }
}

const person = new Person("Alice", 30);
console.log(person.greet());
console.log(Person.species());
</code></pre>
<h3 id="inheritance-1"><a class="header" href="#inheritance-1">Inheritance</a></h3>
<pre><code class="language-javascript">class Animal {
  constructor(name) {
    this.name = name;
  }

  speak() {
    return `${this.name} makes a sound`;
  }
}

class Dog extends Animal {
  constructor(name, breed) {
    super(name);  // Call parent constructor
    this.breed = breed;
  }

  speak() {
    return `${this.name} barks`;
  }

  fetch() {
    return `${this.name} is fetching`;
  }
}

const dog = new Dog("Buddy", "Golden Retriever");
console.log(dog.speak());   // "Buddy barks"
console.log(dog.fetch());   // "Buddy is fetching"
</code></pre>
<h3 id="private-fields-es2022"><a class="header" href="#private-fields-es2022">Private Fields (ES2022)</a></h3>
<pre><code class="language-javascript">class BankAccount {
  #balance = 0;  // Private field

  deposit(amount) {
    this.#balance += amount;
  }

  withdraw(amount) {
    if (amount &lt;= this.#balance) {
      this.#balance -= amount;
      return amount;
    }
    return 0;
  }

  getBalance() {
    return this.#balance;
  }
}

const account = new BankAccount();
account.deposit(100);
console.log(account.getBalance());  // 100
// console.log(account.#balance);   // SyntaxError
</code></pre>
<hr />
<h2 id="common-patterns-2"><a class="header" href="#common-patterns-2">Common Patterns</a></h2>
<h3 id="module-pattern"><a class="header" href="#module-pattern">Module Pattern</a></h3>
<pre><code class="language-javascript">const MyModule = (function() {
  // Private variables
  let privateVar = "I'm private";

  // Private function
  function privateFunction() {
    return "Private function called";
  }

  // Public API
  return {
    publicVar: "I'm public",
    publicFunction() {
      return privateFunction();
    },
    getPrivateVar() {
      return privateVar;
    }
  };
})();

console.log(MyModule.publicVar);
console.log(MyModule.publicFunction());
</code></pre>
<h3 id="revealing-module-pattern"><a class="header" href="#revealing-module-pattern">Revealing Module Pattern</a></h3>
<pre><code class="language-javascript">const Calculator = (function() {
  let result = 0;

  function add(x) {
    result += x;
    return this;
  }

  function subtract(x) {
    result -= x;
    return this;
  }

  function getResult() {
    return result;
  }

  function reset() {
    result = 0;
    return this;
  }

  return {
    add,
    subtract,
    getResult,
    reset
  };
})();

Calculator.add(5).add(3).subtract(2);
console.log(Calculator.getResult());  // 6
</code></pre>
<h3 id="singleton-pattern-1"><a class="header" href="#singleton-pattern-1">Singleton Pattern</a></h3>
<pre><code class="language-javascript">const Singleton = (function() {
  let instance;

  function createInstance() {
    return {
      name: "Singleton",
      getData() {
        return "Data from singleton";
      }
    };
  }

  return {
    getInstance() {
      if (!instance) {
        instance = createInstance();
      }
      return instance;
    }
  };
})();

const instance1 = Singleton.getInstance();
const instance2 = Singleton.getInstance();
console.log(instance1 === instance2);  // true
</code></pre>
<h3 id="factory-pattern-1"><a class="header" href="#factory-pattern-1">Factory Pattern</a></h3>
<pre><code class="language-javascript">class Car {
  constructor(options) {
    this.doors = options.doors || 4;
    this.state = options.state || "brand new";
    this.color = options.color || "silver";
  }
}

class Truck {
  constructor(options) {
    this.wheels = options.wheels || 6;
    this.state = options.state || "used";
    this.color = options.color || "blue";
  }
}

class VehicleFactory {
  createVehicle(type, options) {
    switch(type) {
      case 'car':
        return new Car(options);
      case 'truck':
        return new Truck(options);
      default:
        throw new Error('Unknown vehicle type');
    }
  }
}

const factory = new VehicleFactory();
const car = factory.createVehicle('car', { color: 'red' });
const truck = factory.createVehicle('truck', { wheels: 8 });
</code></pre>
<h3 id="observer-pattern"><a class="header" href="#observer-pattern">Observer Pattern</a></h3>
<pre><code class="language-javascript">class Subject {
  constructor() {
    this.observers = [];
  }

  subscribe(observer) {
    this.observers.push(observer);
  }

  unsubscribe(observer) {
    this.observers = this.observers.filter(obs =&gt; obs !== observer);
  }

  notify(data) {
    this.observers.forEach(observer =&gt; observer.update(data));
  }
}

class Observer {
  constructor(name) {
    this.name = name;
  }

  update(data) {
    console.log(`${this.name} received: ${data}`);
  }
}

const subject = new Subject();
const observer1 = new Observer('Observer 1');
const observer2 = new Observer('Observer 2');

subject.subscribe(observer1);
subject.subscribe(observer2);
subject.notify('Event occurred!');
</code></pre>
<hr />
<h2 id="dom-manipulation"><a class="header" href="#dom-manipulation">DOM Manipulation</a></h2>
<pre><code class="language-javascript">// Selecting elements
const element = document.getElementById('myId');
const elements = document.getElementsByClassName('myClass');
const element = document.querySelector('.myClass');
const elements = document.querySelectorAll('.myClass');

// Creating elements
const div = document.createElement('div');
div.textContent = 'Hello World';
div.className = 'my-class';
div.id = 'my-id';

// Appending elements
document.body.appendChild(div);
parentElement.insertBefore(newElement, referenceElement);

// Modifying content
element.textContent = 'New text';
element.innerHTML = '&lt;strong&gt;Bold text&lt;/strong&gt;';

// Modifying attributes
element.setAttribute('data-id', '123');
element.getAttribute('data-id');
element.removeAttribute('data-id');

// Modifying styles
element.style.color = 'red';
element.style.fontSize = '20px';

// Adding/removing classes
element.classList.add('active');
element.classList.remove('inactive');
element.classList.toggle('visible');
element.classList.contains('active');

// Event listeners
element.addEventListener('click', (event) =&gt; {
  console.log('Element clicked!', event);
});

element.addEventListener('click', handleClick);
element.removeEventListener('click', handleClick);

// Event delegation
document.addEventListener('click', (event) =&gt; {
  if (event.target.matches('.my-button')) {
    console.log('Button clicked!');
  }
});

// Preventing default behavior
form.addEventListener('submit', (event) =&gt; {
  event.preventDefault();
  // Handle form submission
});
</code></pre>
<hr />
<h2 id="es6-features"><a class="header" href="#es6-features">ES6+ Features</a></h2>
<h3 id="destructuring"><a class="header" href="#destructuring">Destructuring</a></h3>
<pre><code class="language-javascript">// Array destructuring
const [a, b, c] = [1, 2, 3];
const [first, , third] = [1, 2, 3];
const [head, ...tail] = [1, 2, 3, 4, 5];

// Object destructuring
const { name, age } = { name: 'Alice', age: 30 };
const { name: personName } = { name: 'Alice' };  // Rename
const { name, age = 25 } = { name: 'Alice' };    // Default value

// Nested destructuring
const { address: { city, country } } = person;

// Function parameter destructuring
function greet({ name, age }) {
  return `Hello ${name}, you are ${age} years old`;
}
</code></pre>
<h3 id="spread-and-rest-operators"><a class="header" href="#spread-and-rest-operators">Spread and Rest Operators</a></h3>
<pre><code class="language-javascript">// Spread in arrays
const arr1 = [1, 2, 3];
const arr2 = [...arr1, 4, 5, 6];

// Spread in objects
const obj1 = { a: 1, b: 2 };
const obj2 = { ...obj1, c: 3 };

// Rest in function parameters
function sum(...numbers) {
  return numbers.reduce((acc, val) =&gt; acc + val, 0);
}

// Rest in destructuring
const [first, ...rest] = [1, 2, 3, 4, 5];
</code></pre>
<h3 id="optional-chaining-es2020"><a class="header" href="#optional-chaining-es2020">Optional Chaining (ES2020)</a></h3>
<pre><code class="language-javascript">const user = {
  name: 'Alice',
  address: {
    city: 'NYC'
  }
};

// Without optional chaining
const city = user &amp;&amp; user.address &amp;&amp; user.address.city;

// With optional chaining
const city = user?.address?.city;
const fn = obj?.method?.();  // Call method if exists
</code></pre>
<h3 id="nullish-coalescing-es2020"><a class="header" href="#nullish-coalescing-es2020">Nullish Coalescing (ES2020)</a></h3>
<pre><code class="language-javascript">// Returns right operand when left is null or undefined
const value = null ?? 'default';        // 'default'
const value = undefined ?? 'default';   // 'default'
const value = 0 ?? 'default';           // 0
const value = '' ?? 'default';          // ''

// Compare with || operator
const value = 0 || 'default';           // 'default'
const value = '' || 'default';          // 'default'
</code></pre>
<hr />
<h2 id="error-handling-1"><a class="header" href="#error-handling-1">Error Handling</a></h2>
<pre><code class="language-javascript">// Try-catch
try {
  throw new Error('Something went wrong');
} catch (error) {
  console.error(error.message);
} finally {
  console.log('Cleanup');
}

// Custom errors
class ValidationError extends Error {
  constructor(message) {
    super(message);
    this.name = 'ValidationError';
  }
}

try {
  throw new ValidationError('Invalid input');
} catch (error) {
  if (error instanceof ValidationError) {
    console.error('Validation error:', error.message);
  } else {
    throw error;  // Re-throw unknown errors
  }
}

// Error handling with async/await
async function fetchData() {
  try {
    const response = await fetch('/api/data');
    if (!response.ok) {
      throw new Error(`HTTP error! status: ${response.status}`);
    }
    return await response.json();
  } catch (error) {
    console.error('Fetch error:', error);
    throw error;
  }
}
</code></pre>
<hr />
<h2 id="common-array-methods"><a class="header" href="#common-array-methods">Common Array Methods</a></h2>
<pre><code class="language-javascript">const numbers = [1, 2, 3, 4, 5];

// map - transform each element
const doubled = numbers.map(n =&gt; n * 2);

// filter - select elements
const evens = numbers.filter(n =&gt; n % 2 === 0);

// reduce - aggregate
const sum = numbers.reduce((acc, n) =&gt; acc + n, 0);

// find - first matching element
const found = numbers.find(n =&gt; n &gt; 3);

// findIndex - index of first match
const index = numbers.findIndex(n =&gt; n &gt; 3);

// some - at least one matches
const hasEven = numbers.some(n =&gt; n % 2 === 0);

// every - all match
const allPositive = numbers.every(n =&gt; n &gt; 0);

// flat - flatten nested arrays
const nested = [1, [2, 3], [4, [5, 6]]];
const flat = nested.flat(2);  // [1, 2, 3, 4, 5, 6]

// flatMap - map then flatten
const words = ['hello world', 'foo bar'];
const letters = words.flatMap(w =&gt; w.split(' '));
</code></pre>
<hr />
<h2 id="best-practices-6"><a class="header" href="#best-practices-6">Best Practices</a></h2>
<ol>
<li><strong>Use <code>const</code> by default</strong>, <code>let</code> when reassignment is needed</li>
<li><strong>Avoid <code>var</code></strong> - it has function scope and hoisting issues</li>
<li><strong>Use arrow functions</strong> for callbacks and short functions</li>
<li><strong>Use template literals</strong> instead of string concatenation</li>
<li><strong>Use async/await</strong> instead of promise chains when possible</li>
<li><strong>Use destructuring</strong> for cleaner code</li>
<li><strong>Use spread operator</strong> for copying arrays/objects</li>
<li><strong>Handle errors properly</strong> with try-catch</li>
<li><strong>Use strict mode</strong>: <code>'use strict';</code></li>
<li><strong>Use meaningful variable names</strong></li>
</ol>
<hr />
<h2 id="common-librariesframeworks"><a class="header" href="#common-librariesframeworks">Common Libraries/Frameworks</a></h2>
<ul>
<li><strong>React</strong>: UI library</li>
<li><strong>Vue.js</strong>: Progressive framework</li>
<li><strong>Angular</strong>: Full-featured framework</li>
<li><strong>Express.js</strong>: Web server framework (Node.js)</li>
<li><strong>Lodash</strong>: Utility library</li>
<li><strong>Axios</strong>: HTTP client</li>
<li><strong>Moment.js/Day.js</strong>: Date manipulation</li>
<li><strong>D3.js</strong>: Data visualization</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="typescript"><a class="header" href="#typescript">TypeScript</a></h1>
<p>TypeScript is a strongly-typed superset of JavaScript developed by Microsoft that compiles to plain JavaScript. It adds optional static typing, classes, interfaces, and other features to JavaScript, making it easier to build and maintain large-scale applications.</p>
<h2 id="table-of-contents-1"><a class="header" href="#table-of-contents-1">Table of Contents</a></h2>
<ul>
<li><a href="programming/typescript.html#why-typescript">Why TypeScript?</a></li>
<li><a href="programming/typescript.html#basic-types">Basic Types</a></li>
<li><a href="programming/typescript.html#interfaces">Interfaces</a></li>
<li><a href="programming/typescript.html#type-aliases">Type Aliases</a></li>
<li><a href="programming/typescript.html#union-and-intersection-types">Union and Intersection Types</a></li>
<li><a href="programming/typescript.html#generics">Generics</a></li>
<li><a href="programming/typescript.html#classes">Classes</a></li>
<li><a href="programming/typescript.html#enums">Enums</a></li>
<li><a href="programming/typescript.html#type-assertions">Type Assertions</a></li>
<li><a href="programming/typescript.html#type-guards">Type Guards</a></li>
<li><a href="programming/typescript.html#utility-types">Utility Types</a></li>
<li><a href="programming/typescript.html#typescript-with-react">TypeScript with React</a></li>
<li><a href="programming/typescript.html#typescript-with-nodejs">TypeScript with Node.js</a></li>
<li><a href="programming/typescript.html#configuration-tsconfigjson">Configuration (tsconfig.json)</a></li>
<li><a href="programming/typescript.html#advanced-types">Advanced Types</a></li>
<li><a href="programming/typescript.html#best-practices">Best Practices</a></li>
</ul>
<hr />
<h2 id="why-typescript"><a class="header" href="#why-typescript">Why TypeScript?</a></h2>
<p><strong>Benefits:</strong></p>
<ul>
<li><strong>Type Safety</strong>: Catch errors at compile-time instead of runtime</li>
<li><strong>Better IDE Support</strong>: Enhanced autocomplete, navigation, and refactoring</li>
<li><strong>Self-Documenting</strong>: Types serve as inline documentation</li>
<li><strong>Scalability</strong>: Easier to maintain large codebases</li>
<li><strong>Modern JavaScript</strong>: Use latest JavaScript features with backward compatibility</li>
<li><strong>Refactoring Confidence</strong>: Safe refactoring with type checking</li>
</ul>
<p><strong>When to Use:</strong></p>
<ul>
<li>Large-scale applications</li>
<li>Team projects with multiple developers</li>
<li>Projects requiring long-term maintenance</li>
<li>When you need robust IDE support</li>
<li>Enterprise applications</li>
</ul>
<hr />
<h2 id="basic-types"><a class="header" href="#basic-types">Basic Types</a></h2>
<h3 id="primitive-types"><a class="header" href="#primitive-types">Primitive Types</a></h3>
<pre><code class="language-typescript">// Boolean
let isDone: boolean = false;

// Number
let decimal: number = 6;
let hex: number = 0xf00d;
let binary: number = 0b1010;
let octal: number = 0o744;

// String
let color: string = "blue";
let fullName: string = `Bob Bobbington`;
let sentence: string = `Hello, my name is ${fullName}.`;

// Array
let list: number[] = [1, 2, 3];
let list2: Array&lt;number&gt; = [1, 2, 3]; // Generic syntax

// Tuple - fixed-length array with known types
let x: [string, number];
x = ["hello", 10]; // OK
// x = [10, "hello"]; // Error

// Enum
enum Color {
  Red,
  Green,
  Blue,
}
let c: Color = Color.Green;

// Any - opt-out of type checking
let notSure: any = 4;
notSure = "maybe a string instead";
notSure = false; // OK

// Unknown - type-safe alternative to any
let userInput: unknown;
userInput = 5;
userInput = "hello";
// let str: string = userInput; // Error
if (typeof userInput === "string") {
  let str: string = userInput; // OK
}

// Void - absence of any type (typically for functions)
function warnUser(): void {
  console.log("This is a warning message");
}

// Null and Undefined
let u: undefined = undefined;
let n: null = null;

// Never - represents values that never occur
function error(message: string): never {
  throw new Error(message);
}

function infiniteLoop(): never {
  while (true) {}
}
</code></pre>
<hr />
<h2 id="interfaces"><a class="header" href="#interfaces">Interfaces</a></h2>
<p>Interfaces define the structure of objects and enforce contracts in your code.</p>
<h3 id="basic-interface"><a class="header" href="#basic-interface">Basic Interface</a></h3>
<pre><code class="language-typescript">interface User {
  id: number;
  name: string;
  email: string;
  age?: number; // Optional property
  readonly createdAt: Date; // Read-only property
}

const user: User = {
  id: 1,
  name: "John Doe",
  email: "john@example.com",
  createdAt: new Date(),
};

// user.createdAt = new Date(); // Error: Cannot assign to 'createdAt'
</code></pre>
<h3 id="function-types"><a class="header" href="#function-types">Function Types</a></h3>
<pre><code class="language-typescript">interface SearchFunc {
  (source: string, subString: string): boolean;
}

const mySearch: SearchFunc = (source, subString) =&gt; {
  return source.includes(subString);
};
</code></pre>
<h3 id="indexable-types"><a class="header" href="#indexable-types">Indexable Types</a></h3>
<pre><code class="language-typescript">interface StringArray {
  [index: number]: string;
}

let myArray: StringArray = ["Bob", "Fred"];
let myStr: string = myArray[0];

interface NumberDictionary {
  [key: string]: number;
}

let dict: NumberDictionary = {
  age: 25,
  height: 180,
};
</code></pre>
<h3 id="extending-interfaces"><a class="header" href="#extending-interfaces">Extending Interfaces</a></h3>
<pre><code class="language-typescript">interface Shape {
  color: string;
}

interface Square extends Shape {
  sideLength: number;
}

let square: Square = {
  color: "blue",
  sideLength: 10,
};

// Multiple inheritance
interface PenStroke {
  penWidth: number;
}

interface FilledSquare extends Square, PenStroke {
  filled: boolean;
}
</code></pre>
<h3 id="implementing-interfaces"><a class="header" href="#implementing-interfaces">Implementing Interfaces</a></h3>
<pre><code class="language-typescript">interface ClockInterface {
  currentTime: Date;
  setTime(d: Date): void;
}

class Clock implements ClockInterface {
  currentTime: Date = new Date();

  setTime(d: Date): void {
    this.currentTime = d;
  }
}
</code></pre>
<hr />
<h2 id="type-aliases"><a class="header" href="#type-aliases">Type Aliases</a></h2>
<p>Type aliases create a new name for a type. Similar to interfaces but more flexible.</p>
<pre><code class="language-typescript">// Basic type alias
type ID = string | number;

type Point = {
  x: number;
  y: number;
};

// Union type
type Result = Success | Failure;

type Success = {
  status: "success";
  data: any;
};

type Failure = {
  status: "error";
  error: string;
};

// Function type
type GreetFunction = (name: string) =&gt; string;

const greet: GreetFunction = (name) =&gt; `Hello, ${name}!`;

// Intersection type
type Admin = {
  privileges: string[];
};

type Employee = {
  name: string;
  startDate: Date;
};

type AdminEmployee = Admin &amp; Employee;

const ae: AdminEmployee = {
  privileges: ["create-server"],
  name: "Max",
  startDate: new Date(),
};
</code></pre>
<h3 id="interface-vs-type-alias"><a class="header" href="#interface-vs-type-alias">Interface vs Type Alias</a></h3>
<pre><code class="language-typescript">// Interfaces can be merged (declaration merging)
interface Window {
  title: string;
}

interface Window {
  ts: number;
}

// Type aliases cannot be merged
// type Window = { title: string };
// type Window = { ts: number }; // Error: Duplicate identifier

// Type aliases can represent unions and tuples
type StringOrNumber = string | number;
type Tuple = [string, number];

// Both can be extended
interface Shape {
  color: string;
}

// Interface extending interface
interface Circle extends Shape {
  radius: number;
}

// Type extending type
type ColoredShape = Shape &amp; { filled: boolean };

// Type extending interface
type ColoredCircle = Circle &amp; { filled: boolean };

// Interface extending type
type Size = { width: number; height: number };
interface Rectangle extends Size {
  color: string;
}
</code></pre>
<hr />
<h2 id="union-and-intersection-types"><a class="header" href="#union-and-intersection-types">Union and Intersection Types</a></h2>
<h3 id="union-types"><a class="header" href="#union-types">Union Types</a></h3>
<p>A union type can be one of several types.</p>
<pre><code class="language-typescript">function printId(id: number | string) {
  console.log("Your ID is: " + id);
}

printId(101); // OK
printId("202"); // OK
// printId({ myID: 22342 }); // Error

// Discriminated Unions (Tagged Unions)
type Shape =
  | { kind: "circle"; radius: number }
  | { kind: "square"; sideLength: number }
  | { kind: "rectangle"; width: number; height: number };

function getArea(shape: Shape): number {
  switch (shape.kind) {
    case "circle":
      return Math.PI * shape.radius ** 2;
    case "square":
      return shape.sideLength ** 2;
    case "rectangle":
      return shape.width * shape.height;
  }
}
</code></pre>
<h3 id="intersection-types"><a class="header" href="#intersection-types">Intersection Types</a></h3>
<p>An intersection type combines multiple types into one.</p>
<pre><code class="language-typescript">interface Colorful {
  color: string;
}

interface Circle {
  radius: number;
}

type ColorfulCircle = Colorful &amp; Circle;

const cc: ColorfulCircle = {
  color: "red",
  radius: 42,
};
</code></pre>
<hr />
<h2 id="generics"><a class="header" href="#generics">Generics</a></h2>
<p>Generics allow you to create reusable components that work with multiple types.</p>
<h3 id="generic-functions"><a class="header" href="#generic-functions">Generic Functions</a></h3>
<pre><code class="language-typescript">function identity&lt;T&gt;(arg: T): T {
  return arg;
}

let output1 = identity&lt;string&gt;("myString");
let output2 = identity&lt;number&gt;(123);
let output3 = identity("myString"); // Type inference

// Generic with constraints
interface Lengthwise {
  length: number;
}

function loggingIdentity&lt;T extends Lengthwise&gt;(arg: T): T {
  console.log(arg.length);
  return arg;
}

loggingIdentity({ length: 10, value: 3 }); // OK
loggingIdentity([1, 2, 3]); // OK
// loggingIdentity(3); // Error: number doesn't have length
</code></pre>
<h3 id="generic-interfaces"><a class="header" href="#generic-interfaces">Generic Interfaces</a></h3>
<pre><code class="language-typescript">interface GenericIdentityFn&lt;T&gt; {
  (arg: T): T;
}

let myIdentity: GenericIdentityFn&lt;number&gt; = identity;

// Generic container
interface Container&lt;T&gt; {
  value: T;
  getValue(): T;
  setValue(value: T): void;
}

class Box&lt;T&gt; implements Container&lt;T&gt; {
  constructor(public value: T) {}

  getValue(): T {
    return this.value;
  }

  setValue(value: T): void {
    this.value = value;
  }
}

const numberBox = new Box&lt;number&gt;(42);
const stringBox = new Box&lt;string&gt;("hello");
</code></pre>
<h3 id="generic-classes"><a class="header" href="#generic-classes">Generic Classes</a></h3>
<pre><code class="language-typescript">class GenericNumber&lt;T&gt; {
  zeroValue: T;
  add: (x: T, y: T) =&gt; T;
}

let myGenericNumber = new GenericNumber&lt;number&gt;();
myGenericNumber.zeroValue = 0;
myGenericNumber.add = (x, y) =&gt; x + y;

let stringNumeric = new GenericNumber&lt;string&gt;();
stringNumeric.zeroValue = "";
stringNumeric.add = (x, y) =&gt; x + y;
</code></pre>
<h3 id="generic-constraints"><a class="header" href="#generic-constraints">Generic Constraints</a></h3>
<pre><code class="language-typescript">function getProperty&lt;T, K extends keyof T&gt;(obj: T, key: K): T[K] {
  return obj[key];
}

let x = { a: 1, b: 2, c: 3, d: 4 };

getProperty(x, "a"); // OK
// getProperty(x, "m"); // Error: "m" is not in 'a' | 'b' | 'c' | 'd'
</code></pre>
<h3 id="advanced-generic-patterns"><a class="header" href="#advanced-generic-patterns">Advanced Generic Patterns</a></h3>
<pre><code class="language-typescript">// Generic type with default
type APIResponse&lt;T = any&gt; = {
  data: T;
  status: number;
  message: string;
};

// Multiple type parameters
function merge&lt;T, U&gt;(obj1: T, obj2: U): T &amp; U {
  return { ...obj1, ...obj2 };
}

const merged = merge({ name: "John" }, { age: 30 });
// merged: { name: string } &amp; { age: number }

// Conditional types with generics
type NonNullable&lt;T&gt; = T extends null | undefined ? never : T;

type A = NonNullable&lt;string | null&gt;; // string
type B = NonNullable&lt;number | undefined&gt;; // number
</code></pre>
<hr />
<h2 id="classes"><a class="header" href="#classes">Classes</a></h2>
<h3 id="basic-class"><a class="header" href="#basic-class">Basic Class</a></h3>
<pre><code class="language-typescript">class Greeter {
  greeting: string;

  constructor(message: string) {
    this.greeting = message;
  }

  greet(): string {
    return `Hello, ${this.greeting}`;
  }
}

let greeter = new Greeter("world");
</code></pre>
<h3 id="inheritance-2"><a class="header" href="#inheritance-2">Inheritance</a></h3>
<pre><code class="language-typescript">class Animal {
  name: string;

  constructor(name: string) {
    this.name = name;
  }

  move(distanceInMeters: number = 0): void {
    console.log(`${this.name} moved ${distanceInMeters}m.`);
  }
}

class Dog extends Animal {
  bark(): void {
    console.log("Woof! Woof!");
  }
}

const dog = new Dog("Buddy");
dog.bark();
dog.move(10);
</code></pre>
<h3 id="access-modifiers"><a class="header" href="#access-modifiers">Access Modifiers</a></h3>
<pre><code class="language-typescript">class Person {
  public name: string; // Public by default
  private age: number; // Only accessible within the class
  protected email: string; // Accessible in class and subclasses
  readonly id: number; // Cannot be modified after initialization

  constructor(name: string, age: number, email: string, id: number) {
    this.name = name;
    this.age = age;
    this.email = email;
    this.id = id;
  }

  getAge(): number {
    return this.age;
  }
}

class Employee extends Person {
  constructor(name: string, age: number, email: string, id: number) {
    super(name, age, email, id);
  }

  getEmail(): string {
    return this.email; // OK: protected is accessible in subclass
  }
}

const person = new Person("John", 30, "john@example.com", 1);
console.log(person.name); // OK
// console.log(person.age); // Error: private
// console.log(person.email); // Error: protected
</code></pre>
<h3 id="getters-and-setters"><a class="header" href="#getters-and-setters">Getters and Setters</a></h3>
<pre><code class="language-typescript">class Employee {
  private _fullName: string = "";

  get fullName(): string {
    return this._fullName;
  }

  set fullName(newName: string) {
    if (newName &amp;&amp; newName.length &gt; 0) {
      this._fullName = newName;
    } else {
      throw new Error("Invalid name");
    }
  }
}

let employee = new Employee();
employee.fullName = "Bob Smith";
console.log(employee.fullName);
</code></pre>
<h3 id="abstract-classes"><a class="header" href="#abstract-classes">Abstract Classes</a></h3>
<pre><code class="language-typescript">abstract class Department {
  constructor(public name: string) {}

  printName(): void {
    console.log("Department name: " + this.name);
  }

  abstract printMeeting(): void; // Must be implemented in derived class
}

class AccountingDepartment extends Department {
  constructor() {
    super("Accounting and Auditing");
  }

  printMeeting(): void {
    console.log("The Accounting Department meets each Monday at 10am.");
  }

  generateReports(): void {
    console.log("Generating accounting reports...");
  }
}

let department: Department = new AccountingDepartment();
department.printName();
department.printMeeting();
// department.generateReports(); // Error: method doesn't exist on Department
</code></pre>
<h3 id="static-members"><a class="header" href="#static-members">Static Members</a></h3>
<pre><code class="language-typescript">class Grid {
  static origin = { x: 0, y: 0 };

  calculateDistanceFromOrigin(point: { x: number; y: number }): number {
    let xDist = point.x - Grid.origin.x;
    let yDist = point.y - Grid.origin.y;
    return Math.sqrt(xDist * xDist + yDist * yDist);
  }
}

console.log(Grid.origin);
let grid = new Grid();
</code></pre>
<hr />
<h2 id="enums"><a class="header" href="#enums">Enums</a></h2>
<p>Enums allow defining a set of named constants.</p>
<h3 id="numeric-enums"><a class="header" href="#numeric-enums">Numeric Enums</a></h3>
<pre><code class="language-typescript">enum Direction {
  Up = 1,
  Down,
  Left,
  Right,
}

// Starts from 1 and auto-increments
console.log(Direction.Up); // 1
console.log(Direction.Down); // 2

enum Response {
  No = 0,
  Yes = 1,
}

function respond(recipient: string, message: Response): void {
  // ...
}

respond("Princess Caroline", Response.Yes);
</code></pre>
<h3 id="string-enums"><a class="header" href="#string-enums">String Enums</a></h3>
<pre><code class="language-typescript">enum Direction {
  Up = "UP",
  Down = "DOWN",
  Left = "LEFT",
  Right = "RIGHT",
}

console.log(Direction.Up); // "UP"
</code></pre>
<h3 id="const-enums"><a class="header" href="#const-enums">Const Enums</a></h3>
<pre><code class="language-typescript">const enum Enum {
  A = 1,
  B = A * 2,
}

// Compiled code is inlined (better performance)
let value = Enum.B; // Becomes: let value = 2;
</code></pre>
<h3 id="enum-as-type"><a class="header" href="#enum-as-type">Enum as Type</a></h3>
<pre><code class="language-typescript">enum Status {
  Active,
  Inactive,
  Pending,
}

interface User {
  name: string;
  status: Status;
}

const user: User = {
  name: "John",
  status: Status.Active,
};
</code></pre>
<hr />
<h2 id="type-assertions"><a class="header" href="#type-assertions">Type Assertions</a></h2>
<p>Type assertions tell the compiler to treat a value as a specific type.</p>
<pre><code class="language-typescript">// Angle-bracket syntax
let someValue: any = "this is a string";
let strLength: number = (&lt;string&gt;someValue).length;

// As syntax (preferred in JSX/TSX)
let someValue2: any = "this is a string";
let strLength2: number = (someValue2 as string).length;

// Non-null assertion operator
function liveDangerously(x?: number | null) {
  // TypeScript will trust that x is not null/undefined
  console.log(x!.toFixed());
}

// Const assertions
let x = "hello" as const; // Type: "hello" (not string)

let y = [10, 20] as const; // Type: readonly [10, 20]

let z = {
  name: "John",
  age: 30,
} as const; // All properties are readonly
</code></pre>
<hr />
<h2 id="type-guards"><a class="header" href="#type-guards">Type Guards</a></h2>
<p>Type guards allow you to narrow down the type of a variable within a conditional block.</p>
<h3 id="typeof-guards"><a class="header" href="#typeof-guards">typeof Guards</a></h3>
<pre><code class="language-typescript">function padLeft(value: string, padding: string | number) {
  if (typeof padding === "number") {
    return Array(padding + 1).join(" ") + value;
  }
  if (typeof padding === "string") {
    return padding + value;
  }
  throw new Error(`Expected string or number, got '${typeof padding}'.`);
}
</code></pre>
<h3 id="instanceof-guards"><a class="header" href="#instanceof-guards">instanceof Guards</a></h3>
<pre><code class="language-typescript">class Bird {
  fly() {
    console.log("Flying");
  }
}

class Fish {
  swim() {
    console.log("Swimming");
  }
}

function move(animal: Bird | Fish) {
  if (animal instanceof Bird) {
    animal.fly();
  } else {
    animal.swim();
  }
}
</code></pre>
<h3 id="in-operator"><a class="header" href="#in-operator">in Operator</a></h3>
<pre><code class="language-typescript">type Fish = { swim: () =&gt; void };
type Bird = { fly: () =&gt; void };

function move(animal: Fish | Bird) {
  if ("swim" in animal) {
    animal.swim();
  } else {
    animal.fly();
  }
}
</code></pre>
<h3 id="custom-type-guards"><a class="header" href="#custom-type-guards">Custom Type Guards</a></h3>
<pre><code class="language-typescript">interface Cat {
  meow(): void;
}

interface Dog {
  bark(): void;
}

function isCat(pet: Cat | Dog): pet is Cat {
  return (pet as Cat).meow !== undefined;
}

function makeSound(pet: Cat | Dog) {
  if (isCat(pet)) {
    pet.meow();
  } else {
    pet.bark();
  }
}
</code></pre>
<hr />
<h2 id="utility-types"><a class="header" href="#utility-types">Utility Types</a></h2>
<p>TypeScript provides several utility types for common type transformations.</p>
<h3 id="partial"><a class="header" href="#partial">Partial<T></a></h3>
<p>Makes all properties optional.</p>
<pre><code class="language-typescript">interface User {
  id: number;
  name: string;
  email: string;
}

function updateUser(user: User, updates: Partial&lt;User&gt;): User {
  return { ...user, ...updates };
}

const user: User = { id: 1, name: "John", email: "john@example.com" };
const updated = updateUser(user, { name: "Jane" });
</code></pre>
<h3 id="required"><a class="header" href="#required">Required<T></a></h3>
<p>Makes all properties required.</p>
<pre><code class="language-typescript">interface Props {
  a?: number;
  b?: string;
}

const obj: Required&lt;Props&gt; = { a: 5, b: "text" };
</code></pre>
<h3 id="readonly"><a class="header" href="#readonly">Readonly<T></a></h3>
<p>Makes all properties readonly.</p>
<pre><code class="language-typescript">interface User {
  name: string;
  age: number;
}

const user: Readonly&lt;User&gt; = {
  name: "John",
  age: 30,
};

// user.name = "Jane"; // Error: Cannot assign to 'name'
</code></pre>
<h3 id="pickt-k"><a class="header" href="#pickt-k">Pick&lt;T, K&gt;</a></h3>
<p>Creates a type by picking specific properties from another type.</p>
<pre><code class="language-typescript">interface User {
  id: number;
  name: string;
  email: string;
  age: number;
}

type UserPreview = Pick&lt;User, "id" | "name"&gt;;
// { id: number; name: string; }

const preview: UserPreview = { id: 1, name: "John" };
</code></pre>
<h3 id="omitt-k"><a class="header" href="#omitt-k">Omit&lt;T, K&gt;</a></h3>
<p>Creates a type by omitting specific properties.</p>
<pre><code class="language-typescript">interface User {
  id: number;
  name: string;
  email: string;
  password: string;
}

type UserPublic = Omit&lt;User, "password"&gt;;
// { id: number; name: string; email: string; }
</code></pre>
<h3 id="recordk-t"><a class="header" href="#recordk-t">Record&lt;K, T&gt;</a></h3>
<p>Creates an object type with keys of type K and values of type T.</p>
<pre><code class="language-typescript">type PageInfo = {
  title: string;
  url: string;
};

type Page = "home" | "about" | "contact";

const pages: Record&lt;Page, PageInfo&gt; = {
  home: { title: "Home", url: "/" },
  about: { title: "About", url: "/about" },
  contact: { title: "Contact", url: "/contact" },
};
</code></pre>
<h3 id="excludet-u-and-extractt-u"><a class="header" href="#excludet-u-and-extractt-u">Exclude&lt;T, U&gt; and Extract&lt;T, U&gt;</a></h3>
<pre><code class="language-typescript">type T0 = Exclude&lt;"a" | "b" | "c", "a"&gt;; // "b" | "c"
type T1 = Exclude&lt;string | number | (() =&gt; void), Function&gt;; // string | number

type T2 = Extract&lt;"a" | "b" | "c", "a" | "f"&gt;; // "a"
type T3 = Extract&lt;string | number | (() =&gt; void), Function&gt;; // () =&gt; void
</code></pre>
<h3 id="returntype"><a class="header" href="#returntype">ReturnType<T></a></h3>
<p>Extracts the return type of a function type.</p>
<pre><code class="language-typescript">function getUser() {
  return { id: 1, name: "John", email: "john@example.com" };
}

type User = ReturnType&lt;typeof getUser&gt;;
// { id: number; name: string; email: string; }
</code></pre>
<h3 id="parameters"><a class="header" href="#parameters">Parameters<T></a></h3>
<p>Extracts parameter types of a function type as a tuple.</p>
<pre><code class="language-typescript">function createUser(name: string, age: number, email: string) {
  return { name, age, email };
}

type CreateUserParams = Parameters&lt;typeof createUser&gt;;
// [name: string, age: number, email: string]
</code></pre>
<hr />
<h2 id="typescript-with-react"><a class="header" href="#typescript-with-react">TypeScript with React</a></h2>
<h3 id="functional-components"><a class="header" href="#functional-components">Functional Components</a></h3>
<pre><code class="language-typescript">import React from "react";

// Props interface
interface ButtonProps {
  label: string;
  onClick: () =&gt; void;
  disabled?: boolean;
  variant?: "primary" | "secondary";
}

// Functional component
const Button: React.FC&lt;ButtonProps&gt; = ({
  label,
  onClick,
  disabled = false,
  variant = "primary",
}) =&gt; {
  return (
    &lt;button onClick={onClick} disabled={disabled} className={variant}&gt;
      {label}
    &lt;/button&gt;
  );
};

// Alternative (recommended in modern React)
function Button2(props: ButtonProps) {
  return &lt;button {...props}&gt;{props.label}&lt;/button&gt;;
}

export default Button;
</code></pre>
<h3 id="component-with-children"><a class="header" href="#component-with-children">Component with Children</a></h3>
<pre><code class="language-typescript">interface CardProps {
  title: string;
  children: React.ReactNode;
}

const Card: React.FC&lt;CardProps&gt; = ({ title, children }) =&gt; {
  return (
    &lt;div className="card"&gt;
      &lt;h2&gt;{title}&lt;/h2&gt;
      &lt;div className="card-body"&gt;{children}&lt;/div&gt;
    &lt;/div&gt;
  );
};
</code></pre>
<h3 id="usestate-hook"><a class="header" href="#usestate-hook">useState Hook</a></h3>
<pre><code class="language-typescript">import { useState } from "react";

interface User {
  id: number;
  name: string;
}

function UserComponent() {
  // Type inference
  const [count, setCount] = useState(0);

  // Explicit type
  const [user, setUser] = useState&lt;User | null&gt;(null);

  // With initial state
  const [users, setUsers] = useState&lt;User[]&gt;([]);

  return (
    &lt;div&gt;
      &lt;p&gt;Count: {count}&lt;/p&gt;
      &lt;button onClick={() =&gt; setCount(count + 1)}&gt;Increment&lt;/button&gt;
    &lt;/div&gt;
  );
}
</code></pre>
<h3 id="useeffect-hook"><a class="header" href="#useeffect-hook">useEffect Hook</a></h3>
<pre><code class="language-typescript">import { useEffect, useState } from "react";

function DataFetcher() {
  const [data, setData] = useState&lt;any&gt;(null);

  useEffect(() =&gt; {
    async function fetchData() {
      const response = await fetch("/api/data");
      const result = await response.json();
      setData(result);
    }

    fetchData();
  }, []); // Empty dependency array

  return &lt;div&gt;{data ? JSON.stringify(data) : "Loading..."}&lt;/div&gt;;
}
</code></pre>
<h3 id="useref-hook"><a class="header" href="#useref-hook">useRef Hook</a></h3>
<pre><code class="language-typescript">import { useRef, useEffect } from "react";

function TextInput() {
  const inputRef = useRef&lt;HTMLInputElement&gt;(null);

  useEffect(() =&gt; {
    inputRef.current?.focus();
  }, []);

  return &lt;input ref={inputRef} type="text" /&gt;;
}
</code></pre>
<h3 id="usecontext-hook"><a class="header" href="#usecontext-hook">useContext Hook</a></h3>
<pre><code class="language-typescript">import { createContext, useContext, useState } from "react";

interface AuthContextType {
  user: User | null;
  login: (user: User) =&gt; void;
  logout: () =&gt; void;
}

const AuthContext = createContext&lt;AuthContextType | undefined&gt;(undefined);

export const AuthProvider: React.FC&lt;{ children: React.ReactNode }&gt; = ({
  children,
}) =&gt; {
  const [user, setUser] = useState&lt;User | null&gt;(null);

  const login = (user: User) =&gt; setUser(user);
  const logout = () =&gt; setUser(null);

  return (
    &lt;AuthContext.Provider value={{ user, login, logout }}&gt;
      {children}
    &lt;/AuthContext.Provider&gt;
  );
};

export const useAuth = () =&gt; {
  const context = useContext(AuthContext);
  if (context === undefined) {
    throw new Error("useAuth must be used within AuthProvider");
  }
  return context;
};
</code></pre>
<h3 id="custom-hooks"><a class="header" href="#custom-hooks">Custom Hooks</a></h3>
<pre><code class="language-typescript">import { useState, useEffect } from "react";

function useFetch&lt;T&gt;(url: string) {
  const [data, setData] = useState&lt;T | null&gt;(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState&lt;Error | null&gt;(null);

  useEffect(() =&gt; {
    async function fetchData() {
      try {
        const response = await fetch(url);
        const result = await response.json();
        setData(result);
      } catch (err) {
        setError(err as Error);
      } finally {
        setLoading(false);
      }
    }

    fetchData();
  }, [url]);

  return { data, loading, error };
}

// Usage
interface User {
  id: number;
  name: string;
}

function UserList() {
  const { data: users, loading, error } = useFetch&lt;User[]&gt;("/api/users");

  if (loading) return &lt;div&gt;Loading...&lt;/div&gt;;
  if (error) return &lt;div&gt;Error: {error.message}&lt;/div&gt;;

  return (
    &lt;ul&gt;
      {users?.map((user) =&gt; (
        &lt;li key={user.id}&gt;{user.name}&lt;/li&gt;
      ))}
    &lt;/ul&gt;
  );
}
</code></pre>
<h3 id="event-handlers"><a class="header" href="#event-handlers">Event Handlers</a></h3>
<pre><code class="language-typescript">import React from "react";

function Form() {
  const handleSubmit = (e: React.FormEvent&lt;HTMLFormElement&gt;) =&gt; {
    e.preventDefault();
    // Handle form submission
  };

  const handleChange = (e: React.ChangeEvent&lt;HTMLInputElement&gt;) =&gt; {
    console.log(e.target.value);
  };

  const handleClick = (e: React.MouseEvent&lt;HTMLButtonElement&gt;) =&gt; {
    console.log("Button clicked");
  };

  return (
    &lt;form onSubmit={handleSubmit}&gt;
      &lt;input type="text" onChange={handleChange} /&gt;
      &lt;button onClick={handleClick}&gt;Submit&lt;/button&gt;
    &lt;/form&gt;
  );
}
</code></pre>
<hr />
<h2 id="typescript-with-nodejs"><a class="header" href="#typescript-with-nodejs">TypeScript with Node.js</a></h2>
<h3 id="basic-express-server"><a class="header" href="#basic-express-server">Basic Express Server</a></h3>
<pre><code class="language-typescript">import express, { Request, Response, NextFunction } from "express";

const app = express();
const PORT = 3000;

app.use(express.json());

// Basic route
app.get("/", (req: Request, res: Response) =&gt; {
  res.json({ message: "Hello World" });
});

// Route with params
app.get("/users/:id", (req: Request, res: Response) =&gt; {
  const userId = req.params.id;
  res.json({ id: userId });
});

// POST route with body
interface CreateUserBody {
  name: string;
  email: string;
}

app.post("/users", (req: Request&lt;{}, {}, CreateUserBody&gt;, res: Response) =&gt; {
  const { name, email } = req.body;
  res.json({ id: 1, name, email });
});

// Middleware
const logger = (req: Request, res: Response, next: NextFunction) =&gt; {
  console.log(`${req.method} ${req.path}`);
  next();
};

app.use(logger);

// Error handling middleware
app.use((err: Error, req: Request, res: Response, next: NextFunction) =&gt; {
  console.error(err.stack);
  res.status(500).json({ error: err.message });
});

app.listen(PORT, () =&gt; {
  console.log(`Server running on port ${PORT}`);
});
</code></pre>
<h3 id="custom-request-types"><a class="header" href="#custom-request-types">Custom Request Types</a></h3>
<pre><code class="language-typescript">import { Request } from "express";

interface UserRequest extends Request {
  user?: {
    id: number;
    email: string;
  };
}

app.get("/profile", (req: UserRequest, res: Response) =&gt; {
  if (!req.user) {
    return res.status(401).json({ error: "Unauthorized" });
  }
  res.json(req.user);
});
</code></pre>
<h3 id="asyncawait-with-express"><a class="header" href="#asyncawait-with-express">Async/Await with Express</a></h3>
<pre><code class="language-typescript">import { Request, Response } from "express";

// Wrapper for async route handlers
const asyncHandler =
  (fn: Function) =&gt; (req: Request, res: Response, next: NextFunction) =&gt; {
    Promise.resolve(fn(req, res, next)).catch(next);
  };

app.get(
  "/users",
  asyncHandler(async (req: Request, res: Response) =&gt; {
    const users = await getUsersFromDB();
    res.json(users);
  })
);
</code></pre>
<h3 id="file-system-operations"><a class="header" href="#file-system-operations">File System Operations</a></h3>
<pre><code class="language-typescript">import * as fs from "fs/promises";
import * as path from "path";

async function readConfig(): Promise&lt;any&gt; {
  try {
    const configPath = path.join(__dirname, "config.json");
    const data = await fs.readFile(configPath, "utf-8");
    return JSON.parse(data);
  } catch (error) {
    console.error("Error reading config:", error);
    throw error;
  }
}

async function writeLog(message: string): Promise&lt;void&gt; {
  const logPath = path.join(__dirname, "app.log");
  const timestamp = new Date().toISOString();
  const logEntry = `[${timestamp}] ${message}\n`;
  await fs.appendFile(logPath, logEntry);
}
</code></pre>
<hr />
<h2 id="configuration-tsconfigjson"><a class="header" href="#configuration-tsconfigjson">Configuration (tsconfig.json)</a></h2>
<h3 id="basic-configuration"><a class="header" href="#basic-configuration">Basic Configuration</a></h3>
<pre><code class="language-json">{
  "compilerOptions": {
    "target": "ES2020",
    "module": "commonjs",
    "lib": ["ES2020"],
    "outDir": "./dist",
    "rootDir": "./src",
    "strict": true,
    "esModuleInterop": true,
    "skipLibCheck": true,
    "forceConsistentCasingInFileNames": true,
    "resolveJsonModule": true,
    "moduleResolution": "node",
    "declaration": true,
    "declarationMap": true,
    "sourceMap": true
  },
  "include": ["src/**/*"],
  "exclude": ["node_modules", "dist"]
}
</code></pre>
<h3 id="important-compiler-options"><a class="header" href="#important-compiler-options">Important Compiler Options</a></h3>
<h4 id="strict-type-checking"><a class="header" href="#strict-type-checking">Strict Type Checking</a></h4>
<pre><code class="language-json">{
  "compilerOptions": {
    "strict": true,               // Enable all strict type checking
    "noImplicitAny": true,        // Error on expressions with implied 'any'
    "strictNullChecks": true,     // Enable strict null checks
    "strictFunctionTypes": true,  // Enable strict checking of function types
    "strictBindCallApply": true,  // Enable strict bind/call/apply methods
    "strictPropertyInitialization": true, // Ensure properties are initialized
    "noImplicitThis": true,       // Error on 'this' expressions with implied 'any'
    "alwaysStrict": true          // Parse in strict mode and emit "use strict"
  }
}
</code></pre>
<h4 id="module-resolution"><a class="header" href="#module-resolution">Module Resolution</a></h4>
<pre><code class="language-json">{
  "compilerOptions": {
    "module": "commonjs",         // Module code generation
    "moduleResolution": "node",   // Module resolution strategy
    "baseUrl": "./",              // Base directory for module resolution
    "paths": {                    // Path mappings
      "@/*": ["src/*"],
      "@components/*": ["src/components/*"]
    },
    "esModuleInterop": true,      // Emit helpers for importing CommonJS modules
    "allowSyntheticDefaultImports": true  // Allow default imports from modules
  }
}
</code></pre>
<h4 id="react-configuration"><a class="header" href="#react-configuration">React Configuration</a></h4>
<pre><code class="language-json">{
  "compilerOptions": {
    "jsx": "react-jsx",           // JSX code generation (React 17+)
    // "jsx": "react",            // For React 16 and earlier
    "lib": ["DOM", "DOM.Iterable", "ES2020"]
  }
}
</code></pre>
<h4 id="nodejs-configuration"><a class="header" href="#nodejs-configuration">Node.js Configuration</a></h4>
<pre><code class="language-json">{
  "compilerOptions": {
    "target": "ES2020",
    "module": "commonjs",
    "lib": ["ES2020"],
    "types": ["node"],
    "esModuleInterop": true
  }
}
</code></pre>
<h3 id="project-references"><a class="header" href="#project-references">Project References</a></h3>
<p>For monorepos or multi-package projects:</p>
<pre><code class="language-json">{
  "compilerOptions": {
    "composite": true,
    "declaration": true,
    "declarationMap": true
  },
  "references": [
    { "path": "../common" },
    { "path": "../utils" }
  ]
}
</code></pre>
<hr />
<h2 id="advanced-types"><a class="header" href="#advanced-types">Advanced Types</a></h2>
<h3 id="conditional-types"><a class="header" href="#conditional-types">Conditional Types</a></h3>
<pre><code class="language-typescript">type IsString&lt;T&gt; = T extends string ? true : false;

type A = IsString&lt;string&gt;; // true
type B = IsString&lt;number&gt;; // false

// Distributive conditional types
type ToArray&lt;T&gt; = T extends any ? T[] : never;
type StrOrNumArray = ToArray&lt;string | number&gt;; // string[] | number[]

// Infer keyword
type ReturnType&lt;T&gt; = T extends (...args: any[]) =&gt; infer R ? R : never;

type Func = () =&gt; number;
type Result = ReturnType&lt;Func&gt;; // number
</code></pre>
<h3 id="mapped-types"><a class="header" href="#mapped-types">Mapped Types</a></h3>
<pre><code class="language-typescript">type Readonly&lt;T&gt; = {
  readonly [P in keyof T]: T[P];
};

type Optional&lt;T&gt; = {
  [P in keyof T]?: T[P];
};

type Nullable&lt;T&gt; = {
  [P in keyof T]: T[P] | null;
};

interface Person {
  name: string;
  age: number;
}

type ReadonlyPerson = Readonly&lt;Person&gt;;
// { readonly name: string; readonly age: number; }

type OptionalPerson = Optional&lt;Person&gt;;
// { name?: string; age?: number; }
</code></pre>
<h3 id="template-literal-types"><a class="header" href="#template-literal-types">Template Literal Types</a></h3>
<pre><code class="language-typescript">type EventName = "click" | "scroll" | "mousemove";
type Handler = `on${Capitalize&lt;EventName&gt;}`;
// "onClick" | "onScroll" | "onMousemove"

type PropEventSource&lt;Type&gt; = {
  on&lt;Key extends string &amp; keyof Type&gt;(
    eventName: `${Key}Changed`,
    callback: (newValue: Type[Key]) =&gt; void
  ): void;
};

declare function makeWatchedObject&lt;Type&gt;(
  obj: Type
): Type &amp; PropEventSource&lt;Type&gt;;

const person = makeWatchedObject({
  firstName: "John",
  age: 26,
});

person.on("firstNameChanged", (newName) =&gt; {
  console.log(`New name: ${newName}`);
});
</code></pre>
<h3 id="index-signatures"><a class="header" href="#index-signatures">Index Signatures</a></h3>
<pre><code class="language-typescript">interface StringArray {
  [index: number]: string;
}

interface StringByString {
  [key: string]: string | number;
  length: number; // OK: number is assignable to string | number
}

// Generic index signature
interface Dictionary&lt;T&gt; {
  [key: string]: T;
}

const userScores: Dictionary&lt;number&gt; = {
  john: 100,
  jane: 95,
};
</code></pre>
<h3 id="discriminated-unions-tagged-unions"><a class="header" href="#discriminated-unions-tagged-unions">Discriminated Unions (Tagged Unions)</a></h3>
<pre><code class="language-typescript">interface Square {
  kind: "square";
  size: number;
}

interface Rectangle {
  kind: "rectangle";
  width: number;
  height: number;
}

interface Circle {
  kind: "circle";
  radius: number;
}

type Shape = Square | Rectangle | Circle;

function area(s: Shape): number {
  switch (s.kind) {
    case "square":
      return s.size * s.size;
    case "rectangle":
      return s.width * s.height;
    case "circle":
      return Math.PI * s.radius ** 2;
  }
}
</code></pre>
<hr />
<h2 id="best-practices-7"><a class="header" href="#best-practices-7">Best Practices</a></h2>
<h3 id="1-use-strict-mode"><a class="header" href="#1-use-strict-mode">1. Use Strict Mode</a></h3>
<p>Always enable <code>strict: true</code> in <code>tsconfig.json</code> for maximum type safety.</p>
<pre><code class="language-json">{
  "compilerOptions": {
    "strict": true
  }
}
</code></pre>
<h3 id="2-avoid-any-type"><a class="header" href="#2-avoid-any-type">2. Avoid <code>any</code> Type</a></h3>
<p>Use <code>unknown</code> instead of <code>any</code> when the type is truly unknown.</p>
<pre><code class="language-typescript">// Bad
function process(data: any) {
  return data.value;
}

// Good
function process(data: unknown) {
  if (typeof data === "object" &amp;&amp; data !== null &amp;&amp; "value" in data) {
    return (data as { value: any }).value;
  }
  throw new Error("Invalid data");
}
</code></pre>
<h3 id="3-use-type-inference"><a class="header" href="#3-use-type-inference">3. Use Type Inference</a></h3>
<p>Let TypeScript infer types when possible.</p>
<pre><code class="language-typescript">// Bad
const numbers: number[] = [1, 2, 3];
const result: number = numbers.reduce((acc: number, n: number) =&gt; acc + n, 0);

// Good
const numbers = [1, 2, 3];
const result = numbers.reduce((acc, n) =&gt; acc + n, 0);
</code></pre>
<h3 id="4-use-readonly-when-appropriate"><a class="header" href="#4-use-readonly-when-appropriate">4. Use Readonly When Appropriate</a></h3>
<pre><code class="language-typescript">// Readonly arrays
const numbers: readonly number[] = [1, 2, 3];
// numbers.push(4); // Error

// Readonly objects
interface Config {
  readonly apiUrl: string;
  readonly timeout: number;
}

// Readonly function parameters
function printList(list: readonly string[]) {
  // list.push("new"); // Error
  console.log(list.join(", "));
}
</code></pre>
<h3 id="5-prefer-interfaces-for-objects-types-for-unionsintersections"><a class="header" href="#5-prefer-interfaces-for-objects-types-for-unionsintersections">5. Prefer Interfaces for Objects, Types for Unions/Intersections</a></h3>
<pre><code class="language-typescript">// Good: Use interface for object shapes
interface User {
  id: number;
  name: string;
}

// Good: Use type for unions
type Status = "pending" | "approved" | "rejected";

// Good: Use type for intersections
type AdminUser = User &amp; { role: "admin" };
</code></pre>
<h3 id="6-use-discriminated-unions-for-complex-state"><a class="header" href="#6-use-discriminated-unions-for-complex-state">6. Use Discriminated Unions for Complex State</a></h3>
<pre><code class="language-typescript">type RequestState =
  | { status: "idle" }
  | { status: "loading" }
  | { status: "success"; data: any }
  | { status: "error"; error: string };

function handleRequest(state: RequestState) {
  switch (state.status) {
    case "idle":
      return "Not started";
    case "loading":
      return "Loading...";
    case "success":
      return state.data;
    case "error":
      return state.error;
  }
}
</code></pre>
<h3 id="7-use-const-assertions"><a class="header" href="#7-use-const-assertions">7. Use Const Assertions</a></h3>
<pre><code class="language-typescript">// Without const assertion
const colors = ["red", "green", "blue"];
// Type: string[]

// With const assertion
const colors = ["red", "green", "blue"] as const;
// Type: readonly ["red", "green", "blue"]

const config = {
  apiUrl: "https://api.example.com",
  timeout: 5000,
} as const;
// All properties are readonly
</code></pre>
<h3 id="8-use-type-guards"><a class="header" href="#8-use-type-guards">8. Use Type Guards</a></h3>
<pre><code class="language-typescript">function isString(value: unknown): value is string {
  return typeof value === "string";
}

function processValue(value: string | number) {
  if (isString(value)) {
    console.log(value.toUpperCase());
  } else {
    console.log(value.toFixed(2));
  }
}
</code></pre>
<h3 id="9-use-generics-for-reusable-code"><a class="header" href="#9-use-generics-for-reusable-code">9. Use Generics for Reusable Code</a></h3>
<pre><code class="language-typescript">// Generic function
function firstOrNull&lt;T&gt;(arr: T[]): T | null {
  return arr.length &gt; 0 ? arr[0] : null;
}

// Generic constraints
function getProperty&lt;T, K extends keyof T&gt;(obj: T, key: K): T[K] {
  return obj[key];
}
</code></pre>
<h3 id="10-use-utility-types"><a class="header" href="#10-use-utility-types">10. Use Utility Types</a></h3>
<pre><code class="language-typescript">// Instead of manually creating partial types
interface User {
  id: number;
  name: string;
  email: string;
}

// Good: Use Partial utility type
function updateUser(id: number, updates: Partial&lt;User&gt;) {
  // Implementation
}

// Good: Use Pick for selecting specific properties
type UserPreview = Pick&lt;User, "id" | "name"&gt;;

// Good: Use Omit to exclude properties
type UserWithoutId = Omit&lt;User, "id"&gt;;
</code></pre>
<h3 id="11-avoid-type-assertions-when-possible"><a class="header" href="#11-avoid-type-assertions-when-possible">11. Avoid Type Assertions When Possible</a></h3>
<pre><code class="language-typescript">// Bad
const data = JSON.parse(jsonString) as User;

// Good: Validate at runtime
function isUser(data: any): data is User {
  return (
    typeof data === "object" &amp;&amp;
    typeof data.id === "number" &amp;&amp;
    typeof data.name === "string"
  );
}

const data = JSON.parse(jsonString);
if (isUser(data)) {
  // TypeScript knows data is User here
}
</code></pre>
<h3 id="12-use-enum-alternatives"><a class="header" href="#12-use-enum-alternatives">12. Use Enum Alternatives</a></h3>
<pre><code class="language-typescript">// Instead of enum
enum Status {
  Pending,
  Approved,
  Rejected,
}

// Consider union types
type Status = "pending" | "approved" | "rejected";

// Or const objects with 'as const'
const Status = {
  Pending: "pending",
  Approved: "approved",
  Rejected: "rejected",
} as const;

type StatusValue = (typeof Status)[keyof typeof Status];
</code></pre>
<h3 id="13-document-complex-types"><a class="header" href="#13-document-complex-types">13. Document Complex Types</a></h3>
<pre><code class="language-typescript">/**
 * Represents a user in the system
 * @property id - Unique identifier
 * @property name - Full name of the user
 * @property email - Contact email address
 */
interface User {
  id: number;
  name: string;
  email: string;
}

/**
 * Fetches user data from the API
 * @param userId - The ID of the user to fetch
 * @returns Promise resolving to user data
 * @throws {Error} When user is not found
 */
async function fetchUser(userId: number): Promise&lt;User&gt; {
  // Implementation
}
</code></pre>
<h3 id="14-use-namespace-for-organization-sparingly"><a class="header" href="#14-use-namespace-for-organization-sparingly">14. Use Namespace for Organization (Sparingly)</a></h3>
<pre><code class="language-typescript">namespace Validation {
  export interface StringValidator {
    isValid(s: string): boolean;
  }

  export class EmailValidator implements StringValidator {
    isValid(s: string): boolean {
      return /^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/.test(s);
    }
  }
}

const validator = new Validation.EmailValidator();
</code></pre>
<h3 id="15-leverage-tsconfig-paths"><a class="header" href="#15-leverage-tsconfig-paths">15. Leverage TSConfig Paths</a></h3>
<pre><code class="language-json">{
  "compilerOptions": {
    "baseUrl": ".",
    "paths": {
      "@components/*": ["src/components/*"],
      "@utils/*": ["src/utils/*"],
      "@models/*": ["src/models/*"]
    }
  }
}
</code></pre>
<pre><code class="language-typescript">// Instead of
import { Button } from "../../../components/Button";

// Use
import { Button } from "@components/Button";
</code></pre>
<hr />
<h2 id="common-patterns-3"><a class="header" href="#common-patterns-3">Common Patterns</a></h2>
<h3 id="factory-pattern-2"><a class="header" href="#factory-pattern-2">Factory Pattern</a></h3>
<pre><code class="language-typescript">interface Product {
  operation(): string;
}

class ConcreteProductA implements Product {
  operation(): string {
    return "Product A";
  }
}

class ConcreteProductB implements Product {
  operation(): string {
    return "Product B";
  }
}

class ProductFactory {
  createProduct(type: "A" | "B"): Product {
    switch (type) {
      case "A":
        return new ConcreteProductA();
      case "B":
        return new ConcreteProductB();
    }
  }
}
</code></pre>
<h3 id="builder-pattern"><a class="header" href="#builder-pattern">Builder Pattern</a></h3>
<pre><code class="language-typescript">class QueryBuilder {
  private query: string = "";

  select(...fields: string[]): this {
    this.query += `SELECT ${fields.join(", ")} `;
    return this;
  }

  from(table: string): this {
    this.query += `FROM ${table} `;
    return this;
  }

  where(condition: string): this {
    this.query += `WHERE ${condition} `;
    return this;
  }

  build(): string {
    return this.query.trim();
  }
}

const query = new QueryBuilder()
  .select("id", "name")
  .from("users")
  .where("age &gt; 18")
  .build();
</code></pre>
<h3 id="singleton-pattern-2"><a class="header" href="#singleton-pattern-2">Singleton Pattern</a></h3>
<pre><code class="language-typescript">class Database {
  private static instance: Database;
  private connection: any;

  private constructor() {
    // Private constructor prevents instantiation
    this.connection = this.connect();
  }

  private connect() {
    // Connection logic
    return {};
  }

  static getInstance(): Database {
    if (!Database.instance) {
      Database.instance = new Database();
    }
    return Database.instance;
  }

  query(sql: string) {
    // Query logic
  }
}

const db1 = Database.getInstance();
const db2 = Database.getInstance();
console.log(db1 === db2); // true
</code></pre>
<hr />
<h2 id="resources"><a class="header" href="#resources">Resources</a></h2>
<ul>
<li><strong>Official Documentation</strong>: <a href="https://www.typescriptlang.org/docs/">https://www.typescriptlang.org/docs/</a></li>
<li><strong>TypeScript Playground</strong>: <a href="https://www.typescriptlang.org/play">https://www.typescriptlang.org/play</a></li>
<li><strong>Definitely Typed</strong>: <a href="https://github.com/DefinitelyTyped/DefinitelyTyped">https://github.com/DefinitelyTyped/DefinitelyTyped</a></li>
<li><strong>TypeScript Deep Dive</strong>: <a href="https://basarat.gitbook.io/typescript/">https://basarat.gitbook.io/typescript/</a></li>
<li><strong>React TypeScript Cheatsheet</strong>: <a href="https://react-typescript-cheatsheet.netlify.app/">https://react-typescript-cheatsheet.netlify.app/</a></li>
</ul>
<hr />
<p>TypeScript significantly improves the development experience by catching errors early, providing better tooling support, and making code more maintainable. The initial learning curve is worth the long-term benefits, especially for large-scale applications and team projects.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="bash-programming"><a class="header" href="#bash-programming">Bash Programming</a></h1>
<h2 id="overview-5"><a class="header" href="#overview-5">Overview</a></h2>
<p>Bash (Bourne Again SHell) is a Unix shell and command language used for automating tasks, system administration, and scripting. It's the default shell on most Linux distributions and macOS.</p>
<p><strong>Key Features:</strong></p>
<ul>
<li>Command execution and scripting</li>
<li>Text processing and file manipulation</li>
<li>Process control and job management</li>
<li>Environment variable management</li>
<li>Piping and redirection</li>
<li>Pattern matching and globbing</li>
</ul>
<hr />
<h2 id="basic-syntax-3"><a class="header" href="#basic-syntax-3">Basic Syntax</a></h2>
<h3 id="variables-1"><a class="header" href="#variables-1">Variables</a></h3>
<pre><code class="language-bash"># Variable assignment (no spaces around =)
name="Alice"
age=30
readonly PI=3.14159  # Read-only variable

# Accessing variables
echo "Hello, $name"
echo "Hello, ${name}!"  # Recommended for clarity

# Command substitution
current_date=$(date)
current_dir=`pwd`  # Old style, avoid

# Default values
echo "${var:-default}"      # Use default if var is unset
echo "${var:=default}"      # Set var to default if unset
echo "${var:+alternate}"    # Use alternate if var is set
echo "${var:?error message}"  # Error if var is unset

# String length
name="Alice"
echo "${#name}"  # 5

# Substring
echo "${name:0:3}"  # Ali
</code></pre>
<h3 id="data-types-2"><a class="header" href="#data-types-2">Data Types</a></h3>
<pre><code class="language-bash"># Strings
str="Hello World"
str='Single quotes - literal'
str="Double quotes - $variable expansion"

# Arrays
fruits=("apple" "banana" "cherry")
echo "${fruits[0]}"      # apple
echo "${fruits[@]}"      # All elements
echo "${#fruits[@]}"     # Array length
fruits+=("date")         # Append

# Associative arrays (Bash 4+)
declare -A person
person[name]="Alice"
person[age]=30
echo "${person[name]}"

# Integers
declare -i num=42
num=$num+10  # Arithmetic
</code></pre>
<hr />
<h2 id="control-flow-2"><a class="header" href="#control-flow-2">Control Flow</a></h2>
<h3 id="if-statements"><a class="header" href="#if-statements">If Statements</a></h3>
<pre><code class="language-bash"># Basic if
if [ "$age" -gt 18 ]; then
    echo "Adult"
fi

# If-elif-else
if [ "$age" -lt 13 ]; then
    echo "Child"
elif [ "$age" -lt 20 ]; then
    echo "Teenager"
else
    echo "Adult"
fi

# String comparison
if [ "$name" = "Alice" ]; then
    echo "Hello Alice"
fi

if [ "$name" != "Bob" ]; then
    echo "Not Bob"
fi

# File tests
if [ -f "file.txt" ]; then
    echo "File exists"
fi

if [ -d "directory" ]; then
    echo "Directory exists"
fi

if [ -r "file.txt" ]; then
    echo "File is readable"
fi

# Logical operators
if [ "$age" -gt 18 ] &amp;&amp; [ "$age" -lt 65 ]; then
    echo "Working age"
fi

if [ "$age" -lt 18 ] || [ "$age" -gt 65 ]; then
    echo "Not working age"
fi

# Modern test syntax [[ ]]
if [[ "$name" == "Alice" ]]; then
    echo "Hello Alice"
fi

if [[ "$name" =~ ^A ]]; then  # Regex matching
    echo "Name starts with A"
fi
</code></pre>
<h3 id="comparison-operators"><a class="header" href="#comparison-operators">Comparison Operators</a></h3>
<pre><code class="language-bash"># Numeric comparison
[ "$a" -eq "$b" ]  # Equal
[ "$a" -ne "$b" ]  # Not equal
[ "$a" -gt "$b" ]  # Greater than
[ "$a" -ge "$b" ]  # Greater than or equal
[ "$a" -lt "$b" ]  # Less than
[ "$a" -le "$b" ]  # Less than or equal

# String comparison
[ "$a" = "$b" ]    # Equal
[ "$a" != "$b" ]   # Not equal
[ -z "$a" ]        # String is empty
[ -n "$a" ]        # String is not empty

# File tests
[ -e file ]        # Exists
[ -f file ]        # Regular file
[ -d file ]        # Directory
[ -r file ]        # Readable
[ -w file ]        # Writable
[ -x file ]        # Executable
[ -s file ]        # Not empty
[ file1 -nt file2 ]  # file1 newer than file2
[ file1 -ot file2 ]  # file1 older than file2
</code></pre>
<h3 id="loops-2"><a class="header" href="#loops-2">Loops</a></h3>
<pre><code class="language-bash"># For loop
for i in 1 2 3 4 5; do
    echo "$i"
done

# C-style for loop
for ((i=0; i&lt;5; i++)); do
    echo "$i"
done

# For loop with range
for i in {1..10}; do
    echo "$i"
done

# For loop with step
for i in {0..10..2}; do
    echo "$i"  # 0, 2, 4, 6, 8, 10
done

# Iterate over array
fruits=("apple" "banana" "cherry")
for fruit in "${fruits[@]}"; do
    echo "$fruit"
done

# Iterate over files
for file in *.txt; do
    echo "Processing $file"
done

# While loop
count=0
while [ $count -lt 5 ]; do
    echo "$count"
    ((count++))
done

# Read file line by line
while IFS= read -r line; do
    echo "$line"
done &lt; file.txt

# Until loop
count=0
until [ $count -ge 5 ]; do
    echo "$count"
    ((count++))
done

# Break and continue
for i in {1..10}; do
    if [ $i -eq 5 ]; then
        continue  # Skip 5
    fi
    if [ $i -eq 8 ]; then
        break     # Stop at 8
    fi
    echo "$i"
done
</code></pre>
<h3 id="case-statements"><a class="header" href="#case-statements">Case Statements</a></h3>
<pre><code class="language-bash">case "$1" in
    start)
        echo "Starting service..."
        ;;
    stop)
        echo "Stopping service..."
        ;;
    restart)
        echo "Restarting service..."
        ;;
    *)
        echo "Usage: $0 {start|stop|restart}"
        exit 1
        ;;
esac

# Pattern matching in case
case "$filename" in
    *.txt)
        echo "Text file"
        ;;
    *.jpg|*.png)
        echo "Image file"
        ;;
    *)
        echo "Unknown file type"
        ;;
esac
</code></pre>
<hr />
<h2 id="functions-3"><a class="header" href="#functions-3">Functions</a></h2>
<pre><code class="language-bash"># Basic function
greet() {
    echo "Hello, $1!"
}

greet "Alice"  # Hello, Alice!

# Function with return value
add() {
    local result=$(($1 + $2))
    echo "$result"
}

sum=$(add 5 3)
echo "Sum: $sum"

# Function with return code
check_file() {
    if [ -f "$1" ]; then
        return 0  # Success
    else
        return 1  # Failure
    fi
}

if check_file "file.txt"; then
    echo "File exists"
else
    echo "File not found"
fi

# Local variables
my_function() {
    local local_var="I'm local"
    global_var="I'm global"
}

# Function with multiple return values
get_stats() {
    local min=1
    local max=100
    local avg=50
    echo "$min $max $avg"
}

read min max avg &lt;&lt;&lt; $(get_stats)
echo "Min: $min, Max: $max, Avg: $avg"
</code></pre>
<hr />
<h2 id="string-manipulation"><a class="header" href="#string-manipulation">String Manipulation</a></h2>
<pre><code class="language-bash"># Length
str="Hello World"
echo "${#str}"  # 11

# Substring
echo "${str:0:5}"   # Hello
echo "${str:6}"     # World
echo "${str: -5}"   # World (note space before -)

# Replace
echo "${str/World/Universe}"  # Hello Universe (first occurrence)
echo "${str//o/O}"            # HellO WOrld (all occurrences)

# Remove prefix/suffix
filename="example.tar.gz"
echo "${filename#*.}"      # tar.gz (remove shortest prefix)
echo "${filename##*.}"     # gz (remove longest prefix)
echo "${filename%.*}"      # example.tar (remove shortest suffix)
echo "${filename%%.*}"     # example (remove longest suffix)

# Upper/Lower case
str="Hello World"
echo "${str^^}"  # HELLO WORLD
echo "${str,,}"  # hello world
echo "${str^}"   # Hello world (first char upper)

# Trim whitespace
str="  hello  "
str="${str#"${str%%[![:space:]]*}"}"  # Trim left
str="${str%"${str##*[![:space:]]}"}"  # Trim right
</code></pre>
<hr />
<h2 id="inputoutput"><a class="header" href="#inputoutput">Input/Output</a></h2>
<h3 id="reading-input"><a class="header" href="#reading-input">Reading Input</a></h3>
<pre><code class="language-bash"># Read from user
read -p "Enter your name: " name
echo "Hello, $name!"

# Read with timeout
if read -t 5 -p "Enter value (5s timeout): " value; then
    echo "You entered: $value"
else
    echo "Timeout!"
fi

# Read password (hidden)
read -s -p "Enter password: " password
echo

# Read multiple values
read -p "Enter name and age: " name age

# Read into array
IFS=',' read -ra array &lt;&lt;&lt; "apple,banana,cherry"
</code></pre>
<h3 id="output"><a class="header" href="#output">Output</a></h3>
<pre><code class="language-bash"># Echo
echo "Hello World"
echo -n "No newline"
echo -e "Line1\nLine2"  # Enable escape sequences

# Printf (more control)
printf "Name: %s, Age: %d\n" "Alice" 30
printf "%.2f\n" 3.14159  # 3.14

# Here document
cat &lt;&lt; EOF
This is a
multi-line
message
EOF

# Here string
grep "pattern" &lt;&lt;&lt; "string to search"
</code></pre>
<h3 id="redirection"><a class="header" href="#redirection">Redirection</a></h3>
<pre><code class="language-bash"># Output redirection
echo "Hello" &gt; file.txt          # Overwrite
echo "World" &gt;&gt; file.txt         # Append

# Input redirection
while read line; do
    echo "$line"
done &lt; file.txt

# Error redirection
command 2&gt; error.log             # Redirect stderr
command &gt; output.txt 2&gt;&amp;1        # Redirect both stdout and stderr
command &amp;&gt; all_output.txt        # Same as above (Bash 4+)

# Discard output
command &gt; /dev/null 2&gt;&amp;1

# Pipe
cat file.txt | grep "pattern" | sort | uniq

# Tee (write to file and stdout)
echo "Hello" | tee file.txt

# Process substitution
diff &lt;(ls dir1) &lt;(ls dir2)
</code></pre>
<hr />
<h2 id="file-operations"><a class="header" href="#file-operations">File Operations</a></h2>
<pre><code class="language-bash"># Create file
touch file.txt
echo "content" &gt; file.txt

# Copy
cp source.txt dest.txt
cp -r source_dir/ dest_dir/

# Move/Rename
mv old.txt new.txt
mv file.txt directory/

# Delete
rm file.txt
rm -r directory/
rm -f file.txt  # Force delete

# Create directory
mkdir directory
mkdir -p path/to/nested/directory

# Read file
cat file.txt
head -n 10 file.txt  # First 10 lines
tail -n 10 file.txt  # Last 10 lines
tail -f file.txt     # Follow file (live updates)

# File permissions
chmod 755 script.sh      # rwxr-xr-x
chmod +x script.sh       # Add execute permission
chmod u+x script.sh      # User execute
chmod go-w file.txt      # Remove write for group and others

# File ownership
chown user:group file.txt

# Find files
find . -name "*.txt"
find . -type f -name "*.log"
find . -mtime -7  # Modified in last 7 days
find . -size +10M  # Larger than 10MB
</code></pre>
<hr />
<h2 id="process-management"><a class="header" href="#process-management">Process Management</a></h2>
<pre><code class="language-bash"># Run in background
command &amp;

# List jobs
jobs

# Bring to foreground
fg %1

# Send to background
bg %1

# Kill process
kill PID
kill -9 PID  # Force kill
killall process_name

# Process info
ps aux
ps aux | grep process_name
top
htop

# Exit status
command
echo $?  # 0 = success, non-zero = failure

# Conditional execution
command1 &amp;&amp; command2  # command2 runs if command1 succeeds
command1 || command2  # command2 runs if command1 fails
command1 ; command2   # command2 runs regardless

# Wait for process
command &amp;
PID=$!
wait $PID
</code></pre>
<hr />
<h2 id="common-patterns-4"><a class="header" href="#common-patterns-4">Common Patterns</a></h2>
<h3 id="error-handling-2"><a class="header" href="#error-handling-2">Error Handling</a></h3>
<pre><code class="language-bash"># Exit on error
set -e  # Exit if any command fails
set -u  # Exit if undefined variable is used
set -o pipefail  # Exit if any command in pipe fails

# Combined
set -euo pipefail

# Error function
error_exit() {
    echo "ERROR: $1" &gt;&amp;2
    exit 1
}

[ -f "file.txt" ] || error_exit "File not found"

# Trap errors
trap 'echo "Error on line $LINENO"' ERR

# Cleanup on exit
cleanup() {
    rm -f /tmp/tempfile
}
trap cleanup EXIT
</code></pre>
<h3 id="argument-parsing"><a class="header" href="#argument-parsing">Argument Parsing</a></h3>
<pre><code class="language-bash"># Positional arguments
echo "Script: $0"
echo "First arg: $1"
echo "Second arg: $2"
echo "All args: $@"
echo "Number of args: $#"

# Shift arguments
while [ $# -gt 0 ]; do
    echo "$1"
    shift
done

# Parse options
while getopts "a:b:c" opt; do
    case $opt in
        a)
            echo "Option -a: $OPTARG"
            ;;
        b)
            echo "Option -b: $OPTARG"
            ;;
        c)
            echo "Option -c"
            ;;
        \?)
            echo "Invalid option: -$OPTARG"
            exit 1
            ;;
    esac
done

# Long options
while [ $# -gt 0 ]; do
    case "$1" in
        --help)
            echo "Usage: $0 [options]"
            exit 0
            ;;
        --file=*)
            FILE="${1#*=}"
            ;;
        --verbose)
            VERBOSE=1
            ;;
        *)
            echo "Unknown option: $1"
            exit 1
            ;;
    esac
    shift
done
</code></pre>
<h3 id="logging"><a class="header" href="#logging">Logging</a></h3>
<pre><code class="language-bash"># Simple logging
log() {
    echo "[$(date '+%Y-%m-%d %H:%M:%S')] $1"
}

log "Script started"

# Log levels
LOG_LEVEL=${LOG_LEVEL:-INFO}

log_debug() {
    [ "$LOG_LEVEL" = "DEBUG" ] &amp;&amp; echo "[DEBUG] $1"
}

log_info() {
    echo "[INFO] $1"
}

log_error() {
    echo "[ERROR] $1" &gt;&amp;2
}

# Log to file
exec &gt; &gt;(tee -a script.log)
exec 2&gt;&amp;1
</code></pre>
<h3 id="configuration-files"><a class="header" href="#configuration-files">Configuration Files</a></h3>
<pre><code class="language-bash"># Source configuration
CONFIG_FILE="config.sh"
if [ -f "$CONFIG_FILE" ]; then
    source "$CONFIG_FILE"
fi

# config.sh
# DB_HOST="localhost"
# DB_PORT=5432
# DB_NAME="mydb"

# Read key-value pairs
while IFS='=' read -r key value; do
    case "$key" in
        DB_HOST) DB_HOST="$value" ;;
        DB_PORT) DB_PORT="$value" ;;
        DB_NAME) DB_NAME="$value" ;;
    esac
done &lt; config.txt
</code></pre>
<hr />
<h2 id="text-processing"><a class="header" href="#text-processing">Text Processing</a></h2>
<pre><code class="language-bash"># grep (search)
grep "pattern" file.txt
grep -i "pattern" file.txt        # Case insensitive
grep -r "pattern" directory/      # Recursive
grep -v "pattern" file.txt        # Invert match
grep -n "pattern" file.txt        # Show line numbers
grep -c "pattern" file.txt        # Count matches
grep -E "regex" file.txt          # Extended regex

# sed (stream editor)
sed 's/old/new/' file.txt         # Replace first occurrence
sed 's/old/new/g' file.txt        # Replace all
sed -i 's/old/new/g' file.txt     # In-place edit
sed -n '10,20p' file.txt          # Print lines 10-20
sed '/pattern/d' file.txt         # Delete matching lines

# awk (text processing)
awk '{print $1}' file.txt         # Print first column
awk '{print $1, $3}' file.txt     # Print columns 1 and 3
awk -F: '{print $1}' /etc/passwd  # Custom delimiter
awk '$3 &gt; 100' file.txt           # Filter rows
awk '{sum += $1} END {print sum}' file.txt  # Sum column

# cut (extract columns)
cut -d: -f1 /etc/passwd           # Field 1, delimiter :
cut -c1-10 file.txt               # Characters 1-10

# sort
sort file.txt
sort -r file.txt                  # Reverse
sort -n file.txt                  # Numeric sort
sort -k2 file.txt                 # Sort by column 2
sort -u file.txt                  # Unique

# uniq (unique lines)
sort file.txt | uniq              # Remove duplicates
sort file.txt | uniq -c           # Count occurrences
sort file.txt | uniq -d           # Only duplicates

# wc (word count)
wc -l file.txt                    # Line count
wc -w file.txt                    # Word count
wc -c file.txt                    # Byte count

# tr (translate characters)
echo "hello" | tr 'a-z' 'A-Z'     # HELLO
echo "hello123" | tr -d '0-9'     # hello
</code></pre>
<hr />
<h2 id="common-utilities"><a class="header" href="#common-utilities">Common Utilities</a></h2>
<pre><code class="language-bash"># Date and time
date                              # Current date/time
date '+%Y-%m-%d'                  # 2024-01-15
date '+%Y-%m-%d %H:%M:%S'         # 2024-01-15 14:30:00
date -d "yesterday"               # Yesterday's date
date -d "+7 days"                 # Date 7 days from now

# Arithmetic
echo $((5 + 3))                   # 8
echo $((10 / 3))                  # 3 (integer division)
echo "scale=2; 10 / 3" | bc       # 3.33 (bc for floating point)

# Random numbers
echo $RANDOM                      # Random number 0-32767
echo $((RANDOM % 100))            # Random 0-99

# Sleep
sleep 5                           # Sleep 5 seconds
sleep 0.5                         # Sleep 0.5 seconds

# Command existence check
if command -v git &amp;&gt; /dev/null; then
    echo "Git is installed"
fi

# Array operations
arr=(1 2 3 4 5)
echo "${arr[@]}"                  # All elements
echo "${#arr[@]}"                 # Length
echo "${arr[@]:1:3}"              # Slice [1:4]
arr+=(6)                          # Append
</code></pre>
<hr />
<h2 id="best-practices-8"><a class="header" href="#best-practices-8">Best Practices</a></h2>
<ol>
<li><strong>Always quote variables</strong>: <code>"$var"</code> not <code>$var</code></li>
<li><strong>Use <code>set -euo pipefail</code></strong> for safer scripts</li>
<li><strong>Check command existence</strong> before using</li>
<li><strong>Validate input</strong> and arguments</li>
<li><strong>Use functions</strong> for code reuse</li>
<li><strong>Add comments</strong> and documentation</li>
<li><strong>Use meaningful variable names</strong></li>
<li><strong>Handle errors</strong> explicitly</li>
<li><strong>Use <code>[[</code> instead of <code>[</code></strong> for conditions</li>
<li><strong>Avoid parsing <code>ls</code> output</strong> - use globbing or <code>find</code></li>
</ol>
<hr />
<h2 id="script-template"><a class="header" href="#script-template">Script Template</a></h2>
<pre><code class="language-bash">#!/usr/bin/env bash

# Script: script_name.sh
# Description: What this script does
# Author: Your Name
# Date: 2024-01-15

set -euo pipefail  # Exit on error, undefined var, pipe failure

# Constants
readonly SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" &amp;&amp; pwd)"
readonly SCRIPT_NAME="$(basename "$0")"

# Variables
VERBOSE=0
DRY_RUN=0

# Functions
usage() {
    cat &lt;&lt; EOF
Usage: $SCRIPT_NAME [OPTIONS]

Description of what the script does.

OPTIONS:
    -h, --help      Show this help message
    -v, --verbose   Verbose output
    -n, --dry-run   Dry run mode
EOF
}

log_info() {
    echo "[INFO] $*"
}

log_error() {
    echo "[ERROR] $*" &gt;&amp;2
}

cleanup() {
    log_info "Cleaning up..."
    # Cleanup code here
}

main() {
    log_info "Starting script..."

    # Main script logic here

    log_info "Script completed successfully"
}

# Parse arguments
while [[ $# -gt 0 ]]; do
    case $1 in
        -h|--help)
            usage
            exit 0
            ;;
        -v|--verbose)
            VERBOSE=1
            shift
            ;;
        -n|--dry-run)
            DRY_RUN=1
            shift
            ;;
        *)
            log_error "Unknown option: $1"
            usage
            exit 1
            ;;
    esac
done

# Trap cleanup on exit
trap cleanup EXIT

# Run main function
main "$@"
</code></pre>
<hr />
<h2 id="common-use-cases"><a class="header" href="#common-use-cases">Common Use Cases</a></h2>
<h3 id="backup-script"><a class="header" href="#backup-script">Backup Script</a></h3>
<pre><code class="language-bash">#!/bin/bash

BACKUP_DIR="/backup"
SOURCE_DIR="/data"
DATE=$(date +%Y%m%d_%H%M%S)
BACKUP_FILE="backup_${DATE}.tar.gz"

tar -czf "${BACKUP_DIR}/${BACKUP_FILE}" "${SOURCE_DIR}"
echo "Backup created: ${BACKUP_FILE}"

# Keep only last 7 backups
cd "${BACKUP_DIR}"
ls -t backup_*.tar.gz | tail -n +8 | xargs -r rm
</code></pre>
<h3 id="system-monitoring"><a class="header" href="#system-monitoring">System Monitoring</a></h3>
<pre><code class="language-bash">#!/bin/bash

CPU_THRESHOLD=80
DISK_THRESHOLD=90

# Check CPU usage
CPU_USAGE=$(top -bn1 | grep "Cpu(s)" | awk '{print $2}' | cut -d'%' -f1)
if (( $(echo "$CPU_USAGE &gt; $CPU_THRESHOLD" | bc -l) )); then
    echo "WARNING: CPU usage is ${CPU_USAGE}%"
fi

# Check disk usage
df -H | grep -vE '^Filesystem|tmpfs|cdrom' | awk '{print $5 " " $1}' | while read output; do
    usage=$(echo $output | awk '{print $1}' | sed 's/%//g')
    partition=$(echo $output | awk '{print $2}')
    if [ $usage -ge $DISK_THRESHOLD ]; then
        echo "WARNING: Disk usage on $partition is ${usage}%"
    fi
done
</code></pre>
<hr />
<h2 id="useful-resources"><a class="header" href="#useful-resources">Useful Resources</a></h2>
<ul>
<li><strong>ShellCheck</strong>: Linter for shell scripts</li>
<li><strong>Bash Manual</strong>: <code>man bash</code></li>
<li><strong>Bash Guide</strong>: https://mywiki.wooledge.org/BashGuide</li>
<li><strong>Explainshell</strong>: Explain shell commands (explainshell.com)</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="java-programming"><a class="header" href="#java-programming">Java Programming</a></h1>
<h2 id="overview-6"><a class="header" href="#overview-6">Overview</a></h2>
<p>Java is a high-level, class-based, object-oriented programming language designed to have minimal implementation dependencies. It follows the "write once, run anywhere" (WORA) principle.</p>
<p><strong>Key Features:</strong></p>
<ul>
<li>Platform independent (runs on JVM)</li>
<li>Object-oriented programming</li>
<li>Automatic memory management (Garbage Collection)</li>
<li>Strong type system</li>
<li>Rich standard library</li>
<li>Multi-threading support</li>
</ul>
<hr />
<h2 id="basic-syntax-4"><a class="header" href="#basic-syntax-4">Basic Syntax</a></h2>
<h3 id="variables-and-data-types-1"><a class="header" href="#variables-and-data-types-1">Variables and Data Types</a></h3>
<pre><code class="language-java">// Primitive types
byte b = 127;           // 8-bit
short s = 32767;        // 16-bit
int i = 2147483647;     // 32-bit
long l = 9223372036854775807L;  // 64-bit
float f = 3.14f;        // 32-bit floating point
double d = 3.14159;     // 64-bit floating point
boolean bool = true;    // true or false
char c = 'A';           // 16-bit Unicode

// Reference types
String str = "Hello, World!";
Integer num = 42;  // Wrapper class

// Type conversion
int x = (int) 3.14;  // Explicit casting
double y = 10;       // Implicit casting

// Constants
final double PI = 3.14159;
final int MAX_SIZE = 100;
</code></pre>
<h3 id="string-operations"><a class="header" href="#string-operations">String Operations</a></h3>
<pre><code class="language-java">// String creation
String s1 = "Hello";
String s2 = new String("World");

// String methods
int length = s1.length();
char ch = s1.charAt(0);
String sub = s1.substring(0, 3);
String upper = s1.toUpperCase();
String lower = s1.toLowerCase();
boolean startsWith = s1.startsWith("He");
boolean contains = s1.contains("ll");

// String comparison
boolean equals = s1.equals(s2);
boolean equalsIgnoreCase = s1.equalsIgnoreCase(s2);
int compare = s1.compareTo(s2);

// String concatenation
String full = s1 + " " + s2;
String joined = String.join(", ", "a", "b", "c");

// String formatting
String formatted = String.format("Name: %s, Age: %d", "Alice", 30);

// StringBuilder (mutable)
StringBuilder sb = new StringBuilder();
sb.append("Hello");
sb.append(" World");
String result = sb.toString();
</code></pre>
<hr />
<h2 id="arrays-and-collections"><a class="header" href="#arrays-and-collections">Arrays and Collections</a></h2>
<h3 id="arrays-2"><a class="header" href="#arrays-2">Arrays</a></h3>
<pre><code class="language-java">// Array declaration
int[] numbers = new int[5];
int[] nums = {1, 2, 3, 4, 5};
String[] names = {"Alice", "Bob", "Charlie"};

// Accessing elements
int first = nums[0];
nums[2] = 10;

// Array length
int length = nums.length;

// Multi-dimensional arrays
int[][] matrix = new int[3][3];
int[][] grid = {{1, 2}, {3, 4}, {5, 6}};

// Arrays utility class
import java.util.Arrays;

Arrays.sort(nums);                    // Sort array
int index = Arrays.binarySearch(nums, 5);  // Binary search
int[] copy = Arrays.copyOf(nums, nums.length);  // Copy
boolean equal = Arrays.equals(nums, copy);  // Compare
String str = Arrays.toString(nums);   // Convert to string
</code></pre>
<h3 id="arraylist"><a class="header" href="#arraylist">ArrayList</a></h3>
<pre><code class="language-java">import java.util.ArrayList;

// Creating ArrayList
ArrayList&lt;String&gt; list = new ArrayList&lt;&gt;();
ArrayList&lt;Integer&gt; numbers = new ArrayList&lt;&gt;(Arrays.asList(1, 2, 3));

// Adding elements
list.add("Apple");
list.add(0, "Banana");  // Add at index
list.addAll(Arrays.asList("Cherry", "Date"));

// Accessing elements
String first = list.get(0);
list.set(1, "Blueberry");

// Removing elements
list.remove(0);
list.remove("Apple");
list.clear();

// Operations
int size = list.size();
boolean empty = list.isEmpty();
boolean contains = list.contains("Apple");
int index = list.indexOf("Apple");

// Iteration
for (String item : list) {
    System.out.println(item);
}

list.forEach(item -&gt; System.out.println(item));
</code></pre>
<h3 id="hashmap"><a class="header" href="#hashmap">HashMap</a></h3>
<pre><code class="language-java">import java.util.HashMap;
import java.util.Map;

// Creating HashMap
HashMap&lt;String, Integer&gt; map = new HashMap&lt;&gt;();

// Adding elements
map.put("Alice", 25);
map.put("Bob", 30);
map.putIfAbsent("Charlie", 35);

// Accessing elements
int age = map.get("Alice");
int defaultAge = map.getOrDefault("David", 0);

// Removing elements
map.remove("Bob");

// Operations
int size = map.size();
boolean empty = map.isEmpty();
boolean hasKey = map.containsKey("Alice");
boolean hasValue = map.containsValue(25);

// Iteration
for (Map.Entry&lt;String, Integer&gt; entry : map.entrySet()) {
    System.out.println(entry.getKey() + ": " + entry.getValue());
}

map.forEach((key, value) -&gt;
    System.out.println(key + ": " + value));
</code></pre>
<hr />
<h2 id="control-flow-3"><a class="header" href="#control-flow-3">Control Flow</a></h2>
<h3 id="if-else"><a class="header" href="#if-else">If-Else</a></h3>
<pre><code class="language-java">int age = 18;

if (age &lt; 13) {
    System.out.println("Child");
} else if (age &lt; 20) {
    System.out.println("Teenager");
} else {
    System.out.println("Adult");
}

// Ternary operator
String status = (age &gt;= 18) ? "Adult" : "Minor";
</code></pre>
<h3 id="switch"><a class="header" href="#switch">Switch</a></h3>
<pre><code class="language-java">// Traditional switch
int day = 3;
switch (day) {
    case 1:
        System.out.println("Monday");
        break;
    case 2:
        System.out.println("Tuesday");
        break;
    default:
        System.out.println("Other day");
}

// Switch expression (Java 14+)
String dayName = switch (day) {
    case 1 -&gt; "Monday";
    case 2 -&gt; "Tuesday";
    case 3 -&gt; "Wednesday";
    default -&gt; "Other day";
};
</code></pre>
<h3 id="loops-3"><a class="header" href="#loops-3">Loops</a></h3>
<pre><code class="language-java">// For loop
for (int i = 0; i &lt; 5; i++) {
    System.out.println(i);
}

// Enhanced for loop
int[] numbers = {1, 2, 3, 4, 5};
for (int num : numbers) {
    System.out.println(num);
}

// While loop
int count = 0;
while (count &lt; 5) {
    System.out.println(count);
    count++;
}

// Do-while loop
int i = 0;
do {
    System.out.println(i);
    i++;
} while (i &lt; 5);

// Break and continue
for (int j = 0; j &lt; 10; j++) {
    if (j == 5) continue;  // Skip 5
    if (j == 8) break;     // Stop at 8
    System.out.println(j);
}
</code></pre>
<hr />
<h2 id="object-oriented-programming-1"><a class="header" href="#object-oriented-programming-1">Object-Oriented Programming</a></h2>
<h3 id="classes-and-objects-1"><a class="header" href="#classes-and-objects-1">Classes and Objects</a></h3>
<pre><code class="language-java">public class Person {
    // Fields (instance variables)
    private String name;
    private int age;

    // Static field (class variable)
    private static int count = 0;

    // Constructor
    public Person(String name, int age) {
        this.name = name;
        this.age = age;
        count++;
    }

    // Default constructor
    public Person() {
        this("Unknown", 0);
    }

    // Getters and setters
    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public int getAge() {
        return age;
    }

    public void setAge(int age) {
        if (age &gt;= 0) {
            this.age = age;
        }
    }

    // Instance method
    public void greet() {
        System.out.println("Hello, I'm " + name);
    }

    // Static method
    public static int getCount() {
        return count;
    }

    // toString method
    @Override
    public String toString() {
        return "Person{name='" + name + "', age=" + age + "}";
    }
}

// Usage
Person person = new Person("Alice", 30);
person.greet();
System.out.println(person.toString());
</code></pre>
<h3 id="inheritance-3"><a class="header" href="#inheritance-3">Inheritance</a></h3>
<pre><code class="language-java">// Base class
public class Animal {
    protected String name;

    public Animal(String name) {
        this.name = name;
    }

    public void speak() {
        System.out.println(name + " makes a sound");
    }
}

// Derived class
public class Dog extends Animal {
    private String breed;

    public Dog(String name, String breed) {
        super(name);  // Call parent constructor
        this.breed = breed;
    }

    @Override
    public void speak() {
        System.out.println(name + " barks");
    }

    public void fetch() {
        System.out.println(name + " is fetching");
    }
}

// Usage
Dog dog = new Dog("Buddy", "Golden Retriever");
dog.speak();   // "Buddy barks"
dog.fetch();   // "Buddy is fetching"
</code></pre>
<h3 id="interfaces-1"><a class="header" href="#interfaces-1">Interfaces</a></h3>
<pre><code class="language-java">// Interface definition
public interface Drawable {
    void draw();  // Abstract method

    // Default method (Java 8+)
    default void display() {
        System.out.println("Displaying...");
    }

    // Static method (Java 8+)
    static void info() {
        System.out.println("Drawable interface");
    }
}

// Implementation
public class Circle implements Drawable {
    private double radius;

    public Circle(double radius) {
        this.radius = radius;
    }

    @Override
    public void draw() {
        System.out.println("Drawing circle with radius " + radius);
    }
}

// Multiple interfaces
public class Square implements Drawable, Comparable&lt;Square&gt; {
    private double side;

    public Square(double side) {
        this.side = side;
    }

    @Override
    public void draw() {
        System.out.println("Drawing square with side " + side);
    }

    @Override
    public int compareTo(Square other) {
        return Double.compare(this.side, other.side);
    }
}
</code></pre>
<h3 id="abstract-classes-1"><a class="header" href="#abstract-classes-1">Abstract Classes</a></h3>
<pre><code class="language-java">public abstract class Shape {
    protected String color;

    public Shape(String color) {
        this.color = color;
    }

    // Abstract method
    public abstract double area();

    // Concrete method
    public void setColor(String color) {
        this.color = color;
    }

    public String getColor() {
        return color;
    }
}

public class Rectangle extends Shape {
    private double width;
    private double height;

    public Rectangle(String color, double width, double height) {
        super(color);
        this.width = width;
        this.height = height;
    }

    @Override
    public double area() {
        return width * height;
    }
}
</code></pre>
<hr />
<h2 id="exception-handling"><a class="header" href="#exception-handling">Exception Handling</a></h2>
<pre><code class="language-java">// Try-catch
try {
    int result = 10 / 0;
} catch (ArithmeticException e) {
    System.out.println("Cannot divide by zero!");
}

// Multiple catch blocks
try {
    int[] arr = new int[5];
    arr[10] = 50;
} catch (ArrayIndexOutOfBoundsException e) {
    System.out.println("Array index out of bounds");
} catch (Exception e) {
    System.out.println("General exception: " + e.getMessage());
}

// Finally block
try {
    // Code that may throw exception
} catch (Exception e) {
    e.printStackTrace();
} finally {
    System.out.println("This always executes");
}

// Try-with-resources (Java 7+)
try (BufferedReader br = new BufferedReader(new FileReader("file.txt"))) {
    String line = br.readLine();
} catch (IOException e) {
    e.printStackTrace();
}

// Throwing exceptions
public void checkAge(int age) throws IllegalArgumentException {
    if (age &lt; 0) {
        throw new IllegalArgumentException("Age cannot be negative");
    }
}

// Custom exception
public class InvalidAgeException extends Exception {
    public InvalidAgeException(String message) {
        super(message);
    }
}
</code></pre>
<hr />
<h2 id="streams-and-lambdas-java-8"><a class="header" href="#streams-and-lambdas-java-8">Streams and Lambdas (Java 8+)</a></h2>
<h3 id="lambda-expressions"><a class="header" href="#lambda-expressions">Lambda Expressions</a></h3>
<pre><code class="language-java">// Functional interface
@FunctionalInterface
interface Calculator {
    int calculate(int a, int b);
}

// Lambda expression
Calculator add = (a, b) -&gt; a + b;
Calculator multiply = (a, b) -&gt; a * b;

System.out.println(add.calculate(5, 3));      // 8
System.out.println(multiply.calculate(5, 3)); // 15

// With collections
List&lt;String&gt; names = Arrays.asList("Alice", "Bob", "Charlie");
names.forEach(name -&gt; System.out.println(name));

// Method reference
names.forEach(System.out::println);
</code></pre>
<h3 id="streams"><a class="header" href="#streams">Streams</a></h3>
<pre><code class="language-java">import java.util.stream.*;

List&lt;Integer&gt; numbers = Arrays.asList(1, 2, 3, 4, 5, 6, 7, 8, 9, 10);

// Filter
List&lt;Integer&gt; evens = numbers.stream()
    .filter(n -&gt; n % 2 == 0)
    .collect(Collectors.toList());

// Map
List&lt;Integer&gt; squared = numbers.stream()
    .map(n -&gt; n * n)
    .collect(Collectors.toList());

// Reduce
int sum = numbers.stream()
    .reduce(0, (a, b) -&gt; a + b);

// Find
Optional&lt;Integer&gt; first = numbers.stream()
    .filter(n -&gt; n &gt; 5)
    .findFirst();

// Any/All match
boolean anyEven = numbers.stream().anyMatch(n -&gt; n % 2 == 0);
boolean allPositive = numbers.stream().allMatch(n -&gt; n &gt; 0);

// Sorted
List&lt;Integer&gt; sorted = numbers.stream()
    .sorted()
    .collect(Collectors.toList());

// Limit and skip
List&lt;Integer&gt; limited = numbers.stream()
    .limit(5)
    .collect(Collectors.toList());

// Chaining operations
List&lt;String&gt; result = Arrays.asList("apple", "banana", "cherry", "date")
    .stream()
    .filter(s -&gt; s.length() &gt; 5)
    .map(String::toUpperCase)
    .sorted()
    .collect(Collectors.toList());
</code></pre>
<hr />
<h2 id="common-patterns-5"><a class="header" href="#common-patterns-5">Common Patterns</a></h2>
<h3 id="singleton"><a class="header" href="#singleton">Singleton</a></h3>
<pre><code class="language-java">public class Singleton {
    private static Singleton instance;

    private Singleton() {
        // Private constructor
    }

    public static Singleton getInstance() {
        if (instance == null) {
            instance = new Singleton();
        }
        return instance;
    }
}

// Thread-safe singleton
public class ThreadSafeSingleton {
    private static volatile ThreadSafeSingleton instance;

    private ThreadSafeSingleton() {}

    public static ThreadSafeSingleton getInstance() {
        if (instance == null) {
            synchronized (ThreadSafeSingleton.class) {
                if (instance == null) {
                    instance = new ThreadSafeSingleton();
                }
            }
        }
        return instance;
    }
}
</code></pre>
<h3 id="factory-pattern-3"><a class="header" href="#factory-pattern-3">Factory Pattern</a></h3>
<pre><code class="language-java">interface Animal {
    void speak();
}

class Dog implements Animal {
    public void speak() {
        System.out.println("Woof!");
    }
}

class Cat implements Animal {
    public void speak() {
        System.out.println("Meow!");
    }
}

class AnimalFactory {
    public static Animal createAnimal(String type) {
        if (type.equals("dog")) {
            return new Dog();
        } else if (type.equals("cat")) {
            return new Cat();
        }
        throw new IllegalArgumentException("Unknown animal type");
    }
}

// Usage
Animal animal = AnimalFactory.createAnimal("dog");
animal.speak();
</code></pre>
<h3 id="builder-pattern-1"><a class="header" href="#builder-pattern-1">Builder Pattern</a></h3>
<pre><code class="language-java">public class User {
    private final String firstName;
    private final String lastName;
    private final int age;
    private final String email;

    private User(UserBuilder builder) {
        this.firstName = builder.firstName;
        this.lastName = builder.lastName;
        this.age = builder.age;
        this.email = builder.email;
    }

    public static class UserBuilder {
        private String firstName;
        private String lastName;
        private int age;
        private String email;

        public UserBuilder(String firstName, String lastName) {
            this.firstName = firstName;
            this.lastName = lastName;
        }

        public UserBuilder age(int age) {
            this.age = age;
            return this;
        }

        public UserBuilder email(String email) {
            this.email = email;
            return this;
        }

        public User build() {
            return new User(this);
        }
    }
}

// Usage
User user = new User.UserBuilder("Alice", "Smith")
    .age(30)
    .email("alice@example.com")
    .build();
</code></pre>
<hr />
<h2 id="file-io-1"><a class="header" href="#file-io-1">File I/O</a></h2>
<pre><code class="language-java">import java.io.*;
import java.nio.file.*;

// Reading file
try (BufferedReader br = new BufferedReader(new FileReader("file.txt"))) {
    String line;
    while ((line = br.readLine()) != null) {
        System.out.println(line);
    }
} catch (IOException e) {
    e.printStackTrace();
}

// Writing file
try (BufferedWriter bw = new BufferedWriter(new FileWriter("file.txt"))) {
    bw.write("Hello, World!");
    bw.newLine();
    bw.write("Second line");
} catch (IOException e) {
    e.printStackTrace();
}

// Using Files class (Java 7+)
try {
    // Read all lines
    List&lt;String&gt; lines = Files.readAllLines(Paths.get("file.txt"));

    // Write lines
    Files.write(Paths.get("output.txt"),
                Arrays.asList("Line 1", "Line 2"));

    // Copy file
    Files.copy(Paths.get("source.txt"), Paths.get("dest.txt"));

    // Delete file
    Files.delete(Paths.get("file.txt"));
} catch (IOException e) {
    e.printStackTrace();
}
</code></pre>
<hr />
<h2 id="best-practices-9"><a class="header" href="#best-practices-9">Best Practices</a></h2>
<ol>
<li>
<p><strong>Follow naming conventions</strong></p>
<ul>
<li>Classes: PascalCase (<code>MyClass</code>)</li>
<li>Methods/variables: camelCase (<code>myMethod</code>)</li>
<li>Constants: UPPER_SNAKE_CASE (<code>MAX_SIZE</code>)</li>
</ul>
</li>
<li>
<p><strong>Use meaningful names</strong></p>
<pre><code class="language-java">// Good
int studentCount = 50;

// Bad
int sc = 50;
</code></pre>
</li>
<li>
<p><strong>Keep methods small</strong> - One responsibility per method</p>
</li>
<li>
<p><strong>Use StringBuilder</strong> for string concatenation in loops</p>
</li>
<li>
<p><strong>Close resources</strong> - Use try-with-resources</p>
</li>
<li>
<p><strong>Handle exceptions properly</strong> - Don't swallow exceptions</p>
</li>
<li>
<p><strong>Use generics</strong> for type safety</p>
</li>
<li>
<p><strong>Follow SOLID principles</strong></p>
</li>
<li>
<p><strong>Use Optional</strong> to avoid null checks (Java 8+)</p>
<pre><code class="language-java">Optional&lt;String&gt; optional = Optional.ofNullable(getValue());
String value = optional.orElse("default");
</code></pre>
</li>
<li>
<p><strong>Use streams</strong> for collection processing (Java 8+)</p>
</li>
</ol>
<hr />
<h2 id="common-librariesframeworks-1"><a class="header" href="#common-librariesframeworks-1">Common Libraries/Frameworks</a></h2>
<ul>
<li><strong>Spring Boot</strong>: Application framework</li>
<li><strong>Hibernate</strong>: ORM framework</li>
<li><strong>JUnit</strong>: Testing framework</li>
<li><strong>Maven/Gradle</strong>: Build tools</li>
<li><strong>Jackson</strong>: JSON processing</li>
<li><strong>Log4j/SLF4J</strong>: Logging</li>
<li><strong>Apache Commons</strong>: Utility libraries</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="go-programming"><a class="header" href="#go-programming">Go Programming</a></h1>
<h2 id="overview-7"><a class="header" href="#overview-7">Overview</a></h2>
<p>Go (Golang) is a statically typed, compiled programming language designed at Google. It's known for its simplicity, efficiency, and excellent support for concurrent programming.</p>
<p><strong>Key Features:</strong></p>
<ul>
<li>Fast compilation and execution</li>
<li>Built-in concurrency (goroutines and channels)</li>
<li>Garbage collection</li>
<li>Strong static typing with type inference</li>
<li>Simple and clean syntax</li>
<li>Excellent standard library</li>
<li>Cross-platform compilation</li>
</ul>
<hr />
<h2 id="basic-syntax-5"><a class="header" href="#basic-syntax-5">Basic Syntax</a></h2>
<h3 id="variables-and-data-types-2"><a class="header" href="#variables-and-data-types-2">Variables and Data Types</a></h3>
<pre><code class="language-go">package main

import "fmt"

func main() {
    // Variable declaration
    var name string = "Alice"
    var age int = 30

    // Short declaration (type inference)
    city := "NYC"
    isActive := true

    // Multiple declarations
    var x, y, z int = 1, 2, 3
    a, b := 10, 20

    // Constants
    const PI = 3.14159
    const MaxSize = 100

    // Zero values (default values)
    var num int        // 0
    var str string     // ""
    var flag bool      // false
    var ptr *int       // nil

    fmt.Println(name, age, city, isActive)
}
</code></pre>
<h3 id="data-types-3"><a class="header" href="#data-types-3">Data Types</a></h3>
<pre><code class="language-go">// Basic types
var i int = 42           // Platform-dependent (32 or 64 bit)
var i8 int8 = 127        // 8-bit
var i16 int16 = 32767    // 16-bit
var i32 int32 = 2147483647  // 32-bit (rune alias)
var i64 int64 = 9223372036854775807  // 64-bit

var u uint = 42          // Unsigned, platform-dependent
var u8 uint8 = 255       // 8-bit (byte alias)

var f32 float32 = 3.14   // 32-bit float
var f64 float64 = 3.14159  // 64-bit float

var c64 complex64 = 1 + 2i
var c128 complex128 = 1 + 2i

var b bool = true
var r rune = 'A'         // Unicode code point (int32)
var by byte = 65         // Alias for uint8

var str string = "Hello, 世界"

// Type conversion
var x int = 42
var y float64 = float64(x)
var z uint = uint(x)
</code></pre>
<h3 id="strings"><a class="header" href="#strings">Strings</a></h3>
<pre><code class="language-go">// String operations
s1 := "Hello"
s2 := "World"

// Concatenation
full := s1 + " " + s2

// Length (bytes, not runes)
length := len(s1)

// Accessing bytes
firstByte := s1[0]

// Substrings
sub := s1[1:4]  // "ell"

// String comparison
if s1 == s2 {
    fmt.Println("Equal")
}

// Multi-line strings
multiline := `This is a
multi-line
string`

// String iteration
for i, char := range "Hello" {
    fmt.Printf("%d: %c\n", i, char)
}

// String formatting
import "fmt"
formatted := fmt.Sprintf("Name: %s, Age: %d", "Alice", 30)

// String conversion
import "strconv"
numStr := strconv.Itoa(42)        // int to string
num, err := strconv.Atoi("42")    // string to int
</code></pre>
<hr />
<h2 id="arrays-and-slices"><a class="header" href="#arrays-and-slices">Arrays and Slices</a></h2>
<h3 id="arrays-3"><a class="header" href="#arrays-3">Arrays</a></h3>
<pre><code class="language-go">// Fixed-size arrays
var arr [5]int
arr[0] = 1

// Array literal
numbers := [5]int{1, 2, 3, 4, 5}

// Compiler counts length
auto := [...]int{1, 2, 3, 4}

// Multi-dimensional arrays
matrix := [3][3]int{
    {1, 2, 3},
    {4, 5, 6},
    {7, 8, 9},
}

// Array length
length := len(numbers)

// Iterate over array
for i, v := range numbers {
    fmt.Printf("%d: %d\n", i, v)
}
</code></pre>
<h3 id="slices-dynamic-arrays"><a class="header" href="#slices-dynamic-arrays">Slices (Dynamic Arrays)</a></h3>
<pre><code class="language-go">// Creating slices
var slice []int                    // nil slice
slice = []int{1, 2, 3, 4, 5}      // slice literal
slice = make([]int, 5)             // length 5, all zeros
slice = make([]int, 5, 10)         // length 5, capacity 10

// Append to slice
slice = append(slice, 6)
slice = append(slice, 7, 8, 9)

// Slice operations
arr := []int{1, 2, 3, 4, 5}
sub := arr[1:4]        // [2, 3, 4]
first := arr[:3]       // [1, 2, 3]
last := arr[3:]        // [4, 5]

// Length and capacity
len := len(slice)
cap := cap(slice)

// Copy slices
src := []int{1, 2, 3}
dst := make([]int, len(src))
copy(dst, src)

// 2D slices
matrix := [][]int{
    {1, 2, 3},
    {4, 5, 6},
}

// Iterate
for i, v := range slice {
    fmt.Printf("%d: %d\n", i, v)
}
</code></pre>
<hr />
<h2 id="maps"><a class="header" href="#maps">Maps</a></h2>
<pre><code class="language-go">// Creating maps
var m map[string]int               // nil map
m = make(map[string]int)           // empty map
m = map[string]int{                // map literal
    "Alice": 25,
    "Bob":   30,
}

// Adding/updating elements
m["Charlie"] = 35
m["Alice"] = 26

// Accessing elements
age := m["Alice"]

// Check if key exists
age, ok := m["Alice"]
if ok {
    fmt.Println("Alice's age:", age)
}

// Delete element
delete(m, "Bob")

// Iterate over map
for key, value := range m {
    fmt.Printf("%s: %d\n", key, value)
}

// Map length
size := len(m)

// Nested maps
nested := map[string]map[string]int{
    "group1": {
        "Alice": 25,
        "Bob":   30,
    },
    "group2": {
        "Charlie": 35,
    },
}
</code></pre>
<hr />
<h2 id="control-flow-4"><a class="header" href="#control-flow-4">Control Flow</a></h2>
<h3 id="if-else-1"><a class="header" href="#if-else-1">If-Else</a></h3>
<pre><code class="language-go">age := 18

if age &lt; 13 {
    fmt.Println("Child")
} else if age &lt; 20 {
    fmt.Println("Teenager")
} else {
    fmt.Println("Adult")
}

// If with initialization
if num := 42; num &gt; 0 {
    fmt.Println("Positive")
}

// Error checking pattern
if err := someFunction(); err != nil {
    fmt.Println("Error:", err)
}
</code></pre>
<h3 id="switch-1"><a class="header" href="#switch-1">Switch</a></h3>
<pre><code class="language-go">// Basic switch
day := 3
switch day {
case 1:
    fmt.Println("Monday")
case 2:
    fmt.Println("Tuesday")
case 3:
    fmt.Println("Wednesday")
default:
    fmt.Println("Other day")
}

// Multiple cases
switch day {
case 1, 2, 3, 4, 5:
    fmt.Println("Weekday")
case 6, 7:
    fmt.Println("Weekend")
}

// Switch with condition
num := 42
switch {
case num &lt; 0:
    fmt.Println("Negative")
case num == 0:
    fmt.Println("Zero")
case num &gt; 0:
    fmt.Println("Positive")
}

// Type switch
var i interface{} = "hello"
switch v := i.(type) {
case string:
    fmt.Println("String:", v)
case int:
    fmt.Println("Int:", v)
default:
    fmt.Println("Unknown type")
}
</code></pre>
<h3 id="loops-4"><a class="header" href="#loops-4">Loops</a></h3>
<pre><code class="language-go">// For loop (only loop in Go)
for i := 0; i &lt; 5; i++ {
    fmt.Println(i)
}

// While-style loop
count := 0
for count &lt; 5 {
    fmt.Println(count)
    count++
}

// Infinite loop
for {
    fmt.Println("Forever")
    break  // Exit loop
}

// Range over slice
numbers := []int{1, 2, 3, 4, 5}
for i, v := range numbers {
    fmt.Printf("%d: %d\n", i, v)
}

// Range over map
m := map[string]int{"a": 1, "b": 2}
for key, value := range m {
    fmt.Printf("%s: %d\n", key, value)
}

// Ignore index/value with _
for _, v := range numbers {
    fmt.Println(v)
}

// Break and continue
for i := 0; i &lt; 10; i++ {
    if i == 5 {
        continue
    }
    if i == 8 {
        break
    }
    fmt.Println(i)
}
</code></pre>
<hr />
<h2 id="functions-4"><a class="header" href="#functions-4">Functions</a></h2>
<h3 id="basic-functions-1"><a class="header" href="#basic-functions-1">Basic Functions</a></h3>
<pre><code class="language-go">// Simple function
func greet(name string) {
    fmt.Println("Hello,", name)
}

// Function with return value
func add(a, b int) int {
    return a + b
}

// Multiple parameters of same type
func multiply(a, b, c int) int {
    return a * b * c
}

// Multiple return values
func swap(a, b string) (string, string) {
    return b, a
}

// Named return values
func divide(a, b float64) (result float64, err error) {
    if b == 0 {
        err = fmt.Errorf("division by zero")
        return
    }
    result = a / b
    return  // Naked return
}

// Variadic functions
func sum(numbers ...int) int {
    total := 0
    for _, num := range numbers {
        total += num
    }
    return total
}

// Usage
result := sum(1, 2, 3, 4, 5)
</code></pre>
<h3 id="anonymous-functions-and-closures"><a class="header" href="#anonymous-functions-and-closures">Anonymous Functions and Closures</a></h3>
<pre><code class="language-go">// Anonymous function
add := func(a, b int) int {
    return a + b
}
result := add(5, 3)

// Immediately invoked function
result := func(a, b int) int {
    return a + b
}(5, 3)

// Closure
func counter() func() int {
    count := 0
    return func() int {
        count++
        return count
    }
}

c := counter()
fmt.Println(c())  // 1
fmt.Println(c())  // 2
fmt.Println(c())  // 3
</code></pre>
<h3 id="defer"><a class="header" href="#defer">Defer</a></h3>
<pre><code class="language-go">// Defer executes at function end
func example() {
    defer fmt.Println("World")
    fmt.Println("Hello")
}
// Output: Hello
//         World

// Multiple defers (LIFO order)
func multiDefer() {
    defer fmt.Println("1")
    defer fmt.Println("2")
    defer fmt.Println("3")
}
// Output: 3, 2, 1

// Common pattern: cleanup
func readFile(filename string) error {
    f, err := os.Open(filename)
    if err != nil {
        return err
    }
    defer f.Close()

    // Work with file
    return nil
}
</code></pre>
<hr />
<h2 id="structs-and-methods"><a class="header" href="#structs-and-methods">Structs and Methods</a></h2>
<h3 id="structs"><a class="header" href="#structs">Structs</a></h3>
<pre><code class="language-go">// Define struct
type Person struct {
    Name string
    Age  int
    Email string
}

// Create struct
p1 := Person{
    Name:  "Alice",
    Age:   30,
    Email: "alice@example.com",
}

// Short form
p2 := Person{"Bob", 25, "bob@example.com"}

// Anonymous struct
person := struct {
    name string
    age  int
}{
    name: "Charlie",
    age:  35,
}

// Accessing fields
fmt.Println(p1.Name)
p1.Age = 31

// Pointer to struct
p := &amp;Person{Name: "Alice", Age: 30}
p.Age = 31  // Automatic dereferencing

// Embedded structs
type Address struct {
    City    string
    Country string
}

type Employee struct {
    Person   // Embedded struct
    Address  // Embedded struct
    Salary   float64
}

emp := Employee{
    Person:  Person{Name: "Alice", Age: 30},
    Address: Address{City: "NYC", Country: "USA"},
    Salary:  100000,
}

// Access embedded fields
fmt.Println(emp.Name)  // From Person
fmt.Println(emp.City)  // From Address
</code></pre>
<h3 id="methods"><a class="header" href="#methods">Methods</a></h3>
<pre><code class="language-go">// Method on struct
type Rectangle struct {
    Width  float64
    Height float64
}

// Value receiver
func (r Rectangle) Area() float64 {
    return r.Width * r.Height
}

// Pointer receiver (can modify)
func (r *Rectangle) Scale(factor float64) {
    r.Width *= factor
    r.Height *= factor
}

// Usage
rect := Rectangle{Width: 10, Height: 5}
area := rect.Area()
rect.Scale(2)

// Method on any type
type MyInt int

func (m MyInt) Double() MyInt {
    return m * 2
}

num := MyInt(5)
result := num.Double()  // 10
</code></pre>
<hr />
<h2 id="interfaces-2"><a class="header" href="#interfaces-2">Interfaces</a></h2>
<pre><code class="language-go">// Define interface
type Shape interface {
    Area() float64
    Perimeter() float64
}

// Implement interface (implicit)
type Circle struct {
    Radius float64
}

func (c Circle) Area() float64 {
    return 3.14159 * c.Radius * c.Radius
}

func (c Circle) Perimeter() float64 {
    return 2 * 3.14159 * c.Radius
}

type Rectangle struct {
    Width, Height float64
}

func (r Rectangle) Area() float64 {
    return r.Width * r.Height
}

func (r Rectangle) Perimeter() float64 {
    return 2 * (r.Width + r.Height)
}

// Use interface
func printArea(s Shape) {
    fmt.Printf("Area: %.2f\n", s.Area())
}

// Usage
c := Circle{Radius: 5}
r := Rectangle{Width: 10, Height: 5}

printArea(c)
printArea(r)

// Empty interface (any type)
func printAnything(v interface{}) {
    fmt.Println(v)
}

printAnything(42)
printAnything("hello")
printAnything(true)

// Type assertion
var i interface{} = "hello"
s := i.(string)
s, ok := i.(string)  // Safe type assertion

// Type switch
switch v := i.(type) {
case string:
    fmt.Println("String:", v)
case int:
    fmt.Println("Int:", v)
default:
    fmt.Println("Unknown")
}
</code></pre>
<hr />
<h2 id="concurrency"><a class="header" href="#concurrency">Concurrency</a></h2>
<h3 id="goroutines"><a class="header" href="#goroutines">Goroutines</a></h3>
<pre><code class="language-go">// Start goroutine
go func() {
    fmt.Println("Hello from goroutine")
}()

// Multiple goroutines
for i := 0; i &lt; 5; i++ {
    go func(n int) {
        fmt.Println("Goroutine", n)
    }(i)
}

// Wait for goroutines
import "sync"

var wg sync.WaitGroup

for i := 0; i &lt; 5; i++ {
    wg.Add(1)
    go func(n int) {
        defer wg.Done()
        fmt.Println("Worker", n)
    }(i)
}

wg.Wait()
</code></pre>
<h3 id="channels"><a class="header" href="#channels">Channels</a></h3>
<pre><code class="language-go">// Create channel
ch := make(chan int)

// Buffered channel
ch := make(chan int, 5)

// Send to channel
go func() {
    ch &lt;- 42
}()

// Receive from channel
value := &lt;-ch

// Close channel
close(ch)

// Range over channel
go func() {
    for i := 0; i &lt; 5; i++ {
        ch &lt;- i
    }
    close(ch)
}()

for value := range ch {
    fmt.Println(value)
}

// Select statement
ch1 := make(chan string)
ch2 := make(chan string)

go func() {
    ch1 &lt;- "from ch1"
}()

go func() {
    ch2 &lt;- "from ch2"
}()

select {
case msg1 := &lt;-ch1:
    fmt.Println(msg1)
case msg2 := &lt;-ch2:
    fmt.Println(msg2)
case &lt;-time.After(1 * time.Second):
    fmt.Println("timeout")
}
</code></pre>
<h3 id="sync-package"><a class="header" href="#sync-package">Sync Package</a></h3>
<pre><code class="language-go">import "sync"

// Mutex
var (
    mu    sync.Mutex
    count int
)

func increment() {
    mu.Lock()
    defer mu.Unlock()
    count++
}

// RWMutex (multiple readers, single writer)
var (
    rwMu sync.RWMutex
    data map[string]int
)

func read(key string) int {
    rwMu.RLock()
    defer rwMu.RUnlock()
    return data[key]
}

func write(key string, value int) {
    rwMu.Lock()
    defer rwMu.Unlock()
    data[key] = value
}

// Once (execute only once)
var once sync.Once

func initialize() {
    once.Do(func() {
        fmt.Println("Initialized")
    })
}
</code></pre>
<hr />
<h2 id="error-handling-3"><a class="header" href="#error-handling-3">Error Handling</a></h2>
<pre><code class="language-go">import "errors"
import "fmt"

// Return error
func divide(a, b float64) (float64, error) {
    if b == 0 {
        return 0, errors.New("division by zero")
    }
    return a / b, nil
}

// Formatted error
func validateAge(age int) error {
    if age &lt; 0 {
        return fmt.Errorf("invalid age: %d", age)
    }
    return nil
}

// Custom error type
type ValidationError struct {
    Field string
    Value interface{}
}

func (e *ValidationError) Error() string {
    return fmt.Sprintf("validation error: %s = %v", e.Field, e.Value)
}

// Error handling pattern
result, err := divide(10, 0)
if err != nil {
    fmt.Println("Error:", err)
    return
}
fmt.Println("Result:", result)

// Panic and recover
func riskyOperation() {
    defer func() {
        if r := recover(); r != nil {
            fmt.Println("Recovered from panic:", r)
        }
    }()

    panic("something went wrong")
}
</code></pre>
<hr />
<h2 id="packages-and-imports"><a class="header" href="#packages-and-imports">Packages and Imports</a></h2>
<pre><code class="language-go">// Package declaration
package main

// Import single package
import "fmt"

// Import multiple packages
import (
    "fmt"
    "math"
    "strings"
)

// Aliased import
import f "fmt"
f.Println("Hello")

// Blank import (side effects)
import _ "database/sql/driver"

// Creating a package
// mypackage/mypackage.go
package mypackage

// Exported (capitalized)
func PublicFunction() {
    fmt.Println("Public")
}

// Not exported (lowercase)
func privateFunction() {
    fmt.Println("Private")
}

// Using the package
import "myproject/mypackage"

mypackage.PublicFunction()
</code></pre>
<hr />
<h2 id="file-io-2"><a class="header" href="#file-io-2">File I/O</a></h2>
<pre><code class="language-go">import (
    "bufio"
    "fmt"
    "io/ioutil"
    "os"
)

// Read entire file
data, err := ioutil.ReadFile("file.txt")
if err != nil {
    panic(err)
}
fmt.Println(string(data))

// Write file
err = ioutil.WriteFile("output.txt", []byte("Hello"), 0644)

// Open file
file, err := os.Open("file.txt")
if err != nil {
    panic(err)
}
defer file.Close()

// Read line by line
scanner := bufio.NewScanner(file)
for scanner.Scan() {
    fmt.Println(scanner.Text())
}

// Write to file
file, err := os.Create("output.txt")
if err != nil {
    panic(err)
}
defer file.Close()

writer := bufio.NewWriter(file)
writer.WriteString("Hello, World!\n")
writer.Flush()
</code></pre>
<hr />
<h2 id="common-patterns-6"><a class="header" href="#common-patterns-6">Common Patterns</a></h2>
<h3 id="singleton-1"><a class="header" href="#singleton-1">Singleton</a></h3>
<pre><code class="language-go">import "sync"

type singleton struct {
    data string
}

var (
    instance *singleton
    once     sync.Once
)

func GetInstance() *singleton {
    once.Do(func() {
        instance = &amp;singleton{data: "singleton"}
    })
    return instance
}
</code></pre>
<h3 id="factory-pattern-4"><a class="header" href="#factory-pattern-4">Factory Pattern</a></h3>
<pre><code class="language-go">type Animal interface {
    Speak() string
}

type Dog struct{}
func (d Dog) Speak() string { return "Woof!" }

type Cat struct{}
func (c Cat) Speak() string { return "Meow!" }

func NewAnimal(animalType string) Animal {
    switch animalType {
    case "dog":
        return Dog{}
    case "cat":
        return Cat{}
    default:
        return nil
    }
}
</code></pre>
<h3 id="builder-pattern-2"><a class="header" href="#builder-pattern-2">Builder Pattern</a></h3>
<pre><code class="language-go">type User struct {
    firstName string
    lastName  string
    age       int
    email     string
}

type UserBuilder struct {
    user User
}

func NewUserBuilder() *UserBuilder {
    return &amp;UserBuilder{}
}

func (b *UserBuilder) FirstName(name string) *UserBuilder {
    b.user.firstName = name
    return b
}

func (b *UserBuilder) LastName(name string) *UserBuilder {
    b.user.lastName = name
    return b
}

func (b *UserBuilder) Age(age int) *UserBuilder {
    b.user.age = age
    return b
}

func (b *UserBuilder) Email(email string) *UserBuilder {
    b.user.email = email
    return b
}

func (b *UserBuilder) Build() User {
    return b.user
}

// Usage
user := NewUserBuilder().
    FirstName("Alice").
    LastName("Smith").
    Age(30).
    Email("alice@example.com").
    Build()
</code></pre>
<hr />
<h2 id="testing"><a class="header" href="#testing">Testing</a></h2>
<pre><code class="language-go">// main.go
package main

func Add(a, b int) int {
    return a + b
}

// main_test.go
package main

import "testing"

func TestAdd(t *testing.T) {
    result := Add(2, 3)
    expected := 5

    if result != expected {
        t.Errorf("Add(2, 3) = %d; want %d", result, expected)
    }
}

func TestAddNegative(t *testing.T) {
    result := Add(-1, -1)
    expected := -2

    if result != expected {
        t.Errorf("Add(-1, -1) = %d; want %d", result, expected)
    }
}

// Table-driven tests
func TestAddTable(t *testing.T) {
    tests := []struct {
        a, b, expected int
    }{
        {1, 2, 3},
        {0, 0, 0},
        {-1, 1, 0},
        {10, 20, 30},
    }

    for _, tt := range tests {
        result := Add(tt.a, tt.b)
        if result != tt.expected {
            t.Errorf("Add(%d, %d) = %d; want %d",
                tt.a, tt.b, result, tt.expected)
        }
    }
}

// Run tests: go test
// Run with coverage: go test -cover
</code></pre>
<hr />
<h2 id="best-practices-10"><a class="header" href="#best-practices-10">Best Practices</a></h2>
<ol>
<li>
<p><strong>Use gofmt</strong> - Format code automatically</p>
<pre><code class="language-bash">gofmt -w .
</code></pre>
</li>
<li>
<p><strong>Use golint</strong> - Check code style</p>
<pre><code class="language-bash">golint ./...
</code></pre>
</li>
<li>
<p><strong>Error handling</strong> - Always check errors</p>
<pre><code class="language-go">if err != nil {
    return err
}
</code></pre>
</li>
<li>
<p><strong>Use interfaces</strong> - Program to interfaces, not implementations</p>
</li>
<li>
<p><strong>Prefer composition</strong> over inheritance</p>
</li>
<li>
<p><strong>Keep functions small</strong> - Single responsibility</p>
</li>
<li>
<p><strong>Use meaningful names</strong> - Clear and descriptive</p>
</li>
<li>
<p><strong>Document exported items</strong> - Comments for public API</p>
<pre><code class="language-go">// Add returns the sum of two integers.
func Add(a, b int) int {
    return a + b
}
</code></pre>
</li>
<li>
<p><strong>Use context</strong> for cancellation and timeouts</p>
<pre><code class="language-go">ctx, cancel := context.WithTimeout(context.Background(), 5*time.Second)
defer cancel()
</code></pre>
</li>
<li>
<p><strong>Avoid global state</strong> - Pass dependencies explicitly</p>
</li>
</ol>
<hr />
<h2 id="common-libraries-1"><a class="header" href="#common-libraries-1">Common Libraries</a></h2>
<ul>
<li><strong>gorilla/mux</strong>: HTTP router</li>
<li><strong>gin</strong>: Web framework</li>
<li><strong>gorm</strong>: ORM</li>
<li><strong>viper</strong>: Configuration</li>
<li><strong>cobra</strong>: CLI applications</li>
<li><strong>logrus</strong>: Logging</li>
<li><strong>testify</strong>: Testing toolkit</li>
<li><strong>zap</strong>: Fast logging</li>
<li><strong>grpc</strong>: RPC framework</li>
<li><strong>redis</strong>: Redis client</li>
</ul>
<hr />
<h2 id="go-modules"><a class="header" href="#go-modules">Go Modules</a></h2>
<pre><code class="language-bash"># Initialize module
go mod init github.com/username/project

# Add dependency
go get github.com/gin-gonic/gin

# Update dependencies
go get -u

# Tidy dependencies
go mod tidy

# Vendor dependencies
go mod vendor
</code></pre>
<hr />
<h2 id="useful-commands"><a class="header" href="#useful-commands">Useful Commands</a></h2>
<pre><code class="language-bash"># Run program
go run main.go

# Build executable
go build

# Install binary
go install

# Format code
go fmt ./...

# Run tests
go test ./...

# Get dependencies
go get package

# Show documentation
go doc fmt.Println
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="lua-programming"><a class="header" href="#lua-programming">Lua Programming</a></h1>
<h2 id="overview-8"><a class="header" href="#overview-8">Overview</a></h2>
<p>Lua is a lightweight, high-level, multi-paradigm programming language designed primarily for embedded use in applications. It's known for its simplicity, efficiency, and powerful data description constructs.</p>
<p><strong>Key Features:</strong></p>
<ul>
<li>Lightweight and embeddable</li>
<li>Fast execution</li>
<li>Simple and clean syntax</li>
<li>Dynamic typing</li>
<li>Automatic memory management (garbage collection)</li>
<li>First-class functions</li>
<li>Powerful table data structure</li>
<li>Coroutines for concurrency</li>
</ul>
<p><strong>Common Uses:</strong></p>
<ul>
<li>Game scripting (World of Warcraft, Roblox)</li>
<li>Embedded systems</li>
<li>Configuration files</li>
<li>Application scripting</li>
<li>Web development (OpenResty)</li>
</ul>
<hr />
<h2 id="basic-syntax-6"><a class="header" href="#basic-syntax-6">Basic Syntax</a></h2>
<h3 id="variables-and-data-types-3"><a class="header" href="#variables-and-data-types-3">Variables and Data Types</a></h3>
<pre><code class="language-lua">-- Variables (global by default)
name = "Alice"
age = 30
pi = 3.14159

-- Local variables (recommended)
local x = 10
local y = 20

-- Multiple assignment
local a, b, c = 1, 2, 3

-- Swap variables
a, b = b, a

-- Nil (undefined/null)
local nothing = nil

-- Comments
-- Single line comment

--[[
    Multi-line
    comment
]]

-- Data types
local num = 42              -- number
local str = "Hello"         -- string
local bool = true           -- boolean
local tbl = {1, 2, 3}      -- table
local func = function() end -- function
local thread = coroutine.create(function() end)  -- thread
local nothing = nil         -- nil

-- Type checking
print(type(num))    -- number
print(type(str))    -- string
print(type(bool))   -- boolean
print(type(tbl))    -- table
print(type(func))   -- function
</code></pre>
<h3 id="strings-1"><a class="header" href="#strings-1">Strings</a></h3>
<pre><code class="language-lua">-- String creation
local s1 = "Hello"
local s2 = 'World'
local s3 = [[Multi-line
string]]

-- String concatenation
local full = s1 .. " " .. s2

-- String length
local len = #s1
local len2 = string.len(s1)

-- String methods
local upper = string.upper(s1)          -- "HELLO"
local lower = string.lower(s1)          -- "hello"
local sub = string.sub(s1, 1, 3)        -- "Hel"
local find = string.find(s1, "ll")      -- 3, 4
local replace = string.gsub(s1, "l", "L")  -- "HeLLo"

-- String formatting
local formatted = string.format("Name: %s, Age: %d", "Alice", 30)

-- String to number
local num = tonumber("42")
local str = tostring(42)

-- String repetition
local repeated = string.rep("Ha", 3)  -- "HaHaHa"

-- Pattern matching (similar to regex)
local match = string.match("Hello123", "%d+")  -- "123"

-- Iterate characters
for i = 1, #s1 do
    local char = string.sub(s1, i, i)
    print(char)
end
</code></pre>
<hr />
<h2 id="tables"><a class="header" href="#tables">Tables</a></h2>
<p>Tables are the only data structure in Lua - they can represent arrays, dictionaries, objects, and more.</p>
<h3 id="arrays-1-indexed"><a class="header" href="#arrays-1-indexed">Arrays (1-indexed)</a></h3>
<pre><code class="language-lua">-- Array creation
local arr = {10, 20, 30, 40, 50}

-- Accessing elements (1-indexed!)
print(arr[1])  -- 10

-- Modifying elements
arr[1] = 15

-- Array length
local len = #arr

-- Append to array
table.insert(arr, 60)        -- Append to end
table.insert(arr, 2, 25)     -- Insert at position 2

-- Remove from array
local last = table.remove(arr)      -- Remove last
local second = table.remove(arr, 2) -- Remove at position 2

-- Iterate array
for i = 1, #arr do
    print(i, arr[i])
end

-- Iterate with ipairs
for i, v in ipairs(arr) do
    print(i, v)
end

-- Table functions
table.sort(arr)                      -- Sort ascending
table.sort(arr, function(a, b) return a &gt; b end)  -- Sort descending
local str = table.concat(arr, ", ")  -- Join with separator
</code></pre>
<h3 id="dictionariesmaps"><a class="header" href="#dictionariesmaps">Dictionaries/Maps</a></h3>
<pre><code class="language-lua">-- Dictionary creation
local person = {
    name = "Alice",
    age = 30,
    city = "NYC"
}

-- Alternative syntax
local person2 = {
    ["name"] = "Bob",
    ["age"] = 25
}

-- Accessing elements
print(person.name)       -- Dot notation
print(person["age"])     -- Bracket notation

-- Adding/modifying
person.email = "alice@example.com"
person["phone"] = "123-456-7890"

-- Removing
person.email = nil

-- Iterate dictionary
for key, value in pairs(person) do
    print(key, value)
end

-- Check if key exists
if person.name then
    print("Name exists")
end

-- Nested tables
local nested = {
    user = {
        name = "Alice",
        address = {
            city = "NYC",
            country = "USA"
        }
    }
}

print(nested.user.address.city)
</code></pre>
<h3 id="mixed-tables"><a class="header" href="#mixed-tables">Mixed Tables</a></h3>
<pre><code class="language-lua">-- Table with both array and dictionary parts
local mixed = {
    "first",      -- [1] = "first"
    "second",     -- [2] = "second"
    name = "Alice",
    age = 30
}

print(mixed[1])      -- "first"
print(mixed.name)    -- "Alice"

-- Length only counts array part
print(#mixed)        -- 2
</code></pre>
<hr />
<h2 id="control-flow-5"><a class="header" href="#control-flow-5">Control Flow</a></h2>
<h3 id="if-else-2"><a class="header" href="#if-else-2">If-Else</a></h3>
<pre><code class="language-lua">local age = 18

if age &lt; 13 then
    print("Child")
elseif age &lt; 20 then
    print("Teenager")
else
    print("Adult")
end

-- Logical operators: and, or, not
if age &gt;= 18 and age &lt; 65 then
    print("Working age")
end

if age &lt; 18 or age &gt; 65 then
    print("Not working age")
end

if not (age &lt; 18) then
    print("Adult")
end

-- Ternary-like operator
local status = age &gt;= 18 and "Adult" or "Minor"
</code></pre>
<h3 id="loops-5"><a class="header" href="#loops-5">Loops</a></h3>
<pre><code class="language-lua">-- While loop
local count = 0
while count &lt; 5 do
    print(count)
    count = count + 1
end

-- Repeat-until loop (do-while)
local i = 0
repeat
    print(i)
    i = i + 1
until i &gt;= 5

-- For loop (numeric)
for i = 1, 5 do
    print(i)  -- 1, 2, 3, 4, 5
end

-- For loop with step
for i = 0, 10, 2 do
    print(i)  -- 0, 2, 4, 6, 8, 10
end

-- For loop (reverse)
for i = 5, 1, -1 do
    print(i)  -- 5, 4, 3, 2, 1
end

-- Iterate array with ipairs
local arr = {10, 20, 30, 40, 50}
for i, v in ipairs(arr) do
    print(i, v)
end

-- Iterate table with pairs
local person = {name = "Alice", age = 30}
for key, value in pairs(person) do
    print(key, value)
end

-- Break
for i = 1, 10 do
    if i == 5 then
        break
    end
    print(i)
end

-- No continue in Lua (use goto in Lua 5.2+)
for i = 1, 10 do
    if i == 5 then
        goto continue
    end
    print(i)
    ::continue::
end
</code></pre>
<hr />
<h2 id="functions-5"><a class="header" href="#functions-5">Functions</a></h2>
<pre><code class="language-lua">-- Basic function
function greet(name)
    print("Hello, " .. name)
end

greet("Alice")

-- Function with return value
function add(a, b)
    return a + b
end

local result = add(5, 3)

-- Multiple return values
function swap(a, b)
    return b, a
end

local x, y = swap(10, 20)

-- Default parameters (manual)
function greet(name)
    name = name or "World"
    print("Hello, " .. name)
end

-- Variable arguments
function sum(...)
    local total = 0
    for _, v in ipairs({...}) do
        total = total + v
    end
    return total
end

print(sum(1, 2, 3, 4, 5))  -- 15

-- Anonymous functions
local add = function(a, b)
    return a + b
end

-- Function as argument
function applyOperation(a, b, operation)
    return operation(a, b)
end

local result = applyOperation(5, 3, function(x, y)
    return x * y
end)

-- Closures
function counter()
    local count = 0
    return function()
        count = count + 1
        return count
    end
end

local c = counter()
print(c())  -- 1
print(c())  -- 2
print(c())  -- 3

-- Local functions
local function helper()
    print("Helper function")
end

-- Recursive functions need forward declaration
local factorial
factorial = function(n)
    if n &lt;= 1 then
        return 1
    else
        return n * factorial(n - 1)
    end
end
</code></pre>
<hr />
<h2 id="object-oriented-programming-2"><a class="header" href="#object-oriented-programming-2">Object-Oriented Programming</a></h2>
<p>Lua doesn't have built-in classes, but tables and metatables provide OOP features.</p>
<h3 id="tables-as-objects"><a class="header" href="#tables-as-objects">Tables as Objects</a></h3>
<pre><code class="language-lua">-- Simple object
local person = {
    name = "Alice",
    age = 30,

    greet = function(self)
        print("Hello, I'm " .. self.name)
    end
}

person:greet()  -- Colon syntax passes self automatically
-- Equivalent to: person.greet(person)
</code></pre>
<h3 id="metatables-and-classes"><a class="header" href="#metatables-and-classes">Metatables and Classes</a></h3>
<pre><code class="language-lua">-- Define a class
local Person = {}
Person.__index = Person

-- Constructor
function Person:new(name, age)
    local instance = setmetatable({}, Person)
    instance.name = name
    instance.age = age
    return instance
end

-- Methods
function Person:greet()
    print("Hello, I'm " .. self.name)
end

function Person:getAge()
    return self.age
end

function Person:setAge(age)
    self.age = age
end

-- Usage
local alice = Person:new("Alice", 30)
alice:greet()
print(alice:getAge())

-- Inheritance
local Employee = setmetatable({}, {__index = Person})
Employee.__index = Employee

function Employee:new(name, age, salary)
    local instance = Person:new(name, age)
    setmetatable(instance, Employee)
    instance.salary = salary
    return instance
end

function Employee:getSalary()
    return self.salary
end

-- Usage
local emp = Employee:new("Bob", 25, 50000)
emp:greet()  -- Inherited from Person
print(emp:getSalary())

-- Operator overloading
local Vector = {}
Vector.__index = Vector

function Vector:new(x, y)
    return setmetatable({x = x, y = y}, Vector)
end

-- Overload addition
Vector.__add = function(a, b)
    return Vector:new(a.x + b.x, a.y + b.y)
end

-- Overload tostring
Vector.__tostring = function(v)
    return "(" .. v.x .. ", " .. v.y .. ")"
end

local v1 = Vector:new(1, 2)
local v2 = Vector:new(3, 4)
local v3 = v1 + v2
print(v3)  -- (4, 6)
</code></pre>
<hr />
<h2 id="modules"><a class="header" href="#modules">Modules</a></h2>
<pre><code class="language-lua">-- mymodule.lua
local M = {}

-- Private function
local function private()
    print("Private")
end

-- Public function
function M.public()
    print("Public")
end

function M.add(a, b)
    return a + b
end

return M

-- main.lua
local mymodule = require("mymodule")
mymodule.public()
local result = mymodule.add(5, 3)
</code></pre>
<hr />
<h2 id="error-handling-4"><a class="header" href="#error-handling-4">Error Handling</a></h2>
<pre><code class="language-lua">-- pcall (protected call)
local success, result = pcall(function()
    return 10 / 0
end)

if success then
    print("Result:", result)
else
    print("Error:", result)
end

-- Error with message
function divide(a, b)
    if b == 0 then
        error("Division by zero")
    end
    return a / b
end

local success, result = pcall(divide, 10, 0)
if not success then
    print("Error:", result)
end

-- Assert
local function checkPositive(n)
    assert(n &gt; 0, "Number must be positive")
    return n
end

-- xpcall (with error handler)
local function errorHandler(err)
    print("Error occurred:", err)
    return err
end

local success, result = xpcall(function()
    error("Something went wrong")
end, errorHandler)
</code></pre>
<hr />
<h2 id="file-io-3"><a class="header" href="#file-io-3">File I/O</a></h2>
<pre><code class="language-lua">-- Read entire file
local file = io.open("input.txt", "r")
if file then
    local content = file:read("*all")
    print(content)
    file:close()
end

-- Read line by line
local file = io.open("input.txt", "r")
if file then
    for line in file:lines() do
        print(line)
    end
    file:close()
end

-- Write file
local file = io.open("output.txt", "w")
if file then
    file:write("Hello, World!\n")
    file:write("Second line\n")
    file:close()
end

-- Append to file
local file = io.open("output.txt", "a")
if file then
    file:write("Appended line\n")
    file:close()
end

-- Using io.input and io.output
io.input("input.txt")
local content = io.read("*all")
io.close()

io.output("output.txt")
io.write("Hello\n")
io.close()
</code></pre>
<hr />
<h2 id="coroutines"><a class="header" href="#coroutines">Coroutines</a></h2>
<pre><code class="language-lua">-- Create coroutine
local co = coroutine.create(function()
    for i = 1, 5 do
        print("Coroutine:", i)
        coroutine.yield()  -- Pause execution
    end
end)

-- Resume coroutine
coroutine.resume(co)  -- Prints 1
coroutine.resume(co)  -- Prints 2
coroutine.resume(co)  -- Prints 3

-- Check status
print(coroutine.status(co))  -- suspended or running or dead

-- Producer-consumer pattern
local function producer()
    return coroutine.create(function()
        for i = 1, 5 do
            coroutine.yield(i)
        end
    end)
end

local function consumer(prod)
    while true do
        local status, value = coroutine.resume(prod)
        if not status then break end
        print("Received:", value)
    end
end

consumer(producer())
</code></pre>
<hr />
<h2 id="common-patterns-7"><a class="header" href="#common-patterns-7">Common Patterns</a></h2>
<h3 id="singleton-pattern-3"><a class="header" href="#singleton-pattern-3">Singleton Pattern</a></h3>
<pre><code class="language-lua">local Singleton = {}
local instance

function Singleton:getInstance()
    if not instance then
        instance = {data = "singleton"}
    end
    return instance
end

local s1 = Singleton:getInstance()
local s2 = Singleton:getInstance()
print(s1 == s2)  -- true
</code></pre>
<h3 id="factory-pattern-5"><a class="header" href="#factory-pattern-5">Factory Pattern</a></h3>
<pre><code class="language-lua">local AnimalFactory = {}

function AnimalFactory:create(animalType)
    if animalType == "dog" then
        return {speak = function() return "Woof!" end}
    elseif animalType == "cat" then
        return {speak = function() return "Meow!" end}
    end
end

local dog = AnimalFactory:create("dog")
print(dog.speak())
</code></pre>
<h3 id="observer-pattern-1"><a class="header" href="#observer-pattern-1">Observer Pattern</a></h3>
<pre><code class="language-lua">local Subject = {}
Subject.__index = Subject

function Subject:new()
    return setmetatable({observers = {}}, Subject)
end

function Subject:attach(observer)
    table.insert(self.observers, observer)
end

function Subject:detach(observer)
    for i, obs in ipairs(self.observers) do
        if obs == observer then
            table.remove(self.observers, i)
            break
        end
    end
end

function Subject:notify(data)
    for _, observer in ipairs(self.observers) do
        observer:update(data)
    end
end

-- Observer
local Observer = {}
Observer.__index = Observer

function Observer:new(name)
    return setmetatable({name = name}, Observer)
end

function Observer:update(data)
    print(self.name .. " received: " .. data)
end

-- Usage
local subject = Subject:new()
local obs1 = Observer:new("Observer1")
local obs2 = Observer:new("Observer2")

subject:attach(obs1)
subject:attach(obs2)
subject:notify("Event occurred!")
</code></pre>
<hr />
<h2 id="standard-library"><a class="header" href="#standard-library">Standard Library</a></h2>
<pre><code class="language-lua">-- Math
print(math.pi)
print(math.abs(-5))
print(math.floor(3.7))
print(math.ceil(3.2))
print(math.max(1, 5, 3))
print(math.min(1, 5, 3))
print(math.random())        -- Random [0, 1)
print(math.random(10))      -- Random [1, 10]
print(math.random(5, 10))   -- Random [5, 10]

-- String
print(string.upper("hello"))
print(string.lower("HELLO"))
print(string.reverse("hello"))

-- Table
local arr = {3, 1, 4, 1, 5}
table.sort(arr)
print(table.concat(arr, ", "))

-- OS
print(os.time())
print(os.date("%Y-%m-%d %H:%M:%S"))
os.execute("ls")  -- Execute shell command

-- Pairs / IPairs
local t = {10, 20, 30, x = 1, y = 2}
for k, v in pairs(t) do   -- All elements
    print(k, v)
end
for i, v in ipairs(t) do  -- Only array part
    print(i, v)
end
</code></pre>
<hr />
<h2 id="best-practices-11"><a class="header" href="#best-practices-11">Best Practices</a></h2>
<ol>
<li>
<p><strong>Use local variables</strong> - Faster and avoids global pollution</p>
<pre><code class="language-lua">local x = 10  -- Good
x = 10        -- Bad (global)
</code></pre>
</li>
<li>
<p><strong>Prefer ipairs for arrays</strong> - More efficient than pairs</p>
</li>
<li>
<p><strong>Use metatables</strong> for OOP and operator overloading</p>
</li>
<li>
<p><strong>Always close files</strong> after use</p>
</li>
<li>
<p><strong>Use pcall</strong> for error handling in production</p>
</li>
<li>
<p><strong>Avoid goto</strong> - Use structured control flow</p>
</li>
<li>
<p><strong>Use string.format</strong> for complex string formatting</p>
</li>
<li>
<p><strong>Cache table lookups</strong> in loops</p>
<pre><code class="language-lua">local insert = table.insert
for i = 1, 1000 do
    insert(arr, i)
end
</code></pre>
</li>
<li>
<p><strong>Use semicolons sparingly</strong> - Optional in Lua</p>
</li>
<li>
<p><strong>Follow naming conventions</strong></p>
<ul>
<li>Variables: snake_case</li>
<li>Constants: UPPER_CASE</li>
<li>Functions: camelCase or snake_case</li>
</ul>
</li>
</ol>
<hr />
<h2 id="common-use-cases-1"><a class="header" href="#common-use-cases-1">Common Use Cases</a></h2>
<h3 id="configuration-files-1"><a class="header" href="#configuration-files-1">Configuration Files</a></h3>
<pre><code class="language-lua">-- config.lua
return {
    database = {
        host = "localhost",
        port = 5432,
        name = "mydb"
    },
    server = {
        port = 8080,
        workers = 4
    }
}

-- Load config
local config = require("config")
print(config.database.host)
</code></pre>
<h3 id="game-scripting"><a class="header" href="#game-scripting">Game Scripting</a></h3>
<pre><code class="language-lua">-- Define enemy
local Enemy = {}
Enemy.__index = Enemy

function Enemy:new(name, health, damage)
    return setmetatable({
        name = name,
        health = health,
        damage = damage
    }, Enemy)
end

function Enemy:attack(target)
    target.health = target.health - self.damage
    print(self.name .. " attacks " .. target.name)
end

function Enemy:isAlive()
    return self.health &gt; 0
end
</code></pre>
<hr />
<h2 id="lua-versions"><a class="header" href="#lua-versions">Lua Versions</a></h2>
<ul>
<li><strong>Lua 5.1</strong>: Widely used in games (WoW, Roblox)</li>
<li><strong>Lua 5.2</strong>: Added <code>goto</code>, <code>_ENV</code></li>
<li><strong>Lua 5.3</strong>: Integer subtype, bitwise operators</li>
<li><strong>Lua 5.4</strong>: To-be-closed variables, const variables</li>
<li><strong>LuaJIT</strong>: JIT compiler, very fast (used in OpenResty)</li>
</ul>
<hr />
<h2 id="useful-libraries"><a class="header" href="#useful-libraries">Useful Libraries</a></h2>
<ul>
<li><strong>LuaSocket</strong>: Networking</li>
<li><strong>LuaFileSystem</strong>: File system operations</li>
<li><strong>Penlight</strong>: Extended standard library</li>
<li><strong>LÖVE</strong>: Game framework</li>
<li><strong>OpenResty</strong>: Web platform (Nginx + Lua)</li>
<li><strong>LuaRocks</strong>: Package manager</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rust-programming"><a class="header" href="#rust-programming">Rust Programming</a></h1>
<h2 id="overview-9"><a class="header" href="#overview-9">Overview</a></h2>
<p>Rust is a systems programming language focused on safety, speed, and concurrency. It achieves memory safety without garbage collection through its ownership system.</p>
<p><strong>Key Features:</strong></p>
<ul>
<li>Memory safety without garbage collection</li>
<li>Zero-cost abstractions</li>
<li>Ownership and borrowing system</li>
<li>Guaranteed thread safety</li>
<li>Pattern matching</li>
<li>Type inference</li>
<li>Powerful macro system</li>
<li>Excellent tooling (cargo, rustfmt, clippy)</li>
</ul>
<hr />
<h2 id="basic-syntax-7"><a class="header" href="#basic-syntax-7">Basic Syntax</a></h2>
<h3 id="variables-and-data-types-4"><a class="header" href="#variables-and-data-types-4">Variables and Data Types</a></h3>
<pre><pre class="playground"><code class="language-rust">fn main() {
    // Immutable by default
    let x = 5;
    // x = 6; // Error! Cannot mutate immutable variable

    // Mutable variable
    let mut y = 5;
    y = 6; // OK

    // Constants (must have type annotation)
    const MAX_POINTS: u32 = 100_000;

    // Shadowing (redefining variable)
    let x = 5;
    let x = x + 1;
    let x = x * 2; // x is now 12

    // Type annotation
    let guess: u32 = "42".parse().expect("Not a number!");

    // Scalar types
    let integer: i32 = 42;
    let float: f64 = 3.14;
    let boolean: bool = true;
    let character: char = 'A';

    // Integer types: i8, i16, i32, i64, i128, isize
    // Unsigned: u8, u16, u32, u64, u128, usize
    let signed: i8 = -127;
    let unsigned: u8 = 255;

    // Number literals
    let decimal = 98_222;
    let hex = 0xff;
    let octal = 0o77;
    let binary = 0b1111_0000;
    let byte = b'A'; // u8 only
}</code></pre></pre>
<h3 id="strings-2"><a class="header" href="#strings-2">Strings</a></h3>
<pre><pre class="playground"><code class="language-rust">fn main() {
    // String slice (immutable, fixed size)
    let s1: &amp;str = "Hello";

    // String (mutable, growable)
    let mut s2 = String::from("Hello");
    s2.push_str(", World!");

    // String operations
    let len = s2.len();
    let is_empty = s2.is_empty();
    let contains = s2.contains("World");

    // String concatenation
    let s3 = String::from("Hello");
    let s4 = String::from(" World");
    let s5 = s3 + &amp;s4; // s3 is moved, can't use it anymore

    // Format macro (doesn't take ownership)
    let s6 = format!("{} {}", s1, s4);

    // String slicing
    let hello = &amp;s2[0..5];
    let world = &amp;s2[7..12];

    // Iterate over chars
    for c in "Hello".chars() {
        println!("{}", c);
    }

    // Iterate over bytes
    for b in "Hello".bytes() {
        println!("{}", b);
    }

    // String to number
    let num: i32 = "42".parse().unwrap();
}</code></pre></pre>
<hr />
<h2 id="ownership-and-borrowing"><a class="header" href="#ownership-and-borrowing">Ownership and Borrowing</a></h2>
<h3 id="ownership-rules"><a class="header" href="#ownership-rules">Ownership Rules</a></h3>
<ol>
<li>Each value in Rust has a variable called its owner</li>
<li>There can only be one owner at a time</li>
<li>When the owner goes out of scope, the value is dropped</li>
</ol>
<pre><pre class="playground"><code class="language-rust">fn main() {
    // Move (ownership transfer)
    let s1 = String::from("hello");
    let s2 = s1; // s1 is no longer valid
    // println!("{}", s1); // Error!
    println!("{}", s2); // OK

    // Clone (deep copy)
    let s3 = String::from("hello");
    let s4 = s3.clone();
    println!("{} {}", s3, s4); // Both valid

    // Copy trait (stack-only data)
    let x = 5;
    let y = x; // x is still valid (Copy trait)
    println!("{} {}", x, y);
}</code></pre></pre>
<h3 id="references-and-borrowing"><a class="header" href="#references-and-borrowing">References and Borrowing</a></h3>
<pre><pre class="playground"><code class="language-rust">fn main() {
    // Immutable reference (borrowing)
    let s1 = String::from("hello");
    let len = calculate_length(&amp;s1); // Borrow
    println!("{} has length {}", s1, len); // s1 still valid

    // Mutable reference
    let mut s = String::from("hello");
    change(&amp;mut s);
    println!("{}", s); // "hello, world"

    // Rules:
    // 1. Multiple immutable references OR one mutable reference
    // 2. References must always be valid

    let r1 = &amp;s; // OK
    let r2 = &amp;s; // OK
    // let r3 = &amp;mut s; // Error! Can't have mutable while immutable exists

    println!("{} {}", r1, r2);
    // r1 and r2 no longer used after this

    let r3 = &amp;mut s; // OK now
}

fn calculate_length(s: &amp;String) -&gt; usize {
    s.len()
}

fn change(s: &amp;mut String) {
    s.push_str(", world");
}</code></pre></pre>
<h3 id="lifetimes"><a class="header" href="#lifetimes">Lifetimes</a></h3>
<pre><pre class="playground"><code class="language-rust">// Lifetime annotations
fn longest&lt;'a&gt;(x: &amp;'a str, y: &amp;'a str) -&gt; &amp;'a str {
    if x.len() &gt; y.len() {
        x
    } else {
        y
    }
}

// Struct with lifetime
struct ImportantExcerpt&lt;'a&gt; {
    part: &amp;'a str,
}

impl&lt;'a&gt; ImportantExcerpt&lt;'a&gt; {
    fn level(&amp;self) -&gt; i32 {
        3
    }
}

fn main() {
    let string1 = String::from("long string");
    let result;
    {
        let string2 = String::from("short");
        result = longest(string1.as_str(), string2.as_str());
        println!("Longest: {}", result);
    }
    // result not valid here (string2 dropped)
}</code></pre></pre>
<hr />
<h2 id="data-structures-1"><a class="header" href="#data-structures-1">Data Structures</a></h2>
<h3 id="arrays-and-vectors"><a class="header" href="#arrays-and-vectors">Arrays and Vectors</a></h3>
<pre><pre class="playground"><code class="language-rust">fn main() {
    // Array (fixed size)
    let arr: [i32; 5] = [1, 2, 3, 4, 5];
    let arr2 = [3; 5]; // [3, 3, 3, 3, 3]
    let first = arr[0];
    let len = arr.len();

    // Vector (dynamic array)
    let mut vec = Vec::new();
    vec.push(1);
    vec.push(2);
    vec.push(3);

    // Vec macro
    let vec2 = vec![1, 2, 3, 4, 5];

    // Accessing elements
    let third = &amp;vec2[2];
    let third = vec2.get(2); // Returns Option&lt;&amp;T&gt;

    // Iterate
    for i in &amp;vec2 {
        println!("{}", i);
    }

    // Mutable iteration
    let mut vec3 = vec![1, 2, 3];
    for i in &amp;mut vec3 {
        *i += 50;
    }

    // Vector with enum for multiple types
    enum SpreadsheetCell {
        Int(i32),
        Float(f64),
        Text(String),
    }

    let row = vec![
        SpreadsheetCell::Int(3),
        SpreadsheetCell::Float(10.12),
        SpreadsheetCell::Text(String::from("blue")),
    ];
}</code></pre></pre>
<h3 id="hashmap-1"><a class="header" href="#hashmap-1">HashMap</a></h3>
<pre><pre class="playground"><code class="language-rust">use std::collections::HashMap;

fn main() {
    // Create HashMap
    let mut scores = HashMap::new();
    scores.insert(String::from("Blue"), 10);
    scores.insert(String::from("Yellow"), 50);

    // From vectors
    let teams = vec![String::from("Blue"), String::from("Yellow")];
    let initial_scores = vec![10, 50];
    let scores: HashMap&lt;_, _&gt; = teams.iter().zip(initial_scores.iter()).collect();

    // Accessing values
    let team_name = String::from("Blue");
    let score = scores.get(&amp;team_name); // Returns Option&lt;&amp;V&gt;

    // Iterate
    for (key, value) in &amp;scores {
        println!("{}: {}", key, value);
    }

    // Update values
    scores.insert(String::from("Blue"), 25); // Overwrite

    // Only insert if key doesn't exist
    scores.entry(String::from("Blue")).or_insert(50);

    // Update based on old value
    let text = "hello world wonderful world";
    let mut map = HashMap::new();

    for word in text.split_whitespace() {
        let count = map.entry(word).or_insert(0);
        *count += 1;
    }

    println!("{:?}", map);
}</code></pre></pre>
<hr />
<h2 id="control-flow-6"><a class="header" href="#control-flow-6">Control Flow</a></h2>
<h3 id="if-else-3"><a class="header" href="#if-else-3">If-Else</a></h3>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let number = 6;

    if number % 4 == 0 {
        println!("divisible by 4");
    } else if number % 3 == 0 {
        println!("divisible by 3");
    } else {
        println!("not divisible by 4 or 3");
    }

    // If in let statement
    let condition = true;
    let number = if condition { 5 } else { 6 };
}</code></pre></pre>
<h3 id="loops-6"><a class="header" href="#loops-6">Loops</a></h3>
<pre><pre class="playground"><code class="language-rust">fn main() {
    // Loop (infinite)
    let mut count = 0;
    let result = loop {
        count += 1;
        if count == 10 {
            break count * 2; // Return value
        }
    };

    // While loop
    let mut number = 3;
    while number != 0 {
        println!("{}!", number);
        number -= 1;
    }

    // For loop
    let arr = [10, 20, 30, 40, 50];
    for element in arr.iter() {
        println!("{}", element);
    }

    // Range
    for number in 1..4 {
        println!("{}", number); // 1, 2, 3
    }

    // Reverse range
    for number in (1..4).rev() {
        println!("{}", number); // 3, 2, 1
    }

    // Enumerate
    for (i, v) in arr.iter().enumerate() {
        println!("{}: {}", i, v);
    }
}</code></pre></pre>
<h3 id="match"><a class="header" href="#match">Match</a></h3>
<pre><pre class="playground"><code class="language-rust">fn main() {
    // Basic match
    let number = 3;
    match number {
        1 =&gt; println!("One"),
        2 =&gt; println!("Two"),
        3 =&gt; println!("Three"),
        _ =&gt; println!("Other"), // Default case
    }

    // Match with return value
    let result = match number {
        1 =&gt; "one",
        2 =&gt; "two",
        3 =&gt; "three",
        _ =&gt; "other",
    };

    // Match ranges
    match number {
        1..=5 =&gt; println!("1 through 5"),
        _ =&gt; println!("something else"),
    }

    // Match Option
    let some_value: Option&lt;i32&gt; = Some(3);
    match some_value {
        Some(i) =&gt; println!("Got {}", i),
        None =&gt; println!("Got nothing"),
    }

    // if let (concise match)
    if let Some(i) = some_value {
        println!("{}", i);
    }

    // Match guards
    let num = Some(4);
    match num {
        Some(x) if x &lt; 5 =&gt; println!("less than five: {}", x),
        Some(x) =&gt; println!("{}", x),
        None =&gt; (),
    }
}</code></pre></pre>
<hr />
<h2 id="structs-and-enums"><a class="header" href="#structs-and-enums">Structs and Enums</a></h2>
<h3 id="structs-1"><a class="header" href="#structs-1">Structs</a></h3>
<pre><pre class="playground"><code class="language-rust">// Define struct
struct User {
    username: String,
    email: String,
    sign_in_count: u64,
    active: bool,
}

// Tuple struct
struct Color(i32, i32, i32);
struct Point(i32, i32, i32);

// Unit struct (no fields)
struct AlwaysEqual;

impl User {
    // Associated function (constructor)
    fn new(username: String, email: String) -&gt; User {
        User {
            username,
            email,
            sign_in_count: 1,
            active: true,
        }
    }

    // Method
    fn is_active(&amp;self) -&gt; bool {
        self.active
    }

    // Mutable method
    fn deactivate(&amp;mut self) {
        self.active = false;
    }
}

fn main() {
    // Create instance
    let mut user1 = User {
        email: String::from("user@example.com"),
        username: String::from("user123"),
        active: true,
        sign_in_count: 1,
    };

    user1.email = String::from("newemail@example.com");

    // Struct update syntax
    let user2 = User {
        email: String::from("another@example.com"),
        ..user1 // Rest from user1
    };

    // Tuple struct
    let black = Color(0, 0, 0);
    let origin = Point(0, 0, 0);
}</code></pre></pre>
<h3 id="enums-1"><a class="header" href="#enums-1">Enums</a></h3>
<pre><pre class="playground"><code class="language-rust">// Define enum
enum IpAddr {
    V4(u8, u8, u8, u8),
    V6(String),
}

enum Message {
    Quit,
    Move { x: i32, y: i32 },
    Write(String),
    ChangeColor(i32, i32, i32),
}

impl Message {
    fn call(&amp;self) {
        match self {
            Message::Quit =&gt; println!("Quit"),
            Message::Move { x, y } =&gt; println!("Move to {}, {}", x, y),
            Message::Write(text) =&gt; println!("Write: {}", text),
            Message::ChangeColor(r, g, b) =&gt; println!("Color: {}, {}, {}", r, g, b),
        }
    }
}

fn main() {
    let home = IpAddr::V4(127, 0, 0, 1);
    let loopback = IpAddr::V6(String::from("::1"));

    let msg = Message::Write(String::from("hello"));
    msg.call();
}</code></pre></pre>
<h3 id="option-and-result"><a class="header" href="#option-and-result">Option and Result</a></h3>
<pre><pre class="playground"><code class="language-rust">fn main() {
    // Option&lt;T&gt; - value or nothing
    let some_number: Option&lt;i32&gt; = Some(5);
    let no_number: Option&lt;i32&gt; = None;

    // Match on Option
    match some_number {
        Some(i) =&gt; println!("{}", i),
        None =&gt; println!("nothing"),
    }

    // Unwrap (panics if None)
    let x = Some(5);
    let y = x.unwrap();

    // Unwrap with default
    let z = no_number.unwrap_or(0);

    // Result&lt;T, E&gt; - success or error
    use std::fs::File;
    use std::io::ErrorKind;

    let f = File::open("hello.txt");
    let f = match f {
        Ok(file) =&gt; file,
        Err(error) =&gt; match error.kind() {
            ErrorKind::NotFound =&gt; match File::create("hello.txt") {
                Ok(fc) =&gt; fc,
                Err(e) =&gt; panic!("Problem creating file: {:?}", e),
            },
            other_error =&gt; panic!("Problem opening file: {:?}", other_error),
        },
    };

    // Propagating errors with ?
    fn read_username() -&gt; Result&lt;String, std::io::Error&gt; {
        let mut f = File::open("hello.txt")?;
        let mut s = String::new();
        use std::io::Read;
        f.read_to_string(&amp;mut s)?;
        Ok(s)
    }
}</code></pre></pre>
<hr />
<h2 id="traits"><a class="header" href="#traits">Traits</a></h2>
<pre><pre class="playground"><code class="language-rust">// Define trait
trait Summary {
    fn summarize(&amp;self) -&gt; String;

    // Default implementation
    fn default_summary(&amp;self) -&gt; String {
        String::from("(Read more...)")
    }
}

// Implement trait
struct NewsArticle {
    headline: String,
    location: String,
    author: String,
}

impl Summary for NewsArticle {
    fn summarize(&amp;self) -&gt; String {
        format!("{}, by {} ({})", self.headline, self.author, self.location)
    }
}

struct Tweet {
    username: String,
    content: String,
}

impl Summary for Tweet {
    fn summarize(&amp;self) -&gt; String {
        format!("{}: {}", self.username, self.content)
    }
}

// Trait as parameter
fn notify(item: &amp;impl Summary) {
    println!("Breaking news! {}", item.summarize());
}

// Trait bound syntax
fn notify2&lt;T: Summary&gt;(item: &amp;T) {
    println!("{}", item.summarize());
}

// Multiple traits
fn notify3&lt;T: Summary + Display&gt;(item: &amp;T) {
    // ...
}

// Where clause
fn some_function&lt;T, U&gt;(t: &amp;T, u: &amp;U) -&gt; i32
where
    T: Display + Clone,
    U: Clone + Debug,
{
    // ...
    0
}

// Return trait
fn returns_summarizable() -&gt; impl Summary {
    Tweet {
        username: String::from("user"),
        content: String::from("content"),
    }
}

use std::fmt::Display;
use std::fmt::Debug;

fn main() {
    let tweet = Tweet {
        username: String::from("user"),
        content: String::from("Hello, world!"),
    };

    println!("{}", tweet.summarize());
}</code></pre></pre>
<hr />
<h2 id="error-handling-5"><a class="header" href="#error-handling-5">Error Handling</a></h2>
<pre><pre class="playground"><code class="language-rust">use std::fs::File;
use std::io::{self, Read};

// Propagating errors
fn read_username_from_file() -&gt; Result&lt;String, io::Error&gt; {
    let mut f = File::open("username.txt")?;
    let mut s = String::new();
    f.read_to_string(&amp;mut s)?;
    Ok(s)
}

// Custom error types
use std::fmt;

#[derive(Debug)]
enum CustomError {
    IoError(io::Error),
    ParseError,
}

impl fmt::Display for CustomError {
    fn fmt(&amp;self, f: &amp;mut fmt::Formatter) -&gt; fmt::Result {
        match self {
            CustomError::IoError(e) =&gt; write!(f, "IO error: {}", e),
            CustomError::ParseError =&gt; write!(f, "Parse error"),
        }
    }
}

impl From&lt;io::Error&gt; for CustomError {
    fn from(err: io::Error) -&gt; CustomError {
        CustomError::IoError(err)
    }
}

// Panic
fn will_panic() {
    panic!("crash and burn");
}

// Assert
fn check_value(x: i32) {
    assert!(x &gt; 0, "x must be positive");
    assert_eq!(x, 5);
    assert_ne!(x, 0);
}

fn main() {
    // Result with match
    match read_username_from_file() {
        Ok(username) =&gt; println!("Username: {}", username),
        Err(e) =&gt; println!("Error: {}", e),
    }

    // Unwrap
    let f = File::open("hello.txt").unwrap();

    // Expect (with custom message)
    let f = File::open("hello.txt").expect("Failed to open file");
}</code></pre></pre>
<hr />
<h2 id="generics-1"><a class="header" href="#generics-1">Generics</a></h2>
<pre><pre class="playground"><code class="language-rust">// Generic function
fn largest&lt;T: PartialOrd&gt;(list: &amp;[T]) -&gt; &amp;T {
    let mut largest = &amp;list[0];
    for item in list {
        if item &gt; largest {
            largest = item;
        }
    }
    largest
}

// Generic struct
struct Point&lt;T&gt; {
    x: T,
    y: T,
}

impl&lt;T&gt; Point&lt;T&gt; {
    fn x(&amp;self) -&gt; &amp;T {
        &amp;self.x
    }
}

// Implement for specific type
impl Point&lt;f32&gt; {
    fn distance_from_origin(&amp;self) -&gt; f32 {
        (self.x.powi(2) + self.y.powi(2)).sqrt()
    }
}

// Multiple generic types
struct Point2&lt;T, U&gt; {
    x: T,
    y: U,
}

// Generic enum
enum Option&lt;T&gt; {
    Some(T),
    None,
}

enum Result&lt;T, E&gt; {
    Ok(T),
    Err(E),
}

fn main() {
    let numbers = vec![34, 50, 25, 100, 65];
    let result = largest(&amp;numbers);

    let integer = Point { x: 5, y: 10 };
    let float = Point { x: 1.0, y: 4.0 };
    let mixed = Point2 { x: 5, y: 4.0 };
}</code></pre></pre>
<hr />
<h2 id="concurrency-1"><a class="header" href="#concurrency-1">Concurrency</a></h2>
<h3 id="threads"><a class="header" href="#threads">Threads</a></h3>
<pre><pre class="playground"><code class="language-rust">use std::thread;
use std::time::Duration;

fn main() {
    // Spawn thread
    let handle = thread::spawn(|| {
        for i in 1..10 {
            println!("spawned thread: {}", i);
            thread::sleep(Duration::from_millis(1));
        }
    });

    // Wait for thread
    handle.join().unwrap();

    // Move closure
    let v = vec![1, 2, 3];
    let handle = thread::spawn(move || {
        println!("vector: {:?}", v);
    });

    handle.join().unwrap();
}</code></pre></pre>
<h3 id="channels-1"><a class="header" href="#channels-1">Channels</a></h3>
<pre><pre class="playground"><code class="language-rust">use std::sync::mpsc;
use std::thread;

fn main() {
    // Create channel
    let (tx, rx) = mpsc::channel();

    thread::spawn(move || {
        let val = String::from("hi");
        tx.send(val).unwrap();
    });

    let received = rx.recv().unwrap();
    println!("Got: {}", received);

    // Multiple producers
    let (tx, rx) = mpsc::channel();
    let tx1 = tx.clone();

    thread::spawn(move || {
        tx.send(String::from("hi from thread 1")).unwrap();
    });

    thread::spawn(move || {
        tx1.send(String::from("hi from thread 2")).unwrap();
    });

    for received in rx {
        println!("Got: {}", received);
    }
}</code></pre></pre>
<h3 id="shared-state"><a class="header" href="#shared-state">Shared State</a></h3>
<pre><pre class="playground"><code class="language-rust">use std::sync::{Arc, Mutex};
use std::thread;

fn main() {
    // Mutex for mutual exclusion
    let counter = Arc::new(Mutex::new(0));
    let mut handles = vec![];

    for _ in 0..10 {
        let counter = Arc::clone(&amp;counter);
        let handle = thread::spawn(move || {
            let mut num = counter.lock().unwrap();
            *num += 1;
        });
        handles.push(handle);
    }

    for handle in handles {
        handle.join().unwrap();
    }

    println!("Result: {}", *counter.lock().unwrap());
}</code></pre></pre>
<hr />
<h2 id="common-patterns-8"><a class="header" href="#common-patterns-8">Common Patterns</a></h2>
<h3 id="builder-pattern-3"><a class="header" href="#builder-pattern-3">Builder Pattern</a></h3>
<pre><pre class="playground"><code class="language-rust">#[derive(Default)]
struct User {
    username: String,
    email: String,
    age: Option&lt;u32&gt;,
}

impl User {
    fn builder() -&gt; UserBuilder {
        UserBuilder::default()
    }
}

#[derive(Default)]
struct UserBuilder {
    username: String,
    email: String,
    age: Option&lt;u32&gt;,
}

impl UserBuilder {
    fn username(mut self, username: &amp;str) -&gt; Self {
        self.username = username.to_string();
        self
    }

    fn email(mut self, email: &amp;str) -&gt; Self {
        self.email = email.to_string();
        self
    }

    fn age(mut self, age: u32) -&gt; Self {
        self.age = Some(age);
        self
    }

    fn build(self) -&gt; User {
        User {
            username: self.username,
            email: self.email,
            age: self.age,
        }
    }
}

fn main() {
    let user = User::builder()
        .username("alice")
        .email("alice@example.com")
        .age(30)
        .build();
}</code></pre></pre>
<h3 id="newtype-pattern"><a class="header" href="#newtype-pattern">Newtype Pattern</a></h3>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// Wrap existing type
struct Wrapper(Vec&lt;String&gt;);

impl Wrapper {
    fn new() -&gt; Self {
        Wrapper(Vec::new())
    }

    fn push(&amp;mut self, s: String) {
        self.0.push(s);
    }
}
<span class="boring">}</span></code></pre></pre>
<hr />
<h2 id="testing-1"><a class="header" href="#testing-1">Testing</a></h2>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// Unit tests
#[cfg(test)]
mod tests {
    use super::*;

    #[test]
    fn it_works() {
        assert_eq!(2 + 2, 4);
    }

    #[test]
    fn it_adds() {
        assert_eq!(add(2, 2), 4);
    }

    #[test]
    #[should_panic]
    fn it_panics() {
        panic!("panic!");
    }

    #[test]
    fn it_returns_result() -&gt; Result&lt;(), String&gt; {
        if 2 + 2 == 4 {
            Ok(())
        } else {
            Err(String::from("two plus two does not equal four"))
        }
    }
}

fn add(a: i32, b: i32) -&gt; i32 {
    a + b
}
<span class="boring">}</span></code></pre></pre>
<hr />
<h2 id="cargo-commands"><a class="header" href="#cargo-commands">Cargo Commands</a></h2>
<pre><code class="language-bash"># Create new project
cargo new project_name
cargo new --lib library_name

# Build project
cargo build
cargo build --release

# Run project
cargo run

# Check code
cargo check

# Run tests
cargo test

# Generate documentation
cargo doc --open

# Update dependencies
cargo update

# Format code
cargo fmt

# Lint code
cargo clippy
</code></pre>
<hr />
<h2 id="best-practices-12"><a class="header" href="#best-practices-12">Best Practices</a></h2>
<ol>
<li><strong>Use ownership properly</strong> - Avoid unnecessary clones</li>
<li><strong>Handle errors with Result</strong> - Don't unwrap in production</li>
<li><strong>Use iterators</strong> - More efficient and idiomatic</li>
<li><strong>Prefer <code>&amp;str</code> over <code>String</code></strong> for function parameters</li>
<li><strong>Use <code>Option</code> instead of null</strong></li>
<li><strong>Implement <code>Debug</code> trait</strong> for custom types</li>
<li><strong>Use pattern matching</strong> instead of if chains</li>
<li><strong>Follow naming conventions</strong> - snake_case for variables/functions</li>
<li><strong>Write tests</strong> - <code>cargo test</code></li>
<li><strong>Use clippy</strong> - <code>cargo clippy</code> for linting</li>
</ol>
<hr />
<h2 id="common-libraries-2"><a class="header" href="#common-libraries-2">Common Libraries</a></h2>
<ul>
<li><strong>serde</strong>: Serialization/deserialization</li>
<li><strong>tokio</strong>: Async runtime</li>
<li><strong>reqwest</strong>: HTTP client</li>
<li><strong>actix-web</strong>: Web framework</li>
<li><strong>diesel</strong>: ORM</li>
<li><strong>clap</strong>: CLI argument parsing</li>
<li><strong>log</strong>: Logging facade</li>
<li><strong>anyhow</strong>: Error handling</li>
<li><strong>thiserror</strong>: Custom error types</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sql-structured-query-language"><a class="header" href="#sql-structured-query-language">SQL (Structured Query Language)</a></h1>
<h2 id="overview-10"><a class="header" href="#overview-10">Overview</a></h2>
<p>SQL is a domain-specific language used for managing and manipulating relational databases. It's the standard language for relational database management systems (RDBMS).</p>
<p><strong>Key Concepts:</strong></p>
<ul>
<li>Declarative language (what, not how)</li>
<li>ACID properties (Atomicity, Consistency, Isolation, Durability)</li>
<li>Set-based operations</li>
<li>Data definition, manipulation, and querying</li>
<li>Transaction management</li>
</ul>
<p><strong>Popular Database Systems:</strong></p>
<ul>
<li>PostgreSQL</li>
<li>MySQL/MariaDB</li>
<li>Oracle Database</li>
<li>Microsoft SQL Server</li>
<li>SQLite</li>
</ul>
<hr />
<h2 id="basic-syntax-8"><a class="header" href="#basic-syntax-8">Basic Syntax</a></h2>
<h3 id="data-types-4"><a class="header" href="#data-types-4">Data Types</a></h3>
<pre><code class="language-sql">-- Numeric
INT, INTEGER              -- Whole numbers
SMALLINT, BIGINT          -- Different sizes
DECIMAL(10, 2), NUMERIC   -- Fixed-point numbers
FLOAT, REAL, DOUBLE       -- Floating-point numbers

-- String
CHAR(10)                  -- Fixed length
VARCHAR(255)              -- Variable length
TEXT                      -- Long text

-- Date and Time
DATE                      -- Date only
TIME                      -- Time only
TIMESTAMP, DATETIME       -- Date and time
YEAR                      -- Year only

-- Boolean
BOOLEAN, BOOL             -- True/False

-- Binary
BLOB                      -- Binary large object
BYTEA (PostgreSQL)        -- Binary data

-- Other
JSON, JSONB (PostgreSQL)  -- JSON data
UUID                      -- Universally unique identifier
ENUM('small', 'medium')   -- Enumerated type
</code></pre>
<hr />
<h2 id="ddl-data-definition-language"><a class="header" href="#ddl-data-definition-language">DDL (Data Definition Language)</a></h2>
<h3 id="create"><a class="header" href="#create">CREATE</a></h3>
<pre><code class="language-sql">-- Create database
CREATE DATABASE mydb;
CREATE DATABASE IF NOT EXISTS mydb;

-- Use database
USE mydb;

-- Create table
CREATE TABLE users (
    id INT PRIMARY KEY AUTO_INCREMENT,
    username VARCHAR(50) NOT NULL UNIQUE,
    email VARCHAR(100) NOT NULL UNIQUE,
    password VARCHAR(255) NOT NULL,
    age INT CHECK (age &gt;= 18),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);

-- Create table with foreign key
CREATE TABLE posts (
    id INT PRIMARY KEY AUTO_INCREMENT,
    user_id INT NOT NULL,
    title VARCHAR(255) NOT NULL,
    content TEXT,
    published BOOLEAN DEFAULT FALSE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
);

-- Create table with composite primary key
CREATE TABLE user_roles (
    user_id INT,
    role_id INT,
    granted_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    PRIMARY KEY (user_id, role_id),
    FOREIGN KEY (user_id) REFERENCES users(id),
    FOREIGN KEY (role_id) REFERENCES roles(id)
);

-- Create table from query
CREATE TABLE archived_users AS
SELECT * FROM users WHERE created_at &lt; '2020-01-01';
</code></pre>
<h3 id="alter"><a class="header" href="#alter">ALTER</a></h3>
<pre><code class="language-sql">-- Add column
ALTER TABLE users ADD COLUMN phone VARCHAR(20);

-- Modify column
ALTER TABLE users MODIFY COLUMN email VARCHAR(150);
ALTER TABLE users ALTER COLUMN age SET DEFAULT 18;

-- Rename column
ALTER TABLE users RENAME COLUMN username TO user_name;

-- Drop column
ALTER TABLE users DROP COLUMN phone;

-- Add constraint
ALTER TABLE users ADD CONSTRAINT chk_age CHECK (age &gt;= 18);
ALTER TABLE users ADD UNIQUE (email);

-- Drop constraint
ALTER TABLE users DROP CONSTRAINT chk_age;

-- Rename table
ALTER TABLE users RENAME TO customers;
</code></pre>
<h3 id="drop"><a class="header" href="#drop">DROP</a></h3>
<pre><code class="language-sql">-- Drop table
DROP TABLE users;
DROP TABLE IF EXISTS users;

-- Drop database
DROP DATABASE mydb;
DROP DATABASE IF EXISTS mydb;

-- Truncate (delete all rows, keep structure)
TRUNCATE TABLE users;
</code></pre>
<hr />
<h2 id="dml-data-manipulation-language"><a class="header" href="#dml-data-manipulation-language">DML (Data Manipulation Language)</a></h2>
<h3 id="insert"><a class="header" href="#insert">INSERT</a></h3>
<pre><code class="language-sql">-- Insert single row
INSERT INTO users (username, email, password, age)
VALUES ('alice', 'alice@example.com', 'hashed_pwd', 30);

-- Insert multiple rows
INSERT INTO users (username, email, password, age)
VALUES
    ('bob', 'bob@example.com', 'hashed_pwd', 25),
    ('charlie', 'charlie@example.com', 'hashed_pwd', 35),
    ('diana', 'diana@example.com', 'hashed_pwd', 28);

-- Insert from select
INSERT INTO archived_users
SELECT * FROM users WHERE created_at &lt; '2020-01-01';

-- Insert or update (MySQL)
INSERT INTO users (id, username, email)
VALUES (1, 'alice', 'alice@example.com')
ON DUPLICATE KEY UPDATE email = VALUES(email);

-- Insert or ignore (MySQL)
INSERT IGNORE INTO users (username, email)
VALUES ('alice', 'alice@example.com');

-- Upsert (PostgreSQL)
INSERT INTO users (id, username, email)
VALUES (1, 'alice', 'alice@example.com')
ON CONFLICT (id) DO UPDATE SET email = EXCLUDED.email;
</code></pre>
<h3 id="update"><a class="header" href="#update">UPDATE</a></h3>
<pre><code class="language-sql">-- Update single row
UPDATE users
SET email = 'newemail@example.com'
WHERE id = 1;

-- Update multiple columns
UPDATE users
SET email = 'alice@newdomain.com',
    age = 31,
    updated_at = CURRENT_TIMESTAMP
WHERE username = 'alice';

-- Update with condition
UPDATE users
SET age = age + 1
WHERE created_at &lt; '2020-01-01';

-- Update from join
UPDATE users u
INNER JOIN orders o ON u.id = o.user_id
SET u.total_orders = (
    SELECT COUNT(*) FROM orders WHERE user_id = u.id
)
WHERE o.created_at &gt; '2024-01-01';

-- Update all rows (dangerous!)
UPDATE users SET active = TRUE;
</code></pre>
<h3 id="delete"><a class="header" href="#delete">DELETE</a></h3>
<pre><code class="language-sql">-- Delete specific row
DELETE FROM users WHERE id = 1;

-- Delete with condition
DELETE FROM users WHERE created_at &lt; '2020-01-01';

-- Delete with join (MySQL)
DELETE u FROM users u
INNER JOIN orders o ON u.id = o.user_id
WHERE o.status = 'cancelled';

-- Delete all rows (dangerous!)
DELETE FROM users;

-- Soft delete (recommended)
UPDATE users SET deleted_at = CURRENT_TIMESTAMP WHERE id = 1;
</code></pre>
<hr />
<h2 id="dql-data-query-language"><a class="header" href="#dql-data-query-language">DQL (Data Query Language)</a></h2>
<h3 id="select"><a class="header" href="#select">SELECT</a></h3>
<pre><code class="language-sql">-- Select all columns
SELECT * FROM users;

-- Select specific columns
SELECT username, email FROM users;

-- Select with alias
SELECT username AS name, email AS contact FROM users;

-- Select with calculation
SELECT
    username,
    age,
    YEAR(CURRENT_DATE) - YEAR(created_at) AS years_member
FROM users;

-- Select distinct
SELECT DISTINCT age FROM users;

-- Select with limit
SELECT * FROM users LIMIT 10;
SELECT * FROM users LIMIT 10 OFFSET 20;  -- Skip first 20

-- Select top (SQL Server)
SELECT TOP 10 * FROM users;
</code></pre>
<h3 id="where"><a class="header" href="#where">WHERE</a></h3>
<pre><code class="language-sql">-- Basic conditions
SELECT * FROM users WHERE age &gt; 25;
SELECT * FROM users WHERE username = 'alice';
SELECT * FROM users WHERE age &gt;= 18 AND age &lt;= 65;

-- IN operator
SELECT * FROM users WHERE age IN (25, 30, 35);
SELECT * FROM users WHERE username IN ('alice', 'bob', 'charlie');

-- BETWEEN
SELECT * FROM users WHERE age BETWEEN 18 AND 65;
SELECT * FROM users WHERE created_at BETWEEN '2023-01-01' AND '2023-12-31';

-- LIKE (pattern matching)
SELECT * FROM users WHERE email LIKE '%@gmail.com';
SELECT * FROM users WHERE username LIKE 'a%';      -- Starts with 'a'
SELECT * FROM users WHERE username LIKE '%a';      -- Ends with 'a'
SELECT * FROM users WHERE username LIKE '%a%';     -- Contains 'a'
SELECT * FROM users WHERE username LIKE 'a_b';     -- _ matches single char

-- IS NULL / IS NOT NULL
SELECT * FROM users WHERE phone IS NULL;
SELECT * FROM users WHERE phone IS NOT NULL;

-- NOT
SELECT * FROM users WHERE NOT age &gt; 25;
SELECT * FROM users WHERE age NOT IN (25, 30, 35);

-- Combining conditions
SELECT * FROM users
WHERE (age &gt; 25 OR username LIKE 'a%')
AND email IS NOT NULL;
</code></pre>
<h3 id="order-by"><a class="header" href="#order-by">ORDER BY</a></h3>
<pre><code class="language-sql">-- Sort ascending
SELECT * FROM users ORDER BY age;
SELECT * FROM users ORDER BY age ASC;

-- Sort descending
SELECT * FROM users ORDER BY age DESC;

-- Sort by multiple columns
SELECT * FROM users ORDER BY age DESC, username ASC;

-- Sort by calculated column
SELECT username, age * 2 AS double_age
FROM users
ORDER BY double_age DESC;

-- Sort with NULL handling
SELECT * FROM users ORDER BY phone NULLS FIRST;
SELECT * FROM users ORDER BY phone NULLS LAST;
</code></pre>
<h3 id="group-by"><a class="header" href="#group-by">GROUP BY</a></h3>
<pre><code class="language-sql">-- Count users by age
SELECT age, COUNT(*) as count
FROM users
GROUP BY age;

-- Multiple aggregations
SELECT
    age,
    COUNT(*) as count,
    AVG(age) as avg_age,
    MIN(age) as min_age,
    MAX(age) as max_age
FROM users
GROUP BY age;

-- Group by multiple columns
SELECT
    age,
    YEAR(created_at) as year,
    COUNT(*) as count
FROM users
GROUP BY age, YEAR(created_at);

-- HAVING (filter groups)
SELECT age, COUNT(*) as count
FROM users
GROUP BY age
HAVING COUNT(*) &gt; 5;

-- GROUP BY with ORDER BY
SELECT age, COUNT(*) as count
FROM users
GROUP BY age
HAVING COUNT(*) &gt; 5
ORDER BY count DESC;
</code></pre>
<hr />
<h2 id="joins"><a class="header" href="#joins">Joins</a></h2>
<pre><code class="language-sql">-- INNER JOIN (only matching rows)
SELECT u.username, p.title
FROM users u
INNER JOIN posts p ON u.id = p.user_id;

-- LEFT JOIN (all from left, matching from right)
SELECT u.username, p.title
FROM users u
LEFT JOIN posts p ON u.id = p.user_id;

-- RIGHT JOIN (all from right, matching from left)
SELECT u.username, p.title
FROM users u
RIGHT JOIN posts p ON u.id = p.user_id;

-- FULL OUTER JOIN (all from both)
SELECT u.username, p.title
FROM users u
FULL OUTER JOIN posts p ON u.id = p.user_id;

-- CROSS JOIN (Cartesian product)
SELECT u.username, r.role_name
FROM users u
CROSS JOIN roles r;

-- Self join
SELECT
    e1.name as employee,
    e2.name as manager
FROM employees e1
LEFT JOIN employees e2 ON e1.manager_id = e2.id;

-- Multiple joins
SELECT
    u.username,
    p.title,
    c.content as comment
FROM users u
INNER JOIN posts p ON u.id = p.user_id
INNER JOIN comments c ON p.id = c.post_id;

-- Join with conditions
SELECT u.username, p.title
FROM users u
LEFT JOIN posts p ON u.id = p.user_id AND p.published = TRUE;
</code></pre>
<hr />
<h2 id="subqueries"><a class="header" href="#subqueries">Subqueries</a></h2>
<pre><code class="language-sql">-- Subquery in WHERE
SELECT username FROM users
WHERE id IN (
    SELECT user_id FROM orders WHERE total &gt; 100
);

-- Subquery in SELECT
SELECT
    username,
    (SELECT COUNT(*) FROM posts WHERE user_id = users.id) as post_count
FROM users;

-- Subquery in FROM
SELECT avg_age FROM (
    SELECT AVG(age) as avg_age FROM users GROUP BY city
) as subquery;

-- Correlated subquery
SELECT username FROM users u
WHERE age &gt; (
    SELECT AVG(age) FROM users WHERE city = u.city
);

-- EXISTS
SELECT username FROM users u
WHERE EXISTS (
    SELECT 1 FROM orders WHERE user_id = u.id
);

-- NOT EXISTS
SELECT username FROM users u
WHERE NOT EXISTS (
    SELECT 1 FROM orders WHERE user_id = u.id
);

-- ANY / ALL
SELECT username FROM users
WHERE age &gt; ANY (SELECT age FROM users WHERE city = 'NYC');

SELECT username FROM users
WHERE age &gt; ALL (SELECT age FROM users WHERE city = 'NYC');
</code></pre>
<hr />
<h2 id="aggregate-functions"><a class="header" href="#aggregate-functions">Aggregate Functions</a></h2>
<pre><code class="language-sql">-- COUNT
SELECT COUNT(*) FROM users;
SELECT COUNT(DISTINCT age) FROM users;

-- SUM
SELECT SUM(total) FROM orders;

-- AVG
SELECT AVG(age) FROM users;

-- MIN / MAX
SELECT MIN(age), MAX(age) FROM users;

-- String aggregation (PostgreSQL)
SELECT STRING_AGG(username, ', ') FROM users;

-- GROUP_CONCAT (MySQL)
SELECT GROUP_CONCAT(username SEPARATOR ', ') FROM users;

-- Combined
SELECT
    COUNT(*) as total_users,
    AVG(age) as average_age,
    MIN(age) as youngest,
    MAX(age) as oldest,
    SUM(CASE WHEN age &gt;= 18 THEN 1 ELSE 0 END) as adults
FROM users;
</code></pre>
<hr />
<h2 id="common-table-expressions-cte"><a class="header" href="#common-table-expressions-cte">Common Table Expressions (CTE)</a></h2>
<pre><code class="language-sql">-- Basic CTE
WITH active_users AS (
    SELECT * FROM users WHERE active = TRUE
)
SELECT * FROM active_users WHERE age &gt; 25;

-- Multiple CTEs
WITH
    active_users AS (
        SELECT * FROM users WHERE active = TRUE
    ),
    user_posts AS (
        SELECT user_id, COUNT(*) as post_count
        FROM posts
        GROUP BY user_id
    )
SELECT
    au.username,
    up.post_count
FROM active_users au
LEFT JOIN user_posts up ON au.id = up.user_id;

-- Recursive CTE (hierarchy)
WITH RECURSIVE employee_hierarchy AS (
    -- Base case
    SELECT id, name, manager_id, 1 as level
    FROM employees
    WHERE manager_id IS NULL

    UNION ALL

    -- Recursive case
    SELECT e.id, e.name, e.manager_id, eh.level + 1
    FROM employees e
    INNER JOIN employee_hierarchy eh ON e.manager_id = eh.id
)
SELECT * FROM employee_hierarchy ORDER BY level;
</code></pre>
<hr />
<h2 id="window-functions"><a class="header" href="#window-functions">Window Functions</a></h2>
<pre><code class="language-sql">-- ROW_NUMBER
SELECT
    username,
    age,
    ROW_NUMBER() OVER (ORDER BY age DESC) as row_num
FROM users;

-- RANK / DENSE_RANK
SELECT
    username,
    score,
    RANK() OVER (ORDER BY score DESC) as rank,
    DENSE_RANK() OVER (ORDER BY score DESC) as dense_rank
FROM users;

-- Partition by
SELECT
    city,
    username,
    age,
    AVG(age) OVER (PARTITION BY city) as avg_city_age
FROM users;

-- Running total
SELECT
    date,
    amount,
    SUM(amount) OVER (ORDER BY date) as running_total
FROM sales;

-- LAG / LEAD (previous/next row)
SELECT
    date,
    revenue,
    LAG(revenue) OVER (ORDER BY date) as prev_revenue,
    LEAD(revenue) OVER (ORDER BY date) as next_revenue
FROM daily_sales;

-- NTILE (divide into buckets)
SELECT
    username,
    score,
    NTILE(4) OVER (ORDER BY score DESC) as quartile
FROM users;
</code></pre>
<hr />
<h2 id="indexes"><a class="header" href="#indexes">Indexes</a></h2>
<pre><code class="language-sql">-- Create index
CREATE INDEX idx_users_email ON users(email);

-- Create unique index
CREATE UNIQUE INDEX idx_users_username ON users(username);

-- Create composite index
CREATE INDEX idx_users_age_city ON users(age, city);

-- Create partial index (PostgreSQL)
CREATE INDEX idx_active_users ON users(username)
WHERE active = TRUE;

-- Create index with condition (filtered index - SQL Server)
CREATE INDEX idx_active_users ON users(username)
WHERE active = 1;

-- Full-text index (MySQL)
CREATE FULLTEXT INDEX idx_posts_content ON posts(title, content);

-- Drop index
DROP INDEX idx_users_email ON users;

-- Show indexes
SHOW INDEX FROM users;  -- MySQL
SELECT * FROM pg_indexes WHERE tablename = 'users';  -- PostgreSQL
</code></pre>
<hr />
<h2 id="transactions"><a class="header" href="#transactions">Transactions</a></h2>
<pre><code class="language-sql">-- Start transaction
BEGIN;
START TRANSACTION;

-- Commit transaction
COMMIT;

-- Rollback transaction
ROLLBACK;

-- Example transaction
BEGIN;

UPDATE accounts SET balance = balance - 100 WHERE id = 1;
UPDATE accounts SET balance = balance + 100 WHERE id = 2;

-- Check if everything is okay
IF (SELECT balance FROM accounts WHERE id = 1) &gt;= 0 THEN
    COMMIT;
ELSE
    ROLLBACK;
END IF;

-- Savepoint
BEGIN;
UPDATE users SET age = 30 WHERE id = 1;
SAVEPOINT my_savepoint;
UPDATE users SET age = 40 WHERE id = 2;
ROLLBACK TO SAVEPOINT my_savepoint;  -- Only rollback second update
COMMIT;

-- Transaction isolation levels
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;
SET TRANSACTION ISOLATION LEVEL READ COMMITTED;
SET TRANSACTION ISOLATION LEVEL REPEATABLE READ;
SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;
</code></pre>
<hr />
<h2 id="views"><a class="header" href="#views">Views</a></h2>
<pre><code class="language-sql">-- Create view
CREATE VIEW active_users AS
SELECT id, username, email
FROM users
WHERE active = TRUE;

-- Use view
SELECT * FROM active_users;

-- Create or replace view
CREATE OR REPLACE VIEW user_stats AS
SELECT
    u.id,
    u.username,
    COUNT(p.id) as post_count,
    COUNT(DISTINCT c.id) as comment_count
FROM users u
LEFT JOIN posts p ON u.id = p.user_id
LEFT JOIN comments c ON u.id = c.user_id
GROUP BY u.id, u.username;

-- Materialized view (PostgreSQL)
CREATE MATERIALIZED VIEW user_stats_mv AS
SELECT
    u.id,
    COUNT(p.id) as post_count
FROM users u
LEFT JOIN posts p ON u.id = p.user_id
GROUP BY u.id;

-- Refresh materialized view
REFRESH MATERIALIZED VIEW user_stats_mv;

-- Drop view
DROP VIEW active_users;
DROP MATERIALIZED VIEW user_stats_mv;
</code></pre>
<hr />
<h2 id="stored-procedures-and-functions"><a class="header" href="#stored-procedures-and-functions">Stored Procedures and Functions</a></h2>
<pre><code class="language-sql">-- MySQL stored procedure
DELIMITER //
CREATE PROCEDURE GetUsersByAge(IN min_age INT)
BEGIN
    SELECT * FROM users WHERE age &gt;= min_age;
END //
DELIMITER ;

-- Call procedure
CALL GetUsersByAge(25);

-- Function (MySQL)
DELIMITER //
CREATE FUNCTION CalculateAge(birth_date DATE)
RETURNS INT
DETERMINISTIC
BEGIN
    RETURN YEAR(CURRENT_DATE) - YEAR(birth_date);
END //
DELIMITER ;

-- Use function
SELECT username, CalculateAge(birth_date) as age FROM users;

-- PostgreSQL function
CREATE OR REPLACE FUNCTION get_user_count()
RETURNS INTEGER AS $$
BEGIN
    RETURN (SELECT COUNT(*) FROM users);
END;
$$ LANGUAGE plpgsql;

-- Call function
SELECT get_user_count();

-- Drop procedure/function
DROP PROCEDURE GetUsersByAge;
DROP FUNCTION CalculateAge;
</code></pre>
<hr />
<h2 id="common-patterns-9"><a class="header" href="#common-patterns-9">Common Patterns</a></h2>
<h3 id="pagination"><a class="header" href="#pagination">Pagination</a></h3>
<pre><code class="language-sql">-- Offset pagination
SELECT * FROM users
ORDER BY id
LIMIT 10 OFFSET 20;  -- Page 3 (0-based)

-- Cursor-based pagination (more efficient)
SELECT * FROM users
WHERE id &gt; 100  -- Last seen ID
ORDER BY id
LIMIT 10;
</code></pre>
<h3 id="finding-duplicates"><a class="header" href="#finding-duplicates">Finding Duplicates</a></h3>
<pre><code class="language-sql">-- Find duplicate emails
SELECT email, COUNT(*) as count
FROM users
GROUP BY email
HAVING COUNT(*) &gt; 1;

-- Get duplicate rows with details
SELECT u.*
FROM users u
INNER JOIN (
    SELECT email FROM users
    GROUP BY email
    HAVING COUNT(*) &gt; 1
) dup ON u.email = dup.email;
</code></pre>
<h3 id="ranking"><a class="header" href="#ranking">Ranking</a></h3>
<pre><code class="language-sql">-- Top N per group
WITH ranked AS (
    SELECT
        *,
        ROW_NUMBER() OVER (PARTITION BY category ORDER BY score DESC) as rn
    FROM products
)
SELECT * FROM ranked WHERE rn &lt;= 3;
</code></pre>
<h3 id="running-totals"><a class="header" href="#running-totals">Running Totals</a></h3>
<pre><code class="language-sql">-- Running total
SELECT
    date,
    revenue,
    SUM(revenue) OVER (ORDER BY date) as cumulative_revenue
FROM sales
ORDER BY date;
</code></pre>
<h3 id="pivot-table"><a class="header" href="#pivot-table">Pivot Table</a></h3>
<pre><code class="language-sql">-- MySQL
SELECT
    username,
    SUM(CASE WHEN YEAR(created_at) = 2023 THEN 1 ELSE 0 END) as year_2023,
    SUM(CASE WHEN YEAR(created_at) = 2024 THEN 1 ELSE 0 END) as year_2024
FROM users
GROUP BY username;

-- PostgreSQL (crosstab)
SELECT * FROM crosstab(
    'SELECT username, YEAR(created_at), COUNT(*) FROM users GROUP BY 1, 2',
    'SELECT DISTINCT YEAR(created_at) FROM users ORDER BY 1'
) AS ct(username TEXT, year_2023 INT, year_2024 INT);
</code></pre>
<hr />
<h2 id="performance-optimization"><a class="header" href="#performance-optimization">Performance Optimization</a></h2>
<h3 id="best-practices-13"><a class="header" href="#best-practices-13">Best Practices</a></h3>
<ol>
<li>
<p><strong>Use indexes wisely</strong></p>
<pre><code class="language-sql">-- Index columns used in WHERE, JOIN, ORDER BY
CREATE INDEX idx_users_email ON users(email);
</code></pre>
</li>
<li>
<p>**Avoid SELECT ***</p>
<pre><code class="language-sql">-- Bad
SELECT * FROM users;

-- Good
SELECT id, username, email FROM users;
</code></pre>
</li>
<li>
<p><strong>Use LIMIT</strong></p>
<pre><code class="language-sql">SELECT * FROM users LIMIT 100;
</code></pre>
</li>
<li>
<p><strong>Use JOIN instead of subqueries when possible</strong></p>
<pre><code class="language-sql">-- Slower
SELECT * FROM users WHERE id IN (SELECT user_id FROM orders);

-- Faster
SELECT DISTINCT u.* FROM users u INNER JOIN orders o ON u.id = o.user_id;
</code></pre>
</li>
<li>
<p><strong>Use EXPLAIN to analyze queries</strong></p>
<pre><code class="language-sql">EXPLAIN SELECT * FROM users WHERE email = 'alice@example.com';
EXPLAIN ANALYZE SELECT * FROM users WHERE age &gt; 25;
</code></pre>
</li>
<li>
<p><strong>Avoid functions on indexed columns</strong></p>
<pre><code class="language-sql">-- Bad (can't use index)
SELECT * FROM users WHERE YEAR(created_at) = 2024;

-- Good
SELECT * FROM users
WHERE created_at &gt;= '2024-01-01' AND created_at &lt; '2025-01-01';
</code></pre>
</li>
<li>
<p><strong>Use covering indexes</strong></p>
<pre><code class="language-sql">CREATE INDEX idx_users_email_username ON users(email, username);
-- This query can be satisfied entirely from the index
SELECT username FROM users WHERE email = 'alice@example.com';
</code></pre>
</li>
</ol>
<hr />
<h2 id="common-functions"><a class="header" href="#common-functions">Common Functions</a></h2>
<h3 id="string-functions"><a class="header" href="#string-functions">String Functions</a></h3>
<pre><code class="language-sql">-- CONCAT
SELECT CONCAT(first_name, ' ', last_name) as full_name FROM users;

-- UPPER / LOWER
SELECT UPPER(username), LOWER(email) FROM users;

-- LENGTH / CHAR_LENGTH
SELECT LENGTH(username), CHAR_LENGTH(username) FROM users;

-- SUBSTRING
SELECT SUBSTRING(email, 1, 10) FROM users;

-- TRIM
SELECT TRIM(username) FROM users;

-- REPLACE
SELECT REPLACE(email, '@gmail.com', '@newdomain.com') FROM users;
</code></pre>
<h3 id="date-functions"><a class="header" href="#date-functions">Date Functions</a></h3>
<pre><code class="language-sql">-- Current date/time
SELECT NOW(), CURRENT_DATE, CURRENT_TIME;

-- Date arithmetic
SELECT DATE_ADD(created_at, INTERVAL 30 DAY) FROM users;
SELECT DATE_SUB(created_at, INTERVAL 1 YEAR) FROM users;

-- Date difference
SELECT DATEDIFF(NOW(), created_at) as days_since_creation FROM users;

-- Date formatting
SELECT DATE_FORMAT(created_at, '%Y-%m-%d %H:%i:%s') FROM users;

-- Extract parts
SELECT
    YEAR(created_at) as year,
    MONTH(created_at) as month,
    DAY(created_at) as day
FROM users;
</code></pre>
<h3 id="conditional-functions"><a class="header" href="#conditional-functions">Conditional Functions</a></h3>
<pre><code class="language-sql">-- CASE
SELECT
    username,
    CASE
        WHEN age &lt; 18 THEN 'Minor'
        WHEN age &gt;= 18 AND age &lt; 65 THEN 'Adult'
        ELSE 'Senior'
    END as age_group
FROM users;

-- IF (MySQL)
SELECT IF(age &gt;= 18, 'Adult', 'Minor') as status FROM users;

-- COALESCE (first non-null value)
SELECT COALESCE(phone, email, 'No contact') FROM users;

-- NULLIF (return NULL if equal)
SELECT NULLIF(age, 0) FROM users;
</code></pre>
<hr />
<h2 id="security-best-practices"><a class="header" href="#security-best-practices">Security Best Practices</a></h2>
<ol>
<li>
<p><strong>Use parameterized queries</strong> (prevent SQL injection)</p>
<pre><code class="language-sql">-- Bad (vulnerable to SQL injection)
SELECT * FROM users WHERE username = '$user_input';

-- Good (parameterized)
SELECT * FROM users WHERE username = ?;
</code></pre>
</li>
<li>
<p><strong>Principle of least privilege</strong></p>
<ul>
<li>Grant minimum necessary permissions</li>
<li>Use separate accounts for different applications</li>
</ul>
</li>
<li>
<p><strong>Encrypt sensitive data</strong></p>
<pre><code class="language-sql">-- Store password hashes, never plain text
INSERT INTO users (username, password_hash)
VALUES ('alice', SHA2('password', 256));
</code></pre>
</li>
<li>
<p><strong>Regular backups</strong></p>
<pre><code class="language-bash">mysqldump -u root -p database_name &gt; backup.sql
pg_dump database_name &gt; backup.sql
</code></pre>
</li>
<li>
<p><strong>Input validation</strong></p>
<ul>
<li>Validate and sanitize all user inputs</li>
<li>Use constraints in database schema</li>
</ul>
</li>
</ol>
<hr />
<h2 id="database-specific-features"><a class="header" href="#database-specific-features">Database-Specific Features</a></h2>
<h3 id="postgresql"><a class="header" href="#postgresql">PostgreSQL</a></h3>
<pre><code class="language-sql">-- Array type
CREATE TABLE users (tags TEXT[]);
INSERT INTO users (tags) VALUES (ARRAY['admin', 'moderator']);
SELECT * FROM users WHERE 'admin' = ANY(tags);

-- JSON type
CREATE TABLE users (metadata JSONB);
INSERT INTO users (metadata) VALUES ('{"age": 30, "city": "NYC"}');
SELECT metadata-&gt;&gt;'age' FROM users;

-- Generate series
SELECT * FROM generate_series(1, 10);
</code></pre>
<h3 id="mysql"><a class="header" href="#mysql">MySQL</a></h3>
<pre><code class="language-sql">-- Auto increment
CREATE TABLE users (
    id INT AUTO_INCREMENT PRIMARY KEY
);

-- Full-text search
CREATE FULLTEXT INDEX ft_content ON posts(content);
SELECT * FROM posts WHERE MATCH(content) AGAINST('search term');

-- JSON functions
SELECT JSON_EXTRACT(metadata, '$.age') FROM users;
</code></pre>
<hr />
<h2 id="common-database-tools"><a class="header" href="#common-database-tools">Common Database Tools</a></h2>
<ul>
<li><strong>MySQL Workbench</strong>: GUI for MySQL</li>
<li><strong>pgAdmin</strong>: GUI for PostgreSQL</li>
<li><strong>DBeaver</strong>: Universal database tool</li>
<li><strong>TablePlus</strong>: Modern database client</li>
<li><strong>DataGrip</strong>: JetBrains database IDE</li>
</ul>
<hr />
<h2 id="command-line-tools"><a class="header" href="#command-line-tools">Command Line Tools</a></h2>
<pre><code class="language-bash"># MySQL
mysql -u root -p
mysql -u root -p database_name &lt; backup.sql
mysqldump -u root -p database_name &gt; backup.sql

# PostgreSQL
psql -U postgres
psql -U postgres database_name &lt; backup.sql
pg_dump database_name &gt; backup.sql

# SQLite
sqlite3 database.db
.tables
.schema table_name
.quit
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="interview-questions"><a class="header" href="#interview-questions">Interview Questions</a></h1>
<h2 id="leetcode-patterns"><a class="header" href="#leetcode-patterns">LeetCode Patterns</a></h2>
<p>LeetCode is a popular platform for practicing coding problems and preparing for technical interviews. Many problems on LeetCode can be categorized into specific patterns. Understanding these patterns can help you approach and solve problems more efficiently. Here are some common LeetCode patterns:</p>
<h3 id="1-sliding-window"><a class="header" href="#1-sliding-window">1. Sliding Window</a></h3>
<p>The sliding window pattern is used to solve problems that involve a contiguous sequence of elements, such as subarrays or substrings. This pattern helps in reducing the time complexity by avoiding redundant calculations.</p>
<p><strong>Example Problem:</strong> Find the maximum sum of a subarray of size <code>k</code>.</p>
<h3 id="2-two-pointers"><a class="header" href="#2-two-pointers">2. Two Pointers</a></h3>
<p>The two pointers pattern is used to solve problems involving sorted arrays or linked lists. It involves using two pointers to iterate through the data structure, often from opposite ends, to find pairs or subarrays that meet certain criteria.</p>
<p><strong>Example Problem:</strong> Find two numbers in a sorted array that add up to a given target.</p>
<h3 id="3-fast-and-slow-pointers"><a class="header" href="#3-fast-and-slow-pointers">3. Fast and Slow Pointers</a></h3>
<p>The fast and slow pointers pattern is used to detect cycles in linked lists or arrays. The fast pointer moves twice as fast as the slow pointer, and if there is a cycle, they will eventually meet.</p>
<p><strong>Example Problem:</strong> Detect a cycle in a linked list.</p>
<h3 id="4-merge-intervals"><a class="header" href="#4-merge-intervals">4. Merge Intervals</a></h3>
<p>The merge intervals pattern is used to solve problems that involve overlapping intervals. This pattern helps in merging overlapping intervals and simplifying the problem.</p>
<p><strong>Example Problem:</strong> Merge overlapping intervals in a list of intervals.</p>
<h3 id="5-cyclic-sort"><a class="header" href="#5-cyclic-sort">5. Cyclic Sort</a></h3>
<p>The cyclic sort pattern is used to solve problems involving arrays where the elements are in a range from 1 to <code>n</code>. This pattern helps in placing each element at its correct index.</p>
<p><strong>Example Problem:</strong> Find the missing number in an array of size <code>n</code> containing numbers from 1 to <code>n</code>.</p>
<h3 id="6-in-place-reversal-of-a-linked-list"><a class="header" href="#6-in-place-reversal-of-a-linked-list">6. In-place Reversal of a Linked List</a></h3>
<p>The in-place reversal of a linked list pattern is used to solve problems that require reversing a portion of a linked list. This pattern helps in reversing the nodes of the linked list in-place without using extra space.</p>
<p><strong>Example Problem:</strong> Reverse a sublist of a linked list from position <code>m</code> to <code>n</code>.</p>
<h3 id="7-tree-bfs-breadth-first-search"><a class="header" href="#7-tree-bfs-breadth-first-search">7. Tree BFS (Breadth-First Search)</a></h3>
<p>The tree BFS pattern is used to solve problems involving tree traversal. This pattern helps in traversing the tree level by level and is useful for problems that require processing nodes in a specific order.</p>
<p><strong>Example Problem:</strong> Find the level order traversal of a binary tree.</p>
<h3 id="8-tree-dfs-depth-first-search"><a class="header" href="#8-tree-dfs-depth-first-search">8. Tree DFS (Depth-First Search)</a></h3>
<p>The tree DFS pattern is used to solve problems involving tree traversal. This pattern helps in traversing the tree depth-wise and is useful for problems that require exploring all paths from the root to the leaves.</p>
<p><strong>Example Problem:</strong> Find all root-to-leaf paths in a binary tree.</p>
<h3 id="9-two-heaps"><a class="header" href="#9-two-heaps">9. Two Heaps</a></h3>
<p>The two heaps pattern is used to solve problems that require finding the median of a data stream. This pattern involves using two heaps (a max-heap and a min-heap) to maintain the median efficiently.</p>
<p><strong>Example Problem:</strong> Find the median of a data stream.</p>
<h3 id="10-subsets"><a class="header" href="#10-subsets">10. Subsets</a></h3>
<p>The subsets pattern is used to solve problems that involve generating all possible subsets of a given set. This pattern helps in exploring all combinations and permutations of the elements.</p>
<p><strong>Example Problem:</strong> Generate all subsets of a given set of numbers.</p>
<h3 id="11-modified-binary-search"><a class="header" href="#11-modified-binary-search">11. Modified Binary Search</a></h3>
<p>The modified binary search pattern is used to solve problems that involve searching in a sorted array or matrix. This pattern helps in reducing the search space by half in each step.</p>
<p><strong>Example Problem:</strong> Find the peak element in a mountain array.</p>
<h3 id="12-topological-sort"><a class="header" href="#12-topological-sort">12. Topological Sort</a></h3>
<p>The topological sort pattern is used to solve problems involving directed acyclic graphs (DAGs). This pattern helps in ordering the nodes of the graph in a linear sequence based on their dependencies.</p>
<p><strong>Example Problem:</strong> Find the order of courses to take given their prerequisites.</p>
<h3 id="13-k-way-merge"><a class="header" href="#13-k-way-merge">13. K-way Merge</a></h3>
<p>The k-way merge pattern is used to solve problems that involve merging multiple sorted arrays or lists. This pattern helps in efficiently merging the arrays using a min-heap.</p>
<p><strong>Example Problem:</strong> Merge <code>k</code> sorted linked lists.</p>
<h3 id="14-knapsack-dynamic-programming"><a class="header" href="#14-knapsack-dynamic-programming">14. Knapsack (Dynamic Programming)</a></h3>
<p>The knapsack pattern is used to solve problems that involve selecting items with given weights and values to maximize the total value without exceeding a weight limit. This pattern helps in solving optimization problems using dynamic programming.</p>
<p><strong>Example Problem:</strong> Find the maximum value that can be obtained by selecting items with given weights and values.</p>
<p>Understanding these patterns and practicing problems based on them can significantly improve your problem-solving skills and help you perform better in technical interviews.</p>
<h3 id="15-stacks"><a class="header" href="#15-stacks">15. Stacks</a></h3>
<p>The stack pattern is used to solve problems that involve processing elements in a last-in, first-out (LIFO) order. This pattern helps in managing function calls, parsing expressions, and backtracking problems.</p>
<p><strong>Example Problem:</strong> Evaluate a postfix expression.</p>
<p>Understanding these patterns and practicing problems based on them can significantly improve your problem-solving skills and help you perform better in technical interviews.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="design-patterns"><a class="header" href="#design-patterns">Design Patterns</a></h1>
<p>// Start Generation Here</p>
<h2 id="introduction-to-design-patterns"><a class="header" href="#introduction-to-design-patterns">Introduction to Design Patterns</a></h2>
<p>Design patterns are proven solutions to common problems encountered in software development. They provide a standardized approach to solving issues related to object creation, structure, and behavior, promoting code reusability, scalability, and maintainability. Understanding design patterns is essential for building robust and efficient software systems.</p>
<h3 id="categories-of-design-patterns"><a class="header" href="#categories-of-design-patterns">Categories of Design Patterns</a></h3>
<p>Design patterns are typically categorized into three main types:</p>
<ol>
<li><strong>Creational Patterns</strong>: Focus on object creation mechanisms, aiming to create objects in a manner suitable to the situation.</li>
<li><strong>Structural Patterns</strong>: Deal with object composition, identifying simple ways to realize relationships between objects.</li>
<li><strong>Behavioral Patterns</strong>: Concerned with communication between objects, highlighting patterns of interaction.</li>
</ol>
<h2 id="list-of-design-patterns-and-their-uses"><a class="header" href="#list-of-design-patterns-and-their-uses">List of Design Patterns and Their Uses</a></h2>
<h3 id="creational-patterns"><a class="header" href="#creational-patterns">Creational Patterns</a></h3>
<ol>
<li>
<p><strong>Singleton</strong>: Ensures a class has only one instance and provides a global point of access to it. Useful for managing shared resources like logging or configuration settings.</p>
</li>
<li>
<p><strong>Factory Method</strong>: Defines an interface for creating an object but lets subclasses alter the type of objects that will be created. Useful for creating objects without specifying the exact class of the object to be created.</p>
</li>
<li>
<p><strong>Abstract Factory</strong>: Provides an interface for creating families of related or dependent objects without specifying their concrete classes. Useful when the system needs to be independent of how its objects are created.</p>
</li>
<li>
<p><strong>Builder</strong>: Separates the construction of a complex object from its representation, allowing the same construction process to create various representations. Useful for constructing complex objects step by step.</p>
</li>
<li>
<p><strong>Prototype</strong>: Specifies the kinds of objects to create using a prototypical instance and creates new objects by copying this prototype. Useful when object creation is expensive or complex.</p>
</li>
</ol>
<h3 id="structural-patterns"><a class="header" href="#structural-patterns">Structural Patterns</a></h3>
<ol>
<li>
<p><strong>Adapter</strong>: Allows incompatible interfaces to work together by converting the interface of one class into another expected by the clients. Useful when integrating legacy systems or third-party libraries.</p>
</li>
<li>
<p><strong>Bridge</strong>: Decouples an abstraction from its implementation so that the two can vary independently. Useful for handling multiple implementations of an abstraction.</p>
</li>
<li>
<p><strong>Composite</strong>: Composes objects into tree structures to represent part-whole hierarchies, allowing clients to treat individual objects and compositions uniformly. Useful for representing hierarchical structures like file systems.</p>
</li>
<li>
<p><strong>Decorator</strong>: Adds additional responsibilities to an object dynamically without altering its structure. Useful for enhancing functionalities of objects without subclassing.</p>
</li>
<li>
<p><strong>Facade</strong>: Provides a simplified interface to a complex subsystem, making the subsystem easier to use. Useful for reducing dependencies and simplifying client interaction.</p>
</li>
<li>
<p><strong>Flyweight</strong>: Reduces the cost of creating and maintaining a large number of similar objects by sharing as much data as possible. Useful for handling large numbers of objects efficiently.</p>
</li>
<li>
<p><strong>Proxy</strong>: Provides a surrogate or placeholder for another object to control access to it. Useful for lazy initialization, access control, or logging.</p>
</li>
</ol>
<h3 id="behavioral-patterns"><a class="header" href="#behavioral-patterns">Behavioral Patterns</a></h3>
<ol>
<li>
<p><strong>Chain of Responsibility</strong>: Passes a request along a chain of handlers, allowing each handler to process or pass it along. Useful for decoupling senders and receivers of requests.</p>
</li>
<li>
<p><strong>Command</strong>: Encapsulates a request as an object, thereby allowing for parameterization and queuing of requests. Useful for implementing undoable operations or task scheduling.</p>
</li>
<li>
<p><strong>Interpreter</strong>: Defines a representation for a language's grammar and interprets sentences in the language. Useful for parsing and interpreting expressions or languages.</p>
</li>
<li>
<p><strong>Iterator</strong>: Provides a way to access elements of an aggregate object sequentially without exposing its underlying representation. Useful for traversing collections.</p>
</li>
<li>
<p><strong>Mediator</strong>: Defines an object that encapsulates how a set of objects interact, promoting loose coupling by keeping objects from referring to each other explicitly. Useful for reducing complexity in object interactions.</p>
</li>
<li>
<p><strong>Memento</strong>: Captures and externalizes an object's internal state without violating encapsulation, allowing the object to be restored to this state later. Useful for implementing undo functionality.</p>
</li>
<li>
<p><strong>Observer</strong>: Defines a one-to-many dependency between objects so that when one object changes state, all its dependents are notified and updated automatically. Useful for event handling and implementing distributed event systems.</p>
</li>
<li>
<p><strong>State</strong>: Allows an object to alter its behavior when its internal state changes, appearing as if it has changed its class. Useful for managing state-dependent behavior.</p>
</li>
<li>
<p><strong>Strategy</strong>: Defines a family of algorithms, encapsulates each one, and makes them interchangeable, allowing the algorithm to vary independently from clients that use it. Useful for selecting algorithms dynamically at runtime.</p>
</li>
<li>
<p><strong>Template Method</strong>: Defines the skeleton of an algorithm in a method, deferring some steps to subclasses, allowing subclasses to redefine certain steps without changing the algorithm's structure. Useful for implementing invariant parts of an algorithm and varying certain steps.</p>
</li>
<li>
<p><strong>Visitor</strong>: Represents an operation to be performed on elements of an object structure, allowing new operations to be added without modifying the classes of the elements on which it operates. Useful for separating algorithms from object structures.</p>
</li>
</ol>
<h3 id="creational-patterns-1"><a class="header" href="#creational-patterns-1">Creational Patterns</a></h3>
<h4 id="singleton-pattern-4"><a class="header" href="#singleton-pattern-4">Singleton Pattern</a></h4>
<p>The Singleton Pattern ensures that a class has only one instance and provides a global point of access to it. This is useful when exactly one object is needed to coordinate actions across the system.</p>
<p><strong>Example Scenario</strong>: Implementing a logger where a single instance manages all logging operations.</p>
<p><strong>Example Implementation in C++:</strong></p>
<pre><code class="language-cpp">#include &lt;iostream&gt;
#include &lt;mutex&gt;

class Logger {
public:
    // Static method to get the single instance
    static Logger&amp; getInstance() {
        static Logger instance; // Guaranteed to be destroyed and instantiated on first use
        return instance;
    }

    // Delete copy constructor and assignment operator to prevent copies
    Logger(const Logger&amp;) = delete;
    Logger&amp; operator=(const Logger&amp;) = delete;

    // Public method to log messages
    void log(const std::string&amp; message) {
        std::lock_guard&lt;std::mutex&gt; lock(mutex_);
        std::cout &lt;&lt; "Log: " &lt;&lt; message &lt;&lt; std::endl;
    }

private:
    Logger() {} // Private constructor
    std::mutex mutex_;
};

int main() {
    Logger::getInstance().log("Application started.");
    Logger::getInstance().log("An error occurred.");
    return 0;
}
</code></pre>
<p><strong>Explanation</strong>:</p>
<ul>
<li>The <code>Logger</code> class has a private constructor to prevent direct instantiation.</li>
<li>The static method <code>getInstance()</code> returns a reference to the single <code>Logger</code> instance.</li>
<li>Copy constructor and assignment operator are deleted to prevent creating additional instances.</li>
<li>A mutex is used to ensure thread-safe logging operations.</li>
</ul>
<h3 id="structural-patterns-1"><a class="header" href="#structural-patterns-1">Structural Patterns</a></h3>
<h4 id="adapter-pattern"><a class="header" href="#adapter-pattern">Adapter Pattern</a></h4>
<p>The Adapter Pattern allows incompatible interfaces to work together. It acts as a bridge between two incompatible interfaces, enabling classes to collaborate without modifying their existing code.</p>
<p><strong>Example Scenario</strong>: Integrating a new payment system into an existing application that expects a different payment interface.</p>
<p><strong>Example Implementation in C++:</strong></p>
<pre><code class="language-cpp">#include &lt;iostream&gt;

// Existing interface expected by the application
class PaymentProcessor {
public:
    virtual void pay(int amount) = 0;
};

// New payment system with a different interface
class NewPaymentSystem {
public:
    void makePayment(int amount) {
        std::cout &lt;&lt; "Processing payment of $" &lt;&lt; amount &lt;&lt; " through the new system." &lt;&lt; std::endl;
    }
};

// Adapter to make NewPaymentSystem compatible with PaymentProcessor
class PaymentAdapter : public PaymentProcessor {
public:
    PaymentAdapter(NewPaymentSystem* newPaymentSystem) : newPaymentSystem_(newPaymentSystem) {}

    void pay(int amount) override {
        newPaymentSystem_-&gt;makePayment(amount);
    }

private:
    NewPaymentSystem* newPaymentSystem_;
};

int main() {
    NewPaymentSystem newSystem;
    PaymentAdapter adapter(&amp;newSystem);
    adapter.pay(100); // Output: Processing payment of $100 through the new system.
    return 0;
}
</code></pre>
<p><strong>Explanation</strong>:</p>
<ul>
<li><code>PaymentProcessor</code> is the existing interface that the application expects.</li>
<li><code>NewPaymentSystem</code> is the new class with an incompatible interface (<code>makePayment</code> method).</li>
<li><code>PaymentAdapter</code> implements <code>PaymentProcessor</code> and internally uses an instance of <code>NewPaymentSystem</code> to fulfill the <code>pay</code> request.</li>
</ul>
<h3 id="behavioral-patterns-1"><a class="header" href="#behavioral-patterns-1">Behavioral Patterns</a></h3>
<h4 id="observer-pattern-2"><a class="header" href="#observer-pattern-2">Observer Pattern</a></h4>
<p>The Observer Pattern defines a one-to-many dependency between objects so that when one object changes state, all its dependents are notified and updated automatically. This pattern is commonly used in event handling systems.</p>
<p><strong>Example Scenario</strong>: Implementing a publish-subscribe mechanism where multiple subscribers listen to updates from a publisher.</p>
<p><strong>Example Implementation in C++:</strong></p>
<pre><code class="language-cpp">#include &lt;iostream&gt;
#include &lt;vector&gt;
#include &lt;string&gt;

// Observer interface
class Observer {
public:
    virtual void update(const std::string&amp; message) = 0;
};

// Subject class
class Subject {
public:
    void addObserver(Observer* observer) {
        observers_.push_back(observer);
    }

    void notify(const std::string&amp; message) {
        for(auto observer : observers_) {
            observer-&gt;update(message);
        }
    }

private:
    std::vector&lt;Observer*&gt; observers_;
};

// Concrete Observer
class ConcreteObserver : public Observer {
public:
    ConcreteObserver(const std::string&amp; name) : name_(name) {}

    void update(const std::string&amp; message) override {
        std::cout &lt;&lt; name_ &lt;&lt; " received message: " &lt;&lt; message &lt;&lt; std::endl;
    }

private:
    std::string name_;
};

int main() {
    Subject subject;

    ConcreteObserver observer1("Observer 1");
    ConcreteObserver observer2("Observer 2");

    subject.addObserver(&amp;observer1);
    subject.addObserver(&amp;observer2);

    subject.notify("Event occurred!");

    return 0;
}
</code></pre>
<p><strong>Explanation</strong>:</p>
<ul>
<li><code>Observer</code> is an interface with an <code>update</code> method.</li>
<li><code>Subject</code> maintains a list of observers and notifies them of events.</li>
<li><code>ConcreteObserver</code> implements the <code>Observer</code> interface and reacts to notifications.</li>
<li>In <code>main</code>, observers are added to the subject, and when <code>notify</code> is called, all observers receive the message.</li>
</ul>
<h2 id="conclusion"><a class="header" href="#conclusion">Conclusion</a></h2>
<p>Design patterns are invaluable tools for software developers, providing standardized solutions to recurring design problems. By understanding and applying appropriate design patterns, developers can create more flexible, reusable, and maintainable codebases.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="linux-documentation"><a class="header" href="#linux-documentation">Linux Documentation</a></h1>
<p>A comprehensive guide to Linux system administration, commands, kernel architecture, and networking.</p>
<h2 id="table-of-contents-2"><a class="header" href="#table-of-contents-2">Table of Contents</a></h2>
<ol>
<li><a href="linux/./commands.html">Essential Commands</a> - Command reference and examples</li>
<li><a href="linux/./kernel.html">Kernel Architecture</a> - Linux kernel internals and development</li>
<li><a href="linux/./kernel_patterns.html">Kernel Development Patterns</a> - Common patterns and best practices for kernel development</li>
<li><a href="linux/./cfg80211_mac80211.html">cfg80211 &amp; mac80211</a> - Wireless subsystem frameworks for WiFi drivers</li>
<li><a href="linux/./driver_development.html">Driver Development</a> - Linux driver model and device driver development</li>
<li><a href="linux/./device_tree.html">Device Tree</a> - Hardware description using Device Tree</li>
<li><a href="linux/./cross_compilation.html">Cross Compilation</a> - Building for different architectures</li>
<li><a href="linux/./networking.html">Networking</a> - Network configuration and troubleshooting</li>
<li><a href="linux/./netfilter.html">Netfilter</a> - Packet filtering framework</li>
<li><a href="linux/./iptables.html">iptables</a> - Firewall configuration</li>
<li><a href="linux/./tc.html">Traffic Control (tc)</a> - Network traffic management</li>
<li><a href="linux/./systemd.html">systemd</a> - Service management and init system</li>
<li><a href="linux/./sysctl.html">sysctl</a> - Kernel parameter tuning at runtime</li>
<li><a href="linux/./sysfs.html">sysfs</a> - Kernel/hardware information filesystem</li>
</ol>
<h2 id="overview-11"><a class="header" href="#overview-11">Overview</a></h2>
<p>This documentation covers essential Linux topics for system administrators, developers, and power users. Each section provides practical examples, use cases, and best practices.</p>
<h2 id="getting-started"><a class="header" href="#getting-started">Getting Started</a></h2>
<h3 id="for-beginners"><a class="header" href="#for-beginners">For Beginners</a></h3>
<p>Start with <a href="linux/./commands.html">Essential Commands</a> to learn the fundamental Linux commands that you'll use daily.</p>
<h3 id="for-system-administrators"><a class="header" href="#for-system-administrators">For System Administrators</a></h3>
<ul>
<li><a href="linux/./commands.html">Essential Commands</a> - Master command-line tools</li>
<li><a href="linux/./networking.html">Networking</a> - Network configuration and diagnostics</li>
<li><a href="linux/./iptables.html">iptables</a> - Firewall management</li>
</ul>
<h3 id="for-developers"><a class="header" href="#for-developers">For Developers</a></h3>
<ul>
<li><a href="linux/./kernel.html">Kernel Architecture</a> - Understand Linux internals</li>
<li><a href="linux/./kernel_patterns.html">Kernel Development Patterns</a> - Coding patterns and best practices</li>
<li><a href="linux/./driver_development.html">Driver Development</a> - Linux driver model and device drivers</li>
<li><a href="linux/./device_tree.html">Device Tree</a> - Hardware description and parsing</li>
<li><a href="linux/./cross_compilation.html">Cross Compilation</a> - Building for embedded systems</li>
<li><a href="linux/./cfg80211_mac80211.html">cfg80211 &amp; mac80211</a> - Wireless driver development</li>
<li><a href="linux/./commands.html">Essential Commands</a> - Development and debugging tools</li>
</ul>
<h3 id="for-network-engineers"><a class="header" href="#for-network-engineers">For Network Engineers</a></h3>
<ul>
<li><a href="linux/./networking.html">Networking</a> - Network stack and protocols</li>
<li><a href="linux/./cfg80211_mac80211.html">cfg80211 &amp; mac80211</a> - Wireless networking subsystem</li>
<li><a href="linux/./netfilter.html">Netfilter</a> - Packet filtering framework</li>
<li><a href="linux/./tc.html">Traffic Control</a> - QoS and traffic shaping</li>
</ul>
<h2 id="key-topics"><a class="header" href="#key-topics">Key Topics</a></h2>
<h3 id="system-administration"><a class="header" href="#system-administration">System Administration</a></h3>
<ul>
<li>User and permission management</li>
<li>Process management and monitoring</li>
<li>System resource monitoring</li>
<li>Service management with systemd</li>
<li>Log management and analysis</li>
</ul>
<h3 id="kernel-development"><a class="header" href="#kernel-development">Kernel Development</a></h3>
<ul>
<li>Kernel architecture and components</li>
<li>System calls and kernel modules</li>
<li>Device drivers</li>
<li>Kernel compilation and debugging</li>
</ul>
<h3 id="networking"><a class="header" href="#networking">Networking</a></h3>
<ul>
<li>Network configuration (ip, ifconfig)</li>
<li>Routing and bridging</li>
<li>Packet filtering (iptables, nftables)</li>
<li>Traffic shaping and QoS</li>
<li>Network troubleshooting</li>
</ul>
<h2 id="quick-reference-1"><a class="header" href="#quick-reference-1">Quick Reference</a></h2>
<h3 id="most-used-commands"><a class="header" href="#most-used-commands">Most Used Commands</a></h3>
<pre><code class="language-bash"># File operations
ls -lah                    # List files with details
cd /path/to/directory      # Change directory
cp -r source dest          # Copy recursively
mv source dest             # Move/rename
rm -rf directory           # Remove recursively

# Text processing
grep pattern file          # Search for pattern
sed 's/old/new/g' file     # Replace text
awk '{print $1}' file      # Process columns

# System monitoring
top                        # Process viewer
htop                       # Enhanced process viewer
ps aux                     # List all processes
df -h                      # Disk usage
free -h                    # Memory usage

# Network
ip addr show               # Show IP addresses
ss -tulpn                  # Show listening ports
ping host                  # Test connectivity
curl url                   # HTTP client
</code></pre>
<h3 id="system-information"><a class="header" href="#system-information">System Information</a></h3>
<pre><code class="language-bash">uname -a                   # Kernel version
lsb_release -a             # Distribution info
hostnamectl                # System hostname
uptime                     # System uptime
</code></pre>
<h2 id="learning-path"><a class="header" href="#learning-path">Learning Path</a></h2>
<ol>
<li>
<p><strong>Basics</strong> (1-2 weeks)</p>
<ul>
<li>File system navigation</li>
<li>File manipulation</li>
<li>Text editors (vim, nano)</li>
<li>Basic shell scripting</li>
</ul>
</li>
<li>
<p><strong>Intermediate</strong> (2-4 weeks)</p>
<ul>
<li>Process management</li>
<li>User management</li>
<li>Permissions and ownership</li>
<li>Package management</li>
<li>System services</li>
</ul>
</li>
<li>
<p><strong>Advanced</strong> (1-3 months)</p>
<ul>
<li>Kernel modules</li>
<li>Network configuration</li>
<li>Firewall rules</li>
<li>Performance tuning</li>
<li>Security hardening</li>
</ul>
</li>
<li>
<p><strong>Expert</strong> (3-6 months)</p>
<ul>
<li>Kernel development</li>
<li>Custom modules</li>
<li>Advanced networking</li>
<li>High availability systems</li>
<li>Container orchestration</li>
</ul>
</li>
</ol>
<h2 id="best-practices-14"><a class="header" href="#best-practices-14">Best Practices</a></h2>
<h3 id="security"><a class="header" href="#security">Security</a></h3>
<ul>
<li>Always use sudo instead of root login</li>
<li>Keep system and packages updated</li>
<li>Use SSH keys instead of passwords</li>
<li>Enable and configure firewall</li>
<li>Regular security audits</li>
<li>Monitor system logs</li>
</ul>
<h3 id="performance-1"><a class="header" href="#performance-1">Performance</a></h3>
<ul>
<li>Monitor system resources regularly</li>
<li>Use appropriate file systems</li>
<li>Optimize kernel parameters</li>
<li>Implement proper backup strategies</li>
<li>Use automation tools</li>
</ul>
<h3 id="documentation-1"><a class="header" href="#documentation-1">Documentation</a></h3>
<ul>
<li>Document custom configurations</li>
<li>Keep change logs</li>
<li>Use version control for configs</li>
<li>Create runbooks for common tasks</li>
</ul>
<h2 id="useful-resources-1"><a class="header" href="#useful-resources-1">Useful Resources</a></h2>
<h3 id="official-documentation"><a class="header" href="#official-documentation">Official Documentation</a></h3>
<ul>
<li><a href="https://www.kernel.org/doc/html/latest/">Linux Kernel Documentation</a></li>
<li><a href="https://www.gnu.org/software/coreutils/manual/">GNU Core Utilities</a></li>
<li><a href="https://www.freedesktop.org/wiki/Software/systemd/">systemd Documentation</a></li>
</ul>
<h3 id="community-resources"><a class="header" href="#community-resources">Community Resources</a></h3>
<ul>
<li><a href="https://tldp.org/">Linux Documentation Project</a></li>
<li><a href="https://wiki.archlinux.org/">Arch Wiki</a></li>
<li><a href="https://help.ubuntu.com/">Ubuntu Documentation</a></li>
</ul>
<h3 id="books"><a class="header" href="#books">Books</a></h3>
<ul>
<li>"The Linux Command Line" by William Shotts</li>
<li>"Linux Kernel Development" by Robert Love</li>
<li>"UNIX and Linux System Administration Handbook"</li>
</ul>
<h2 id="contributing"><a class="header" href="#contributing">Contributing</a></h2>
<p>When adding new documentation:</p>
<ol>
<li>Follow the existing structure</li>
<li>Include practical examples</li>
<li>Add use cases and scenarios</li>
<li>Reference related sections</li>
<li>Keep examples tested and working</li>
</ol>
<h2 id="version-information"><a class="header" href="#version-information">Version Information</a></h2>
<ul>
<li>Documentation maintained for Linux Kernel 5.x and 6.x</li>
<li>Examples tested on Ubuntu 20.04/22.04 and Debian 11/12</li>
<li>Command syntax may vary slightly between distributions</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="networking-1"><a class="header" href="#networking-1">Networking</a></h1>
<h2 id="tun-and-tap-interfaces"><a class="header" href="#tun-and-tap-interfaces">TUN and TAP Interfaces</a></h2>
<p>TUN and TAP are virtual network kernel interfaces. They are used to create network interfaces that operate at different layers of the network stack.</p>
<h3 id="tun-interface"><a class="header" href="#tun-interface">TUN Interface</a></h3>
<p>A TUN (network TUNnel) interface is a virtual point-to-point network device that operates at the network layer (Layer 3). It is used to route IP packets. TUN interfaces are commonly used in VPN (Virtual Private Network) implementations to tunnel IP traffic over a secure connection.</p>
<h4 id="key-features-of-tun-interface"><a class="header" href="#key-features-of-tun-interface">Key Features of TUN Interface:</a></h4>
<ul>
<li>Operates at Layer 3 (Network Layer).</li>
<li>Handles IP packets.</li>
<li>Used for routing and tunneling IP traffic.</li>
<li>Commonly used in VPNs.</li>
</ul>
<h4 id="example-use-case"><a class="header" href="#example-use-case">Example Use Case:</a></h4>
<p>A TUN interface can be used to create a secure VPN connection between two remote networks, allowing them to communicate as if they were on the same local network.</p>
<h3 id="tap-interface"><a class="header" href="#tap-interface">TAP Interface</a></h3>
<p>A TAP (network TAP) interface is a virtual network device that operates at the data link layer (Layer 2). It is used to handle Ethernet frames. TAP interfaces are useful for creating network bridges and for virtual machine networking.</p>
<h4 id="key-features-of-tap-interface"><a class="header" href="#key-features-of-tap-interface">Key Features of TAP Interface:</a></h4>
<ul>
<li>Operates at Layer 2 (Data Link Layer).</li>
<li>Handles Ethernet frames.</li>
<li>Used for bridging and virtual machine networking.</li>
<li>Can be used to create virtual switches.</li>
</ul>
<h4 id="example-use-case-1"><a class="header" href="#example-use-case-1">Example Use Case:</a></h4>
<p>A TAP interface can be used to connect a virtual machine to a virtual switch, allowing the virtual machine to communicate with other virtual machines and the host system as if they were connected to a physical Ethernet switch.</p>
<h3 id="creating-tun-and-tap-interfaces"><a class="header" href="#creating-tun-and-tap-interfaces">Creating TUN and TAP Interfaces</a></h3>
<p>TUN and TAP interfaces can be created and managed using the <code>ip</code> command or the <code>tunctl</code> utility. Here is an example of how to create a TUN interface using the <code>ip</code> command:</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="linux-kernel-architecture"><a class="header" href="#linux-kernel-architecture">Linux Kernel Architecture</a></h1>
<p>A comprehensive guide to Linux kernel internals, architecture, system calls, modules, compilation, and debugging.</p>
<h2 id="table-of-contents-3"><a class="header" href="#table-of-contents-3">Table of Contents</a></h2>
<ol>
<li><a href="linux/kernel.html#kernel-overview">Kernel Overview</a></li>
<li><a href="linux/kernel.html#kernel-architecture">Kernel Architecture</a></li>
<li><a href="linux/kernel.html#memory-management">Memory Management</a></li>
<li><a href="linux/kernel.html#process-management">Process Management</a></li>
<li><a href="linux/kernel.html#system-calls">System Calls</a></li>
<li><a href="linux/kernel.html#kernel-modules">Kernel Modules</a></li>
<li><a href="linux/kernel.html#device-drivers">Device Drivers</a></li>
<li><a href="linux/kernel.html#file-systems">File Systems</a></li>
<li><a href="linux/kernel.html#networking-stack">Networking Stack</a></li>
<li><a href="linux/kernel.html#kernel-compilation">Kernel Compilation</a></li>
<li><a href="linux/kernel.html#kernel-debugging">Kernel Debugging</a></li>
<li><a href="linux/kernel.html#performance-tuning">Performance Tuning</a></li>
</ol>
<hr />
<h2 id="kernel-overview"><a class="header" href="#kernel-overview">Kernel Overview</a></h2>
<p>The Linux kernel is a monolithic kernel that handles all system operations including process management, memory management, device drivers, and system calls.</p>
<h3 id="kernel-architecture-types"><a class="header" href="#kernel-architecture-types">Kernel Architecture Types</a></h3>
<p><strong>Monolithic Kernel (Linux)</strong></p>
<ul>
<li>All services run in kernel space</li>
<li>Better performance (no context switching)</li>
<li>Single address space</li>
<li>Larger kernel size</li>
</ul>
<p><strong>Microkernel</strong></p>
<ul>
<li>Minimal kernel (IPC, memory, scheduling)</li>
<li>Services run in user space</li>
<li>Better stability and security</li>
<li>More context switches</li>
</ul>
<p><strong>Hybrid Kernel</strong></p>
<ul>
<li>Combination of both approaches</li>
<li>Examples: Windows NT, macOS</li>
</ul>
<h3 id="linux-kernel-features"><a class="header" href="#linux-kernel-features">Linux Kernel Features</a></h3>
<pre><code>- Preemptive multitasking
- Symmetric multiprocessing (SMP)
- Virtual memory management
- Loadable kernel modules
- Multiple filesystem support
- POSIX compliance
- Dynamic kernel memory allocation
- Networking stack (TCP/IP, IPv6)
- Advanced security features (SELinux, AppArmor)
- Real-time capabilities (PREEMPT_RT)
</code></pre>
<h3 id="kernel-version-numbering"><a class="header" href="#kernel-version-numbering">Kernel Version Numbering</a></h3>
<pre><code class="language-bash"># Check kernel version
uname -r
# Output: 6.5.0-15-generic

# Format: MAJOR.MINOR.PATCH-BUILD-ARCH
# 6.5.0 - kernel version
# 15 - distribution build number
# generic - kernel flavor/variant
</code></pre>
<p><strong>Version Types:</strong></p>
<ul>
<li><strong>Mainline</strong> - Latest features, active development</li>
<li><strong>Stable</strong> - Production-ready, bug fixes only</li>
<li><strong>LTS (Long Term Support)</strong> - Extended maintenance (2-6 years)</li>
<li><strong>EOL (End of Life)</strong> - No longer maintained</li>
</ul>
<h3 id="kernel-source-tree-structure"><a class="header" href="#kernel-source-tree-structure">Kernel Source Tree Structure</a></h3>
<pre><code>/usr/src/linux/
├── arch/           # Architecture-specific code (x86, ARM, etc.)
├── block/          # Block device drivers
├── crypto/         # Cryptographic API
├── Documentation/  # Kernel documentation
├── drivers/        # Device drivers
│   ├── char/       # Character devices
│   ├── block/      # Block devices
│   ├── net/        # Network devices
│   ├── gpu/        # Graphics drivers
│   └── usb/        # USB drivers
├── fs/             # File system implementations
│   ├── ext4/       # ext4 filesystem
│   ├── btrfs/      # Btrfs filesystem
│   └── nfs/        # Network file system
├── include/        # Header files
│   ├── linux/      # Linux-specific headers
│   └── uapi/       # User-space API headers
├── init/           # Kernel initialization
├── ipc/            # Inter-process communication
├── kernel/         # Core kernel code
│   ├── sched/      # Process scheduler
│   ├── time/       # Time management
│   └── irq/        # Interrupt handling
├── lib/            # Library routines
├── mm/             # Memory management
├── net/            # Networking stack
│   ├── ipv4/       # IPv4 implementation
│   ├── ipv6/       # IPv6 implementation
│   └── core/       # Core networking
├── samples/        # Sample code
├── scripts/        # Build scripts
├── security/       # Security modules (SELinux, AppArmor)
├── sound/          # Sound drivers
└── tools/          # Kernel tools and utilities
</code></pre>
<hr />
<h2 id="kernel-architecture"><a class="header" href="#kernel-architecture">Kernel Architecture</a></h2>
<h3 id="kernel-space-vs-user-space"><a class="header" href="#kernel-space-vs-user-space">Kernel Space vs User Space</a></h3>
<pre><code>+------------------------------------------+
|           User Space (Ring 3)            |
| +--------------------------------------+ |
| | User Applications                    | |
| | (web browsers, editors, games, etc.) | |
| +--------------------------------------+ |
|                   ↕                      |
| +--------------------------------------+ |
| | System Libraries (glibc, etc.)       | |
| +--------------------------------------+ |
+------------------------------------------+
                   ↕
         System Call Interface
                   ↕
+------------------------------------------+
|         Kernel Space (Ring 0)            |
| +--------------------------------------+ |
| | System Call Interface                | |
| +--------------------------------------+ |
| | Process    | Memory   | File System | |
| | Management | Manager  | Layer       | |
| +--------------------------------------+ |
| | Network    | IPC      | Security    | |
| | Stack      | Layer    | Modules     | |
| +--------------------------------------+ |
| | Device Drivers                       | |
| | (char, block, network)               | |
| +--------------------------------------+ |
| | Architecture-Specific Code           | |
| | (CPU, MMU, interrupts)               | |
| +--------------------------------------+ |
+------------------------------------------+
                   ↕
            Hardware Layer
</code></pre>
<h3 id="key-kernel-components"><a class="header" href="#key-kernel-components">Key Kernel Components</a></h3>
<h4 id="1-process-scheduler"><a class="header" href="#1-process-scheduler">1. Process Scheduler</a></h4>
<p>Manages CPU time allocation among processes.</p>
<pre><code class="language-c">// Scheduling classes (from highest to lowest priority)
1. SCHED_DEADLINE  // Deadline scheduling (real-time)
2. SCHED_FIFO      // First-in-first-out (real-time)
3. SCHED_RR        // Round-robin (real-time)
4. SCHED_NORMAL    // Standard time-sharing (CFS)
5. SCHED_BATCH     // Batch processes
6. SCHED_IDLE      // Very low priority

// Completely Fair Scheduler (CFS) - default for SCHED_NORMAL
// - Uses red-black tree for O(log n) operations
// - Virtual runtime tracking
// - Fair CPU time distribution
</code></pre>
<p><strong>Check and modify scheduling:</strong></p>
<pre><code class="language-bash"># View process scheduling info
ps -eo pid,pri,ni,comm,policy

# Change scheduling policy
chrt -f -p 99 PID        # Set to FIFO with priority 99
chrt -r -p 50 PID        # Set to Round-robin
chrt -o -p 0 PID         # Set to normal

# Change nice value (-20 to 19)
nice -n 10 command       # Run with nice value 10
renice -n 5 -p PID       # Change nice value of running process
</code></pre>
<h4 id="2-memory-manager"><a class="header" href="#2-memory-manager">2. Memory Manager</a></h4>
<p>Handles virtual memory, paging, and memory allocation.</p>
<pre><code>Virtual Memory Layout (64-bit x86):

0x00007FFFFFFFFFFF  +------------------+
                    | User Stack       | (grows down)
                    +------------------+
                    | Memory Mapped    |
                    | Files &amp; Libs     |
                    +------------------+
                    | Heap             | (grows up)
                    +------------------+
                    | BSS (uninit data)|
                    +------------------+
                    | Data (init data) |
                    +------------------+
0x0000000000400000  | Text (code)      |
                    +------------------+
                    | Reserved         |
0x0000000000000000  +------------------+

Kernel Space Layout:

0xFFFFFFFFFFFFFFFF  +------------------+
                    | Kernel Code/Data |
                    +------------------+
                    | Direct Mapping   |
                    | (Physical RAM)   |
                    +------------------+
                    | vmalloc Area     |
                    +------------------+
                    | Module Space     |
0xFFFF800000000000  +------------------+
</code></pre>
<p><strong>Memory zones:</strong></p>
<pre><code>ZONE_DMA       - Memory for DMA (0-16MB on x86)
ZONE_DMA32     - Memory for 32-bit DMA (0-4GB)
ZONE_NORMAL    - Normal memory (above 4GB on 64-bit)
ZONE_HIGHMEM   - High memory (not directly mapped, 32-bit only)
ZONE_MOVABLE   - Memory that can be migrated
</code></pre>
<h4 id="3-virtual-file-system-vfs"><a class="header" href="#3-virtual-file-system-vfs">3. Virtual File System (VFS)</a></h4>
<p>Abstract layer for file system operations.</p>
<pre><code class="language-c">// VFS Objects
struct super_block  // Mounted filesystem
struct inode        // File metadata
struct dentry       // Directory entry (name to inode mapping)
struct file         // Open file instance

// File operations structure
struct file_operations {
    ssize_t (*read) (struct file *, char __user *, size_t, loff_t *);
    ssize_t (*write) (struct file *, const char __user *, size_t, loff_t *);
    int (*open) (struct inode *, struct file *);
    int (*release) (struct inode *, struct file *);
    // ... more operations
};
</code></pre>
<h4 id="4-network-stack"><a class="header" href="#4-network-stack">4. Network Stack</a></h4>
<p>Implements network protocols and socket interface.</p>
<pre><code>Layer Model:

Application Layer
       ↕
Socket Interface
       ↕
Transport Layer (TCP/UDP)
       ↕
Network Layer (IP)
       ↕
Link Layer (Ethernet, WiFi)
       ↕
Device Driver
       ↕
Hardware
</code></pre>
<hr />
<h2 id="memory-management-1"><a class="header" href="#memory-management-1">Memory Management</a></h2>
<h3 id="page-management"><a class="header" href="#page-management">Page Management</a></h3>
<p>Linux uses paging for memory management:</p>
<pre><code class="language-bash"># Check page size
getconf PAGE_SIZE
# Usually 4096 bytes (4KB)

# View memory info
cat /proc/meminfo
# MemTotal, MemFree, MemAvailable, Buffers, Cached, etc.

# Memory statistics
vmstat 1
# View paging, memory, CPU stats every second

# Detailed memory usage
cat /proc/PID/status | grep -i vm
cat /proc/PID/maps    # Memory mappings
</code></pre>
<h3 id="memory-allocation"><a class="header" href="#memory-allocation">Memory Allocation</a></h3>
<p><strong>Kernel Memory Allocation:</strong></p>
<pre><code class="language-c">// Physically contiguous memory
kmalloc(size, GFP_KERNEL)     // Standard allocation
kfree(ptr)                     // Free memory

// Virtual contiguous memory
vmalloc(size)                  // Large allocations
vfree(ptr)

// Page-based allocation
alloc_pages(gfp_mask, order)   // 2^order pages
free_pages(addr, order)

// Flags (GFP = Get Free Pages)
GFP_KERNEL    // Standard, may sleep
GFP_ATOMIC    // Cannot sleep, for interrupts
GFP_USER      // User space allocation
GFP_DMA       // DMA-capable memory
</code></pre>
<h3 id="memory-reclamation"><a class="header" href="#memory-reclamation">Memory Reclamation</a></h3>
<p><strong>OOM Killer (Out-of-Memory):</strong></p>
<pre><code class="language-bash"># View OOM score (higher = more likely to be killed)
cat /proc/PID/oom_score

# Adjust OOM score (-1000 to 1000)
echo -500 &gt; /proc/PID/oom_score_adj  # Less likely to be killed
echo 500 &gt; /proc/PID/oom_score_adj   # More likely to be killed

# Disable OOM killer for process
echo -1000 &gt; /proc/PID/oom_score_adj

# View OOM killer logs
dmesg | grep -i "out of memory"
journalctl -k | grep -i "oom"
</code></pre>
<p><strong>Swapping:</strong></p>
<pre><code class="language-bash"># View swap usage
swapon --show
free -h

# Create swap file
dd if=/dev/zero of=/swapfile bs=1M count=1024
chmod 600 /swapfile
mkswap /swapfile
swapon /swapfile

# Control swappiness (0-100, default 60)
cat /proc/sys/vm/swappiness
echo 10 &gt; /proc/sys/vm/swappiness  # Less aggressive swapping

# Make permanent in /etc/sysctl.conf
vm.swappiness=10
</code></pre>
<h3 id="huge-pages"><a class="header" href="#huge-pages">Huge Pages</a></h3>
<p>Improve performance for applications with large memory footprints:</p>
<pre><code class="language-bash"># View huge page info
cat /proc/meminfo | grep -i huge

# Configure huge pages
echo 512 &gt; /proc/sys/vm/nr_hugepages

# Transparent Huge Pages (THP)
cat /sys/kernel/mm/transparent_hugepage/enabled
echo always &gt; /sys/kernel/mm/transparent_hugepage/enabled
echo madvise &gt; /sys/kernel/mm/transparent_hugepage/enabled  # Recommended
echo never &gt; /sys/kernel/mm/transparent_hugepage/enabled
</code></pre>
<hr />
<h2 id="process-management-1"><a class="header" href="#process-management-1">Process Management</a></h2>
<h3 id="process-representation"><a class="header" href="#process-representation">Process Representation</a></h3>
<pre><code class="language-c">// Task structure (Process Control Block)
struct task_struct {
    pid_t pid;                     // Process ID
    pid_t tgid;                    // Thread group ID
    struct task_struct *parent;    // Parent process
    struct list_head children;     // Child processes
    struct mm_struct *mm;          // Memory descriptor
    struct fs_struct *fs;          // Filesystem info
    struct files_struct *files;    // Open files
    int exit_state;                // Exit status
    unsigned int policy;           // Scheduling policy
    // ... many more fields
};
</code></pre>
<h3 id="process-states"><a class="header" href="#process-states">Process States</a></h3>
<pre><code class="language-c">TASK_RUNNING           // Running or ready to run
TASK_INTERRUPTIBLE     // Sleeping, can be woken by signals
TASK_UNINTERRUPTIBLE   // Sleeping, cannot be interrupted
TASK_STOPPED           // Stopped (e.g., by SIGSTOP)
TASK_TRACED            // Being traced by debugger
EXIT_ZOMBIE            // Terminated, waiting for parent
EXIT_DEAD              // Final state before removal
</code></pre>
<p><strong>View process states:</strong></p>
<pre><code class="language-bash">ps aux
# STAT column:
# R - Running
# S - Sleeping (interruptible)
# D - Sleeping (uninterruptible, usually I/O)
# T - Stopped
# Z - Zombie
# &lt; - High priority
# N - Low priority
# + - Foreground process group

# Find stuck processes (uninterruptible sleep)
ps aux | awk '$8 ~ /D/'
</code></pre>
<h3 id="process-creation"><a class="header" href="#process-creation">Process Creation</a></h3>
<p><strong>fork() system call:</strong></p>
<pre><code class="language-c">#include &lt;unistd.h&gt;
#include &lt;stdio.h&gt;

int main() {
    pid_t pid = fork();
    
    if (pid &lt; 0) {
        // Fork failed
        perror("fork");
        return 1;
    } else if (pid == 0) {
        // Child process
        printf("Child: PID = %d\n", getpid());
    } else {
        // Parent process
        printf("Parent: PID = %d, Child PID = %d\n", getpid(), pid);
    }
    
    return 0;
}
</code></pre>
<p><strong>exec() system call:</strong></p>
<pre><code class="language-c">#include &lt;unistd.h&gt;

int main() {
    char *args[] = {"/bin/ls", "-l", NULL};
    execv("/bin/ls", args);  // Replace current process
    
    // Only reached if exec fails
    perror("exec");
    return 1;
}
</code></pre>
<h3 id="process-namespaces"><a class="header" href="#process-namespaces">Process Namespaces</a></h3>
<p>Provide isolation for different resources:</p>
<pre><code class="language-bash"># Namespace types
PID      # Process IDs
NET      # Network stack
MNT      # Mount points
IPC      # Inter-process communication
UTS      # Hostname and domain name
USER     # User and group IDs
CGROUP   # Control groups

# View process namespaces
ls -l /proc/self/ns/
lsns  # List namespaces

# Create new namespace
unshare --pid --fork bash  # New PID namespace
unshare --net bash         # New network namespace

# Enter namespace
nsenter --target PID --pid --uts --net bash
</code></pre>
<hr />
<h2 id="system-calls"><a class="header" href="#system-calls">System Calls</a></h2>
<p>System calls provide the interface between user space and kernel space.</p>
<h3 id="system-call-mechanism"><a class="header" href="#system-call-mechanism">System Call Mechanism</a></h3>
<pre><code>User Space:
  Application calls glibc function
         ↓
  glibc wrapper function
         ↓
  Software interrupt (int 0x80 or syscall instruction)
         ↓
Kernel Space:
  System call handler
         ↓
  Kernel function implementation
         ↓
  Return to user space
</code></pre>
<h3 id="common-system-calls"><a class="header" href="#common-system-calls">Common System Calls</a></h3>
<p><strong>Process Management:</strong></p>
<pre><code class="language-c">fork()          // Create child process
exec()          // Execute program
exit()          // Terminate process
wait()          // Wait for child process
getpid()        // Get process ID
getppid()       // Get parent process ID
kill()          // Send signal to process
nice()          // Change priority
</code></pre>
<p><strong>File Operations:</strong></p>
<pre><code class="language-c">open()          // Open file
close()         // Close file
read()          // Read from file
write()         // Write to file
lseek()         // Change file position
stat()          // Get file status
chmod()         // Change permissions
chown()         // Change ownership
link()          // Create hard link
unlink()        // Delete file
mkdir()         // Create directory
rmdir()         // Remove directory
</code></pre>
<p><strong>Memory Management:</strong></p>
<pre><code class="language-c">brk()           // Change data segment size
mmap()          // Map file or device into memory
munmap()        // Unmap memory
mprotect()      // Change memory protection
mlock()         // Lock memory (prevent swapping)
</code></pre>
<p><strong>Networking:</strong></p>
<pre><code class="language-c">socket()        // Create socket
bind()          // Bind socket to address
listen()        // Listen for connections
accept()        // Accept connection
connect()       // Connect to remote socket
send()          // Send data
recv()          // Receive data
shutdown()      // Shut down socket
</code></pre>
<h3 id="tracing-system-calls"><a class="header" href="#tracing-system-calls">Tracing System Calls</a></h3>
<p><strong>strace - Trace system calls:</strong></p>
<pre><code class="language-bash"># Trace program execution
strace ls
strace -o output.txt ls    # Save to file

# Trace specific system calls
strace -e open,read ls     # Only open and read
strace -e trace=file ls    # All file operations
strace -e trace=network curl example.com

# Attach to running process
strace -p PID

# Count system call statistics
strace -c ls

# Follow child processes
strace -f ./program

# Timestamp system calls
strace -t ls               # Time of day
strace -T ls               # Time spent in each call

# Examples
strace -e trace=open,openat cat /etc/passwd
strace -c find / -name "*.log" 2&gt;/dev/null
strace -p $(pgrep nginx | head -1)
</code></pre>
<h3 id="writing-a-simple-system-call"><a class="header" href="#writing-a-simple-system-call">Writing a Simple System Call</a></h3>
<p><strong>1. Add system call to kernel:</strong></p>
<pre><code class="language-c">// kernel/sys.c
SYSCALL_DEFINE1(hello, char __user *, msg)
{
    char kernel_msg[256];
    
    if (copy_from_user(kernel_msg, msg, sizeof(kernel_msg)))
        return -EFAULT;
    
    printk(KERN_INFO "System call hello: %s\n", kernel_msg);
    return 0;
}
</code></pre>
<p><strong>2. Add to system call table:</strong></p>
<pre><code class="language-c">// arch/x86/entry/syscalls/syscall_64.tbl
450    common    hello    sys_hello
</code></pre>
<p><strong>3. User space program:</strong></p>
<pre><code class="language-c">#include &lt;unistd.h&gt;
#include &lt;sys/syscall.h&gt;

#define __NR_hello 450

int main() {
    syscall(__NR_hello, "Hello from user space!");
    return 0;
}
</code></pre>
<hr />
<h2 id="kernel-modules"><a class="header" href="#kernel-modules">Kernel Modules</a></h2>
<p>Kernel modules allow dynamic loading of code into the running kernel.</p>
<h3 id="module-basics"><a class="header" href="#module-basics">Module Basics</a></h3>
<pre><code class="language-bash"># List loaded modules
lsmod

# Module information
modinfo module_name

# Load module
modprobe module_name
insmod /path/to/module.ko

# Unload module
modprobe -r module_name
rmmod module_name

# Module dependencies
depmod -a

# Module parameters
modinfo -p module_name
modprobe module_name param=value
</code></pre>
<h3 id="writing-a-simple-module"><a class="header" href="#writing-a-simple-module">Writing a Simple Module</a></h3>
<p><strong>hello_module.c:</strong></p>
<pre><code class="language-c">#include &lt;linux/init.h&gt;
#include &lt;linux/module.h&gt;
#include &lt;linux/kernel.h&gt;

MODULE_LICENSE("GPL");
MODULE_AUTHOR("Your Name");
MODULE_DESCRIPTION("A simple Hello World module");
MODULE_VERSION("1.0");

// Module initialization
static int __init hello_init(void)
{
    printk(KERN_INFO "Hello World module loaded\n");
    return 0;  // 0 = success
}

// Module cleanup
static void __exit hello_exit(void)
{
    printk(KERN_INFO "Hello World module unloaded\n");
}

// Register init and exit functions
module_init(hello_init);
module_exit(hello_exit);
</code></pre>
<p><strong>Makefile:</strong></p>
<pre><code class="language-makefile">obj-m += hello_module.o

all:
	make -C /lib/modules/$(shell uname -r)/build M=$(PWD) modules

clean:
	make -C /lib/modules/$(shell uname -r)/build M=$(PWD) clean

install:
	make -C /lib/modules/$(shell uname -r)/build M=$(PWD) modules_install
	depmod -a
</code></pre>
<p><strong>Build and load:</strong></p>
<pre><code class="language-bash"># Compile
make

# Load module
sudo insmod hello_module.ko

# Check kernel log
dmesg | tail

# Unload module
sudo rmmod hello_module

# Install system-wide
sudo make install
</code></pre>
<h3 id="module-with-parameters"><a class="header" href="#module-with-parameters">Module with Parameters</a></h3>
<pre><code class="language-c">#include &lt;linux/init.h&gt;
#include &lt;linux/module.h&gt;
#include &lt;linux/kernel.h&gt;
#include &lt;linux/moduleparam.h&gt;

MODULE_LICENSE("GPL");

static int count = 1;
static char *name = "World";

module_param(count, int, S_IRUGO);
module_param(name, charp, S_IRUGO);

MODULE_PARM_DESC(count, "Number of times to greet");
MODULE_PARM_DESC(name, "Name to greet");

static int __init param_init(void)
{
    int i;
    for (i = 0; i &lt; count; i++) {
        printk(KERN_INFO "Hello %s! (%d/%d)\n", name, i+1, count);
    }
    return 0;
}

static void __exit param_exit(void)
{
    printk(KERN_INFO "Goodbye %s!\n", name);
}

module_init(param_init);
module_exit(param_exit);
</code></pre>
<p><strong>Load with parameters:</strong></p>
<pre><code class="language-bash">sudo insmod param_module.ko count=3 name="Linux"
</code></pre>
<h3 id="character-device-driver"><a class="header" href="#character-device-driver">Character Device Driver</a></h3>
<pre><code class="language-c">#include &lt;linux/init.h&gt;
#include &lt;linux/module.h&gt;
#include &lt;linux/kernel.h&gt;
#include &lt;linux/fs.h&gt;
#include &lt;linux/uaccess.h&gt;

#define DEVICE_NAME "chardev"
#define BUFFER_SIZE 1024

MODULE_LICENSE("GPL");

static int major_number;
static char device_buffer[BUFFER_SIZE];
static int buffer_size = 0;

// File operations
static int dev_open(struct inode *inodep, struct file *filep)
{
    printk(KERN_INFO "chardev: Device opened\n");
    return 0;
}

static ssize_t dev_read(struct file *filep, char *buffer, 
                        size_t len, loff_t *offset)
{
    int bytes_read = 0;
    
    if (*offset &gt;= buffer_size)
        return 0;
    
    bytes_read = buffer_size - *offset;
    if (bytes_read &gt; len)
        bytes_read = len;
    
    if (copy_to_user(buffer, device_buffer + *offset, bytes_read))
        return -EFAULT;
    
    *offset += bytes_read;
    return bytes_read;
}

static ssize_t dev_write(struct file *filep, const char *buffer, 
                         size_t len, loff_t *offset)
{
    int bytes_written = len;
    
    if (bytes_written &gt; BUFFER_SIZE)
        bytes_written = BUFFER_SIZE;
    
    if (copy_from_user(device_buffer, buffer, bytes_written))
        return -EFAULT;
    
    buffer_size = bytes_written;
    printk(KERN_INFO "chardev: Received %d bytes\n", bytes_written);
    return bytes_written;
}

static int dev_release(struct inode *inodep, struct file *filep)
{
    printk(KERN_INFO "chardev: Device closed\n");
    return 0;
}

static struct file_operations fops = {
    .open = dev_open,
    .read = dev_read,
    .write = dev_write,
    .release = dev_release,
};

static int __init chardev_init(void)
{
    major_number = register_chrdev(0, DEVICE_NAME, &amp;fops);
    
    if (major_number &lt; 0) {
        printk(KERN_ALERT "chardev: Failed to register\n");
        return major_number;
    }
    
    printk(KERN_INFO "chardev: Registered with major number %d\n", 
           major_number);
    printk(KERN_INFO "chardev: Create device with: mknod /dev/%s c %d 0\n",
           DEVICE_NAME, major_number);
    return 0;
}

static void __exit chardev_exit(void)
{
    unregister_chrdev(major_number, DEVICE_NAME);
    printk(KERN_INFO "chardev: Unregistered\n");
}

module_init(chardev_init);
module_exit(chardev_exit);
</code></pre>
<p><strong>Using the device:</strong></p>
<pre><code class="language-bash"># Load module
sudo insmod chardev.ko

# Create device node
sudo mknod /dev/chardev c &lt;major_number&gt; 0
sudo chmod 666 /dev/chardev

# Test device
echo "Hello" &gt; /dev/chardev
cat /dev/chardev

# Cleanup
sudo rm /dev/chardev
sudo rmmod chardev
</code></pre>
<hr />
<h2 id="device-drivers"><a class="header" href="#device-drivers">Device Drivers</a></h2>
<h3 id="driver-types"><a class="header" href="#driver-types">Driver Types</a></h3>
<p><strong>Character Devices:</strong></p>
<ul>
<li>Sequential access</li>
<li>Examples: keyboards, serial ports, /dev/null</li>
<li>Major/minor numbers for identification</li>
</ul>
<p><strong>Block Devices:</strong></p>
<ul>
<li>Random access, buffered I/O</li>
<li>Examples: hard drives, SSDs, USB drives</li>
<li>Use page cache for performance</li>
</ul>
<p><strong>Network Devices:</strong></p>
<ul>
<li>Packet transmission/reception</li>
<li>Examples: Ethernet, WiFi, loopback</li>
<li>Socket interface</li>
</ul>
<h3 id="device-model"><a class="header" href="#device-model">Device Model</a></h3>
<pre><code class="language-bash"># View device hierarchy
ls /sys/devices/
ls /sys/class/

# PCI devices
lspci -v
ls /sys/bus/pci/devices/

# USB devices
lsusb -v
ls /sys/bus/usb/devices/

# Block devices
lsblk
ls /sys/block/

# Network devices
ip link show
ls /sys/class/net/

# Device information
udevadm info --query=all --name=/dev/sda
</code></pre>
<h3 id="device-management-with-udev"><a class="header" href="#device-management-with-udev">Device Management with udev</a></h3>
<p><strong>udev rules</strong> (/etc/udev/rules.d/):</p>
<pre><code class="language-bash"># Example: Custom USB device rule
# /etc/udev/rules.d/99-usb-device.rules
SUBSYSTEM=="usb", ATTR{idVendor}=="1234", ATTR{idProduct}=="5678", \
    MODE="0666", GROUP="users", SYMLINK+="mydevice"

# Reload udev rules
sudo udevadm control --reload-rules
sudo udevadm trigger

# Monitor udev events
udevadm monitor
</code></pre>
<hr />
<h2 id="file-systems"><a class="header" href="#file-systems">File Systems</a></h2>
<h3 id="vfs-layer"><a class="header" href="#vfs-layer">VFS Layer</a></h3>
<p>The Virtual File System provides a common interface for all filesystems.</p>
<p><strong>Supported filesystems:</strong></p>
<pre><code class="language-bash">cat /proc/filesystems
# ext4, btrfs, xfs, nfs, vfat, tmpfs, etc.

# Filesystem modules
ls /lib/modules/$(uname -r)/kernel/fs/
</code></pre>
<h3 id="ext4-filesystem"><a class="header" href="#ext4-filesystem">ext4 Filesystem</a></h3>
<pre><code class="language-bash"># Create ext4 filesystem
mkfs.ext4 /dev/sdb1

# Filesystem check
fsck.ext4 /dev/sdb1
e2fsck -f /dev/sdb1

# Filesystem information
dumpe2fs /dev/sdb1
tune2fs -l /dev/sdb1

# Tune filesystem
tune2fs -m 1 /dev/sdb1           # Reserved blocks percentage
tune2fs -c 30 /dev/sdb1          # Max mount count
tune2fs -i 6m /dev/sdb1          # Check interval

# Enable/disable features
tune2fs -O has_journal /dev/sdb1   # Enable journaling
tune2fs -O ^has_journal /dev/sdb1  # Disable journaling
</code></pre>
<h3 id="filesystem-debugging"><a class="header" href="#filesystem-debugging">Filesystem Debugging</a></h3>
<pre><code class="language-bash"># Debugfs - interactive ext2/ext3/ext4 debugger
debugfs /dev/sdb1
# Commands: ls, cd, stat, logdump, etc.

# View inode information
stat /path/to/file
ls -i /path/to/file              # Show inode number
debugfs -R "stat &lt;inode_number&gt;" /dev/sdb1

# Find deleted files
debugfs -R "lsdel" /dev/sdb1
</code></pre>
<hr />
<h2 id="networking-stack"><a class="header" href="#networking-stack">Networking Stack</a></h2>
<h3 id="network-layer-architecture"><a class="header" href="#network-layer-architecture">Network Layer Architecture</a></h3>
<pre><code>+-----------------+
| Application     |
+-----------------+
| Socket Layer    |
+-----------------+
| Protocol Layer  | (TCP, UDP, ICMP)
+-----------------+
| IP Layer        | (IPv4, IPv6, routing)
+-----------------+
| Link Layer      | (Ethernet, WiFi)
+-----------------+
| Device Driver   |
+-----------------+
| Hardware        |
+-----------------+
</code></pre>
<h3 id="network-configuration"><a class="header" href="#network-configuration">Network Configuration</a></h3>
<pre><code class="language-bash"># View network configuration
ip addr show
ip route show
ip link show

# Network statistics
cat /proc/net/dev               # Interface statistics
cat /proc/net/tcp               # TCP connections
cat /proc/net/udp               # UDP connections
netstat -s                      # Protocol statistics

# Socket buffers
sysctl net.core.rmem_max        # Receive buffer
sysctl net.core.wmem_max        # Send buffer

# TCP parameters
sysctl net.ipv4.tcp_rmem        # TCP receive memory
sysctl net.ipv4.tcp_wmem        # TCP send memory
sysctl net.ipv4.tcp_congestion_control
</code></pre>
<h3 id="network-debugging"><a class="header" href="#network-debugging">Network Debugging</a></h3>
<p>See <a href="linux/./networking.html">networking.md</a> for detailed network debugging.</p>
<hr />
<h2 id="kernel-compilation"><a class="header" href="#kernel-compilation">Kernel Compilation</a></h2>
<h3 id="getting-kernel-source"><a class="header" href="#getting-kernel-source">Getting Kernel Source</a></h3>
<pre><code class="language-bash"># Download from kernel.org
wget https://cdn.kernel.org/pub/linux/kernel/v6.x/linux-6.5.tar.xz
tar -xf linux-6.5.tar.xz
cd linux-6.5

# Or use git
git clone https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git
cd linux
git checkout v6.5

# Distribution specific
# Ubuntu/Debian
apt-get source linux-image-$(uname -r)

# Fedora/RHEL
dnf download --source kernel
</code></pre>
<h3 id="kernel-configuration"><a class="header" href="#kernel-configuration">Kernel Configuration</a></h3>
<pre><code class="language-bash">cd /usr/src/linux

# Configuration methods
make config           # Text-based Q&amp;A (tedious)
make menuconfig       # Text-based menu (ncurses)
make xconfig          # Qt-based GUI
make gconfig          # GTK-based GUI

# Use existing config
make oldconfig        # Update old config
make localmodconfig   # Only modules for current hardware
make defconfig        # Default configuration
cp /boot/config-$(uname -r) .config  # Copy running config

# Configuration file
.config               # Generated configuration
</code></pre>
<p><strong>Important config options:</strong></p>
<pre><code class="language-bash"># General setup
CONFIG_LOCALVERSION="-custom"        # Custom kernel name
CONFIG_DEFAULT_HOSTNAME="myhost"

# Processor type
CONFIG_SMP=y                         # Symmetric multiprocessing
CONFIG_NR_CPUS=8                     # Number of CPUs

# Power management
CONFIG_CPU_FREQ=y                    # CPU frequency scaling
CONFIG_HIBERNATION=y

# Networking
CONFIG_NETFILTER=y                   # Firewall support
CONFIG_BRIDGE=y                      # Network bridging

# Filesystems
CONFIG_EXT4_FS=y                     # ext4 filesystem
CONFIG_BTRFS_FS=y                    # Btrfs filesystem

# Security
CONFIG_SECURITY_SELINUX=y            # SELinux support
CONFIG_SECURITY_APPARMOR=y           # AppArmor support

# Debugging
CONFIG_DEBUG_KERNEL=y                # Kernel debugging
CONFIG_KGDB=y                        # Kernel debugger
CONFIG_DEBUG_INFO=y                  # Debug symbols
</code></pre>
<h3 id="building-the-kernel"><a class="header" href="#building-the-kernel">Building the Kernel</a></h3>
<pre><code class="language-bash"># Install build dependencies
# Ubuntu/Debian
sudo apt install build-essential libncurses-dev bison flex \
                 libssl-dev libelf-dev bc

# Fedora/RHEL
sudo dnf groupinstall "Development Tools"
sudo dnf install ncurses-devel bison flex elfutils-libelf-devel \
                 openssl-devel bc

# Build kernel
make -j$(nproc)                      # Use all CPU cores

# Or build specific targets
make bzImage                         # Kernel image
make modules                         # Kernel modules
make dtbs                            # Device tree blobs (ARM)

# Install
sudo make modules_install            # Install modules to /lib/modules
sudo make install                    # Install kernel to /boot

# Manual installation
sudo cp arch/x86/boot/bzImage /boot/vmlinuz-6.5-custom
sudo cp System.map /boot/System.map-6.5-custom
sudo cp .config /boot/config-6.5-custom

# Update bootloader
sudo update-grub                     # Debian/Ubuntu
sudo grub2-mkconfig -o /boot/grub2/grub.cfg  # Fedora/RHEL

# Reboot
sudo reboot
</code></pre>
<h3 id="cross-compilation"><a class="header" href="#cross-compilation">Cross-Compilation</a></h3>
<pre><code class="language-bash"># Install cross-compiler
sudo apt install gcc-arm-linux-gnueabi

# Configure for target architecture
make ARCH=arm CROSS_COMPILE=arm-linux-gnueabi- defconfig

# Build
make ARCH=arm CROSS_COMPILE=arm-linux-gnueabi- -j$(nproc)

# Example architectures
ARCH=arm                             # ARM 32-bit
ARCH=arm64                           # ARM 64-bit (aarch64)
ARCH=mips                            # MIPS
ARCH=powerpc                         # PowerPC
ARCH=riscv                           # RISC-V
</code></pre>
<h3 id="kernel-patching"><a class="header" href="#kernel-patching">Kernel Patching</a></h3>
<pre><code class="language-bash"># Apply patch
patch -p1 &lt; patch-file.patch

# Create patch
diff -Naur original/ modified/ &gt; my-patch.patch

# Check if patch applies cleanly
patch -p1 --dry-run &lt; patch-file.patch

# Reverse patch
patch -R -p1 &lt; patch-file.patch
</code></pre>
<hr />
<h2 id="kernel-debugging"><a class="header" href="#kernel-debugging">Kernel Debugging</a></h2>
<h3 id="printk---kernel-logging"><a class="header" href="#printk---kernel-logging">printk - Kernel Logging</a></h3>
<pre><code class="language-c">#include &lt;linux/printk.h&gt;

// Log levels (from highest to lowest priority)
printk(KERN_EMERG "System is unusable\n");           // 0
printk(KERN_ALERT "Action must be taken\n");         // 1
printk(KERN_CRIT "Critical conditions\n");           // 2
printk(KERN_ERR "Error conditions\n");               // 3
printk(KERN_WARNING "Warning conditions\n");         // 4
printk(KERN_NOTICE "Normal but significant\n");      // 5
printk(KERN_INFO "Informational\n");                 // 6
printk(KERN_DEBUG "Debug-level messages\n");         // 7

// Default level (usually KERN_WARNING)
printk("Default level message\n");

// Dynamic debug (if CONFIG_DYNAMIC_DEBUG enabled)
pr_debug("Debug message\n");
</code></pre>
<p><strong>View kernel messages:</strong></p>
<pre><code class="language-bash">dmesg                                # View kernel ring buffer
dmesg -w                             # Follow new messages
dmesg -l err                         # Only errors
dmesg --level=err,warn               # Errors and warnings
dmesg -T                             # Human-readable timestamps

journalctl -k                        # Kernel messages via systemd
journalctl -k -f                     # Follow kernel messages
journalctl -k --since "1 hour ago"

# Set console log level
dmesg -n 1                           # Only emergency messages to console
echo 7 &gt; /proc/sys/kernel/printk     # All messages to console
</code></pre>
<h3 id="kgdb---kernel-debugger"><a class="header" href="#kgdb---kernel-debugger">KGDB - Kernel Debugger</a></h3>
<pre><code class="language-bash"># Build kernel with debugging enabled
CONFIG_DEBUG_KERNEL=y
CONFIG_DEBUG_INFO=y
CONFIG_KGDB=y
CONFIG_KGDB_SERIAL_CONSOLE=y

# Boot with KGDB enabled
linux ... kgdboc=ttyS0,115200 kgdbwait

# Connect with GDB
gdb vmlinux
(gdb) target remote /dev/ttyS0
(gdb) break sys_open
(gdb) continue
</code></pre>
<h3 id="kdump---kernel-crash-dumps"><a class="header" href="#kdump---kernel-crash-dumps">kdump - Kernel Crash Dumps</a></h3>
<pre><code class="language-bash"># Install kdump
# Ubuntu/Debian
sudo apt install kdump-tools

# Fedora/RHEL
sudo dnf install kexec-tools

# Configure kdump
# Edit /etc/default/kdump-tools (Debian) or /etc/sysconfig/kdump (RHEL)

# Reserve memory for crash kernel
# Add to kernel parameters: crashkernel=384M-:128M

# Enable kdump
sudo systemctl enable kdump
sudo systemctl start kdump

# Test crash
echo c &gt; /proc/sysrq-trigger         # WARNING: Crashes system!

# Analyze crash dump
crash /usr/lib/debug/vmlinux-&lt;version&gt; /var/crash/vmcore
</code></pre>
<h3 id="magic-sysrq-key"><a class="header" href="#magic-sysrq-key">Magic SysRq Key</a></h3>
<p>Emergency kernel functions:</p>
<pre><code class="language-bash"># Enable SysRq
echo 1 &gt; /proc/sys/kernel/sysrq

# SysRq commands (Alt+SysRq+&lt;key&gt;)
# Or: echo &lt;key&gt; &gt; /proc/sysrq-trigger

b - Reboot immediately
c - Crash (for kdump)
e - SIGTERM to all processes
f - OOM killer
h - Help
i - SIGKILL to all processes
k - Kill all on current console
m - Memory info
p - Current registers and flags
r - Keyboard raw mode
s - Sync all filesystems
t - Task list
u - Remount filesystems read-only
w - Tasks in uninterruptible sleep

# Safe reboot sequence (REISUB)
# R - Raw keyboard mode
# E - SIGTERM all
# I - SIGKILL all
# S - Sync disks
# U - Remount read-only
# B - Reboot
</code></pre>
<h3 id="ftrace---function-tracer"><a class="header" href="#ftrace---function-tracer">ftrace - Function Tracer</a></h3>
<pre><code class="language-bash"># Mount debugfs
mount -t debugfs none /sys/kernel/debug

cd /sys/kernel/debug/tracing

# Available tracers
cat available_tracers
# function, function_graph, blk, wakeup, etc.

# Enable function tracer
echo function &gt; current_tracer
echo 1 &gt; tracing_on

# View trace
cat trace | head -20

# Stop tracing
echo 0 &gt; tracing_on

# Trace specific function
echo sys_open &gt; set_ftrace_filter
echo function &gt; current_tracer
echo 1 &gt; tracing_on

# Clear trace
echo &gt; trace

# Example: Trace network stack
echo 1 &gt; events/net/enable
echo 1 &gt; tracing_on
# Generate network traffic
cat trace
</code></pre>
<h3 id="systemtap"><a class="header" href="#systemtap">SystemTap</a></h3>
<p>Dynamic tracing and instrumentation:</p>
<pre><code class="language-bash"># Install SystemTap
sudo apt install systemtap systemtap-runtime

# Install kernel debug symbols
sudo apt install linux-image-$(uname -r)-dbgsym

# Simple script (hello.stp)
probe begin {
    printf("Hello, SystemTap!\n")
    exit()
}

# Run script
sudo stap hello.stp

# Trace system calls
sudo stap -e 'probe syscall.open { println(execname()) }'

# Count system calls
sudo stap -e '
    global count
    probe syscall.* {
        count[name]++
    }
    probe end {
        foreach (syscall in count-)
            printf("%20s: %d\n", syscall, count[syscall])
    }
' -c "ls -l /"
</code></pre>
<h3 id="perf---performance-analysis"><a class="header" href="#perf---performance-analysis">perf - Performance Analysis</a></h3>
<pre><code class="language-bash"># Install perf
sudo apt install linux-tools-$(uname -r)

# Record CPU cycles
sudo perf record -a sleep 10

# View report
sudo perf report

# CPU profiling
sudo perf top

# Stat command
sudo perf stat ls -R /

# Trace system calls
sudo perf trace ls

# Record specific events
sudo perf record -e sched:sched_switch -a sleep 5
sudo perf script

# Hardware counters
perf list                          # List available events
sudo perf stat -e cache-misses,cache-references ls
</code></pre>
<hr />
<h2 id="performance-tuning"><a class="header" href="#performance-tuning">Performance Tuning</a></h2>
<h3 id="sysctl-parameters"><a class="header" href="#sysctl-parameters">sysctl Parameters</a></h3>
<pre><code class="language-bash"># View all parameters
sysctl -a

# View specific parameter
sysctl vm.swappiness

# Set temporarily
sudo sysctl vm.swappiness=10

# Set permanently (/etc/sysctl.conf or /etc/sysctl.d/)
echo "vm.swappiness=10" | sudo tee -a /etc/sysctl.conf
sudo sysctl -p                     # Reload configuration
</code></pre>
<p><strong>Important parameters:</strong></p>
<pre><code class="language-bash"># Virtual Memory
vm.swappiness=10                   # Reduce swap usage
vm.dirty_ratio=10                  # Dirty page threshold for writeback
vm.dirty_background_ratio=5        # Background writeback threshold
vm.overcommit_memory=1             # Allow memory overcommit

# Network
net.core.rmem_max=134217728        # Max receive buffer
net.core.wmem_max=134217728        # Max send buffer
net.core.netdev_max_backlog=5000   # Input queue size
net.ipv4.tcp_rmem=4096 87380 67108864     # TCP read memory
net.ipv4.tcp_wmem=4096 65536 67108864     # TCP write memory
net.ipv4.tcp_congestion_control=bbr        # Congestion algorithm
net.ipv4.tcp_fastopen=3            # TCP Fast Open
net.ipv4.tcp_mtu_probing=1         # Path MTU discovery
net.ipv4.ip_forward=1              # IP forwarding

# File System
fs.file-max=2097152                # Max open files system-wide
fs.inotify.max_user_watches=524288 # Inotify watches

# Kernel
kernel.sysrq=1                     # Enable SysRq
kernel.panic=10                    # Reboot 10s after panic
kernel.pid_max=4194304             # Max PIDs
</code></pre>
<h3 id="io-schedulers"><a class="header" href="#io-schedulers">I/O Schedulers</a></h3>
<pre><code class="language-bash"># View available schedulers
cat /sys/block/sda/queue/scheduler
# [mq-deadline] kyber bfq none

# Change scheduler
echo kyber &gt; /sys/block/sda/queue/scheduler

# Schedulers:
# mq-deadline - Default, good for most workloads
# kyber - Low latency, good for SSDs
# bfq - Fair queueing, good for desktops
# none - No scheduling (for NVMe with low latency)

# Make permanent (udev rule)
# /etc/udev/rules.d/60-scheduler.rules
ACTION=="add|change", KERNEL=="sd[a-z]", ATTR{queue/scheduler}="kyber"
</code></pre>
<h3 id="cpu-governor"><a class="header" href="#cpu-governor">CPU Governor</a></h3>
<pre><code class="language-bash"># View current governor
cat /sys/devices/system/cpu/cpu*/cpufreq/scaling_governor

# Available governors
cat /sys/devices/system/cpu/cpu0/cpufreq/scaling_available_governors
# performance powersave schedutil ondemand conservative

# Set governor
echo performance | sudo tee /sys/devices/system/cpu/cpu*/cpufreq/scaling_governor

# Governors:
# performance - Max frequency
# powersave - Min frequency
# ondemand - Dynamic scaling (legacy)
# schedutil - Scheduler-driven (default, recommended)
# conservative - Gradual scaling

# Using cpupower
sudo cpupower frequency-set -g performance
sudo cpupower frequency-info
</code></pre>
<h3 id="huge-pages-1"><a class="header" href="#huge-pages-1">Huge Pages</a></h3>
<pre><code class="language-bash"># Configure huge pages
echo 512 &gt; /proc/sys/vm/nr_hugepages

# Transparent Huge Pages
echo always &gt; /sys/kernel/mm/transparent_hugepage/enabled
echo madvise &gt; /sys/kernel/mm/transparent_hugepage/enabled  # Recommended

# View huge page usage
cat /proc/meminfo | grep -i huge

# Permanent configuration (/etc/sysctl.conf)
vm.nr_hugepages=512
</code></pre>
<h3 id="numa-non-uniform-memory-access"><a class="header" href="#numa-non-uniform-memory-access">NUMA (Non-Uniform Memory Access)</a></h3>
<pre><code class="language-bash"># Check NUMA configuration
numactl --hardware

# View NUMA statistics
numastat

# Run program on specific NUMA node
numactl --cpunodebind=0 --membind=0 ./program

# Automatic NUMA balancing
echo 1 &gt; /proc/sys/kernel/numa_balancing
</code></pre>
<hr />
<h2 id="practical-examples"><a class="header" href="#practical-examples">Practical Examples</a></h2>
<h3 id="monitoring-system-performance"><a class="header" href="#monitoring-system-performance">Monitoring System Performance</a></h3>
<pre><code class="language-bash">#!/bin/bash
# System performance monitoring script

echo "=== CPU Usage ==="
mpstat 1 5 | tail -1

echo -e "\n=== Memory Usage ==="
free -h

echo -e "\n=== Disk I/O ==="
iostat -xz 1 2 | tail -n +3

echo -e "\n=== Network ==="
sar -n DEV 1 1 | tail -3

echo -e "\n=== Top Processes by CPU ==="
ps aux --sort=-%cpu | head -6

echo -e "\n=== Top Processes by Memory ==="
ps aux --sort=-%mem | head -6

echo -e "\n=== Load Average ==="
uptime

echo -e "\n=== Kernel Parameters ==="
sysctl vm.swappiness net.ipv4.tcp_congestion_control
</code></pre>
<h3 id="kernel-module-template"><a class="header" href="#kernel-module-template">Kernel Module Template</a></h3>
<pre><code class="language-c">/**
 * template_module.c - Template for kernel modules
 */
#include &lt;linux/init.h&gt;
#include &lt;linux/module.h&gt;
#include &lt;linux/kernel.h&gt;
#include &lt;linux/slab.h&gt;

MODULE_LICENSE("GPL");
MODULE_AUTHOR("Your Name");
MODULE_DESCRIPTION("Template module");
MODULE_VERSION("1.0");

static int __init template_init(void)
{
    printk(KERN_INFO "template: Module loaded\n");
    
    // Initialize your code here
    
    return 0;
}

static void __exit template_exit(void)
{
    // Cleanup your code here
    
    printk(KERN_INFO "template: Module unloaded\n");
}

module_init(template_init);
module_exit(template_exit);
</code></pre>
<hr />
<h2 id="resources-1"><a class="header" href="#resources-1">Resources</a></h2>
<h3 id="official-documentation-1"><a class="header" href="#official-documentation-1">Official Documentation</a></h3>
<ul>
<li><a href="https://www.kernel.org/doc/html/latest/">Kernel Documentation</a></li>
<li><a href="https://lkml.org/">Linux Kernel Mailing List</a></li>
<li><a href="https://kernelnewbies.org/">Kernel Newbies</a></li>
</ul>
<h3 id="books-1"><a class="header" href="#books-1">Books</a></h3>
<ul>
<li>"Linux Kernel Development" by Robert Love</li>
<li>"Linux Device Drivers" by Jonathan Corbet</li>
<li>"Understanding the Linux Kernel" by Daniel P. Bovet</li>
<li>"Linux System Programming" by Robert Love</li>
</ul>
<h3 id="online-resources"><a class="header" href="#online-resources">Online Resources</a></h3>
<ul>
<li><a href="https://www.kernel.org/">The Linux Kernel Archives</a></li>
<li><a href="https://lwn.net/">LWN.net</a> - Linux Weekly News</li>
<li><a href="https://bootlin.com/docs/">Bootlin Training Materials</a></li>
</ul>
<h3 id="development-tools"><a class="header" href="#development-tools">Development Tools</a></h3>
<ul>
<li>Git - Version control</li>
<li>cscope/ctags - Code navigation</li>
<li>sparse - Static analyzer</li>
<li>Coccinelle - Semantic patching</li>
<li>QEMU - Virtualization for testing</li>
</ul>
<hr />
<p>This guide covers the fundamentals of Linux kernel architecture and development. The kernel is vast and constantly evolving, so continuous learning and experimentation are essential!</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="linux-kernel-development-patterns"><a class="header" href="#linux-kernel-development-patterns">Linux Kernel Development Patterns</a></h1>
<p>Common patterns, idioms, and best practices used throughout the Linux kernel codebase.</p>
<h2 id="table-of-contents-4"><a class="header" href="#table-of-contents-4">Table of Contents</a></h2>
<ul>
<li><a href="linux/kernel_patterns.html#coding-style">Coding Style</a></li>
<li><a href="linux/kernel_patterns.html#design-patterns">Design Patterns</a></li>
<li><a href="linux/kernel_patterns.html#memory-management-patterns">Memory Management Patterns</a></li>
<li><a href="linux/kernel_patterns.html#locking-and-synchronization">Locking and Synchronization</a></li>
<li><a href="linux/kernel_patterns.html#error-handling">Error Handling</a></li>
<li><a href="linux/kernel_patterns.html#device-driver-patterns">Device Driver Patterns</a></li>
<li><a href="linux/kernel_patterns.html#data-structures">Data Structures</a></li>
<li><a href="linux/kernel_patterns.html#kernel-apis">Kernel APIs</a></li>
<li><a href="linux/kernel_patterns.html#debugging-patterns">Debugging Patterns</a></li>
<li><a href="linux/kernel_patterns.html#best-practices">Best Practices</a></li>
</ul>
<hr />
<h2 id="coding-style"><a class="header" href="#coding-style">Coding Style</a></h2>
<h3 id="basic-rules"><a class="header" href="#basic-rules">Basic Rules</a></h3>
<p>The Linux kernel has strict coding style guidelines documented in <code>Documentation/process/coding-style.rst</code>.</p>
<p><strong>Indentation and Formatting:</strong></p>
<pre><code class="language-c">// Use tabs (8 characters) for indentation, not spaces
int function_name(int arg1, int arg2)
{
	int local_var;

	if (condition) {
		do_something();
	} else {
		do_something_else();
	}

	return 0;
}
</code></pre>
<p><strong>Line Length:</strong></p>
<pre><code class="language-c">// Prefer 80 columns, maximum 100 columns
// Break long lines sensibly
static const struct file_operations my_fops = {
	.owner = THIS_MODULE,
	.open = my_open,
	.read = my_read,
	.write = my_write,
	.release = my_release,
};
</code></pre>
<p><strong>Naming Conventions:</strong></p>
<pre><code class="language-c">// Use descriptive, lowercase names with underscores
int count_active_users(struct user_struct *user);

// Global functions should be prefixed with subsystem name
int netdev_register_device(struct net_device *dev);

// Static functions can be shorter
static int validate(void);

// Avoid Hungarian notation
int nr_pages;           // Good
int iPageCount;         // Bad
</code></pre>
<p><strong>Braces:</strong></p>
<pre><code class="language-c">// Opening brace on same line for functions, structs, etc.
struct my_struct {
	int member;
};

// But on next line for functions
int my_function(void)
{
	// function body
}

// Single statement doesn't need braces (but be careful)
if (condition)
	return -EINVAL;

// Multiple statements always need braces
if (condition) {
	do_something();
	return 0;
}
</code></pre>
<h3 id="comments-1"><a class="header" href="#comments-1">Comments</a></h3>
<pre><code class="language-c">/*
 * Multi-line comments use this format.
 * Each line starts with a star.
 * The closing star-slash is on its own line.
 */

// Single-line comments can use C++ style, but prefer /* */ style

/**
 * function_name - Short description
 * @param1: Description of param1
 * @param2: Description of param2
 *
 * Longer description of what the function does.
 * This can span multiple lines.
 *
 * Return: Description of return value
 */
int function_name(int param1, char *param2)
{
	/* Implementation */
}
</code></pre>
<hr />
<h2 id="design-patterns-1"><a class="header" href="#design-patterns-1">Design Patterns</a></h2>
<h3 id="registration-pattern"><a class="header" href="#registration-pattern">Registration Pattern</a></h3>
<p>The kernel uses registration callbacks extensively for hooking into subsystems.</p>
<pre><code class="language-c">/* Define operations structure */
struct my_operations {
	int (*init)(void);
	void (*cleanup)(void);
	int (*process)(void *data);
};

/* Define registration structure */
struct my_driver {
	const char *name;
	struct my_operations *ops;
	struct list_head list;
};

/* Registration function */
int register_my_driver(struct my_driver *driver)
{
	if (!driver || !driver-&gt;ops)
		return -EINVAL;

	/* Add to global list with locking */
	mutex_lock(&amp;drivers_mutex);
	list_add_tail(&amp;driver-&gt;list, &amp;drivers_list);
	mutex_unlock(&amp;drivers_mutex);

	/* Initialize if needed */
	if (driver-&gt;ops-&gt;init)
		return driver-&gt;ops-&gt;init();

	return 0;
}

/* Unregistration */
void unregister_my_driver(struct my_driver *driver)
{
	mutex_lock(&amp;drivers_mutex);
	list_del(&amp;driver-&gt;list);
	mutex_unlock(&amp;drivers_mutex);

	if (driver-&gt;ops-&gt;cleanup)
		driver-&gt;ops-&gt;cleanup();
}
</code></pre>
<h3 id="object-oriented-patterns-in-c"><a class="header" href="#object-oriented-patterns-in-c">Object-Oriented Patterns in C</a></h3>
<p>The kernel implements inheritance-like patterns using structure embedding.</p>
<pre><code class="language-c">/* Base "class" */
struct device {
	const char *name;
	struct device *parent;
	void (*release)(struct device *dev);
};

/* Derived "class" */
struct pci_device {
	struct device dev;      /* Embedded base */
	unsigned int vendor;
	unsigned int device_id;
};

/* Upcast: derived to base */
struct pci_device *pci_dev;
struct device *dev = &amp;pci_dev-&gt;dev;

/* Downcast: base to derived using container_of */
struct device *dev;
struct pci_device *pci_dev = container_of(dev, struct pci_device, dev);
</code></pre>
<h3 id="reference-counting-pattern"><a class="header" href="#reference-counting-pattern">Reference Counting Pattern</a></h3>
<pre><code class="language-c">struct my_object {
	atomic_t refcount;
	/* other fields */
};

/* Initialize reference count */
static void my_object_init(struct my_object *obj)
{
	atomic_set(&amp;obj-&gt;refcount, 1);
}

/* Get reference (increment) */
static inline struct my_object *my_object_get(struct my_object *obj)
{
	if (obj)
		atomic_inc(&amp;obj-&gt;refcount);
	return obj;
}

/* Put reference (decrement and free if zero) */
static inline void my_object_put(struct my_object *obj)
{
	if (obj &amp;&amp; atomic_dec_and_test(&amp;obj-&gt;refcount))
		my_object_destroy(obj);
}

/* Usage */
struct my_object *obj = my_object_alloc();  /* refcount = 1 */
struct my_object *obj2 = my_object_get(obj); /* refcount = 2 */
my_object_put(obj);   /* refcount = 1 */
my_object_put(obj2);  /* refcount = 0, object destroyed */
</code></pre>
<h3 id="kernel-object-kobject-pattern"><a class="header" href="#kernel-object-kobject-pattern">Kernel Object (kobject) Pattern</a></h3>
<pre><code class="language-c">#include &lt;linux/kobject.h&gt;

struct my_object {
	struct kobject kobj;
	int value;
};

static struct kobj_type my_ktype = {
	.release = my_release,
	.sysfs_ops = &amp;my_sysfs_ops,
	.default_attrs = my_attrs,
};

/* Create object */
struct my_object *obj = kzalloc(sizeof(*obj), GFP_KERNEL);
kobject_init(&amp;obj-&gt;kobj, &amp;my_ktype);
kobject_add(&amp;obj-&gt;kobj, parent, "my_object");

/* Get reference */
kobject_get(&amp;obj-&gt;kobj);

/* Release reference */
kobject_put(&amp;obj-&gt;kobj);
</code></pre>
<hr />
<h2 id="memory-management-patterns"><a class="header" href="#memory-management-patterns">Memory Management Patterns</a></h2>
<h3 id="allocation-patterns"><a class="header" href="#allocation-patterns">Allocation Patterns</a></h3>
<pre><code class="language-c">/* Kernel memory allocation */
void *ptr = kmalloc(size, GFP_KERNEL);  /* Can sleep */
void *ptr = kmalloc(size, GFP_ATOMIC);  /* Cannot sleep, use in interrupt */
void *ptr = kzalloc(size, GFP_KERNEL);  /* Zeroed memory */

/* Large allocations */
void *ptr = vmalloc(size);  /* Virtually contiguous, physically may not be */

/* Page allocation */
struct page *page = alloc_page(GFP_KERNEL);
struct page *pages = alloc_pages(GFP_KERNEL, order);  /* 2^order pages */

/* Per-CPU variables */
DEFINE_PER_CPU(int, my_var);
int val = get_cpu_var(my_var);
put_cpu_var(my_var);

/* Slab/KMEM cache for frequent allocations */
struct kmem_cache *my_cache;

my_cache = kmem_cache_create("my_cache",
                              sizeof(struct my_struct),
                              0, SLAB_HWCACHE_ALIGN, NULL);

struct my_struct *obj = kmem_cache_alloc(my_cache, GFP_KERNEL);
kmem_cache_free(my_cache, obj);
</code></pre>
<h3 id="memory-barriers"><a class="header" href="#memory-barriers">Memory Barriers</a></h3>
<pre><code class="language-c">/* Compiler barrier - prevent compiler reordering */
barrier();

/* Memory barriers - prevent CPU reordering */
mb();    /* Full memory barrier */
rmb();   /* Read memory barrier */
wmb();   /* Write memory barrier */
smp_mb(); /* SMP memory barrier */

/* Example: Producer-consumer */
/* Producer */
data-&gt;value = 42;
smp_wmb();  /* Ensure value is written before flag */
data-&gt;ready = 1;

/* Consumer */
while (!data-&gt;ready)
	cpu_relax();
smp_rmb();  /* Ensure flag is read before value */
value = data-&gt;value;
</code></pre>
<h3 id="page-flags-and-reference-counting"><a class="header" href="#page-flags-and-reference-counting">Page Flags and Reference Counting</a></h3>
<pre><code class="language-c">/* Get a page reference */
get_page(page);

/* Release a page reference */
put_page(page);

/* Check if page is locked */
if (PageLocked(page))
	/* ... */

/* Lock a page */
lock_page(page);
unlock_page(page);

/* Page flags */
SetPageDirty(page);
ClearPageDirty(page);
TestSetPageLocked(page);
</code></pre>
<hr />
<h2 id="locking-and-synchronization"><a class="header" href="#locking-and-synchronization">Locking and Synchronization</a></h2>
<h3 id="spinlock-pattern"><a class="header" href="#spinlock-pattern">Spinlock Pattern</a></h3>
<pre><code class="language-c">/* Define spinlock */
spinlock_t my_lock;

/* Initialize */
spin_lock_init(&amp;my_lock);

/* Use in process context */
spin_lock(&amp;my_lock);
/* Critical section */
spin_unlock(&amp;my_lock);

/* Use with IRQ disabling (if accessed from interrupt) */
unsigned long flags;
spin_lock_irqsave(&amp;my_lock, flags);
/* Critical section */
spin_unlock_irqrestore(&amp;my_lock, flags);

/* Bottom-half (softirq) protection */
spin_lock_bh(&amp;my_lock);
/* Critical section */
spin_unlock_bh(&amp;my_lock);
</code></pre>
<h3 id="mutex-pattern"><a class="header" href="#mutex-pattern">Mutex Pattern</a></h3>
<pre><code class="language-c">/* Define mutex */
struct mutex my_mutex;

/* Initialize */
mutex_init(&amp;my_mutex);

/* Use (can sleep, so only in process context) */
mutex_lock(&amp;my_mutex);
/* Critical section */
mutex_unlock(&amp;my_mutex);

/* Trylock */
if (mutex_trylock(&amp;my_mutex)) {
	/* Got the lock */
	mutex_unlock(&amp;my_mutex);
}

/* Interruptible lock */
if (mutex_lock_interruptible(&amp;my_mutex))
	return -EINTR;
/* Critical section */
mutex_unlock(&amp;my_mutex);
</code></pre>
<h3 id="read-write-locks"><a class="header" href="#read-write-locks">Read-Write Locks</a></h3>
<pre><code class="language-c">/* Spinlock version */
rwlock_t my_rwlock;
rwlock_init(&amp;my_rwlock);

/* Readers */
read_lock(&amp;my_rwlock);
/* Read data */
read_unlock(&amp;my_rwlock);

/* Writer */
write_lock(&amp;my_rwlock);
/* Modify data */
write_unlock(&amp;my_rwlock);

/* Semaphore version (can sleep) */
struct rw_semaphore my_rwsem;
init_rwsem(&amp;my_rwsem);

down_read(&amp;my_rwsem);
/* Read data */
up_read(&amp;my_rwsem);

down_write(&amp;my_rwsem);
/* Modify data */
up_write(&amp;my_rwsem);
</code></pre>
<h3 id="rcu-read-copy-update-pattern"><a class="header" href="#rcu-read-copy-update-pattern">RCU (Read-Copy-Update) Pattern</a></h3>
<pre><code class="language-c">/* RCU list */
struct my_data {
	int value;
	struct list_head list;
	struct rcu_head rcu;
};

static LIST_HEAD(my_list);
static DEFINE_SPINLOCK(list_lock);

/* Read (no lock needed!) */
rcu_read_lock();
list_for_each_entry_rcu(entry, &amp;my_list, list) {
	/* Read entry-&gt;value */
}
rcu_read_unlock();

/* Update (needs lock) */
spin_lock(&amp;list_lock);
new = kmalloc(sizeof(*new), GFP_KERNEL);
new-&gt;value = 42;
list_add_rcu(&amp;new-&gt;list, &amp;my_list);
spin_unlock(&amp;list_lock);

/* Delete */
static void my_data_free(struct rcu_head *head)
{
	struct my_data *entry = container_of(head, struct my_data, rcu);
	kfree(entry);
}

spin_lock(&amp;list_lock);
list_del_rcu(&amp;entry-&gt;list);
spin_unlock(&amp;list_lock);
call_rcu(&amp;entry-&gt;rcu, my_data_free);  /* Deferred free */
</code></pre>
<h3 id="completion-pattern"><a class="header" href="#completion-pattern">Completion Pattern</a></h3>
<pre><code class="language-c">/* Declare completion */
struct completion my_completion;

/* Initialize */
init_completion(&amp;my_completion);

/* Wait for completion */
wait_for_completion(&amp;my_completion);

/* Timeout version */
if (!wait_for_completion_timeout(&amp;my_completion, msecs_to_jiffies(5000)))
	printk(KERN_ERR "Timeout waiting for completion\n");

/* Signal completion */
complete(&amp;my_completion);

/* Signal all waiters */
complete_all(&amp;my_completion);
</code></pre>
<h3 id="atomic-operations"><a class="header" href="#atomic-operations">Atomic Operations</a></h3>
<pre><code class="language-c">/* Atomic integer */
atomic_t counter = ATOMIC_INIT(0);

atomic_inc(&amp;counter);
atomic_dec(&amp;counter);
atomic_add(5, &amp;counter);
atomic_sub(3, &amp;counter);

/* Read */
int val = atomic_read(&amp;counter);

/* Set */
atomic_set(&amp;counter, 10);

/* Conditional operations */
if (atomic_dec_and_test(&amp;counter))
	/* Counter reached zero */

if (atomic_inc_and_test(&amp;counter))
	/* Counter is zero after increment */

/* Compare and swap */
int old = 5;
int new = 10;
atomic_cmpxchg(&amp;counter, old, new);

/* Bitops */
unsigned long flags = 0;
set_bit(0, &amp;flags);
clear_bit(0, &amp;flags);
if (test_bit(0, &amp;flags))
	/* Bit is set */

/* Atomic bitops */
test_and_set_bit(0, &amp;flags);
test_and_clear_bit(0, &amp;flags);
</code></pre>
<hr />
<h2 id="error-handling-6"><a class="header" href="#error-handling-6">Error Handling</a></h2>
<h3 id="error-code-pattern"><a class="header" href="#error-code-pattern">Error Code Pattern</a></h3>
<pre><code class="language-c">/* Return negative error codes, 0 for success */
int my_function(void)
{
	if (error_condition)
		return -EINVAL;  /* Invalid argument */

	if (no_memory)
		return -ENOMEM;  /* Out of memory */

	if (timeout)
		return -ETIMEDOUT;

	return 0;  /* Success */
}

/* Caller checks return value */
int ret = my_function();
if (ret) {
	printk(KERN_ERR "Function failed: %d\n", ret);
	return ret;  /* Propagate error */
}
</code></pre>
<h3 id="common-error-codes"><a class="header" href="#common-error-codes">Common Error Codes</a></h3>
<pre><code class="language-c">-EINVAL    /* Invalid argument */
-ENOMEM    /* Out of memory */
-EFAULT    /* Bad address (copy_from/to_user failed) */
-EBUSY     /* Device or resource busy */
-EAGAIN    /* Try again (non-blocking operation) */
-EINTR     /* Interrupted system call */
-EIO       /* I/O error */
-ENODEV    /* No such device */
-ENOTTY    /* Inappropriate ioctl for device */
-EPERM     /* Operation not permitted */
-EACCES    /* Permission denied */
-EEXIST    /* File exists */
-ENOENT    /* No such file or directory */
-ETIMEDOUT /* Connection timed out */
</code></pre>
<h3 id="cleanup-with-goto-pattern"><a class="header" href="#cleanup-with-goto-pattern">Cleanup with goto Pattern</a></h3>
<pre><code class="language-c">int complex_function(void)
{
	struct resource1 *res1 = NULL;
	struct resource2 *res2 = NULL;
	struct resource3 *res3 = NULL;
	int ret;

	res1 = allocate_resource1();
	if (!res1) {
		ret = -ENOMEM;
		goto out;
	}

	res2 = allocate_resource2();
	if (!res2) {
		ret = -ENOMEM;
		goto free_res1;
	}

	res3 = allocate_resource3();
	if (!res3) {
		ret = -ENOMEM;
		goto free_res2;
	}

	/* Do work */
	ret = do_work(res1, res2, res3);
	if (ret)
		goto free_res3;

	/* Success path */
	return 0;

free_res3:
	free_resource3(res3);
free_res2:
	free_resource2(res2);
free_res1:
	free_resource1(res1);
out:
	return ret;
}
</code></pre>
<h3 id="err_ptr-pattern"><a class="header" href="#err_ptr-pattern">ERR_PTR Pattern</a></h3>
<pre><code class="language-c">/* Return pointer or error */
struct my_struct *my_function(void)
{
	struct my_struct *ptr;

	ptr = kmalloc(sizeof(*ptr), GFP_KERNEL);
	if (!ptr)
		return ERR_PTR(-ENOMEM);

	if (some_error) {
		kfree(ptr);
		return ERR_PTR(-EINVAL);
	}

	return ptr;
}

/* Caller checks for error */
struct my_struct *ptr = my_function();
if (IS_ERR(ptr)) {
	int err = PTR_ERR(ptr);
	printk(KERN_ERR "Function failed: %d\n", err);
	return err;
}

/* Use ptr */
kfree(ptr);
</code></pre>
<hr />
<h2 id="device-driver-patterns"><a class="header" href="#device-driver-patterns">Device Driver Patterns</a></h2>
<h3 id="character-device-pattern"><a class="header" href="#character-device-pattern">Character Device Pattern</a></h3>
<pre><code class="language-c">#include &lt;linux/fs.h&gt;
#include &lt;linux/cdev.h&gt;

static dev_t dev_num;
static struct cdev my_cdev;
static struct class *my_class;

static int my_open(struct inode *inode, struct file *filp)
{
	/* Initialize private data */
	return 0;
}

static int my_release(struct inode *inode, struct file *filp)
{
	/* Cleanup */
	return 0;
}

static ssize_t my_read(struct file *filp, char __user *buf,
                       size_t count, loff_t *pos)
{
	/* Read data and copy to user space */
	if (copy_to_user(buf, kernel_buf, count))
		return -EFAULT;

	return count;
}

static ssize_t my_write(struct file *filp, const char __user *buf,
                        size_t count, loff_t *pos)
{
	/* Copy from user space and write */
	if (copy_from_user(kernel_buf, buf, count))
		return -EFAULT;

	return count;
}

static long my_ioctl(struct file *filp, unsigned int cmd, unsigned long arg)
{
	switch (cmd) {
	case MY_IOCTL_CMD:
		/* Handle command */
		break;
	default:
		return -ENOTTY;
	}
	return 0;
}

static const struct file_operations my_fops = {
	.owner = THIS_MODULE,
	.open = my_open,
	.release = my_release,
	.read = my_read,
	.write = my_write,
	.unlocked_ioctl = my_ioctl,
};

static int __init my_init(void)
{
	int ret;

	/* Allocate device number */
	ret = alloc_chrdev_region(&amp;dev_num, 0, 1, "mydev");
	if (ret &lt; 0)
		return ret;

	/* Initialize cdev */
	cdev_init(&amp;my_cdev, &amp;my_fops);
	my_cdev.owner = THIS_MODULE;

	/* Add cdev */
	ret = cdev_add(&amp;my_cdev, dev_num, 1);
	if (ret &lt; 0)
		goto unregister_chrdev;

	/* Create device class */
	my_class = class_create(THIS_MODULE, "myclass");
	if (IS_ERR(my_class)) {
		ret = PTR_ERR(my_class);
		goto del_cdev;
	}

	/* Create device */
	device_create(my_class, NULL, dev_num, NULL, "mydev");

	return 0;

del_cdev:
	cdev_del(&amp;my_cdev);
unregister_chrdev:
	unregister_chrdev_region(dev_num, 1);
	return ret;
}

static void __exit my_exit(void)
{
	device_destroy(my_class, dev_num);
	class_destroy(my_class);
	cdev_del(&amp;my_cdev);
	unregister_chrdev_region(dev_num, 1);
}

module_init(my_init);
module_exit(my_exit);
MODULE_LICENSE("GPL");
</code></pre>
<h3 id="platform-device-pattern"><a class="header" href="#platform-device-pattern">Platform Device Pattern</a></h3>
<pre><code class="language-c">#include &lt;linux/platform_device.h&gt;

static int my_probe(struct platform_device *pdev)
{
	struct resource *res;
	void __iomem *base;

	/* Get resources */
	res = platform_get_resource(pdev, IORESOURCE_MEM, 0);
	if (!res)
		return -ENODEV;

	/* Map registers */
	base = devm_ioremap_resource(&amp;pdev-&gt;dev, res);
	if (IS_ERR(base))
		return PTR_ERR(base);

	/* Store in device private data */
	platform_set_drvdata(pdev, base);

	return 0;
}

static int my_remove(struct platform_device *pdev)
{
	/* Cleanup */
	return 0;
}

static const struct of_device_id my_of_match[] = {
	{ .compatible = "vendor,my-device" },
	{ }
};
MODULE_DEVICE_TABLE(of, my_of_match);

static struct platform_driver my_driver = {
	.probe = my_probe,
	.remove = my_remove,
	.driver = {
		.name = "my-driver",
		.of_match_table = my_of_match,
	},
};

module_platform_driver(my_driver);
</code></pre>
<h3 id="interrupt-handler-pattern"><a class="header" href="#interrupt-handler-pattern">Interrupt Handler Pattern</a></h3>
<pre><code class="language-c">#include &lt;linux/interrupt.h&gt;

static irqreturn_t my_interrupt(int irq, void *dev_id)
{
	struct my_device *dev = dev_id;
	u32 status;

	/* Read interrupt status */
	status = readl(dev-&gt;base + STATUS_REG);

	if (!(status &amp; MY_IRQ_FLAG))
		return IRQ_NONE;  /* Not our interrupt */

	/* Clear interrupt */
	writel(status, dev-&gt;base + STATUS_REG);

	/* Handle interrupt - do minimal work */
	/* Schedule bottom half if needed */
	tasklet_schedule(&amp;dev-&gt;tasklet);

	return IRQ_HANDLED;
}

/* Bottom half (tasklet) */
static void my_tasklet_func(unsigned long data)
{
	struct my_device *dev = (struct my_device *)data;

	/* Do heavy work here */
}

/* Request IRQ */
ret = request_irq(irq, my_interrupt, IRQF_SHARED, "mydev", dev);

/* Free IRQ */
free_irq(irq, dev);

/* Threaded IRQ (for handlers that can sleep) */
ret = request_threaded_irq(irq, NULL, my_threaded_handler,
                            IRQF_ONESHOT, "mydev", dev);
</code></pre>
<hr />
<h2 id="data-structures-2"><a class="header" href="#data-structures-2">Data Structures</a></h2>
<h3 id="linked-lists"><a class="header" href="#linked-lists">Linked Lists</a></h3>
<pre><code class="language-c">#include &lt;linux/list.h&gt;

struct my_node {
	int data;
	struct list_head list;
};

/* Define and initialize list head */
static LIST_HEAD(my_list);

/* Add entry */
struct my_node *node = kmalloc(sizeof(*node), GFP_KERNEL);
node-&gt;data = 42;
list_add(&amp;node-&gt;list, &amp;my_list);       /* Add to head */
list_add_tail(&amp;node-&gt;list, &amp;my_list);  /* Add to tail */

/* Iterate */
struct my_node *entry;
list_for_each_entry(entry, &amp;my_list, list) {
	printk(KERN_INFO "data: %d\n", entry-&gt;data);
}

/* Safe iteration (allows deletion) */
struct my_node *tmp;
list_for_each_entry_safe(entry, tmp, &amp;my_list, list) {
	if (entry-&gt;data == 42) {
		list_del(&amp;entry-&gt;list);
		kfree(entry);
	}
}

/* Check if empty */
if (list_empty(&amp;my_list))
	printk(KERN_INFO "List is empty\n");
</code></pre>
<h3 id="hash-tables"><a class="header" href="#hash-tables">Hash Tables</a></h3>
<pre><code class="language-c">#include &lt;linux/hashtable.h&gt;

#define HASH_BITS 8

struct my_entry {
	int key;
	int value;
	struct hlist_node hash;
};

/* Declare hash table */
static DEFINE_HASHTABLE(my_hash, HASH_BITS);

/* Initialize */
hash_init(my_hash);

/* Add entry */
struct my_entry *entry = kmalloc(sizeof(*entry), GFP_KERNEL);
entry-&gt;key = 123;
entry-&gt;value = 456;
hash_add(my_hash, &amp;entry-&gt;hash, entry-&gt;key);

/* Find entry */
struct my_entry *found = NULL;
hash_for_each_possible(my_hash, entry, hash, key) {
	if (entry-&gt;key == key) {
		found = entry;
		break;
	}
}

/* Delete entry */
hash_del(&amp;entry-&gt;hash);

/* Iterate all entries */
int bkt;
hash_for_each(my_hash, bkt, entry, hash) {
	printk(KERN_INFO "key=%d value=%d\n", entry-&gt;key, entry-&gt;value);
}
</code></pre>
<h3 id="radix-tree"><a class="header" href="#radix-tree">Radix Tree</a></h3>
<pre><code class="language-c">#include &lt;linux/radix-tree.h&gt;

static RADIX_TREE(my_tree, GFP_KERNEL);

/* Insert */
void *item = kmalloc(sizeof(struct my_data), GFP_KERNEL);
radix_tree_insert(&amp;my_tree, index, item);

/* Lookup */
void *found = radix_tree_lookup(&amp;my_tree, index);

/* Delete */
void *deleted = radix_tree_delete(&amp;my_tree, index);
kfree(deleted);

/* Iterate */
struct radix_tree_iter iter;
void **slot;
radix_tree_for_each_slot(slot, &amp;my_tree, &amp;iter, start) {
	void *item = radix_tree_deref_slot(slot);
	/* Process item */
}
</code></pre>
<h3 id="red-black-tree"><a class="header" href="#red-black-tree">Red-Black Tree</a></h3>
<pre><code class="language-c">#include &lt;linux/rbtree.h&gt;

struct my_node {
	int key;
	struct rb_node node;
};

static struct rb_root my_tree = RB_ROOT;

/* Insert */
int my_insert(struct rb_root *root, struct my_node *data)
{
	struct rb_node **new = &amp;(root-&gt;rb_node), *parent = NULL;

	while (*new) {
		struct my_node *this = container_of(*new, struct my_node, node);

		parent = *new;
		if (data-&gt;key &lt; this-&gt;key)
			new = &amp;((*new)-&gt;rb_left);
		else if (data-&gt;key &gt; this-&gt;key)
			new = &amp;((*new)-&gt;rb_right);
		else
			return -EEXIST;
	}

	rb_link_node(&amp;data-&gt;node, parent, new);
	rb_insert_color(&amp;data-&gt;node, root);

	return 0;
}

/* Search */
struct my_node *my_search(struct rb_root *root, int key)
{
	struct rb_node *node = root-&gt;rb_node;

	while (node) {
		struct my_node *data = container_of(node, struct my_node, node);

		if (key &lt; data-&gt;key)
			node = node-&gt;rb_left;
		else if (key &gt; data-&gt;key)
			node = node-&gt;rb_right;
		else
			return data;
	}

	return NULL;
}

/* Erase */
rb_erase(&amp;node-&gt;node, &amp;my_tree);
</code></pre>
<hr />
<h2 id="kernel-apis"><a class="header" href="#kernel-apis">Kernel APIs</a></h2>
<h3 id="workqueues"><a class="header" href="#workqueues">Workqueues</a></h3>
<pre><code class="language-c">#include &lt;linux/workqueue.h&gt;

struct work_struct my_work;

/* Work function */
static void my_work_func(struct work_struct *work)
{
	/* Do work in process context */
}

/* Initialize */
INIT_WORK(&amp;my_work, my_work_func);

/* Schedule work */
schedule_work(&amp;my_work);

/* Delayed work */
struct delayed_work my_delayed_work;
INIT_DELAYED_WORK(&amp;my_delayed_work, my_work_func);
schedule_delayed_work(&amp;my_delayed_work, msecs_to_jiffies(1000));

/* Cancel work */
cancel_work_sync(&amp;my_work);
cancel_delayed_work_sync(&amp;my_delayed_work);
</code></pre>
<h3 id="timers"><a class="header" href="#timers">Timers</a></h3>
<pre><code class="language-c">#include &lt;linux/timer.h&gt;

struct timer_list my_timer;

/* Timer callback */
static void my_timer_callback(struct timer_list *t)
{
	/* Timer expired */
	printk(KERN_INFO "Timer expired\n");

	/* Reschedule if needed */
	mod_timer(&amp;my_timer, jiffies + msecs_to_jiffies(1000));
}

/* Initialize and start timer */
timer_setup(&amp;my_timer, my_timer_callback, 0);
mod_timer(&amp;my_timer, jiffies + msecs_to_jiffies(1000));

/* Stop timer */
del_timer_sync(&amp;my_timer);

/* High-resolution timers */
#include &lt;linux/hrtimer.h&gt;

struct hrtimer my_hrtimer;

static enum hrtimer_restart my_hrtimer_callback(struct hrtimer *timer)
{
	/* Timer expired */
	return HRTIMER_NORESTART;  /* Or HRTIMER_RESTART */
}

hrtimer_init(&amp;my_hrtimer, CLOCK_MONOTONIC, HRTIMER_MODE_REL);
my_hrtimer.function = my_hrtimer_callback;
hrtimer_start(&amp;my_hrtimer, ms_to_ktime(1000), HRTIMER_MODE_REL);
</code></pre>
<h3 id="wait-queues"><a class="header" href="#wait-queues">Wait Queues</a></h3>
<pre><code class="language-c">#include &lt;linux/wait.h&gt;

static DECLARE_WAIT_QUEUE_HEAD(my_wait_queue);
static int condition = 0;

/* Wait for condition */
wait_event(my_wait_queue, condition != 0);

/* Wait with timeout */
int ret = wait_event_timeout(my_wait_queue, condition != 0,
                              msecs_to_jiffies(5000));

/* Interruptible wait */
if (wait_event_interruptible(my_wait_queue, condition != 0))
	return -ERESTARTSYS;

/* Wake up waiters */
condition = 1;
wake_up(&amp;my_wait_queue);        /* Wake one */
wake_up_all(&amp;my_wait_queue);    /* Wake all */
wake_up_interruptible(&amp;my_wait_queue);
</code></pre>
<h3 id="kernel-threads"><a class="header" href="#kernel-threads">Kernel Threads</a></h3>
<pre><code class="language-c">#include &lt;linux/kthread.h&gt;

static struct task_struct *my_thread;

static int my_thread_func(void *data)
{
	while (!kthread_should_stop()) {
		/* Do work */

		/* Sleep */
		msleep(1000);

		/* Or wait for condition */
		wait_event_interruptible(queue, condition || kthread_should_stop());
	}

	return 0;
}

/* Create and start thread */
my_thread = kthread_run(my_thread_func, NULL, "my_thread");
if (IS_ERR(my_thread))
	return PTR_ERR(my_thread);

/* Stop thread */
kthread_stop(my_thread);
</code></pre>
<hr />
<h2 id="debugging-patterns"><a class="header" href="#debugging-patterns">Debugging Patterns</a></h2>
<h3 id="print-debugging"><a class="header" href="#print-debugging">Print Debugging</a></h3>
<pre><code class="language-c">/* Use appropriate log level */
printk(KERN_EMERG   "Emergency\n");    /* System unusable */
printk(KERN_ALERT   "Alert\n");        /* Action must be taken */
printk(KERN_CRIT    "Critical\n");     /* Critical conditions */
printk(KERN_ERR     "Error\n");        /* Error conditions */
printk(KERN_WARNING "Warning\n");      /* Warning conditions */
printk(KERN_NOTICE  "Notice\n");       /* Normal but significant */
printk(KERN_INFO    "Info\n");         /* Informational */
printk(KERN_DEBUG   "Debug\n");        /* Debug messages */

/* Modern API */
pr_emerg("Emergency\n");
pr_err("Error\n");
pr_info("Info\n");
pr_debug("Debug\n");  /* Only if DEBUG is defined */

/* Device-specific logging */
dev_err(&amp;pdev-&gt;dev, "Device error\n");
dev_info(&amp;pdev-&gt;dev, "Device info\n");
</code></pre>
<h3 id="dynamic-debug"><a class="header" href="#dynamic-debug">Dynamic Debug</a></h3>
<pre><code class="language-c">/* Compile with CONFIG_DYNAMIC_DEBUG */

/* Use pr_debug or dev_dbg */
pr_debug("Debug message: value=%d\n", value);
dev_dbg(&amp;dev-&gt;dev, "Device debug: %s\n", msg);

/* Enable at runtime */
/* echo 'file mydriver.c +p' &gt; /sys/kernel/debug/dynamic_debug/control */
</code></pre>
<h3 id="assertions"><a class="header" href="#assertions">Assertions</a></h3>
<pre><code class="language-c">/* BUG and WARN macros */
BUG_ON(bad_condition);        /* Panic if true */
WARN_ON(warning_condition);   /* Warning if true */

if (WARN_ON_ONCE(ptr == NULL))
	return -EINVAL;

/* Better: return error instead of crashing */
if (WARN(bad_condition, "Something went wrong: %d\n", value))
	return -EINVAL;
</code></pre>
<h3 id="tracing"><a class="header" href="#tracing">Tracing</a></h3>
<pre><code class="language-c">#include &lt;linux/trace_events.h&gt;

/* Use ftrace */
trace_printk("Fast trace message: %d\n", value);

/* Define tracepoints */
#include &lt;trace/events/mydriver.h&gt;

TRACE_EVENT(my_event,
	TP_PROTO(int value),
	TP_ARGS(value),
	TP_STRUCT__entry(
		__field(int, value)
	),
	TP_fast_assign(
		__entry-&gt;value = value;
	),
	TP_printk("value=%d", __entry-&gt;value)
);

/* Use tracepoint */
trace_my_event(42);
</code></pre>
<hr />
<h2 id="best-practices-15"><a class="header" href="#best-practices-15">Best Practices</a></h2>
<h3 id="resource-management"><a class="header" href="#resource-management">Resource Management</a></h3>
<pre><code class="language-c">/* Use devm_* functions for automatic cleanup on error/remove */
void __iomem *base = devm_ioremap_resource(&amp;pdev-&gt;dev, res);
int *ptr = devm_kmalloc(&amp;pdev-&gt;dev, size, GFP_KERNEL);
int irq = devm_request_irq(&amp;pdev-&gt;dev, irq_num, handler, flags, name, dev);

/* These are automatically freed when device is removed */
</code></pre>
<h3 id="copy-tofrom-user-space"><a class="header" href="#copy-tofrom-user-space">Copy to/from User Space</a></h3>
<pre><code class="language-c">/* Always use copy_to_user/copy_from_user */
if (copy_to_user(user_buf, kernel_buf, count))
	return -EFAULT;

if (copy_from_user(kernel_buf, user_buf, count))
	return -EFAULT;

/* For single values */
int value;
if (get_user(value, (int __user *)arg))
	return -EFAULT;

if (put_user(value, (int __user *)arg))
	return -EFAULT;

/* Check access */
if (!access_ok(user_buf, count))
	return -EFAULT;
</code></pre>
<h3 id="module-parameters"><a class="header" href="#module-parameters">Module Parameters</a></h3>
<pre><code class="language-c">/* Define module parameters */
static int debug = 0;
module_param(debug, int, 0644);
MODULE_PARM_DESC(debug, "Enable debug mode");

static char *name = "default";
module_param(name, charp, 0644);
MODULE_PARM_DESC(name, "Device name");

/* Load module with parameters */
/* insmod mymodule.ko debug=1 name="custom" */
</code></pre>
<h3 id="smp-safety"><a class="header" href="#smp-safety">SMP Safety</a></h3>
<pre><code class="language-c">/* Always consider SMP (multiprocessor) safety */

/* Use per-CPU variables for lock-free data */
DEFINE_PER_CPU(int, my_counter);

int val = get_cpu_var(my_counter);
val++;
put_cpu_var(my_counter);

/* Use proper locking */
/* Identify data that needs protection */
/* Choose appropriate lock type (spinlock vs mutex) */
/* Keep critical sections short */
/* Avoid nested locks (lock ordering) */
</code></pre>
<h3 id="power-management"><a class="header" href="#power-management">Power Management</a></h3>
<pre><code class="language-c">/* Implement PM operations */
static int my_suspend(struct device *dev)
{
	/* Save state, disable device */
	return 0;
}

static int my_resume(struct device *dev)
{
	/* Restore state, enable device */
	return 0;
}

static const struct dev_pm_ops my_pm_ops = {
	.suspend = my_suspend,
	.resume = my_resume,
};

static struct platform_driver my_driver = {
	.driver = {
		.name = "my-driver",
		.pm = &amp;my_pm_ops,
	},
};
</code></pre>
<hr />
<h2 id="common-pitfalls"><a class="header" href="#common-pitfalls">Common Pitfalls</a></h2>
<h3 id="dont-do-this"><a class="header" href="#dont-do-this">Don't Do This</a></h3>
<pre><code class="language-c">/* DON'T use floating point in kernel */
// float x = 3.14;  /* Wrong! */

/* DON'T use large stack allocations */
// char buffer[8192];  /* Too big for stack */
/* Use kmalloc instead */

/* DON'T sleep in atomic context */
spin_lock(&amp;lock);
// msleep(100);  /* Wrong! */
spin_unlock(&amp;lock);

/* DON'T access user space directly */
// int *user_ptr;
// *user_ptr = 5;  /* Wrong! Use copy_to_user */

/* DON'T ignore return values */
// kmalloc(size, GFP_KERNEL);  /* Check for NULL! */

/* DON'T use unbounded loops */
// while (1) { }  /* Use kthread_should_stop() */
</code></pre>
<hr />
<h2 id="resources-2"><a class="header" href="#resources-2">Resources</a></h2>
<ul>
<li><strong>Kernel Documentation</strong>: <code>Documentation/</code> in kernel source</li>
<li><strong>Coding Style</strong>: <code>Documentation/process/coding-style.rst</code></li>
<li><strong>API Documentation</strong>: <code>Documentation/core-api/</code></li>
<li><strong>Linux Kernel Development</strong> by Robert Love</li>
<li><strong>Linux Device Drivers</strong> by Corbet, Rubini, and Kroah-Hartman</li>
<li><strong>Understanding the Linux Kernel</strong> by Bovet and Cesati</li>
</ul>
<hr />
<p>Linux kernel development follows well-established patterns that promote consistency, safety, and performance. Understanding these patterns is essential for writing quality kernel code that integrates well with the rest of the kernel.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="linux-driver-development"><a class="header" href="#linux-driver-development">Linux Driver Development</a></h1>
<p>Comprehensive guide to developing device drivers for the Linux kernel, covering the driver model, device types, and best practices.</p>
<h2 id="table-of-contents-5"><a class="header" href="#table-of-contents-5">Table of Contents</a></h2>
<ul>
<li><a href="linux/driver_development.html#introduction">Introduction</a></li>
<li><a href="linux/driver_development.html#linux-driver-model">Linux Driver Model</a></li>
<li><a href="linux/driver_development.html#device-types">Device Types</a></li>
<li><a href="linux/driver_development.html#character-device-drivers">Character Device Drivers</a></li>
<li><a href="linux/driver_development.html#platform-drivers">Platform Drivers</a></li>
<li><a href="linux/driver_development.html#bus-drivers">Bus Drivers</a></li>
<li><a href="linux/driver_development.html#block-device-drivers">Block Device Drivers</a></li>
<li><a href="linux/driver_development.html#network-device-drivers">Network Device Drivers</a></li>
<li><a href="linux/driver_development.html#device-tree">Device Tree</a></li>
<li><a href="linux/driver_development.html#power-management">Power Management</a></li>
<li><a href="linux/driver_development.html#dma">DMA</a></li>
<li><a href="linux/driver_development.html#interrupts">Interrupts</a></li>
<li><a href="linux/driver_development.html#sysfs-and-device-model">sysfs and Device Model</a></li>
<li><a href="linux/driver_development.html#debugging">Debugging</a></li>
<li><a href="linux/driver_development.html#best-practices">Best Practices</a></li>
</ul>
<hr />
<h2 id="introduction"><a class="header" href="#introduction">Introduction</a></h2>
<p>Linux device drivers are kernel modules that provide an interface between hardware devices and the kernel. They abstract hardware complexity and provide a uniform API for user space.</p>
<h3 id="driver-architecture"><a class="header" href="#driver-architecture">Driver Architecture</a></h3>
<pre><code>┌─────────────────────────────────────┐
│        User Space                    │
│    (Applications, Libraries)         │
└─────────────────────────────────────┘
              │ System Calls
┌─────────────────────────────────────┐
│        Kernel Space                  │
│  ┌───────────────────────────────┐  │
│  │  Virtual File System (VFS)    │  │
│  └───────────────────────────────┘  │
│              │                       │
│  ┌───────────────────────────────┐  │
│  │    Device Drivers              │  │
│  │  - Character Drivers           │  │
│  │  - Block Drivers               │  │
│  │  - Network Drivers             │  │
│  └───────────────────────────────┘  │
│              │                       │
│  ┌───────────────────────────────┐  │
│  │    Bus Subsystems              │  │
│  │  - PCI, USB, I2C, SPI, etc.   │  │
│  └───────────────────────────────┘  │
└─────────────────────────────────────┘
              │
┌─────────────────────────────────────┐
│        Hardware                      │
└─────────────────────────────────────┘
</code></pre>
<h3 id="driver-types-1"><a class="header" href="#driver-types-1">Driver Types</a></h3>
<ol>
<li><strong>Character Drivers</strong>: Sequential access (serial ports, keyboards)</li>
<li><strong>Block Drivers</strong>: Random access (hard drives, SSDs)</li>
<li><strong>Network Drivers</strong>: Network interfaces (Ethernet, WiFi)</li>
</ol>
<hr />
<h2 id="linux-driver-model"><a class="header" href="#linux-driver-model">Linux Driver Model</a></h2>
<p>The Linux driver model provides a unified framework for device management.</p>
<h3 id="core-components"><a class="header" href="#core-components">Core Components</a></h3>
<pre><code>Device ←→ Driver ←→ Bus
   ↓         ↓       ↓
 struct   struct   struct
 device   driver    bus
</code></pre>
<h3 id="key-structures"><a class="header" href="#key-structures">Key Structures</a></h3>
<pre><code class="language-c">#include &lt;linux/device.h&gt;

/* Device structure */
struct device {
	struct device		*parent;
	struct device_private	*p;

	struct kobject kobj;
	const char		*init_name;
	const struct device_type *type;

	struct bus_type	*bus;
	struct device_driver *driver;

	void		*platform_data;
	void		*driver_data;

	struct dev_pm_info	power;
	struct dev_pm_domain	*pm_domain;

	int		numa_node;
	u64		*dma_mask;
	u64		coherent_dma_mask;

	struct device_dma_parameters *dma_parms;

	struct list_head	dma_pools;
	struct dma_coherent_mem	*dma_mem;

	struct dev_archdata	archdata;
	struct device_node	*of_node;
	struct fwnode_handle	*fwnode;

	dev_t			devt;
	u32			id;

	spinlock_t		devres_lock;
	struct list_head	devres_head;
};

/* Driver structure */
struct device_driver {
	const char		*name;
	struct bus_type		*bus;

	struct module		*owner;
	const char		*mod_name;

	bool suppress_bind_attrs;

	const struct of_device_id	*of_match_table;
	const struct acpi_device_id	*acpi_match_table;

	int (*probe) (struct device *dev);
	int (*remove) (struct device *dev);
	void (*shutdown) (struct device *dev);
	int (*suspend) (struct device *dev, pm_message_t state);
	int (*resume) (struct device *dev);

	const struct attribute_group **groups;

	const struct dev_pm_ops *pm;

	struct driver_private *p;
};

/* Bus type structure */
struct bus_type {
	const char		*name;
	const char		*dev_name;
	struct device		*dev_root;

	const struct attribute_group **bus_groups;
	const struct attribute_group **dev_groups;
	const struct attribute_group **drv_groups;

	int (*match)(struct device *dev, struct device_driver *drv);
	int (*uevent)(struct device *dev, struct kobj_uevent_env *env);
	int (*probe)(struct device *dev);
	int (*remove)(struct device *dev);
	void (*shutdown)(struct device *dev);

	int (*suspend)(struct device *dev, pm_message_t state);
	int (*resume)(struct device *dev);

	const struct dev_pm_ops *pm;

	struct subsys_private *p;
};
</code></pre>
<h3 id="device-registration"><a class="header" href="#device-registration">Device Registration</a></h3>
<pre><code class="language-c">/* Register a device */
int device_register(struct device *dev)
{
	device_initialize(dev);
	return device_add(dev);
}

/* Example: Create and register a device */
static int create_my_device(struct device *parent)
{
	struct device *dev;
	int ret;

	dev = kzalloc(sizeof(*dev), GFP_KERNEL);
	if (!dev)
		return -ENOMEM;

	dev-&gt;parent = parent;
	dev-&gt;bus = &amp;my_bus_type;
	dev_set_name(dev, "mydevice%d", id);

	ret = device_register(dev);
	if (ret) {
		put_device(dev);
		return ret;
	}

	return 0;
}

/* Unregister device */
void device_unregister(struct device *dev)
{
	device_del(dev);
	put_device(dev);
}
</code></pre>
<h3 id="driver-registration"><a class="header" href="#driver-registration">Driver Registration</a></h3>
<pre><code class="language-c">/* Register a driver */
int driver_register(struct device_driver *drv)
{
	int ret;

	ret = bus_add_driver(drv);
	if (ret)
		return ret;

	ret = driver_add_groups(drv, drv-&gt;groups);
	if (ret) {
		bus_remove_driver(drv);
		return ret;
	}

	return 0;
}

/* Example: Register a driver */
static struct device_driver my_driver = {
	.name = "my_driver",
	.bus = &amp;my_bus_type,
	.probe = my_probe,
	.remove = my_remove,
	.pm = &amp;my_pm_ops,
};

static int __init my_driver_init(void)
{
	return driver_register(&amp;my_driver);
}

static void __exit my_driver_exit(void)
{
	driver_unregister(&amp;my_driver);
}

module_init(my_driver_init);
module_exit(my_driver_exit);
</code></pre>
<h3 id="matching-devices-and-drivers"><a class="header" href="#matching-devices-and-drivers">Matching Devices and Drivers</a></h3>
<pre><code class="language-c">/* Bus match function */
static int my_bus_match(struct device *dev, struct device_driver *drv)
{
	struct my_device *my_dev = to_my_device(dev);
	struct my_driver *my_drv = to_my_driver(drv);

	/* Match by name */
	if (strcmp(dev_name(dev), drv-&gt;name) == 0)
		return 1;

	/* Match by compatible string (device tree) */
	if (of_driver_match_device(dev, drv))
		return 1;

	return 0;
}
</code></pre>
<hr />
<h2 id="device-types"><a class="header" href="#device-types">Device Types</a></h2>
<h3 id="character-devices"><a class="header" href="#character-devices">Character Devices</a></h3>
<p>Sequential access devices. Most common type.</p>
<pre><code class="language-c">#include &lt;linux/cdev.h&gt;
#include &lt;linux/fs.h&gt;

struct my_char_dev {
	struct cdev cdev;
	dev_t devt;
	struct class *class;
	struct device *device;
	/* Device-specific data */
	void __iomem *base;
	struct mutex lock;
};

static int my_open(struct inode *inode, struct file *filp)
{
	struct my_char_dev *dev;

	dev = container_of(inode-&gt;i_cdev, struct my_char_dev, cdev);
	filp-&gt;private_data = dev;

	pr_info("Device opened\n");
	return 0;
}

static int my_release(struct inode *inode, struct file *filp)
{
	pr_info("Device closed\n");
	return 0;
}

static ssize_t my_read(struct file *filp, char __user *buf,
		       size_t count, loff_t *f_pos)
{
	struct my_char_dev *dev = filp-&gt;private_data;
	char kbuf[256];
	size_t len;

	/* Read from hardware */
	len = snprintf(kbuf, sizeof(kbuf), "Hello from device\n");

	if (count &lt; len)
		len = count;

	if (copy_to_user(buf, kbuf, len))
		return -EFAULT;

	*f_pos += len;
	return len;
}

static ssize_t my_write(struct file *filp, const char __user *buf,
			size_t count, loff_t *f_pos)
{
	struct my_char_dev *dev = filp-&gt;private_data;
	char kbuf[256];

	if (count &gt; sizeof(kbuf) - 1)
		count = sizeof(kbuf) - 1;

	if (copy_from_user(kbuf, buf, count))
		return -EFAULT;

	kbuf[count] = '\0';

	pr_info("Received: %s\n", kbuf);

	/* Write to hardware */

	return count;
}

static long my_ioctl(struct file *filp, unsigned int cmd, unsigned long arg)
{
	struct my_char_dev *dev = filp-&gt;private_data;

	switch (cmd) {
	case MY_IOCTL_RESET:
		/* Reset device */
		pr_info("Reset device\n");
		break;

	case MY_IOCTL_GET_STATUS:
		/* Get device status */
		if (copy_to_user((void __user *)arg, &amp;dev-&gt;status,
				 sizeof(dev-&gt;status)))
			return -EFAULT;
		break;

	default:
		return -ENOTTY;
	}

	return 0;
}

static const struct file_operations my_fops = {
	.owner = THIS_MODULE,
	.open = my_open,
	.release = my_release,
	.read = my_read,
	.write = my_write,
	.unlocked_ioctl = my_ioctl,
};
</code></pre>
<h3 id="block-devices"><a class="header" href="#block-devices">Block Devices</a></h3>
<p>Random access storage devices.</p>
<pre><code class="language-c">#include &lt;linux/blkdev.h&gt;
#include &lt;linux/genhd.h&gt;

struct my_block_dev {
	spinlock_t lock;
	struct request_queue *queue;
	struct gendisk *gd;

	u8 *data;		/* Virtual disk storage */
	size_t size;		/* Size in bytes */
};

static void my_request(struct request_queue *q)
{
	struct request *req;
	struct my_block_dev *dev = q-&gt;queuedata;

	while ((req = blk_fetch_request(q)) != NULL) {
		sector_t sector = blk_rq_pos(req);
		unsigned long offset = sector * KERNEL_SECTOR_SIZE;
		size_t len = blk_rq_bytes(req);

		if (offset + len &gt; dev-&gt;size) {
			pr_err("Beyond device size\n");
			__blk_end_request_all(req, -EIO);
			continue;
		}

		if (rq_data_dir(req) == WRITE) {
			/* Write to virtual disk */
			memcpy(dev-&gt;data + offset, bio_data(req-&gt;bio), len);
		} else {
			/* Read from virtual disk */
			memcpy(bio_data(req-&gt;bio), dev-&gt;data + offset, len);
		}

		__blk_end_request_all(req, 0);
	}
}

static int my_block_open(struct block_device *bdev, fmode_t mode)
{
	pr_info("Block device opened\n");
	return 0;
}

static void my_block_release(struct gendisk *gd, fmode_t mode)
{
	pr_info("Block device released\n");
}

static const struct block_device_operations my_bdev_ops = {
	.owner = THIS_MODULE,
	.open = my_block_open,
	.release = my_block_release,
};

static int create_block_device(struct my_block_dev *dev)
{
	int ret;

	/* Allocate request queue */
	spin_lock_init(&amp;dev-&gt;lock);
	dev-&gt;queue = blk_init_queue(my_request, &amp;dev-&gt;lock);
	if (!dev-&gt;queue)
		return -ENOMEM;

	dev-&gt;queue-&gt;queuedata = dev;

	/* Allocate gendisk */
	dev-&gt;gd = alloc_disk(1);
	if (!dev-&gt;gd) {
		blk_cleanup_queue(dev-&gt;queue);
		return -ENOMEM;
	}

	dev-&gt;gd-&gt;major = MY_MAJOR;
	dev-&gt;gd-&gt;first_minor = 0;
	dev-&gt;gd-&gt;fops = &amp;my_bdev_ops;
	dev-&gt;gd-&gt;queue = dev-&gt;queue;
	dev-&gt;gd-&gt;private_data = dev;
	snprintf(dev-&gt;gd-&gt;disk_name, 32, "myblock");
	set_capacity(dev-&gt;gd, dev-&gt;size / KERNEL_SECTOR_SIZE);

	add_disk(dev-&gt;gd);

	return 0;
}
</code></pre>
<h3 id="network-devices"><a class="header" href="#network-devices">Network Devices</a></h3>
<pre><code class="language-c">#include &lt;linux/netdevice.h&gt;
#include &lt;linux/etherdevice.h&gt;

struct my_net_priv {
	struct net_device *dev;
	struct napi_struct napi;

	void __iomem *base;
	spinlock_t lock;
};

static int my_net_open(struct net_device *dev)
{
	struct my_net_priv *priv = netdev_priv(dev);

	/* Enable hardware */
	/* Request IRQ */
	/* Enable NAPI */
	napi_enable(&amp;priv-&gt;napi);

	netif_start_queue(dev);

	pr_info("Network device opened\n");
	return 0;
}

static int my_net_stop(struct net_device *dev)
{
	struct my_net_priv *priv = netdev_priv(dev);

	netif_stop_queue(dev);

	napi_disable(&amp;priv-&gt;napi);
	/* Free IRQ */
	/* Disable hardware */

	pr_info("Network device closed\n");
	return 0;
}

static netdev_tx_t my_net_start_xmit(struct sk_buff *skb,
				     struct net_device *dev)
{
	struct my_net_priv *priv = netdev_priv(dev);

	/* Transmit packet */
	/* Write to hardware TX ring */

	dev-&gt;stats.tx_packets++;
	dev-&gt;stats.tx_bytes += skb-&gt;len;

	dev_kfree_skb(skb);

	return NETDEV_TX_OK;
}

static int my_net_poll(struct napi_struct *napi, int budget)
{
	struct my_net_priv *priv = container_of(napi, struct my_net_priv, napi);
	struct net_device *dev = priv-&gt;dev;
	int work_done = 0;
	struct sk_buff *skb;

	/* Process RX packets */
	while (work_done &lt; budget) {
		/* Get packet from hardware */
		skb = my_get_rx_packet(priv);
		if (!skb)
			break;

		skb-&gt;dev = dev;
		skb-&gt;protocol = eth_type_trans(skb, dev);

		netif_receive_skb(skb);

		dev-&gt;stats.rx_packets++;
		dev-&gt;stats.rx_bytes += skb-&gt;len;

		work_done++;
	}

	if (work_done &lt; budget) {
		napi_complete(napi);
		/* Re-enable interrupts */
	}

	return work_done;
}

static const struct net_device_ops my_netdev_ops = {
	.ndo_open = my_net_open,
	.ndo_stop = my_net_stop,
	.ndo_start_xmit = my_net_start_xmit,
};

static int create_net_device(struct device *parent)
{
	struct net_device *dev;
	struct my_net_priv *priv;
	int ret;

	dev = alloc_etherdev(sizeof(*priv));
	if (!dev)
		return -ENOMEM;

	priv = netdev_priv(dev);
	priv-&gt;dev = dev;

	dev-&gt;netdev_ops = &amp;my_netdev_ops;
	dev-&gt;watchdog_timeo = 5 * HZ;

	/* Set MAC address */
	eth_hw_addr_random(dev);

	/* Setup NAPI */
	netif_napi_add(dev, &amp;priv-&gt;napi, my_net_poll, 64);

	SET_NETDEV_DEV(dev, parent);

	ret = register_netdev(dev);
	if (ret) {
		free_netdev(dev);
		return ret;
	}

	return 0;
}
</code></pre>
<hr />
<h2 id="character-device-drivers"><a class="header" href="#character-device-drivers">Character Device Drivers</a></h2>
<p>Complete example with multiple features.</p>
<pre><code class="language-c">#include &lt;linux/module.h&gt;
#include &lt;linux/fs.h&gt;
#include &lt;linux/cdev.h&gt;
#include &lt;linux/device.h&gt;
#include &lt;linux/uaccess.h&gt;

#define DEVICE_NAME "mychardev"
#define CLASS_NAME "myclass"

static int major_number;
static struct class *my_class;
static struct device *my_device;
static struct cdev my_cdev;

static char message[256] = "Hello from driver";
static short message_len;
static int times_opened = 0;

static int dev_open(struct inode *inode, struct file *file)
{
	times_opened++;
	pr_info("Device opened %d times\n", times_opened);
	return 0;
}

static int dev_release(struct inode *inode, struct file *file)
{
	pr_info("Device closed\n");
	return 0;
}

static ssize_t dev_read(struct file *file, char __user *buffer,
			size_t len, loff_t *offset)
{
	int bytes_to_read;

	if (*offset &gt;= message_len)
		return 0;

	bytes_to_read = min(len, (size_t)(message_len - *offset));

	if (copy_to_user(buffer, message + *offset, bytes_to_read))
		return -EFAULT;

	*offset += bytes_to_read;

	pr_info("Sent %d characters to user\n", bytes_to_read);

	return bytes_to_read;
}

static ssize_t dev_write(struct file *file, const char __user *buffer,
			 size_t len, loff_t *offset)
{
	size_t bytes_to_write = min(len, sizeof(message) - 1);

	if (copy_from_user(message, buffer, bytes_to_write))
		return -EFAULT;

	message[bytes_to_write] = '\0';
	message_len = bytes_to_write;

	pr_info("Received %zu characters from user\n", bytes_to_write);

	return bytes_to_write;
}

static struct file_operations fops = {
	.owner = THIS_MODULE,
	.open = dev_open,
	.release = dev_release,
	.read = dev_read,
	.write = dev_write,
};

static int __init chardev_init(void)
{
	int ret;
	dev_t dev;

	/* Allocate major number */
	ret = alloc_chrdev_region(&amp;dev, 0, 1, DEVICE_NAME);
	if (ret &lt; 0) {
		pr_err("Failed to allocate major number\n");
		return ret;
	}

	major_number = MAJOR(dev);
	pr_info("Registered with major number %d\n", major_number);

	/* Initialize cdev */
	cdev_init(&amp;my_cdev, &amp;fops);
	my_cdev.owner = THIS_MODULE;

	/* Add cdev */
	ret = cdev_add(&amp;my_cdev, dev, 1);
	if (ret &lt; 0) {
		unregister_chrdev_region(dev, 1);
		pr_err("Failed to add cdev\n");
		return ret;
	}

	/* Create class */
	my_class = class_create(THIS_MODULE, CLASS_NAME);
	if (IS_ERR(my_class)) {
		cdev_del(&amp;my_cdev);
		unregister_chrdev_region(dev, 1);
		pr_err("Failed to create class\n");
		return PTR_ERR(my_class);
	}

	/* Create device */
	my_device = device_create(my_class, NULL, dev, NULL, DEVICE_NAME);
	if (IS_ERR(my_device)) {
		class_destroy(my_class);
		cdev_del(&amp;my_cdev);
		unregister_chrdev_region(dev, 1);
		pr_err("Failed to create device\n");
		return PTR_ERR(my_device);
	}

	message_len = strlen(message);

	pr_info("Character device driver loaded\n");
	return 0;
}

static void __exit chardev_exit(void)
{
	dev_t dev = MKDEV(major_number, 0);

	device_destroy(my_class, dev);
	class_destroy(my_class);
	cdev_del(&amp;my_cdev);
	unregister_chrdev_region(dev, 1);

	pr_info("Character device driver unloaded\n");
}

module_init(chardev_init);
module_exit(chardev_exit);

MODULE_LICENSE("GPL");
MODULE_AUTHOR("Driver Developer");
MODULE_DESCRIPTION("Simple character device driver");
</code></pre>
<hr />
<h2 id="platform-drivers"><a class="header" href="#platform-drivers">Platform Drivers</a></h2>
<p>Platform drivers are for devices that are not discoverable (embedded SoCs).</p>
<pre><code class="language-c">#include &lt;linux/platform_device.h&gt;
#include &lt;linux/mod_devicetable.h&gt;
#include &lt;linux/io.h&gt;
#include &lt;linux/of.h&gt;

struct my_platform_dev {
	struct device *dev;
	void __iomem *base;
	struct resource *res;
	int irq;
};

static int my_platform_probe(struct platform_device *pdev)
{
	struct my_platform_dev *priv;
	struct resource *res;
	int ret;

	pr_info("Platform driver probe\n");

	priv = devm_kzalloc(&amp;pdev-&gt;dev, sizeof(*priv), GFP_KERNEL);
	if (!priv)
		return -ENOMEM;

	priv-&gt;dev = &amp;pdev-&gt;dev;

	/* Get memory resource */
	res = platform_get_resource(pdev, IORESOURCE_MEM, 0);
	if (!res) {
		dev_err(&amp;pdev-&gt;dev, "No memory resource\n");
		return -ENODEV;
	}

	/* Map registers */
	priv-&gt;base = devm_ioremap_resource(&amp;pdev-&gt;dev, res);
	if (IS_ERR(priv-&gt;base))
		return PTR_ERR(priv-&gt;base);

	/* Get IRQ */
	priv-&gt;irq = platform_get_irq(pdev, 0);
	if (priv-&gt;irq &lt; 0) {
		dev_err(&amp;pdev-&gt;dev, "No IRQ resource\n");
		return priv-&gt;irq;
	}

	/* Request IRQ */
	ret = devm_request_irq(&amp;pdev-&gt;dev, priv-&gt;irq, my_irq_handler,
			       IRQF_SHARED, dev_name(&amp;pdev-&gt;dev), priv);
	if (ret) {
		dev_err(&amp;pdev-&gt;dev, "Failed to request IRQ\n");
		return ret;
	}

	/* Store private data */
	platform_set_drvdata(pdev, priv);

	/* Initialize hardware */
	writel(0x1, priv-&gt;base + CTRL_REG);

	dev_info(&amp;pdev-&gt;dev, "Device initialized\n");

	return 0;
}

static int my_platform_remove(struct platform_device *pdev)
{
	struct my_platform_dev *priv = platform_get_drvdata(pdev);

	/* Shutdown hardware */
	writel(0x0, priv-&gt;base + CTRL_REG);

	dev_info(&amp;pdev-&gt;dev, "Device removed\n");

	return 0;
}

/* Device tree match table */
static const struct of_device_id my_of_match[] = {
	{ .compatible = "vendor,my-device" },
	{ .compatible = "vendor,my-device-v2" },
	{ }
};
MODULE_DEVICE_TABLE(of, my_of_match);

/* Platform device ID table (for non-DT systems) */
static const struct platform_device_id my_platform_ids[] = {
	{ .name = "my-device" },
	{ }
};
MODULE_DEVICE_TABLE(platform, my_platform_ids);

static struct platform_driver my_platform_driver = {
	.probe = my_platform_probe,
	.remove = my_platform_remove,
	.driver = {
		.name = "my-device",
		.of_match_table = my_of_match,
	},
	.id_table = my_platform_ids,
};

module_platform_driver(my_platform_driver);

MODULE_LICENSE("GPL");
MODULE_DESCRIPTION("Platform device driver");
</code></pre>
<hr />
<h2 id="bus-drivers"><a class="header" href="#bus-drivers">Bus Drivers</a></h2>
<h3 id="i2c-driver"><a class="header" href="#i2c-driver">I2C Driver</a></h3>
<pre><code class="language-c">#include &lt;linux/i2c.h&gt;

struct my_i2c_dev {
	struct i2c_client *client;
	struct device *dev;
};

static int my_i2c_probe(struct i2c_client *client,
			const struct i2c_device_id *id)
{
	struct my_i2c_dev *priv;
	u8 buf[2];
	int ret;

	dev_info(&amp;client-&gt;dev, "I2C device probed\n");

	priv = devm_kzalloc(&amp;client-&gt;dev, sizeof(*priv), GFP_KERNEL);
	if (!priv)
		return -ENOMEM;

	priv-&gt;client = client;
	priv-&gt;dev = &amp;client-&gt;dev;

	i2c_set_clientdata(client, priv);

	/* Read device ID */
	ret = i2c_smbus_read_byte_data(client, REG_ID);
	if (ret &lt; 0) {
		dev_err(&amp;client-&gt;dev, "Failed to read device ID\n");
		return ret;
	}

	dev_info(&amp;client-&gt;dev, "Device ID: 0x%02x\n", ret);

	/* Write configuration */
	buf[0] = REG_CONFIG;
	buf[1] = 0x80;
	ret = i2c_master_send(client, buf, 2);
	if (ret &lt; 0) {
		dev_err(&amp;client-&gt;dev, "Failed to write config\n");
		return ret;
	}

	return 0;
}

static int my_i2c_remove(struct i2c_client *client)
{
	dev_info(&amp;client-&gt;dev, "I2C device removed\n");
	return 0;
}

static const struct i2c_device_id my_i2c_ids[] = {
	{ "my-i2c-device", 0 },
	{ }
};
MODULE_DEVICE_TABLE(i2c, my_i2c_ids);

static const struct of_device_id my_i2c_of_match[] = {
	{ .compatible = "vendor,my-i2c-device" },
	{ }
};
MODULE_DEVICE_TABLE(of, my_i2c_of_match);

static struct i2c_driver my_i2c_driver = {
	.driver = {
		.name = "my-i2c-device",
		.of_match_table = my_i2c_of_match,
	},
	.probe = my_i2c_probe,
	.remove = my_i2c_remove,
	.id_table = my_i2c_ids,
};

module_i2c_driver(my_i2c_driver);
</code></pre>
<h3 id="spi-driver"><a class="header" href="#spi-driver">SPI Driver</a></h3>
<pre><code class="language-c">#include &lt;linux/spi/spi.h&gt;

struct my_spi_dev {
	struct spi_device *spi;
	struct device *dev;
};

static int my_spi_probe(struct spi_device *spi)
{
	struct my_spi_dev *priv;
	u8 tx_buf[2], rx_buf[2];
	int ret;

	dev_info(&amp;spi-&gt;dev, "SPI device probed\n");

	priv = devm_kzalloc(&amp;spi-&gt;dev, sizeof(*priv), GFP_KERNEL);
	if (!priv)
		return -ENOMEM;

	priv-&gt;spi = spi;
	priv-&gt;dev = &amp;spi-&gt;dev;

	spi_set_drvdata(spi, priv);

	/* Configure SPI mode and speed */
	spi-&gt;mode = SPI_MODE_0;
	spi-&gt;max_speed_hz = 1000000;
	spi-&gt;bits_per_word = 8;

	ret = spi_setup(spi);
	if (ret &lt; 0) {
		dev_err(&amp;spi-&gt;dev, "Failed to setup SPI\n");
		return ret;
	}

	/* Read register */
	tx_buf[0] = READ_CMD | REG_ID;
	tx_buf[1] = 0x00;

	ret = spi_write_then_read(spi, tx_buf, 1, rx_buf, 1);
	if (ret &lt; 0) {
		dev_err(&amp;spi-&gt;dev, "Failed to read register\n");
		return ret;
	}

	dev_info(&amp;spi-&gt;dev, "Device ID: 0x%02x\n", rx_buf[0]);

	return 0;
}

static int my_spi_remove(struct spi_device *spi)
{
	dev_info(&amp;spi-&gt;dev, "SPI device removed\n");
	return 0;
}

static const struct of_device_id my_spi_of_match[] = {
	{ .compatible = "vendor,my-spi-device" },
	{ }
};
MODULE_DEVICE_TABLE(of, my_spi_of_match);

static const struct spi_device_id my_spi_ids[] = {
	{ "my-spi-device", 0 },
	{ }
};
MODULE_DEVICE_TABLE(spi, my_spi_ids);

static struct spi_driver my_spi_driver = {
	.driver = {
		.name = "my-spi-device",
		.of_match_table = my_spi_of_match,
	},
	.probe = my_spi_probe,
	.remove = my_spi_remove,
	.id_table = my_spi_ids,
};

module_spi_driver(my_spi_driver);
</code></pre>
<h3 id="usb-driver"><a class="header" href="#usb-driver">USB Driver</a></h3>
<pre><code class="language-c">#include &lt;linux/usb.h&gt;

struct my_usb_dev {
	struct usb_device *udev;
	struct usb_interface *interface;
	struct urb *int_in_urb;
	unsigned char *int_in_buffer;
};

static void my_int_callback(struct urb *urb)
{
	struct my_usb_dev *dev = urb-&gt;context;
	int status = urb-&gt;status;

	switch (status) {
	case 0:
		/* Success */
		dev_info(&amp;dev-&gt;interface-&gt;dev, "Data: %*ph\n",
			 urb-&gt;actual_length, dev-&gt;int_in_buffer);
		break;
	case -ECONNRESET:
	case -ENOENT:
	case -ESHUTDOWN:
		/* URB killed */
		return;
	default:
		dev_err(&amp;dev-&gt;interface-&gt;dev, "URB error: %d\n", status);
		break;
	}

	/* Resubmit URB */
	usb_submit_urb(urb, GFP_ATOMIC);
}

static int my_usb_probe(struct usb_interface *interface,
			const struct usb_device_id *id)
{
	struct my_usb_dev *dev;
	struct usb_host_interface *iface_desc;
	struct usb_endpoint_descriptor *endpoint;
	int ret;

	dev_info(&amp;interface-&gt;dev, "USB device probed\n");

	dev = kzalloc(sizeof(*dev), GFP_KERNEL);
	if (!dev)
		return -ENOMEM;

	dev-&gt;udev = usb_get_dev(interface_to_usbdev(interface));
	dev-&gt;interface = interface;

	/* Get endpoint descriptors */
	iface_desc = interface-&gt;cur_altsetting;

	for (int i = 0; i &lt; iface_desc-&gt;desc.bNumEndpoints; i++) {
		endpoint = &amp;iface_desc-&gt;endpoint[i].desc;

		if (usb_endpoint_is_int_in(endpoint)) {
			/* Found interrupt IN endpoint */
			dev-&gt;int_in_buffer = kmalloc(
				le16_to_cpu(endpoint-&gt;wMaxPacketSize),
				GFP_KERNEL);
			if (!dev-&gt;int_in_buffer) {
				ret = -ENOMEM;
				goto error;
			}

			dev-&gt;int_in_urb = usb_alloc_urb(0, GFP_KERNEL);
			if (!dev-&gt;int_in_urb) {
				ret = -ENOMEM;
				goto error;
			}

			usb_fill_int_urb(dev-&gt;int_in_urb, dev-&gt;udev,
				usb_rcvintpipe(dev-&gt;udev, endpoint-&gt;bEndpointAddress),
				dev-&gt;int_in_buffer,
				le16_to_cpu(endpoint-&gt;wMaxPacketSize),
				my_int_callback,
				dev,
				endpoint-&gt;bInterval);

			/* Submit URB */
			ret = usb_submit_urb(dev-&gt;int_in_urb, GFP_KERNEL);
			if (ret) {
				dev_err(&amp;interface-&gt;dev, "Failed to submit URB\n");
				goto error;
			}
		}
	}

	usb_set_intfdata(interface, dev);

	return 0;

error:
	if (dev-&gt;int_in_urb)
		usb_free_urb(dev-&gt;int_in_urb);
	kfree(dev-&gt;int_in_buffer);
	usb_put_dev(dev-&gt;udev);
	kfree(dev);
	return ret;
}

static void my_usb_disconnect(struct usb_interface *interface)
{
	struct my_usb_dev *dev;

	dev = usb_get_intfdata(interface);

	usb_set_intfdata(interface, NULL);

	if (dev-&gt;int_in_urb) {
		usb_kill_urb(dev-&gt;int_in_urb);
		usb_free_urb(dev-&gt;int_in_urb);
	}

	kfree(dev-&gt;int_in_buffer);
	usb_put_dev(dev-&gt;udev);
	kfree(dev);

	dev_info(&amp;interface-&gt;dev, "USB device disconnected\n");
}

static const struct usb_device_id my_usb_table[] = {
	{ USB_DEVICE(VENDOR_ID, PRODUCT_ID) },
	{ }
};
MODULE_DEVICE_TABLE(usb, my_usb_table);

static struct usb_driver my_usb_driver = {
	.name = "my-usb-device",
	.probe = my_usb_probe,
	.disconnect = my_usb_disconnect,
	.id_table = my_usb_table,
};

module_usb_driver(my_usb_driver);
</code></pre>
<hr />
<h2 id="block-device-drivers"><a class="header" href="#block-device-drivers">Block Device Drivers</a></h2>
<p>(See earlier section for complete example)</p>
<h3 id="modern-block-layer-blk-mq"><a class="header" href="#modern-block-layer-blk-mq">Modern Block Layer (blk-mq)</a></h3>
<pre><code class="language-c">#include &lt;linux/blk-mq.h&gt;

struct my_blk_dev {
	struct blk_mq_tag_set tag_set;
	struct request_queue *queue;
	struct gendisk *disk;

	void *data;
	size_t size;
};

static blk_status_t my_queue_rq(struct blk_mq_hw_ctx *hctx,
				const struct blk_mq_queue_data *bd)
{
	struct request *rq = bd-&gt;rq;
	struct my_blk_dev *dev = rq-&gt;q-&gt;queuedata;
	struct bio_vec bvec;
	struct req_iterator iter;
	sector_t pos = blk_rq_pos(rq);
	void *buffer;
	unsigned long offset = pos * SECTOR_SIZE;

	blk_mq_start_request(rq);

	rq_for_each_segment(bvec, rq, iter) {
		buffer = page_address(bvec.bv_page) + bvec.bv_offset;

		if (rq_data_dir(rq) == WRITE)
			memcpy(dev-&gt;data + offset, buffer, bvec.bv_len);
		else
			memcpy(buffer, dev-&gt;data + offset, bvec.bv_len);

		offset += bvec.bv_len;
	}

	blk_mq_end_request(rq, BLK_STS_OK);

	return BLK_STS_OK;
}

static const struct blk_mq_ops my_mq_ops = {
	.queue_rq = my_queue_rq,
};

static int create_blkmq_device(struct my_blk_dev *dev)
{
	int ret;

	/* Initialize tag set */
	memset(&amp;dev-&gt;tag_set, 0, sizeof(dev-&gt;tag_set));
	dev-&gt;tag_set.ops = &amp;my_mq_ops;
	dev-&gt;tag_set.nr_hw_queues = 1;
	dev-&gt;tag_set.queue_depth = 128;
	dev-&gt;tag_set.numa_node = NUMA_NO_NODE;
	dev-&gt;tag_set.cmd_size = 0;
	dev-&gt;tag_set.flags = BLK_MQ_F_SHOULD_MERGE;
	dev-&gt;tag_set.driver_data = dev;

	ret = blk_mq_alloc_tag_set(&amp;dev-&gt;tag_set);
	if (ret)
		return ret;

	/* Allocate queue */
	dev-&gt;queue = blk_mq_init_queue(&amp;dev-&gt;tag_set);
	if (IS_ERR(dev-&gt;queue)) {
		blk_mq_free_tag_set(&amp;dev-&gt;tag_set);
		return PTR_ERR(dev-&gt;queue);
	}

	dev-&gt;queue-&gt;queuedata = dev;

	/* Allocate disk */
	dev-&gt;disk = alloc_disk(1);
	if (!dev-&gt;disk) {
		blk_cleanup_queue(dev-&gt;queue);
		blk_mq_free_tag_set(&amp;dev-&gt;tag_set);
		return -ENOMEM;
	}

	dev-&gt;disk-&gt;major = MY_MAJOR;
	dev-&gt;disk-&gt;first_minor = 0;
	dev-&gt;disk-&gt;fops = &amp;my_bdev_ops;
	dev-&gt;disk-&gt;queue = dev-&gt;queue;
	dev-&gt;disk-&gt;private_data = dev;
	snprintf(dev-&gt;disk-&gt;disk_name, 32, "myblkmq");
	set_capacity(dev-&gt;disk, dev-&gt;size / SECTOR_SIZE);

	add_disk(dev-&gt;disk);

	return 0;
}
</code></pre>
<hr />
<h2 id="network-device-drivers"><a class="header" href="#network-device-drivers">Network Device Drivers</a></h2>
<p>(See earlier section for complete example)</p>
<hr />
<h2 id="device-tree"><a class="header" href="#device-tree">Device Tree</a></h2>
<p>Device tree describes hardware topology for non-discoverable devices.</p>
<h3 id="device-tree-syntax"><a class="header" href="#device-tree-syntax">Device Tree Syntax</a></h3>
<pre><code class="language-dts">/* my-device.dts */
/dts-v1/;

/ {
	compatible = "vendor,my-board";
	#address-cells = &lt;1&gt;;
	#size-cells = &lt;1&gt;;

	my_device: my-device@40000000 {
		compatible = "vendor,my-device";
		reg = &lt;0x40000000 0x1000&gt;;
		interrupts = &lt;0 25 4&gt;;
		clocks = &lt;&amp;clk_peripheral&gt;;
		clock-names = "peripheral";
		status = "okay";

		/* Custom properties */
		vendor,feature-enable;
		vendor,threshold = &lt;100&gt;;
		vendor,string-prop = "value";
	};

	i2c@40005000 {
		compatible = "vendor,i2c";
		reg = &lt;0x40005000 0x1000&gt;;
		#address-cells = &lt;1&gt;;
		#size-cells = &lt;0&gt;;

		sensor@48 {
			compatible = "vendor,temperature-sensor";
			reg = &lt;0x48&gt;;
		};
	};
};
</code></pre>
<h3 id="parsing-device-tree-in-driver"><a class="header" href="#parsing-device-tree-in-driver">Parsing Device Tree in Driver</a></h3>
<pre><code class="language-c">#include &lt;linux/of.h&gt;
#include &lt;linux/of_device.h&gt;
#include &lt;linux/of_irq.h&gt;

static int my_probe(struct platform_device *pdev)
{
	struct device *dev = &amp;pdev-&gt;dev;
	struct device_node *np = dev-&gt;of_node;
	u32 threshold;
	const char *string_prop;
	int ret;

	/* Check compatible string */
	if (!of_device_is_compatible(np, "vendor,my-device"))
		return -ENODEV;

	/* Read u32 property */
	ret = of_property_read_u32(np, "vendor,threshold", &amp;threshold);
	if (ret) {
		dev_err(dev, "Failed to read threshold\n");
		return ret;
	}

	dev_info(dev, "Threshold: %u\n", threshold);

	/* Read string property */
	ret = of_property_read_string(np, "vendor,string-prop", &amp;string_prop);
	if (ret == 0)
		dev_info(dev, "String property: %s\n", string_prop);

	/* Check boolean property */
	if (of_property_read_bool(np, "vendor,feature-enable"))
		dev_info(dev, "Feature enabled\n");

	/* Get resource from reg property */
	res = platform_get_resource(pdev, IORESOURCE_MEM, 0);

	/* Get IRQ */
	irq = irq_of_parse_and_map(np, 0);

	/* Get clock */
	clk = devm_clk_get(dev, "peripheral");
	if (IS_ERR(clk))
		return PTR_ERR(clk);

	/* Get regulator */
	regulator = devm_regulator_get(dev, "vdd");

	return 0;
}
</code></pre>
<hr />
<h2 id="power-management-1"><a class="header" href="#power-management-1">Power Management</a></h2>
<pre><code class="language-c">#include &lt;linux/pm.h&gt;
#include &lt;linux/pm_runtime.h&gt;

/* System suspend/resume */
static int my_suspend(struct device *dev)
{
	struct my_dev *priv = dev_get_drvdata(dev);

	dev_info(dev, "Suspending\n");

	/* Save state */
	priv-&gt;saved_state = readl(priv-&gt;base + STATE_REG);

	/* Disable device */
	writel(0, priv-&gt;base + CTRL_REG);

	/* Gate clock */
	clk_disable_unprepare(priv-&gt;clk);

	return 0;
}

static int my_resume(struct device *dev)
{
	struct my_dev *priv = dev_get_drvdata(dev);
	int ret;

	dev_info(dev, "Resuming\n");

	/* Ungate clock */
	ret = clk_prepare_enable(priv-&gt;clk);
	if (ret)
		return ret;

	/* Restore state */
	writel(priv-&gt;saved_state, priv-&gt;base + STATE_REG);

	/* Enable device */
	writel(1, priv-&gt;base + CTRL_REG);

	return 0;
}

/* Runtime PM */
static int my_runtime_suspend(struct device *dev)
{
	struct my_dev *priv = dev_get_drvdata(dev);

	dev_dbg(dev, "Runtime suspend\n");

	clk_disable_unprepare(priv-&gt;clk);

	return 0;
}

static int my_runtime_resume(struct device *dev)
{
	struct my_dev *priv = dev_get_drvdata(dev);
	int ret;

	dev_dbg(dev, "Runtime resume\n");

	ret = clk_prepare_enable(priv-&gt;clk);
	if (ret)
		return ret;

	return 0;
}

static const struct dev_pm_ops my_pm_ops = {
	SET_SYSTEM_SLEEP_PM_OPS(my_suspend, my_resume)
	SET_RUNTIME_PM_OPS(my_runtime_suspend, my_runtime_resume, NULL)
};

/* Using runtime PM */
static int my_do_something(struct my_dev *priv)
{
	int ret;

	/* Get PM reference (resume device if suspended) */
	ret = pm_runtime_get_sync(priv-&gt;dev);
	if (ret &lt; 0) {
		pm_runtime_put_noidle(priv-&gt;dev);
		return ret;
	}

	/* Do work */
	writel(0x1, priv-&gt;base + CMD_REG);

	/* Release PM reference */
	pm_runtime_mark_last_busy(priv-&gt;dev);
	pm_runtime_put_autosuspend(priv-&gt;dev);

	return 0;
}
</code></pre>
<hr />
<h2 id="dma"><a class="header" href="#dma">DMA</a></h2>
<pre><code class="language-c">#include &lt;linux/dma-mapping.h&gt;

struct my_dma_dev {
	struct device *dev;
	dma_addr_t dma_handle;
	void *cpu_addr;
	size_t size;
};

/* Coherent (consistent) DMA mapping */
static int setup_coherent_dma(struct my_dma_dev *priv)
{
	priv-&gt;size = 4096;

	priv-&gt;cpu_addr = dma_alloc_coherent(priv-&gt;dev, priv-&gt;size,
					    &amp;priv-&gt;dma_handle, GFP_KERNEL);
	if (!priv-&gt;cpu_addr)
		return -ENOMEM;

	pr_info("DMA buffer: cpu=%p dma=%pad\n",
		priv-&gt;cpu_addr, &amp;priv-&gt;dma_handle);

	/* Write data to DMA buffer */
	memset(priv-&gt;cpu_addr, 0xAA, priv-&gt;size);

	/* Program hardware with DMA address */
	writel(priv-&gt;dma_handle, priv-&gt;base + DMA_ADDR_REG);
	writel(priv-&gt;size, priv-&gt;base + DMA_SIZE_REG);
	writel(DMA_START, priv-&gt;base + DMA_CTRL_REG);

	return 0;
}

static void cleanup_coherent_dma(struct my_dma_dev *priv)
{
	if (priv-&gt;cpu_addr) {
		dma_free_coherent(priv-&gt;dev, priv-&gt;size,
				  priv-&gt;cpu_addr, priv-&gt;dma_handle);
		priv-&gt;cpu_addr = NULL;
	}
}

/* Streaming DMA mapping */
static int do_streaming_dma_tx(struct my_dma_dev *priv, void *buffer,
			       size_t len)
{
	dma_addr_t dma_addr;

	/* Map buffer for DMA */
	dma_addr = dma_map_single(priv-&gt;dev, buffer, len, DMA_TO_DEVICE);
	if (dma_mapping_error(priv-&gt;dev, dma_addr))
		return -ENOMEM;

	/* Program hardware */
	writel(dma_addr, priv-&gt;base + DMA_ADDR_REG);
	writel(len, priv-&gt;base + DMA_SIZE_REG);
	writel(DMA_START, priv-&gt;base + DMA_CTRL_REG);

	/* Wait for DMA completion (in real driver, use interrupt) */

	/* Unmap buffer */
	dma_unmap_single(priv-&gt;dev, dma_addr, len, DMA_TO_DEVICE);

	return 0;
}

/* Scatter-gather DMA */
static int do_sg_dma(struct my_dma_dev *priv, struct scatterlist *sgl,
		     int nents)
{
	int mapped_nents;
	struct scatterlist *sg;
	int i;

	/* Map scatter-gather list */
	mapped_nents = dma_map_sg(priv-&gt;dev, sgl, nents, DMA_TO_DEVICE);
	if (!mapped_nents)
		return -ENOMEM;

	/* Program hardware with each SG entry */
	for_each_sg(sgl, sg, mapped_nents, i) {
		writel(sg_dma_address(sg),
		       priv-&gt;base + DMA_SG_ADDR_REG(i));
		writel(sg_dma_len(sg),
		       priv-&gt;base + DMA_SG_LEN_REG(i));
	}

	writel(mapped_nents, priv-&gt;base + DMA_SG_COUNT_REG);
	writel(DMA_SG_START, priv-&gt;base + DMA_CTRL_REG);

	/* Wait for completion */

	/* Unmap */
	dma_unmap_sg(priv-&gt;dev, sgl, nents, DMA_TO_DEVICE);

	return 0;
}

/* Set DMA mask */
static int setup_dma(struct device *dev)
{
	int ret;

	/* Try 64-bit DMA */
	ret = dma_set_mask_and_coherent(dev, DMA_BIT_MASK(64));
	if (ret) {
		/* Fall back to 32-bit */
		ret = dma_set_mask_and_coherent(dev, DMA_BIT_MASK(32));
		if (ret) {
			dev_err(dev, "No suitable DMA available\n");
			return ret;
		}
	}

	return 0;
}
</code></pre>
<hr />
<h2 id="interrupts"><a class="header" href="#interrupts">Interrupts</a></h2>
<pre><code class="language-c">#include &lt;linux/interrupt.h&gt;

/* Interrupt handler (top half) */
static irqreturn_t my_irq_handler(int irq, void *dev_id)
{
	struct my_dev *priv = dev_id;
	u32 status;

	/* Read interrupt status */
	status = readl(priv-&gt;base + INT_STATUS_REG);

	if (!(status &amp; MY_INT_MASK))
		return IRQ_NONE;  /* Not our interrupt */

	/* Clear interrupt */
	writel(status, priv-&gt;base + INT_STATUS_REG);

	/* Minimal processing */
	if (status &amp; INT_ERROR)
		priv-&gt;errors++;

	/* Schedule bottom half */
	schedule_work(&amp;priv-&gt;work);
	/* Or */
	tasklet_schedule(&amp;priv-&gt;tasklet);

	return IRQ_HANDLED;
}

/* Bottom half (workqueue) */
static void my_work_func(struct work_struct *work)
{
	struct my_dev *priv = container_of(work, struct my_dev, work);

	/* Heavy processing that can sleep */
	mutex_lock(&amp;priv-&gt;lock);
	/* Process data */
	mutex_unlock(&amp;priv-&gt;lock);
}

/* Bottom half (tasklet) */
static void my_tasklet_func(unsigned long data)
{
	struct my_dev *priv = (struct my_dev *)data;

	/* Processing that cannot sleep */
	spin_lock(&amp;priv-&gt;lock);
	/* Process data */
	spin_unlock(&amp;priv-&gt;lock);
}

/* Threaded IRQ handler */
static irqreturn_t my_threaded_irq(int irq, void *dev_id)
{
	struct my_dev *priv = dev_id;

	/* This runs in a kernel thread, can sleep */
	mutex_lock(&amp;priv-&gt;lock);

	/* Heavy processing */

	mutex_unlock(&amp;priv-&gt;lock);

	return IRQ_HANDLED;
}

/* Setup interrupts */
static int setup_interrupts(struct my_dev *priv)
{
	int ret;

	/* Regular IRQ */
	ret = devm_request_irq(priv-&gt;dev, priv-&gt;irq, my_irq_handler,
			       IRQF_SHARED, "my-device", priv);
	if (ret) {
		dev_err(priv-&gt;dev, "Failed to request IRQ\n");
		return ret;
	}

	/* Threaded IRQ */
	ret = devm_request_threaded_irq(priv-&gt;dev, priv-&gt;irq,
					NULL, my_threaded_irq,
					IRQF_ONESHOT, "my-device", priv);
	if (ret) {
		dev_err(priv-&gt;dev, "Failed to request threaded IRQ\n");
		return ret;
	}

	/* Initialize work */
	INIT_WORK(&amp;priv-&gt;work, my_work_func);

	/* Initialize tasklet */
	tasklet_init(&amp;priv-&gt;tasklet, my_tasklet_func, (unsigned long)priv);

	return 0;
}
</code></pre>
<hr />
<h2 id="sysfs-and-device-model"><a class="header" href="#sysfs-and-device-model">sysfs and Device Model</a></h2>
<pre><code class="language-c">#include &lt;linux/sysfs.h&gt;

/* sysfs attribute */
static ssize_t threshold_show(struct device *dev,
			      struct device_attribute *attr,
			      char *buf)
{
	struct my_dev *priv = dev_get_drvdata(dev);

	return sprintf(buf, "%u\n", priv-&gt;threshold);
}

static ssize_t threshold_store(struct device *dev,
			       struct device_attribute *attr,
			       const char *buf, size_t count)
{
	struct my_dev *priv = dev_get_drvdata(dev);
	unsigned int val;
	int ret;

	ret = kstrtouint(buf, 0, &amp;val);
	if (ret)
		return ret;

	if (val &gt; MAX_THRESHOLD)
		return -EINVAL;

	priv-&gt;threshold = val;

	/* Update hardware */
	writel(val, priv-&gt;base + THRESHOLD_REG);

	return count;
}

static DEVICE_ATTR_RW(threshold);

/* Binary attribute (for large data) */
static ssize_t firmware_read(struct file *filp, struct kobject *kobj,
			     struct bin_attribute *attr,
			     char *buf, loff_t pos, size_t count)
{
	struct device *dev = kobj_to_dev(kobj);
	struct my_dev *priv = dev_get_drvdata(dev);

	if (pos &gt;= priv-&gt;firmware_size)
		return 0;

	if (pos + count &gt; priv-&gt;firmware_size)
		count = priv-&gt;firmware_size - pos;

	memcpy(buf, priv-&gt;firmware + pos, count);

	return count;
}

static BIN_ATTR_RO(firmware, 0);

/* Attribute group */
static struct attribute *my_attrs[] = {
	&amp;dev_attr_threshold.attr,
	NULL,
};

static struct bin_attribute *my_bin_attrs[] = {
	&amp;bin_attr_firmware,
	NULL,
};

static const struct attribute_group my_attr_group = {
	.attrs = my_attrs,
	.bin_attrs = my_bin_attrs,
};

/* Register attributes */
static int register_sysfs(struct my_dev *priv)
{
	return sysfs_create_group(&amp;priv-&gt;dev-&gt;kobj, &amp;my_attr_group);
}

static void unregister_sysfs(struct my_dev *priv)
{
	sysfs_remove_group(&amp;priv-&gt;dev-&gt;kobj, &amp;my_attr_group);
}

/* Alternative: Use device attribute groups directly */
static const struct attribute_group *my_attr_groups[] = {
	&amp;my_attr_group,
	NULL,
};

/* Set in driver structure */
static struct device_driver my_driver = {
	.groups = my_attr_groups,
};
</code></pre>
<hr />
<h2 id="debugging"><a class="header" href="#debugging">Debugging</a></h2>
<h3 id="printk-and-dev_-functions"><a class="header" href="#printk-and-dev_-functions">printk and dev_* Functions</a></h3>
<pre><code class="language-c">/* Use appropriate log level */
pr_emerg("System is unusable\n");
pr_alert("Action must be taken immediately\n");
pr_crit("Critical conditions\n");
pr_err("Error conditions\n");
pr_warn("Warning conditions\n");
pr_notice("Normal but significant\n");
pr_info("Informational\n");
pr_debug("Debug-level messages\n");

/* Device-specific logging (preferred) */
dev_err(dev, "Device error: %d\n", err);
dev_warn(dev, "Device warning\n");
dev_info(dev, "Device information\n");
dev_dbg(dev, "Device debug\n");

/* Rate limited logging */
dev_err_ratelimited(dev, "This might happen often\n");
dev_warn_once(dev, "Only print once\n");
</code></pre>
<h3 id="debugfs"><a class="header" href="#debugfs">debugfs</a></h3>
<pre><code class="language-c">#include &lt;linux/debugfs.h&gt;

struct my_dev {
	struct dentry *debugfs_dir;
	u32 debug_value;
};

static int register_debugfs(struct my_dev *priv)
{
	priv-&gt;debugfs_dir = debugfs_create_dir("my-device", NULL);
	if (!priv-&gt;debugfs_dir)
		return -ENOMEM;

	/* Create files */
	debugfs_create_u32("debug_value", 0644, priv-&gt;debugfs_dir,
			   &amp;priv-&gt;debug_value);

	debugfs_create_file("registers", 0444, priv-&gt;debugfs_dir,
			    priv, &amp;registers_fops);

	return 0;
}

static void unregister_debugfs(struct my_dev *priv)
{
	debugfs_remove_recursive(priv-&gt;debugfs_dir);
}

/* Custom debugfs file operations */
static int registers_show(struct seq_file *s, void *unused)
{
	struct my_dev *priv = s-&gt;private;

	seq_printf(s, "CTRL:   0x%08x\n", readl(priv-&gt;base + CTRL_REG));
	seq_printf(s, "STATUS: 0x%08x\n", readl(priv-&gt;base + STATUS_REG));
	seq_printf(s, "DATA:   0x%08x\n", readl(priv-&gt;base + DATA_REG));

	return 0;
}

static int registers_open(struct inode *inode, struct file *file)
{
	return single_open(file, registers_show, inode-&gt;i_private);
}

static const struct file_operations registers_fops = {
	.open = registers_open,
	.read = seq_read,
	.llseek = seq_lseek,
	.release = single_release,
};
</code></pre>
<h3 id="tracing-1"><a class="header" href="#tracing-1">Tracing</a></h3>
<pre><code class="language-c">/* Use trace_printk for fast debugging */
trace_printk("Fast trace: value=%d\n", value);

/* Define tracepoints */
#include &lt;trace/events/my_driver.h&gt;

TRACE_EVENT(my_event,
	TP_PROTO(int value, const char *msg),
	TP_ARGS(value, msg),
	TP_STRUCT__entry(
		__field(int, value)
		__string(msg, msg)
	),
	TP_fast_assign(
		__entry-&gt;value = value;
		__assign_str(msg, msg);
	),
	TP_printk("value=%d msg=%s", __entry-&gt;value, __get_str(msg))
);

/* Use tracepoint */
trace_my_event(42, "test message");
</code></pre>
<hr />
<h2 id="best-practices-16"><a class="header" href="#best-practices-16">Best Practices</a></h2>
<h3 id="error-handling-7"><a class="header" href="#error-handling-7">Error Handling</a></h3>
<pre><code class="language-c">/* Always check return values */
ret = device_register(&amp;my_device);
if (ret) {
	pr_err("Failed to register device: %d\n", ret);
	goto err_register;
}

/* Use goto for cleanup */
err_register:
	kfree(buffer);
err_alloc:
	return ret;

/* Use devm_* functions for automatic cleanup */
priv = devm_kzalloc(dev, sizeof(*priv), GFP_KERNEL);
priv-&gt;base = devm_ioremap_resource(dev, res);
devm_request_irq(dev, irq, handler, flags, name, dev_id);
</code></pre>
<h3 id="memory-management-2"><a class="header" href="#memory-management-2">Memory Management</a></h3>
<pre><code class="language-c">/* Use appropriate allocation flags */
/* GFP_KERNEL: Can sleep (process context) */
ptr = kmalloc(size, GFP_KERNEL);

/* GFP_ATOMIC: Cannot sleep (interrupt context) */
ptr = kmalloc(size, GFP_ATOMIC);

/* Always check for NULL */
if (!ptr)
	return -ENOMEM;

/* Free memory */
kfree(ptr);

/* Use devm_* for automatic cleanup */
ptr = devm_kmalloc(dev, size, GFP_KERNEL);
/* No need to explicitly free */
</code></pre>
<h3 id="locking"><a class="header" href="#locking">Locking</a></h3>
<pre><code class="language-c">/* Choose appropriate lock type */

/* Mutex: Can sleep, process context only */
mutex_lock(&amp;priv-&gt;lock);
/* ... */
mutex_unlock(&amp;priv-&gt;lock);

/* Spinlock: Cannot sleep, short critical sections */
spin_lock(&amp;priv-&gt;lock);
/* ... */
spin_unlock(&amp;priv-&gt;lock);

/* Spinlock with IRQ disable (accessed from IRQ) */
unsigned long flags;
spin_lock_irqsave(&amp;priv-&gt;lock, flags);
/* ... */
spin_unlock_irqrestore(&amp;priv-&gt;lock, flags);
</code></pre>
<h3 id="module-parameters-1"><a class="header" href="#module-parameters-1">Module Parameters</a></h3>
<pre><code class="language-c">static int debug = 0;
module_param(debug, int, 0644);
MODULE_PARM_DESC(debug, "Enable debug output");

static char *mode = "auto";
module_param(mode, charp, 0444);
MODULE_PARM_DESC(mode, "Operating mode");

/* Use in code */
if (debug)
	pr_info("Debug mode enabled\n");
</code></pre>
<h3 id="module-metadata"><a class="header" href="#module-metadata">Module Metadata</a></h3>
<pre><code class="language-c">MODULE_LICENSE("GPL");
MODULE_AUTHOR("Your Name &lt;your.email@example.com&gt;");
MODULE_DESCRIPTION("Device driver for XYZ hardware");
MODULE_VERSION("1.0");
MODULE_ALIAS("platform:my-device");
</code></pre>
<hr />
<h2 id="resources-3"><a class="header" href="#resources-3">Resources</a></h2>
<ul>
<li><strong>Linux Device Drivers</strong> (LDD3): <a href="https://lwn.net/Kernel/LDD3/">https://lwn.net/Kernel/LDD3/</a></li>
<li><strong>Kernel Documentation</strong>: <code>Documentation/driver-api/</code> in kernel source</li>
<li><strong>Device Tree</strong>: <code>Documentation/devicetree/</code> in kernel source</li>
<li><strong>Example Drivers</strong>: <code>drivers/</code> in kernel source tree</li>
<li><strong>Linux Driver Development for Embedded Processors</strong> (Alberto Liberal)</li>
<li><strong>Essential Linux Device Drivers</strong> (Sreekrishnan Venkateswaran)</li>
</ul>
<hr />
<p>Linux driver development requires understanding of kernel internals, hardware interfaces, and proper resource management. Following best practices and using the kernel's device model framework ensures drivers are maintainable, efficient, and safe.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="device-tree-1"><a class="header" href="#device-tree-1">Device Tree</a></h1>
<p>A comprehensive guide to Linux Device Tree, a data structure for describing hardware configuration that can be passed to the kernel at boot time.</p>
<h2 id="table-of-contents-6"><a class="header" href="#table-of-contents-6">Table of Contents</a></h2>
<ul>
<li><a href="linux/device_tree.html#overview">Overview</a></li>
<li><a href="linux/device_tree.html#why-device-tree">Why Device Tree?</a></li>
<li><a href="linux/device_tree.html#device-tree-basics">Device Tree Basics</a></li>
<li><a href="linux/device_tree.html#device-tree-syntax">Device Tree Syntax</a></li>
<li><a href="linux/device_tree.html#device-tree-structure">Device Tree Structure</a></li>
<li><a href="linux/device_tree.html#standard-properties">Standard Properties</a></li>
<li><a href="linux/device_tree.html#writing-device-tree-files">Writing Device Tree Files</a></li>
<li><a href="linux/device_tree.html#device-tree-compiler">Device Tree Compiler</a></li>
<li><a href="linux/device_tree.html#parsing-device-tree-in-drivers">Parsing Device Tree in Drivers</a></li>
<li><a href="linux/device_tree.html#common-bindings">Common Bindings</a></li>
<li><a href="linux/device_tree.html#platform-specific-details">Platform-Specific Details</a></li>
<li><a href="linux/device_tree.html#debugging-device-tree">Debugging Device Tree</a></li>
<li><a href="linux/device_tree.html#best-practices">Best Practices</a></li>
<li><a href="linux/device_tree.html#real-world-examples">Real-World Examples</a></li>
</ul>
<hr />
<h2 id="overview-12"><a class="header" href="#overview-12">Overview</a></h2>
<p><strong>Device Tree</strong> is a data structure and language for describing hardware that cannot be dynamically detected by the operating system. It's used extensively in embedded systems, especially ARM-based platforms.</p>
<h3 id="key-concepts"><a class="header" href="#key-concepts">Key Concepts</a></h3>
<ul>
<li><strong>Device Tree Source (.dts)</strong>: Human-readable text file describing hardware</li>
<li><strong>Device Tree Blob (.dtb)</strong>: Compiled binary format loaded by bootloader</li>
<li><strong>Device Tree Overlay (.dtbo)</strong>: Runtime modifications to base device tree</li>
<li><strong>Bindings</strong>: Documentation defining properties for specific device types</li>
</ul>
<h3 id="purpose"><a class="header" href="#purpose">Purpose</a></h3>
<pre><code>+-----------------+
|   Bootloader    |
|   (U-Boot)      |
+-----------------+
        |
        | Passes DTB
        v
+-----------------+
|  Linux Kernel   |
+-----------------+
        |
        | Parses DT
        v
+-----------------+
| Device Drivers  |
+-----------------+
</code></pre>
<p>Device Tree allows:</p>
<ul>
<li>Hardware description separated from kernel code</li>
<li>Single kernel binary supporting multiple boards</li>
<li>Board-specific configuration without recompiling kernel</li>
<li>Runtime hardware configuration via overlays</li>
</ul>
<hr />
<h2 id="why-device-tree"><a class="header" href="#why-device-tree">Why Device Tree?</a></h2>
<h3 id="problems-device-tree-solves"><a class="header" href="#problems-device-tree-solves">Problems Device Tree Solves</a></h3>
<p><strong>Before Device Tree:</strong></p>
<pre><code class="language-c">/* ARM board file - arch/arm/mach-vendor/board-xyz.c */
static struct platform_device uart0 = {
	.name = "vendor-uart",
	.id = 0,
	.resource = {
		.start = 0x44e09000,
		.end = 0x44e09fff,
		.flags = IORESOURCE_MEM,
	},
	.dev = {
		.platform_data = &amp;uart0_data,
	},
};

platform_device_register(&amp;uart0);
</code></pre>
<p><strong>Problems:</strong></p>
<ul>
<li>Board-specific code in kernel</li>
<li>One kernel per board variant</li>
<li>Difficult to maintain</li>
<li>No standardization</li>
</ul>
<p><strong>With Device Tree:</strong></p>
<pre><code class="language-dts">uart0: serial@44e09000 {
	compatible = "vendor,uart";
	reg = &lt;0x44e09000 0x1000&gt;;
	interrupts = &lt;72&gt;;
	clock-frequency = &lt;48000000&gt;;
};
</code></pre>
<p><strong>Benefits:</strong></p>
<ul>
<li>Hardware description in separate file</li>
<li>Single kernel for multiple boards</li>
<li>Standardized bindings</li>
<li>Easier to maintain</li>
</ul>
<hr />
<h2 id="device-tree-basics"><a class="header" href="#device-tree-basics">Device Tree Basics</a></h2>
<h3 id="device-tree-hierarchy"><a class="header" href="#device-tree-hierarchy">Device Tree Hierarchy</a></h3>
<p>Device Tree represents hardware as a tree of nodes:</p>
<pre><code class="language-dts">/ {
	model = "Vendor Board XYZ";
	compatible = "vendor,board-xyz";

	cpus {
		cpu@0 {
			compatible = "arm,cortex-a8";
			device_type = "cpu";
			reg = &lt;0&gt;;
		};
	};

	memory@80000000 {
		device_type = "memory";
		reg = &lt;0x80000000 0x20000000&gt;;  /* 512MB */
	};

	soc {
		compatible = "simple-bus";
		#address-cells = &lt;1&gt;;
		#size-cells = &lt;1&gt;;
		ranges;

		uart0: serial@44e09000 {
			compatible = "vendor,uart";
			reg = &lt;0x44e09000 0x1000&gt;;
		};
	};
};
</code></pre>
<h3 id="key-terminology"><a class="header" href="#key-terminology">Key Terminology</a></h3>
<ul>
<li><strong>Node</strong>: Represents a device or bus (<code>uart0</code>, <code>cpus</code>)</li>
<li><strong>Property</strong>: Key-value pair in a node (<code>compatible = "vendor,uart"</code>)</li>
<li><strong>Label</strong>: Reference to a node (<code>uart0:</code>)</li>
<li><strong>Phandle</strong>: Reference to another node (pointer to node)</li>
<li><strong>Unit Address</strong>: Address part after <code>@</code> (<code>serial@44e09000</code>)</li>
</ul>
<hr />
<h2 id="device-tree-syntax-1"><a class="header" href="#device-tree-syntax-1">Device Tree Syntax</a></h2>
<h3 id="basic-syntax-9"><a class="header" href="#basic-syntax-9">Basic Syntax</a></h3>
<pre><code class="language-dts">/* Comments use C-style syntax */

/ {
	/* Root node - always present */

	node-name {
		/* Properties */
		property-name = "string value";
		another-property = &lt;0x12345678&gt;;
		multi-value = &lt;0x1 0x2 0x3&gt;;
		boolean-property;  /* Presence indicates true */
	};

	node@unit-address {
		/* Node with unit address */
		reg = &lt;0x12340000 0x1000&gt;;
	};
};
</code></pre>
<h3 id="property-value-types"><a class="header" href="#property-value-types">Property Value Types</a></h3>
<pre><code class="language-dts">/ {
	/* String */
	model = "Vendor Board XYZ";

	/* String list */
	compatible = "vendor,board-xyz", "vendor,board";

	/* 32-bit unsigned integers (cells) */
	reg = &lt;0x44e09000 0x1000&gt;;

	/* Multiple cells */
	interrupts = &lt;0 72 4&gt;;

	/* Boolean (empty property) */
	dma-coherent;

	/* Byte sequence */
	mac-address = [00 11 22 33 44 55];

	/* Mixed */
	property = "string", &lt;0x1234&gt;, [AB CD];

	/* Phandle reference */
	interrupt-parent = &lt;&amp;intc&gt;;
	clocks = &lt;&amp;osc 0&gt;;
};
</code></pre>
<h3 id="cell-size-specifiers"><a class="header" href="#cell-size-specifiers">Cell Size Specifiers</a></h3>
<pre><code class="language-dts">/ {
	#address-cells = &lt;1&gt;;  /* Address takes 1 cell (32-bit) */
	#size-cells = &lt;1&gt;;     /* Size takes 1 cell */

	soc {
		#address-cells = &lt;1&gt;;
		#size-cells = &lt;1&gt;;

		/* reg = &lt;address size&gt; */
		uart0: serial@44e09000 {
			reg = &lt;0x44e09000 0x1000&gt;;
		};
	};
};

/ {
	#address-cells = &lt;2&gt;;  /* 64-bit addressing */
	#size-cells = &lt;2&gt;;

	memory@0 {
		/* reg = &lt;address-high address-low size-high size-low&gt; */
		reg = &lt;0x00000000 0x80000000 0x00000000 0x40000000&gt;;
	};
};
</code></pre>
<h3 id="labels-and-references"><a class="header" href="#labels-and-references">Labels and References</a></h3>
<pre><code class="language-dts">/ {
	/* Define label */
	intc: interrupt-controller@48200000 {
		compatible = "arm,gic";
		reg = &lt;0x48200000 0x1000&gt;;
		interrupt-controller;
		#interrupt-cells = &lt;3&gt;;
	};

	uart0: serial@44e09000 {
		compatible = "vendor,uart";
		/* Reference using phandle */
		interrupt-parent = &lt;&amp;intc&gt;;
		interrupts = &lt;0 72 4&gt;;
		clocks = &lt;&amp;sysclk&gt;;
	};
};
</code></pre>
<h3 id="includes"><a class="header" href="#includes">Includes</a></h3>
<pre><code class="language-dts">/* Include common definitions */
/include/ "vendor-common.dtsi"

/* Or using C preprocessor */
#include "vendor-common.dtsi"
#include &lt;dt-bindings/gpio/gpio.h&gt;

/ {
	compatible = "vendor,board";
};
</code></pre>
<hr />
<h2 id="device-tree-structure"><a class="header" href="#device-tree-structure">Device Tree Structure</a></h2>
<h3 id="complete-example"><a class="header" href="#complete-example">Complete Example</a></h3>
<pre><code class="language-dts">/dts-v1/;

/ {
	model = "Vendor Development Board";
	compatible = "vendor,dev-board", "vendor,soc";

	#address-cells = &lt;1&gt;;
	#size-cells = &lt;1&gt;;

	chosen {
		bootargs = "console=ttyS0,115200 root=/dev/mmcblk0p2";
		stdout-path = "/serial@44e09000:115200n8";
	};

	memory@80000000 {
		device_type = "memory";
		reg = &lt;0x80000000 0x40000000&gt;;  /* 1GB */
	};

	cpus {
		#address-cells = &lt;1&gt;;
		#size-cells = &lt;0&gt;;

		cpu0: cpu@0 {
			compatible = "arm,cortex-a8";
			device_type = "cpu";
			reg = &lt;0&gt;;
			operating-points = &lt;
				/* kHz    uV */
				1000000 1350000
				800000  1300000
				600000  1200000
			&gt;;
			clock-latency = &lt;300000&gt;; /* 300 us */
		};
	};

	clocks {
		osc: oscillator {
			compatible = "fixed-clock";
			#clock-cells = &lt;0&gt;;
			clock-frequency = &lt;24000000&gt;;
		};

		sysclk: system-clock {
			compatible = "fixed-clock";
			#clock-cells = &lt;0&gt;;
			clock-frequency = &lt;48000000&gt;;
		};
	};

	soc {
		compatible = "simple-bus";
		#address-cells = &lt;1&gt;;
		#size-cells = &lt;1&gt;;
		ranges;

		intc: interrupt-controller@48200000 {
			compatible = "arm,cortex-a8-gic";
			interrupt-controller;
			#interrupt-cells = &lt;3&gt;;
			reg = &lt;0x48200000 0x1000&gt;,
			      &lt;0x48210000 0x2000&gt;;
		};

		uart0: serial@44e09000 {
			compatible = "vendor,uart", "ns16550a";
			reg = &lt;0x44e09000 0x1000&gt;;
			interrupt-parent = &lt;&amp;intc&gt;;
			interrupts = &lt;0 72 4&gt;;
			clocks = &lt;&amp;sysclk&gt;;
			clock-names = "uart";
			status = "okay";
		};

		i2c0: i2c@44e0b000 {
			compatible = "vendor,i2c";
			reg = &lt;0x44e0b000 0x1000&gt;;
			interrupts = &lt;0 70 4&gt;;
			#address-cells = &lt;1&gt;;
			#size-cells = &lt;0&gt;;
			clocks = &lt;&amp;sysclk&gt;;
			status = "okay";

			/* I2C device */
			eeprom@50 {
				compatible = "atmel,24c256";
				reg = &lt;0x50&gt;;
				pagesize = &lt;64&gt;;
			};
		};

		gpio0: gpio@44e07000 {
			compatible = "vendor,gpio";
			reg = &lt;0x44e07000 0x1000&gt;;
			interrupts = &lt;0 96 4&gt;;
			gpio-controller;
			#gpio-cells = &lt;2&gt;;
			interrupt-controller;
			#interrupt-cells = &lt;2&gt;;
		};

		mmc0: mmc@48060000 {
			compatible = "vendor,mmc";
			reg = &lt;0x48060000 0x1000&gt;;
			interrupts = &lt;0 64 4&gt;;
			bus-width = &lt;4&gt;;
			cd-gpios = &lt;&amp;gpio0 6 0&gt;;
			status = "okay";
		};
	};

	leds {
		compatible = "gpio-leds";

		led0 {
			label = "board:green:user0";
			gpios = &lt;&amp;gpio0 21 0&gt;;
			linux,default-trigger = "heartbeat";
		};

		led1 {
			label = "board:green:user1";
			gpios = &lt;&amp;gpio0 22 0&gt;;
			default-state = "off";
		};
	};

	regulators {
		compatible = "simple-bus";

		vdd_3v3: regulator@0 {
			compatible = "regulator-fixed";
			regulator-name = "vdd_3v3";
			regulator-min-microvolt = &lt;3300000&gt;;
			regulator-max-microvolt = &lt;3300000&gt;;
			regulator-always-on;
		};
	};
};
</code></pre>
<hr />
<h2 id="standard-properties"><a class="header" href="#standard-properties">Standard Properties</a></h2>
<h3 id="compatible-property"><a class="header" href="#compatible-property">Compatible Property</a></h3>
<p>The <code>compatible</code> property is the most important - it binds the node to a driver:</p>
<pre><code class="language-dts">uart0: serial@44e09000 {
	/* Most specific first, generic last */
	compatible = "vendor,soc-uart", "vendor,uart", "ns16550a";
	...
};
</code></pre>
<p><strong>Driver matching:</strong></p>
<pre><code class="language-c">static const struct of_device_id uart_of_match[] = {
	{ .compatible = "vendor,soc-uart", .data = &amp;soc_uart_data },
	{ .compatible = "vendor,uart", .data = &amp;generic_uart_data },
	{ .compatible = "ns16550a", .data = &amp;ns16550_data },
	{ }
};
MODULE_DEVICE_TABLE(of, uart_of_match);
</code></pre>
<h3 id="reg-property"><a class="header" href="#reg-property">Reg Property</a></h3>
<p>Specifies address ranges (MMIO, I2C address, SPI chip select):</p>
<pre><code class="language-dts">/* MMIO register range */
uart0: serial@44e09000 {
	reg = &lt;0x44e09000 0x1000&gt;;  /* Base address, size */
};

/* Multiple ranges */
intc: interrupt-controller@48200000 {
	reg = &lt;0x48200000 0x1000&gt;,   /* Distributor */
	      &lt;0x48210000 0x2000&gt;;   /* CPU interface */
};

/* I2C device */
eeprom@50 {
	reg = &lt;0x50&gt;;  /* I2C address */
};

/* SPI device */
flash@0 {
	reg = &lt;0&gt;;  /* Chip select 0 */
};
</code></pre>
<h3 id="status-property"><a class="header" href="#status-property">Status Property</a></h3>
<p>Enables or disables devices:</p>
<pre><code class="language-dts">uart0: serial@44e09000 {
	status = "okay";     /* Enable */
};

uart1: serial@44e0a000 {
	status = "disabled"; /* Disable */
};

uart2: serial@44e0b000 {
	status = "fail";     /* Error detected */
};
</code></pre>
<h3 id="interrupt-properties"><a class="header" href="#interrupt-properties">Interrupt Properties</a></h3>
<pre><code class="language-dts">uart0: serial@44e09000 {
	/* Parent interrupt controller */
	interrupt-parent = &lt;&amp;intc&gt;;

	/* Interrupt specifier (format defined by parent) */
	/* For GIC: &lt;type number flags&gt; */
	interrupts = &lt;0 72 4&gt;;  /* SPI, IRQ 72, level-high */
};

/* Shared interrupt */
device@0 {
	interrupts = &lt;0 50 4&gt;;
	interrupt-names = "tx", "rx", "error";
};
</code></pre>
<h3 id="clock-properties"><a class="header" href="#clock-properties">Clock Properties</a></h3>
<pre><code class="language-dts">uart0: serial@44e09000 {
	clocks = &lt;&amp;sysclk&gt;, &lt;&amp;pclk&gt;;
	clock-names = "uart", "apb_pclk";
};

/* Clock frequency for fixed clocks */
osc: oscillator {
	compatible = "fixed-clock";
	#clock-cells = &lt;0&gt;;
	clock-frequency = &lt;24000000&gt;;
};
</code></pre>
<h3 id="gpio-properties"><a class="header" href="#gpio-properties">GPIO Properties</a></h3>
<pre><code class="language-dts">device {
	/* GPIO specifier: &lt;&amp;controller pin flags&gt; */
	reset-gpios = &lt;&amp;gpio0 15 GPIO_ACTIVE_LOW&gt;;
	enable-gpios = &lt;&amp;gpio0 16 GPIO_ACTIVE_HIGH&gt;;
};

#include &lt;dt-bindings/gpio/gpio.h&gt;
/* GPIO_ACTIVE_LOW, GPIO_ACTIVE_HIGH */
</code></pre>
<h3 id="dma-properties"><a class="header" href="#dma-properties">DMA Properties</a></h3>
<pre><code class="language-dts">uart0: serial@44e09000 {
	dmas = &lt;&amp;dma 25&gt;, &lt;&amp;dma 26&gt;;
	dma-names = "tx", "rx";
};
</code></pre>
<hr />
<h2 id="writing-device-tree-files"><a class="header" href="#writing-device-tree-files">Writing Device Tree Files</a></h2>
<h3 id="device-tree-source-dts"><a class="header" href="#device-tree-source-dts">Device Tree Source (.dts)</a></h3>
<p>Board-specific file:</p>
<pre><code class="language-dts">/dts-v1/;

#include "vendor-soc.dtsi"

/ {
	model = "Vendor Board XYZ";
	compatible = "vendor,board-xyz", "vendor,soc";

	memory@80000000 {
		device_type = "memory";
		reg = &lt;0x80000000 0x40000000&gt;;
	};
};

/* Enable and configure UART0 */
&amp;uart0 {
	status = "okay";
	pinctrl-names = "default";
	pinctrl-0 = &lt;&amp;uart0_pins&gt;;
};

/* Disable UART1 (not used on this board) */
&amp;uart1 {
	status = "disabled";
};

/* Add I2C devices */
&amp;i2c0 {
	status = "okay";
	clock-frequency = &lt;400000&gt;;

	/* Board-specific I2C device */
	rtc@68 {
		compatible = "dallas,ds1307";
		reg = &lt;0x68&gt;;
	};
};
</code></pre>
<h3 id="device-tree-include-dtsi"><a class="header" href="#device-tree-include-dtsi">Device Tree Include (.dtsi)</a></h3>
<p>SoC-level common definitions:</p>
<pre><code class="language-dts">/* vendor-soc.dtsi */
/ {
	#address-cells = &lt;1&gt;;
	#size-cells = &lt;1&gt;;

	cpus {
		#address-cells = &lt;1&gt;;
		#size-cells = &lt;0&gt;;

		cpu@0 {
			compatible = "arm,cortex-a8";
			device_type = "cpu";
			reg = &lt;0&gt;;
		};
	};

	soc {
		compatible = "simple-bus";
		#address-cells = &lt;1&gt;;
		#size-cells = &lt;1&gt;;
		ranges;

		uart0: serial@44e09000 {
			compatible = "vendor,uart";
			reg = &lt;0x44e09000 0x1000&gt;;
			interrupts = &lt;0 72 4&gt;;
			clocks = &lt;&amp;sysclk&gt;;
			status = "disabled";  /* Disabled by default */
		};

		uart1: serial@44e0a000 {
			compatible = "vendor,uart";
			reg = &lt;0x44e0a000 0x1000&gt;;
			interrupts = &lt;0 73 4&gt;;
			clocks = &lt;&amp;sysclk&gt;;
			status = "disabled";
		};

		i2c0: i2c@44e0b000 {
			compatible = "vendor,i2c";
			reg = &lt;0x44e0b000 0x1000&gt;;
			interrupts = &lt;0 70 4&gt;;
			#address-cells = &lt;1&gt;;
			#size-cells = &lt;0&gt;;
			clocks = &lt;&amp;sysclk&gt;;
			status = "disabled";
		};
	};
};
</code></pre>
<h3 id="overriding-and-extending-nodes"><a class="header" href="#overriding-and-extending-nodes">Overriding and Extending Nodes</a></h3>
<pre><code class="language-dts">/* Base definition in .dtsi */
&amp;uart0 {
	compatible = "vendor,uart";
	reg = &lt;0x44e09000 0x1000&gt;;
	status = "disabled";
};

/* Board-specific .dts */
&amp;uart0 {
	status = "okay";
	pinctrl-names = "default";
	pinctrl-0 = &lt;&amp;uart0_pins&gt;;
	/* Adds new properties while keeping existing ones */
};
</code></pre>
<h3 id="deleting-nodesproperties"><a class="header" href="#deleting-nodesproperties">Deleting Nodes/Properties</a></h3>
<pre><code class="language-dts">/* Delete property */
&amp;uart0 {
	/delete-property/ dmas;
	/delete-property/ dma-names;
};

/* Delete node */
&amp;uart1 {
	/delete-node/ device@0;
};
</code></pre>
<hr />
<h2 id="device-tree-compiler"><a class="header" href="#device-tree-compiler">Device Tree Compiler</a></h2>
<h3 id="compiling-device-tree"><a class="header" href="#compiling-device-tree">Compiling Device Tree</a></h3>
<pre><code class="language-bash"># Compile .dts to .dtb
dtc -I dts -O dtb -o board.dtb board.dts

# With includes
dtc -I dts -O dtb -o board.dtb -i include_path board.dts

# Using C preprocessor
cpp -nostdinc -I include_path -undef -x assembler-with-cpp \
    board.dts board.preprocessed.dts
dtc -I dts -O dtb -o board.dtb board.preprocessed.dts
</code></pre>
<h3 id="decompiling-device-tree"><a class="header" href="#decompiling-device-tree">Decompiling Device Tree</a></h3>
<pre><code class="language-bash"># Decompile .dtb to .dts
dtc -I dtb -O dts -o board.dts board.dtb

# With symbols for overlays
dtc -I dtb -O dts -o board.dts board.dtb -@
</code></pre>
<h3 id="building-with-kernel"><a class="header" href="#building-with-kernel">Building with Kernel</a></h3>
<pre><code class="language-makefile"># In kernel Makefile
dtb-$(CONFIG_BOARD_XYZ) += board-xyz.dtb

# Build
make dtbs

# Output in: arch/arm/boot/dts/board-xyz.dtb
</code></pre>
<h3 id="validation"><a class="header" href="#validation">Validation</a></h3>
<pre><code class="language-bash"># Check syntax
dtc -I dts -O dtb -o /dev/null board.dts

# Validate against schema (Linux 5.4+)
make dt_binding_check
make dtbs_check
</code></pre>
<hr />
<h2 id="parsing-device-tree-in-drivers"><a class="header" href="#parsing-device-tree-in-drivers">Parsing Device Tree in Drivers</a></h2>
<h3 id="getting-device-tree-node"><a class="header" href="#getting-device-tree-node">Getting Device Tree Node</a></h3>
<pre><code class="language-c">#include &lt;linux/of.h&gt;
#include &lt;linux/of_device.h&gt;

static int my_probe(struct platform_device *pdev)
{
	struct device *dev = &amp;pdev-&gt;dev;
	struct device_node *np = dev-&gt;of_node;

	if (!np) {
		dev_err(dev, "No device tree node\n");
		return -ENODEV;
	}

	/* Node is available */
	return 0;
}
</code></pre>
<h3 id="reading-properties"><a class="header" href="#reading-properties">Reading Properties</a></h3>
<pre><code class="language-c">/* Read string */
const char *model;
if (of_property_read_string(np, "model", &amp;model) == 0) {
	pr_info("Model: %s\n", model);
}

/* Read u32 */
u32 clock_freq;
if (of_property_read_u32(np, "clock-frequency", &amp;clock_freq) == 0) {
	pr_info("Clock: %u Hz\n", clock_freq);
}

/* Read u32 array */
u32 values[3];
int count = of_property_read_u32_array(np, "interrupts", values, 3);

/* Read u64 */
u64 reg_base;
of_property_read_u64(np, "reg", &amp;reg_base);

/* Check if property exists */
if (of_property_read_bool(np, "dma-coherent")) {
	pr_info("DMA coherent enabled\n");
}
</code></pre>
<h3 id="getting-resources"><a class="header" href="#getting-resources">Getting Resources</a></h3>
<pre><code class="language-c">/* Get memory resource */
struct resource *res;
res = platform_get_resource(pdev, IORESOURCE_MEM, 0);
if (!res)
	return -ENODEV;

void __iomem *base = devm_ioremap_resource(dev, res);
if (IS_ERR(base))
	return PTR_ERR(base);

/* Get IRQ */
int irq = platform_get_irq(pdev, 0);
if (irq &lt; 0)
	return irq;

/* Get register address/size directly */
u64 addr, size;
of_property_read_u64_index(np, "reg", 0, &amp;addr);
of_property_read_u64_index(np, "reg", 1, &amp;size);
</code></pre>
<h3 id="parsing-phandles"><a class="header" href="#parsing-phandles">Parsing Phandles</a></h3>
<pre><code class="language-c">/* Get referenced node */
struct device_node *clk_np;
clk_np = of_parse_phandle(np, "clocks", 0);
if (!clk_np) {
	dev_err(dev, "No clock specified\n");
	return -EINVAL;
}

/* Get clock */
struct clk *clk = of_clk_get(np, 0);
if (IS_ERR(clk))
	return PTR_ERR(clk);

/* Or by name */
clk = of_clk_get_by_name(np, "uart");
</code></pre>
<h3 id="gpio-handling"><a class="header" href="#gpio-handling">GPIO Handling</a></h3>
<pre><code class="language-c">#include &lt;linux/of_gpio.h&gt;

/* Get GPIO */
int reset_gpio = of_get_named_gpio(np, "reset-gpios", 0);
if (!gpio_is_valid(reset_gpio))
	return -EINVAL;

/* Request and configure */
devm_gpio_request_one(dev, reset_gpio, GPIOF_OUT_INIT_LOW, "reset");

/* Using GPIO descriptor API (preferred) */
#include &lt;linux/gpio/consumer.h&gt;

struct gpio_desc *reset_gpiod;
reset_gpiod = devm_gpiod_get(dev, "reset", GPIOD_OUT_LOW);
if (IS_ERR(reset_gpiod))
	return PTR_ERR(reset_gpiod);

gpiod_set_value(reset_gpiod, 1);
</code></pre>
<h3 id="iterating-child-nodes"><a class="header" href="#iterating-child-nodes">Iterating Child Nodes</a></h3>
<pre><code class="language-c">struct device_node *child;

for_each_child_of_node(np, child) {
	const char *name;
	u32 reg;

	of_property_read_string(child, "label", &amp;name);
	of_property_read_u32(child, "reg", &amp;reg);

	pr_info("Child: %s at 0x%x\n", name, reg);
}
</code></pre>
<h3 id="complete-driver-example"><a class="header" href="#complete-driver-example">Complete Driver Example</a></h3>
<pre><code class="language-c">#include &lt;linux/module.h&gt;
#include &lt;linux/platform_device.h&gt;
#include &lt;linux/of.h&gt;
#include &lt;linux/of_device.h&gt;
#include &lt;linux/clk.h&gt;
#include &lt;linux/gpio/consumer.h&gt;

struct my_device {
	void __iomem *base;
	struct clk *clk;
	int irq;
	struct gpio_desc *reset_gpio;
	u32 clock_freq;
};

static int my_probe(struct platform_device *pdev)
{
	struct device *dev = &amp;pdev-&gt;dev;
	struct device_node *np = dev-&gt;of_node;
	struct my_device *priv;
	struct resource *res;
	int ret;

	priv = devm_kzalloc(dev, sizeof(*priv), GFP_KERNEL);
	if (!priv)
		return -ENOMEM;

	/* Get memory resource */
	res = platform_get_resource(pdev, IORESOURCE_MEM, 0);
	priv-&gt;base = devm_ioremap_resource(dev, res);
	if (IS_ERR(priv-&gt;base))
		return PTR_ERR(priv-&gt;base);

	/* Get IRQ */
	priv-&gt;irq = platform_get_irq(pdev, 0);
	if (priv-&gt;irq &lt; 0)
		return priv-&gt;irq;

	/* Get clock */
	priv-&gt;clk = devm_clk_get(dev, "uart");
	if (IS_ERR(priv-&gt;clk)) {
		dev_err(dev, "Failed to get clock\n");
		return PTR_ERR(priv-&gt;clk);
	}

	/* Get GPIO */
	priv-&gt;reset_gpio = devm_gpiod_get_optional(dev, "reset", GPIOD_OUT_LOW);
	if (IS_ERR(priv-&gt;reset_gpio))
		return PTR_ERR(priv-&gt;reset_gpio);

	/* Read clock frequency */
	ret = of_property_read_u32(np, "clock-frequency", &amp;priv-&gt;clock_freq);
	if (ret) {
		/* Use default if not specified */
		priv-&gt;clock_freq = 48000000;
	}

	/* Enable clock */
	ret = clk_prepare_enable(priv-&gt;clk);
	if (ret)
		return ret;

	/* Reset device */
	if (priv-&gt;reset_gpio) {
		gpiod_set_value(priv-&gt;reset_gpio, 1);
		msleep(10);
		gpiod_set_value(priv-&gt;reset_gpio, 0);
	}

	platform_set_drvdata(pdev, priv);

	dev_info(dev, "Device initialized (clock=%u Hz)\n", priv-&gt;clock_freq);
	return 0;
}

static int my_remove(struct platform_device *pdev)
{
	struct my_device *priv = platform_get_drvdata(pdev);

	clk_disable_unprepare(priv-&gt;clk);
	return 0;
}

static const struct of_device_id my_of_match[] = {
	{ .compatible = "vendor,my-device" },
	{ }
};
MODULE_DEVICE_TABLE(of, my_of_match);

static struct platform_driver my_driver = {
	.probe = my_probe,
	.remove = my_remove,
	.driver = {
		.name = "my-device",
		.of_match_table = my_of_match,
	},
};
module_platform_driver(my_driver);

MODULE_LICENSE("GPL");
MODULE_AUTHOR("Your Name");
MODULE_DESCRIPTION("Device Tree Example Driver");
</code></pre>
<p><strong>Device Tree:</strong></p>
<pre><code class="language-dts">my_device: device@44e09000 {
	compatible = "vendor,my-device";
	reg = &lt;0x44e09000 0x1000&gt;;
	interrupts = &lt;0 72 4&gt;;
	clocks = &lt;&amp;sysclk&gt;;
	clock-names = "uart";
	reset-gpios = &lt;&amp;gpio0 15 GPIO_ACTIVE_LOW&gt;;
	clock-frequency = &lt;48000000&gt;;
};
</code></pre>
<hr />
<h2 id="common-bindings"><a class="header" href="#common-bindings">Common Bindings</a></h2>
<h3 id="i2c-devices"><a class="header" href="#i2c-devices">I2C Devices</a></h3>
<pre><code class="language-dts">&amp;i2c0 {
	#address-cells = &lt;1&gt;;
	#size-cells = &lt;0&gt;;

	eeprom@50 {
		compatible = "atmel,24c256";
		reg = &lt;0x50&gt;;
		pagesize = &lt;64&gt;;
	};

	rtc@68 {
		compatible = "dallas,ds1307";
		reg = &lt;0x68&gt;;
		interrupts = &lt;0 75 IRQ_TYPE_EDGE_FALLING&gt;;
	};
};
</code></pre>
<h3 id="spi-devices"><a class="header" href="#spi-devices">SPI Devices</a></h3>
<pre><code class="language-dts">&amp;spi0 {
	#address-cells = &lt;1&gt;;
	#size-cells = &lt;0&gt;;

	flash@0 {
		compatible = "jedec,spi-nor";
		reg = &lt;0&gt;;  /* Chip select 0 */
		spi-max-frequency = &lt;20000000&gt;;

		partitions {
			compatible = "fixed-partitions";
			#address-cells = &lt;1&gt;;
			#size-cells = &lt;1&gt;;

			partition@0 {
				label = "bootloader";
				reg = &lt;0x000000 0x100000&gt;;
				read-only;
			};

			partition@100000 {
				label = "kernel";
				reg = &lt;0x100000 0x400000&gt;;
			};

			partition@500000 {
				label = "rootfs";
				reg = &lt;0x500000 0xb00000&gt;;
			};
		};
	};
};
</code></pre>
<h3 id="regulators"><a class="header" href="#regulators">Regulators</a></h3>
<pre><code class="language-dts">regulators {
	compatible = "simple-bus";
	#address-cells = &lt;1&gt;;
	#size-cells = &lt;0&gt;;

	vdd_core: regulator@0 {
		compatible = "regulator-fixed";
		reg = &lt;0&gt;;
		regulator-name = "vdd_core";
		regulator-min-microvolt = &lt;1200000&gt;;
		regulator-max-microvolt = &lt;1200000&gt;;
		regulator-always-on;
		regulator-boot-on;
	};

	vdd_3v3: regulator@1 {
		compatible = "regulator-gpio";
		reg = &lt;1&gt;;
		regulator-name = "vdd_3v3";
		regulator-min-microvolt = &lt;3300000&gt;;
		regulator-max-microvolt = &lt;3300000&gt;;
		enable-gpio = &lt;&amp;gpio0 20 GPIO_ACTIVE_HIGH&gt;;
		enable-active-high;
	};
};

/* Usage */
&amp;uart0 {
	vdd-supply = &lt;&amp;vdd_3v3&gt;;
};
</code></pre>
<h3 id="pinctrl-pin-multiplexing"><a class="header" href="#pinctrl-pin-multiplexing">Pinctrl (Pin Multiplexing)</a></h3>
<pre><code class="language-dts">pinctrl: pinctrl@44e10800 {
	compatible = "vendor,pinctrl";
	reg = &lt;0x44e10800 0x1000&gt;;

	uart0_pins: uart0_pins {
		pinctrl-single,pins = &lt;
			0x170 (PIN_INPUT_PULLUP | MUX_MODE0)  /* uart0_rxd */
			0x174 (PIN_OUTPUT_PULLDOWN | MUX_MODE0) /* uart0_txd */
		&gt;;
	};

	i2c0_pins: i2c0_pins {
		pinctrl-single,pins = &lt;
			0x188 (PIN_INPUT_PULLUP | MUX_MODE0)   /* i2c0_sda */
			0x18c (PIN_INPUT_PULLUP | MUX_MODE0)   /* i2c0_scl */
		&gt;;
	};
};

&amp;uart0 {
	pinctrl-names = "default";
	pinctrl-0 = &lt;&amp;uart0_pins&gt;;
};

&amp;i2c0 {
	pinctrl-names = "default";
	pinctrl-0 = &lt;&amp;i2c0_pins&gt;;
};
</code></pre>
<hr />
<h2 id="platform-specific-details"><a class="header" href="#platform-specific-details">Platform-Specific Details</a></h2>
<h3 id="arm-device-tree"><a class="header" href="#arm-device-tree">ARM Device Tree</a></h3>
<pre><code class="language-dts">/dts-v1/;

/ {
	model = "ARM Versatile Express";
	compatible = "arm,vexpress";

	#address-cells = &lt;1&gt;;
	#size-cells = &lt;1&gt;;

	cpus {
		#address-cells = &lt;1&gt;;
		#size-cells = &lt;0&gt;;

		cpu@0 {
			device_type = "cpu";
			compatible = "arm,cortex-a9";
			reg = &lt;0&gt;;
		};

		cpu@1 {
			device_type = "cpu";
			compatible = "arm,cortex-a9";
			reg = &lt;1&gt;;
		};
	};
};
</code></pre>
<h3 id="arm64-device-tree"><a class="header" href="#arm64-device-tree">ARM64 Device Tree</a></h3>
<pre><code class="language-dts">/dts-v1/;

/ {
	#address-cells = &lt;2&gt;;  /* 64-bit addressing */
	#size-cells = &lt;2&gt;;

	cpus {
		#address-cells = &lt;1&gt;;
		#size-cells = &lt;0&gt;;

		cpu@0 {
			device_type = "cpu";
			compatible = "arm,cortex-a57";
			reg = &lt;0x0&gt;;
			enable-method = "psci";
		};
	};

	memory@80000000 {
		device_type = "memory";
		reg = &lt;0x0 0x80000000 0x0 0x80000000&gt;; /* 2GB */
	};
};
</code></pre>
<h3 id="raspberry-pi-example"><a class="header" href="#raspberry-pi-example">Raspberry Pi Example</a></h3>
<pre><code class="language-dts">/dts-v1/;

#include "bcm2835.dtsi"

/ {
	compatible = "raspberrypi,model-b", "brcm,bcm2835";
	model = "Raspberry Pi Model B";

	memory@0 {
		device_type = "memory";
		reg = &lt;0 0x20000000&gt;; /* 512 MB */
	};
};

&amp;uart0 {
	status = "okay";
};

&amp;i2c1 {
	status = "okay";
	clock-frequency = &lt;100000&gt;;
};

&amp;sdhci {
	status = "okay";
	bus-width = &lt;4&gt;;
};
</code></pre>
<hr />
<h2 id="debugging-device-tree"><a class="header" href="#debugging-device-tree">Debugging Device Tree</a></h2>
<h3 id="viewing-loaded-device-tree"><a class="header" href="#viewing-loaded-device-tree">Viewing Loaded Device Tree</a></h3>
<pre><code class="language-bash"># View device tree in /proc
cat /proc/device-tree/model

# Or using dtc
dtc -I fs -O dts /proc/device-tree

# Better formatting
dtc -I fs -O dts -o /tmp/current.dts /proc/device-tree
</code></pre>
<h3 id="sysfs-device-tree"><a class="header" href="#sysfs-device-tree">Sysfs Device Tree</a></h3>
<pre><code class="language-bash"># Navigate device tree in sysfs
ls /sys/firmware/devicetree/base/

# View property
cat /sys/firmware/devicetree/base/model

# View all properties of a node
ls -la /sys/firmware/devicetree/base/soc/serial@44e09000/
</code></pre>
<h3 id="kernel-boot-messages"><a class="header" href="#kernel-boot-messages">Kernel Boot Messages</a></h3>
<pre><code class="language-bash"># Check device tree loading
dmesg | grep -i "device tree"
dmesg | grep -i "dtb"

# Check OF (Open Firmware) messages
dmesg | grep -i "of:"
</code></pre>
<h3 id="driver-matching-debug"><a class="header" href="#driver-matching-debug">Driver Matching Debug</a></h3>
<pre><code class="language-c">/* In driver code */
static int my_probe(struct platform_device *pdev)
{
	struct device *dev = &amp;pdev-&gt;dev;
	struct device_node *np = dev-&gt;of_node;

	dev_info(dev, "Device tree node: %pOF\n", np);
	dev_info(dev, "Compatible: %s\n",
		 of_get_property(np, "compatible", NULL));

	/* Print all properties */
	struct property *prop;
	for_each_property_of_node(np, prop) {
		dev_info(dev, "Property: %s\n", prop-&gt;name);
	}

	return 0;
}
</code></pre>
<h3 id="common-issues-1"><a class="header" href="#common-issues-1">Common Issues</a></h3>
<p><strong>Device not probing:</strong></p>
<pre><code class="language-bash"># Check if device is in device tree
ls /sys/firmware/devicetree/base/soc/

# Check driver registration
ls /sys/bus/platform/drivers/

# Check devices without driver
cat /sys/kernel/debug/devices_deferred
</code></pre>
<p><strong>Compatible string mismatch:</strong></p>
<pre><code class="language-c">/* Check driver's compatible strings */
static const struct of_device_id my_of_match[] = {
	{ .compatible = "vendor,device-v2" },  /* Try this first */
	{ .compatible = "vendor,device" },      /* Then this */
	{ }
};
</code></pre>
<hr />
<h2 id="best-practices-17"><a class="header" href="#best-practices-17">Best Practices</a></h2>
<h3 id="dos"><a class="header" href="#dos">DO's</a></h3>
<ol>
<li><strong>Use specific compatible strings first:</strong></li>
</ol>
<pre><code class="language-dts">compatible = "vendor,soc-uart-v2", "vendor,uart", "ns16550a";
</code></pre>
<ol start="2">
<li><strong>Disable devices by default in SoC .dtsi:</strong></li>
</ol>
<pre><code class="language-dts">/* In SoC .dtsi */
uart0: serial@44e09000 {
	status = "disabled";
};

/* In board .dts */
&amp;uart0 {
	status = "okay";
};
</code></pre>
<ol start="3">
<li><strong>Use labels for references:</strong></li>
</ol>
<pre><code class="language-dts">uart0: serial@44e09000 { ... };

&amp;uart0 {
	/* Override properties */
};
</code></pre>
<ol start="4">
<li><strong>Document bindings:</strong></li>
</ol>
<pre><code class="language-yaml"># Documentation/devicetree/bindings/serial/vendor-uart.yaml
title: Vendor UART Controller

properties:
  compatible:
    const: vendor,uart

  reg:
    maxItems: 1

  interrupts:
    maxItems: 1
</code></pre>
<ol start="5">
<li><strong>Use standard property names:</strong></li>
</ol>
<ul>
<li><code>clock-frequency</code> not <code>clock-freq</code></li>
<li><code>reset-gpios</code> not <code>reset-gpio</code></li>
<li>Follow bindings in <code>Documentation/devicetree/bindings/</code></li>
</ul>
<h3 id="donts"><a class="header" href="#donts">DON'Ts</a></h3>
<ol>
<li><strong>Don't duplicate information:</strong></li>
</ol>
<pre><code class="language-dts">/* Bad - IRQ already specified in interrupts */
uart0 {
	interrupts = &lt;72&gt;;
	irq-number = &lt;72&gt;;  /* Redundant */
};

/* Good */
uart0 {
	interrupts = &lt;72&gt;;
};
</code></pre>
<ol start="2">
<li><strong>Don't use Linux-specific information:</strong></li>
</ol>
<pre><code class="language-dts">/* Bad - driver name is Linux-specific */
uart0 {
	linux,driver-name = "vendor-uart";
};

/* Good - use compatible */
uart0 {
	compatible = "vendor,uart";
};
</code></pre>
<ol start="3">
<li><strong>Don't hardcode board-specific data in drivers:</strong></li>
</ol>
<pre><code class="language-c">/* Bad - hardcoded in driver */
#define UART_BASE 0x44e09000

/* Good - read from device tree */
res = platform_get_resource(pdev, IORESOURCE_MEM, 0);
</code></pre>
<hr />
<h2 id="real-world-examples"><a class="header" href="#real-world-examples">Real-World Examples</a></h2>
<h3 id="beaglebone-black"><a class="header" href="#beaglebone-black">BeagleBone Black</a></h3>
<pre><code class="language-dts">/dts-v1/;

#include "am33xx.dtsi"

/ {
	model = "TI AM335x BeagleBone Black";
	compatible = "ti,am335x-bone-black", "ti,am335x-bone", "ti,am33xx";

	memory@80000000 {
		device_type = "memory";
		reg = &lt;0x80000000 0x20000000&gt;; /* 512 MB */
	};

	leds {
		compatible = "gpio-leds";
		pinctrl-names = "default";
		pinctrl-0 = &lt;&amp;user_leds_s0&gt;;

		led0 {
			label = "beaglebone:green:usr0";
			gpios = &lt;&amp;gpio1 21 GPIO_ACTIVE_HIGH&gt;;
			linux,default-trigger = "heartbeat";
			default-state = "off";
		};
	};
};

&amp;uart0 {
	pinctrl-names = "default";
	pinctrl-0 = &lt;&amp;uart0_pins&gt;;
	status = "okay";
};

&amp;mmc1 {
	vmmc-supply = &lt;&amp;vmmcsd_fixed&gt;;
	bus-width = &lt;4&gt;;
	status = "okay";
};
</code></pre>
<h3 id="raspberry-pi-4"><a class="header" href="#raspberry-pi-4">Raspberry Pi 4</a></h3>
<pre><code class="language-dts">/dts-v1/;

#include "bcm2711.dtsi"

/ {
	compatible = "raspberrypi,4-model-b", "brcm,bcm2711";
	model = "Raspberry Pi 4 Model B";

	memory@0 {
		device_type = "memory";
		reg = &lt;0x0 0x0 0x0 0x80000000&gt;; /* 2GB */
	};

	aliases {
		serial0 = &amp;uart0;
		serial1 = &amp;uart1;
	};
};

&amp;uart0 {
	pinctrl-names = "default";
	pinctrl-0 = &lt;&amp;uart0_gpio14&gt;;
	status = "okay";
};

&amp;i2c1 {
	pinctrl-names = "default";
	pinctrl-0 = &lt;&amp;i2c1_gpio2&gt;;
	clock-frequency = &lt;100000&gt;;
	status = "okay";
};
</code></pre>
<hr />
<h2 id="summary"><a class="header" href="#summary">Summary</a></h2>
<p>Device Tree provides:</p>
<ul>
<li>Hardware description separated from kernel code</li>
<li>Single kernel for multiple boards</li>
<li>Runtime configuration</li>
<li>Standardized hardware description</li>
</ul>
<p><strong>Key points:</strong></p>
<ol>
<li>Use <code>.dts</code> for board-specific, <code>.dtsi</code> for SoC common definitions</li>
<li><code>compatible</code> property binds nodes to drivers</li>
<li>Use standard properties and follow bindings documentation</li>
<li>Parse device tree in drivers using OF APIs</li>
<li>Debug using <code>/proc/device-tree</code> and <code>/sys/firmware/devicetree</code></li>
</ol>
<p><strong>Resources:</strong></p>
<ul>
<li><a href="https://www.devicetree.org/">Device Tree Specification</a></li>
<li><a href="https://www.kernel.org/doc/Documentation/devicetree/">Linux Device Tree Documentation</a></li>
<li><a href="https://www.kernel.org/doc/Documentation/devicetree/bindings/">Device Tree Bindings</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cross-compilation-1"><a class="header" href="#cross-compilation-1">Cross Compilation</a></h1>
<p>A comprehensive guide to cross compilation for Linux - building software on one platform (host) to run on a different platform (target).</p>
<h2 id="table-of-contents-7"><a class="header" href="#table-of-contents-7">Table of Contents</a></h2>
<ul>
<li><a href="linux/cross_compilation.html#overview">Overview</a></li>
<li><a href="linux/cross_compilation.html#why-cross-compilation">Why Cross Compilation?</a></li>
<li><a href="linux/cross_compilation.html#terminology">Terminology</a></li>
<li><a href="linux/cross_compilation.html#toolchain-setup">Toolchain Setup</a></li>
<li><a href="linux/cross_compilation.html#cross-compiling-the-linux-kernel">Cross Compiling the Linux Kernel</a></li>
<li><a href="linux/cross_compilation.html#cross-compiling-user-space-applications">Cross Compiling User Space Applications</a></li>
<li><a href="linux/cross_compilation.html#build-system-support">Build System Support</a></li>
<li><a href="linux/cross_compilation.html#root-filesystem-creation">Root Filesystem Creation</a></li>
<li><a href="linux/cross_compilation.html#debugging-cross-compiled-code">Debugging Cross-Compiled Code</a></li>
<li><a href="linux/cross_compilation.html#common-architectures">Common Architectures</a></li>
<li><a href="linux/cross_compilation.html#troubleshooting">Troubleshooting</a></li>
<li><a href="linux/cross_compilation.html#best-practices">Best Practices</a></li>
</ul>
<hr />
<h2 id="overview-13"><a class="header" href="#overview-13">Overview</a></h2>
<p><strong>Cross Compilation</strong> is the process of building executable code on one system (the <strong>host</strong>) that will run on a different system (the <strong>target</strong>). This is essential for embedded systems development where the target device may have limited resources or a different architecture.</p>
<h3 id="typical-scenario"><a class="header" href="#typical-scenario">Typical Scenario</a></h3>
<pre><code>┌─────────────────────┐         ┌─────────────────────┐
│   Host System       │         │   Target System     │
│   x86_64 Linux      │         │   ARM Cortex-A8     │
│   Development PC    │  ────&gt;  │   Embedded Board    │
│                     │         │                     │
│ - Fast CPU          │         │ - Slow CPU          │
│ - Lots of RAM       │         │ - Limited RAM       │
│ - Large Storage     │         │ - Small Storage     │
└─────────────────────┘         └─────────────────────┘
</code></pre>
<p><strong>Build on host → Deploy to target</strong></p>
<hr />
<h2 id="why-cross-compilation"><a class="header" href="#why-cross-compilation">Why Cross Compilation?</a></h2>
<h3 id="reasons-for-cross-compilation"><a class="header" href="#reasons-for-cross-compilation">Reasons for Cross Compilation</a></h3>
<ol>
<li>
<p><strong>Limited Target Resources</strong></p>
<ul>
<li>Embedded devices lack CPU power, RAM, or storage for compilation</li>
<li>Building natively would take hours or fail due to memory constraints</li>
</ul>
</li>
<li>
<p><strong>Architecture Differences</strong></p>
<ul>
<li>Development machine (x86_64) differs from target (ARM, MIPS, etc.)</li>
<li>Cannot run x86 binaries on ARM without emulation</li>
</ul>
</li>
<li>
<p><strong>Speed</strong></p>
<ul>
<li>Powerful development machine compiles much faster than embedded target</li>
<li>Native compilation on Raspberry Pi: 2 hours → Cross compilation: 10 minutes</li>
</ul>
</li>
<li>
<p><strong>Tooling</strong></p>
<ul>
<li>Better development tools available on host</li>
<li>Easier debugging and profiling setup</li>
</ul>
</li>
<li>
<p><strong>Consistency</strong></p>
<ul>
<li>Reproducible builds across team</li>
<li>Controlled toolchain versions</li>
</ul>
</li>
</ol>
<h3 id="example-raspberry-pi"><a class="header" href="#example-raspberry-pi">Example: Raspberry Pi</a></h3>
<p><strong>Native compilation on Pi 3:</strong></p>
<pre><code class="language-bash"># Building Linux kernel natively
$ time make -j4
real    120m0.000s   # 2 hours!
</code></pre>
<p><strong>Cross compilation on x86_64 PC:</strong></p>
<pre><code class="language-bash"># Cross compiling same kernel
$ time make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- -j8
real    10m0.000s    # 10 minutes!
</code></pre>
<hr />
<h2 id="terminology"><a class="header" href="#terminology">Terminology</a></h2>
<h3 id="key-terms"><a class="header" href="#key-terms">Key Terms</a></h3>
<ul>
<li>
<p><strong>Host</strong>: System where compilation happens (your development PC)</p>
</li>
<li>
<p><strong>Build</strong>: System where build tools run (usually same as host)</p>
</li>
<li>
<p><strong>Target</strong>: System where compiled code will run (embedded device)</p>
</li>
<li>
<p><strong>Toolchain</strong>: Collection of tools for cross compilation</p>
<ul>
<li>Compiler (gcc, clang)</li>
<li>Linker (ld)</li>
<li>Assembler (as)</li>
<li>Libraries (libc, libgcc)</li>
<li>Utilities (objcopy, objdump, strip)</li>
</ul>
</li>
<li>
<p><strong>Triple/Tuple</strong>: Architecture specification format</p>
<ul>
<li>Format: <code>arch-vendor-os-abi</code></li>
<li>Example: <code>arm-linux-gnueabihf</code>
<ul>
<li><code>arm</code>: Architecture (ARM)</li>
<li><code>linux</code>: OS (Linux)</li>
<li><code>gnueabihf</code>: ABI (GNU EABI Hard Float)</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Sysroot</strong>: Target system's root filesystem on host</p>
<ul>
<li>Contains target's headers and libraries</li>
<li>Located on development machine</li>
<li>Mimics target's <code>/usr</code>, <code>/lib</code>, etc.</li>
</ul>
</li>
</ul>
<h3 id="architecture-tuples"><a class="header" href="#architecture-tuples">Architecture Tuples</a></h3>
<pre><code class="language-bash"># Common architecture tuples
arm-linux-gnueabi         # ARM soft-float
arm-linux-gnueabihf       # ARM hard-float
aarch64-linux-gnu         # ARM 64-bit
mips-linux-gnu            # MIPS
mipsel-linux-gnu          # MIPS little-endian
powerpc-linux-gnu         # PowerPC
x86_64-w64-mingw32        # Windows 64-bit
</code></pre>
<hr />
<h2 id="toolchain-setup"><a class="header" href="#toolchain-setup">Toolchain Setup</a></h2>
<h3 id="option-1-pre-built-toolchains"><a class="header" href="#option-1-pre-built-toolchains">Option 1: Pre-built Toolchains</a></h3>
<p><strong>Install from Distribution:</strong></p>
<pre><code class="language-bash"># Ubuntu/Debian - ARM
sudo apt-get install gcc-arm-linux-gnueabihf g++-arm-linux-gnueabihf

# ARM64
sudo apt-get install gcc-aarch64-linux-gnu g++-aarch64-linux-gnu

# MIPS
sudo apt-get install gcc-mips-linux-gnu g++-mips-linux-gnu

# Verify installation
arm-linux-gnueabihf-gcc --version
</code></pre>
<p><strong>Linaro Toolchains:</strong></p>
<pre><code class="language-bash"># Download from Linaro
wget https://releases.linaro.org/components/toolchain/binaries/latest-7/arm-linux-gnueabihf/gcc-linaro-7.5.0-2019.12-x86_64_arm-linux-gnueabihf.tar.xz

# Extract
tar xf gcc-linaro-7.5.0-2019.12-x86_64_arm-linux-gnueabihf.tar.xz

# Add to PATH
export PATH=$PATH:$(pwd)/gcc-linaro-7.5.0-2019.12-x86_64_arm-linux-gnueabihf/bin

# Test
arm-linux-gnueabihf-gcc --version
</code></pre>
<h3 id="option-2-crosstool-ng"><a class="header" href="#option-2-crosstool-ng">Option 2: Crosstool-NG</a></h3>
<p>Build custom toolchains:</p>
<pre><code class="language-bash"># Install crosstool-NG
git clone https://github.com/crosstool-ng/crosstool-ng
cd crosstool-ng
./bootstrap
./configure --prefix=/opt/crosstool-ng
make
sudo make install

# Add to PATH
export PATH=/opt/crosstool-ng/bin:$PATH

# Configure and build
ct-ng list-samples
ct-ng arm-unknown-linux-gnueabi
ct-ng menuconfig  # Configure as needed
ct-ng build

# Toolchain installed in ~/x-tools/arm-unknown-linux-gnueabi/
</code></pre>
<h3 id="option-3-buildroot"><a class="header" href="#option-3-buildroot">Option 3: Buildroot</a></h3>
<p>Creates complete embedded Linux system including toolchain:</p>
<pre><code class="language-bash"># Download Buildroot
wget https://buildroot.org/downloads/buildroot-2023.02.tar.gz
tar xf buildroot-2023.02.tar.gz
cd buildroot-2023.02

# Configure
make menuconfig
# Target options -&gt; Target Architecture -&gt; ARM
# Toolchain -&gt; Build toolchain

# Build
make

# Toolchain in output/host/usr/bin/
export PATH=$PATH:$(pwd)/output/host/usr/bin
</code></pre>
<h3 id="setting-up-environment"><a class="header" href="#setting-up-environment">Setting Up Environment</a></h3>
<p><strong>Permanent setup:</strong></p>
<pre><code class="language-bash"># Add to ~/.bashrc or ~/.zshrc
export CROSS_COMPILE=arm-linux-gnueabihf-
export ARCH=arm
export PATH=$PATH:/path/to/toolchain/bin

# Apply
source ~/.bashrc
</code></pre>
<p><strong>Project-specific:</strong></p>
<pre><code class="language-bash"># Create toolchain.env
cat &gt; toolchain.env &lt;&lt; 'EOF'
export CROSS_COMPILE=arm-linux-gnueabihf-
export ARCH=arm
export PATH=/opt/arm-toolchain/bin:$PATH
export SYSROOT=/opt/arm-sysroot
EOF

# Source when needed
source toolchain.env
</code></pre>
<h3 id="verifying-toolchain"><a class="header" href="#verifying-toolchain">Verifying Toolchain</a></h3>
<pre><code class="language-bash"># Check compiler
${CROSS_COMPILE}gcc --version
${CROSS_COMPILE}gcc -v

# Check target
${CROSS_COMPILE}gcc -dumpmachine
# Output: arm-linux-gnueabihf

# List all tools
ls -la $(dirname $(which ${CROSS_COMPILE}gcc))/${CROSS_COMPILE}*
</code></pre>
<hr />
<h2 id="cross-compiling-the-linux-kernel"><a class="header" href="#cross-compiling-the-linux-kernel">Cross Compiling the Linux Kernel</a></h2>
<h3 id="basic-kernel-cross-compilation"><a class="header" href="#basic-kernel-cross-compilation">Basic Kernel Cross Compilation</a></h3>
<pre><code class="language-bash"># Get kernel source
git clone https://github.com/torvalds/linux.git
cd linux

# Clean
make mrproper

# Configure for ARM (example: Versatile Express)
make ARCH=arm vexpress_defconfig

# Or use menuconfig
make ARCH=arm menuconfig

# Build
make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- -j$(nproc)

# Build specific targets
make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- zImage
make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- modules
make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- dtbs

# Install modules to staging directory
make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- \
     INSTALL_MOD_PATH=/path/to/rootfs modules_install
</code></pre>
<h3 id="raspberry-pi-kernel"><a class="header" href="#raspberry-pi-kernel">Raspberry Pi Kernel</a></h3>
<pre><code class="language-bash"># Clone Raspberry Pi kernel
git clone --depth=1 https://github.com/raspberrypi/linux
cd linux

# Pi 1, Zero, Zero W (32-bit)
make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- bcmrpi_defconfig

# Pi 2, 3, 4 (32-bit)
make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- bcm2709_defconfig

# Pi 3, 4 (64-bit)
make ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu- bcm2711_defconfig

# Build
make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- zImage modules dtbs -j$(nproc)

# Install to SD card
export ROOTFS=/mnt/ext4
export BOOTFS=/mnt/fat32

# Install modules
sudo make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- \
     INSTALL_MOD_PATH=$ROOTFS modules_install

# Install kernel
sudo cp arch/arm/boot/zImage $BOOTFS/kernel7.img
sudo cp arch/arm/boot/dts/*.dtb $BOOTFS/
sudo cp arch/arm/boot/dts/overlays/*.dtb* $BOOTFS/overlays/
</code></pre>
<h3 id="beaglebone-black-kernel"><a class="header" href="#beaglebone-black-kernel">BeagleBone Black Kernel</a></h3>
<pre><code class="language-bash"># Clone kernel
git clone https://github.com/beagleboard/linux.git
cd linux

# Checkout stable branch
git checkout 5.10

# Configure
make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- bb.org_defconfig

# Build
make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- zImage modules dtbs -j$(nproc)

# Create uImage (U-Boot format)
make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- uImage \
     LOADADDR=0x80008000

# Install
sudo cp arch/arm/boot/uImage /media/$USER/BOOT/
sudo cp arch/arm/boot/dts/am335x-boneblack.dtb /media/$USER/BOOT/
sudo make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- \
     INSTALL_MOD_PATH=/media/$USER/rootfs modules_install
</code></pre>
<h3 id="kernel-configuration-tips"><a class="header" href="#kernel-configuration-tips">Kernel Configuration Tips</a></h3>
<pre><code class="language-bash"># Use existing config from target
scp user@target:/proc/config.gz .
zcat config.gz &gt; .config
make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- oldconfig

# Save custom config
make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- savedefconfig
cp defconfig arch/arm/configs/myboard_defconfig

# Enable specific features
./scripts/config --enable CONFIG_FEATURE_NAME
./scripts/config --disable CONFIG_FEATURE_NAME
./scripts/config --module CONFIG_FEATURE_NAME
</code></pre>
<hr />
<h2 id="cross-compiling-user-space-applications"><a class="header" href="#cross-compiling-user-space-applications">Cross Compiling User Space Applications</a></h2>
<h3 id="simple-c-program"><a class="header" href="#simple-c-program">Simple C Program</a></h3>
<pre><code class="language-c">/* hello.c */
#include &lt;stdio.h&gt;

int main(void)
{
	printf("Hello from %s!\n",
#ifdef __arm__
		"ARM"
#elif __aarch64__
		"ARM64"
#elif __mips__
		"MIPS"
#else
		"unknown"
#endif
	);
	return 0;
}
</code></pre>
<p><strong>Compile:</strong></p>
<pre><code class="language-bash"># Cross compile
arm-linux-gnueabihf-gcc hello.c -o hello

# Check architecture
file hello
# hello: ELF 32-bit LSB executable, ARM, version 1 (SYSV)

# Check dynamic libraries
arm-linux-gnueabihf-readelf -d hello | grep NEEDED
</code></pre>
<h3 id="static-vs-dynamic-linking"><a class="header" href="#static-vs-dynamic-linking">Static vs Dynamic Linking</a></h3>
<p><strong>Dynamic linking (default):</strong></p>
<pre><code class="language-bash"># Requires target's libc at runtime
arm-linux-gnueabihf-gcc hello.c -o hello

# List dependencies
arm-linux-gnueabihf-ldd hello
# or
arm-linux-gnueabihf-readelf -d hello
</code></pre>
<p><strong>Static linking:</strong></p>
<pre><code class="language-bash"># Includes all libraries in binary
arm-linux-gnueabihf-gcc hello.c -o hello -static

# Check - no dependencies
file hello
# hello: ELF 32-bit LSB executable, ARM, statically linked

# Size comparison
ls -lh hello
# Much larger with static linking
</code></pre>
<h3 id="cross-compiling-with-libraries"><a class="header" href="#cross-compiling-with-libraries">Cross Compiling with Libraries</a></h3>
<pre><code class="language-c">/* http_client.c - requires libcurl */
#include &lt;curl/curl.h&gt;
#include &lt;stdio.h&gt;

int main(void)
{
	CURL *curl = curl_easy_init();
	if (curl) {
		curl_easy_cleanup(curl);
		printf("libcurl working!\n");
	}
	return 0;
}
</code></pre>
<p><strong>Without sysroot (will fail):</strong></p>
<pre><code class="language-bash">arm-linux-gnueabihf-gcc http_client.c -o http_client -lcurl
# Error: curl/curl.h: No such file or directory
</code></pre>
<p><strong>With sysroot:</strong></p>
<pre><code class="language-bash"># Install target libraries on host
sudo apt-get install libcurl4-openssl-dev:armhf

# Compile with sysroot
arm-linux-gnueabihf-gcc http_client.c -o http_client \
	--sysroot=/usr/arm-linux-gnueabihf \
	-lcurl

# Or set PKG_CONFIG
export PKG_CONFIG_PATH=/usr/arm-linux-gnueabihf/lib/pkgconfig
arm-linux-gnueabihf-gcc http_client.c -o http_client \
	$(pkg-config --cflags --libs libcurl)
</code></pre>
<h3 id="makefile-for-cross-compilation"><a class="header" href="#makefile-for-cross-compilation">Makefile for Cross Compilation</a></h3>
<pre><code class="language-makefile"># Makefile
CC := $(CROSS_COMPILE)gcc
CXX := $(CROSS_COMPILE)g++
LD := $(CROSS_COMPILE)ld
AR := $(CROSS_COMPILE)ar
STRIP := $(CROSS_COMPILE)strip

CFLAGS := -Wall -O2
LDFLAGS :=

# Add sysroot if set
ifdef SYSROOT
CFLAGS += --sysroot=$(SYSROOT)
LDFLAGS += --sysroot=$(SYSROOT)
endif

TARGET := myapp
SRCS := main.c utils.c
OBJS := $(SRCS:.c=.o)

all: $(TARGET)

$(TARGET): $(OBJS)
	$(CC) $(LDFLAGS) -o $@ $^
	$(STRIP) $@

%.o: %.c
	$(CC) $(CFLAGS) -c -o $@ $&lt;

clean:
	rm -f $(OBJS) $(TARGET)

.PHONY: all clean
</code></pre>
<p><strong>Usage:</strong></p>
<pre><code class="language-bash"># Native compilation
make

# Cross compilation
make CROSS_COMPILE=arm-linux-gnueabihf-

# With sysroot
make CROSS_COMPILE=arm-linux-gnueabihf- SYSROOT=/opt/arm-sysroot
</code></pre>
<hr />
<h2 id="build-system-support"><a class="header" href="#build-system-support">Build System Support</a></h2>
<h3 id="autotools-configure"><a class="header" href="#autotools-configure">Autotools (./configure)</a></h3>
<pre><code class="language-bash"># Basic cross compilation
./configure --host=arm-linux-gnueabihf --prefix=/usr

# With sysroot
./configure \
	--host=arm-linux-gnueabihf \
	--prefix=/usr \
	--with-sysroot=/opt/arm-sysroot \
	CFLAGS="--sysroot=/opt/arm-sysroot" \
	LDFLAGS="--sysroot=/opt/arm-sysroot"

# Build and install
make
make DESTDIR=/path/to/rootfs install
</code></pre>
<p><strong>config.site for consistent configuration:</strong></p>
<pre><code class="language-bash"># Create config.site
cat &gt; arm-config.site &lt;&lt; 'EOF'
# Cross compilation settings
ac_cv_func_malloc_0_nonnull=yes
ac_cv_func_realloc_0_nonnull=yes
EOF

# Use it
./configure --host=arm-linux-gnueabihf --prefix=/usr \
	CONFIG_SITE=arm-config.site
</code></pre>
<h3 id="cmake"><a class="header" href="#cmake">CMake</a></h3>
<p><strong>Toolchain file:</strong></p>
<pre><code class="language-cmake"># arm-toolchain.cmake
set(CMAKE_SYSTEM_NAME Linux)
set(CMAKE_SYSTEM_PROCESSOR arm)

# Specify the cross compiler
set(CMAKE_C_COMPILER arm-linux-gnueabihf-gcc)
set(CMAKE_CXX_COMPILER arm-linux-gnueabihf-g++)

# Where to look for libraries
set(CMAKE_FIND_ROOT_PATH /usr/arm-linux-gnueabihf)

# Search for programs in the build host directories
set(CMAKE_FIND_ROOT_PATH_MODE_PROGRAM NEVER)

# Search for libraries and headers in target directories
set(CMAKE_FIND_ROOT_PATH_MODE_LIBRARY ONLY)
set(CMAKE_FIND_ROOT_PATH_MODE_INCLUDE ONLY)
set(CMAKE_FIND_ROOT_PATH_MODE_PACKAGE ONLY)
</code></pre>
<p><strong>Build:</strong></p>
<pre><code class="language-bash">mkdir build &amp;&amp; cd build
cmake .. -DCMAKE_TOOLCHAIN_FILE=../arm-toolchain.cmake
make
</code></pre>
<p><strong>Or using environment variables:</strong></p>
<pre><code class="language-bash">export CC=arm-linux-gnueabihf-gcc
export CXX=arm-linux-gnueabihf-g++
cmake ..
make
</code></pre>
<h3 id="meson"><a class="header" href="#meson">Meson</a></h3>
<p><strong>Cross file:</strong></p>
<pre><code class="language-ini"># arm-cross.txt
[binaries]
c = 'arm-linux-gnueabihf-gcc'
cpp = 'arm-linux-gnueabihf-g++'
ar = 'arm-linux-gnueabihf-ar'
strip = 'arm-linux-gnueabihf-strip'
pkgconfig = 'arm-linux-gnueabihf-pkg-config'

[host_machine]
system = 'linux'
cpu_family = 'arm'
cpu = 'cortex-a8'
endian = 'little'

[properties]
sys_root = '/usr/arm-linux-gnueabihf'
</code></pre>
<p><strong>Build:</strong></p>
<pre><code class="language-bash">meson setup build --cross-file arm-cross.txt
ninja -C build
</code></pre>
<hr />
<h2 id="root-filesystem-creation"><a class="header" href="#root-filesystem-creation">Root Filesystem Creation</a></h2>
<h3 id="using-buildroot"><a class="header" href="#using-buildroot">Using Buildroot</a></h3>
<pre><code class="language-bash"># Configure
make menuconfig

# Filesystem images -&gt; ext2/3/4 root filesystem
# System configuration -&gt; System hostname, root password
# Target packages -&gt; Select packages

# Build
make

# Output
ls output/images/
# rootfs.ext4  zImage  *.dtb
</code></pre>
<h3 id="using-yoctoopenembedded"><a class="header" href="#using-yoctoopenembedded">Using Yocto/OpenEmbedded</a></h3>
<pre><code class="language-bash"># Clone Poky
git clone -b kirkstone git://git.yoctoproject.org/poky
cd poky

# Initialize build
source oe-init-build-env

# Edit conf/local.conf
# MACHINE = "beaglebone-yocto"

# Build minimal image
bitbake core-image-minimal

# Output in tmp/deploy/images/beaglebone-yocto/
</code></pre>
<h3 id="manual-root-filesystem"><a class="header" href="#manual-root-filesystem">Manual Root Filesystem</a></h3>
<pre><code class="language-bash">#!/bin/bash
# create-rootfs.sh

ROOTFS=/tmp/arm-rootfs
TOOLCHAIN=arm-linux-gnueabihf

# Create directory structure
mkdir -p $ROOTFS/{bin,sbin,etc,proc,sys,dev,lib,usr/{bin,sbin,lib},tmp,var,home,root}

# Copy libraries from toolchain
SYSROOT=$(${TOOLCHAIN}-gcc -print-sysroot)
cp -a $SYSROOT/lib/* $ROOTFS/lib/
cp -a $SYSROOT/usr/lib/* $ROOTFS/usr/lib/

# Install busybox (provides basic utilities)
git clone https://git.busybox.net/busybox
cd busybox
make ARCH=arm CROSS_COMPILE=$TOOLCHAIN- defconfig
make ARCH=arm CROSS_COMPILE=$TOOLCHAIN- -j$(nproc)
make ARCH=arm CROSS_COMPILE=$TOOLCHAIN- \
	CONFIG_PREFIX=$ROOTFS install
cd ..

# Create device nodes
sudo mknod -m 666 $ROOTFS/dev/null c 1 3
sudo mknod -m 666 $ROOTFS/dev/console c 5 1
sudo mknod -m 666 $ROOTFS/dev/tty c 5 0

# Create /etc/inittab
cat &gt; $ROOTFS/etc/inittab &lt;&lt; 'EOF'
::sysinit:/etc/init.d/rcS
::respawn:/sbin/getty 115200 console
::shutdown:/bin/umount -a -r
::restart:/sbin/init
EOF

# Create init script
mkdir -p $ROOTFS/etc/init.d
cat &gt; $ROOTFS/etc/init.d/rcS &lt;&lt; 'EOF'
#!/bin/sh
mount -t proc none /proc
mount -t sysfs none /sys
mount -t tmpfs none /tmp
echo "Boot complete"
EOF
chmod +x $ROOTFS/etc/init.d/rcS

# Create filesystem image
dd if=/dev/zero of=rootfs.ext4 bs=1M count=512
mkfs.ext4 rootfs.ext4
mkdir -p /mnt/rootfs
sudo mount rootfs.ext4 /mnt/rootfs
sudo cp -a $ROOTFS/* /mnt/rootfs/
sudo umount /mnt/rootfs

echo "Root filesystem created: rootfs.ext4"
</code></pre>
<hr />
<h2 id="debugging-cross-compiled-code"><a class="header" href="#debugging-cross-compiled-code">Debugging Cross-Compiled Code</a></h2>
<h3 id="remote-gdb-debugging"><a class="header" href="#remote-gdb-debugging">Remote GDB Debugging</a></h3>
<p><strong>On target (ARM device):</strong></p>
<pre><code class="language-bash"># Install gdbserver (if not already present)
# Run application under gdbserver
gdbserver :1234 ./myapp arg1 arg2
</code></pre>
<p><strong>On host (development PC):</strong></p>
<pre><code class="language-bash"># Use cross-gdb
arm-linux-gnueabihf-gdb ./myapp

# In GDB
(gdb) target remote target-ip:1234
(gdb) break main
(gdb) continue
(gdb) step
(gdb) print variable
(gdb) backtrace
</code></pre>
<p><strong>GDB script for convenience:</strong></p>
<pre><code class="language-bash"># .gdbinit
target remote 192.168.1.100:1234
break main
</code></pre>
<h3 id="qemu-user-mode"><a class="header" href="#qemu-user-mode">QEMU User Mode</a></h3>
<p>Run ARM binaries on x86 using QEMU:</p>
<pre><code class="language-bash"># Install QEMU user mode
sudo apt-get install qemu-user-static

# Run ARM binary
qemu-arm-static -L /usr/arm-linux-gnueabihf ./hello

# With GDB
qemu-arm-static -L /usr/arm-linux-gnueabihf -g 1234 ./hello

# In another terminal
arm-linux-gnueabihf-gdb ./hello
(gdb) target remote :1234
</code></pre>
<h3 id="qemu-system-mode"><a class="header" href="#qemu-system-mode">QEMU System Mode</a></h3>
<p>Emulate entire ARM system:</p>
<pre><code class="language-bash"># Install QEMU system
sudo apt-get install qemu-system-arm

# Run with kernel and rootfs
qemu-system-arm \
	-M vexpress-a9 \
	-kernel zImage \
	-dtb vexpress-v2p-ca9.dtb \
	-drive file=rootfs.ext4,if=sd,format=raw \
	-append "console=ttyAMA0 root=/dev/mmcblk0 rootwait" \
	-serial stdio \
	-net nic -net user
</code></pre>
<h3 id="analyzing-binaries"><a class="header" href="#analyzing-binaries">Analyzing Binaries</a></h3>
<pre><code class="language-bash"># Check architecture
file myapp
arm-linux-gnueabihf-readelf -h myapp

# List symbols
arm-linux-gnueabihf-nm myapp

# Disassemble
arm-linux-gnueabihf-objdump -d myapp

# Check shared library dependencies
arm-linux-gnueabihf-readelf -d myapp | grep NEEDED

# Strings in binary
arm-linux-gnueabihf-strings myapp

# Size information
arm-linux-gnueabihf-size myapp
</code></pre>
<hr />
<h2 id="common-architectures"><a class="header" href="#common-architectures">Common Architectures</a></h2>
<h3 id="arm-32-bit"><a class="header" href="#arm-32-bit">ARM (32-bit)</a></h3>
<pre><code class="language-bash"># Soft-float (no FPU)
CROSS_COMPILE=arm-linux-gnueabi-
ARCH=arm

# Hard-float (with FPU)
CROSS_COMPILE=arm-linux-gnueabihf-
ARCH=arm

# Kernel config
make ARCH=arm multi_v7_defconfig
</code></pre>
<h3 id="arm64-aarch64"><a class="header" href="#arm64-aarch64">ARM64 (AArch64)</a></h3>
<pre><code class="language-bash">CROSS_COMPILE=aarch64-linux-gnu-
ARCH=arm64

# Kernel config
make ARCH=arm64 defconfig
</code></pre>
<h3 id="mips"><a class="header" href="#mips">MIPS</a></h3>
<pre><code class="language-bash"># Big-endian
CROSS_COMPILE=mips-linux-gnu-
ARCH=mips

# Little-endian
CROSS_COMPILE=mipsel-linux-gnu-
ARCH=mips

# Kernel config
make ARCH=mips malta_defconfig
</code></pre>
<h3 id="risc-v"><a class="header" href="#risc-v">RISC-V</a></h3>
<pre><code class="language-bash"># 64-bit
CROSS_COMPILE=riscv64-linux-gnu-
ARCH=riscv

# 32-bit
CROSS_COMPILE=riscv32-linux-gnu-
ARCH=riscv

# Kernel config
make ARCH=riscv defconfig
</code></pre>
<h3 id="powerpc"><a class="header" href="#powerpc">PowerPC</a></h3>
<pre><code class="language-bash">CROSS_COMPILE=powerpc-linux-gnu-
ARCH=powerpc

# Kernel config
make ARCH=powerpc pmac32_defconfig
</code></pre>
<hr />
<h2 id="troubleshooting-1"><a class="header" href="#troubleshooting-1">Troubleshooting</a></h2>
<h3 id="common-issues-2"><a class="header" href="#common-issues-2">Common Issues</a></h3>
<p><strong>Issue: "No such file or directory" for header files</strong></p>
<pre><code class="language-bash"># Problem: Headers not found
arm-linux-gnueabihf-gcc test.c
# test.c:1:10: fatal error: curl/curl.h: No such file or directory

# Solution: Install cross-compiled development package
sudo apt-get install libcurl4-openssl-dev:armhf

# Or specify include path
arm-linux-gnueabihf-gcc test.c \
	-I/usr/arm-linux-gnueabihf/include
</code></pre>
<p><strong>Issue: "cannot find -lxxx" linker errors</strong></p>
<pre><code class="language-bash"># Problem: Library not found
# /usr/bin/ld: cannot find -lssl

# Solution: Install library for target architecture
sudo apt-get install libssl-dev:armhf

# Or specify library path
arm-linux-gnueabihf-gcc test.c -lssl \
	-L/usr/arm-linux-gnueabihf/lib
</code></pre>
<p><strong>Issue: Binary runs on host but not target</strong></p>
<pre><code class="language-bash"># Check architecture
file myapp
# If says x86_64 instead of ARM, CROSS_COMPILE wasn't set

# Verify you're using cross compiler
which ${CROSS_COMPILE}gcc

# Check if it's stripped of debug info
${CROSS_COMPILE}readelf -S myapp | grep debug
</code></pre>
<p><strong>Issue: "Exec format error" on target</strong></p>
<pre><code class="language-bash"># Problem: Wrong architecture or ABI mismatch

# Check target's actual architecture
ssh target 'uname -m'  # armv7l, aarch64, etc.

# Check binary architecture
file myapp

# For ARM: Check float ABI
${CROSS_COMPILE}readelf -A myapp | grep ABI
# Must match target's ABI (soft-float vs hard-float)
</code></pre>
<p><strong>Issue: Shared library not found on target</strong></p>
<pre><code class="language-bash"># Error on target
./myapp: error while loading shared libraries: libfoo.so.1

# Solution 1: Copy library to target
scp /usr/arm-linux-gnueabihf/lib/libfoo.so.* target:/lib/

# Solution 2: Static linking
arm-linux-gnueabihf-gcc test.c -o myapp -static

# Solution 3: Use LD_LIBRARY_PATH on target
export LD_LIBRARY_PATH=/path/to/libs:$LD_LIBRARY_PATH
</code></pre>
<h3 id="debugging-tips"><a class="header" href="#debugging-tips">Debugging Tips</a></h3>
<pre><code class="language-bash"># Verbose compiler output
arm-linux-gnueabihf-gcc -v test.c

# Show search paths
arm-linux-gnueabihf-gcc -print-search-dirs

# Show sysroot
arm-linux-gnueabihf-gcc -print-sysroot

# Preprocessor output only
arm-linux-gnueabihf-gcc -E test.c

# Show include paths
echo | arm-linux-gnueabihf-gcc -v -E -

# Test if toolchain works
arm-linux-gnueabihf-gcc -v
</code></pre>
<hr />
<h2 id="best-practices-18"><a class="header" href="#best-practices-18">Best Practices</a></h2>
<h3 id="1-use-consistent-toolchain"><a class="header" href="#1-use-consistent-toolchain">1. Use Consistent Toolchain</a></h3>
<pre><code class="language-bash"># Bad: Mixing toolchains
gcc myapp.c  # Native compiler!
arm-linux-gnueabihf-gcc mylib.c

# Good: Use CROSS_COMPILE consistently
export CROSS_COMPILE=arm-linux-gnueabihf-
${CROSS_COMPILE}gcc myapp.c mylib.c
</code></pre>
<h3 id="2-separate-build-directories"><a class="header" href="#2-separate-build-directories">2. Separate Build Directories</a></h3>
<pre><code class="language-bash"># Keep source clean
mkdir -p build/arm build/x86

# ARM build
make O=build/arm ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf-

# x86 build
make O=build/x86

# Clean specific build
rm -rf build/arm
</code></pre>
<h3 id="3-use-build-scripts"><a class="header" href="#3-use-build-scripts">3. Use Build Scripts</a></h3>
<pre><code class="language-bash">#!/bin/bash
# build-cross.sh

set -e  # Exit on error

# Configuration
export ARCH=arm
export CROSS_COMPILE=arm-linux-gnueabihf-
export INSTALL_PATH=/opt/target-root

# Build
echo "Building for $ARCH..."
make clean
make -j$(nproc)
make install DESTDIR=$INSTALL_PATH

echo "Build complete: $INSTALL_PATH"
</code></pre>
<h3 id="4-maintain-sysroot"><a class="header" href="#4-maintain-sysroot">4. Maintain Sysroot</a></h3>
<pre><code class="language-bash"># Organized sysroot
/opt/arm-sysroot/
├── usr/
│   ├── include/  # Headers
│   └── lib/      # Libraries
├── lib/          # System libraries
└── etc/          # Configuration files

# Set PKG_CONFIG for libraries
export PKG_CONFIG_PATH=/opt/arm-sysroot/usr/lib/pkgconfig
export PKG_CONFIG_SYSROOT_DIR=/opt/arm-sysroot
</code></pre>
<h3 id="5-version-control-binaries"><a class="header" href="#5-version-control-binaries">5. Version Control Binaries</a></h3>
<pre><code class="language-bash"># Tag releases
git tag -a v1.0-arm -m "ARM release v1.0"

# Separate binary artifacts
artifacts/
├── v1.0/
│   ├── arm/
│   │   ├── myapp
│   │   └── myapp.debug
│   ├── arm64/
│   └── x86_64/
</code></pre>
<h3 id="6-automate-testing"><a class="header" href="#6-automate-testing">6. Automate Testing</a></h3>
<pre><code class="language-bash">#!/bin/bash
# test-cross.sh

# Build
./build-cross.sh

# Copy to target
scp build/myapp target:/tmp/

# Run on target
ssh target "/tmp/myapp --test"

# Check exit code
if [ $? -eq 0 ]; then
	echo "Tests passed"
else
	echo "Tests failed"
	exit 1
fi
</code></pre>
<h3 id="7-document-dependencies"><a class="header" href="#7-document-dependencies">7. Document Dependencies</a></h3>
<pre><code class="language-bash"># dependencies.txt
Toolchain: gcc-arm-linux-gnueabihf-9.3
Libraries:
  - libssl-dev:armhf (&gt;= 1.1.1)
  - libcurl4-openssl-dev:armhf (&gt;= 7.68.0)
  - zlib1g-dev:armhf

Kernel: 5.10 or later
Bootloader: U-Boot 2021.01
</code></pre>
<h3 id="8-optimize-for-target"><a class="header" href="#8-optimize-for-target">8. Optimize for Target</a></h3>
<pre><code class="language-bash"># Compiler optimizations
CFLAGS="-O2 -march=armv7-a -mtune=cortex-a8 -mfpu=neon"

# Size optimization
CFLAGS="-Os -ffunction-sections -fdata-sections"
LDFLAGS="-Wl,--gc-sections"

# Strip debug info for production
${CROSS_COMPILE}strip --strip-all myapp
</code></pre>
<hr />
<h2 id="summary-1"><a class="header" href="#summary-1">Summary</a></h2>
<p>Cross compilation is essential for embedded Linux development:</p>
<p><strong>Key Steps:</strong></p>
<ol>
<li>Install or build a cross-compilation toolchain</li>
<li>Set <code>CROSS_COMPILE</code> and <code>ARCH</code> environment variables</li>
<li>Use <code>--sysroot</code> or install target libraries on host</li>
<li>Build with cross compiler instead of native compiler</li>
<li>Test on target device or QEMU emulator</li>
</ol>
<p><strong>Essential Variables:</strong></p>
<ul>
<li><code>CROSS_COMPILE</code>: Toolchain prefix (e.g., <code>arm-linux-gnueabihf-</code>)</li>
<li><code>ARCH</code>: Target architecture (e.g., <code>arm</code>, <code>arm64</code>, <code>mips</code>)</li>
<li><code>SYSROOT</code>: Target root filesystem path on host</li>
</ul>
<p><strong>Common Workflows:</strong></p>
<ul>
<li>Kernel: <code>make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf-</code></li>
<li>Autotools: <code>./configure --host=arm-linux-gnueabihf</code></li>
<li>CMake: <code>cmake -DCMAKE_TOOLCHAIN_FILE=arm-toolchain.cmake</code></li>
<li>Makefile: <code>make CROSS_COMPILE=arm-linux-gnueabihf-</code></li>
</ul>
<p><strong>Resources:</strong></p>
<ul>
<li><a href="https://crosstool-ng.github.io/">Crosstool-NG</a></li>
<li><a href="https://buildroot.org/">Buildroot</a></li>
<li><a href="https://www.yoctoproject.org/">Yocto Project</a></li>
<li><a href="https://elinux.org/">Embedded Linux Wiki</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cfg80211-and-mac80211"><a class="header" href="#cfg80211-and-mac80211">cfg80211 and mac80211</a></h1>
<p>Linux wireless subsystem frameworks for 802.11 (WiFi) device drivers and configuration.</p>
<h2 id="table-of-contents-8"><a class="header" href="#table-of-contents-8">Table of Contents</a></h2>
<ul>
<li><a href="linux/cfg80211_mac80211.html#overview">Overview</a></li>
<li><a href="linux/cfg80211_mac80211.html#architecture">Architecture</a></li>
<li><a href="linux/cfg80211_mac80211.html#cfg80211">cfg80211</a></li>
<li><a href="linux/cfg80211_mac80211.html#mac80211">mac80211</a></li>
<li><a href="linux/cfg80211_mac80211.html#driver-development">Driver Development</a></li>
<li><a href="linux/cfg80211_mac80211.html#nl80211">nl80211</a></li>
<li><a href="linux/cfg80211_mac80211.html#regulatory-framework">Regulatory Framework</a></li>
<li><a href="linux/cfg80211_mac80211.html#power-management">Power Management</a></li>
<li><a href="linux/cfg80211_mac80211.html#scanning">Scanning</a></li>
<li><a href="linux/cfg80211_mac80211.html#connection-management">Connection Management</a></li>
<li><a href="linux/cfg80211_mac80211.html#mesh-networking">Mesh Networking</a></li>
<li><a href="linux/cfg80211_mac80211.html#debugging">Debugging</a></li>
</ul>
<hr />
<h2 id="overview-14"><a class="header" href="#overview-14">Overview</a></h2>
<p>The Linux wireless stack consists of two main components:</p>
<ul>
<li><strong>cfg80211</strong>: Configuration API and regulatory database for 802.11 devices</li>
<li><strong>mac80211</strong>: Generic IEEE 802.11 MAC layer implementation</li>
</ul>
<h3 id="why-two-layers"><a class="header" href="#why-two-layers">Why Two Layers?</a></h3>
<pre><code>┌─────────────────────────────────────┐
│        User Space (iw, wpa_supplicant)  │
└─────────────────────────────────────┘
              │ nl80211
┌─────────────────────────────────────┐
│          cfg80211                    │  ← Configuration &amp; regulatory
│   (wireless configuration API)       │
└─────────────────────────────────────┘
              │
┌─────────────────────────────────────┐
│          mac80211                    │  ← MAC layer (optional)
│   (generic MAC implementation)       │
└─────────────────────────────────────┘
              │
┌─────────────────────────────────────┐
│      WiFi Device Driver              │  ← Hardware-specific
│   (ath9k, iwlwifi, rtl8xxxu, etc.)  │
└─────────────────────────────────────┘
              │
┌─────────────────────────────────────┐
│      Hardware (WiFi Chip)            │
└─────────────────────────────────────┘
</code></pre>
<p><strong>cfg80211</strong> is mandatory for all wireless drivers. It provides:</p>
<ul>
<li>Configuration interface via nl80211</li>
<li>Regulatory domain management</li>
<li>Scanning coordination</li>
<li>Authentication/association state machine</li>
</ul>
<p><strong>mac80211</strong> is optional and provides a generic MAC layer implementation for devices that only implement hardware-specific functions (PHY layer). Drivers can choose to:</p>
<ol>
<li>Use mac80211 (most SoftMAC drivers: ath9k, iwlwifi, rtl8xxxu)</li>
<li>Implement their own MAC (FullMAC drivers: brcmfmac, mwifiex)</li>
</ol>
<hr />
<h2 id="architecture"><a class="header" href="#architecture">Architecture</a></h2>
<h3 id="layer-responsibilities"><a class="header" href="#layer-responsibilities">Layer Responsibilities</a></h3>
<pre><code>User Space
    │
    ├─ iw: Configuration tool
    ├─ wpa_supplicant: WPA/WPA2 authentication
    └─ hostapd: Access Point daemon
    │
    ▼ nl80211 (netlink)
    │
cfg80211
    │
    ├─ Configuration API
    ├─ Regulatory database
    ├─ Scan results management
    ├─ Connection tracking
    └─ nl80211 ↔ cfg80211_ops translation
    │
    ▼ cfg80211_ops
    │
mac80211 (optional)
    │
    ├─ Beacon handling
    ├─ Power save
    ├─ Aggregation (A-MPDU/A-MSDU)
    ├─ Rate control
    ├─ TX/RX queuing
    └─ Frame filtering
    │
    ▼ ieee80211_ops
    │
Driver (hardware-specific)
    │
    ├─ Channel switching
    ├─ TX/RX DMA
    ├─ Interrupt handling
    └─ Register access
    │
    ▼
Hardware
</code></pre>
<h3 id="data-flow"><a class="header" href="#data-flow">Data Flow</a></h3>
<p><strong>TX Path:</strong></p>
<pre><code>Application
    ↓
Socket/Network Stack
    ↓
cfg80211 (for management frames)
    ↓
mac80211 (encryption, aggregation, queuing)
    ↓
Driver (DMA, hardware TX)
    ↓
Hardware
</code></pre>
<p><strong>RX Path:</strong></p>
<pre><code>Hardware
    ↓
Driver (interrupt, DMA)
    ↓
mac80211 (decryption, defragmentation)
    ↓
cfg80211 (scan results, regulatory info)
    ↓
Network Stack
    ↓
Application
</code></pre>
<hr />
<h2 id="cfg80211"><a class="header" href="#cfg80211">cfg80211</a></h2>
<h3 id="core-concepts"><a class="header" href="#core-concepts">Core Concepts</a></h3>
<p>cfg80211 is the configuration API for 802.11 devices. It abstracts hardware differences and provides a unified interface.</p>
<h3 id="key-data-structures"><a class="header" href="#key-data-structures">Key Data Structures</a></h3>
<pre><code class="language-c">#include &lt;net/cfg80211.h&gt;

/* Wireless device (wiphy) - represents physical device */
struct wiphy {
	int n_addresses;
	struct mac_address *addresses;

	/* Supported bands */
	struct ieee80211_supported_band *bands[NUM_NL80211_BANDS];

	/* Regulatory domain */
	const struct ieee80211_regdomain *regd;

	/* Driver callbacks */
	const struct cfg80211_ops *ops;

	/* Flags */
	u32 flags;

	/* Interface modes supported */
	u16 interface_modes;

	/* Cipher suites */
	const u32 *cipher_suites;
	int n_cipher_suites;

	/* Maximum scan SSIDs */
	u8 max_scan_ssids;

	/* Maximum scheduled scan SSIDs */
	u8 max_sched_scan_ssids;

	/* Private driver data */
	void *priv;
};

/* Wireless interface (wdev) - represents virtual interface */
struct wireless_dev {
	struct wiphy *wiphy;
	enum nl80211_iftype iftype;

	struct net_device *netdev;

	/* Current BSS */
	struct cfg80211_bss *current_bss;

	/* Connection parameters */
	u8 ssid[IEEE80211_MAX_SSID_LEN];
	u8 ssid_len;

	/* Wireless extensions compatibility */
	struct cfg80211_internal_bss *authtry_bsses[4];
	struct cfg80211_internal_bss *auth_bsses[4];
	struct cfg80211_internal_bss *assoc_bsses[4];
};

/* BSS information */
struct cfg80211_bss {
	struct ieee80211_channel *channel;

	u8 bssid[ETH_ALEN];
	u64 tsf;
	u16 beacon_interval;
	u16 capability;

	const u8 *ies;
	size_t ies_len;

	s32 signal;
	u64 parent_tsf;
};
</code></pre>
<h3 id="cfg80211_ops---driver-callbacks"><a class="header" href="#cfg80211_ops---driver-callbacks">cfg80211_ops - Driver Callbacks</a></h3>
<pre><code class="language-c">struct cfg80211_ops {
	/* Interface management */
	int (*add_virtual_intf)(struct wiphy *wiphy,
				const char *name,
				enum nl80211_iftype type,
				struct vif_params *params);

	int (*del_virtual_intf)(struct wiphy *wiphy,
				struct wireless_dev *wdev);

	int (*change_virtual_intf)(struct wiphy *wiphy,
				   struct net_device *dev,
				   enum nl80211_iftype type,
				   struct vif_params *params);

	/* Scanning */
	int (*scan)(struct wiphy *wiphy,
		    struct cfg80211_scan_request *request);

	/* Connection */
	int (*connect)(struct wiphy *wiphy,
		       struct net_device *dev,
		       struct cfg80211_connect_params *sme);

	int (*disconnect)(struct wiphy *wiphy,
			  struct net_device *dev,
			  u16 reason_code);

	/* Authentication &amp; Association */
	int (*auth)(struct wiphy *wiphy,
		    struct net_device *dev,
		    struct cfg80211_auth_request *req);

	int (*assoc)(struct wiphy *wiphy,
		     struct net_device *dev,
		     struct cfg80211_assoc_request *req);

	int (*deauth)(struct wiphy *wiphy,
		      struct net_device *dev,
		      struct cfg80211_deauth_request *req);

	int (*disassoc)(struct wiphy *wiphy,
			struct net_device *dev,
			struct cfg80211_disassoc_request *req);

	/* Configuration */
	int (*set_channel)(struct wiphy *wiphy,
			   struct cfg80211_chan_def *chandef);

	int (*set_txq_params)(struct wiphy *wiphy,
			      struct net_device *dev,
			      struct ieee80211_txq_params *params);

	int (*set_tx_power)(struct wiphy *wiphy,
			    struct wireless_dev *wdev,
			    enum nl80211_tx_power_setting type,
			    int mbm);

	int (*get_tx_power)(struct wiphy *wiphy,
			    struct wireless_dev *wdev,
			    int *dbm);

	/* AP mode */
	int (*start_ap)(struct wiphy *wiphy,
			struct net_device *dev,
			struct cfg80211_ap_settings *settings);

	int (*stop_ap)(struct wiphy *wiphy,
		       struct net_device *dev);

	/* Station management */
	int (*add_station)(struct wiphy *wiphy,
			   struct net_device *dev,
			   const u8 *mac,
			   struct station_parameters *params);

	int (*del_station)(struct wiphy *wiphy,
			   struct net_device *dev,
			   struct station_del_parameters *params);

	int (*change_station)(struct wiphy *wiphy,
			      struct net_device *dev,
			      const u8 *mac,
			      struct station_parameters *params);

	int (*get_station)(struct wiphy *wiphy,
			   struct net_device *dev,
			   const u8 *mac,
			   struct station_info *sinfo);

	/* Power management */
	int (*set_power_mgmt)(struct wiphy *wiphy,
			      struct net_device *dev,
			      bool enabled,
			      int timeout);

	/* Regulatory */
	void (*reg_notifier)(struct wiphy *wiphy,
			     struct regulatory_request *request);
};
</code></pre>
<h3 id="registering-a-wiphy"><a class="header" href="#registering-a-wiphy">Registering a Wiphy</a></h3>
<pre><code class="language-c">#include &lt;net/cfg80211.h&gt;

static const struct cfg80211_ops my_cfg_ops = {
	.scan = my_scan,
	.connect = my_connect,
	.disconnect = my_disconnect,
	/* ... other callbacks ... */
};

static int my_probe(struct pci_dev *pdev, const struct pci_device_id *id)
{
	struct wiphy *wiphy;
	struct my_priv *priv;
	int ret;

	/* Allocate wiphy with private data */
	wiphy = wiphy_new(&amp;my_cfg_ops, sizeof(*priv));
	if (!wiphy)
		return -ENOMEM;

	priv = wiphy_priv(wiphy);

	/* Set wiphy parameters */
	wiphy-&gt;interface_modes = BIT(NL80211_IFTYPE_STATION) |
				 BIT(NL80211_IFTYPE_AP);

	wiphy-&gt;max_scan_ssids = 4;
	wiphy-&gt;max_scan_ie_len = 256;

	/* Set supported bands */
	wiphy-&gt;bands[NL80211_BAND_2GHZ] = &amp;my_band_2ghz;
	wiphy-&gt;bands[NL80211_BAND_5GHZ] = &amp;my_band_5ghz;

	/* Set supported cipher suites */
	wiphy-&gt;cipher_suites = my_cipher_suites;
	wiphy-&gt;n_cipher_suites = ARRAY_SIZE(my_cipher_suites);

	/* Set regulatory domain */
	wiphy-&gt;regulatory_flags = REGULATORY_STRICT_REG;

	/* Register wiphy */
	ret = wiphy_register(wiphy);
	if (ret) {
		wiphy_free(wiphy);
		return ret;
	}

	return 0;
}

static void my_remove(struct pci_dev *pdev)
{
	struct wiphy *wiphy = pci_get_drvdata(pdev);

	wiphy_unregister(wiphy);
	wiphy_free(wiphy);
}
</code></pre>
<h3 id="band-and-channel-definition"><a class="header" href="#band-and-channel-definition">Band and Channel Definition</a></h3>
<pre><code class="language-c">/* 2.4 GHz band channels */
static struct ieee80211_channel my_2ghz_channels[] = {
	{ .band = NL80211_BAND_2GHZ, .center_freq = 2412, .hw_value = 1 },
	{ .band = NL80211_BAND_2GHZ, .center_freq = 2417, .hw_value = 2 },
	{ .band = NL80211_BAND_2GHZ, .center_freq = 2422, .hw_value = 3 },
	/* ... channels 4-13 ... */
};

/* Supported rates for 2.4 GHz */
static struct ieee80211_rate my_2ghz_rates[] = {
	{ .bitrate = 10 },   /* 1 Mbps */
	{ .bitrate = 20 },   /* 2 Mbps */
	{ .bitrate = 55 },   /* 5.5 Mbps */
	{ .bitrate = 110 },  /* 11 Mbps */
	{ .bitrate = 60 },   /* 6 Mbps */
	{ .bitrate = 90 },   /* 9 Mbps */
	{ .bitrate = 120 },  /* 12 Mbps */
	/* ... more rates ... */
};

/* 2.4 GHz band definition */
static struct ieee80211_supported_band my_band_2ghz = {
	.channels = my_2ghz_channels,
	.n_channels = ARRAY_SIZE(my_2ghz_channels),
	.bitrates = my_2ghz_rates,
	.n_bitrates = ARRAY_SIZE(my_2ghz_rates),
	.ht_cap = {
		.cap = IEEE80211_HT_CAP_SGI_20 |
		       IEEE80211_HT_CAP_SGI_40 |
		       IEEE80211_HT_CAP_SUP_WIDTH_20_40,
		.ht_supported = true,
	},
};
</code></pre>
<hr />
<h2 id="mac80211"><a class="header" href="#mac80211">mac80211</a></h2>
<h3 id="overview-15"><a class="header" href="#overview-15">Overview</a></h3>
<p>mac80211 is a framework for SoftMAC 802.11 drivers. It implements the MAC layer so drivers only need to implement hardware-specific operations.</p>
<h3 id="key-features-1"><a class="header" href="#key-features-1">Key Features</a></h3>
<ul>
<li><strong>Frame handling</strong>: Beacon, probe, authentication, association</li>
<li><strong>Encryption</strong>: WEP, TKIP, CCMP (AES)</li>
<li><strong>Power save</strong>: PS-Poll, U-APSD</li>
<li><strong>Aggregation</strong>: A-MPDU, A-MSDU</li>
<li><strong>Rate control</strong>: Minstrel, Minstrel HT</li>
<li><strong>Quality of Service</strong>: WMM/802.11e</li>
<li><strong>Block ACK</strong>: Aggregation acknowledgment</li>
</ul>
<h3 id="core-data-structures"><a class="header" href="#core-data-structures">Core Data Structures</a></h3>
<pre><code class="language-c">#include &lt;net/mac80211.h&gt;

/* Hardware structure */
struct ieee80211_hw {
	struct ieee80211_conf conf;
	struct wiphy *wiphy;
	const char *rate_control_algorithm;
	void *priv;
	unsigned long flags;

	/* Queues */
	u16 queues;
	u16 max_listen_interval;
	s8 max_signal;

	/* TX aggregation */
	u8 max_rx_aggregation_subframes;
	u8 max_tx_aggregation_subframes;

	/* Offload capabilities */
	u32 offchannel_tx_hw_queue;
	netdev_features_t netdev_features;
};

/* Virtual interface (VIF) */
struct ieee80211_vif {
	enum nl80211_iftype type;
	struct ieee80211_bss_conf bss_conf;
	u8 addr[ETH_ALEN];
	bool p2p;

	/* Driver private data */
	u8 drv_priv[0] __aligned(sizeof(void *));
};

/* BSS configuration */
struct ieee80211_bss_conf {
	u8 bssid[ETH_ALEN];
	bool assoc;
	u16 aid;

	bool use_cts_prot;
	bool use_short_preamble;
	bool use_short_slot;
	bool enable_beacon;

	u16 beacon_int;
	u8 dtim_period;

	u32 basic_rates;
	u32 beacon_rate;

	struct ieee80211_p2p_noa_attr p2p_noa_attr;
};

/* Station information */
struct ieee80211_sta {
	u8 addr[ETH_ALEN];
	u16 aid;
	u16 max_amsdu_len;

	struct ieee80211_sta_ht_cap ht_cap;
	struct ieee80211_sta_vht_cap vht_cap;

	u8 max_sp;
	u8 rx_nss;

	/* Driver private data */
	u8 drv_priv[0] __aligned(sizeof(void *));
};

/* TX info - attached to each TX skb */
struct ieee80211_tx_info {
	u32 flags;
	u8 band;

	struct ieee80211_tx_rate rates[IEEE80211_TX_MAX_RATES];

	union {
		struct {
			struct ieee80211_vif *vif;
			struct ieee80211_key_conf *hw_key;
		} control;
		struct {
			u64 cookie;
		} ack;
		struct {
			struct ieee80211_tx_rate rates[IEEE80211_TX_MAX_RATES];
			u8 ack_signal;
		} status;
	};
};

/* RX status - filled by driver */
struct ieee80211_rx_status {
	u64 mactime;
	u32 device_timestamp;
	u16 flag;
	u16 freq;
	u8 rate_idx;
	u8 vht_nss;
	u8 rx_flags;
	u8 band;
	u8 antenna;
	s8 signal;
	u8 chains;
	s8 chain_signal[IEEE80211_MAX_CHAINS];
};
</code></pre>
<h3 id="ieee80211_ops---driver-operations"><a class="header" href="#ieee80211_ops---driver-operations">ieee80211_ops - Driver Operations</a></h3>
<pre><code class="language-c">struct ieee80211_ops {
	/* Basic operations */
	int (*start)(struct ieee80211_hw *hw);
	void (*stop)(struct ieee80211_hw *hw);

	/* Interface handling */
	int (*add_interface)(struct ieee80211_hw *hw,
			     struct ieee80211_vif *vif);
	void (*remove_interface)(struct ieee80211_hw *hw,
				 struct ieee80211_vif *vif);

	/* Configuration */
	int (*config)(struct ieee80211_hw *hw, u32 changed);
	void (*bss_info_changed)(struct ieee80211_hw *hw,
				 struct ieee80211_vif *vif,
				 struct ieee80211_bss_conf *info,
				 u32 changed);

	/* TX/RX */
	void (*tx)(struct ieee80211_hw *hw,
		   struct ieee80211_tx_control *control,
		   struct sk_buff *skb);

	int (*set_key)(struct ieee80211_hw *hw,
		       enum set_key_cmd cmd,
		       struct ieee80211_vif *vif,
		       struct ieee80211_sta *sta,
		       struct ieee80211_key_conf *key);

	/* Scanning */
	void (*sw_scan_start)(struct ieee80211_hw *hw,
			      struct ieee80211_vif *vif,
			      const u8 *mac_addr);
	void (*sw_scan_complete)(struct ieee80211_hw *hw,
				 struct ieee80211_vif *vif);

	int (*hw_scan)(struct ieee80211_hw *hw,
		       struct ieee80211_vif *vif,
		       struct ieee80211_scan_request *req);

	/* Aggregation */
	int (*ampdu_action)(struct ieee80211_hw *hw,
			    struct ieee80211_vif *vif,
			    struct ieee80211_ampdu_params *params);

	/* Station management */
	int (*sta_add)(struct ieee80211_hw *hw,
		       struct ieee80211_vif *vif,
		       struct ieee80211_sta *sta);

	int (*sta_remove)(struct ieee80211_hw *hw,
			  struct ieee80211_vif *vif,
			  struct ieee80211_sta *sta);

	void (*sta_notify)(struct ieee80211_hw *hw,
			   struct ieee80211_vif *vif,
			   enum sta_notify_cmd cmd,
			   struct ieee80211_sta *sta);

	/* Power management */
	int (*set_rts_threshold)(struct ieee80211_hw *hw, u32 value);
	void (*set_coverage_class)(struct ieee80211_hw *hw, s16 coverage_class);

	/* Multicast filter */
	void (*configure_filter)(struct ieee80211_hw *hw,
				 unsigned int changed_flags,
				 unsigned int *total_flags,
				 u64 multicast);
};
</code></pre>
<h3 id="registering-with-mac80211"><a class="header" href="#registering-with-mac80211">Registering with mac80211</a></h3>
<pre><code class="language-c">static const struct ieee80211_ops my_ops = {
	.start = my_start,
	.stop = my_stop,
	.add_interface = my_add_interface,
	.remove_interface = my_remove_interface,
	.config = my_config,
	.bss_info_changed = my_bss_info_changed,
	.tx = my_tx,
	.set_key = my_set_key,
	/* ... */
};

static int my_probe(struct pci_dev *pdev, const struct pci_device_id *id)
{
	struct ieee80211_hw *hw;
	struct my_priv *priv;
	int ret;

	/* Allocate hardware structure */
	hw = ieee80211_alloc_hw(sizeof(*priv), &amp;my_ops);
	if (!hw)
		return -ENOMEM;

	priv = hw-&gt;priv;
	priv-&gt;pdev = pdev;

	/* Set hardware capabilities */
	hw-&gt;flags = IEEE80211_HW_SIGNAL_DBM |
		    IEEE80211_HW_AMPDU_AGGREGATION |
		    IEEE80211_HW_SUPPORTS_PS |
		    IEEE80211_HW_MFP_CAPABLE;

	hw-&gt;queues = 4;  /* Number of TX queues */
	hw-&gt;max_rates = 4;
	hw-&gt;max_rate_tries = 7;

	/* Set channel bands */
	hw-&gt;wiphy-&gt;bands[NL80211_BAND_2GHZ] = &amp;my_band_2ghz;
	hw-&gt;wiphy-&gt;bands[NL80211_BAND_5GHZ] = &amp;my_band_5ghz;

	/* Set supported interface modes */
	hw-&gt;wiphy-&gt;interface_modes =
		BIT(NL80211_IFTYPE_STATION) |
		BIT(NL80211_IFTYPE_AP) |
		BIT(NL80211_IFTYPE_P2P_CLIENT) |
		BIT(NL80211_IFTYPE_P2P_GO);

	/* Register hardware */
	ret = ieee80211_register_hw(hw);
	if (ret) {
		ieee80211_free_hw(hw);
		return ret;
	}

	return 0;
}
</code></pre>
<h3 id="tx-path-implementation"><a class="header" href="#tx-path-implementation">TX Path Implementation</a></h3>
<pre><code class="language-c">static void my_tx(struct ieee80211_hw *hw,
		  struct ieee80211_tx_control *control,
		  struct sk_buff *skb)
{
	struct my_priv *priv = hw-&gt;priv;
	struct ieee80211_tx_info *info = IEEE80211_SKB_CB(skb);
	struct ieee80211_hdr *hdr = (struct ieee80211_hdr *)skb-&gt;data;

	/* Get TX rate from mac80211 rate control */
	u8 rate_idx = info-&gt;control.rates[0].idx;

	/* Determine hardware queue */
	u8 queue = skb_get_queue_mapping(skb);

	/* Add hardware-specific TX descriptor */
	struct my_tx_desc *desc = (struct my_tx_desc *)skb_push(skb, sizeof(*desc));
	memset(desc, 0, sizeof(*desc));

	desc-&gt;rate = rate_idx;
	desc-&gt;retry_limit = info-&gt;control.rates[0].count;

	/* Handle encryption if needed */
	if (info-&gt;control.hw_key) {
		/* Hardware encryption */
		desc-&gt;key_idx = info-&gt;control.hw_key-&gt;hw_key_idx;
		desc-&gt;flags |= TX_FLAGS_ENCRYPT;
	}

	/* Submit to hardware TX queue */
	spin_lock_bh(&amp;priv-&gt;tx_lock);

	if (my_tx_queue_full(priv, queue)) {
		/* Queue full, stop mac80211 queue */
		ieee80211_stop_queue(hw, queue);
		spin_unlock_bh(&amp;priv-&gt;tx_lock);
		dev_kfree_skb_any(skb);
		return;
	}

	/* Add to DMA ring */
	my_tx_add_to_ring(priv, queue, skb);

	/* Kick hardware */
	my_tx_kick(priv, queue);

	spin_unlock_bh(&amp;priv-&gt;tx_lock);
}

/* TX completion interrupt handler */
static void my_tx_complete(struct my_priv *priv)
{
	struct ieee80211_hw *hw = priv-&gt;hw;
	struct sk_buff *skb;
	struct ieee80211_tx_info *info;
	u8 queue;

	while ((skb = my_get_completed_frame(priv, &amp;queue))) {
		info = IEEE80211_SKB_CB(skb);

		/* Fill in TX status */
		if (my_tx_was_successful(skb)) {
			info-&gt;flags |= IEEE80211_TX_STAT_ACK;
		}

		/* Remove hardware TX descriptor */
		skb_pull(skb, sizeof(struct my_tx_desc));

		/* Report to mac80211 */
		ieee80211_tx_status(hw, skb);

		/* Wake queue if needed */
		if (ieee80211_queue_stopped(hw, queue))
			ieee80211_wake_queue(hw, queue);
	}
}
</code></pre>
<h3 id="rx-path-implementation"><a class="header" href="#rx-path-implementation">RX Path Implementation</a></h3>
<pre><code class="language-c">static void my_rx_tasklet(unsigned long data)
{
	struct my_priv *priv = (struct my_priv *)data;
	struct ieee80211_hw *hw = priv-&gt;hw;
	struct sk_buff *skb;
	struct ieee80211_rx_status *rx_status;
	struct my_rx_desc *desc;

	while ((skb = my_get_rx_frame(priv))) {
		desc = (struct my_rx_desc *)skb-&gt;data;

		/* Allocate rx_status */
		rx_status = IEEE80211_SKB_RXCB(skb);
		memset(rx_status, 0, sizeof(*rx_status));

		/* Fill in RX status from hardware descriptor */
		rx_status-&gt;freq = ieee80211_channel_to_frequency(
					desc-&gt;channel,
					NL80211_BAND_2GHZ);
		rx_status-&gt;band = NL80211_BAND_2GHZ;
		rx_status-&gt;signal = desc-&gt;rssi;
		rx_status-&gt;rate_idx = desc-&gt;rate;
		rx_status-&gt;antenna = desc-&gt;antenna;

		/* Set flags */
		if (desc-&gt;flags &amp; RX_FLAG_SHORT_PREAMBLE)
			rx_status-&gt;flag |= RX_FLAG_SHORTPRE;

		if (desc-&gt;flags &amp; RX_FLAG_DECRYPTED) {
			rx_status-&gt;flag |= RX_FLAG_DECRYPTED;
			rx_status-&gt;flag |= RX_FLAG_IV_STRIPPED;
			rx_status-&gt;flag |= RX_FLAG_MMIC_STRIPPED;
		}

		/* Remove hardware RX descriptor */
		skb_pull(skb, sizeof(*desc));

		/* Pass to mac80211 */
		ieee80211_rx(hw, skb);
	}
}
</code></pre>
<hr />
<h2 id="driver-development"><a class="header" href="#driver-development">Driver Development</a></h2>
<h3 id="fullmac-driver-example"><a class="header" href="#fullmac-driver-example">FullMAC Driver Example</a></h3>
<p>FullMAC drivers implement their own MAC and only use cfg80211.</p>
<pre><code class="language-c">#include &lt;net/cfg80211.h&gt;

/* FullMAC driver - implements own MAC */
static int my_fullmac_scan(struct wiphy *wiphy,
			   struct cfg80211_scan_request *request)
{
	struct my_priv *priv = wiphy_priv(wiphy);
	int i;

	/* Send scan command to firmware */
	for (i = 0; i &lt; request-&gt;n_ssids; i++) {
		my_fw_scan_ssid(priv,
				request-&gt;ssids[i].ssid,
				request-&gt;ssids[i].ssid_len);
	}

	for (i = 0; i &lt; request-&gt;n_channels; i++) {
		my_fw_scan_channel(priv,
				   request-&gt;channels[i]-&gt;center_freq);
	}

	my_fw_start_scan(priv);

	return 0;
}

/* Firmware event: scan result */
static void my_handle_scan_result(struct my_priv *priv,
				   struct my_scan_result *result)
{
	struct wiphy *wiphy = priv-&gt;wiphy;
	struct cfg80211_bss *bss;
	struct ieee80211_channel *channel;
	struct cfg80211_inform_bss data = {};

	channel = ieee80211_get_channel(wiphy, result-&gt;frequency);
	if (!channel)
		return;

	/* Inform cfg80211 about BSS */
	bss = cfg80211_inform_bss_data(
		wiphy,
		&amp;data,
		CFG80211_BSS_FTYPE_UNKNOWN,
		result-&gt;bssid,
		result-&gt;tsf,
		result-&gt;capability,
		result-&gt;beacon_interval,
		result-&gt;ie,
		result-&gt;ie_len,
		result-&gt;signal,
		GFP_KERNEL);

	cfg80211_put_bss(wiphy, bss);
}

/* Firmware event: scan complete */
static void my_handle_scan_complete(struct my_priv *priv)
{
	struct cfg80211_scan_info info = {
		.aborted = false,
	};

	cfg80211_scan_done(priv-&gt;scan_request, &amp;info);
	priv-&gt;scan_request = NULL;
}

/* Connect */
static int my_fullmac_connect(struct wiphy *wiphy,
			      struct net_device *dev,
			      struct cfg80211_connect_params *sme)
{
	struct my_priv *priv = wiphy_priv(wiphy);

	/* Send connect command to firmware */
	my_fw_connect(priv,
		      sme-&gt;ssid, sme-&gt;ssid_len,
		      sme-&gt;bssid,
		      sme-&gt;channel,
		      sme-&gt;auth_type);

	return 0;
}

/* Firmware event: connected */
static void my_handle_connected(struct my_priv *priv)
{
	cfg80211_connect_result(priv-&gt;dev,
				priv-&gt;bssid,
				NULL, 0,
				NULL, 0,
				WLAN_STATUS_SUCCESS,
				GFP_KERNEL);
}

/* Firmware event: disconnected */
static void my_handle_disconnected(struct my_priv *priv, u16 reason)
{
	cfg80211_disconnected(priv-&gt;dev, reason, NULL, 0, true, GFP_KERNEL);
}
</code></pre>
<h3 id="softmac-driver-example"><a class="header" href="#softmac-driver-example">SoftMAC Driver Example</a></h3>
<p>SoftMAC drivers use mac80211 for MAC implementation.</p>
<pre><code class="language-c">#include &lt;net/mac80211.h&gt;

static int my_softmac_start(struct ieee80211_hw *hw)
{
	struct my_priv *priv = hw-&gt;priv;

	/* Power on hardware */
	my_hw_power_on(priv);

	/* Load firmware if needed */
	my_load_firmware(priv);

	/* Initialize hardware */
	my_hw_init(priv);

	/* Enable interrupts */
	my_enable_interrupts(priv);

	return 0;
}

static void my_softmac_stop(struct ieee80211_hw *hw)
{
	struct my_priv *priv = hw-&gt;priv;

	/* Disable interrupts */
	my_disable_interrupts(priv);

	/* Shutdown hardware */
	my_hw_shutdown(priv);

	/* Power off */
	my_hw_power_off(priv);
}

static int my_softmac_add_interface(struct ieee80211_hw *hw,
				    struct ieee80211_vif *vif)
{
	struct my_priv *priv = hw-&gt;priv;

	/* Set MAC address */
	my_hw_set_mac_address(priv, vif-&gt;addr);

	/* Set interface type */
	switch (vif-&gt;type) {
	case NL80211_IFTYPE_STATION:
		my_hw_set_mode(priv, MODE_STA);
		break;
	case NL80211_IFTYPE_AP:
		my_hw_set_mode(priv, MODE_AP);
		break;
	default:
		return -EOPNOTSUPP;
	}

	return 0;
}

static void my_softmac_bss_info_changed(struct ieee80211_hw *hw,
					struct ieee80211_vif *vif,
					struct ieee80211_bss_conf *info,
					u32 changed)
{
	struct my_priv *priv = hw-&gt;priv;

	if (changed &amp; BSS_CHANGED_BSSID) {
		/* BSSID changed */
		my_hw_set_bssid(priv, info-&gt;bssid);
	}

	if (changed &amp; BSS_CHANGED_ASSOC) {
		if (info-&gt;assoc) {
			/* Associated */
			my_hw_set_associated(priv, true);
			my_hw_set_aid(priv, info-&gt;aid);
		} else {
			/* Disassociated */
			my_hw_set_associated(priv, false);
		}
	}

	if (changed &amp; BSS_CHANGED_BEACON_INT) {
		/* Beacon interval changed */
		my_hw_set_beacon_interval(priv, info-&gt;beacon_int);
	}

	if (changed &amp; BSS_CHANGED_ERP_CTS_PROT) {
		/* CTS protection changed */
		my_hw_set_cts_protection(priv, info-&gt;use_cts_prot);
	}

	if (changed &amp; BSS_CHANGED_ERP_SLOT) {
		/* Slot time changed */
		my_hw_set_short_slot(priv, info-&gt;use_short_slot);
	}
}

static int my_softmac_config(struct ieee80211_hw *hw, u32 changed)
{
	struct my_priv *priv = hw-&gt;priv;
	struct ieee80211_conf *conf = &amp;hw-&gt;conf;

	if (changed &amp; IEEE80211_CONF_CHANGE_CHANNEL) {
		/* Channel changed */
		struct ieee80211_channel *chan = conf-&gt;chandef.chan;
		my_hw_set_channel(priv, chan-&gt;center_freq);
	}

	if (changed &amp; IEEE80211_CONF_CHANGE_POWER) {
		/* TX power changed */
		my_hw_set_tx_power(priv, conf-&gt;power_level);
	}

	if (changed &amp; IEEE80211_CONF_CHANGE_IDLE) {
		/* Idle state changed */
		if (conf-&gt;flags &amp; IEEE80211_CONF_IDLE)
			my_hw_enter_idle(priv);
		else
			my_hw_exit_idle(priv);
	}

	return 0;
}
</code></pre>
<hr />
<h2 id="nl80211"><a class="header" href="#nl80211">nl80211</a></h2>
<p>nl80211 is the netlink-based configuration interface for wireless devices.</p>
<h3 id="user-space-tools"><a class="header" href="#user-space-tools">User Space Tools</a></h3>
<pre><code class="language-bash"># iw - nl80211 configuration utility

# List wireless devices
iw dev

# Scan for networks
iw dev wlan0 scan

# Connect to network
iw dev wlan0 connect MyNetwork

# Set channel
iw dev wlan0 set channel 6

# Set TX power
iw dev wlan0 set txpower fixed 2000  # 20 dBm

# Create AP
iw dev wlan0 set type __ap
ip link set wlan0 up
iw dev wlan0 set channel 6

# Monitor mode
iw dev wlan0 set type monitor
ip link set wlan0 up

# Station info
iw dev wlan0 station dump

# Link statistics
iw dev wlan0 link

# Survey (channel usage)
iw dev wlan0 survey dump
</code></pre>
<h3 id="nl80211-in-code"><a class="header" href="#nl80211-in-code">nl80211 in Code</a></h3>
<pre><code class="language-c">#include &lt;net/nl80211.h&gt;

/* User space typically uses libnl */
#include &lt;netlink/netlink.h&gt;
#include &lt;netlink/genl/genl.h&gt;
#include &lt;netlink/genl/ctrl.h&gt;

/* Send scan request */
static int nl80211_scan(const char *ifname)
{
	struct nl_sock *sk;
	struct nl_msg *msg;
	int ret, family_id;

	sk = nl_socket_alloc();
	genl_connect(sk);

	family_id = genl_ctrl_resolve(sk, "nl80211");

	msg = nlmsg_alloc();
	genlmsg_put(msg, 0, 0, family_id, 0, 0, NL80211_CMD_TRIGGER_SCAN, 0);

	nla_put_u32(msg, NL80211_ATTR_IFINDEX, if_nametoindex(ifname));

	ret = nl_send_auto(sk, msg);
	nlmsg_free(msg);

	nl_socket_free(sk);

	return ret;
}
</code></pre>
<hr />
<h2 id="regulatory-framework"><a class="header" href="#regulatory-framework">Regulatory Framework</a></h2>
<p>The regulatory framework enforces regional wireless regulations.</p>
<h3 id="regulatory-database"><a class="header" href="#regulatory-database">Regulatory Database</a></h3>
<pre><code class="language-c">/* Regulatory domain definition */
static const struct ieee80211_regdomain my_regdom = {
	.n_reg_rules = 2,
	.alpha2 = "US",
	.reg_rules = {
		/* 2.4 GHz */
		REG_RULE(2412-10, 2462+10, 40, 6, 20, 0),
		/* 5 GHz */
		REG_RULE(5180-10, 5320+10, 160, 6, 23, 0),
	}
};

/* Set regulatory domain */
static void my_set_regdom(struct wiphy *wiphy)
{
	regulatory_hint(wiphy, "US");
}

/* Regulatory notifier */
static void my_reg_notifier(struct wiphy *wiphy,
			    struct regulatory_request *request)
{
	struct my_priv *priv = wiphy_priv(wiphy);

	pr_info("Regulatory domain: %c%c\n",
		request-&gt;alpha2[0], request-&gt;alpha2[1]);

	/* Update hardware with new regulatory settings */
	my_hw_update_regulatory(priv, request);
}
</code></pre>
<h3 id="country-ie-handling"><a class="header" href="#country-ie-handling">Country IE Handling</a></h3>
<pre><code class="language-c">/* Parse country IE from beacon */
static void my_parse_country_ie(struct my_priv *priv,
				const u8 *country_ie, size_t len)
{
	char alpha2[2];
	struct ieee80211_regdomain *rd;

	if (len &lt; 6)
		return;

	/* Extract country code */
	alpha2[0] = country_ie[0];
	alpha2[1] = country_ie[1];

	/* Hint regulatory domain */
	regulatory_hint(priv-&gt;wiphy, alpha2);
}
</code></pre>
<hr />
<h2 id="power-management-2"><a class="header" href="#power-management-2">Power Management</a></h2>
<h3 id="station-power-save"><a class="header" href="#station-power-save">Station Power Save</a></h3>
<pre><code class="language-c">/* Enable power save */
static int my_set_power_mgmt(struct wiphy *wiphy,
			     struct net_device *dev,
			     bool enabled, int timeout)
{
	struct my_priv *priv = wiphy_priv(wiphy);

	if (enabled) {
		my_hw_enable_power_save(priv);
		my_hw_set_ps_timeout(priv, timeout);
	} else {
		my_hw_disable_power_save(priv);
	}

	return 0;
}

/* Handle beacon from AP (in power save mode) */
static void my_handle_beacon(struct my_priv *priv, struct sk_buff *skb)
{
	struct ieee80211_mgmt *mgmt = (void *)skb-&gt;data;
	u8 *tim_ie;
	bool has_buffered;

	/* Find TIM IE */
	tim_ie = my_find_ie(mgmt-&gt;u.beacon.variable,
			    skb-&gt;len - offsetof(struct ieee80211_mgmt,
						u.beacon.variable),
			    WLAN_EID_TIM);

	if (!tim_ie)
		return;

	/* Check if AP has buffered frames */
	has_buffered = my_check_tim(tim_ie, priv-&gt;aid);

	if (has_buffered) {
		/* Send PS-Poll to retrieve frames */
		my_send_pspoll(priv);
	}
}
</code></pre>
<h3 id="ap-power-save"><a class="header" href="#ap-power-save">AP Power Save</a></h3>
<pre><code class="language-c">/* Client entered power save */
static void my_sta_ps_start(struct my_priv *priv, struct ieee80211_sta *sta)
{
	/* Mark station as sleeping */
	set_sta_flag(sta, WLAN_STA_PS_STA);

	/* Queue frames instead of transmitting */
}

/* Client exited power save */
static void my_sta_ps_end(struct my_priv *priv, struct ieee80211_sta *sta)
{
	/* Mark station as awake */
	clear_sta_flag(sta, WLAN_STA_PS_STA);

	/* Transmit buffered frames */
	my_deliver_buffered_frames(priv, sta);
}
</code></pre>
<hr />
<h2 id="scanning"><a class="header" href="#scanning">Scanning</a></h2>
<h3 id="active-scan"><a class="header" href="#active-scan">Active Scan</a></h3>
<pre><code class="language-c">/* Send probe request */
static void my_send_probe_req(struct my_priv *priv,
			      const u8 *ssid, size_t ssid_len,
			      u32 freq)
{
	struct sk_buff *skb;
	struct ieee80211_mgmt *mgmt;
	u8 *pos;

	skb = dev_alloc_skb(200);
	mgmt = (struct ieee80211_mgmt *)skb_put(skb,
		offsetof(struct ieee80211_mgmt, u.probe_req.variable));

	/* Fill in header */
	mgmt-&gt;frame_control = cpu_to_le16(IEEE80211_FTYPE_MGMT |
					  IEEE80211_STYPE_PROBE_REQ);
	eth_broadcast_addr(mgmt-&gt;da);
	memcpy(mgmt-&gt;sa, priv-&gt;mac_addr, ETH_ALEN);
	eth_broadcast_addr(mgmt-&gt;bssid);

	/* Add SSID IE */
	pos = skb_put(skb, 2 + ssid_len);
	*pos++ = WLAN_EID_SSID;
	*pos++ = ssid_len;
	memcpy(pos, ssid, ssid_len);

	/* Add supported rates IE */
	/* ... */

	/* Transmit */
	my_tx_mgmt_frame(priv, skb, freq);
}
</code></pre>
<h3 id="passive-scan"><a class="header" href="#passive-scan">Passive Scan</a></h3>
<pre><code class="language-c">/* Listen for beacons on channel */
static void my_passive_scan_channel(struct my_priv *priv, u32 freq)
{
	/* Switch to channel */
	my_hw_set_channel(priv, freq);

	/* Wait for beacons (typically 100-200ms per channel) */
	msleep(100);

	/* Process received beacons in RX handler */
}
</code></pre>
<hr />
<h2 id="connection-management"><a class="header" href="#connection-management">Connection Management</a></h2>
<h3 id="station-connection-flow"><a class="header" href="#station-connection-flow">Station Connection Flow</a></h3>
<pre><code class="language-c">/* 1. Authentication */
static int my_authenticate(struct my_priv *priv,
			   const u8 *bssid,
			   enum nl80211_auth_type auth_type)
{
	struct sk_buff *skb;
	struct ieee80211_mgmt *mgmt;

	skb = dev_alloc_skb(256);
	mgmt = (struct ieee80211_mgmt *)skb_put(skb,
		offsetof(struct ieee80211_mgmt, u.auth.variable));

	mgmt-&gt;frame_control = cpu_to_le16(IEEE80211_FTYPE_MGMT |
					  IEEE80211_STYPE_AUTH);
	memcpy(mgmt-&gt;da, bssid, ETH_ALEN);
	memcpy(mgmt-&gt;sa, priv-&gt;mac_addr, ETH_ALEN);
	memcpy(mgmt-&gt;bssid, bssid, ETH_ALEN);

	mgmt-&gt;u.auth.auth_alg = cpu_to_le16(auth_type);
	mgmt-&gt;u.auth.auth_transaction = cpu_to_le16(1);
	mgmt-&gt;u.auth.status_code = 0;

	my_tx_mgmt_frame(priv, skb, priv-&gt;channel_freq);

	return 0;
}

/* 2. Handle authentication response */
static void my_handle_auth_resp(struct my_priv *priv, struct sk_buff *skb)
{
	struct ieee80211_mgmt *mgmt = (void *)skb-&gt;data;
	u16 status = le16_to_cpu(mgmt-&gt;u.auth.status_code);

	if (status == WLAN_STATUS_SUCCESS) {
		/* Authenticated, proceed to association */
		cfg80211_tx_mlme_mgmt(priv-&gt;dev, skb-&gt;data, skb-&gt;len);
		my_associate(priv, mgmt-&gt;bssid);
	} else {
		cfg80211_tx_mlme_mgmt(priv-&gt;dev, skb-&gt;data, skb-&gt;len);
	}
}

/* 3. Association */
static int my_associate(struct my_priv *priv, const u8 *bssid)
{
	struct sk_buff *skb;
	struct ieee80211_mgmt *mgmt;
	u8 *pos;

	skb = dev_alloc_skb(512);
	mgmt = (struct ieee80211_mgmt *)skb_put(skb,
		offsetof(struct ieee80211_mgmt, u.assoc_req.variable));

	mgmt-&gt;frame_control = cpu_to_le16(IEEE80211_FTYPE_MGMT |
					  IEEE80211_STYPE_ASSOC_REQ);
	memcpy(mgmt-&gt;da, bssid, ETH_ALEN);
	memcpy(mgmt-&gt;sa, priv-&gt;mac_addr, ETH_ALEN);
	memcpy(mgmt-&gt;bssid, bssid, ETH_ALEN);

	mgmt-&gt;u.assoc_req.capab_info = cpu_to_le16(WLAN_CAPABILITY_ESS);
	mgmt-&gt;u.assoc_req.listen_interval = cpu_to_le16(10);

	pos = mgmt-&gt;u.assoc_req.variable;

	/* Add SSID IE */
	/* Add supported rates IE */
	/* Add HT capabilities IE */
	/* Add VHT capabilities IE */
	/* ... */

	my_tx_mgmt_frame(priv, skb, priv-&gt;channel_freq);

	return 0;
}

/* 4. Handle association response */
static void my_handle_assoc_resp(struct my_priv *priv, struct sk_buff *skb)
{
	struct ieee80211_mgmt *mgmt = (void *)skb-&gt;data;
	u16 status = le16_to_cpu(mgmt-&gt;u.assoc_resp.status_code);
	u16 aid = le16_to_cpu(mgmt-&gt;u.assoc_resp.aid);

	if (status == WLAN_STATUS_SUCCESS) {
		priv-&gt;aid = aid &amp; 0x3fff;
		cfg80211_connect_result(priv-&gt;dev,
					mgmt-&gt;bssid,
					NULL, 0, NULL, 0,
					status, GFP_KERNEL);
	} else {
		cfg80211_connect_result(priv-&gt;dev,
					mgmt-&gt;bssid,
					NULL, 0, NULL, 0,
					status, GFP_KERNEL);
	}
}
</code></pre>
<hr />
<h2 id="mesh-networking"><a class="header" href="#mesh-networking">Mesh Networking</a></h2>
<pre><code class="language-c">/* Start mesh interface */
static int my_join_mesh(struct wiphy *wiphy,
			struct net_device *dev,
			const struct mesh_config *conf,
			const struct mesh_setup *setup)
{
	struct my_priv *priv = wiphy_priv(wiphy);

	/* Set mesh ID */
	memcpy(priv-&gt;mesh_id, setup-&gt;mesh_id, setup-&gt;mesh_id_len);
	priv-&gt;mesh_id_len = setup-&gt;mesh_id_len;

	/* Enable mesh mode in hardware */
	my_hw_enable_mesh(priv);

	/* Start beaconing */
	my_start_mesh_beaconing(priv);

	return 0;
}

/* Handle mesh peering */
static void my_mesh_peer_open(struct my_priv *priv,
			      const u8 *peer_addr)
{
	/* Send peer link open frame */
	my_send_mesh_peering_frame(priv, peer_addr,
				    MESH_PEERING_OPEN);
}
</code></pre>
<hr />
<h2 id="debugging-1"><a class="header" href="#debugging-1">Debugging</a></h2>
<h3 id="enable-cfg80211-debug"><a class="header" href="#enable-cfg80211-debug">Enable cfg80211 Debug</a></h3>
<pre><code class="language-bash"># Enable cfg80211 debug messages
echo 'module cfg80211 +p' &gt; /sys/kernel/debug/dynamic_debug/control

# Or at boot
cfg80211.debug=0xffffffff
</code></pre>
<h3 id="enable-mac80211-debug"><a class="header" href="#enable-mac80211-debug">Enable mac80211 Debug</a></h3>
<pre><code class="language-bash"># Enable mac80211 debug
echo 'module mac80211 +p' &gt; /sys/kernel/debug/dynamic_debug/control

# Or at module load
modprobe mac80211 debug=0xffffffff

# Debug categories (bitfield):
# 0x00000001 - INFO
# 0x00000002 - PS (power save)
# 0x00000004 - HT (high throughput)
# 0x00000008 - TX status
</code></pre>
<h3 id="driver-debug"><a class="header" href="#driver-debug">Driver Debug</a></h3>
<pre><code class="language-c">/* Use dev_dbg for driver messages */
dev_dbg(&amp;pdev-&gt;dev, "Channel: %d, Freq: %d\n", channel, freq);

/* Conditional debugging */
#ifdef DEBUG
#define my_dbg(fmt, ...) pr_debug(fmt, ##__VA_ARGS__)
#else
#define my_dbg(fmt, ...) no_printk(fmt, ##__VA_ARGS__)
#endif

/* Rate control debugging */
#ifdef CONFIG_MAC80211_RC_MINSTREL_DEBUGFS
/* Rate stats available in debugfs */
/* /sys/kernel/debug/ieee80211/phyX/netdev:wlanX/stations/&lt;MAC&gt;/rc_stats */
#endif
</code></pre>
<h3 id="useful-debugfs-entries"><a class="header" href="#useful-debugfs-entries">Useful debugfs Entries</a></h3>
<pre><code class="language-bash"># List all wireless devices
ls /sys/kernel/debug/ieee80211/

# Per-PHY info
cat /sys/kernel/debug/ieee80211/phy0/hwflags
cat /sys/kernel/debug/ieee80211/phy0/queues

# Per-netdev info
ls /sys/kernel/debug/ieee80211/phy0/netdev:wlan0/

# Station info
ls /sys/kernel/debug/ieee80211/phy0/netdev:wlan0/stations/

# Rate control stats
cat /sys/kernel/debug/ieee80211/phy0/netdev:wlan0/stations/&lt;MAC&gt;/rc_stats

# Reset stats
echo 1 &gt; /sys/kernel/debug/ieee80211/phy0/reset
</code></pre>
<h3 id="packet-capture"><a class="header" href="#packet-capture">Packet Capture</a></h3>
<pre><code class="language-bash"># Monitor mode for packet capture
iw dev wlan0 set type monitor
ip link set wlan0 up
iw dev wlan0 set channel 6

# Capture with tcpdump
tcpdump -i wlan0 -w capture.pcap

# Or with wireshark
wireshark -i wlan0 -k
</code></pre>
<hr />
<h2 id="best-practices-19"><a class="header" href="#best-practices-19">Best Practices</a></h2>
<h3 id="driver-development-1"><a class="header" href="#driver-development-1">Driver Development</a></h3>
<ol>
<li><strong>Use mac80211 when possible</strong>: Unless hardware has a full MAC, use mac80211</li>
<li><strong>Implement all required callbacks</strong>: Check return values</li>
<li><strong>Handle errors gracefully</strong>: Don't crash the kernel</li>
<li><strong>Test with multiple APs</strong>: Different vendors, security types</li>
<li><strong>Support monitor mode</strong>: Essential for debugging</li>
<li><strong>Implement regulatory</strong>: Country codes, power limits</li>
<li><strong>Handle race conditions</strong>: Use proper locking</li>
<li><strong>Clean up resources</strong>: On errors and removal</li>
</ol>
<h3 id="performance-2"><a class="header" href="#performance-2">Performance</a></h3>
<ol>
<li><strong>Enable hardware offloads</strong>: Encryption, aggregation</li>
<li><strong>Use DMA efficiently</strong>: Minimize CPU involvement</li>
<li><strong>Implement rate control</strong>: Or use mac80211's minstrel</li>
<li><strong>Support A-MPDU/A-MSDU</strong>: For high throughput</li>
<li><strong>Optimize interrupt handling</strong>: Use NAPI if possible</li>
<li><strong>Enable power save</strong>: For battery-powered devices</li>
</ol>
<h3 id="security-1"><a class="header" href="#security-1">Security</a></h3>
<ol>
<li><strong>Never trust user input</strong>: Validate all parameters</li>
<li><strong>Handle untrusted frames</strong>: Check lengths, types</li>
<li><strong>Implement hardware encryption</strong>: When available</li>
<li><strong>Support WPA3</strong>: Modern security standards</li>
<li><strong>Protect management frames</strong>: 802.11w (PMF)</li>
</ol>
<hr />
<h2 id="resources-4"><a class="header" href="#resources-4">Resources</a></h2>
<ul>
<li><strong>Kernel Documentation</strong>: <code>Documentation/networking/mac80211.rst</code></li>
<li><strong>cfg80211 header</strong>: <code>include/net/cfg80211.h</code></li>
<li><strong>mac80211 header</strong>: <code>include/net/mac80211.h</code></li>
<li><strong>nl80211 header</strong>: <code>include/uapi/linux/nl80211.h</code></li>
<li><strong>Example drivers</strong>: <code>drivers/net/wireless/</code>
<ul>
<li><code>ath/ath9k/</code> - mac80211 driver</li>
<li><code>broadcom/brcm80211/brcmfmac/</code> - FullMAC driver</li>
<li><code>intel/iwlwifi/</code> - Advanced mac80211 driver</li>
</ul>
</li>
<li><strong>iw tool source</strong>: <a href="https://git.kernel.org/pub/scm/linux/kernel/git/jberg/iw.git">https://git.kernel.org/pub/scm/linux/kernel/git/jberg/iw.git</a></li>
<li><strong>Regulatory database</strong>: <a href="https://git.kernel.org/pub/scm/linux/kernel/git/sforshee/wireless-regdb.git">https://git.kernel.org/pub/scm/linux/kernel/git/sforshee/wireless-regdb.git</a></li>
</ul>
<hr />
<p>cfg80211 and mac80211 provide a robust framework for wireless driver development in Linux, handling much of the complex 802.11 protocol logic so drivers can focus on hardware-specific operations.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ebpf-extended-berkeley-packet-filter"><a class="header" href="#ebpf-extended-berkeley-packet-filter">eBPF (Extended Berkeley Packet Filter)</a></h1>
<h2 id="table-of-contents-9"><a class="header" href="#table-of-contents-9">Table of Contents</a></h2>
<ol>
<li><a href="linux/ebpf.html#introduction">Introduction</a></li>
<li><a href="linux/ebpf.html#architecture">Architecture</a></li>
<li><a href="linux/ebpf.html#program-types">Program Types</a></li>
<li><a href="linux/ebpf.html#ebpf-maps">eBPF Maps</a></li>
<li><a href="linux/ebpf.html#development-tools">Development Tools</a></li>
<li><a href="linux/ebpf.html#writing-ebpf-programs">Writing eBPF Programs</a></li>
<li><a href="linux/ebpf.html#common-use-cases">Common Use Cases</a></li>
<li><a href="linux/ebpf.html#examples">Examples</a></li>
<li><a href="linux/ebpf.html#security-and-safety">Security and Safety</a></li>
<li><a href="linux/ebpf.html#debugging">Debugging</a></li>
<li><a href="linux/ebpf.html#resources">Resources</a></li>
</ol>
<hr />
<h2 id="introduction-1"><a class="header" href="#introduction-1">Introduction</a></h2>
<h3 id="what-is-ebpf"><a class="header" href="#what-is-ebpf">What is eBPF?</a></h3>
<p>eBPF (Extended Berkeley Packet Filter) is a revolutionary Linux kernel technology that allows running sandboxed programs in kernel space without changing kernel source code or loading kernel modules. It enables dynamic extension of kernel capabilities for networking, observability, security, and performance analysis.</p>
<h3 id="history"><a class="header" href="#history">History</a></h3>
<ul>
<li><strong>1992</strong>: Original BPF (Berkeley Packet Filter) created for packet filtering in BSD</li>
<li><strong>2014</strong>: eBPF introduced in Linux kernel 3.18, extending BPF beyond networking</li>
<li><strong>2016-Present</strong>: Rapid evolution with new program types, maps, and helper functions</li>
</ul>
<h3 id="key-features-2"><a class="header" href="#key-features-2">Key Features</a></h3>
<ul>
<li><strong>Safe</strong>: Verifier ensures programs are safe to run in kernel space</li>
<li><strong>Efficient</strong>: JIT compilation for native performance</li>
<li><strong>Dynamic</strong>: Load/unload programs without rebooting</li>
<li><strong>Programmable</strong>: Write custom kernel extensions in C/Rust</li>
<li><strong>Event-driven</strong>: Attach to kernel/user events without overhead when not triggered</li>
</ul>
<h3 id="use-cases"><a class="header" href="#use-cases">Use Cases</a></h3>
<ul>
<li>Network packet filtering and manipulation</li>
<li>Performance monitoring and profiling</li>
<li>Security enforcement and runtime protection</li>
<li>Tracing and observability</li>
<li>Load balancing and service mesh</li>
<li>Container networking</li>
</ul>
<hr />
<h2 id="architecture-1"><a class="header" href="#architecture-1">Architecture</a></h2>
<h3 id="ebpf-virtual-machine"><a class="header" href="#ebpf-virtual-machine">eBPF Virtual Machine</a></h3>
<p>eBPF programs run in a virtual machine within the kernel with:</p>
<ul>
<li><strong>11 64-bit registers</strong> (R0-R10)</li>
<li><strong>512-byte stack</strong></li>
<li><strong>RISC-like instruction set</strong> (similar to x86-64)</li>
<li><strong>Bounded loops</strong> (since kernel 5.3)</li>
</ul>
<pre><code>R0:  Return value from functions/exit value
R1-R5: Function arguments
R6-R9: Callee-saved registers
R10: Read-only frame pointer
</code></pre>
<h3 id="core-components-1"><a class="header" href="#core-components-1">Core Components</a></h3>
<h4 id="1-verifier"><a class="header" href="#1-verifier">1. Verifier</a></h4>
<ul>
<li>Static analysis of eBPF bytecode before loading</li>
<li>Ensures memory safety (no out-of-bounds access)</li>
<li>Validates control flow (no infinite loops, reachable code)</li>
<li>Checks register states and types</li>
<li>Limits program complexity</li>
</ul>
<h4 id="2-jit-compiler"><a class="header" href="#2-jit-compiler">2. JIT Compiler</a></h4>
<ul>
<li>Compiles eBPF bytecode to native machine code</li>
<li>Available for x86-64, ARM64, RISC-V, etc.</li>
<li>Provides near-native performance</li>
<li>Can be disabled (interpreter fallback)</li>
</ul>
<pre><code class="language-bash"># Enable JIT compiler
echo 1 &gt; /proc/sys/net/core/bpf_jit_enable

# Enable JIT debug (dump compiled code)
echo 2 &gt; /proc/sys/net/core/bpf_jit_enable
</code></pre>
<h4 id="3-helper-functions"><a class="header" href="#3-helper-functions">3. Helper Functions</a></h4>
<ul>
<li>Kernel functions callable from eBPF programs</li>
<li>Type-safe interfaces to kernel functionality</li>
<li>Examples: map operations, packet manipulation, time functions</li>
</ul>
<h4 id="4-maps-1"><a class="header" href="#4-maps-1">4. Maps</a></h4>
<ul>
<li>Data structures for sharing data between eBPF programs and user space</li>
<li>Persistent storage across program invocations</li>
<li>Various types: hash, array, ring buffer, etc.</li>
</ul>
<h3 id="attachment-points-hooks"><a class="header" href="#attachment-points-hooks">Attachment Points (Hooks)</a></h3>
<p>eBPF programs attach to kernel events:</p>
<ul>
<li><strong>Network</strong>: XDP, TC, socket operations, cgroups</li>
<li><strong>Tracing</strong>: kprobes, uprobes, tracepoints, USDT</li>
<li><strong>Security</strong>: LSM hooks, seccomp</li>
<li><strong>Cgroups</strong>: Device access, socket operations, sysctl</li>
</ul>
<hr />
<h2 id="program-types"><a class="header" href="#program-types">Program Types</a></h2>
<h3 id="xdp-express-data-path"><a class="header" href="#xdp-express-data-path">XDP (eXpress Data Path)</a></h3>
<p>Processes packets at the earliest point in the network stack (driver level).</p>
<p><strong>Use Cases</strong>: DDoS mitigation, load balancing, packet filtering</p>
<p><strong>Return Codes</strong>:</p>
<ul>
<li><code>XDP_DROP</code>: Drop packet</li>
<li><code>XDP_PASS</code>: Pass to network stack</li>
<li><code>XDP_TX</code>: Bounce packet back out same interface</li>
<li><code>XDP_REDIRECT</code>: Redirect to another interface</li>
<li><code>XDP_ABORTED</code>: Error, drop packet</li>
</ul>
<p><strong>Example Hook</strong>:</p>
<pre><code class="language-c">SEC("xdp")
int xdp_prog(struct xdp_md *ctx) {
    // Access packet data
    void *data_end = (void *)(long)ctx-&gt;data_end;
    void *data = (void *)(long)ctx-&gt;data;

    // Process packet
    return XDP_PASS;
}
</code></pre>
<h3 id="tc-traffic-control"><a class="header" href="#tc-traffic-control">TC (Traffic Control)</a></h3>
<p>Attaches to network queueing discipline (ingress/egress).</p>
<p><strong>Use Cases</strong>: QoS, traffic shaping, packet modification</p>
<p><strong>Attachment</strong>:</p>
<pre><code class="language-bash">tc qdisc add dev eth0 clsact
tc filter add dev eth0 ingress bpf da obj prog.o sec classifier
</code></pre>
<h3 id="tracepoints"><a class="header" href="#tracepoints">Tracepoints</a></h3>
<p>Static instrumentation points in the kernel.</p>
<p><strong>Advantages</strong>: Stable ABI, defined arguments
<strong>Locations</strong>: Scheduling, system calls, network events</p>
<pre><code class="language-c">SEC("tracepoint/syscalls/sys_enter_execve")
int trace_execve(struct trace_event_raw_sys_enter *ctx) {
    // Trace execve system call
    return 0;
}
</code></pre>
<h3 id="kprobeskretprobes"><a class="header" href="#kprobeskretprobes">Kprobes/Kretprobes</a></h3>
<p>Dynamic instrumentation of any kernel function.</p>
<p><strong>Kprobe</strong>: Execute at function entry
<strong>Kretprobe</strong>: Execute at function return</p>
<pre><code class="language-c">SEC("kprobe/tcp_connect")
int trace_tcp_connect(struct pt_regs *ctx) {
    // Hook tcp_connect function
    return 0;
}

SEC("kretprobe/tcp_connect")
int trace_tcp_connect_ret(struct pt_regs *ctx) {
    // Get return value
    int ret = PT_REGS_RC(ctx);
    return 0;
}
</code></pre>
<h3 id="uprobesuretprobes"><a class="header" href="#uprobesuretprobes">Uprobes/Uretprobes</a></h3>
<p>Dynamic instrumentation of user-space functions.</p>
<p><strong>Use Cases</strong>: Application profiling, library tracing</p>
<pre><code class="language-c">SEC("uprobe/usr/lib/libc.so.6:malloc")
int trace_malloc(struct pt_regs *ctx) {
    size_t size = PT_REGS_PARM1(ctx);
    return 0;
}
</code></pre>
<h3 id="socket-filters"><a class="header" href="#socket-filters">Socket Filters</a></h3>
<p>Filter and process socket data.</p>
<p><strong>Types</strong>:</p>
<ul>
<li><code>BPF_PROG_TYPE_SOCKET_FILTER</code>: Classic socket filtering</li>
<li><code>BPF_PROG_TYPE_SOCK_OPS</code>: Socket operations monitoring</li>
<li><code>BPF_PROG_TYPE_SK_SKB</code>: Socket buffer redirection</li>
<li><code>BPF_PROG_TYPE_SK_MSG</code>: Socket message filtering</li>
</ul>
<h3 id="lsm-linux-security-module"><a class="header" href="#lsm-linux-security-module">LSM (Linux Security Module)</a></h3>
<p>Implement security policies using LSM hooks.</p>
<p><strong>Requirements</strong>: Kernel 5.7+, BPF LSM enabled</p>
<pre><code class="language-c">SEC("lsm/file_open")
int BPF_PROG(file_open, struct file *file) {
    // Implement access control
    return 0; // Allow
}
</code></pre>
<h3 id="other-program-types"><a class="header" href="#other-program-types">Other Program Types</a></h3>
<ul>
<li><strong>Cgroup programs</strong>: Control resource access per cgroup</li>
<li><strong>Perf event</strong>: Attach to performance monitoring events</li>
<li><strong>Raw tracepoints</strong>: Low-overhead tracing</li>
<li><strong>BTF-enabled programs</strong>: Type information for portability</li>
</ul>
<hr />
<h2 id="ebpf-maps"><a class="header" href="#ebpf-maps">eBPF Maps</a></h2>
<p>Maps are key-value data structures for storing state and communicating between eBPF programs and user space.</p>
<h3 id="map-types"><a class="header" href="#map-types">Map Types</a></h3>
<h4 id="bpf_map_type_hash"><a class="header" href="#bpf_map_type_hash">BPF_MAP_TYPE_HASH</a></h4>
<p>Hash table for arbitrary key-value pairs.</p>
<pre><code class="language-c">struct {
    __uint(type, BPF_MAP_TYPE_HASH);
    __uint(max_entries, 10000);
    __type(key, u32);
    __type(value, u64);
} my_hash_map SEC(".maps");
</code></pre>
<h4 id="bpf_map_type_array"><a class="header" href="#bpf_map_type_array">BPF_MAP_TYPE_ARRAY</a></h4>
<p>Fixed-size array indexed by integer.</p>
<pre><code class="language-c">struct {
    __uint(type, BPF_MAP_TYPE_ARRAY);
    __uint(max_entries, 256);
    __type(key, u32);
    __type(value, u64);
} my_array SEC(".maps");
</code></pre>
<h4 id="bpf_map_type_percpu_hash--percpu_array"><a class="header" href="#bpf_map_type_percpu_hash--percpu_array">BPF_MAP_TYPE_PERCPU_HASH / PERCPU_ARRAY</a></h4>
<p>Per-CPU variants for better performance (no locking).</p>
<pre><code class="language-c">struct {
    __uint(type, BPF_MAP_TYPE_PERCPU_ARRAY);
    __uint(max_entries, 256);
    __type(key, u32);
    __type(value, u64);
} percpu_stats SEC(".maps");
</code></pre>
<h4 id="bpf_map_type_ringbuf"><a class="header" href="#bpf_map_type_ringbuf">BPF_MAP_TYPE_RINGBUF</a></h4>
<p>Ring buffer for efficient kernel-to-user data streaming (kernel 5.8+).</p>
<pre><code class="language-c">struct {
    __uint(type, BPF_MAP_TYPE_RINGBUF);
    __uint(max_entries, 256 * 1024);
} events SEC(".maps");

// Reserve and submit
struct event *e = bpf_ringbuf_reserve(&amp;events, sizeof(*e), 0);
if (e) {
    e-&gt;pid = bpf_get_current_pid_tgid() &gt;&gt; 32;
    bpf_ringbuf_submit(e, 0);
}
</code></pre>
<h4 id="bpf_map_type_perf_event_array"><a class="header" href="#bpf_map_type_perf_event_array">BPF_MAP_TYPE_PERF_EVENT_ARRAY</a></h4>
<p>Per-CPU event buffers (older than ringbuf).</p>
<pre><code class="language-c">struct {
    __uint(type, BPF_MAP_TYPE_PERF_EVENT_ARRAY);
    __uint(key_size, sizeof(u32));
    __uint(value_size, sizeof(u32));
} events SEC(".maps");
</code></pre>
<h4 id="bpf_map_type_lru_hash"><a class="header" href="#bpf_map_type_lru_hash">BPF_MAP_TYPE_LRU_HASH</a></h4>
<p>Hash table with Least Recently Used eviction.</p>
<pre><code class="language-c">struct {
    __uint(type, BPF_MAP_TYPE_LRU_HASH);
    __uint(max_entries, 10000);
    __type(key, u32);
    __type(value, u64);
} lru_cache SEC(".maps");
</code></pre>
<h4 id="bpf_map_type_stack_trace"><a class="header" href="#bpf_map_type_stack_trace">BPF_MAP_TYPE_STACK_TRACE</a></h4>
<p>Store stack traces.</p>
<pre><code class="language-c">struct {
    __uint(type, BPF_MAP_TYPE_STACK_TRACE);
    __uint(max_entries, 1000);
    __type(key, u32);
    __type(value, u64[127]);
} stack_traces SEC(".maps");
</code></pre>
<h4 id="bpf_map_type_prog_array"><a class="header" href="#bpf_map_type_prog_array">BPF_MAP_TYPE_PROG_ARRAY</a></h4>
<p>Array of eBPF programs for tail calls.</p>
<pre><code class="language-c">struct {
    __uint(type, BPF_MAP_TYPE_PROG_ARRAY);
    __uint(max_entries, 10);
    __type(key, u32);
    __type(value, u32);
} prog_array SEC(".maps");

// Tail call
bpf_tail_call(ctx, &amp;prog_array, index);
</code></pre>
<h3 id="map-operations"><a class="header" href="#map-operations">Map Operations</a></h3>
<pre><code class="language-c">// Lookup
value = bpf_map_lookup_elem(&amp;my_map, &amp;key);

// Update
bpf_map_update_elem(&amp;my_map, &amp;key, &amp;value, BPF_ANY);

// Delete
bpf_map_delete_elem(&amp;my_map, &amp;key);
</code></pre>
<p><strong>Update Flags</strong>:</p>
<ul>
<li><code>BPF_ANY</code>: Create or update</li>
<li><code>BPF_NOEXIST</code>: Create only if doesn't exist</li>
<li><code>BPF_EXIST</code>: Update only if exists</li>
</ul>
<hr />
<h2 id="development-tools-1"><a class="header" href="#development-tools-1">Development Tools</a></h2>
<h3 id="bcc-bpf-compiler-collection"><a class="header" href="#bcc-bpf-compiler-collection">BCC (BPF Compiler Collection)</a></h3>
<p>Python/Lua framework for writing eBPF programs.</p>
<p><strong>Pros</strong>: High-level, rapid development, many examples
<strong>Cons</strong>: Runtime compilation, LLVM dependency on target</p>
<pre><code class="language-python">from bcc import BPF

prog = """
int hello(void *ctx) {
    bpf_trace_printk("Hello, World!\\n");
    return 0;
}
"""

b = BPF(text=prog)
b.attach_kprobe(event="sys_clone", fn_name="hello")
</code></pre>
<h3 id="libbpf"><a class="header" href="#libbpf">libbpf</a></h3>
<p>C library for loading and managing eBPF programs.</p>
<p><strong>Pros</strong>: No runtime dependencies, CO-RE support, production-ready
<strong>Cons</strong>: Lower-level, more boilerplate</p>
<pre><code class="language-c">struct bpf_object *obj;
struct bpf_program *prog;
struct bpf_link *link;

obj = bpf_object__open_file("prog.o", NULL);
bpf_object__load(obj);
prog = bpf_object__find_program_by_name(obj, "xdp_prog");
link = bpf_program__attach(prog);
</code></pre>
<h3 id="bpftool"><a class="header" href="#bpftool">bpftool</a></h3>
<p>Command-line tool for inspecting and managing eBPF programs/maps.</p>
<pre><code class="language-bash"># List programs
bpftool prog list

# Show program details
bpftool prog show id 123

# Dump program bytecode
bpftool prog dump xlated id 123

# List maps
bpftool map list

# Dump map contents
bpftool map dump id 456

# Load program
bpftool prog load prog.o /sys/fs/bpf/myprog

# Pin map
bpftool map pin id 456 /sys/fs/bpf/mymap
</code></pre>
<h3 id="ebpf-for-go"><a class="header" href="#ebpf-for-go">eBPF for Go</a></h3>
<pre><code class="language-go">import "github.com/cilium/ebpf"

spec, err := ebpf.LoadCollectionSpec("prog.o")
coll, err := ebpf.NewCollection(spec)
defer coll.Close()

prog := coll.Programs["xdp_prog"]
link, err := link.AttachXDP(link.XDPOptions{
    Program:   prog,
    Interface: iface.Index,
})
defer link.Close()
</code></pre>
<h3 id="other-tools"><a class="header" href="#other-tools">Other Tools</a></h3>
<ul>
<li><strong>Cilium</strong>: Container networking with eBPF</li>
<li><strong>Katran</strong>: Layer 4 load balancer (Facebook)</li>
<li><strong>Falco</strong>: Runtime security monitoring</li>
<li><strong>Pixie</strong>: Observability platform</li>
<li><strong>bpftrace</strong>: High-level tracing language</li>
</ul>
<hr />
<h2 id="writing-ebpf-programs"><a class="header" href="#writing-ebpf-programs">Writing eBPF Programs</a></h2>
<h3 id="development-workflow"><a class="header" href="#development-workflow">Development Workflow</a></h3>
<ol>
<li><strong>Write C code</strong> with eBPF program</li>
<li><strong>Compile to eBPF bytecode</strong> using Clang/LLVM</li>
<li><strong>Load into kernel</strong> using libbpf/BCC</li>
<li><strong>Attach to hook point</strong></li>
<li><strong>Communicate via maps</strong></li>
<li><strong>Unload/detach</strong> when done</li>
</ol>
<h3 id="basic-c-program-structure"><a class="header" href="#basic-c-program-structure">Basic C Program Structure</a></h3>
<pre><code class="language-c">#include &lt;linux/bpf.h&gt;
#include &lt;bpf/bpf_helpers.h&gt;

// Define map
struct {
    __uint(type, BPF_MAP_TYPE_HASH);
    __uint(max_entries, 1024);
    __type(key, u32);
    __type(value, u64);
} stats SEC(".maps");

// eBPF program
SEC("xdp")
int xdp_main(struct xdp_md *ctx) {
    u32 key = 0;
    u64 *count;

    count = bpf_map_lookup_elem(&amp;stats, &amp;key);
    if (count) {
        __sync_fetch_and_add(count, 1);
    }

    return XDP_PASS;
}

char LICENSE[] SEC("license") = "GPL";
</code></pre>
<h3 id="compilation"><a class="header" href="#compilation">Compilation</a></h3>
<pre><code class="language-bash"># Compile to eBPF bytecode
clang -O2 -g -target bpf -c prog.c -o prog.o

# With BTF (Type Information)
clang -O2 -g -target bpf -D__TARGET_ARCH_x86 \
    -I/usr/include/bpf -c prog.c -o prog.o
</code></pre>
<h3 id="co-re-compile-once---run-everywhere"><a class="header" href="#co-re-compile-once---run-everywhere">CO-RE (Compile Once - Run Everywhere)</a></h3>
<p><strong>Problem</strong>: Kernel data structures change across versions
<strong>Solution</strong>: BTF (BPF Type Format) + CO-RE relocations</p>
<pre><code class="language-c">#include &lt;vmlinux.h&gt;
#include &lt;bpf/bpf_core_read.h&gt;

SEC("kprobe/tcp_connect")
int trace_connect(struct pt_regs *ctx) {
    struct sock *sk = (struct sock *)PT_REGS_PARM1(ctx);
    u16 family;

    // CO-RE read - portable across kernel versions
    BPF_CORE_READ_INTO(&amp;family, sk, __sk_common.skc_family);

    return 0;
}
</code></pre>
<p><strong>Generate vmlinux.h</strong> (kernel type definitions):</p>
<pre><code class="language-bash">bpftool btf dump file /sys/kernel/btf/vmlinux format c &gt; vmlinux.h
</code></pre>
<h3 id="user-space-loader-libbpf"><a class="header" href="#user-space-loader-libbpf">User-Space Loader (libbpf)</a></h3>
<pre><code class="language-c">#include &lt;bpf/libbpf.h&gt;
#include &lt;bpf/bpf.h&gt;

int main() {
    struct bpf_object *obj;
    struct bpf_program *prog;
    int prog_fd, map_fd;

    // Open and load
    obj = bpf_object__open_file("prog.o", NULL);
    bpf_object__load(obj);

    // Get program
    prog = bpf_object__find_program_by_name(obj, "xdp_main");
    prog_fd = bpf_program__fd(prog);

    // Get map
    map_fd = bpf_object__find_map_fd_by_name(obj, "stats");

    // Attach (XDP example)
    int ifindex = if_nametoindex("eth0");
    bpf_xdp_attach(ifindex, prog_fd, XDP_FLAGS_UPDATE_IF_NOEXIST, NULL);

    // Read from map
    u32 key = 0;
    u64 value;
    bpf_map_lookup_elem(map_fd, &amp;key, &amp;value);
    printf("Count: %llu\n", value);

    // Cleanup
    bpf_xdp_detach(ifindex, XDP_FLAGS_UPDATE_IF_NOEXIST, NULL);
    bpf_object__close(obj);

    return 0;
}
</code></pre>
<p><strong>Compile user-space loader</strong>:</p>
<pre><code class="language-bash">gcc -o loader loader.c -lbpf -lelf -lz
</code></pre>
<hr />
<h2 id="common-use-cases-2"><a class="header" href="#common-use-cases-2">Common Use Cases</a></h2>
<h3 id="1-network-packet-filtering"><a class="header" href="#1-network-packet-filtering">1. Network Packet Filtering</a></h3>
<p><strong>XDP-based firewall</strong>:</p>
<ul>
<li>Drop malicious packets at driver level</li>
<li>Block by IP, port, protocol</li>
<li>DDoS mitigation</li>
</ul>
<h3 id="2-load-balancing"><a class="header" href="#2-load-balancing">2. Load Balancing</a></h3>
<p><strong>Layer 4 load balancing</strong>:</p>
<ul>
<li>Distribute connections across backends</li>
<li>Connection tracking</li>
<li>Health checks</li>
</ul>
<p><strong>Examples</strong>: Katran (Facebook), Cilium</p>
<h3 id="3-observability-and-tracing"><a class="header" href="#3-observability-and-tracing">3. Observability and Tracing</a></h3>
<p><strong>System call tracing</strong>:</p>
<ul>
<li>Monitor file access</li>
<li>Track network connections</li>
<li>Profile CPU usage</li>
</ul>
<p><strong>Tools</strong>: BCC tools (execsnoop, opensnoop, tcpconnect)</p>
<h3 id="4-security-monitoring"><a class="header" href="#4-security-monitoring">4. Security Monitoring</a></h3>
<p><strong>Runtime security</strong>:</p>
<ul>
<li>Detect malicious behavior</li>
<li>File integrity monitoring</li>
<li>Process ancestry tracking</li>
</ul>
<p><strong>Tools</strong>: Falco, Tracee</p>
<h3 id="5-performance-analysis"><a class="header" href="#5-performance-analysis">5. Performance Analysis</a></h3>
<p><strong>Profiling</strong>:</p>
<ul>
<li>CPU flame graphs</li>
<li>I/O latency</li>
<li>Memory allocation tracking</li>
</ul>
<h3 id="6-container-networking"><a class="header" href="#6-container-networking">6. Container Networking</a></h3>
<p><strong>CNI plugins</strong>:</p>
<ul>
<li>Pod networking</li>
<li>Network policies</li>
<li>Service mesh data plane</li>
</ul>
<p><strong>Examples</strong>: Cilium, Calico eBPF</p>
<h3 id="7-network-monitoring"><a class="header" href="#7-network-monitoring">7. Network Monitoring</a></h3>
<p><strong>Metrics collection</strong>:</p>
<ul>
<li>Packet counters</li>
<li>Bandwidth monitoring</li>
<li>Protocol analysis</li>
</ul>
<hr />
<h2 id="examples"><a class="header" href="#examples">Examples</a></h2>
<h3 id="example-1-packet-counter-xdp"><a class="header" href="#example-1-packet-counter-xdp">Example 1: Packet Counter (XDP)</a></h3>
<p><strong>prog.c</strong>:</p>
<pre><code class="language-c">#include &lt;linux/bpf.h&gt;
#include &lt;linux/if_ether.h&gt;
#include &lt;linux/ip.h&gt;
#include &lt;bpf/bpf_helpers.h&gt;

struct {
    __uint(type, BPF_MAP_TYPE_ARRAY);
    __uint(max_entries, 256);
    __type(key, u32);
    __type(value, u64);
} proto_count SEC(".maps");

SEC("xdp")
int count_packets(struct xdp_md *ctx) {
    void *data_end = (void *)(long)ctx-&gt;data_end;
    void *data = (void *)(long)ctx-&gt;data;

    struct ethhdr *eth = data;
    if ((void *)(eth + 1) &gt; data_end)
        return XDP_PASS;

    if (eth-&gt;h_proto != __constant_htons(ETH_P_IP))
        return XDP_PASS;

    struct iphdr *ip = (void *)(eth + 1);
    if ((void *)(ip + 1) &gt; data_end)
        return XDP_PASS;

    u32 key = ip-&gt;protocol;
    u64 *count = bpf_map_lookup_elem(&amp;proto_count, &amp;key);
    if (count)
        __sync_fetch_and_add(count, 1);

    return XDP_PASS;
}

char LICENSE[] SEC("license") = "GPL";
</code></pre>
<p><strong>Compile and load</strong>:</p>
<pre><code class="language-bash">clang -O2 -g -target bpf -c prog.c -o prog.o
ip link set dev eth0 xdp obj prog.o sec xdp
</code></pre>
<p><strong>Read stats</strong>:</p>
<pre><code class="language-bash">bpftool map dump name proto_count
</code></pre>
<h3 id="example-2-process-execution-tracer"><a class="header" href="#example-2-process-execution-tracer">Example 2: Process Execution Tracer</a></h3>
<p><strong>execsnoop.c</strong>:</p>
<pre><code class="language-c">#include &lt;vmlinux.h&gt;
#include &lt;bpf/bpf_helpers.h&gt;
#include &lt;bpf/bpf_core_read.h&gt;

struct event {
    u32 pid;
    char comm[16];
};

struct {
    __uint(type, BPF_MAP_TYPE_RINGBUF);
    __uint(max_entries, 256 * 1024);
} events SEC(".maps");

SEC("tracepoint/syscalls/sys_enter_execve")
int trace_execve(struct trace_event_raw_sys_enter *ctx) {
    struct event *e;

    e = bpf_ringbuf_reserve(&amp;events, sizeof(*e), 0);
    if (!e)
        return 0;

    e-&gt;pid = bpf_get_current_pid_tgid() &gt;&gt; 32;
    bpf_get_current_comm(&amp;e-&gt;comm, sizeof(e-&gt;comm));

    bpf_ringbuf_submit(e, 0);
    return 0;
}

char LICENSE[] SEC("license") = "GPL";
</code></pre>
<p><strong>User-space consumer</strong>:</p>
<pre><code class="language-c">#include &lt;bpf/libbpf.h&gt;
#include &lt;bpf/bpf.h&gt;

struct event {
    u32 pid;
    char comm[16];
};

int handle_event(void *ctx, void *data, size_t len) {
    struct event *e = data;
    printf("PID: %d, COMM: %s\n", e-&gt;pid, e-&gt;comm);
    return 0;
}

int main() {
    struct bpf_object *obj;
    struct ring_buffer *rb;
    int map_fd;

    obj = bpf_object__open_file("execsnoop.o", NULL);
    bpf_object__load(obj);

    map_fd = bpf_object__find_map_fd_by_name(obj, "events");
    rb = ring_buffer__new(map_fd, handle_event, NULL, NULL);

    while (1) {
        ring_buffer__poll(rb, 100);
    }

    return 0;
}
</code></pre>
<h3 id="example-3-tcp-connection-tracking"><a class="header" href="#example-3-tcp-connection-tracking">Example 3: TCP Connection Tracking</a></h3>
<p><strong>tcpconnect.c</strong>:</p>
<pre><code class="language-c">#include &lt;vmlinux.h&gt;
#include &lt;bpf/bpf_helpers.h&gt;
#include &lt;bpf/bpf_core_read.h&gt;

struct conn_event {
    u32 pid;
    u32 saddr;
    u32 daddr;
    u16 sport;
    u16 dport;
};

struct {
    __uint(type, BPF_MAP_TYPE_RINGBUF);
    __uint(max_entries, 256 * 1024);
} events SEC(".maps");

SEC("kprobe/tcp_connect")
int trace_connect(struct pt_regs *ctx) {
    struct sock *sk = (struct sock *)PT_REGS_PARM1(ctx);
    struct conn_event *e;
    u16 family;

    BPF_CORE_READ_INTO(&amp;family, sk, __sk_common.skc_family);
    if (family != AF_INET)
        return 0;

    e = bpf_ringbuf_reserve(&amp;events, sizeof(*e), 0);
    if (!e)
        return 0;

    e-&gt;pid = bpf_get_current_pid_tgid() &gt;&gt; 32;
    BPF_CORE_READ_INTO(&amp;e-&gt;saddr, sk, __sk_common.skc_rcv_saddr);
    BPF_CORE_READ_INTO(&amp;e-&gt;daddr, sk, __sk_common.skc_daddr);
    BPF_CORE_READ_INTO(&amp;e-&gt;sport, sk, __sk_common.skc_num);
    BPF_CORE_READ_INTO(&amp;e-&gt;dport, sk, __sk_common.skc_dport);
    e-&gt;dport = __bpf_ntohs(e-&gt;dport);

    bpf_ringbuf_submit(e, 0);
    return 0;
}

char LICENSE[] SEC("license") = "GPL";
</code></pre>
<h3 id="example-4-simple-lsm-hook"><a class="header" href="#example-4-simple-lsm-hook">Example 4: Simple LSM Hook</a></h3>
<p><strong>file_access.c</strong> (kernel 5.7+):</p>
<pre><code class="language-c">#include &lt;vmlinux.h&gt;
#include &lt;bpf/bpf_helpers.h&gt;
#include &lt;bpf/bpf_core_read.h&gt;

SEC("lsm/file_open")
int BPF_PROG(restrict_file_open, struct file *file, int ret) {
    const char *filename;
    char comm[16];
    char name[256];

    if (ret != 0)
        return ret;

    bpf_get_current_comm(&amp;comm, sizeof(comm));

    filename = BPF_CORE_READ(file, f_path.dentry, d_name.name);
    bpf_probe_read_kernel_str(name, sizeof(name), filename);

    // Block access to /etc/shadow for specific process
    if (__builtin_memcmp(name, "shadow", 6) == 0) {
        bpf_printk("Blocked access to %s by %s\n", name, comm);
        return -1; // EPERM
    }

    return 0;
}

char LICENSE[] SEC("license") = "GPL";
</code></pre>
<hr />
<h2 id="security-and-safety"><a class="header" href="#security-and-safety">Security and Safety</a></h2>
<h3 id="verifier-guarantees"><a class="header" href="#verifier-guarantees">Verifier Guarantees</a></h3>
<p>The eBPF verifier ensures:</p>
<ol>
<li>
<p><strong>Memory Safety</strong></p>
<ul>
<li>No out-of-bounds access</li>
<li>All memory access through pointers is validated</li>
<li>Null pointer checks required</li>
</ul>
</li>
<li>
<p><strong>Termination</strong></p>
<ul>
<li>Bounded loops (kernel 5.3+) or loop unrolling</li>
<li>No infinite loops</li>
<li>Limited complexity (instruction count)</li>
</ul>
</li>
<li>
<p><strong>No Undefined Behavior</strong></p>
<ul>
<li>All code paths return a value</li>
<li>No unreachable code</li>
<li>Register initialization checked</li>
</ul>
</li>
</ol>
<h3 id="verifier-checks"><a class="header" href="#verifier-checks">Verifier Checks</a></h3>
<pre><code class="language-c">// ❌ BAD: Unbounded loop (pre-5.3)
for (int i = 0; i &lt; n; i++) { }

// ✅ GOOD: Bounded loop
#pragma unroll
for (int i = 0; i &lt; 10; i++) { }

// ✅ GOOD: Bounded with verifier check (5.3+)
for (int i = 0; i &lt; n &amp;&amp; i &lt; 100; i++) { }
</code></pre>
<pre><code class="language-c">// ❌ BAD: Unchecked pointer
void *data = (void *)(long)ctx-&gt;data;
struct ethhdr *eth = data;
return eth-&gt;h_proto; // Verifier error!

// ✅ GOOD: Bounds check
void *data = (void *)(long)ctx-&gt;data;
void *data_end = (void *)(long)ctx-&gt;data_end;
struct ethhdr *eth = data;
if ((void *)(eth + 1) &gt; data_end)
    return XDP_DROP;
return eth-&gt;h_proto;
</code></pre>
<h3 id="required-capabilities"><a class="header" href="#required-capabilities">Required Capabilities</a></h3>
<p>Loading eBPF programs requires:</p>
<ul>
<li><code>CAP_BPF</code> (kernel 5.8+) for eBPF operations</li>
<li><code>CAP_PERFMON</code> for tracing programs</li>
<li><code>CAP_NET_ADMIN</code> for networking programs</li>
</ul>
<p><strong>Legacy</strong> (pre-5.8): <code>CAP_SYS_ADMIN</code> required</p>
<pre><code class="language-bash"># Grant specific capabilities
setcap cap_bpf,cap_perfmon,cap_net_admin+eip ./my_program
</code></pre>
<h3 id="unprivileged-ebpf"><a class="header" href="#unprivileged-ebpf">Unprivileged eBPF</a></h3>
<p>Limited eBPF for unprivileged users (disabled by default):</p>
<pre><code class="language-bash"># Enable (use with caution)
sysctl kernel.unprivileged_bpf_disabled=0

# Disable (recommended)
sysctl kernel.unprivileged_bpf_disabled=1
</code></pre>
<h3 id="restrictions"><a class="header" href="#restrictions">Restrictions</a></h3>
<ul>
<li>Limited helper functions (no arbitrary kernel memory access)</li>
<li>No direct kernel pointer access</li>
<li>Stack size limited to 512 bytes</li>
<li>Program size limits (1M instructions)</li>
<li>Map size limits (configurable)</li>
</ul>
<hr />
<h2 id="debugging-2"><a class="header" href="#debugging-2">Debugging</a></h2>
<h3 id="common-verifier-errors"><a class="header" href="#common-verifier-errors">Common Verifier Errors</a></h3>
<h4 id="1-invalid-memory-access"><a class="header" href="#1-invalid-memory-access">1. Invalid memory access</a></h4>
<pre><code>R0 invalid mem access 'inv'
</code></pre>
<p><strong>Solution</strong>: Add bounds checks before pointer dereference</p>
<h4 id="2-unreachable-instructions"><a class="header" href="#2-unreachable-instructions">2. Unreachable instructions</a></h4>
<pre><code>unreachable insn 123
</code></pre>
<p><strong>Solution</strong>: Ensure all code paths are reachable</p>
<h4 id="3-infinite-loop-detected"><a class="header" href="#3-infinite-loop-detected">3. Infinite loop detected</a></h4>
<pre><code>back-edge from insn 45 to 12
</code></pre>
<p><strong>Solution</strong>: Add loop bounds or use <code>#pragma unroll</code></p>
<h4 id="4-invalid-register-state"><a class="header" href="#4-invalid-register-state">4. Invalid register state</a></h4>
<pre><code>R1 !read_ok
</code></pre>
<p><strong>Solution</strong>: Initialize register before use</p>
<h3 id="debugging-techniques"><a class="header" href="#debugging-techniques">Debugging Techniques</a></h3>
<h4 id="1-bpf_printk-kernel-tracing"><a class="header" href="#1-bpf_printk-kernel-tracing">1. bpf_printk (Kernel Tracing)</a></h4>
<pre><code class="language-c">bpf_printk("Debug: value=%d\n", value);
</code></pre>
<p><strong>Read output</strong>:</p>
<pre><code class="language-bash">cat /sys/kernel/debug/tracing/trace_pipe
# or
bpftool prog tracelog
</code></pre>
<p><strong>Limitations</strong>:</p>
<ul>
<li>Limited format strings</li>
<li>Performance overhead</li>
<li>Max 3 arguments</li>
</ul>
<h4 id="2-bpftool-inspection"><a class="header" href="#2-bpftool-inspection">2. bpftool Inspection</a></h4>
<pre><code class="language-bash"># Dump translated bytecode
bpftool prog dump xlated id 123

# Dump JIT code
bpftool prog dump jited id 123

# Show verifier log
bpftool prog load prog.o /sys/fs/bpf/prog 2&gt;&amp;1 | less
</code></pre>
<h4 id="3-verbose-verifier-output"><a class="header" href="#3-verbose-verifier-output">3. Verbose Verifier Output</a></h4>
<pre><code class="language-c">// In user-space loader
LIBBPF_OPTS(bpf_object_open_opts, opts,
    .kernel_log_level = 1 | 2 | 4,  // Verbosity levels
);
obj = bpf_object__open_file("prog.o", &amp;opts);
</code></pre>
<p>Or with bpftool:</p>
<pre><code class="language-bash">bpftool -d prog load prog.o /sys/fs/bpf/prog
</code></pre>
<h4 id="4-map-debugging"><a class="header" href="#4-map-debugging">4. Map Debugging</a></h4>
<pre><code class="language-bash"># Dump all map entries
bpftool map dump id 123

# Update map entry
bpftool map update id 123 key 0 0 0 0 value 1 0 0 0 0 0 0 0

# Delete entry
bpftool map delete id 123 key 0 0 0 0
</code></pre>
<h4 id="5-statistics"><a class="header" href="#5-statistics">5. Statistics</a></h4>
<pre><code class="language-bash"># Enable statistics
bpftool feature probe kernel | grep stats
sysctl -w kernel.bpf_stats_enabled=1

# View program stats (run count, runtime)
bpftool prog show id 123
</code></pre>
<h3 id="performance-profiling"><a class="header" href="#performance-profiling">Performance Profiling</a></h3>
<h4 id="1-measure-program-runtime"><a class="header" href="#1-measure-program-runtime">1. Measure Program Runtime</a></h4>
<pre><code class="language-c">u64 start = bpf_ktime_get_ns();
// ... program logic ...
u64 duration = bpf_ktime_get_ns() - start;
</code></pre>
<h4 id="2-use-perf-with-ebpf"><a class="header" href="#2-use-perf-with-ebpf">2. Use perf with eBPF</a></h4>
<pre><code class="language-bash"># Profile eBPF program
perf record -e bpf:bpf_prog_run -a
perf report
</code></pre>
<h3 id="common-issues-3"><a class="header" href="#common-issues-3">Common Issues</a></h3>
<h4 id="issue-program-rejected-by-verifier"><a class="header" href="#issue-program-rejected-by-verifier">Issue: Program rejected by verifier</a></h4>
<ul>
<li><strong>Check</strong>: Verifier log for specific error</li>
<li><strong>Solutions</strong>: Add bounds checks, limit loop iterations, reduce complexity</li>
</ul>
<h4 id="issue-map-update-fails"><a class="header" href="#issue-map-update-fails">Issue: Map update fails</a></h4>
<ul>
<li><strong>Check</strong>: Map is full, wrong flags</li>
<li><strong>Solutions</strong>: Use LRU maps, increase size, check update flags</li>
</ul>
<h4 id="issue-helper-function-not-found"><a class="header" href="#issue-helper-function-not-found">Issue: Helper function not found</a></h4>
<ul>
<li><strong>Check</strong>: Kernel version, program type</li>
<li><strong>Solutions</strong>: Update kernel, use available helpers for program type</li>
</ul>
<h4 id="issue-btfco-re-errors"><a class="header" href="#issue-btfco-re-errors">Issue: BTF/CO-RE errors</a></h4>
<ul>
<li><strong>Check</strong>: BTF available (<code>/sys/kernel/btf/vmlinux</code>)</li>
<li><strong>Solutions</strong>: Enable CONFIG_DEBUG_INFO_BTF, use correct libbpf version</li>
</ul>
<hr />
<h2 id="resources-5"><a class="header" href="#resources-5">Resources</a></h2>
<h3 id="documentation-2"><a class="header" href="#documentation-2">Documentation</a></h3>
<ul>
<li><strong>Official eBPF Docs</strong>: https://ebpf.io/</li>
<li><strong>Kernel Documentation</strong>: https://www.kernel.org/doc/html/latest/bpf/</li>
<li><strong>BPF and XDP Reference Guide</strong>: https://docs.cilium.io/en/latest/bpf/</li>
<li><strong>libbpf Documentation</strong>: https://libbpf.readthedocs.io/</li>
</ul>
<h3 id="books-2"><a class="header" href="#books-2">Books</a></h3>
<ul>
<li><strong>"Learning eBPF"</strong> by Liz Rice (O'Reilly, 2023)</li>
<li><strong>"BPF Performance Tools"</strong> by Brendan Gregg (Addison-Wesley, 2019)</li>
<li><strong>"Linux Observability with BPF"</strong> by David Calavera &amp; Lorenzo Fontana (O'Reilly, 2019)</li>
</ul>
<h3 id="key-projects"><a class="header" href="#key-projects">Key Projects</a></h3>
<ul>
<li><strong>BCC</strong>: https://github.com/iovisor/bcc</li>
<li><strong>libbpf</strong>: https://github.com/libbpf/libbpf</li>
<li><strong>bpftool</strong>: https://github.com/libbpf/bpftool</li>
<li><strong>Cilium</strong>: https://github.com/cilium/cilium</li>
<li><strong>Katran</strong>: https://github.com/facebookincubator/katran</li>
<li><strong>Falco</strong>: https://github.com/falcosecurity/falco</li>
<li><strong>bpftrace</strong>: https://github.com/iovisor/bpftrace</li>
</ul>
<h3 id="example-collections"><a class="header" href="#example-collections">Example Collections</a></h3>
<ul>
<li><strong>BCC Tools</strong>: https://github.com/iovisor/bcc/tree/master/tools</li>
<li><strong>libbpf-bootstrap</strong>: https://github.com/libbpf/libbpf-bootstrap</li>
<li><strong>Linux kernel samples</strong>: https://github.com/torvalds/linux/tree/master/samples/bpf</li>
</ul>
<h3 id="community"><a class="header" href="#community">Community</a></h3>
<ul>
<li><strong>eBPF Summit</strong>: Annual conference</li>
<li><strong>eBPF Slack</strong>: https://ebpf.io/slack</li>
<li><strong>Mailing List</strong>: bpf@vger.kernel.org</li>
<li><strong>Reddit</strong>: r/ebpf</li>
</ul>
<h3 id="tutorials"><a class="header" href="#tutorials">Tutorials</a></h3>
<ul>
<li><strong>Cilium eBPF Tutorial</strong>: https://github.com/cilium/ebpf-tutorial</li>
<li><strong>XDP Hands-On Tutorial</strong>: https://github.com/xdp-project/xdp-tutorial</li>
<li><strong>libbpf-bootstrap Examples</strong>: Step-by-step guides</li>
</ul>
<h3 id="tools-and-utilities"><a class="header" href="#tools-and-utilities">Tools and Utilities</a></h3>
<pre><code class="language-bash"># Install development tools (Ubuntu/Debian)
apt install -y clang llvm libelf-dev libz-dev libbpf-dev \
    linux-tools-common linux-tools-generic bpftool

# Install BCC
apt install -y bpfcc-tools python3-bpfcc

# Install bpftrace
apt install -y bpftrace
</code></pre>
<hr />
<h2 id="quick-reference-2"><a class="header" href="#quick-reference-2">Quick Reference</a></h2>
<h3 id="common-commands"><a class="header" href="#common-commands">Common Commands</a></h3>
<pre><code class="language-bash"># List all eBPF programs
bpftool prog list

# List all maps
bpftool map list

# Show program by ID
bpftool prog show id &lt;ID&gt;

# Dump program bytecode
bpftool prog dump xlated id &lt;ID&gt;

# Pin program to filesystem
bpftool prog pin id &lt;ID&gt; /sys/fs/bpf/&lt;name&gt;

# Load program from object file
bpftool prog load prog.o /sys/fs/bpf/myprog

# Attach XDP program
ip link set dev &lt;iface&gt; xdp obj prog.o sec xdp

# Detach XDP program
ip link set dev &lt;iface&gt; xdp off

# Attach TC program
tc qdisc add dev &lt;iface&gt; clsact
tc filter add dev &lt;iface&gt; ingress bpf da obj prog.o

# View trace output
cat /sys/kernel/debug/tracing/trace_pipe
</code></pre>
<h3 id="helper-function-categories"><a class="header" href="#helper-function-categories">Helper Function Categories</a></h3>
<ul>
<li><strong>Map operations</strong>: <code>bpf_map_lookup_elem</code>, <code>bpf_map_update_elem</code>, <code>bpf_map_delete_elem</code></li>
<li><strong>Time</strong>: <code>bpf_ktime_get_ns</code>, <code>bpf_ktime_get_boot_ns</code></li>
<li><strong>Process/Thread</strong>: <code>bpf_get_current_pid_tgid</code>, <code>bpf_get_current_uid_gid</code>, <code>bpf_get_current_comm</code></li>
<li><strong>Tracing</strong>: <code>bpf_probe_read</code>, <code>bpf_probe_read_kernel</code>, <code>bpf_probe_read_user</code></li>
<li><strong>Networking</strong>: <code>bpf_skb_load_bytes</code>, <code>bpf_skb_store_bytes</code>, <code>bpf_xdp_adjust_head</code></li>
<li><strong>Output</strong>: <code>bpf_printk</code>, <code>bpf_perf_event_output</code>, <code>bpf_ringbuf_submit</code></li>
<li><strong>Stack</strong>: <code>bpf_get_stackid</code>, <code>bpf_get_stack</code></li>
</ul>
<h3 id="kernel-version-features"><a class="header" href="#kernel-version-features">Kernel Version Features</a></h3>
<ul>
<li><strong>3.18</strong> (2014): Initial eBPF support</li>
<li><strong>4.1</strong> (2015): BPF maps, tail calls</li>
<li><strong>4.4</strong> (2016): XDP support</li>
<li><strong>4.8</strong> (2016): Direct packet access</li>
<li><strong>4.18</strong> (2018): BTF (BPF Type Format)</li>
<li><strong>5.2</strong> (2019): Bounded loops support</li>
<li><strong>5.7</strong> (2020): LSM BPF programs</li>
<li><strong>5.8</strong> (2020): Ring buffer, <code>CAP_BPF</code></li>
<li><strong>5.13</strong> (2021): Kernel module function calls</li>
<li><strong>6.0</strong> (2022): Sleepable programs enhancements</li>
</ul>
<hr />
<p><strong>Last Updated</strong>: 2024
<strong>Kernel Version Coverage</strong>: Linux 3.18 - 6.x</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="essential-linux-commands-reference"><a class="header" href="#essential-linux-commands-reference">Essential Linux Commands Reference</a></h1>
<p>A comprehensive guide to essential Linux commands with examples, use cases, and practical tips.</p>
<h2 id="table-of-contents-10"><a class="header" href="#table-of-contents-10">Table of Contents</a></h2>
<ol>
<li><a href="linux/commands.html#file-system-navigation">File System Navigation</a></li>
<li><a href="linux/commands.html#file-operations">File Operations</a></li>
<li><a href="linux/commands.html#text-processing">Text Processing</a></li>
<li><a href="linux/commands.html#search-and-find">Search and Find</a></li>
<li><a href="linux/commands.html#process-management">Process Management</a></li>
<li><a href="linux/commands.html#system-monitoring">System Monitoring</a></li>
<li><a href="linux/commands.html#user-management">User Management</a></li>
<li><a href="linux/commands.html#permissions">Permissions</a></li>
<li><a href="linux/commands.html#package-management">Package Management</a></li>
<li><a href="linux/commands.html#network-commands">Network Commands</a></li>
<li><a href="linux/commands.html#service-management">Service Management</a></li>
<li><a href="linux/commands.html#compression">Compression</a></li>
<li><a href="linux/commands.html#disk-management">Disk Management</a></li>
<li><a href="linux/commands.html#system-information">System Information</a></li>
</ol>
<hr />
<h2 id="file-system-navigation"><a class="header" href="#file-system-navigation">File System Navigation</a></h2>
<h3 id="ls---list-directory-contents"><a class="header" href="#ls---list-directory-contents">ls - List Directory Contents</a></h3>
<pre><code class="language-bash"># Basic listing
ls                         # List files in current directory
ls -l                      # Long format with details
ls -a                      # Show hidden files
ls -lh                     # Human-readable sizes
ls -lah                    # Combine all above options
ls -R                      # Recursive listing
ls -lt                     # Sort by modification time
ls -lS                     # Sort by size

# Advanced usage
ls -i                      # Show inode numbers
ls -d */                   # List only directories
ls --color=auto            # Colored output
ls -ltr                    # Reverse time sort (oldest first)

# Examples
ls *.txt                   # List all .txt files
ls -l /var/log/            # List files in specific directory
ls -lh --sort=size         # Sort by size, human-readable
</code></pre>
<p><strong>Use Cases:</strong></p>
<ul>
<li>Quick directory overview</li>
<li>Check file permissions and ownership</li>
<li>Find recently modified files</li>
<li>Disk usage analysis</li>
</ul>
<h3 id="cd---change-directory"><a class="header" href="#cd---change-directory">cd - Change Directory</a></h3>
<pre><code class="language-bash">cd /path/to/directory      # Absolute path
cd relative/path           # Relative path
cd ..                      # Parent directory
cd ../..                   # Two levels up
cd -                       # Previous directory
cd ~                       # Home directory
cd                         # Home directory (shorthand)
cd ~username               # Another user's home

# Examples
cd /var/log                # Go to log directory
cd ~/Documents             # Go to Documents in home
cd -                       # Toggle between two directories
</code></pre>
<h3 id="pwd---print-working-directory"><a class="header" href="#pwd---print-working-directory">pwd - Print Working Directory</a></h3>
<pre><code class="language-bash">pwd                        # Show current directory
pwd -P                     # Show physical directory (resolve symlinks)
</code></pre>
<hr />
<h2 id="file-operations-1"><a class="header" href="#file-operations-1">File Operations</a></h2>
<h3 id="cp---copy-files"><a class="header" href="#cp---copy-files">cp - Copy Files</a></h3>
<pre><code class="language-bash"># Basic copying
cp source.txt dest.txt     # Copy file
cp file1 file2 dir/        # Copy multiple files to directory
cp -r dir1/ dir2/          # Copy directory recursively
cp -i file dest            # Interactive (prompt before overwrite)
cp -v file dest            # Verbose output
cp -u file dest            # Update (copy only if newer)

# Advanced options
cp -p file dest            # Preserve attributes (mode, ownership, timestamps)
cp -a dir1/ dir2/          # Archive mode (recursive + preserve)
cp --backup file dest      # Create backup before overwriting

# Examples
cp /etc/config ~/.config/  # Copy config file to home
cp -r /var/www/* /backup/  # Backup web directory
cp -av src/ dest/          # Full directory copy with attributes
</code></pre>
<h3 id="mv---moverename-files"><a class="header" href="#mv---moverename-files">mv - Move/Rename Files</a></h3>
<pre><code class="language-bash"># Basic move/rename
mv old.txt new.txt         # Rename file
mv file.txt dir/           # Move file to directory
mv file1 file2 dir/        # Move multiple files
mv -i file dest            # Interactive mode
mv -v file dest            # Verbose output

# Examples
mv *.log /var/log/         # Move all log files
mv -n file dest            # No overwrite
mv --backup=numbered f d   # Numbered backups
</code></pre>
<h3 id="rm---remove-files"><a class="header" href="#rm---remove-files">rm - Remove Files</a></h3>
<pre><code class="language-bash"># Basic removal
rm file.txt                # Remove file
rm -r directory/           # Remove directory recursively
rm -f file                 # Force removal (no confirmation)
rm -rf directory/          # Force remove directory
rm -i file                 # Interactive (ask before removal)
rm -v file                 # Verbose output

# Safe practices
rm -I files*               # Prompt once before removing many files
rm -d emptydir/            # Remove empty directory only

# Examples
rm *.tmp                   # Remove all .tmp files
rm -rf /tmp/session*       # Force remove temp sessions
find . -name "*.bak" -delete  # Alternative: safer removal
</code></pre>
<p><strong>Warning:</strong> Use <code>rm -rf</code> with extreme caution!</p>
<h3 id="mkdir---make-directories"><a class="header" href="#mkdir---make-directories">mkdir - Make Directories</a></h3>
<pre><code class="language-bash">mkdir newdir               # Create directory
mkdir -p path/to/dir       # Create parent directories
mkdir -m 755 dir           # Set permissions
mkdir -v dir               # Verbose output

# Examples
mkdir -p project/{src,bin,doc}  # Create multiple directories
mkdir -p ~/backup/$(date +%Y-%m-%d)  # Date-based backup dir
</code></pre>
<h3 id="touch---createupdate-files"><a class="header" href="#touch---createupdate-files">touch - Create/Update Files</a></h3>
<pre><code class="language-bash">touch file.txt             # Create empty file or update timestamp
touch -c file              # No create (only update if exists)
touch -t 202301011200 file # Set specific timestamp
touch -d "2023-01-01" file # Set date

# Examples
touch {1..10}.txt          # Create multiple files
touch -r ref.txt new.txt   # Copy timestamp from reference
</code></pre>
<hr />
<h2 id="text-processing-1"><a class="header" href="#text-processing-1">Text Processing</a></h2>
<h3 id="cat---concatenate-and-display"><a class="header" href="#cat---concatenate-and-display">cat - Concatenate and Display</a></h3>
<pre><code class="language-bash">cat file.txt               # Display file contents
cat file1 file2            # Concatenate multiple files
cat &gt; file.txt             # Create file from stdin (Ctrl+D to end)
cat &gt;&gt; file.txt            # Append to file
cat -n file.txt            # Number all lines
cat -b file.txt            # Number non-blank lines
cat -s file.txt            # Squeeze multiple blank lines

# Examples
cat /etc/passwd            # View user accounts
cat file1 file2 &gt; combined # Combine files
cat /dev/null &gt; file.txt   # Empty a file
</code></pre>
<h3 id="grep---search-text-patterns"><a class="header" href="#grep---search-text-patterns">grep - Search Text Patterns</a></h3>
<pre><code class="language-bash"># Basic search
grep "pattern" file.txt    # Search for pattern
grep -i "pattern" file     # Case-insensitive
grep -v "pattern" file     # Invert match (exclude)
grep -r "pattern" dir/     # Recursive search
grep -n "pattern" file     # Show line numbers
grep -c "pattern" file     # Count matches

# Advanced options
grep -w "word" file        # Match whole words only
grep -A 3 "pattern" file   # Show 3 lines after match
grep -B 3 "pattern" file   # Show 3 lines before match
grep -C 3 "pattern" file   # Show 3 lines context
grep -l "pattern" files*   # List filenames only
grep -E "regex" file       # Extended regex (or egrep)

# Regular expressions
grep "^start" file         # Lines starting with "start"
grep "end$" file           # Lines ending with "end"
grep "^$" file             # Empty lines
grep "[0-9]\{3\}" file     # Three consecutive digits

# Examples
grep -r "TODO" ~/code/     # Find all TODOs in code
grep -i "error" /var/log/*.log  # Find errors in logs
ps aux | grep nginx        # Find nginx processes
grep -v "^#" config.txt    # Show non-comment lines
netstat -tulpn | grep :80  # Find what's using port 80
</code></pre>
<p><strong>Use Cases:</strong></p>
<ul>
<li>Log file analysis</li>
<li>Finding specific code patterns</li>
<li>Filtering command output</li>
<li>Configuration file parsing</li>
</ul>
<h3 id="sed---stream-editor"><a class="header" href="#sed---stream-editor">sed - Stream Editor</a></h3>
<pre><code class="language-bash"># Basic substitution
sed 's/old/new/' file      # Replace first occurrence per line
sed 's/old/new/g' file     # Replace all occurrences
sed 's/old/new/gi' file    # Case-insensitive global replace
sed -i 's/old/new/g' file  # In-place editing
sed -i.bak 's/old/new/g' file  # In-place with backup

# Line operations
sed -n '5p' file           # Print line 5
sed -n '1,5p' file         # Print lines 1-5
sed '5d' file              # Delete line 5
sed '/pattern/d' file      # Delete lines matching pattern
sed '1,3d' file            # Delete lines 1-3

# Advanced usage
sed '/pattern/s/old/new/' file  # Replace only in matching lines
sed 's/^/  /' file         # Add 2 spaces at start of each line
sed 's/$/\r/' file         # Convert to DOS line endings
sed '/^$/d' file           # Remove empty lines

# Examples
sed 's/localhost/127.0.0.1/g' config  # Replace hostname
sed -n '/ERROR/,/END/p' log    # Print between patterns
sed '/#/d' file                # Remove comment lines
sed 's/\t/ /g' file            # Replace tabs with spaces
</code></pre>
<h3 id="awk---text-processing-language"><a class="header" href="#awk---text-processing-language">awk - Text Processing Language</a></h3>
<pre><code class="language-bash"># Basic usage
awk '{print}' file         # Print all lines
awk '{print $1}' file      # Print first column
awk '{print $1,$3}' file   # Print columns 1 and 3
awk '{print $NF}' file     # Print last column
awk '{print NR,$0}' file   # Print line numbers

# Field separator
awk -F: '{print $1}' /etc/passwd  # Custom delimiter
awk -F',' '{print $2}' data.csv   # CSV parsing

# Patterns and conditions
awk '/pattern/' file       # Print lines matching pattern
awk '$3 &gt; 100' file        # Print if column 3 &gt; 100
awk 'NR==5' file           # Print line 5
awk 'NR&gt;=5 &amp;&amp; NR&lt;=10' file # Print lines 5-10
awk 'length($0) &gt; 80' file # Print lines longer than 80 chars

# Calculations
awk '{sum+=$1} END {print sum}' file  # Sum first column
awk '{print $1*$2}' file   # Multiply columns 1 and 2

# Examples
awk -F: '{print $1}' /etc/passwd  # List usernames
ps aux | awk '{print $2,$11}'  # Print PID and command
df -h | awk '$5+0 &gt; 80 {print $0}'  # Disk usage &gt; 80%
netstat -an | awk '/ESTABLISHED/ {print $5}'  # Connected IPs
awk '{sum+=$1} END {print sum/NR}' data  # Average of column 1
</code></pre>
<p><strong>Use Cases:</strong></p>
<ul>
<li>Log parsing and analysis</li>
<li>Data extraction from structured text</li>
<li>Quick calculations on columns</li>
<li>Report generation</li>
</ul>
<h3 id="head---display-beginning-of-file"><a class="header" href="#head---display-beginning-of-file">head - Display Beginning of File</a></h3>
<pre><code class="language-bash">head file.txt              # First 10 lines
head -n 20 file.txt        # First 20 lines
head -c 100 file.txt       # First 100 bytes
head -n -5 file.txt        # All but last 5 lines

# Examples
head -n 1 *.txt            # First line of each file
head /var/log/syslog       # Quick log preview
</code></pre>
<h3 id="tail---display-end-of-file"><a class="header" href="#tail---display-end-of-file">tail - Display End of File</a></h3>
<pre><code class="language-bash">tail file.txt              # Last 10 lines
tail -n 20 file.txt        # Last 20 lines
tail -f file.txt           # Follow file (live updates)
tail -F file.txt           # Follow with retry (if rotated)
tail -n +5 file.txt        # From line 5 to end

# Examples
tail -f /var/log/syslog    # Monitor system log
tail -n 100 -f app.log     # Follow last 100 lines
tail -f log | grep ERROR   # Filter live log stream
</code></pre>
<h3 id="sort---sort-lines"><a class="header" href="#sort---sort-lines">sort - Sort Lines</a></h3>
<pre><code class="language-bash">sort file.txt              # Alphabetical sort
sort -r file.txt           # Reverse sort
sort -n file.txt           # Numeric sort
sort -u file.txt           # Unique lines only
sort -k 2 file.txt         # Sort by column 2
sort -t: -k3 -n /etc/passwd  # Numeric sort by field 3

# Examples
sort -t',' -k2 -n data.csv # Sort CSV by second column
ls -l | sort -k 5 -n       # Sort files by size
history | sort | uniq -c   # Find most used commands
</code></pre>
<h3 id="uniq---report-unique-lines"><a class="header" href="#uniq---report-unique-lines">uniq - Report Unique Lines</a></h3>
<pre><code class="language-bash">uniq file.txt              # Remove adjacent duplicates
uniq -c file.txt           # Count occurrences
uniq -d file.txt           # Show only duplicates
uniq -u file.txt           # Show only unique lines
uniq -i file.txt           # Case-insensitive

# Examples (usually with sort)
sort file.txt | uniq       # Remove all duplicates
sort file.txt | uniq -c | sort -rn  # Frequency count
</code></pre>
<hr />
<h2 id="search-and-find"><a class="header" href="#search-and-find">Search and Find</a></h2>
<h3 id="find---search-for-files"><a class="header" href="#find---search-for-files">find - Search for Files</a></h3>
<pre><code class="language-bash"># By name
find . -name "file.txt"    # Find by exact name
find . -iname "*.txt"      # Case-insensitive name
find /var -name "*.log"    # Find in specific directory

# By type
find . -type f             # Find files
find . -type d             # Find directories
find . -type l             # Find symbolic links

# By size
find . -size +100M         # Files larger than 100MB
find . -size -1k           # Files smaller than 1KB
find . -empty              # Empty files/directories

# By time
find . -mtime -7           # Modified in last 7 days
find . -atime +30          # Accessed more than 30 days ago
find . -ctime -1           # Changed in last 24 hours
find . -mmin -60           # Modified in last 60 minutes

# By permissions
find . -perm 777           # Exactly 777 permissions
find . -perm -644          # At least 644 permissions
find . -user root          # Owned by root
find . -group www-data     # Owned by www-data group

# Actions
find . -name "*.tmp" -delete  # Delete found files
find . -name "*.sh" -exec chmod +x {} \;  # Execute command
find . -type f -exec wc -l {} +  # Count lines

# Examples
find /home -user john -name "*.pdf"  # User's PDF files
find . -name "*.log" -mtime +30 -delete  # Delete old logs
find /var/www -type f -perm 777  # Find world-writable files
find . -size +50M -size -100M    # Files between 50-100MB
find . -name "*.js" -exec grep -l "TODO" {} \;  # Find TODOs
</code></pre>
<h3 id="locate---quick-file-search"><a class="header" href="#locate---quick-file-search">locate - Quick File Search</a></h3>
<pre><code class="language-bash">locate filename            # Quick search in database
locate -i filename         # Case-insensitive
locate -c pattern          # Count matches
locate -b '\filename'      # Exact basename match

# Update database
sudo updatedb              # Refresh locate database

# Examples
locate nginx.conf          # Find nginx config
locate -r '\.conf$'        # All .conf files
</code></pre>
<h3 id="which---locate-command"><a class="header" href="#which---locate-command">which - Locate Command</a></h3>
<pre><code class="language-bash">which python               # Find command path
which -a python            # Show all matches

# Examples
which docker               # Find Docker binary
type python                # Alternative (bash builtin)
</code></pre>
<h3 id="whereis---locate-binarysourcemanual"><a class="header" href="#whereis---locate-binarysourcemanual">whereis - Locate Binary/Source/Manual</a></h3>
<pre><code class="language-bash">whereis ls                 # Find binary, source, man page
whereis -b ls              # Binary only
whereis -m ls              # Manual only
whereis -s ls              # Source only
</code></pre>
<hr />
<h2 id="process-management-2"><a class="header" href="#process-management-2">Process Management</a></h2>
<h3 id="ps---process-status"><a class="header" href="#ps---process-status">ps - Process Status</a></h3>
<pre><code class="language-bash"># Basic usage
ps                         # Current shell processes
ps aux                     # All processes (BSD style)
ps -ef                     # All processes (System V style)
ps -u username             # User's processes
ps -p 1234                 # Specific process by PID

# Detailed view
ps aux | grep nginx        # Find specific process
ps auxf                    # Process tree (forest)
ps -eo pid,user,%cpu,%mem,cmd  # Custom columns
ps --sort=-%mem            # Sort by memory usage
ps -C nginx                # Processes by command name

# Examples
ps aux | head              # Top processes
ps -eo pid,ppid,cmd,%mem,%cpu --sort=-%cpu | head  # CPU hogs
ps -U www-data             # Web server processes
</code></pre>
<h3 id="top---interactive-process-viewer"><a class="header" href="#top---interactive-process-viewer">top - Interactive Process Viewer</a></h3>
<pre><code class="language-bash">top                        # Launch interactive viewer
top -u username            # Show user's processes
top -p 1234                # Monitor specific PID
top -b -n 1                # Batch mode (one iteration)
top -d 5                   # Update every 5 seconds

# Interactive commands (while running)
# k - kill process
# r - renice (change priority)
# M - sort by memory
# P - sort by CPU
# q - quit
# h - help

# Examples
top -o %MEM                # Sort by memory (macOS)
top | head -20             # First 20 lines
</code></pre>
<h3 id="htop---enhanced-process-viewer"><a class="header" href="#htop---enhanced-process-viewer">htop - Enhanced Process Viewer</a></h3>
<pre><code class="language-bash">htop                       # Launch htop (if installed)
htop -u username           # Show user's processes
htop -p PID,PID            # Monitor specific PIDs

# Interactive features
# F9 - kill process
# F7/F8 - adjust priority
# F5 - tree view
# F3 - search
# F4 - filter
</code></pre>
<h3 id="kill---terminate-process"><a class="header" href="#kill---terminate-process">kill - Terminate Process</a></h3>
<pre><code class="language-bash"># By PID
kill 1234                  # Graceful termination (SIGTERM)
kill -9 1234               # Force kill (SIGKILL)
kill -15 1234              # Explicit SIGTERM
kill -HUP 1234             # Hangup signal (reload config)

# Signal list
kill -l                    # List all signals

# Examples
kill $(pidof firefox)      # Kill by process name
killall nginx              # Kill all nginx processes
pkill -u username          # Kill user's processes
</code></pre>
<h3 id="pkillkillall---kill-by-name"><a class="header" href="#pkillkillall---kill-by-name">pkill/killall - Kill by Name</a></h3>
<pre><code class="language-bash">pkill firefox              # Kill by process name
pkill -u username          # Kill user's processes
pkill -9 python            # Force kill all python processes
pkill -f "script.py"       # Kill by full command line

killall nginx              # Kill all nginx processes
killall -u username bash   # Kill user's bash sessions
</code></pre>
<h3 id="jobsbgfg---job-control"><a class="header" href="#jobsbgfg---job-control">jobs/bg/fg - Job Control</a></h3>
<pre><code class="language-bash"># Job control
command &amp;                  # Run in background
jobs                       # List background jobs
fg %1                      # Bring job 1 to foreground
bg %1                      # Resume job 1 in background
Ctrl+Z                     # Suspend current job
disown %1                  # Detach job from shell

# Examples
find / -name "*.log" &gt; /tmp/logs.txt &amp;  # Background search
sleep 100 &amp;                # Background sleep
jobs -l                    # List with PIDs
</code></pre>
<h3 id="nohup---run-immune-to-hangups"><a class="header" href="#nohup---run-immune-to-hangups">nohup - Run Immune to Hangups</a></h3>
<pre><code class="language-bash">nohup command &amp;            # Run detached from terminal
nohup ./script.sh &amp;        # Script continues after logout
nohup command &gt; output.log 2&gt;&amp;1 &amp;  # Redirect output

# Examples
nohup python server.py &gt; server.log 2&gt;&amp;1 &amp;
nohup long_running_task.sh &amp;
</code></pre>
<h3 id="systemctl---service-management"><a class="header" href="#systemctl---service-management">systemctl - Service Management</a></h3>
<pre><code class="language-bash"># Service operations
systemctl start nginx      # Start service
systemctl stop nginx       # Stop service
systemctl restart nginx    # Restart service
systemctl reload nginx     # Reload configuration
systemctl status nginx     # Service status
systemctl enable nginx     # Enable at boot
systemctl disable nginx    # Disable at boot

# System operations
systemctl reboot           # Reboot system
systemctl poweroff         # Shutdown system
systemctl suspend          # Suspend system

# Information
systemctl list-units       # List active units
systemctl list-unit-files  # List all unit files
systemctl --failed         # Show failed services
systemctl is-enabled nginx # Check if enabled
systemctl is-active nginx  # Check if running

# Examples
systemctl status sshd      # Check SSH status
systemctl restart apache2  # Restart web server
systemctl list-dependencies nginx  # Show dependencies
</code></pre>
<hr />
<h2 id="system-monitoring-1"><a class="header" href="#system-monitoring-1">System Monitoring</a></h2>
<h3 id="df---disk-free-space"><a class="header" href="#df---disk-free-space">df - Disk Free Space</a></h3>
<pre><code class="language-bash">df                         # Show disk usage
df -h                      # Human-readable sizes
df -i                      # Inode usage
df -T                      # Show filesystem type
df /home                   # Specific mount point

# Examples
df -h | grep -v tmpfs      # Exclude temporary filesystems
df -h --total              # Show total summary
</code></pre>
<h3 id="du---disk-usage"><a class="header" href="#du---disk-usage">du - Disk Usage</a></h3>
<pre><code class="language-bash">du                         # Directory space usage
du -h                      # Human-readable
du -sh *                   # Summary for each item
du -sh directory           # Total for directory
du -ah                     # All files (not just directories)
du --max-depth=1           # Limit directory depth

# Examples
du -sh /var/log            # Log directory size
du -h | sort -rh | head -10  # Top 10 largest directories
du -ch *.log | tail -1     # Total size of log files
</code></pre>
<h3 id="free---memory-usage"><a class="header" href="#free---memory-usage">free - Memory Usage</a></h3>
<pre><code class="language-bash">free                       # Show memory usage
free -h                    # Human-readable
free -m                    # In megabytes
free -g                    # In gigabytes
free -s 5                  # Update every 5 seconds

# Examples
free -h                    # Quick memory check
watch -n 1 free -h         # Monitor continuously
</code></pre>
<h3 id="vmstat---virtual-memory-statistics"><a class="header" href="#vmstat---virtual-memory-statistics">vmstat - Virtual Memory Statistics</a></h3>
<pre><code class="language-bash">vmstat                     # Memory, process, paging stats
vmstat 1                   # Update every second
vmstat 1 10                # 10 samples, 1 second apart
vmstat -s                  # Memory statistics
vmstat -d                  # Disk statistics

# Examples
vmstat 5                   # Monitor system stats
</code></pre>
<h3 id="iostat---io-statistics"><a class="header" href="#iostat---io-statistics">iostat - I/O Statistics</a></h3>
<pre><code class="language-bash">iostat                     # CPU and disk I/O stats
iostat -x                  # Extended statistics
iostat -d 1                # Disk stats every second
iostat -p sda              # Specific disk

# Examples
iostat -xz 1               # Extended, skip zero-activity
</code></pre>
<h3 id="netstat---network-statistics"><a class="header" href="#netstat---network-statistics">netstat - Network Statistics</a></h3>
<pre><code class="language-bash">netstat -tulpn             # Listening ports with programs
netstat -an                # All connections, numeric
netstat -r                 # Routing table
netstat -i                 # Network interfaces
netstat -s                 # Protocol statistics

# Examples
netstat -tulpn | grep :80  # Check port 80
netstat -ant | grep ESTABLISHED  # Active connections
</code></pre>
<h3 id="ss---socket-statistics-newer-netstat"><a class="header" href="#ss---socket-statistics-newer-netstat">ss - Socket Statistics (newer netstat)</a></h3>
<pre><code class="language-bash">ss -tulpn                  # Listening TCP/UDP ports
ss -ta                     # All TCP sockets
ss -ua                     # All UDP sockets
ss -s                      # Summary statistics
ss dst :80                 # Connections to port 80

# Examples
ss -t state established    # Established TCP connections
ss -o state established    # With timer info
ss -p | grep ssh           # SSH connections
</code></pre>
<h3 id="lsof---list-open-files"><a class="header" href="#lsof---list-open-files">lsof - List Open Files</a></h3>
<pre><code class="language-bash">lsof                       # All open files
lsof -u username           # User's open files
lsof -i :80                # Processes using port 80
lsof -i TCP:1-1024         # Processes on ports 1-1024
lsof /path/to/file         # What's accessing a file
lsof -c nginx              # Files opened by nginx
lsof -p 1234               # Files opened by PID

# Examples
lsof -i -P -n              # Network connections (no DNS)
lsof +D /var/log           # Everything under directory
lsof -t -i :8080           # PIDs using port 8080
</code></pre>
<hr />
<h2 id="user-management"><a class="header" href="#user-management">User Management</a></h2>
<h3 id="useradd---create-user"><a class="header" href="#useradd---create-user">useradd - Create User</a></h3>
<pre><code class="language-bash">useradd username           # Create user
useradd -m username        # Create with home directory
useradd -m -s /bin/bash username  # Specify shell
useradd -m -G group1,group2 user  # Add to groups
useradd -m -e 2024-12-31 user     # With expiry date

# Examples
useradd -m -s /bin/bash john
useradd -m -G sudo,docker admin
</code></pre>
<h3 id="usermod---modify-user"><a class="header" href="#usermod---modify-user">usermod - Modify User</a></h3>
<pre><code class="language-bash">usermod -aG sudo username  # Add to sudo group
usermod -s /bin/zsh user   # Change shell
usermod -L username        # Lock account
usermod -U username        # Unlock account
usermod -e 2024-12-31 user # Set expiry date

# Examples
usermod -aG docker username  # Add to docker group
usermod -d /new/home -m user # Change home directory
</code></pre>
<h3 id="userdel---delete-user"><a class="header" href="#userdel---delete-user">userdel - Delete User</a></h3>
<pre><code class="language-bash">userdel username           # Delete user
userdel -r username        # Delete user and home directory
</code></pre>
<h3 id="passwd---change-password"><a class="header" href="#passwd---change-password">passwd - Change Password</a></h3>
<pre><code class="language-bash">passwd                     # Change your password
passwd username            # Change user's password (as root)
passwd -l username         # Lock password
passwd -u username         # Unlock password
passwd -e username         # Expire password (force change)

# Examples
passwd john                # Set password for john
passwd -S john             # Show password status
</code></pre>
<h3 id="su---switch-user"><a class="header" href="#su---switch-user">su - Switch User</a></h3>
<pre><code class="language-bash">su                         # Switch to root
su username                # Switch to user
su - username              # Switch with environment
su -c "command" username   # Run command as user

# Examples
su - postgres              # Switch to postgres user
su -c "systemctl restart nginx" root
</code></pre>
<h3 id="sudo---execute-as-superuser"><a class="header" href="#sudo---execute-as-superuser">sudo - Execute as Superuser</a></h3>
<pre><code class="language-bash">sudo command               # Run command as root
sudo -u user command       # Run as specific user
sudo -i                    # Interactive root shell
sudo -s                    # Shell as root
sudo -l                    # List allowed commands
sudo -k                    # Invalidate cached credentials

# Examples
sudo apt update            # Update package lists
sudo -u www-data touch /var/www/file
sudo !!                    # Run last command with sudo
</code></pre>
<hr />
<h2 id="permissions"><a class="header" href="#permissions">Permissions</a></h2>
<h3 id="chmod---change-file-mode"><a class="header" href="#chmod---change-file-mode">chmod - Change File Mode</a></h3>
<pre><code class="language-bash"># Numeric mode
chmod 644 file             # rw-r--r--
chmod 755 file             # rwxr-xr-x
chmod 777 file             # rwxrwxrwx
chmod 600 file             # rw-------

# Symbolic mode
chmod u+x file             # Add execute for user
chmod g-w file             # Remove write for group
chmod o=r file             # Set others to read only
chmod a+r file             # Add read for all
chmod u+x,g+x file         # Multiple changes

# Recursive
chmod -R 755 directory     # Apply recursively

# Examples
chmod +x script.sh         # Make executable
chmod -R 755 /var/www      # Web directory permissions
chmod u+s file             # Set SUID bit
chmod g+s directory        # Set SGID bit
chmod +t directory         # Set sticky bit
</code></pre>
<p><strong>Permission numbers:</strong></p>
<ul>
<li>4 = read (r)</li>
<li>2 = write (w)</li>
<li>1 = execute (x)</li>
<li>Sum for each user/group/others</li>
</ul>
<h3 id="chown---change-ownership"><a class="header" href="#chown---change-ownership">chown - Change Ownership</a></h3>
<pre><code class="language-bash">chown user file            # Change owner
chown user:group file      # Change owner and group
chown -R user:group dir    # Recursive change
chown --reference=ref file # Copy ownership from reference

# Examples
chown www-data:www-data /var/www/html
chown -R mysql:mysql /var/lib/mysql
chown john:developers project/
</code></pre>
<h3 id="chgrp---change-group"><a class="header" href="#chgrp---change-group">chgrp - Change Group</a></h3>
<pre><code class="language-bash">chgrp group file           # Change group
chgrp -R group directory   # Recursive change

# Examples
chgrp www-data website/
chgrp -R developers /opt/project
</code></pre>
<h3 id="umask---default-permissions"><a class="header" href="#umask---default-permissions">umask - Default Permissions</a></h3>
<pre><code class="language-bash">umask                      # Show current umask
umask 022                  # Set umask (755 for dirs, 644 for files)
umask 002                  # Set umask (775 for dirs, 664 for files)

# Examples
umask 077                  # Private by default (700/600)
</code></pre>
<hr />
<h2 id="package-management"><a class="header" href="#package-management">Package Management</a></h2>
<h3 id="apt-debianubuntu"><a class="header" href="#apt-debianubuntu">APT (Debian/Ubuntu)</a></h3>
<pre><code class="language-bash"># Update
apt update                 # Update package lists
apt upgrade                # Upgrade packages
apt full-upgrade           # Upgrade + handle dependencies
apt dist-upgrade           # Distribution upgrade

# Install/Remove
apt install package        # Install package
apt install package1 package2  # Multiple packages
apt remove package         # Remove package
apt purge package          # Remove package and config
apt autoremove             # Remove unused dependencies

# Search and Info
apt search keyword         # Search packages
apt show package           # Package information
apt list --installed       # List installed packages
apt list --upgradable      # List upgradable packages

# Examples
apt install nginx          # Install web server
apt remove --purge apache2 # Complete removal
apt install build-essential git curl
</code></pre>
<h3 id="dnfyum-rhelfedoracentos"><a class="header" href="#dnfyum-rhelfedoracentos">DNF/YUM (RHEL/Fedora/CentOS)</a></h3>
<pre><code class="language-bash"># Update
dnf update                 # Update packages
dnf upgrade                # Synonym for update

# Install/Remove
dnf install package        # Install package
dnf remove package         # Remove package
dnf autoremove             # Remove orphaned dependencies

# Search and Info
dnf search keyword         # Search packages
dnf info package           # Package information
dnf list installed         # List installed packages

# Examples
dnf install httpd          # Install Apache
dnf groupinstall "Development Tools"
</code></pre>
<h3 id="snap-universal"><a class="header" href="#snap-universal">Snap (Universal)</a></h3>
<pre><code class="language-bash">snap install package       # Install snap package
snap remove package        # Remove package
snap refresh               # Update all snaps
snap list                  # List installed snaps
snap find keyword          # Search snaps

# Examples
snap install docker
snap install --classic code  # Classic confinement
</code></pre>
<hr />
<h2 id="network-commands"><a class="header" href="#network-commands">Network Commands</a></h2>
<h3 id="ip---network-configuration"><a class="header" href="#ip---network-configuration">ip - Network Configuration</a></h3>
<pre><code class="language-bash"># Address management
ip addr show               # Show all IP addresses
ip addr show eth0          # Show specific interface
ip addr add IP/MASK dev eth0  # Add IP address
ip addr del IP/MASK dev eth0  # Delete IP address

# Link management
ip link show               # Show network interfaces
ip link set eth0 up        # Bring interface up
ip link set eth0 down      # Bring interface down

# Route management
ip route show              # Show routing table
ip route add default via GATEWAY  # Add default route
ip route del default       # Delete default route

# Neighbor (ARP)
ip neigh show              # Show ARP table

# Examples
ip addr show               # Quick network overview
ip route get 8.8.8.8       # Show route to destination
ip link set eth0 mtu 9000  # Set MTU
</code></pre>
<h3 id="ping---test-connectivity"><a class="header" href="#ping---test-connectivity">ping - Test Connectivity</a></h3>
<pre><code class="language-bash">ping host                  # Ping host
ping -c 4 host             # Send 4 packets
ping -i 2 host             # 2 second interval
ping -s 1000 host          # 1000 byte packets
ping -W 1 host             # 1 second timeout

# Examples
ping -c 4 google.com       # Test internet connectivity
ping 192.168.1.1           # Test local gateway
</code></pre>
<h3 id="curl---transfer-data"><a class="header" href="#curl---transfer-data">curl - Transfer Data</a></h3>
<pre><code class="language-bash"># Basic requests
curl URL                   # GET request
curl -O URL                # Download file (keep name)
curl -o file.txt URL       # Download with custom name
curl -I URL                # Headers only
curl -L URL                # Follow redirects

# HTTP methods
curl -X POST URL           # POST request
curl -X PUT URL            # PUT request
curl -X DELETE URL         # DELETE request

# Data and headers
curl -d "param=value" URL  # POST data
curl -H "Header: Value" URL  # Custom header
curl -u user:pass URL      # Basic authentication
curl -b cookies.txt URL    # Send cookies
curl -c cookies.txt URL    # Save cookies

# Examples
curl -I https://google.com  # Check headers
curl -o page.html https://example.com
curl -X POST -H "Content-Type: application/json" -d '{"key":"value"}' API_URL
curl -u admin:password http://api.example.com
</code></pre>
<h3 id="wget---download-files"><a class="header" href="#wget---download-files">wget - Download Files</a></h3>
<pre><code class="language-bash">wget URL                   # Download file
wget -O filename URL       # Save with custom name
wget -c URL                # Continue interrupted download
wget -b URL                # Background download
wget -r URL                # Recursive download
wget --limit-rate=200k URL # Limit download speed
wget -i urls.txt           # Download multiple URLs

# Examples
wget https://example.com/file.iso
wget -c https://mirrors.kernel.org/ubuntu/ubuntu-22.04.iso
wget -r -np -k http://example.com  # Mirror website
</code></pre>
<h3 id="ssh---secure-shell"><a class="header" href="#ssh---secure-shell">ssh - Secure Shell</a></h3>
<pre><code class="language-bash">ssh user@host              # Connect to host
ssh -p 2222 user@host      # Custom port
ssh -i key.pem user@host   # Use specific key
ssh user@host command      # Run remote command
ssh -L 8080:localhost:80 user@host  # Local port forwarding
ssh -R 8080:localhost:80 user@host  # Remote port forwarding

# Examples
ssh john@192.168.1.100
ssh -i ~/.ssh/aws-key.pem ubuntu@ec2-instance
ssh user@host 'df -h'      # Check remote disk space
</code></pre>
<h3 id="scp---secure-copy"><a class="header" href="#scp---secure-copy">scp - Secure Copy</a></h3>
<pre><code class="language-bash">scp file user@host:/path   # Copy to remote
scp user@host:/path/file . # Copy from remote
scp -r directory user@host:/path  # Copy directory
scp -P 2222 file user@host:/path  # Custom port
scp -i key.pem file user@host:/path  # Specific key

# Examples
scp backup.tar.gz user@backup-server:/backups/
scp -r website/ user@server:/var/www/
scp user@server:/var/log/app.log ./logs/
</code></pre>
<h3 id="rsync---sync-files"><a class="header" href="#rsync---sync-files">rsync - Sync Files</a></h3>
<pre><code class="language-bash">rsync -av source/ dest/    # Archive and verbose
rsync -avz source/ user@host:dest/  # With compression
rsync -av --delete src/ dst/  # Delete in destination
rsync -av --progress src/ dst/  # Show progress
rsync -av --exclude="*.log" src/ dst/  # Exclude pattern

# Examples
rsync -avz ~/project/ backup-server:/backups/project/
rsync -av --delete /var/www/ /backup/www/
rsync -avz -e "ssh -p 2222" src/ user@host:dest/
</code></pre>
<hr />
<h2 id="service-management"><a class="header" href="#service-management">Service Management</a></h2>
<h3 id="journalctl---query-systemd-journal"><a class="header" href="#journalctl---query-systemd-journal">journalctl - Query Systemd Journal</a></h3>
<pre><code class="language-bash">journalctl                 # Show all logs
journalctl -f              # Follow logs (tail -f)
journalctl -u nginx        # Service logs
journalctl -u nginx -f     # Follow service logs
journalctl --since today   # Today's logs
journalctl --since "1 hour ago"  # Last hour
journalctl -p err          # Error priority and above
journalctl -k              # Kernel messages
journalctl -b              # Current boot logs
journalctl --disk-usage    # Disk usage by logs

# Examples
journalctl -u sshd -n 100  # Last 100 SSH log entries
journalctl --since "2024-01-01" --until "2024-01-31"
journalctl -u nginx --since yesterday
</code></pre>
<hr />
<h2 id="compression"><a class="header" href="#compression">Compression</a></h2>
<h3 id="tar---archive-files"><a class="header" href="#tar---archive-files">tar - Archive Files</a></h3>
<pre><code class="language-bash"># Create archives
tar -cvf archive.tar files # Create tar archive
tar -czvf archive.tar.gz files  # Create gzipped archive
tar -cjvf archive.tar.bz2 files # Create bzip2 archive
tar -cJvf archive.tar.xz files  # Create xz archive

# Extract archives
tar -xvf archive.tar       # Extract tar
tar -xzvf archive.tar.gz   # Extract gzipped
tar -xjvf archive.tar.bz2  # Extract bzip2
tar -xJvf archive.tar.xz   # Extract xz
tar -xzvf archive.tar.gz -C /dest  # Extract to directory

# List contents
tar -tvf archive.tar       # List contents
tar -tzvf archive.tar.gz   # List gzipped archive

# Examples
tar -czvf backup-$(date +%Y%m%d).tar.gz /home/user/
tar -xzvf website.tar.gz -C /var/www/
tar -czvf project.tar.gz --exclude='*.log' project/
</code></pre>
<h3 id="gzipgunzip---compress-files"><a class="header" href="#gzipgunzip---compress-files">gzip/gunzip - Compress Files</a></h3>
<pre><code class="language-bash">gzip file.txt              # Compress (creates file.txt.gz)
gzip -k file.txt           # Keep original
gzip -9 file.txt           # Maximum compression
gunzip file.txt.gz         # Decompress
gzip -l file.txt.gz        # List compression info

# Examples
gzip -r directory/         # Compress all files in directory
gzip -c file.txt &gt; file.txt.gz  # Keep original
</code></pre>
<h3 id="zipunzip---zip-archives"><a class="header" href="#zipunzip---zip-archives">zip/unzip - Zip Archives</a></h3>
<pre><code class="language-bash">zip archive.zip files      # Create zip
zip -r archive.zip dir/    # Recursive zip
unzip archive.zip          # Extract zip
unzip -l archive.zip       # List contents
unzip archive.zip -d /dest # Extract to directory

# Examples
zip -r backup.zip /home/user/Documents
unzip file.zip
zip -e secure.zip file     # Password protected
</code></pre>
<hr />
<h2 id="disk-management"><a class="header" href="#disk-management">Disk Management</a></h2>
<h3 id="fdisk---partition-disk"><a class="header" href="#fdisk---partition-disk">fdisk - Partition Disk</a></h3>
<pre><code class="language-bash">fdisk -l                   # List all disks and partitions
fdisk /dev/sda             # Open disk for partitioning

# Interactive commands (in fdisk):
# n - new partition
# d - delete partition
# p - print partition table
# w - write changes
# q - quit without saving
</code></pre>
<h3 id="mountumount---mount-filesystems"><a class="header" href="#mountumount---mount-filesystems">mount/umount - Mount Filesystems</a></h3>
<pre><code class="language-bash">mount                      # Show mounted filesystems
mount /dev/sda1 /mnt       # Mount partition
mount -t nfs server:/share /mnt  # Mount NFS
mount -o loop disk.iso /mnt # Mount ISO
umount /mnt                # Unmount
umount -l /mnt             # Lazy unmount

# Examples
mount /dev/sdb1 /media/usb
mount -t cifs //server/share /mnt -o username=user
mount --bind /source /dest # Bind mount
</code></pre>
<h3 id="mkfs---make-filesystem"><a class="header" href="#mkfs---make-filesystem">mkfs - Make Filesystem</a></h3>
<pre><code class="language-bash">mkfs.ext4 /dev/sda1        # Create ext4 filesystem
mkfs.xfs /dev/sda1         # Create XFS filesystem
mkfs.vfat /dev/sda1        # Create FAT filesystem

# Examples
mkfs.ext4 -L MyDisk /dev/sdb1  # With label
mkfs.ext4 -m 1 /dev/sdb1   # Reserve 1% for root
</code></pre>
<hr />
<h2 id="system-information-1"><a class="header" href="#system-information-1">System Information</a></h2>
<h3 id="uname---system-information"><a class="header" href="#uname---system-information">uname - System Information</a></h3>
<pre><code class="language-bash">uname -a                   # All information
uname -r                   # Kernel release
uname -m                   # Machine hardware
uname -o                   # Operating system
</code></pre>
<h3 id="lscpu---cpu-information"><a class="header" href="#lscpu---cpu-information">lscpu - CPU Information</a></h3>
<pre><code class="language-bash">lscpu                      # Detailed CPU info
lscpu | grep "CPU(s)"      # Number of CPUs
</code></pre>
<h3 id="lsblk---block-devices"><a class="header" href="#lsblk---block-devices">lsblk - Block Devices</a></h3>
<pre><code class="language-bash">lsblk                      # List block devices
lsblk -f                   # Show filesystems
lsblk -o NAME,SIZE,TYPE,MOUNTPOINT  # Custom columns
</code></pre>
<h3 id="lspci---pci-devices"><a class="header" href="#lspci---pci-devices">lspci - PCI Devices</a></h3>
<pre><code class="language-bash">lspci                      # List PCI devices
lspci -v                   # Verbose output
lspci | grep VGA           # Graphics card info
</code></pre>
<h3 id="lsusb---usb-devices"><a class="header" href="#lsusb---usb-devices">lsusb - USB Devices</a></h3>
<pre><code class="language-bash">lsusb                      # List USB devices
lsusb -v                   # Verbose output
</code></pre>
<h3 id="hostname---system-hostname"><a class="header" href="#hostname---system-hostname">hostname - System Hostname</a></h3>
<pre><code class="language-bash">hostname                   # Show hostname
hostname -I                # Show IP addresses
hostnamectl                # Detailed host information
hostnamectl set-hostname new-name  # Change hostname
</code></pre>
<h3 id="date---date-and-time"><a class="header" href="#date---date-and-time">date - Date and Time</a></h3>
<pre><code class="language-bash">date                       # Current date and time
date +%Y-%m-%d             # Custom format (2024-01-15)
date +%s                   # Unix timestamp
date -d "yesterday"        # Yesterday's date
date -d "next Monday"      # Next Monday

# Examples
date +%Y%m%d-%H%M%S        # 20240115-143025
date -d @1704067200        # Convert timestamp
</code></pre>
<h3 id="uptime---system-uptime"><a class="header" href="#uptime---system-uptime">uptime - System Uptime</a></h3>
<pre><code class="language-bash">uptime                     # How long system is running
uptime -p                  # Pretty format
uptime -s                  # Since when
</code></pre>
<hr />
<h2 id="practical-tips-and-best-practices"><a class="header" href="#practical-tips-and-best-practices">Practical Tips and Best Practices</a></h2>
<h3 id="command-chaining"><a class="header" href="#command-chaining">Command Chaining</a></h3>
<pre><code class="language-bash"># Sequential execution
command1 ; command2        # Run both regardless
command1 &amp;&amp; command2       # Run command2 if command1 succeeds
command1 || command2       # Run command2 if command1 fails

# Examples
apt update &amp;&amp; apt upgrade  # Update then upgrade
make || echo "Build failed"
cd /tmp &amp;&amp; rm -rf old_files
</code></pre>
<h3 id="redirection-and-pipes"><a class="header" href="#redirection-and-pipes">Redirection and Pipes</a></h3>
<pre><code class="language-bash"># Output redirection
command &gt; file             # Overwrite file
command &gt;&gt; file            # Append to file
command 2&gt; file            # Redirect stderr
command &gt; file 2&gt;&amp;1        # Redirect both stdout and stderr
command &amp;&gt; file            # Redirect both (shorthand)

# Input redirection
command &lt; file             # Read from file
command &lt;&lt; EOF             # Here document
multiline input
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="this-section-will-provide-an-overview-of-netfilter-and-its-role-in-packet-filtering"><a class="header" href="#this-section-will-provide-an-overview-of-netfilter-and-its-role-in-packet-filtering">This section will provide an overview of netfilter and its role in packet filtering.</a></h1>
<h1 id="netfilter"><a class="header" href="#netfilter">Netfilter</a></h1>
<p>Netfilter is a framework provided by the Linux kernel for packet filtering, network address translation (NAT), and other packet mangling. It allows system administrators to define rules for how packets should be handled by the kernel.</p>
<h2 id="key-concepts-1"><a class="header" href="#key-concepts-1">Key Concepts</a></h2>
<ul>
<li>
<p><strong>Hooks</strong>: Netfilter provides hooks in the networking stack where packets can be intercepted and processed. The main hooks are:</p>
<ul>
<li><strong>PREROUTING</strong>: Before routing decisions are made.</li>
<li><strong>INPUT</strong>: For packets destined for the local system.</li>
<li><strong>FORWARD</strong>: For packets being routed through the system.</li>
<li><strong>OUTPUT</strong>: For packets generated by the local system.</li>
<li><strong>POSTROUTING</strong>: After routing decisions are made.</li>
</ul>
</li>
<li>
<p><strong>Tables</strong>: Netfilter organizes rules into tables, with the most common being:</p>
<ul>
<li><strong>filter</strong>: The default table for packet filtering.</li>
<li><strong>nat</strong>: Used for network address translation.</li>
<li><strong>mangle</strong>: Used for specialized packet alterations.</li>
</ul>
</li>
<li>
<p><strong>Chains</strong>: Each table contains chains, which are lists of rules that packets are checked against. Each rule specifies a target action (e.g., ACCEPT, DROP) when a packet matches.</p>
</li>
</ul>
<h2 id="common-commands-1"><a class="header" href="#common-commands-1">Common Commands</a></h2>
<ol>
<li>
<p><strong>List Rules</strong>: To view the current rules in a specific table, use:</p>
<pre><code class="language-bash">iptables -L
</code></pre>
</li>
<li>
<p><strong>Add a Rule</strong>: To add a new rule to a chain, use:</p>
<pre><code class="language-bash">iptables -A INPUT -p tcp --dport 80 -j ACCEPT
</code></pre>
</li>
<li>
<p><strong>Delete a Rule</strong>: To delete a specific rule, use:</p>
<pre><code class="language-bash">iptables -D INPUT -p tcp --dport 80 -j ACCEPT
</code></pre>
</li>
<li>
<p><strong>Save Rules</strong>: To save the current rules to a file, use:</p>
<pre><code class="language-bash">iptables-save &gt; /etc/iptables/rules.v4
</code></pre>
</li>
</ol>
<h2 id="applications"><a class="header" href="#applications">Applications</a></h2>
<p>Netfilter is widely used for:</p>
<ul>
<li><strong>Firewalling</strong>: Protecting systems from unauthorized access and attacks.</li>
<li><strong>NAT</strong>: Allowing multiple devices on a local network to share a single public IP address.</li>
<li><strong>Traffic Shaping</strong>: Managing and controlling the flow of network traffic.</li>
</ul>
<h2 id="conclusion-1"><a class="header" href="#conclusion-1">Conclusion</a></h2>
<p>Netfilter is a crucial component of the Linux networking stack, providing powerful capabilities for packet filtering and manipulation. Understanding how to configure and use netfilter effectively is essential for system administrators and network engineers.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="tc"><a class="header" href="#tc">tc</a></h1>
<p><code>tc</code> (traffic control) is a utility in the Linux kernel used to configure Traffic Control in the network stack. It allows administrators to configure the queuing discipline (qdisc), which determines how packets are enqueued and dequeued from the network interface.</p>
<h3 id="important-components-of-tc"><a class="header" href="#important-components-of-tc">Important Components of <code>tc</code></a></h3>
<ol>
<li><strong>qdisc (Queuing Discipline)</strong>: The core component of <code>tc</code>, which defines the algorithm used to manage the packet queue. Examples include <code>pfifo_fast</code>, <code>fq_codel</code>, and <code>netem</code>.</li>
<li><strong>class</strong>: A way to create a hierarchy within a qdisc, allowing for more granular control over traffic. Classes can be used to apply different rules to different types of traffic.</li>
<li><strong>filter</strong>: Used to classify packets into different classes. Filters can match on various packet attributes, such as IP address, port number, or protocol.</li>
<li><strong>action</strong>: Defines what to do with packets that match a filter. Actions can include marking, mirroring, or redirecting packets.</li>
</ol>
<h3 id="uses-of-tc"><a class="header" href="#uses-of-tc">Uses of <code>tc</code></a></h3>
<ul>
<li><strong>Traffic Shaping</strong>: Control the rate of outgoing traffic to ensure that the network is not overwhelmed. This can be useful for managing bandwidth usage and ensuring fair distribution of network resources.</li>
<li><strong>Traffic Policing</strong>: Enforce limits on the rate of incoming traffic, dropping packets that exceed the specified rate. This can help protect against network abuse or attacks.</li>
<li><strong>Network Emulation</strong>: Simulate various network conditions, such as latency, packet loss, and jitter, to test the performance of applications under different scenarios.</li>
<li><strong>Quality of Service (QoS)</strong>: Prioritize certain types of traffic to ensure that critical applications receive the necessary bandwidth and low latency.</li>
</ul>
<p>By using <code>tc</code>, administrators can fine-tune network performance, improve reliability, and ensure that critical applications have the necessary resources to function optimally.</p>
<p>Add delay to all traffic on eth0</p>
<pre><code class="language-bash">sudo tc qdisc add dev eth0 root netem delay 100ms
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="iptables"><a class="header" href="#iptables">iptables</a></h1>
<p>iptables is a user-space utility program that allows a system administrator to configure the IP packet filter rules of the Linux kernel firewall. It is a powerful tool for managing network traffic and enhancing security.</p>
<h2 id="key-concepts-2"><a class="header" href="#key-concepts-2">Key Concepts</a></h2>
<ul>
<li>
<p><strong>Chains</strong>: A chain is a set of rules that iptables uses to determine the action to take on packets. There are three built-in chains: INPUT, OUTPUT, and FORWARD.</p>
</li>
<li>
<p><strong>Tables</strong>: iptables organizes rules into tables, with the most common being the filter table, which is used for packet filtering.</p>
</li>
<li>
<p><strong>Targets</strong>: Each rule in a chain specifies a target, which is the action to take when a packet matches the rule. Common targets include ACCEPT, DROP, and REJECT.</p>
</li>
</ul>
<h2 id="common-commands-2"><a class="header" href="#common-commands-2">Common Commands</a></h2>
<ol>
<li>
<p><strong>List Rules</strong>: To view the current rules in a specific chain, use:</p>
<pre><code class="language-bash">iptables -L
</code></pre>
</li>
<li>
<p><strong>Add a Rule</strong>: To add a new rule to a chain, use:</p>
<pre><code class="language-bash">iptables -A INPUT -s 192.168.1.1 -j ACCEPT
</code></pre>
</li>
<li>
<p><strong>Delete a Rule</strong>: To delete a specific rule, use:</p>
<pre><code class="language-bash">iptables -D INPUT -s 192.168.1.1 -j ACCEPT
</code></pre>
</li>
<li>
<p><strong>Save Rules</strong>: To save the current rules to a file, use:</p>
<pre><code class="language-bash">iptables-save &gt; /etc/iptables/rules.v4
</code></pre>
</li>
</ol>
<h2 id="applications-1"><a class="header" href="#applications-1">Applications</a></h2>
<p>iptables is widely used for:</p>
<ul>
<li><strong>Network Security</strong>: Protecting systems from unauthorized access and attacks.</li>
<li><strong>Traffic Control</strong>: Managing and controlling the flow of network traffic.</li>
<li><strong>Logging</strong>: Keeping track of network activity for analysis and troubleshooting.</li>
</ul>
<h2 id="conclusion-2"><a class="header" href="#conclusion-2">Conclusion</a></h2>
<p>iptables is an essential tool for network management and security in Linux environments. Understanding how to configure and use iptables effectively is crucial for system administrators and network engineers.</p>
<h1 id="eli10-what-is-iptables"><a class="header" href="#eli10-what-is-iptables">ELI10: What is iptables?</a></h1>
<p>iptables is like a set of rules for your computer's door. Just like you might have rules about who can come into your house or what they can bring, iptables helps your computer decide what kind of data can come in or go out.</p>
<p>Here’s a simple breakdown:</p>
<ul>
<li>
<p><strong>Chains</strong>: Think of these as different doors. Each door has its own set of rules. For example, one door might let in friends (INPUT), another might let out toys (OUTPUT), and a third might let things pass through without stopping (FORWARD).</p>
</li>
<li>
<p><strong>Tables</strong>: These are like the lists of rules for each door. The most common list is for filtering, which decides what gets to come in or go out.</p>
</li>
<li>
<p><strong>Targets</strong>: When something tries to come through a door, the rules tell it what to do. It might be allowed in (ACCEPT), told to go away (DROP), or asked to leave a message (REJECT).</p>
</li>
</ul>
<p>So, iptables is a way to keep your computer safe and make sure only the right data gets in and out!</p>
<h1 id="example-commands"><a class="header" href="#example-commands">Example Commands</a></h1>
<ol>
<li>
<p><strong>List Rules</strong>: To see what rules are set up, you can use:</p>
<pre><code class="language-bash">iptables -L
</code></pre>
</li>
<li>
<p><strong>Add a Rule</strong>: If you want to let a specific friend in, you can add a rule like this:</p>
<pre><code class="language-bash">iptables -A INPUT -s 192.168.1.1 -j ACCEPT
</code></pre>
</li>
<li>
<p><strong>Delete a Rule</strong>: If you want to remove a rule, you can do it like this:</p>
<pre><code class="language-bash">iptables -D INPUT -s 192.168.1.1 -j ACCEPT
</code></pre>
</li>
<li>
<p><strong>Save Rules</strong>: To keep your rules safe, you can save them to a file:</p>
<pre><code class="language-bash">iptables-save &gt; /etc/iptables/rules.v4
</code></pre>
</li>
</ol>
<h1 id="why-use-iptables"><a class="header" href="#why-use-iptables">Why Use iptables?</a></h1>
<p>Using iptables helps keep your computer safe from bad data and makes sure everything runs smoothly. It's like having a good security system for your digital home!</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="systemd"><a class="header" href="#systemd">systemd</a></h1>
<p>systemd is a system and service manager for Linux operating systems. It provides aggressive parallelization capabilities, uses socket and D-Bus activation for starting services, offers on-demand starting of daemons, and maintains process tracking using Linux control groups.</p>
<h2 id="overview-16"><a class="header" href="#overview-16">Overview</a></h2>
<p>systemd replaces the traditional SysV init system and provides a more modern approach to system initialization and service management.</p>
<p><strong>Key Features:</strong></p>
<ul>
<li>Parallel service startup</li>
<li>Socket and D-Bus activation</li>
<li>On-demand service starting</li>
<li>Process supervision</li>
<li>Mount and automount point management</li>
<li>Snapshot support</li>
<li>System state snapshots</li>
<li>Logging with journald</li>
</ul>
<h2 id="basic-concepts"><a class="header" href="#basic-concepts">Basic Concepts</a></h2>
<p><strong>Units</strong>: Resources that systemd manages</p>
<ul>
<li><strong>Service units</strong> (.service): System services</li>
<li><strong>Socket units</strong> (.socket): IPC or network sockets</li>
<li><strong>Target units</strong> (.target): Group of units (like runlevels)</li>
<li><strong>Mount units</strong> (.mount): Mount points</li>
<li><strong>Timer units</strong> (.timer): Scheduled tasks</li>
<li><strong>Device units</strong> (.device): Device files</li>
<li><strong>Path units</strong> (.path): File/directory monitoring</li>
</ul>
<h2 id="service-management-1"><a class="header" href="#service-management-1">Service Management</a></h2>
<h3 id="systemctl-commands"><a class="header" href="#systemctl-commands">systemctl Commands</a></h3>
<pre><code class="language-bash"># Service control
sudo systemctl start service_name
sudo systemctl stop service_name
sudo systemctl restart service_name
sudo systemctl reload service_name         # Reload config without restart
sudo systemctl reload-or-restart service_name

# Enable/disable services (start at boot)
sudo systemctl enable service_name
sudo systemctl disable service_name
sudo systemctl enable --now service_name   # Enable and start

# Check service status
systemctl status service_name
systemctl is-active service_name
systemctl is-enabled service_name
systemctl is-failed service_name

# List services
systemctl list-units --type=service
systemctl list-units --type=service --state=running
systemctl list-units --type=service --state=failed
systemctl list-unit-files --type=service

# Show service configuration
systemctl cat service_name
systemctl show service_name

# Service dependencies
systemctl list-dependencies service_name
</code></pre>
<h3 id="service-examples"><a class="header" href="#service-examples">Service Examples</a></h3>
<pre><code class="language-bash"># Common services
sudo systemctl status nginx
sudo systemctl restart sshd
sudo systemctl enable docker
sudo systemctl start postgresql

# Check all failed services
systemctl --failed

# Mask service (prevent from being started)
sudo systemctl mask service_name
sudo systemctl unmask service_name
</code></pre>
<h2 id="creating-service-units"><a class="header" href="#creating-service-units">Creating Service Units</a></h2>
<h3 id="basic-service-file"><a class="header" href="#basic-service-file">Basic Service File</a></h3>
<pre><code class="language-ini"># /etc/systemd/system/myapp.service
[Unit]
Description=My Application
After=network.target
Wants=network-online.target

[Service]
Type=simple
User=myapp
Group=myapp
WorkingDirectory=/opt/myapp
ExecStart=/opt/myapp/bin/myapp
Restart=on-failure
RestartSec=5s

[Install]
WantedBy=multi-user.target
</code></pre>
<h3 id="service-types"><a class="header" href="#service-types">Service Types</a></h3>
<pre><code class="language-ini"># Type=simple (default)
[Service]
Type=simple
ExecStart=/usr/bin/myapp

# Type=forking (daemon that forks)
[Service]
Type=forking
PIDFile=/var/run/myapp.pid
ExecStart=/usr/bin/myapp --daemon

# Type=oneshot (runs once and exits)
[Service]
Type=oneshot
ExecStart=/usr/bin/backup-script.sh
RemainAfterExit=yes

# Type=notify (sends notification when ready)
[Service]
Type=notify
ExecStart=/usr/bin/myapp
NotifyAccess=main

# Type=dbus (acquires D-Bus name)
[Service]
Type=dbus
BusName=org.example.myapp
ExecStart=/usr/bin/myapp

# Type=idle (delays until all jobs finished)
[Service]
Type=idle
ExecStart=/usr/bin/myapp
</code></pre>
<h3 id="advanced-service-configuration"><a class="header" href="#advanced-service-configuration">Advanced Service Configuration</a></h3>
<pre><code class="language-ini"># /etc/systemd/system/myapp.service
[Unit]
Description=My Web Application
Documentation=https://example.com/docs
After=network-online.target postgresql.service
Wants=network-online.target
Requires=postgresql.service

[Service]
Type=notify
User=www-data
Group=www-data
WorkingDirectory=/opt/myapp

# Environment
Environment="NODE_ENV=production"
Environment="PORT=3000"
EnvironmentFile=/etc/myapp/config

# Execution
ExecStartPre=/usr/bin/myapp-check-config
ExecStart=/usr/bin/node /opt/myapp/server.js
ExecReload=/bin/kill -HUP $MAINPID
ExecStop=/bin/kill -TERM $MAINPID

# Restart policy
Restart=on-failure
RestartSec=5s
StartLimitInterval=10min
StartLimitBurst=5

# Security
PrivateTmp=true
NoNewPrivileges=true
ProtectSystem=strict
ProtectHome=true
ReadWritePaths=/var/lib/myapp
ReadWritePaths=/var/log/myapp

# Resource limits
LimitNOFILE=65536
MemoryLimit=1G
CPUQuota=200%

# Logging
StandardOutput=journal
StandardError=journal
SyslogIdentifier=myapp

[Install]
WantedBy=multi-user.target
</code></pre>
<h3 id="service-management-workflow"><a class="header" href="#service-management-workflow">Service Management Workflow</a></h3>
<pre><code class="language-bash"># Create service file
sudo vim /etc/systemd/system/myapp.service

# Reload systemd configuration
sudo systemctl daemon-reload

# Enable and start service
sudo systemctl enable --now myapp

# Check status
systemctl status myapp

# View logs
journalctl -u myapp -f

# Edit service (creates override)
sudo systemctl edit myapp

# Edit full service file
sudo systemctl edit --full myapp
</code></pre>
<h2 id="timers-cron-alternative"><a class="header" href="#timers-cron-alternative">Timers (Cron Alternative)</a></h2>
<h3 id="timer-unit"><a class="header" href="#timer-unit">Timer Unit</a></h3>
<pre><code class="language-ini"># /etc/systemd/system/backup.timer
[Unit]
Description=Daily Backup Timer
Requires=backup.service

[Timer]
OnCalendar=daily
OnCalendar=*-*-* 02:00:00
Persistent=true
Unit=backup.service

[Install]
WantedBy=timers.target
</code></pre>
<h3 id="corresponding-service"><a class="header" href="#corresponding-service">Corresponding Service</a></h3>
<pre><code class="language-ini"># /etc/systemd/system/backup.service
[Unit]
Description=Backup Service

[Service]
Type=oneshot
ExecStart=/usr/local/bin/backup.sh
User=backup
</code></pre>
<h3 id="timer-management"><a class="header" href="#timer-management">Timer Management</a></h3>
<pre><code class="language-bash"># Enable and start timer
sudo systemctl enable --now backup.timer

# List timers
systemctl list-timers
systemctl list-timers --all

# Check timer status
systemctl status backup.timer

# View next run time
systemctl list-timers backup.timer

# Manual trigger
sudo systemctl start backup.service
</code></pre>
<h3 id="timer-examples"><a class="header" href="#timer-examples">Timer Examples</a></h3>
<pre><code class="language-ini"># Every 5 minutes
OnCalendar=*:0/5

# Every hour
OnCalendar=hourly

# Every day at 3:00 AM
OnCalendar=*-*-* 03:00:00

# Every Monday at 9:00 AM
OnCalendar=Mon *-*-* 09:00:00

# First day of month
OnCalendar=*-*-01 00:00:00

# Relative to boot
OnBootSec=15min
OnUnitActiveSec=1h
</code></pre>
<h2 id="journalctl-logging"><a class="header" href="#journalctl-logging">journalctl (Logging)</a></h2>
<h3 id="viewing-logs"><a class="header" href="#viewing-logs">Viewing Logs</a></h3>
<pre><code class="language-bash"># View all logs
journalctl

# Follow logs (like tail -f)
journalctl -f

# Recent logs
journalctl -n 50               # Last 50 lines
journalctl -n 100 --no-pager

# Service-specific logs
journalctl -u nginx
journalctl -u nginx -f
journalctl -u nginx --since today

# Multiple services
journalctl -u nginx -u postgresql

# Time-based filtering
journalctl --since "2024-01-01"
journalctl --since "2024-01-01 10:00" --until "2024-01-01 11:00"
journalctl --since "1 hour ago"
journalctl --since yesterday
journalctl --since "10 min ago"

# Priority filtering
journalctl -p err              # Errors only
journalctl -p warning          # Warnings and above
journalctl -p 0..3             # Emergency to error

# Kernel messages
journalctl -k
journalctl -k -b              # Current boot

# Boot-specific logs
journalctl -b                  # Current boot
journalctl -b -1               # Previous boot
journalctl --list-boots        # List all boots

# Specific process
journalctl _PID=1234

# Output formats
journalctl -o json             # JSON format
journalctl -o json-pretty
journalctl -o verbose
journalctl -o cat              # Just the message

# Disk usage
journalctl --disk-usage

# Verify integrity
journalctl --verify
</code></pre>
<h3 id="journal-management"><a class="header" href="#journal-management">Journal Management</a></h3>
<pre><code class="language-bash"># Clean old logs
sudo journalctl --vacuum-time=7d    # Keep last 7 days
sudo journalctl --vacuum-size=500M  # Keep max 500MB
sudo journalctl --vacuum-files=5    # Keep max 5 files

# Rotate journals
sudo systemctl kill --signal=SIGUSR2 systemd-journald

# Configure retention
# /etc/systemd/journald.conf
[Journal]
SystemMaxUse=500M
SystemMaxFileSize=100M
SystemMaxFiles=5
RuntimeMaxUse=100M
MaxRetentionSec=7day
</code></pre>
<h2 id="targets-runlevels"><a class="header" href="#targets-runlevels">Targets (Runlevels)</a></h2>
<h3 id="common-targets"><a class="header" href="#common-targets">Common Targets</a></h3>
<pre><code class="language-bash"># List targets
systemctl list-units --type=target

# Current target
systemctl get-default

# Change default target
sudo systemctl set-default multi-user.target
sudo systemctl set-default graphical.target

# Switch target
sudo systemctl isolate multi-user.target
sudo systemctl isolate rescue.target

# Common targets
# poweroff.target (runlevel 0)
# rescue.target (runlevel 1)
# multi-user.target (runlevel 3)
# graphical.target (runlevel 5)
# reboot.target (runlevel 6)
</code></pre>
<h2 id="system-management"><a class="header" href="#system-management">System Management</a></h2>
<h3 id="system-control"><a class="header" href="#system-control">System Control</a></h3>
<pre><code class="language-bash"># Reboot/shutdown
sudo systemctl reboot
sudo systemctl poweroff
sudo systemctl halt
sudo systemctl suspend
sudo systemctl hibernate
sudo systemctl hybrid-sleep

# System state
systemctl is-system-running

# Reload systemd configuration
sudo systemctl daemon-reload

# Reexecute systemd
sudo systemctl daemon-reexec

# Show system boot time
systemd-analyze
systemd-analyze blame           # Show service startup times
systemd-analyze critical-chain  # Show critical startup chain
systemd-analyze plot &gt; boot.svg # Generate SVG timeline

# List all units
systemctl list-units
systemctl list-units --all
systemctl list-unit-files

# Check configuration
sudo systemd-analyze verify /etc/systemd/system/myapp.service
</code></pre>
<h3 id="socket-activation"><a class="header" href="#socket-activation">Socket Activation</a></h3>
<pre><code class="language-ini"># /etc/systemd/system/myapp.socket
[Unit]
Description=My App Socket

[Socket]
ListenStream=8080
Accept=no

[Install]
WantedBy=sockets.target

# /etc/systemd/system/myapp.service
[Unit]
Description=My App Service
Requires=myapp.socket

[Service]
ExecStart=/usr/bin/myapp
StandardInput=socket
</code></pre>
<h2 id="path-units-file-monitoring"><a class="header" href="#path-units-file-monitoring">Path Units (File Monitoring)</a></h2>
<pre><code class="language-ini"># /etc/systemd/system/watch-config.path
[Unit]
Description=Watch Config Directory

[Path]
PathModified=/etc/myapp
Unit=process-config.service

[Install]
WantedBy=multi-user.target

# /etc/systemd/system/process-config.service
[Unit]
Description=Process Config Changes

[Service]
Type=oneshot
ExecStart=/usr/local/bin/reload-config.sh
</code></pre>
<h2 id="user-services"><a class="header" href="#user-services">User Services</a></h2>
<pre><code class="language-bash"># User service directory
~/.config/systemd/user/

# User commands (no sudo)
systemctl --user start myservice
systemctl --user enable myservice
systemctl --user status myservice

# User timers
systemctl --user list-timers

# Enable lingering (services run without login)
loginctl enable-linger username

# User journal
journalctl --user
journalctl --user -u myservice
</code></pre>
<h3 id="example-user-service"><a class="header" href="#example-user-service">Example User Service</a></h3>
<pre><code class="language-ini"># ~/.config/systemd/user/myapp.service
[Unit]
Description=My User Application

[Service]
ExecStart=%h/bin/myapp
Restart=on-failure

[Install]
WantedBy=default.target
</code></pre>
<h2 id="security-features-1"><a class="header" href="#security-features-1">Security Features</a></h2>
<h3 id="service-hardening"><a class="header" href="#service-hardening">Service Hardening</a></h3>
<pre><code class="language-ini">[Service]
# User/Group isolation
User=myapp
Group=myapp
DynamicUser=yes                # Create temporary user

# Filesystem restrictions
ProtectSystem=strict           # Read-only /usr, /boot, /efi
ProtectHome=true               # Inaccessible /home
PrivateTmp=true                # Private /tmp
ReadWritePaths=/var/lib/myapp  # Writable paths
ReadOnlyPaths=/etc/myapp
InaccessiblePaths=/root

# Namespace isolation
PrivateDevices=yes             # Private /dev
PrivateNetwork=yes             # Private network namespace
PrivateUsers=yes               # User namespace

# Capabilities
NoNewPrivileges=yes            # Prevent privilege escalation
CapabilityBoundingSet=CAP_NET_BIND_SERVICE
AmbientCapabilities=CAP_NET_BIND_SERVICE

# System calls
SystemCallFilter=@system-service
SystemCallFilter=~@privileged @resources
SystemCallErrorNumber=EPERM

# Misc restrictions
RestrictAddressFamilies=AF_INET AF_INET6
RestrictNamespaces=yes
RestrictRealtime=yes
LockPersonality=yes
ProtectKernelTunables=yes
ProtectKernelModules=yes
ProtectControlGroups=yes
MemoryDenyWriteExecute=yes
</code></pre>
<h2 id="troubleshooting-2"><a class="header" href="#troubleshooting-2">Troubleshooting</a></h2>
<h3 id="common-issues-4"><a class="header" href="#common-issues-4">Common Issues</a></h3>
<pre><code class="language-bash"># Service won't start
systemctl status service_name
journalctl -u service_name -n 50
journalctl -xe

# Check service configuration
systemd-analyze verify /etc/systemd/system/myapp.service

# Dependency issues
systemctl list-dependencies service_name
systemctl list-dependencies --reverse service_name

# Stuck service
sudo systemctl kill service_name
sudo systemctl kill -s SIGKILL service_name

# Reset failed state
sudo systemctl reset-failed service_name
sudo systemctl reset-failed

# Show why service failed
systemctl status service_name --no-pager --full

# Debug mode
sudo SYSTEMD_LOG_LEVEL=debug systemctl start service_name

# Emergency shell
# Add to kernel command line: systemd.unit=emergency.target
</code></pre>
<h3 id="debugging-services"><a class="header" href="#debugging-services">Debugging Services</a></h3>
<pre><code class="language-ini"># Add debug output to service
[Service]
Environment="DEBUG=true"
StandardOutput=journal+console
StandardError=journal+console

# Increase log level
LogLevel=debug

# Show environment
systemctl show-environment
systemctl show service_name
</code></pre>
<h2 id="best-practices-20"><a class="header" href="#best-practices-20">Best Practices</a></h2>
<pre><code class="language-ini"># 1. Use After= and Wants= for dependencies
[Unit]
After=network-online.target
Wants=network-online.target

# 2. Set restart policy
[Service]
Restart=on-failure
RestartSec=5s
StartLimitInterval=10min
StartLimitBurst=5

# 3. Use specific user
[Service]
User=myapp
Group=myapp

# 4. Set working directory
[Service]
WorkingDirectory=/opt/myapp

# 5. Use environment files
[Service]
EnvironmentFile=/etc/myapp/config

# 6. Add security restrictions
[Service]
ProtectSystem=strict
PrivateTmp=true
NoNewPrivileges=true

# 7. Proper logging
[Service]
StandardOutput=journal
StandardError=journal
SyslogIdentifier=myapp

# 8. Resource limits
[Service]
LimitNOFILE=65536
MemoryMax=1G

# 9. Use timers instead of cron
# Create .timer and .service files

# 10. Test configuration
sudo systemd-analyze verify myapp.service
</code></pre>
<h2 id="quick-reference-3"><a class="header" href="#quick-reference-3">Quick Reference</a></h2>
<h3 id="service-management-2"><a class="header" href="#service-management-2">Service Management</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody>
<tr><td><code>systemctl start</code></td><td>Start service</td></tr>
<tr><td><code>systemctl stop</code></td><td>Stop service</td></tr>
<tr><td><code>systemctl restart</code></td><td>Restart service</td></tr>
<tr><td><code>systemctl reload</code></td><td>Reload configuration</td></tr>
<tr><td><code>systemctl enable</code></td><td>Enable at boot</td></tr>
<tr><td><code>systemctl disable</code></td><td>Disable at boot</td></tr>
<tr><td><code>systemctl status</code></td><td>Show service status</td></tr>
<tr><td><code>systemctl is-active</code></td><td>Check if active</td></tr>
<tr><td><code>systemctl is-enabled</code></td><td>Check if enabled</td></tr>
</tbody></table>
</div>
<h3 id="journalctl"><a class="header" href="#journalctl">Journalctl</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody>
<tr><td><code>journalctl -u SERVICE</code></td><td>Service logs</td></tr>
<tr><td><code>journalctl -f</code></td><td>Follow logs</td></tr>
<tr><td><code>journalctl -b</code></td><td>Current boot logs</td></tr>
<tr><td><code>journalctl --since</code></td><td>Time-filtered logs</td></tr>
<tr><td><code>journalctl -p err</code></td><td>Error priority logs</td></tr>
<tr><td><code>journalctl -k</code></td><td>Kernel messages</td></tr>
</tbody></table>
</div>
<p>systemd provides a powerful, modern init system with extensive features for service management, logging, and system administration, making it the standard for most Linux distributions.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sysctl"><a class="header" href="#sysctl">sysctl</a></h1>
<p>sysctl is a tool for examining and changing kernel parameters at runtime. It's used to modify kernel behavior without rebooting.</p>
<h2 id="basic-usage"><a class="header" href="#basic-usage">Basic Usage</a></h2>
<pre><code class="language-bash"># List all parameters
sysctl -a

# Get specific parameter
sysctl net.ipv4.ip_forward

# Set parameter (temporary)
sudo sysctl -w net.ipv4.ip_forward=1

# Load from configuration file
sudo sysctl -p /etc/sysctl.conf
</code></pre>
<h2 id="common-parameters"><a class="header" href="#common-parameters">Common Parameters</a></h2>
<pre><code class="language-bash"># Network settings
net.ipv4.ip_forward = 1                    # Enable IP forwarding
net.ipv4.tcp_syncookies = 1                # SYN flood protection
net.core.somaxconn = 1024                  # Connection backlog
net.ipv4.tcp_max_syn_backlog = 2048        # SYN backlog

# Memory settings
vm.swappiness = 10                         # Swap preference (0-100)
vm.dirty_ratio = 15                        # Dirty page threshold
vm.overcommit_memory = 1                   # Memory overcommit

# File system
fs.file-max = 65536                        # Max open files
fs.inotify.max_user_watches = 524288       # inotify watches

# Kernel settings
kernel.sysrq = 1                           # Enable SysRq key
kernel.panic = 10                          # Reboot after panic (seconds)
</code></pre>
<h2 id="persistent-configuration"><a class="header" href="#persistent-configuration">Persistent Configuration</a></h2>
<pre><code class="language-bash"># /etc/sysctl.conf or /etc/sysctl.d/99-custom.conf
net.ipv4.ip_forward = 1
vm.swappiness = 10
fs.file-max = 100000

# Apply configuration
sudo sysctl -p
</code></pre>
<h2 id="performance-tuning-1"><a class="header" href="#performance-tuning-1">Performance Tuning</a></h2>
<pre><code class="language-bash"># High-performance networking
net.core.rmem_max = 134217728
net.core.wmem_max = 134217728
net.ipv4.tcp_rmem = 4096 87380 67108864
net.ipv4.tcp_wmem = 4096 65536 67108864
net.ipv4.tcp_congestion_control = bbr

# Database server optimization
vm.swappiness = 1
vm.dirty_background_ratio = 5
vm.dirty_ratio = 10
</code></pre>
<p>sysctl provides runtime kernel tuning for optimizing system performance and behavior.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sysfs"><a class="header" href="#sysfs">sysfs</a></h1>
<p>sysfs is a virtual filesystem that exports information about kernel subsystems, hardware devices, and associated device drivers to userspace.</p>
<h2 id="overview-17"><a class="header" href="#overview-17">Overview</a></h2>
<p>sysfs is mounted at <code>/sys</code> and provides:</p>
<ul>
<li>Device information</li>
<li>Driver parameters</li>
<li>Kernel configuration</li>
<li>Power management settings</li>
</ul>
<h2 id="structure"><a class="header" href="#structure">Structure</a></h2>
<pre><code class="language-bash">/sys/
├── block/          # Block devices
├── bus/            # Bus types (pci, usb, etc.)
├── class/          # Device classes (network, input, etc.)
├── devices/        # Device tree
├── firmware/       # Firmware information
├── fs/             # Filesystem information
├── kernel/         # Kernel parameters
├── module/         # Loaded kernel modules
└── power/          # Power management
</code></pre>
<h2 id="common-usage"><a class="header" href="#common-usage">Common Usage</a></h2>
<pre><code class="language-bash"># List block devices
ls /sys/block/

# Device information
cat /sys/class/net/eth0/address      # MAC address
cat /sys/class/net/eth0/speed        # Link speed
cat /sys/class/net/eth0/operstate    # Interface state

# CPU information
cat /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor
ls /sys/devices/system/cpu/cpu*/topology/

# GPU information
cat /sys/class/drm/card0/device/vendor
cat /sys/class/drm/card0/device/device

# USB devices
ls /sys/bus/usb/devices/

# Module parameters
ls /sys/module/*/parameters/
cat /sys/module/bluetooth/parameters/disable_esco
</code></pre>
<h2 id="power-management-3"><a class="header" href="#power-management-3">Power Management</a></h2>
<pre><code class="language-bash"># CPU frequency scaling
echo "performance" | sudo tee /sys/devices/system/cpu/cpu*/cpufreq/scaling_governor

# Device power state
cat /sys/class/net/eth0/device/power/runtime_status

# Display brightness
echo 50 | sudo tee /sys/class/backlight/*/brightness
</code></pre>
<h2 id="led-control"><a class="header" href="#led-control">LED Control</a></h2>
<pre><code class="language-bash"># List LEDs
ls /sys/class/leds/

# Control LED
echo 1 &gt; /sys/class/leds/led0/brightness
echo 0 &gt; /sys/class/leds/led0/brightness

# LED trigger
echo "heartbeat" &gt; /sys/class/leds/led0/trigger
</code></pre>
<p>sysfs provides a unified interface for interacting with kernel and hardware information.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="android-development"><a class="header" href="#android-development">Android Development</a></h1>
<h2 id="overview-18"><a class="header" href="#overview-18">Overview</a></h2>
<p>Android is an open-source operating system based on the Linux kernel, designed primarily for mobile devices. It's the world's most popular mobile platform, powering billions of devices worldwide. Android development involves creating applications using Java, Kotlin, or C++ that run on Android devices.</p>
<h2 id="key-concepts-3"><a class="header" href="#key-concepts-3">Key Concepts</a></h2>
<h3 id="android-platform-architecture"><a class="header" href="#android-platform-architecture">Android Platform Architecture</a></h3>
<p>Android is built on a multi-layered architecture:</p>
<ol>
<li><strong>Linux Kernel</strong>: Foundation providing core system services</li>
<li><strong>Hardware Abstraction Layer (HAL)</strong>: Interface between hardware and software</li>
<li><strong>Android Runtime (ART)</strong>: Executes app bytecode with optimized performance</li>
<li><strong>Native C/C++ Libraries</strong>: Core system libraries (SQLite, OpenGL, etc.)</li>
<li><strong>Java API Framework</strong>: High-level APIs for app development</li>
<li><strong>System Apps</strong>: Pre-installed applications</li>
</ol>
<h3 id="core-components-2"><a class="header" href="#core-components-2">Core Components</a></h3>
<p>Android applications are built using four fundamental components:</p>
<ol>
<li><strong>Activities</strong>: Single screen with a user interface</li>
<li><strong>Services</strong>: Background operations without UI</li>
<li><strong>Broadcast Receivers</strong>: Respond to system-wide broadcast announcements</li>
<li><strong>Content Providers</strong>: Manage shared app data</li>
</ol>
<h2 id="development-environment"><a class="header" href="#development-environment">Development Environment</a></h2>
<h3 id="prerequisites"><a class="header" href="#prerequisites">Prerequisites</a></h3>
<ul>
<li><strong>Java Development Kit (JDK)</strong>: Version 8 or higher</li>
<li><strong>Android Studio</strong>: Official IDE for Android development</li>
<li><strong>Android SDK</strong>: Software development kit with tools and APIs</li>
<li><strong>Gradle</strong>: Build automation system</li>
</ul>
<h3 id="installation-2"><a class="header" href="#installation-2">Installation</a></h3>
<pre><code class="language-bash"># Download Android Studio from https://developer.android.com/studio
# Install Android Studio and SDK through the setup wizard

# Verify installation
adb --version
</code></pre>
<h2 id="quick-start-1"><a class="header" href="#quick-start-1">Quick Start</a></h2>
<h3 id="creating-your-first-app"><a class="header" href="#creating-your-first-app">Creating Your First App</a></h3>
<pre><code class="language-kotlin">// MainActivity.kt
package com.example.myfirstapp

import android.os.Bundle
import androidx.appcompat.app.AppCompatActivity
import android.widget.TextView

class MainActivity : AppCompatActivity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)
        
        val textView: TextView = findViewById(R.id.textView)
        textView.text = "Hello, Android!"
    }
}
</code></pre>
<pre><code class="language-xml">&lt;!-- res/layout/activity_main.xml --&gt;
&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    android:gravity="center"&gt;
    
    &lt;TextView
        android:id="@+id/textView"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Hello World!"
        android:textSize="24sp" /&gt;
        
&lt;/LinearLayout&gt;
</code></pre>
<h3 id="androidmanifestxml"><a class="header" href="#androidmanifestxml">AndroidManifest.xml</a></h3>
<p>Every Android app must have a manifest file:</p>
<pre><code class="language-xml">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.myfirstapp"&gt;
    
    &lt;application
        android:allowBackup="true"
        android:icon="@mipmap/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/Theme.AppCompat"&gt;
        
        &lt;activity android:name=".MainActivity"&gt;
            &lt;intent-filter&gt;
                &lt;action android:name="android.intent.action.MAIN" /&gt;
                &lt;category android:name="android.intent.category.LAUNCHER" /&gt;
            &lt;/intent-filter&gt;
        &lt;/activity&gt;
    &lt;/application&gt;
    
    &lt;!-- Permissions --&gt;
    &lt;uses-permission android:name="android.permission.INTERNET" /&gt;
&lt;/manifest&gt;
</code></pre>
<h2 id="android-application-components"><a class="header" href="#android-application-components">Android Application Components</a></h2>
<h3 id="activities-lifecycle"><a class="header" href="#activities-lifecycle">Activities Lifecycle</a></h3>
<pre><code class="language-kotlin">class MyActivity : AppCompatActivity() {
    
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        // Initialize activity
        setContentView(R.layout.activity_my)
    }
    
    override fun onStart() {
        super.onStart()
        // Activity is becoming visible
    }
    
    override fun onResume() {
        super.onResume()
        // Activity is interactive
    }
    
    override fun onPause() {
        super.onPause()
        // Activity is losing focus
    }
    
    override fun onStop() {
        super.onStop()
        // Activity is no longer visible
    }
    
    override fun onDestroy() {
        super.onDestroy()
        // Activity is being destroyed
    }
}
</code></pre>
<h3 id="intents"><a class="header" href="#intents">Intents</a></h3>
<p>Intents are messaging objects used to request actions from other components:</p>
<pre><code class="language-kotlin">// Explicit Intent - Start specific activity
val intent = Intent(this, SecondActivity::class.java)
intent.putExtra("KEY_NAME", "value")
startActivity(intent)

// Implicit Intent - Let system find appropriate component
val browserIntent = Intent(Intent.ACTION_VIEW, Uri.parse("https://www.example.com"))
startActivity(browserIntent)

// Share content
val shareIntent = Intent().apply {
    action = Intent.ACTION_SEND
    putExtra(Intent.EXTRA_TEXT, "Check out this content!")
    type = "text/plain"
}
startActivity(Intent.createChooser(shareIntent, "Share via"))
</code></pre>
<h2 id="ui-development"><a class="header" href="#ui-development">UI Development</a></h2>
<h3 id="views-and-viewgroups"><a class="header" href="#views-and-viewgroups">Views and ViewGroups</a></h3>
<pre><code class="language-kotlin">// Programmatically create UI
val layout = LinearLayout(this).apply {
    orientation = LinearLayout.VERTICAL
    layoutParams = LinearLayout.LayoutParams(
        LinearLayout.LayoutParams.MATCH_PARENT,
        LinearLayout.LayoutParams.MATCH_PARENT
    )
}

val button = Button(this).apply {
    text = "Click Me"
    setOnClickListener {
        Toast.makeText(context, "Button clicked!", Toast.LENGTH_SHORT).show()
    }
}

layout.addView(button)
setContentView(layout)
</code></pre>
<h3 id="recyclerview-example"><a class="header" href="#recyclerview-example">RecyclerView Example</a></h3>
<pre><code class="language-kotlin">// Adapter
class MyAdapter(private val items: List&lt;String&gt;) : 
    RecyclerView.Adapter&lt;MyAdapter.ViewHolder&gt;() {
    
    class ViewHolder(view: View) : RecyclerView.ViewHolder(view) {
        val textView: TextView = view.findViewById(R.id.textView)
    }
    
    override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): ViewHolder {
        val view = LayoutInflater.from(parent.context)
            .inflate(R.layout.item_layout, parent, false)
        return ViewHolder(view)
    }
    
    override fun onBindViewHolder(holder: ViewHolder, position: Int) {
        holder.textView.text = items[position]
    }
    
    override fun getItemCount() = items.size
}

// Usage in Activity
val recyclerView: RecyclerView = findViewById(R.id.recyclerView)
recyclerView.layoutManager = LinearLayoutManager(this)
recyclerView.adapter = MyAdapter(listOf("Item 1", "Item 2", "Item 3"))
</code></pre>
<h2 id="data-storage"><a class="header" href="#data-storage">Data Storage</a></h2>
<h3 id="sharedpreferences"><a class="header" href="#sharedpreferences">SharedPreferences</a></h3>
<pre><code class="language-kotlin">// Save data
val sharedPref = getSharedPreferences("MyPrefs", Context.MODE_PRIVATE)
with(sharedPref.edit()) {
    putString("username", "john_doe")
    putInt("score", 100)
    apply()
}

// Read data
val username = sharedPref.getString("username", "default")
val score = sharedPref.getInt("score", 0)
</code></pre>
<h3 id="room-database"><a class="header" href="#room-database">Room Database</a></h3>
<pre><code class="language-kotlin">// Entity
@Entity(tableName = "users")
data class User(
    @PrimaryKey(autoGenerate = true) val id: Int = 0,
    @ColumnInfo(name = "name") val name: String,
    @ColumnInfo(name = "email") val email: String
)

// DAO
@Dao
interface UserDao {
    @Query("SELECT * FROM users")
    fun getAllUsers(): List&lt;User&gt;
    
    @Insert
    fun insert(user: User)
    
    @Delete
    fun delete(user: User)
}

// Database
@Database(entities = [User::class], version = 1)
abstract class AppDatabase : RoomDatabase() {
    abstract fun userDao(): UserDao
}
</code></pre>
<h2 id="networking-2"><a class="header" href="#networking-2">Networking</a></h2>
<h3 id="retrofit-example"><a class="header" href="#retrofit-example">Retrofit Example</a></h3>
<pre><code class="language-kotlin">// API Interface
interface ApiService {
    @GET("users/{id}")
    suspend fun getUser(@Path("id") userId: Int): User
    
    @POST("users")
    suspend fun createUser(@Body user: User): User
}

// Implementation
val retrofit = Retrofit.Builder()
    .baseUrl("https://api.example.com/")
    .addConverterFactory(GsonConverterFactory.create())
    .build()

val apiService = retrofit.create(ApiService::class.java)

// Usage with Coroutines
lifecycleScope.launch {
    try {
        val user = apiService.getUser(1)
        // Update UI with user data
    } catch (e: Exception) {
        // Handle error
    }
}
</code></pre>
<h2 id="modern-android-development"><a class="header" href="#modern-android-development">Modern Android Development</a></h2>
<h3 id="jetpack-compose"><a class="header" href="#jetpack-compose">Jetpack Compose</a></h3>
<p>Jetpack Compose is Android's modern toolkit for building native UI:</p>
<pre><code class="language-kotlin">@Composable
fun Greeting(name: String) {
    Text(
        text = "Hello $name!",
        modifier = Modifier.padding(16.dp),
        style = MaterialTheme.typography.h4
    )
}

@Composable
fun Counter() {
    var count by remember { mutableStateOf(0) }
    
    Column(
        modifier = Modifier.fillMaxSize(),
        horizontalAlignment = Alignment.CenterHorizontally,
        verticalArrangement = Arrangement.Center
    ) {
        Text("Count: $count")
        Button(onClick = { count++ }) {
            Text("Increment")
        }
    }
}
</code></pre>
<h3 id="viewmodel"><a class="header" href="#viewmodel">ViewModel</a></h3>
<pre><code class="language-kotlin">class MyViewModel : ViewModel() {
    private val _uiState = MutableLiveData&lt;UiState&gt;()
    val uiState: LiveData&lt;UiState&gt; = _uiState
    
    fun loadData() {
        viewModelScope.launch {
            try {
                val data = repository.getData()
                _uiState.value = UiState.Success(data)
            } catch (e: Exception) {
                _uiState.value = UiState.Error(e.message)
            }
        }
    }
}

// Usage in Activity
class MainActivity : AppCompatActivity() {
    private val viewModel: MyViewModel by viewModels()
    
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        
        viewModel.uiState.observe(this) { state -&gt;
            when (state) {
                is UiState.Success -&gt; updateUI(state.data)
                is UiState.Error -&gt; showError(state.message)
            }
        }
    }
}
</code></pre>
<h2 id="testing-2"><a class="header" href="#testing-2">Testing</a></h2>
<h3 id="unit-tests"><a class="header" href="#unit-tests">Unit Tests</a></h3>
<pre><code class="language-kotlin">class CalculatorTest {
    @Test
    fun addition_isCorrect() {
        assertEquals(4, 2 + 2)
    }
    
    @Test
    fun viewModel_loadsData() = runTest {
        val viewModel = MyViewModel(FakeRepository())
        viewModel.loadData()
        
        val state = viewModel.uiState.value
        assertTrue(state is UiState.Success)
    }
}
</code></pre>
<h3 id="instrumented-tests"><a class="header" href="#instrumented-tests">Instrumented Tests</a></h3>
<pre><code class="language-kotlin">@RunWith(AndroidJUnit4::class)
class MainActivityTest {
    @get:Rule
    val activityRule = ActivityScenarioRule(MainActivity::class.java)
    
    @Test
    fun testButtonClick() {
        onView(withId(R.id.button))
            .perform(click())
        
        onView(withId(R.id.textView))
            .check(matches(withText("Button clicked!")))
    }
}
</code></pre>
<h2 id="build-configuration"><a class="header" href="#build-configuration">Build Configuration</a></h2>
<h3 id="buildgradle-module-level"><a class="header" href="#buildgradle-module-level">build.gradle (Module level)</a></h3>
<pre><code class="language-gradle">plugins {
    id 'com.android.application'
    id 'org.jetbrains.kotlin.android'
}

android {
    namespace 'com.example.myapp'
    compileSdk 34
    
    defaultConfig {
        applicationId "com.example.myapp"
        minSdk 24
        targetSdk 34
        versionCode 1
        versionName "1.0"
    }
    
    buildTypes {
        release {
            minifyEnabled true
            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'
        }
    }
    
    compileOptions {
        sourceCompatibility JavaVersion.VERSION_1_8
        targetCompatibility JavaVersion.VERSION_1_8
    }
}

dependencies {
    implementation 'androidx.core:core-ktx:1.12.0'
    implementation 'androidx.appcompat:appcompat:1.6.1'
    implementation 'com.google.android.material:material:1.11.0'
    
    testImplementation 'junit:junit:4.13.2'
    androidTestImplementation 'androidx.test.ext:junit:1.1.5'
}
</code></pre>
<h2 id="best-practices-21"><a class="header" href="#best-practices-21">Best Practices</a></h2>
<ol>
<li><strong>Follow Material Design Guidelines</strong>: Use Material Components for consistent UI</li>
<li><strong>Handle Configuration Changes</strong>: Save state during rotation</li>
<li><strong>Use Architecture Components</strong>: ViewModel, LiveData, Room</li>
<li><strong>Implement Proper Error Handling</strong>: Never ignore exceptions</li>
<li><strong>Optimize Performance</strong>: Avoid blocking the main thread</li>
<li><strong>Test Your Code</strong>: Write unit and instrumented tests</li>
<li><strong>Follow Android Security Best Practices</strong>: Validate inputs, use encryption</li>
<li><strong>Support Multiple Screen Sizes</strong>: Use responsive layouts</li>
<li><strong>Handle Permissions Properly</strong>: Request permissions at runtime</li>
<li><strong>Keep Libraries Updated</strong>: Use latest stable versions</li>
</ol>
<h2 id="resources-6"><a class="header" href="#resources-6">Resources</a></h2>
<h3 id="documentation-3"><a class="header" href="#documentation-3">Documentation</a></h3>
<ul>
<li><a href="https://developer.android.com/">Android Developers</a></li>
<li><a href="https://developer.android.com/reference">Android API Reference</a></li>
<li><a href="https://kotlinlang.org/docs/home.html">Kotlin Documentation</a></li>
<li><a href="https://developer.android.com/jetpack/compose">Jetpack Compose</a></li>
</ul>
<h3 id="related-files"><a class="header" href="#related-files">Related Files</a></h3>
<ul>
<li><a href="android/internals.html">Android Internals</a> - Understanding Android architecture</li>
<li><a href="android/adb.html">ADB Commands</a> - Android Debug Bridge reference</li>
<li><a href="android/development.html">Development Guide</a> - Detailed development workflow</li>
<li><a href="android/binder.html">Android Binder</a> - Inter-process communication mechanism</li>
</ul>
<h2 id="common-issues-5"><a class="header" href="#common-issues-5">Common Issues</a></h2>
<h3 id="gradle-sync-failed"><a class="header" href="#gradle-sync-failed">Gradle Sync Failed</a></h3>
<pre><code class="language-bash"># Clear Gradle cache
./gradlew clean
# Invalidate caches in Android Studio: File &gt; Invalidate Caches / Restart
</code></pre>
<h3 id="app-crashes-on-launch"><a class="header" href="#app-crashes-on-launch">App Crashes on Launch</a></h3>
<ul>
<li>Check Logcat for stack traces</li>
<li>Verify all required permissions are declared</li>
<li>Ensure ProGuard rules are correct for release builds</li>
</ul>
<h3 id="memory-leaks"><a class="header" href="#memory-leaks">Memory Leaks</a></h3>
<ul>
<li>Use LeakCanary for detection</li>
<li>Avoid holding Activity context in long-lived objects</li>
<li>Unregister listeners and callbacks</li>
</ul>
<h2 id="next-steps-1"><a class="header" href="#next-steps-1">Next Steps</a></h2>
<ol>
<li>Complete the <a href="android/development.html">Android Development Guide</a></li>
<li>Learn <a href="android/adb.html">ADB commands</a> for debugging</li>
<li>Study <a href="android/internals.html">Android Internals</a> for deeper understanding</li>
<li>Build sample projects to practice</li>
<li>Explore Jetpack Compose for modern UI development</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="android-internals"><a class="header" href="#android-internals">Android Internals</a></h1>
<h2 id="overview-19"><a class="header" href="#overview-19">Overview</a></h2>
<p>Android is an open-source operating system primarily designed for mobile devices such as smartphones and tablets. It is based on the Linux kernel and developed by Google. Understanding Android internals is crucial for developers who want to create efficient and optimized applications or modify the operating system itself.</p>
<h2 id="key-components"><a class="header" href="#key-components">Key Components</a></h2>
<h3 id="1-linux-kernel"><a class="header" href="#1-linux-kernel">1. Linux Kernel</a></h3>
<p>The Linux kernel is the core of the Android operating system. It provides essential system services such as process management, memory management, security, and hardware abstraction. The kernel also includes drivers for various hardware components like display, camera, and audio.</p>
<h3 id="2-hardware-abstraction-layer-hal"><a class="header" href="#2-hardware-abstraction-layer-hal">2. Hardware Abstraction Layer (HAL)</a></h3>
<p>The Hardware Abstraction Layer (HAL) defines a standard interface for hardware vendors to implement. It allows Android to communicate with the hardware-specific drivers in the Linux kernel. HAL modules are implemented as shared libraries and loaded by the Android system at runtime.</p>
<h3 id="3-android-runtime-art"><a class="header" href="#3-android-runtime-art">3. Android Runtime (ART)</a></h3>
<p>The Android Runtime (ART) is the managed runtime used by applications and some system services on Android. ART executes the Dalvik Executable (DEX) bytecode, which is compiled from Java source code. ART includes features like ahead-of-time (AOT) compilation, just-in-time (JIT) compilation, and garbage collection to improve performance and memory management.</p>
<h3 id="4-native-cc-libraries"><a class="header" href="#4-native-cc-libraries">4. Native C/C++ Libraries</a></h3>
<p>Android provides a set of native libraries written in C and C++ that are used by various components of the system. These libraries include:</p>
<ul>
<li><strong>Bionic</strong>: The standard C library (libc) for Android, derived from BSD's libc.</li>
<li><strong>SurfaceFlinger</strong>: A compositing window manager that renders the display surface.</li>
<li><strong>Media Framework</strong>: Provides support for playing and recording audio and video.</li>
<li><strong>SQLite</strong>: A lightweight relational database engine used for data storage.</li>
</ul>
<h3 id="5-application-framework"><a class="header" href="#5-application-framework">5. Application Framework</a></h3>
<p>The Application Framework provides a set of higher-level services and APIs that developers use to build applications. Key components of the application framework include:</p>
<ul>
<li><strong>Activity Manager</strong>: Manages the lifecycle of applications and activities.</li>
<li><strong>Content Providers</strong>: Manage access to structured data and provide a way to share data between applications.</li>
<li><strong>Resource Manager</strong>: Handles resources like strings, graphics, and layout files.</li>
<li><strong>Notification Manager</strong>: Allows applications to display notifications to the user.</li>
<li><strong>View System</strong>: Provides a set of UI components for building user interfaces.</li>
</ul>
<h3 id="6-system-applications"><a class="header" href="#6-system-applications">6. System Applications</a></h3>
<p>Android includes a set of core system applications that provide basic functionality to the user. These applications are written using the same APIs available to third-party developers. Examples of system applications include:</p>
<ul>
<li><strong>Phone</strong>: Manages phone calls and contacts.</li>
<li><strong>Messages</strong>: Handles SMS and MMS messaging.</li>
<li><strong>Browser</strong>: Provides web browsing capabilities.</li>
<li><strong>Settings</strong>: Allows users to configure system settings.</li>
</ul>
<h2 id="conclusion-3"><a class="header" href="#conclusion-3">Conclusion</a></h2>
<p>Understanding Android internals is essential for developers who want to create high-performance applications or contribute to the Android open-source project. By familiarizing yourself with the key components of the Android operating system, you can gain a deeper insight into how Android works and how to optimize your applications for better performance and user experience.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="android-development-guide"><a class="header" href="#android-development-guide">Android Development Guide</a></h1>
<h2 id="overview-20"><a class="header" href="#overview-20">Overview</a></h2>
<p>This guide covers the complete Android development workflow, from setting up Android Studio to building, debugging, and deploying applications. It focuses on practical development practices and tools that every Android developer should know.</p>
<h2 id="android-studio-setup"><a class="header" href="#android-studio-setup">Android Studio Setup</a></h2>
<h3 id="installation-3"><a class="header" href="#installation-3">Installation</a></h3>
<p>Android Studio is the official IDE for Android development, built on JetBrains' IntelliJ IDEA.</p>
<pre><code class="language-bash"># Download from https://developer.android.com/studio

# Linux installation
sudo tar -xzf android-studio-*.tar.gz -C /opt/
cd /opt/android-studio/bin
./studio.sh

# Add to PATH (optional)
echo 'export PATH=$PATH:/opt/android-studio/bin' &gt;&gt; ~/.bashrc
</code></pre>
<h3 id="initial-configuration-1"><a class="header" href="#initial-configuration-1">Initial Configuration</a></h3>
<ol>
<li><strong>Welcome Screen</strong>: Choose "Standard" installation</li>
<li><strong>SDK Components</strong>: Install latest Android SDK and tools</li>
<li><strong>Emulator</strong>: Install Android Emulator and system images</li>
<li><strong>Gradle</strong>: Let Android Studio manage Gradle installation</li>
</ol>
<h3 id="sdk-manager"><a class="header" href="#sdk-manager">SDK Manager</a></h3>
<pre><code class="language-bash"># Open SDK Manager: Tools &gt; SDK Manager

# Essential SDK Packages:
# - Android SDK Platform (latest)
# - Android SDK Build-Tools
# - Android Emulator
# - Android SDK Platform-Tools
# - Android SDK Tools

# Command-line SDK management
sdkmanager --list
sdkmanager "platform-tools" "platforms;android-34"
sdkmanager --update
</code></pre>
<h3 id="avd-manager"><a class="header" href="#avd-manager">AVD Manager</a></h3>
<p>Create virtual devices for testing:</p>
<pre><code class="language-bash"># Open AVD Manager: Tools &gt; AVD Manager

# Or use command line
avdmanager create avd -n Pixel_7 -k "system-images;android-34;google_apis;x86_64"
avdmanager list avd

# Start emulator from command line
emulator -avd Pixel_7
</code></pre>
<h2 id="project-structure"><a class="header" href="#project-structure">Project Structure</a></h2>
<h3 id="standard-android-project"><a class="header" href="#standard-android-project">Standard Android Project</a></h3>
<pre><code>MyApp/
├── app/
│   ├── src/
│   │   ├── main/
│   │   │   ├── java/com/example/myapp/
│   │   │   │   ├── MainActivity.kt
│   │   │   │   ├── models/
│   │   │   │   ├── viewmodels/
│   │   │   │   └── repositories/
│   │   │   ├── res/
│   │   │   │   ├── layout/
│   │   │   │   ├── values/
│   │   │   │   ├── drawable/
│   │   │   │   ├── mipmap/
│   │   │   │   └── menu/
│   │   │   └── AndroidManifest.xml
│   │   ├── test/          # Unit tests
│   │   └── androidTest/   # Instrumented tests
│   ├── build.gradle
│   └── proguard-rules.pro
├── gradle/
├── build.gradle
├── settings.gradle
└── gradle.properties
</code></pre>
<h3 id="key-directories"><a class="header" href="#key-directories">Key Directories</a></h3>
<ul>
<li><strong>java/</strong>: Source code (Kotlin/Java)</li>
<li><strong>res/</strong>: Resources (layouts, strings, images)</li>
<li><strong>res/layout/</strong>: XML layout files</li>
<li><strong>res/values/</strong>: Strings, colors, dimensions, styles</li>
<li><strong>res/drawable/</strong>: Images and vector graphics</li>
<li><strong>res/mipmap/</strong>: App launcher icons</li>
<li><strong>AndroidManifest.xml</strong>: App configuration and permissions</li>
</ul>
<h2 id="activities"><a class="header" href="#activities">Activities</a></h2>
<h3 id="creating-an-activity"><a class="header" href="#creating-an-activity">Creating an Activity</a></h3>
<p>Activities represent a single screen in your app.</p>
<pre><code class="language-kotlin">// MainActivity.kt
package com.example.myapp

import android.os.Bundle
import android.widget.Button
import android.widget.TextView
import androidx.appcompat.app.AppCompatActivity

class MainActivity : AppCompatActivity() {
    
    private lateinit var textView: TextView
    private lateinit var button: Button
    
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)
        
        // Initialize views
        textView = findViewById(R.id.textView)
        button = findViewById(R.id.button)
        
        // Set click listener
        button.setOnClickListener {
            textView.text = "Button clicked!"
        }
    }
}
</code></pre>
<h3 id="activity-lifecycle"><a class="header" href="#activity-lifecycle">Activity Lifecycle</a></h3>
<pre><code class="language-kotlin">class MyActivity : AppCompatActivity() {
    
    private val TAG = "MyActivity"
    
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        Log.d(TAG, "onCreate called")
        setContentView(R.layout.activity_my)
        
        // Restore saved state
        savedInstanceState?.let {
            val savedText = it.getString("saved_text")
            textView.text = savedText
        }
    }
    
    override fun onStart() {
        super.onStart()
        Log.d(TAG, "onStart called")
        // Activity becoming visible
    }
    
    override fun onResume() {
        super.onResume()
        Log.d(TAG, "onResume called")
        // Activity in foreground, user can interact
        // Start animations, resume sensors
    }
    
    override fun onPause() {
        super.onPause()
        Log.d(TAG, "onPause called")
        // Activity losing focus
        // Pause animations, release sensors
    }
    
    override fun onStop() {
        super.onStop()
        Log.d(TAG, "onStop called")
        // Activity no longer visible
        // Release heavy resources
    }
    
    override fun onDestroy() {
        super.onDestroy()
        Log.d(TAG, "onDestroy called")
        // Activity being destroyed
        // Final cleanup
    }
    
    override fun onSaveInstanceState(outState: Bundle) {
        super.onSaveInstanceState(outState)
        // Save state before activity is killed
        outState.putString("saved_text", textView.text.toString())
    }
}
</code></pre>
<h3 id="registering-activities"><a class="header" href="#registering-activities">Registering Activities</a></h3>
<pre><code class="language-xml">&lt;!-- AndroidManifest.xml --&gt;
&lt;application&gt;
    &lt;!-- Launcher Activity --&gt;
    &lt;activity
        android:name=".MainActivity"
        android:exported="true"&gt;
        &lt;intent-filter&gt;
            &lt;action android:name="android.intent.action.MAIN" /&gt;
            &lt;category android:name="android.intent.category.LAUNCHER" /&gt;
        &lt;/intent-filter&gt;
    &lt;/activity&gt;
    
    &lt;!-- Other Activities --&gt;
    &lt;activity
        android:name=".SecondActivity"
        android:label="@string/second_activity_title"
        android:parentActivityName=".MainActivity" /&gt;
&lt;/application&gt;
</code></pre>
<h2 id="intents-1"><a class="header" href="#intents-1">Intents</a></h2>
<h3 id="explicit-intents"><a class="header" href="#explicit-intents">Explicit Intents</a></h3>
<p>Used to start specific components within your app:</p>
<pre><code class="language-kotlin">// Start another activity
val intent = Intent(this, SecondActivity::class.java)
startActivity(intent)

// Pass data to activity
val intent = Intent(this, DetailActivity::class.java).apply {
    putExtra("USER_ID", 12345)
    putExtra("USERNAME", "john_doe")
    putExtra("USER_DATA", userData) // Parcelable or Serializable
}
startActivity(intent)

// Receive data in target activity
class DetailActivity : AppCompatActivity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        
        val userId = intent.getIntExtra("USER_ID", -1)
        val username = intent.getStringExtra("USERNAME")
        val userData = intent.getParcelableExtra&lt;UserData&gt;("USER_DATA")
    }
}
</code></pre>
<h3 id="activity-results"><a class="header" href="#activity-results">Activity Results</a></h3>
<pre><code class="language-kotlin">// Modern approach using Activity Result API
class MainActivity : AppCompatActivity() {
    
    private val getContent = registerForActivityResult(
        ActivityResultContracts.StartActivityForResult()
    ) { result -&gt;
        if (result.resultCode == Activity.RESULT_OK) {
            val data = result.data?.getStringExtra("RESULT_DATA")
            // Handle result
        }
    }
    
    private fun launchSecondActivity() {
        val intent = Intent(this, SecondActivity::class.java)
        getContent.launch(intent)
    }
}

// Return result from activity
class SecondActivity : AppCompatActivity() {
    
    private fun returnResult() {
        val resultIntent = Intent().apply {
            putExtra("RESULT_DATA", "Some result")
        }
        setResult(Activity.RESULT_OK, resultIntent)
        finish()
    }
}
</code></pre>
<h3 id="implicit-intents"><a class="header" href="#implicit-intents">Implicit Intents</a></h3>
<p>Used to request actions from other apps:</p>
<pre><code class="language-kotlin">// Open web page
val webpage = Uri.parse("https://www.example.com")
val intent = Intent(Intent.ACTION_VIEW, webpage)
startActivity(intent)

// Make phone call
val phoneNumber = Uri.parse("tel:1234567890")
val intent = Intent(Intent.ACTION_DIAL, phoneNumber)
startActivity(intent)

// Send email
val intent = Intent(Intent.ACTION_SENDTO).apply {
    data = Uri.parse("mailto:")
    putExtra(Intent.EXTRA_EMAIL, arrayOf("recipient@example.com"))
    putExtra(Intent.EXTRA_SUBJECT, "Email subject")
    putExtra(Intent.EXTRA_TEXT, "Email body")
}
startActivity(intent)

// Share content
val shareIntent = Intent().apply {
    action = Intent.ACTION_SEND
    putExtra(Intent.EXTRA_TEXT, "Check this out!")
    type = "text/plain"
}
startActivity(Intent.createChooser(shareIntent, "Share via"))

// Take photo
val takePictureIntent = Intent(MediaStore.ACTION_IMAGE_CAPTURE)
if (takePictureIntent.resolveActivity(packageManager) != null) {
    startActivity(takePictureIntent)
}

// Pick image from gallery
val pickPhotoIntent = Intent(Intent.ACTION_PICK, 
    MediaStore.Images.Media.EXTERNAL_CONTENT_URI)
startActivity(pickPhotoIntent)
</code></pre>
<h3 id="intent-filters"><a class="header" href="#intent-filters">Intent Filters</a></h3>
<pre><code class="language-xml">&lt;!-- Declare activity can handle specific actions --&gt;
&lt;activity android:name=".ShareActivity"&gt;
    &lt;intent-filter&gt;
        &lt;action android:name="android.intent.action.SEND" /&gt;
        &lt;category android:name="android.intent.category.DEFAULT" /&gt;
        &lt;data android:mimeType="text/plain" /&gt;
    &lt;/intent-filter&gt;
&lt;/activity&gt;

&lt;!-- Handle custom URL scheme --&gt;
&lt;activity android:name=".DeepLinkActivity"&gt;
    &lt;intent-filter android:autoVerify="true"&gt;
        &lt;action android:name="android.intent.action.VIEW" /&gt;
        &lt;category android:name="android.intent.category.DEFAULT" /&gt;
        &lt;category android:name="android.intent.category.BROWSABLE" /&gt;
        &lt;data
            android:scheme="https"
            android:host="www.example.com"
            android:pathPrefix="/app" /&gt;
    &lt;/intent-filter&gt;
&lt;/activity&gt;
</code></pre>
<h2 id="layouts"><a class="header" href="#layouts">Layouts</a></h2>
<h3 id="xml-layouts"><a class="header" href="#xml-layouts">XML Layouts</a></h3>
<h4 id="linearlayout"><a class="header" href="#linearlayout">LinearLayout</a></h4>
<pre><code class="language-xml">&lt;!-- res/layout/activity_main.xml --&gt;
&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    android:padding="16dp"&gt;
    
    &lt;TextView
        android:id="@+id/titleTextView"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="@string/title"
        android:textSize="24sp"
        android:textStyle="bold" /&gt;
    
    &lt;EditText
        android:id="@+id/nameEditText"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_marginTop="16dp"
        android:hint="@string/enter_name"
        android:inputType="textPersonName" /&gt;
    
    &lt;Button
        android:id="@+id/submitButton"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center"
        android:layout_marginTop="16dp"
        android:text="@string/submit" /&gt;
    
&lt;/LinearLayout&gt;
</code></pre>
<h4 id="constraintlayout"><a class="header" href="#constraintlayout">ConstraintLayout</a></h4>
<pre><code class="language-xml">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;androidx.constraintlayout.widget.ConstraintLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    android:layout_width="match_parent"
    android:layout_height="match_parent"&gt;
    
    &lt;TextView
        android:id="@+id/titleTextView"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/title"
        android:textSize="24sp"
        app:layout_constraintTop_toTopOf="parent"
        app:layout_constraintStart_toStartOf="parent"
        app:layout_constraintEnd_toEndOf="parent"
        android:layout_marginTop="32dp" /&gt;
    
    &lt;ImageView
        android:id="@+id/imageView"
        android:layout_width="200dp"
        android:layout_height="200dp"
        android:src="@drawable/placeholder"
        app:layout_constraintTop_toBottomOf="@id/titleTextView"
        app:layout_constraintStart_toStartOf="parent"
        app:layout_constraintEnd_toEndOf="parent"
        android:layout_marginTop="24dp" /&gt;
    
    &lt;Button
        android:id="@+id/button"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/action"
        app:layout_constraintBottom_toBottomOf="parent"
        app:layout_constraintStart_toStartOf="parent"
        app:layout_constraintEnd_toEndOf="parent"
        android:layout_marginBottom="32dp" /&gt;
    
&lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;
</code></pre>
<h4 id="relativelayout"><a class="header" href="#relativelayout">RelativeLayout</a></h4>
<pre><code class="language-xml">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;RelativeLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:padding="16dp"&gt;
    
    &lt;TextView
        android:id="@+id/header"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentTop="true"
        android:text="@string/header"
        android:textSize="20sp" /&gt;
    
    &lt;Button
        android:id="@+id/button"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerInParent="true"
        android:text="@string/click_me" /&gt;
    
    &lt;TextView
        android:id="@+id/footer"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:text="@string/footer"
        android:gravity="center" /&gt;
    
&lt;/RelativeLayout&gt;
</code></pre>
<h4 id="framelayout"><a class="header" href="#framelayout">FrameLayout</a></h4>
<pre><code class="language-xml">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;FrameLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"&gt;
    
    &lt;!-- Background --&gt;
    &lt;ImageView
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:src="@drawable/background"
        android:scaleType="centerCrop" /&gt;
    
    &lt;!-- Foreground content --&gt;
    &lt;LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_gravity="center"
        android:orientation="vertical"
        android:padding="32dp"&gt;
        
        &lt;TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="@string/welcome"
            android:textSize="32sp"
            android:textColor="@android:color/white" /&gt;
        
    &lt;/LinearLayout&gt;
    
&lt;/FrameLayout&gt;
</code></pre>
<h3 id="view-binding"><a class="header" href="#view-binding">View Binding</a></h3>
<p>Safer alternative to findViewById:</p>
<pre><code class="language-kotlin">// Enable in build.gradle
android {
    buildFeatures {
        viewBinding = true
    }
}

// Usage in Activity
class MainActivity : AppCompatActivity() {
    
    private lateinit var binding: ActivityMainBinding
    
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        binding = ActivityMainBinding.inflate(layoutInflater)
        setContentView(binding.root)
        
        // Access views directly
        binding.button.setOnClickListener {
            binding.textView.text = "Clicked!"
        }
    }
}

// Usage in Fragment
class MyFragment : Fragment() {
    
    private var _binding: FragmentMyBinding? = null
    private val binding get() = _binding!!
    
    override fun onCreateView(
        inflater: LayoutInflater,
        container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View {
        _binding = FragmentMyBinding.inflate(inflater, container, false)
        return binding.root
    }
    
    override fun onDestroyView() {
        super.onDestroyView()
        _binding = null
    }
}
</code></pre>
<h3 id="recyclerview"><a class="header" href="#recyclerview">RecyclerView</a></h3>
<pre><code class="language-kotlin">// Item layout: res/layout/item_user.xml
&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:padding="16dp"
    android:orientation="horizontal"&gt;
    
    &lt;TextView
        android:id="@+id/nameTextView"
        android:layout_width="0dp"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:textSize="18sp" /&gt;
    
&lt;/LinearLayout&gt;

// Data class
data class User(val id: Int, val name: String)

// Adapter
class UserAdapter(private val users: List&lt;User&gt;) : 
    RecyclerView.Adapter&lt;UserAdapter.UserViewHolder&gt;() {
    
    class UserViewHolder(view: View) : RecyclerView.ViewHolder(view) {
        val nameTextView: TextView = view.findViewById(R.id.nameTextView)
    }
    
    override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): UserViewHolder {
        val view = LayoutInflater.from(parent.context)
            .inflate(R.layout.item_user, parent, false)
        return UserViewHolder(view)
    }
    
    override fun onBindViewHolder(holder: UserViewHolder, position: Int) {
        val user = users[position]
        holder.nameTextView.text = user.name
        holder.itemView.setOnClickListener {
            // Handle click
        }
    }
    
    override fun getItemCount() = users.size
}

// Usage
val recyclerView: RecyclerView = findViewById(R.id.recyclerView)
recyclerView.layoutManager = LinearLayoutManager(this)
recyclerView.adapter = UserAdapter(userList)
</code></pre>
<h2 id="fragments"><a class="header" href="#fragments">Fragments</a></h2>
<pre><code class="language-kotlin">// Fragment class
class MyFragment : Fragment() {
    
    private var _binding: FragmentMyBinding? = null
    private val binding get() = _binding!!
    
    override fun onCreateView(
        inflater: LayoutInflater,
        container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View {
        _binding = FragmentMyBinding.inflate(inflater, container, false)
        return binding.root
    }
    
    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {
        super.onViewCreated(view, savedInstanceState)
        
        binding.button.setOnClickListener {
            // Handle click
        }
    }
    
    override fun onDestroyView() {
        super.onDestroyView()
        _binding = null
    }
}

// Add fragment to activity
supportFragmentManager.commit {
    setReorderingAllowed(true)
    add(R.id.fragment_container, MyFragment())
}

// Replace fragment
supportFragmentManager.commit {
    setReorderingAllowed(true)
    replace(R.id.fragment_container, AnotherFragment())
    addToBackStack("transaction_name")
}

// Pass arguments to fragment
val fragment = MyFragment().apply {
    arguments = Bundle().apply {
        putString("ARG_NAME", "value")
        putInt("ARG_ID", 123)
    }
}

// Retrieve arguments in fragment
val name = arguments?.getString("ARG_NAME")
val id = arguments?.getInt("ARG_ID")
</code></pre>
<h2 id="resources-7"><a class="header" href="#resources-7">Resources</a></h2>
<h3 id="strings-3"><a class="header" href="#strings-3">Strings</a></h3>
<pre><code class="language-xml">&lt;!-- res/values/strings.xml --&gt;
&lt;resources&gt;
    &lt;string name="app_name"&gt;My App&lt;/string&gt;
    &lt;string name="welcome_message"&gt;Welcome, %1$s!&lt;/string&gt;
    &lt;string name="items_count"&gt;You have %d items&lt;/string&gt;
    
    &lt;plurals name="number_of_items"&gt;
        &lt;item quantity="one"&gt;%d item&lt;/item&gt;
        &lt;item quantity="other"&gt;%d items&lt;/item&gt;
    &lt;/plurals&gt;
&lt;/resources&gt;

&lt;!-- Usage in code --&gt;
val welcome = getString(R.string.welcome_message, "John")
val count = getString(R.string.items_count, 5)
val plural = resources.getQuantityString(R.plurals.number_of_items, count, count)
</code></pre>
<h3 id="colors"><a class="header" href="#colors">Colors</a></h3>
<pre><code class="language-xml">&lt;!-- res/values/colors.xml --&gt;
&lt;resources&gt;
    &lt;color name="purple_200"&gt;#FFBB86FC&lt;/color&gt;
    &lt;color name="purple_500"&gt;#FF6200EE&lt;/color&gt;
    &lt;color name="purple_700"&gt;#FF3700B3&lt;/color&gt;
    &lt;color name="teal_200"&gt;#FF03DAC5&lt;/color&gt;
    &lt;color name="black"&gt;#FF000000&lt;/color&gt;
    &lt;color name="white"&gt;#FFFFFFFF&lt;/color&gt;
&lt;/resources&gt;
</code></pre>
<h3 id="dimensions"><a class="header" href="#dimensions">Dimensions</a></h3>
<pre><code class="language-xml">&lt;!-- res/values/dimens.xml --&gt;
&lt;resources&gt;
    &lt;dimen name="padding_small"&gt;8dp&lt;/dimen&gt;
    &lt;dimen name="padding_medium"&gt;16dp&lt;/dimen&gt;
    &lt;dimen name="padding_large"&gt;24dp&lt;/dimen&gt;
    &lt;dimen name="text_size_small"&gt;12sp&lt;/dimen&gt;
    &lt;dimen name="text_size_medium"&gt;16sp&lt;/dimen&gt;
    &lt;dimen name="text_size_large"&gt;20sp&lt;/dimen&gt;
&lt;/resources&gt;
</code></pre>
<h3 id="styles-and-themes"><a class="header" href="#styles-and-themes">Styles and Themes</a></h3>
<pre><code class="language-xml">&lt;!-- res/values/styles.xml --&gt;
&lt;resources&gt;
    &lt;!-- Base application theme --&gt;
    &lt;style name="AppTheme" parent="Theme.MaterialComponents.DayNight"&gt;
        &lt;item name="colorPrimary"&gt;@color/purple_500&lt;/item&gt;
        &lt;item name="colorPrimaryVariant"&gt;@color/purple_700&lt;/item&gt;
        &lt;item name="colorOnPrimary"&gt;@color/white&lt;/item&gt;
        &lt;item name="colorSecondary"&gt;@color/teal_200&lt;/item&gt;
    &lt;/style&gt;
    
    &lt;!-- Custom style --&gt;
    &lt;style name="CustomButton" parent="Widget.MaterialComponents.Button"&gt;
        &lt;item name="android:textColor"&gt;@color/white&lt;/item&gt;
        &lt;item name="backgroundTint"&gt;@color/purple_500&lt;/item&gt;
        &lt;item name="cornerRadius"&gt;8dp&lt;/item&gt;
    &lt;/style&gt;
&lt;/resources&gt;
</code></pre>
<h2 id="debugging-3"><a class="header" href="#debugging-3">Debugging</a></h2>
<h3 id="logcat"><a class="header" href="#logcat">Logcat</a></h3>
<pre><code class="language-kotlin">import android.util.Log

class MainActivity : AppCompatActivity() {
    
    companion object {
        private const val TAG = "MainActivity"
    }
    
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        
        // Different log levels
        Log.v(TAG, "Verbose message")   // Verbose
        Log.d(TAG, "Debug message")     // Debug
        Log.i(TAG, "Info message")      // Info
        Log.w(TAG, "Warning message")   // Warning
        Log.e(TAG, "Error message")     // Error
        
        // Log with exception
        try {
            // Code that might throw
        } catch (e: Exception) {
            Log.e(TAG, "Error occurred", e)
        }
    }
}
</code></pre>
<h3 id="breakpoints"><a class="header" href="#breakpoints">Breakpoints</a></h3>
<ol>
<li>Click left margin in code editor to set breakpoint</li>
<li>Run app in Debug mode (Shift + F9)</li>
<li>Use Debug panel to step through code:
<ul>
<li>Step Over (F8)</li>
<li>Step Into (F7)</li>
<li>Step Out (Shift + F8)</li>
<li>Resume (F9)</li>
</ul>
</li>
</ol>
<h3 id="layout-inspector"><a class="header" href="#layout-inspector">Layout Inspector</a></h3>
<pre><code>Tools &gt; Layout Inspector

- View hierarchy in real-time
- Inspect view properties
- Debug rendering issues
</code></pre>
<h2 id="build-and-deploy"><a class="header" href="#build-and-deploy">Build and Deploy</a></h2>
<h3 id="building-apk"><a class="header" href="#building-apk">Building APK</a></h3>
<pre><code class="language-bash"># Debug build
./gradlew assembleDebug

# Release build
./gradlew assembleRelease

# Install debug APK
./gradlew installDebug

# APK location
# Debug: app/build/outputs/apk/debug/app-debug.apk
# Release: app/build/outputs/apk/release/app-release.apk
</code></pre>
<h3 id="signing-configuration"><a class="header" href="#signing-configuration">Signing Configuration</a></h3>
<pre><code class="language-gradle">// app/build.gradle
android {
    signingConfigs {
        release {
            storeFile file("release-keystore.jks")
            storePassword "your_store_password"
            keyAlias "your_key_alias"
            keyPassword "your_key_password"
        }
    }
    
    buildTypes {
        release {
            signingConfig signingConfigs.release
            minifyEnabled true
            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'),
                         'proguard-rules.pro'
        }
    }
}
</code></pre>
<h3 id="proguard-rules"><a class="header" href="#proguard-rules">ProGuard Rules</a></h3>
<pre><code class="language-proguard"># app/proguard-rules.pro

# Keep model classes
-keep class com.example.app.models.** { *; }

# Keep Parcelable implementations
-keep class * implements android.os.Parcelable {
    public static final ** CREATOR;
}

# Gson
-keepattributes Signature
-keepattributes *Annotation*
-keep class com.google.gson.** { *; }

# Retrofit
-keepattributes Signature
-keepattributes Exceptions
-keep class retrofit2.** { *; }
</code></pre>
<h2 id="best-practices-22"><a class="header" href="#best-practices-22">Best Practices</a></h2>
<ol>
<li><strong>Use ConstraintLayout</strong> for complex, flat hierarchies</li>
<li><strong>Implement View Binding</strong> instead of findViewById</li>
<li><strong>Follow Material Design</strong> guidelines</li>
<li><strong>Use string resources</strong> instead of hardcoded strings</li>
<li><strong>Handle configuration changes</strong> properly</li>
<li><strong>Use Fragments</strong> for reusable UI components</li>
<li><strong>Implement proper error handling</strong> and user feedback</li>
<li><strong>Test on multiple devices</strong> and screen sizes</li>
<li><strong>Optimize layouts</strong> to reduce overdraw</li>
<li><strong>Use Android Architecture Components</strong> (ViewModel, LiveData, Room)</li>
</ol>
<h2 id="related-resources"><a class="header" href="#related-resources">Related Resources</a></h2>
<ul>
<li><a href="android/README.html">Android Overview</a></li>
<li><a href="android/internals.html">Android Internals</a></li>
<li><a href="android/adb.html">ADB Commands</a></li>
<li><a href="https://developer.android.com/">Official Android Documentation</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="android-binder"><a class="header" href="#android-binder">Android Binder</a></h1>
<p>Binder is Android's inter-process communication (IPC) mechanism. It's a custom implementation allowing processes to communicate efficiently and securely.</p>
<h2 id="overview-21"><a class="header" href="#overview-21">Overview</a></h2>
<p>Binder enables:</p>
<ul>
<li>Cross-process method invocation</li>
<li>Object reference passing</li>
<li>Security via UID/PID checking</li>
<li>Death notification</li>
</ul>
<h2 id="architecture-2"><a class="header" href="#architecture-2">Architecture</a></h2>
<pre><code>Client Process          Binder Driver         Server Process
    │                        │                       │
    │──Service Request──────&gt;│                       │
    │                        │──Forward Request────&gt;│
    │                        │&lt;──Response───────────│
    │&lt;──Return Result────────│                       │
</code></pre>
<h2 id="aidl-android-interface-definition-language"><a class="header" href="#aidl-android-interface-definition-language">AIDL (Android Interface Definition Language)</a></h2>
<pre><code class="language-java">// ICalculator.aidl
package com.example;

interface ICalculator {
    int add(int a, int b);
    int subtract(int a, int b);
}
</code></pre>
<h2 id="service-implementation"><a class="header" href="#service-implementation">Service Implementation</a></h2>
<pre><code class="language-java">// CalculatorService.java
public class CalculatorService extends Service {
    private final ICalculator.Stub binder = new ICalculator.Stub() {
        @Override
        public int add(int a, int b) {
            return a + b;
        }

        @Override
        public int subtract(int a, int b) {
            return a - b;
        }
    };

    @Override
    public IBinder onBind(Intent intent) {
        return binder;
    }
}
</code></pre>
<h2 id="client-usage"><a class="header" href="#client-usage">Client Usage</a></h2>
<pre><code class="language-java">// Client code
ServiceConnection connection = new ServiceConnection() {
    public void onServiceConnected(ComponentName name, IBinder service) {
        ICalculator calculator = ICalculator.Stub.asInterface(service);
        int result = calculator.add(5, 3);  // Result: 8
    }

    public void onServiceDisconnected(ComponentName name) {
        // Handle disconnection
    }
};

bindService(intent, connection, Context.BIND_AUTO_CREATE);
</code></pre>
<h2 id="key-features-3"><a class="header" href="#key-features-3">Key Features</a></h2>
<ul>
<li><strong>Security</strong>: Permission checking at IPC boundaries</li>
<li><strong>Reference Counting</strong>: Automatic resource management</li>
<li><strong>Death Recipients</strong>: Notification when remote process dies</li>
<li><strong>Asynchronous</strong>: Non-blocking calls with oneway keyword</li>
</ul>
<p>Binder is fundamental to Android's architecture, enabling system services and app communication.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="android-debug-bridge-adb"><a class="header" href="#android-debug-bridge-adb">Android Debug Bridge (ADB)</a></h1>
<h2 id="overview-22"><a class="header" href="#overview-22">Overview</a></h2>
<p>Android Debug Bridge (ADB) is a versatile command-line tool that lets you communicate with an Android device. ADB facilitates a variety of device actions, such as installing and debugging apps, and it provides access to a Unix shell that you can use to run various commands on a device.</p>
<p>ADB is included in the Android SDK Platform Tools package and can be used with physical devices connected via USB or with emulators.</p>
<h2 id="installation-4"><a class="header" href="#installation-4">Installation</a></h2>
<h3 id="linuxmac"><a class="header" href="#linuxmac">Linux/Mac</a></h3>
<pre><code class="language-bash"># Install via Android SDK Platform Tools
# Or use package manager
sudo apt install adb  # Ubuntu/Debian
brew install android-platform-tools  # macOS

# Verify installation
adb version
</code></pre>
<h3 id="windows"><a class="header" href="#windows">Windows</a></h3>
<pre><code class="language-bash"># Download Android SDK Platform Tools from:
# https://developer.android.com/studio/releases/platform-tools

# Add to PATH and verify
adb version
</code></pre>
<h2 id="setup-and-connection"><a class="header" href="#setup-and-connection">Setup and Connection</a></h2>
<h3 id="enable-developer-options"><a class="header" href="#enable-developer-options">Enable Developer Options</a></h3>
<ol>
<li>Go to Settings &gt; About Phone</li>
<li>Tap "Build Number" 7 times</li>
<li>Go back to Settings &gt; Developer Options</li>
<li>Enable "USB Debugging"</li>
</ol>
<h3 id="connect-device-via-usb"><a class="header" href="#connect-device-via-usb">Connect Device via USB</a></h3>
<pre><code class="language-bash"># List connected devices
adb devices

# Output example:
# List of devices attached
# 1234567890ABCDEF    device
# emulator-5554       device

# Connect to specific device
adb -s 1234567890ABCDEF shell
</code></pre>
<h3 id="connect-device-via-wifi"><a class="header" href="#connect-device-via-wifi">Connect Device via WiFi</a></h3>
<pre><code class="language-bash"># Connect device via USB first, then:
# Get device IP address
adb shell ip addr show wlan0

# Enable TCP/IP mode on port 5555
adb tcpip 5555

# Disconnect USB and connect via WiFi
adb connect 192.168.1.100:5555

# Verify connection
adb devices

# Disconnect
adb disconnect 192.168.1.100:5555

# Return to USB mode
adb usb
</code></pre>
<h2 id="basic-commands-1"><a class="header" href="#basic-commands-1">Basic Commands</a></h2>
<h3 id="device-management"><a class="header" href="#device-management">Device Management</a></h3>
<pre><code class="language-bash"># List all connected devices
adb devices -l

# Start ADB server
adb start-server

# Kill ADB server
adb kill-server

# Restart ADB server
adb kill-server &amp;&amp; adb start-server

# Wait for device to be connected
adb wait-for-device

# Get device state
adb get-state

# Get device serial number
adb get-serialno
</code></pre>
<h3 id="device-information"><a class="header" href="#device-information">Device Information</a></h3>
<pre><code class="language-bash"># Get device model
adb shell getprop ro.product.model

# Get Android version
adb shell getprop ro.build.version.release

# Get device manufacturer
adb shell getprop ro.product.manufacturer

# Get device serial number
adb shell getprop ro.serialno

# Get device resolution
adb shell wm size

# Get device density
adb shell wm density

# Display all properties
adb shell getprop

# Get battery status
adb shell dumpsys battery

# Get CPU information
adb shell cat /proc/cpuinfo

# Get memory information
adb shell cat /proc/meminfo
</code></pre>
<h2 id="app-management"><a class="header" href="#app-management">App Management</a></h2>
<h3 id="installing-and-uninstalling-apps"><a class="header" href="#installing-and-uninstalling-apps">Installing and Uninstalling Apps</a></h3>
<pre><code class="language-bash"># Install APK
adb install app.apk

# Install APK to specific location
adb install -s /sdcard/app.apk

# Reinstall existing app (keep data)
adb install -r app.apk

# Install APK to SD card
adb install -s app.apk

# Uninstall app
adb uninstall com.example.app

# Uninstall app but keep data
adb uninstall -k com.example.app
</code></pre>
<h3 id="package-information"><a class="header" href="#package-information">Package Information</a></h3>
<pre><code class="language-bash"># List all packages
adb shell pm list packages

# List third-party packages
adb shell pm list packages -3

# List system packages
adb shell pm list packages -s

# Search for specific package
adb shell pm list packages | grep keyword

# Get path of installed package
adb shell pm path com.example.app

# Get app information
adb shell dumpsys package com.example.app

# Clear app data
adb shell pm clear com.example.app

# Enable/Disable app
adb shell pm enable com.example.app
adb shell pm disable com.example.app
</code></pre>
<h3 id="running-apps"><a class="header" href="#running-apps">Running Apps</a></h3>
<pre><code class="language-bash"># Start an activity
adb shell am start -n com.example.app/.MainActivity

# Start activity with data
adb shell am start -a android.intent.action.VIEW -d "https://example.com"

# Start service
adb shell am startservice com.example.app/.MyService

# Broadcast intent
adb shell am broadcast -a android.intent.action.BOOT_COMPLETED

# Force stop app
adb shell am force-stop com.example.app

# Kill app process
adb shell am kill com.example.app
</code></pre>
<h2 id="file-operations-2"><a class="header" href="#file-operations-2">File Operations</a></h2>
<h3 id="copying-files"><a class="header" href="#copying-files">Copying Files</a></h3>
<pre><code class="language-bash"># Copy file from device to computer
adb pull /sdcard/file.txt ~/Desktop/

# Copy file from computer to device
adb push ~/Desktop/file.txt /sdcard/

# Copy directory recursively
adb pull /sdcard/DCIM/ ~/Pictures/

# Copy with progress display
adb pull /sdcard/large_file.mp4 .

# Push multiple files
adb push file1.txt file2.txt /sdcard/
</code></pre>
<h3 id="file-system-navigation-1"><a class="header" href="#file-system-navigation-1">File System Navigation</a></h3>
<pre><code class="language-bash"># Access device shell
adb shell

# Navigate directories (once in shell)
cd /sdcard
ls -la
pwd

# Create directory
adb shell mkdir /sdcard/NewFolder

# Remove file
adb shell rm /sdcard/file.txt

# Remove directory
adb shell rm -r /sdcard/OldFolder

# Change file permissions
adb shell chmod 777 /sdcard/file.txt

# View file contents
adb shell cat /sdcard/file.txt

# Search for files
adb shell find /sdcard -name "*.txt"
</code></pre>
<h2 id="logging-and-debugging"><a class="header" href="#logging-and-debugging">Logging and Debugging</a></h2>
<h3 id="logcat-1"><a class="header" href="#logcat-1">Logcat</a></h3>
<pre><code class="language-bash"># View all logs
adb logcat

# Clear log buffer
adb logcat -c

# View logs with specific priority
adb logcat *:E  # Error
adb logcat *:W  # Warning
adb logcat *:I  # Info
adb logcat *:D  # Debug
adb logcat *:V  # Verbose

# Filter by tag
adb logcat -s MyApp

# Filter by multiple tags
adb logcat -s MyApp:D ActivityManager:W

# Save logs to file
adb logcat &gt; logfile.txt

# View logs with timestamp
adb logcat -v time

# View logs in different formats
adb logcat -v brief
adb logcat -v process
adb logcat -v tag
adb logcat -v thread
adb logcat -v raw
adb logcat -v long

# Filter using grep
adb logcat | grep "keyword"

# View specific buffer
adb logcat -b radio   # Radio/telephony logs
adb logcat -b events  # Event logs
adb logcat -b main    # Main application logs
adb logcat -b system  # System logs
adb logcat -b crash   # Crash logs

# Continuous monitoring with color
adb logcat -v color
</code></pre>
<h3 id="bug-reports"><a class="header" href="#bug-reports">Bug Reports</a></h3>
<pre><code class="language-bash"># Generate bug report
adb bugreport

# Save bug report to file
adb bugreport &gt; bugreport.txt

# Generate zipped bug report (Android 7.0+)
adb bugreport bugreport.zip
</code></pre>
<h2 id="screen-control"><a class="header" href="#screen-control">Screen Control</a></h2>
<h3 id="screenshots-and-screen-recording"><a class="header" href="#screenshots-and-screen-recording">Screenshots and Screen Recording</a></h3>
<pre><code class="language-bash"># Take screenshot
adb shell screencap /sdcard/screenshot.png
adb pull /sdcard/screenshot.png

# Take screenshot (one command)
adb exec-out screencap -p &gt; screenshot.png

# Record screen (Ctrl+C to stop)
adb shell screenrecord /sdcard/demo.mp4

# Record with time limit (max 180 seconds)
adb shell screenrecord --time-limit 30 /sdcard/demo.mp4

# Record with specific size
adb shell screenrecord --size 1280x720 /sdcard/demo.mp4

# Record with specific bitrate
adb shell screenrecord --bit-rate 6000000 /sdcard/demo.mp4

# Pull recorded video
adb pull /sdcard/demo.mp4
</code></pre>
<h3 id="screen-input"><a class="header" href="#screen-input">Screen Input</a></h3>
<pre><code class="language-bash"># Tap at coordinates (x, y)
adb shell input tap 500 1000

# Swipe from (x1,y1) to (x2,y2) over duration ms
adb shell input swipe 500 1000 500 200 300

# Type text
adb shell input text "Hello%sWorld"  # %s represents space

# Press key
adb shell input keyevent KEYCODE_HOME
adb shell input keyevent KEYCODE_BACK
adb shell input keyevent KEYCODE_MENU
adb shell input keyevent 3  # Home key (key code)

# Common key codes
# KEYCODE_HOME = 3
# KEYCODE_BACK = 4
# KEYCODE_MENU = 82
# KEYCODE_POWER = 26
# KEYCODE_VOLUME_UP = 24
# KEYCODE_VOLUME_DOWN = 25
</code></pre>
<h2 id="system-control-1"><a class="header" href="#system-control-1">System Control</a></h2>
<h3 id="power-management-4"><a class="header" href="#power-management-4">Power Management</a></h3>
<pre><code class="language-bash"># Reboot device
adb reboot

# Reboot to recovery mode
adb reboot recovery

# Reboot to bootloader
adb reboot bootloader

# Shutdown device (requires root)
adb shell reboot -p

# Wake up screen
adb shell input keyevent KEYCODE_WAKEUP

# Sleep screen
adb shell input keyevent KEYCODE_SLEEP
</code></pre>
<h3 id="network"><a class="header" href="#network">Network</a></h3>
<pre><code class="language-bash"># Check WiFi status
adb shell dumpsys wifi

# Enable WiFi
adb shell svc wifi enable

# Disable WiFi
adb shell svc wifi disable

# Check network connectivity
adb shell ping -c 4 google.com

# Get IP address
adb shell ip addr show wlan0

# Enable/Disable data
adb shell svc data enable
adb shell svc data disable
</code></pre>
<h3 id="settings"><a class="header" href="#settings">Settings</a></h3>
<pre><code class="language-bash"># Get setting value
adb shell settings get system screen_brightness

# Set setting value
adb shell settings put system screen_brightness 100

# Common settings namespaces:
# - system: User preferences
# - secure: Secure system settings
# - global: Device-wide settings

# Enable airplane mode
adb shell settings put global airplane_mode_on 1
adb shell am broadcast -a android.intent.action.AIRPLANE_MODE

# Disable animations (for testing)
adb shell settings put global window_animation_scale 0
adb shell settings put global transition_animation_scale 0
adb shell settings put global animator_duration_scale 0
</code></pre>
<h2 id="advanced-commands-1"><a class="header" href="#advanced-commands-1">Advanced Commands</a></h2>
<h3 id="dumpsys"><a class="header" href="#dumpsys">Dumpsys</a></h3>
<pre><code class="language-bash"># Get system information
adb shell dumpsys

# Battery information
adb shell dumpsys battery

# Memory usage
adb shell dumpsys meminfo
adb shell dumpsys meminfo com.example.app

# CPU usage
adb shell dumpsys cpuinfo

# Display information
adb shell dumpsys display

# Activity information
adb shell dumpsys activity

# Current activity
adb shell dumpsys activity activities | grep mResumedActivity

# Package information
adb shell dumpsys package com.example.app

# Window information
adb shell dumpsys window
</code></pre>
<h3 id="performance-monitoring"><a class="header" href="#performance-monitoring">Performance Monitoring</a></h3>
<pre><code class="language-bash"># Monitor CPU usage
adb shell top

# Monitor specific process
adb shell top | grep com.example.app

# Get process list
adb shell ps

# Get process info by name
adb shell ps | grep com.example.app

# Memory stats
adb shell procrank

# Disk usage
adb shell df

# Network statistics
adb shell netstat
</code></pre>
<h3 id="database-operations"><a class="header" href="#database-operations">Database Operations</a></h3>
<pre><code class="language-bash"># Access app database (requires root or debuggable app)
adb shell run-as com.example.app

# Navigate to database directory
cd /data/data/com.example.app/databases/

# Pull database
adb exec-out run-as com.example.app cat databases/mydb.db &gt; mydb.db

# Query database using sqlite3
adb shell "run-as com.example.app sqlite3 databases/mydb.db 'SELECT * FROM users;'"
</code></pre>
<h2 id="testing-and-automation"><a class="header" href="#testing-and-automation">Testing and Automation</a></h2>
<h3 id="monkey-testing"><a class="header" href="#monkey-testing">Monkey Testing</a></h3>
<pre><code class="language-bash"># Generate random events
adb shell monkey -p com.example.app 1000

# Monkey with specific event types
adb shell monkey -p com.example.app --pct-touch 70 --pct-motion 30 1000

# Monkey with seed (reproducible)
adb shell monkey -p com.example.app -s 100 1000

# Throttle events (delay in ms)
adb shell monkey -p com.example.app --throttle 500 1000

# Ignore crashes and continue
adb shell monkey -p com.example.app --ignore-crashes 1000
</code></pre>
<h3 id="ui-automator"><a class="header" href="#ui-automator">UI Automator</a></h3>
<pre><code class="language-bash"># Dump UI hierarchy
adb shell uiautomator dump

# Pull UI hierarchy XML
adb pull /sdcard/window_dump.xml

# Run UI Automator test
adb shell uiautomator runtest UiAutomatorTest.jar -c com.example.test.MyTest
</code></pre>
<h2 id="scripting-with-adb"><a class="header" href="#scripting-with-adb">Scripting with ADB</a></h2>
<h3 id="batch-operations"><a class="header" href="#batch-operations">Batch Operations</a></h3>
<pre><code class="language-bash">#!/bin/bash

# Install app on all connected devices
for device in $(adb devices | grep -v "List" | awk '{print $1}'); do
    echo "Installing on device: $device"
    adb -s $device install app.apk
done

# Clear app data on all devices
for device in $(adb devices | grep -v "List" | awk '{print $1}'); do
    echo "Clearing data on device: $device"
    adb -s $device shell pm clear com.example.app
done
</code></pre>
<h3 id="automated-screenshot-script"><a class="header" href="#automated-screenshot-script">Automated Screenshot Script</a></h3>
<pre><code class="language-bash">#!/bin/bash

# Take screenshot and save with timestamp
timestamp=$(date +"%Y%m%d_%H%M%S")
filename="screenshot_${timestamp}.png"

adb exec-out screencap -p &gt; "$filename"
echo "Screenshot saved: $filename"
</code></pre>
<h3 id="log-filtering-script"><a class="header" href="#log-filtering-script">Log Filtering Script</a></h3>
<pre><code class="language-bash">#!/bin/bash

# Monitor logs for specific package
package="com.example.app"
adb logcat | grep --line-buffered "$package" | while read line; do
    echo "[$(date +"%H:%M:%S")] $line"
done
</code></pre>
<h2 id="troubleshooting-3"><a class="header" href="#troubleshooting-3">Troubleshooting</a></h2>
<h3 id="common-issues-6"><a class="header" href="#common-issues-6">Common Issues</a></h3>
<p><strong>Device not detected:</strong></p>
<pre><code class="language-bash"># Check USB connection
lsusb  # Linux
system_profiler SPUSBDataType  # macOS

# Restart ADB
adb kill-server
adb start-server

# Check device authorization
# Accept the authorization prompt on device
</code></pre>
<p><strong>Permission denied:</strong></p>
<pre><code class="language-bash"># Check USB debugging is enabled
# Revoke USB debugging authorizations and reconnect
# Settings &gt; Developer Options &gt; Revoke USB Debugging Authorizations

# Linux: Add udev rules
sudo vim /etc/udev/rules.d/51-android.rules
# Add: SUBSYSTEM=="usb", ATTR{idVendor}=="18d1", MODE="0666", GROUP="plugdev"
sudo udevadm control --reload-rules
</code></pre>
<p><strong>Multiple devices:</strong></p>
<pre><code class="language-bash"># Specify device with -s flag
adb -s 1234567890ABCDEF shell

# Or use -d for physical device, -e for emulator
adb -d shell  # Physical device
adb -e shell  # Emulator
</code></pre>
<h2 id="best-practices-23"><a class="header" href="#best-practices-23">Best Practices</a></h2>
<ol>
<li>Always specify device with <code>-s</code> when multiple devices are connected</li>
<li>Use <code>adb wait-for-device</code> in scripts before commands</li>
<li>Clear logcat before testing: <code>adb logcat -c</code></li>
<li>Use appropriate log levels to reduce noise</li>
<li>Save important logs to files for later analysis</li>
<li>Be careful with <code>rm</code> commands - there's no undo</li>
<li>Test commands on emulator before using on physical device</li>
<li>Keep ADB updated with latest platform tools</li>
<li>Use <code>adb shell</code> for interactive sessions, direct commands for scripts</li>
<li>Always pull important data before performing system changes</li>
</ol>
<h2 id="security-considerations"><a class="header" href="#security-considerations">Security Considerations</a></h2>
<ul>
<li>Disable USB debugging when not in development</li>
<li>Be cautious when connecting to devices over WiFi</li>
<li>Don't leave ADB over TCP/IP enabled on public networks</li>
<li>Review USB debugging authorization requests carefully</li>
<li>Use secure, trusted computers for ADB connections</li>
<li>Never share bug reports publicly without reviewing contents first</li>
</ul>
<h2 id="references"><a class="header" href="#references">References</a></h2>
<ul>
<li><a href="https://developer.android.com/studio/command-line/adb">Official ADB Documentation</a></li>
<li><a href="https://adbshell.com/">ADB Shell Commands</a></li>
<li><a href="android/internals.html">Android Internals</a></li>
<li><a href="android/development.html">Development Guide</a></li>
</ul>
<h2 id="quick-reference-card"><a class="header" href="#quick-reference-card">Quick Reference Card</a></h2>
<pre><code class="language-bash"># Connection
adb devices                    # List devices
adb connect IP:5555           # Connect via WiFi

# Apps
adb install app.apk           # Install app
adb uninstall package.name    # Uninstall app
adb shell pm list packages    # List packages

# Files
adb push local remote         # Upload file
adb pull remote local         # Download file

# Shell
adb shell                     # Interactive shell
adb shell command             # Run single command

# Logs
adb logcat                    # View logs
adb logcat -c                 # Clear logs

# Screen
adb shell screencap /sdcard/s.png    # Screenshot
adb shell screenrecord /sdcard/v.mp4 # Record screen

# System
adb reboot                    # Reboot device
adb shell dumpsys battery     # Battery info
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="data-structures-3"><a class="header" href="#data-structures-3">Data Structures</a></h1>
<h2 id="overview-23"><a class="header" href="#overview-23">Overview</a></h2>
<p>A data structure is a specialized format for organizing, processing, retrieving, and storing data. Different data structures are suited for different kinds of applications, and some are highly specialized for specific tasks. Understanding data structures is fundamental to writing efficient algorithms and building scalable software systems.</p>
<h2 id="why-data-structures-matter"><a class="header" href="#why-data-structures-matter">Why Data Structures Matter</a></h2>
<ol>
<li><strong>Efficiency</strong>: Right data structure can dramatically improve performance</li>
<li><strong>Organization</strong>: Logical way to organize and manage data</li>
<li><strong>Reusability</strong>: Common patterns for solving problems</li>
<li><strong>Abstraction</strong>: Hide implementation details</li>
<li><strong>Optimization</strong>: Trade-offs between time and space complexity</li>
</ol>
<h2 id="classification-of-data-structures"><a class="header" href="#classification-of-data-structures">Classification of Data Structures</a></h2>
<h3 id="linear-data-structures"><a class="header" href="#linear-data-structures">Linear Data Structures</a></h3>
<p>Elements are arranged in sequential order:</p>
<ul>
<li>Arrays</li>
<li>Linked Lists</li>
<li>Stacks</li>
<li>Queues</li>
</ul>
<h3 id="non-linear-data-structures"><a class="header" href="#non-linear-data-structures">Non-Linear Data Structures</a></h3>
<p>Elements are arranged hierarchically or in a network:</p>
<ul>
<li>Trees</li>
<li>Graphs</li>
<li>Tries</li>
<li>Hash Tables</li>
</ul>
<h3 id="static-vs-dynamic"><a class="header" href="#static-vs-dynamic">Static vs Dynamic</a></h3>
<ul>
<li><strong>Static</strong>: Fixed size (arrays)</li>
<li><strong>Dynamic</strong>: Size can change (linked lists, dynamic arrays)</li>
</ul>
<h2 id="core-data-structures-1"><a class="header" href="#core-data-structures-1">Core Data Structures</a></h2>
<h3 id="1-arrays"><a class="header" href="#1-arrays">1. Arrays</a></h3>
<p>Contiguous memory locations storing elements of the same type.</p>
<pre><code class="language-python"># Array operations
arr = [1, 2, 3, 4, 5]

# Access - $O(1)$
element = arr[2]  # 3

# Insert at end - $O(1)$ amortized
arr.append(6)

# Insert at position - $O(n)$
arr.insert(2, 10)

# Delete - $O(n)$
arr.remove(10)

# Search - $O(n)$
if 4 in arr:
    print("Found")

# 2D Array
matrix = [
    [1, 2, 3],
    [4, 5, 6],
    [7, 8, 9]
]

# Access element
value = matrix[1][2]  # 6
</code></pre>
<p><strong>Time Complexity:</strong></p>
<ul>
<li>Access: $O(1)$</li>
<li>Search: $O(n)$</li>
<li>Insert: $O(n)$</li>
<li>Delete: $O(n)$</li>
</ul>
<p><strong>Space Complexity:</strong> $O(n)$</p>
<p>See: <a href="data_structures/arrays.html">Arrays</a></p>
<h3 id="2-linked-lists"><a class="header" href="#2-linked-lists">2. Linked Lists</a></h3>
<p>Nodes connected via pointers, allowing efficient insertion/deletion.</p>
<pre><code class="language-python">class Node:
    def __init__(self, data):
        self.data = data
        self.next = None

class LinkedList:
    def __init__(self):
        self.head = None
    
    def insert_at_beginning(self, data):
        new_node = Node(data)
        new_node.next = self.head
        self.head = new_node
    
    def insert_at_end(self, data):
        new_node = Node(data)
        
        if not self.head:
            self.head = new_node
            return
        
        current = self.head
        while current.next:
            current = current.next
        current.next = new_node
    
    def delete(self, key):
        current = self.head
        
        # Delete head
        if current and current.data == key:
            self.head = current.next
            return
        
        # Delete other node
        prev = None
        while current and current.data != key:
            prev = current
            current = current.next
        
        if current:
            prev.next = current.next
    
    def search(self, key):
        current = self.head
        while current:
            if current.data == key:
                return True
            current = current.next
        return False
    
    def display(self):
        elements = []
        current = self.head
        while current:
            elements.append(current.data)
            current = current.next
        return elements
</code></pre>
<p><strong>Types:</strong></p>
<ul>
<li>Singly Linked List</li>
<li>Doubly Linked List</li>
<li>Circular Linked List</li>
</ul>
<p><strong>Time Complexity:</strong></p>
<ul>
<li>Access: $O(n)$</li>
<li>Search: $O(n)$</li>
<li>Insert at beginning: $O(1)$</li>
<li>Insert at end: $O(n)$ or $O(1)$ with tail pointer</li>
<li>Delete: $O(n)$</li>
</ul>
<p>See: <a href="data_structures/linked_lists.html">Linked Lists</a></p>
<h3 id="3-stacks"><a class="header" href="#3-stacks">3. Stacks</a></h3>
<p>LIFO (Last In, First Out) structure.</p>
<pre><code class="language-python">class Stack:
    def __init__(self):
        self.items = []
    
    def push(self, item):
        """Add item to top - $O(1)$"""
        self.items.append(item)

    def pop(self):
        """Remove and return top item - $O(1)$"""
        if not self.is_empty():
            return self.items.pop()
        raise IndexError("Stack is empty")

    def peek(self):
        """Return top item without removing - $O(1)$"""
        if not self.is_empty():
            return self.items[-1]
        raise IndexError("Stack is empty")

    def is_empty(self):
        """Check if stack is empty - $O(1)$"""
        return len(self.items) == 0

    def size(self):
        """Return number of items - $O(1)$"""
        return len(self.items)

# Usage
stack = Stack()
stack.push(1)
stack.push(2)
stack.push(3)
print(stack.pop())    # 3
print(stack.peek())   # 2

# Applications
def is_balanced(expression):
    """Check if parentheses are balanced"""
    stack = []
    opening = "([{"
    closing = ")]}"
    pairs = {"(": ")", "[": "]", "{": "}"}
    
    for char in expression:
        if char in opening:
            stack.append(char)
        elif char in closing:
            if not stack or pairs[stack.pop()] != char:
                return False
    
    return len(stack) == 0

# Reverse string using stack
def reverse_string(s):
    stack = list(s)
    return ''.join(stack[::-1])
</code></pre>
<p><strong>Applications:</strong></p>
<ul>
<li>Function call stack</li>
<li>Undo/Redo operations</li>
<li>Expression evaluation</li>
<li>Backtracking algorithms</li>
<li>Browser history</li>
</ul>
<p>See: <a href="data_structures/stacks.html">Stacks</a></p>
<h3 id="4-queues"><a class="header" href="#4-queues">4. Queues</a></h3>
<p>FIFO (First In, First Out) structure.</p>
<pre><code class="language-python">from collections import deque

class Queue:
    def __init__(self):
        self.items = deque()
    
    def enqueue(self, item):
        """Add item to rear - $O(1)$"""
        self.items.append(item)

    def dequeue(self):
        """Remove and return front item - $O(1)$"""
        if not self.is_empty():
            return self.items.popleft()
        raise IndexError("Queue is empty")

    def front(self):
        """Return front item - $O(1)$"""
        if not self.is_empty():
            return self.items[0]
        raise IndexError("Queue is empty")

    def is_empty(self):
        """Check if queue is empty - $O(1)$"""
        return len(self.items) == 0

    def size(self):
        """Return number of items - $O(1)$"""
        return len(self.items)

# Priority Queue
import heapq

class PriorityQueue:
    def __init__(self):
        self.heap = []
    
    def push(self, item, priority):
        """Add item with priority - $O(\log n)$"""
        heapq.heappush(self.heap, (priority, item))

    def pop(self):
        """Remove and return highest priority item - $O(\log n)$"""
        if self.heap:
            return heapq.heappop(self.heap)[1]
        raise IndexError("Queue is empty")

# Circular Queue
class CircularQueue:
    def __init__(self, size):
        self.size = size
        self.queue = [None] * size
        self.front = self.rear = -1
    
    def enqueue(self, item):
        if (self.rear + 1) % self.size == self.front:
            raise Exception("Queue is full")
        
        if self.front == -1:
            self.front = 0
        
        self.rear = (self.rear + 1) % self.size
        self.queue[self.rear] = item
    
    def dequeue(self):
        if self.front == -1:
            raise Exception("Queue is empty")
        
        item = self.queue[self.front]
        
        if self.front == self.rear:
            self.front = self.rear = -1
        else:
            self.front = (self.front + 1) % self.size
        
        return item
</code></pre>
<p><strong>Types:</strong></p>
<ul>
<li>Simple Queue</li>
<li>Circular Queue</li>
<li>Priority Queue</li>
<li>Double-Ended Queue (Deque)</li>
</ul>
<p><strong>Applications:</strong></p>
<ul>
<li>Task scheduling</li>
<li>BFS traversal</li>
<li>Print queue</li>
<li>Buffer management</li>
<li>Async processing</li>
</ul>
<p>See: <a href="data_structures/queues.html">Queues</a></p>
<h3 id="5-hash-tables"><a class="header" href="#5-hash-tables">5. Hash Tables</a></h3>
<p>Key-value pairs with $O(1)$ average-case operations.</p>
<pre><code class="language-python">class HashTable:
    def __init__(self, size=10):
        self.size = size
        self.table = [[] for _ in range(size)]
    
    def _hash(self, key):
        """Hash function - $O(1)$"""
        return hash(key) % self.size

    def insert(self, key, value):
        """Insert key-value pair - $O(1)$ average"""
        index = self._hash(key)
        
        # Update if key exists
        for i, (k, v) in enumerate(self.table[index]):
            if k == key:
                self.table[index][i] = (key, value)
                return
        
        # Insert new key-value
        self.table[index].append((key, value))
    
    def get(self, key):
        """Get value by key - $O(1)$ average"""
        index = self._hash(key)
        
        for k, v in self.table[index]:
            if k == key:
                return v
        
        raise KeyError(f"Key '{key}' not found")
    
    def delete(self, key):
        """Delete key-value pair - $O(1)$ average"""
        index = self._hash(key)
        
        for i, (k, v) in enumerate(self.table[index]):
            if k == key:
                self.table[index].pop(i)
                return
        
        raise KeyError(f"Key '{key}' not found")
    
    def contains(self, key):
        """Check if key exists - $O(1)$ average"""
        try:
            self.get(key)
            return True
        except KeyError:
            return False

# Python dict is a hash table
hash_map = {}
hash_map["name"] = "John"
hash_map["age"] = 30

# Counter using hash table
from collections import Counter
text = "hello world"
char_count = Counter(text)
</code></pre>
<p><strong>Collision Resolution:</strong></p>
<ul>
<li>Chaining (linked lists)</li>
<li>Open addressing (linear probing, quadratic probing, double hashing)</li>
</ul>
<p><strong>Time Complexity:</strong></p>
<ul>
<li>Average: $O(1)$ for insert, delete, search</li>
<li>Worst: $O(n)$ with many collisions</li>
</ul>
<p>See: <a href="data_structures/hash_tables.html">Hash Tables</a></p>
<h2 id="advanced-data-structures"><a class="header" href="#advanced-data-structures">Advanced Data Structures</a></h2>
<h3 id="6-trees"><a class="header" href="#6-trees">6. Trees</a></h3>
<p>Hierarchical structure with nodes connected by edges.</p>
<pre><code class="language-python">class TreeNode:
    def __init__(self, value):
        self.value = value
        self.left = None
        self.right = None

class BinarySearchTree:
    def __init__(self):
        self.root = None
    
    def insert(self, value):
        """Insert value - $O(\log n)$ average, $O(n)$ worst"""
        if not self.root:
            self.root = TreeNode(value)
        else:
            self._insert_recursive(self.root, value)
    
    def _insert_recursive(self, node, value):
        if value &lt; node.value:
            if node.left is None:
                node.left = TreeNode(value)
            else:
                self._insert_recursive(node.left, value)
        else:
            if node.right is None:
                node.right = TreeNode(value)
            else:
                self._insert_recursive(node.right, value)
    
    def search(self, value):
        """Search for value - $O(\log n)$ average"""
        return self._search_recursive(self.root, value)
    
    def _search_recursive(self, node, value):
        if node is None or node.value == value:
            return node
        
        if value &lt; node.value:
            return self._search_recursive(node.left, value)
        return self._search_recursive(node.right, value)
    
    def inorder_traversal(self, node, result=None):
        """Inorder: Left -&gt; Root -&gt; Right"""
        if result is None:
            result = []
        
        if node:
            self.inorder_traversal(node.left, result)
            result.append(node.value)
            self.inorder_traversal(node.right, result)
        
        return result
</code></pre>
<p><strong>Types:</strong></p>
<ul>
<li>Binary Tree</li>
<li>Binary Search Tree</li>
<li>AVL Tree (self-balancing)</li>
<li>Red-Black Tree</li>
<li>B-Tree</li>
<li>Heap</li>
</ul>
<p>See: <a href="data_structures/../algorithms/trees.html">Trees documentation in algorithms</a></p>
<h3 id="7-graphs"><a class="header" href="#7-graphs">7. Graphs</a></h3>
<p>Network of nodes (vertices) connected by edges.</p>
<pre><code class="language-python"># Adjacency List representation
class Graph:
    def __init__(self):
        self.graph = {}
    
    def add_vertex(self, vertex):
        """Add vertex - $O(1)$"""
        if vertex not in self.graph:
            self.graph[vertex] = []

    def add_edge(self, v1, v2):
        """Add edge - $O(1)$"""
        if v1 in self.graph and v2 in self.graph:
            self.graph[v1].append(v2)
            self.graph[v2].append(v1)  # For undirected graph
    
    def bfs(self, start):
        """Breadth-First Search - $O(V + E)$"""
        visited = set()
        queue = [start]
        result = []
        
        while queue:
            vertex = queue.pop(0)
            if vertex not in visited:
                visited.add(vertex)
                result.append(vertex)
                queue.extend(self.graph[vertex])
        
        return result
    
    def dfs(self, start, visited=None):
        """Depth-First Search - $O(V + E)$"""
        if visited is None:
            visited = set()
        
        visited.add(start)
        result = [start]
        
        for neighbor in self.graph[start]:
            if neighbor not in visited:
                result.extend(self.dfs(neighbor, visited))
        
        return result

# Adjacency Matrix representation
class GraphMatrix:
    def __init__(self, num_vertices):
        self.num_vertices = num_vertices
        self.matrix = [[0] * num_vertices for _ in range(num_vertices)]
    
    def add_edge(self, v1, v2, weight=1):
        """Add edge with optional weight"""
        self.matrix[v1][v2] = weight
        self.matrix[v2][v1] = weight  # For undirected graph
</code></pre>
<p><strong>Types:</strong></p>
<ul>
<li>Directed/Undirected</li>
<li>Weighted/Unweighted</li>
<li>Cyclic/Acyclic</li>
<li>Connected/Disconnected</li>
</ul>
<p>See: <a href="data_structures/../algorithms/graphs.html">Graph algorithms</a></p>
<h2 id="choosing-the-right-data-structure"><a class="header" href="#choosing-the-right-data-structure">Choosing the Right Data Structure</a></h2>
<h3 id="array-vs-linked-list"><a class="header" href="#array-vs-linked-list">Array vs Linked List</a></h3>
<p><strong>Use Array when:</strong></p>
<ul>
<li>Need random access</li>
<li>Size is known and fixed</li>
<li>Memory is contiguous</li>
<li>Cache performance matters</li>
</ul>
<p><strong>Use Linked List when:</strong></p>
<ul>
<li>Frequent insertions/deletions</li>
<li>Size is unknown</li>
<li>Don't need random access</li>
<li>Memory fragmentation is acceptable</li>
</ul>
<h3 id="stack-vs-queue"><a class="header" href="#stack-vs-queue">Stack vs Queue</a></h3>
<p><strong>Use Stack for:</strong></p>
<ul>
<li>LIFO operations</li>
<li>Recursion simulation</li>
<li>Undo/redo functionality</li>
<li>Expression evaluation</li>
</ul>
<p><strong>Use Queue for:</strong></p>
<ul>
<li>FIFO operations</li>
<li>Scheduling</li>
<li>BFS traversal</li>
<li>Resource sharing</li>
</ul>
<h3 id="hash-table-vs-tree"><a class="header" href="#hash-table-vs-tree">Hash Table vs Tree</a></h3>
<p><strong>Use Hash Table when:</strong></p>
<ul>
<li>Need $O(1)$ lookup</li>
<li>Order doesn't matter</li>
<li>No range queries needed</li>
<li>Keys are hashable</li>
</ul>
<p><strong>Use Tree when:</strong></p>
<ul>
<li>Need sorted order</li>
<li>Range queries required</li>
<li>Prefix searches (Trie)</li>
<li>Hierarchical data</li>
</ul>
<h2 id="performance-comparison"><a class="header" href="#performance-comparison">Performance Comparison</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Operation</th><th>Array</th><th>Linked List</th><th>Stack</th><th>Queue</th><th>Hash Table</th><th>BST</th></tr></thead><tbody>
<tr><td>Access</td><td>$O(1)$</td><td>$O(n)$</td><td>$O(n)$</td><td>$O(n)$</td><td>-</td><td>$O(\log n)$</td></tr>
<tr><td>Search</td><td>$O(n)$</td><td>$O(n)$</td><td>$O(n)$</td><td>$O(n)$</td><td>$O(1)$*</td><td>$O(\log n)$</td></tr>
<tr><td>Insert</td><td>$O(n)$</td><td>$O(1)$**</td><td>$O(1)$</td><td>$O(1)$</td><td>$O(1)$*</td><td>$O(\log n)$</td></tr>
<tr><td>Delete</td><td>$O(n)$</td><td>$O(1)$**</td><td>$O(1)$</td><td>$O(1)$</td><td>$O(1)$*</td><td>$O(\log n)$</td></tr>
</tbody></table>
</div>
<p>* Average case, ** At beginning/with reference</p>
<h2 id="common-operations"><a class="header" href="#common-operations">Common Operations</a></h2>
<h3 id="traversal-patterns"><a class="header" href="#traversal-patterns">Traversal Patterns</a></h3>
<pre><code class="language-python"># Array traversal
for i in range(len(arr)):
    process(arr[i])

# Linked list traversal
current = head
while current:
    process(current.data)
    current = current.next

# Tree traversal (recursion)
def traverse_tree(node):
    if node:
        traverse_tree(node.left)
        process(node.value)
        traverse_tree(node.right)

# Graph traversal (BFS)
def bfs(graph, start):
    visited = set()
    queue = [start]
    
    while queue:
        vertex = queue.pop(0)
        if vertex not in visited:
            visited.add(vertex)
            process(vertex)
            queue.extend(graph[vertex])
</code></pre>
<h3 id="searching-patterns"><a class="header" href="#searching-patterns">Searching Patterns</a></h3>
<pre><code class="language-python"># Linear search - $O(n)$
def linear_search(arr, target):
    for i, val in enumerate(arr):
        if val == target:
            return i
    return -1

# Binary search - $O(\log n)$
def binary_search(arr, target):
    left, right = 0, len(arr) - 1

    while left &lt;= right:
        mid = (left + right) // 2
        if arr[mid] == target:
            return mid
        elif arr[mid] &lt; target:
            left = mid + 1
        else:
            right = mid - 1

    return -1

# Hash table search - $O(1)$
def hash_search(hash_table, key):
    return hash_table.get(key)
</code></pre>
<h2 id="real-world-applications"><a class="header" href="#real-world-applications">Real-World Applications</a></h2>
<h3 id="arrays-4"><a class="header" href="#arrays-4">Arrays</a></h3>
<ul>
<li>Database tables</li>
<li>Image processing (pixel arrays)</li>
<li>Dynamic programming tables</li>
<li>Buffer implementation</li>
</ul>
<h3 id="linked-lists-1"><a class="header" href="#linked-lists-1">Linked Lists</a></h3>
<ul>
<li>Music playlists</li>
<li>Browser history (doubly linked)</li>
<li>Undo functionality</li>
<li>Memory management (free lists)</li>
</ul>
<h3 id="stacks"><a class="header" href="#stacks">Stacks</a></h3>
<ul>
<li>Function call management</li>
<li>Expression evaluation</li>
<li>Backtracking (maze solving)</li>
<li>Browser back button</li>
</ul>
<h3 id="queues"><a class="header" href="#queues">Queues</a></h3>
<ul>
<li>Print spooling</li>
<li>CPU scheduling</li>
<li>BFS traversal</li>
<li>Message queues (async)</li>
</ul>
<h3 id="hash-tables-1"><a class="header" href="#hash-tables-1">Hash Tables</a></h3>
<ul>
<li>Database indexing</li>
<li>Caching</li>
<li>Symbol tables (compilers)</li>
<li>Spell checkers</li>
</ul>
<h3 id="trees"><a class="header" href="#trees">Trees</a></h3>
<ul>
<li>File systems</li>
<li>DOM (HTML)</li>
<li>Decision trees (AI)</li>
<li>Database indexing (B-trees)</li>
</ul>
<h3 id="graphs"><a class="header" href="#graphs">Graphs</a></h3>
<ul>
<li>Social networks</li>
<li>Maps and navigation</li>
<li>Network routing</li>
<li>Recommendation systems</li>
</ul>
<h2 id="interview-preparation"><a class="header" href="#interview-preparation">Interview Preparation</a></h2>
<h3 id="essential-topics"><a class="header" href="#essential-topics">Essential Topics</a></h3>
<ol>
<li>
<p><strong>Arrays and Strings</strong></p>
<ul>
<li>Two pointers</li>
<li>Sliding window</li>
<li>Prefix sums</li>
</ul>
</li>
<li>
<p><strong>Linked Lists</strong></p>
<ul>
<li>Reverse list</li>
<li>Detect cycle</li>
<li>Merge lists</li>
</ul>
</li>
<li>
<p><strong>Stacks and Queues</strong></p>
<ul>
<li>Valid parentheses</li>
<li>Min/max stack</li>
<li>Implement queue with stacks</li>
</ul>
</li>
<li>
<p><strong>Trees</strong></p>
<ul>
<li>Traversals</li>
<li>Height/depth</li>
<li>Lowest common ancestor</li>
</ul>
</li>
<li>
<p><strong>Graphs</strong></p>
<ul>
<li>BFS/DFS</li>
<li>Cycle detection</li>
<li>Shortest path</li>
</ul>
</li>
<li>
<p><strong>Hash Tables</strong></p>
<ul>
<li>Two sum</li>
<li>Group anagrams</li>
<li>LRU cache</li>
</ul>
</li>
</ol>
<h3 id="common-patterns-10"><a class="header" href="#common-patterns-10">Common Patterns</a></h3>
<ul>
<li><strong>Two Pointers</strong>: Array problems</li>
<li><strong>Fast/Slow Pointers</strong>: Linked list cycles</li>
<li><strong>Sliding Window</strong>: Subarray problems</li>
<li><strong>BFS/DFS</strong>: Tree/graph traversal</li>
<li><strong>Backtracking</strong>: Combinatorial problems</li>
<li><strong>Dynamic Programming</strong>: Optimization problems</li>
</ul>
<h2 id="available-resources-1"><a class="header" href="#available-resources-1">Available Resources</a></h2>
<p>Explore detailed guides for specific data structures:</p>
<ol>
<li><a href="data_structures/arrays.html">Arrays</a> - Array operations and techniques</li>
<li><a href="data_structures/linked_lists.html">Linked Lists</a> - Singly, doubly, circular lists</li>
<li><a href="data_structures/stacks.html">Stacks</a> - Stack implementation and applications</li>
<li><a href="data_structures/queues.html">Queues</a> - Queue types and use cases</li>
<li><a href="data_structures/hash_tables.html">Hash Tables</a> - Hashing and collision resolution</li>
<li><a href="data_structures/trees.html">Trees</a> - Binary trees, BST, AVL, traversals</li>
<li><a href="data_structures/graphs.html">Graphs</a> - Graph representations, traversal, algorithms</li>
<li><a href="data_structures/heaps.html">Heaps</a> - Min heaps, max heaps, priority queues</li>
<li><a href="data_structures/tries.html">Tries</a> - Prefix trees, autocomplete, string matching</li>
</ol>
<p>Related algorithm topics:</p>
<ul>
<li><a href="data_structures/../algorithms/sorting.html">Sorting Algorithms</a></li>
<li><a href="data_structures/../algorithms/searching.html">Searching Algorithms</a></li>
<li><a href="data_structures/../algorithms/trees.html">Tree Algorithms</a></li>
<li><a href="data_structures/../algorithms/graphs.html">Graph Algorithms</a></li>
</ul>
<h2 id="best-practices-24"><a class="header" href="#best-practices-24">Best Practices</a></h2>
<ol>
<li><strong>Choose appropriately</strong>: Match data structure to problem</li>
<li><strong>Consider trade-offs</strong>: Time vs space complexity</li>
<li><strong>Test edge cases</strong>: Empty, single element, duplicates</li>
<li><strong>Optimize</strong>: Start simple, then optimize</li>
<li><strong>Document</strong>: Comment complex logic</li>
<li><strong>Practice</strong>: Regular coding practice</li>
<li><strong>Learn patterns</strong>: Recognize common patterns</li>
<li><strong>Understand internals</strong>: Know how they work</li>
</ol>
<h2 id="next-steps-2"><a class="header" href="#next-steps-2">Next Steps</a></h2>
<ol>
<li>Master the fundamental structures (array, linked list, stack, queue)</li>
<li>Practice implementing each structure from scratch</li>
<li>Solve problems using each data structure</li>
<li>Learn when to use each structure</li>
<li>Study advanced structures (trees, graphs, tries)</li>
<li>Practice on coding platforms (LeetCode, HackerRank)</li>
<li>Review time/space complexity for all operations</li>
<li>Work on real-world projects using these structures</li>
</ol>
<p>Remember: Understanding data structures is essential for writing efficient code and succeeding in technical interviews. Focus on understanding the concepts, not just memorizing implementations.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="arrays-5"><a class="header" href="#arrays-5">Arrays</a></h1>
<h2 id="overview-24"><a class="header" href="#overview-24">Overview</a></h2>
<p>An array is a fundamental data structure that stores elements of the same type in contiguous memory locations. Arrays provide fast, constant-time access to elements using an index, making them one of the most commonly used data structures in programming.</p>
<h2 id="key-concepts-4"><a class="header" href="#key-concepts-4">Key Concepts</a></h2>
<h3 id="characteristics"><a class="header" href="#characteristics">Characteristics</a></h3>
<ul>
<li><strong>Fixed Size</strong>: Most arrays have a fixed size determined at creation</li>
<li><strong>Contiguous Memory</strong>: Elements stored sequentially in memory</li>
<li><strong>Index-Based</strong>: Access elements using zero-based indexing</li>
<li><strong>Homogeneous</strong>: All elements must be of the same type</li>
<li><strong>Fast Access</strong>: $O(1)$ time complexity for accessing any element</li>
</ul>
<h3 id="memory-layout-1"><a class="header" href="#memory-layout-1">Memory Layout</a></h3>
<pre><code>Index:     0    1    2    3    4
Array:   | 10 | 20 | 30 | 40 | 50 |
Address: 1000 1004 1008 1012 1016  (for 4-byte integers)
</code></pre>
<h2 id="time-complexity"><a class="header" href="#time-complexity">Time Complexity</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Operation</th><th>Time Complexity</th></tr></thead><tbody>
<tr><td><strong>Access</strong></td><td>$O(1)$</td></tr>
<tr><td><strong>Search</strong></td><td>$O(n)$</td></tr>
<tr><td><strong>Insert (at end)</strong></td><td>$O(1)$ amortized*</td></tr>
<tr><td><strong>Insert (at position)</strong></td><td>$O(n)$</td></tr>
<tr><td><strong>Delete (at end)</strong></td><td>$O(1)$</td></tr>
<tr><td><strong>Delete (at position)</strong></td><td>$O(n)$</td></tr>
</tbody></table>
</div>
<p>*For dynamic arrays like Python lists or C++ vectors</p>
<h2 id="code-examples"><a class="header" href="#code-examples">Code Examples</a></h2>
<h3 id="python"><a class="header" href="#python">Python</a></h3>
<pre><code class="language-python"># Creating arrays
arr = [1, 2, 3, 4, 5]
arr_zeros = [0] * 10  # [0, 0, 0, ..., 0] (10 elements)

# Accessing elements
first = arr[0]        # 1
last = arr[-1]        # 5 (negative indexing)

# Modifying elements
arr[2] = 100          # [1, 2, 100, 4, 5]

# Slicing
sub = arr[1:4]        # [2, 100, 4]
reversed_arr = arr[::-1]  # [5, 4, 100, 2, 1]

# Common operations
arr.append(6)         # Add to end: [1, 2, 100, 4, 5, 6]
arr.insert(2, 99)     # Insert at index: [1, 2, 99, 100, 4, 5, 6]
arr.pop()             # Remove last: returns 6
arr.remove(99)        # Remove first occurrence of 99
length = len(arr)     # Get length

# Iteration
for element in arr:
    print(element)

for index, element in enumerate(arr):
    print(f"Index {index}: {element}")

# List comprehension
squares = [x**2 for x in range(10)]  # [0, 1, 4, 9, 16, ..., 81]
evens = [x for x in arr if x % 2 == 0]  # Filter even numbers

# 2D Arrays (Matrix)
matrix = [
    [1, 2, 3],
    [4, 5, 6],
    [7, 8, 9]
]
element = matrix[1][2]  # Access: 6
</code></pre>
<h3 id="javascript"><a class="header" href="#javascript">JavaScript</a></h3>
<pre><code class="language-javascript">// Creating arrays
let arr = [1, 2, 3, 4, 5];
let arr2 = new Array(10);  // Array with 10 undefined elements
let arr3 = Array.from({length: 5}, (_, i) =&gt; i);  // [0, 1, 2, 3, 4]

// Accessing and modifying
arr[0] = 100;
let last = arr[arr.length - 1];  // 5

// Common methods
arr.push(6);              // Add to end
arr.pop();                // Remove from end
arr.unshift(0);           // Add to beginning
arr.shift();              // Remove from beginning
arr.splice(2, 1, 99);     // Remove 1 element at index 2, insert 99

// Iteration
arr.forEach((element, index) =&gt; {
    console.log(index, element);
});

// Map, filter, reduce
let doubled = arr.map(x =&gt; x * 2);
let evens = arr.filter(x =&gt; x % 2 === 0);
let sum = arr.reduce((acc, x) =&gt; acc + x, 0);

// Find elements
let found = arr.find(x =&gt; x &gt; 3);     // First element &gt; 3
let index = arr.findIndex(x =&gt; x &gt; 3);  // Index of first element &gt; 3
let includes = arr.includes(3);       // true if 3 exists

// Sorting
arr.sort((a, b) =&gt; a - b);  // Ascending
arr.sort((a, b) =&gt; b - a);  // Descending

// Spread operator
let combined = [...arr, ...arr2];
let copy = [...arr];
</code></pre>
<h3 id="c-1"><a class="header" href="#c-1">C++</a></h3>
<pre><code class="language-cpp">#include &lt;iostream&gt;
#include &lt;vector&gt;
#include &lt;array&gt;
using namespace std;

int main() {
    // Static array
    int arr[5] = {1, 2, 3, 4, 5};
    int size = sizeof(arr) / sizeof(arr[0]);  // 5

    // Access and modify
    arr[0] = 100;
    int last = arr[size - 1];

    // std::array (fixed size, safer)
    array&lt;int, 5&gt; std_arr = {1, 2, 3, 4, 5};
    std_arr[0] = 100;
    int sz = std_arr.size();

    // std::vector (dynamic array)
    vector&lt;int&gt; vec = {1, 2, 3, 4, 5};
    vec.push_back(6);         // Add to end
    vec.pop_back();           // Remove from end
    vec.insert(vec.begin() + 2, 99);  // Insert at index 2
    vec.erase(vec.begin() + 2);       // Remove at index 2

    // Iteration
    for (int i = 0; i &lt; vec.size(); i++) {
        cout &lt;&lt; vec[i] &lt;&lt; " ";
    }

    // Range-based for loop
    for (int x : vec) {
        cout &lt;&lt; x &lt;&lt; " ";
    }

    // 2D vector
    vector&lt;vector&lt;int&gt;&gt; matrix(3, vector&lt;int&gt;(4, 0));  // 3x4 matrix of zeros
    matrix[1][2] = 99;

    return 0;
}
</code></pre>
<h3 id="java"><a class="header" href="#java">Java</a></h3>
<pre><code class="language-java">import java.util.ArrayList;
import java.util.Arrays;

public class ArrayExamples {
    public static void main(String[] args) {
        // Static array
        int[] arr = {1, 2, 3, 4, 5};
        int[] arr2 = new int[10];  // 10 elements, initialized to 0

        // Access and modify
        arr[0] = 100;
        int length = arr.length;

        // ArrayList (dynamic array)
        ArrayList&lt;Integer&gt; list = new ArrayList&lt;&gt;();
        list.add(1);
        list.add(2);
        list.add(3);
        list.add(2, 99);  // Insert at index 2
        list.remove(2);   // Remove at index 2
        int element = list.get(1);  // Access index 1
        list.set(1, 100);           // Modify index 1

        // Iteration
        for (int i = 0; i &lt; list.size(); i++) {
            System.out.println(list.get(i));
        }

        for (int x : list) {
            System.out.println(x);
        }

        // Useful methods
        boolean contains = list.contains(3);
        int idx = list.indexOf(3);
        list.sort((a, b) -&gt; a - b);  // Sort

        // Arrays utility
        int[] arr3 = {3, 1, 4, 1, 5};
        Arrays.sort(arr3);
        int index = Arrays.binarySearch(arr3, 4);  // Binary search (sorted array)
    }
}
</code></pre>
<h2 id="common-algorithms"><a class="header" href="#common-algorithms">Common Algorithms</a></h2>
<h3 id="linear-search"><a class="header" href="#linear-search">Linear Search</a></h3>
<pre><code class="language-python">def linear_search(arr, target):
    for i in range(len(arr)):
        if arr[i] == target:
            return i
    return -1  # Not found

# Time: $O(n)$, Space: $O(1)$
</code></pre>
<h3 id="binary-search-sorted-array"><a class="header" href="#binary-search-sorted-array">Binary Search (Sorted Array)</a></h3>
<pre><code class="language-python">def binary_search(arr, target):
    left, right = 0, len(arr) - 1

    while left &lt;= right:
        mid = left + (right - left) // 2  # Avoid overflow

        if arr[mid] == target:
            return mid
        elif arr[mid] &lt; target:
            left = mid + 1
        else:
            right = mid - 1

    return -1  # Not found

# Time: $O(\log n)$, Space: $O(1)$
</code></pre>
<h3 id="two-pointers-technique"><a class="header" href="#two-pointers-technique">Two Pointers Technique</a></h3>
<pre><code class="language-python">def two_sum_sorted(arr, target):
    """Find two numbers that sum to target in sorted array"""
    left, right = 0, len(arr) - 1

    while left &lt; right:
        current_sum = arr[left] + arr[right]
        if current_sum == target:
            return [left, right]
        elif current_sum &lt; target:
            left += 1
        else:
            right -= 1

    return []  # Not found
</code></pre>
<h3 id="sliding-window"><a class="header" href="#sliding-window">Sliding Window</a></h3>
<pre><code class="language-python">def max_sum_subarray(arr, k):
    """Maximum sum of k consecutive elements"""
    if len(arr) &lt; k:
        return None

    # Compute sum of first window
    window_sum = sum(arr[:k])
    max_sum = window_sum

    # Slide the window
    for i in range(k, len(arr)):
        window_sum = window_sum - arr[i - k] + arr[i]
        max_sum = max(max_sum, window_sum)

    return max_sum

# Time: $O(n)$, Space: $O(1)$
</code></pre>
<h3 id="kadanes-algorithm-maximum-subarray"><a class="header" href="#kadanes-algorithm-maximum-subarray">Kadane's Algorithm (Maximum Subarray)</a></h3>
<pre><code class="language-python">def max_subarray_sum(arr):
    """Find maximum sum of any contiguous subarray"""
    max_so_far = arr[0]
    max_ending_here = arr[0]

    for i in range(1, len(arr)):
        max_ending_here = max(arr[i], max_ending_here + arr[i])
        max_so_far = max(max_so_far, max_ending_here)

    return max_so_far

# Time: $O(n)$, Space: $O(1)$
# Example: [-2, 1, -3, 4, -1, 2, 1, -5, 4] -&gt; 6 (subarray [4, -1, 2, 1])
</code></pre>
<h2 id="common-problems"><a class="header" href="#common-problems">Common Problems</a></h2>
<h3 id="reverse-an-array"><a class="header" href="#reverse-an-array">Reverse an Array</a></h3>
<pre><code class="language-python">def reverse(arr):
    left, right = 0, len(arr) - 1
    while left &lt; right:
        arr[left], arr[right] = arr[right], arr[left]
        left += 1
        right -= 1
    return arr
</code></pre>
<h3 id="rotate-array"><a class="header" href="#rotate-array">Rotate Array</a></h3>
<pre><code class="language-python">def rotate_right(arr, k):
    """Rotate array to the right by k positions"""
    n = len(arr)
    k = k % n  # Handle k &gt; n

    # Reverse entire array
    arr.reverse()
    # Reverse first k elements
    arr[:k] = reversed(arr[:k])
    # Reverse remaining elements
    arr[k:] = reversed(arr[k:])

    return arr

# Example: [1, 2, 3, 4, 5], k=2 -&gt; [4, 5, 1, 2, 3]
</code></pre>
<h3 id="remove-duplicates-sorted-array"><a class="header" href="#remove-duplicates-sorted-array">Remove Duplicates (Sorted Array)</a></h3>
<pre><code class="language-python">def remove_duplicates(arr):
    """Remove duplicates in-place, return new length"""
    if not arr:
        return 0

    write_index = 1
    for i in range(1, len(arr)):
        if arr[i] != arr[i - 1]:
            arr[write_index] = arr[i]
            write_index += 1

    return write_index
</code></pre>
<h2 id="best-practices-25"><a class="header" href="#best-practices-25">Best Practices</a></h2>
<h3 id="1-bounds-checking"><a class="header" href="#1-bounds-checking">1. Bounds Checking</a></h3>
<pre><code class="language-python"># Bad
if arr[i] &gt; 0:  # May cause IndexError

# Good
if i &lt; len(arr) and arr[i] &gt; 0:
</code></pre>
<h3 id="2-avoid-modifying-while-iterating"><a class="header" href="#2-avoid-modifying-while-iterating">2. Avoid Modifying While Iterating</a></h3>
<pre><code class="language-python"># Bad
for x in arr:
    if x % 2 == 0:
        arr.remove(x)  # Causes skipping

# Good
arr = [x for x in arr if x % 2 != 0]  # Create new list
</code></pre>
<h3 id="3-use-appropriate-data-structure"><a class="header" href="#3-use-appropriate-data-structure">3. Use Appropriate Data Structure</a></h3>
<ul>
<li>Need frequent insertions/deletions? Consider linked list</li>
<li>Need fast lookups? Consider hash table</li>
<li>Working with numerical data? Use NumPy arrays</li>
</ul>
<h2 id="eli10"><a class="header" href="#eli10">ELI10</a></h2>
<p>Think of an array like a row of mailboxes in an apartment building:</p>
<ul>
<li>Each mailbox has a number (index): 0, 1, 2, 3, ...</li>
<li>Each mailbox can hold one item (element)</li>
<li>To get mail from mailbox #3, you go directly to it - very fast!</li>
<li>All mailboxes are right next to each other in a line</li>
<li>You know exactly how many mailboxes there are</li>
</ul>
<p><strong>The cool part</strong>: You can instantly go to any mailbox by its number, no need to check all the other mailboxes first!</p>
<p><strong>The tricky part</strong>: If you want to add a new mailbox in the middle, you have to shift all the mailboxes after it to make room - that takes time!</p>
<h2 id="further-resources"><a class="header" href="#further-resources">Further Resources</a></h2>
<ul>
<li><a href="https://docs.python.org/3/tutorial/datastructures.html">Arrays in Python - Official Docs</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array">MDN JavaScript Arrays</a></li>
<li><a href="https://en.cppreference.com/w/cpp/container/vector">C++ Vector Documentation</a></li>
<li><a href="https://leetcode.com/tag/array/">LeetCode Array Problems</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="linked-lists-2"><a class="header" href="#linked-lists-2">Linked Lists</a></h1>
<h2 id="overview-25"><a class="header" href="#overview-25">Overview</a></h2>
<p>A linked list is a linear data structure where elements (nodes) are connected via pointers/references rather than stored in contiguous memory. Each node contains data and a reference to the next node, creating a chain-like structure.</p>
<h2 id="key-concepts-5"><a class="header" href="#key-concepts-5">Key Concepts</a></h2>
<h3 id="structure-1"><a class="header" href="#structure-1">Structure</a></h3>
<pre><code>    Head
     |
    Data -&gt; Next -&gt; Data -&gt; Next -&gt; Data -&gt; Next -&gt; None
</code></pre>
<h3 id="types"><a class="header" href="#types">Types</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Type</th><th>Description</th><th>Use Case</th></tr></thead><tbody>
<tr><td><strong>Singly Linked List</strong></td><td>Each node points to next node only</td><td>Standard, memory efficient</td></tr>
<tr><td><strong>Doubly Linked List</strong></td><td>Each node points to next and previous</td><td>Need bidirectional traversal</td></tr>
<tr><td><strong>Circular Linked List</strong></td><td>Last node points back to first</td><td>Round-robin scheduling</td></tr>
</tbody></table>
</div>
<h3 id="advantages-vs-arrays"><a class="header" href="#advantages-vs-arrays">Advantages vs Arrays</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Feature</th><th>Linked List</th><th>Array</th></tr></thead><tbody>
<tr><td><strong>Access</strong></td><td>$O(n)$</td><td>$O(1)$</td></tr>
<tr><td><strong>Insert/Delete at start</strong></td><td>$O(1)$</td><td>$O(n)$</td></tr>
<tr><td><strong>Insert/Delete in middle</strong></td><td>$O(n)$ to find, $O(1)$ to insert</td><td>$O(n)$</td></tr>
<tr><td><strong>Memory</strong></td><td>Flexible, dynamic</td><td>Fixed or expensive to resize</td></tr>
<tr><td><strong>Cache Efficiency</strong></td><td>Poor</td><td>Excellent</td></tr>
</tbody></table>
</div>
<h2 id="implementation"><a class="header" href="#implementation">Implementation</a></h2>
<h3 id="python---singly-linked-list"><a class="header" href="#python---singly-linked-list">Python - Singly Linked List</a></h3>
<pre><code class="language-python">class Node:
    def __init__(self, data):
        self.data = data
        self.next = None

class LinkedList:
    def __init__(self):
        self.head = None

    def append(self, data):
        """Add element to end"""
        new_node = Node(data)
        if not self.head:
            self.head = new_node
            return

        current = self.head
        while current.next:
            current = current.next
        current.next = new_node

    def prepend(self, data):
        """Add element to beginning"""
        new_node = Node(data)
        new_node.next = self.head
        self.head = new_node

    def insert_after(self, prev_data, data):
        """Insert after specific value"""
        current = self.head
        while current and current.data != prev_data:
            current = current.next

        if current:
            new_node = Node(data)
            new_node.next = current.next
            current.next = new_node

    def delete(self, data):
        """Remove first occurrence"""
        if not self.head:
            return

        # If head needs to be deleted
        if self.head.data == data:
            self.head = self.head.next
            return

        current = self.head
        while current.next and current.next.data != data:
            current = current.next

        if current.next:
            current.next = current.next.next

    def search(self, data):
        """Find element"""
        current = self.head
        while current:
            if current.data == data:
                return True
            current = current.next
        return False

    def display(self):
        """Print all elements"""
        elements = []
        current = self.head
        while current:
            elements.append(str(current.data))
            current = current.next
        print(" -&gt; ".join(elements) + " -&gt; None")

    def __len__(self):
        """Get length"""
        count = 0
        current = self.head
        while current:
            count += 1
            current = current.next
        return count

# Usage
ll = LinkedList()
ll.append(1)
ll.append(2)
ll.append(3)
ll.prepend(0)
ll.display()  # 0 -&gt; 1 -&gt; 2 -&gt; 3 -&gt; None
ll.delete(2)
ll.display()  # 0 -&gt; 1 -&gt; 3 -&gt; None
</code></pre>
<h3 id="python---doubly-linked-list"><a class="header" href="#python---doubly-linked-list">Python - Doubly Linked List</a></h3>
<pre><code class="language-python">class DNode:
    def __init__(self, data):
        self.data = data
        self.next = None
        self.prev = None

class DoublyLinkedList:
    def __init__(self):
        self.head = None

    def append(self, data):
        """Add to end"""
        new_node = DNode(data)
        if not self.head:
            self.head = new_node
            return

        current = self.head
        while current.next:
            current = current.next
        current.next = new_node
        new_node.prev = current

    def reverse_display(self):
        """Print in reverse"""
        if not self.head:
            return

        current = self.head
        while current.next:
            current = current.next

        elements = []
        while current:
            elements.append(str(current.data))
            current = current.prev
        print(" -&gt; ".join(elements) + " -&gt; None")
</code></pre>
<h3 id="javascript-1"><a class="header" href="#javascript-1">JavaScript</a></h3>
<pre><code class="language-javascript">class Node {
    constructor(data) {
        this.data = data;
        this.next = null;
    }
}

class LinkedList {
    constructor() {
        this.head = null;
    }

    append(data) {
        const newNode = new Node(data);
        if (!this.head) {
            this.head = newNode;
            return;
        }

        let current = this.head;
        while (current.next) {
            current = current.next;
        }
        current.next = newNode;
    }

    prepend(data) {
        const newNode = new Node(data);
        newNode.next = this.head;
        this.head = newNode;
    }

    delete(data) {
        if (!this.head) return;

        if (this.head.data === data) {
            this.head = this.head.next;
            return;
        }

        let current = this.head;
        while (current.next &amp;&amp; current.next.data !== data) {
            current = current.next;
        }

        if (current.next) {
            current.next = current.next.next;
        }
    }

    display() {
        let current = this.head;
        let result = [];
        while (current) {
            result.push(current.data);
            current = current.next;
        }
        console.log(result.join(" -&gt; ") + " -&gt; null");
    }
}

// Usage
const ll = new LinkedList();
ll.append(1);
ll.append(2);
ll.prepend(0);
ll.display();  // 0 -&gt; 1 -&gt; 2 -&gt; null
</code></pre>
<h3 id="c-2"><a class="header" href="#c-2">C++</a></h3>
<pre><code class="language-cpp">#include &lt;iostream&gt;
using namespace std;

struct Node {
    int data;
    Node* next;

    Node(int data) : data(data), next(nullptr) {}
};

class LinkedList {
private:
    Node* head;

public:
    LinkedList() : head(nullptr) {}

    void append(int data) {
        Node* newNode = new Node(data);
        if (!head) {
            head = newNode;
            return;
        }

        Node* current = head;
        while (current-&gt;next) {
            current = current-&gt;next;
        }
        current-&gt;next = newNode;
    }

    void prepend(int data) {
        Node* newNode = new Node(data);
        newNode-&gt;next = head;
        head = newNode;
    }

    void deleteNode(int data) {
        if (!head) return;

        if (head-&gt;data == data) {
            Node* temp = head;
            head = head-&gt;next;
            delete temp;
            return;
        }

        Node* current = head;
        while (current-&gt;next &amp;&amp; current-&gt;next-&gt;data != data) {
            current = current-&gt;next;
        }

        if (current-&gt;next) {
            Node* temp = current-&gt;next;
            current-&gt;next = current-&gt;next-&gt;next;
            delete temp;
        }
    }

    void display() {
        Node* current = head;
        while (current) {
            cout &lt;&lt; current-&gt;data &lt;&lt; " -&gt; ";
            current = current-&gt;next;
        }
        cout &lt;&lt; "null\n";
    }

    ~LinkedList() {
        Node* current = head;
        while (current) {
            Node* temp = current;
            current = current-&gt;next;
            delete temp;
        }
    }
};
</code></pre>
<h2 id="common-problems-1"><a class="header" href="#common-problems-1">Common Problems</a></h2>
<h3 id="reverse-a-linked-list"><a class="header" href="#reverse-a-linked-list">Reverse a Linked List</a></h3>
<pre><code class="language-python">def reverse(head):
    """Reverse entire linked list"""
    prev = None
    current = head

    while current:
        next_temp = current.next  # Save next
        current.next = prev       # Reverse link
        prev = current            # Move prev forward
        current = next_temp       # Move current forward

    return prev  # New head
</code></pre>
<h3 id="find-middle"><a class="header" href="#find-middle">Find Middle</a></h3>
<pre><code class="language-python">def find_middle(head):
    """Find middle node using slow/fast pointers"""
    slow = fast = head

    while fast and fast.next:
        slow = slow.next
        fast = fast.next.next

    return slow  # Slow pointer at middle
</code></pre>
<h3 id="detect-cycle"><a class="header" href="#detect-cycle">Detect Cycle</a></h3>
<pre><code class="language-python">def has_cycle(head):
    """Detect if linked list has cycle"""
    slow = fast = head

    while fast and fast.next:
        slow = slow.next
        fast = fast.next.next

        if slow == fast:  # Cycle detected
            return True

    return False
</code></pre>
<h3 id="merge-two-sorted-lists"><a class="header" href="#merge-two-sorted-lists">Merge Two Sorted Lists</a></h3>
<pre><code class="language-python">def merge_sorted(l1, l2):
    """Merge two sorted linked lists"""
    dummy = Node(0)
    current = dummy

    while l1 and l2:
        if l1.data &lt; l2.data:
            current.next = l1
            l1 = l1.next
        else:
            current.next = l2
            l2 = l2.next
        current = current.next

    # Attach remaining
    current.next = l1 if l1 else l2

    return dummy.next
</code></pre>
<h3 id="remove-nth-node-from-end"><a class="header" href="#remove-nth-node-from-end">Remove Nth Node from End</a></h3>
<pre><code class="language-python">def remove_nth_from_end(head, n):
    """Remove nth node from end"""
    dummy = Node(0)
    dummy.next = head
    first = second = dummy

    # Move first pointer n+1 steps ahead
    for i in range(n + 1):
        if not first:
            return head
        first = first.next

    # Move both until first reaches end
    while first:
        first = first.next
        second = second.next

    # Remove node
    second.next = second.next.next

    return dummy.next
</code></pre>
<h2 id="time-complexity-summary"><a class="header" href="#time-complexity-summary">Time Complexity Summary</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Operation</th><th>Singly</th><th>Doubly</th></tr></thead><tbody>
<tr><td><strong>Access</strong></td><td>$O(n)$</td><td>$O(n)$</td></tr>
<tr><td><strong>Search</strong></td><td>$O(n)$</td><td>$O(n)$</td></tr>
<tr><td><strong>Insert at head</strong></td><td>$O(1)$</td><td>$O(1)$</td></tr>
<tr><td><strong>Insert at tail</strong></td><td>$O(n)$</td><td>$O(1)$*</td></tr>
<tr><td><strong>Delete from head</strong></td><td>$O(1)$</td><td>$O(1)$</td></tr>
<tr><td><strong>Delete from tail</strong></td><td>$O(n)$</td><td>$O(1)$*</td></tr>
<tr><td><strong>Reverse</strong></td><td>$O(n)$</td><td>$O(n)$</td></tr>
</tbody></table>
</div>
<p>*With tail pointer</p>
<h2 id="best-practices-26"><a class="header" href="#best-practices-26">Best Practices</a></h2>
<h3 id="1-use-sentinel-nodes"><a class="header" href="#1-use-sentinel-nodes">1. Use Sentinel Nodes</a></h3>
<pre><code class="language-python"># Bad: Check for None multiple times
if head and head.next and head.next.next:
    ...

# Good: Use dummy node
dummy = Node(0)
dummy.next = head
current = dummy
# Now no need to check if current exists
</code></pre>
<h3 id="2-avoid-memory-leaks-c"><a class="header" href="#2-avoid-memory-leaks-c">2. Avoid Memory Leaks (C++)</a></h3>
<pre><code class="language-cpp">// Always delete removed nodes
Node* temp = current-&gt;next;
current-&gt;next = current-&gt;next-&gt;next;
delete temp;  // Free memory
</code></pre>
<h3 id="3-two-pointer-technique"><a class="header" href="#3-two-pointer-technique">3. Two-Pointer Technique</a></h3>
<pre><code class="language-python"># Many problems solved with slow/fast pointers:
# - Find middle
# - Detect cycle
# - Remove nth from end
</code></pre>
<h2 id="eli10-1"><a class="header" href="#eli10-1">ELI10</a></h2>
<p>Imagine a treasure hunt with clues:</p>
<ul>
<li>Each clue card (node) has treasure info and points to the next clue</li>
<li>You start at the first clue (head)</li>
<li>To find a specific clue, you must follow the chain - you can't jump!</li>
<li>To add a clue in the middle, you just change what one card points to</li>
<li>You don't need a big board to write all clues - they can be anywhere!</li>
</ul>
<p>The tricky part: You can only look at clues in order, you can't jump to the middle one directly like you could with an array.</p>
<h2 id="further-resources-1"><a class="header" href="#further-resources-1">Further Resources</a></h2>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Linked_list">Linked List Wikipedia</a></li>
<li><a href="https://leetcode.com/tag/linked-list/">LeetCode Linked List Problems</a></li>
<li><a href="https://visualgo.net/en/list">Visual Algo - Linked List Visualizations</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="stacks-1"><a class="header" href="#stacks-1">Stacks</a></h1>
<h2 id="overview-26"><a class="header" href="#overview-26">Overview</a></h2>
<p>A stack is a Last-In-First-Out (LIFO) data structure where elements are added and removed from the same end, called the top. Think of it like a stack of dinner plates - you put plates on top and take them from the top.</p>
<h2 id="key-concepts-6"><a class="header" href="#key-concepts-6">Key Concepts</a></h2>
<h3 id="lifo-principle"><a class="header" href="#lifo-principle">LIFO Principle</a></h3>
<pre><code>Push: 1 -&gt; 2 -&gt; 3

     3     Top (Last In)

     2

     1     First In


Pop: Returns 3 (First Out)
</code></pre>
<h2 id="operations--time-complexity"><a class="header" href="#operations--time-complexity">Operations &amp; Time Complexity</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Operation</th><th>Time</th><th>Space</th></tr></thead><tbody>
<tr><td>Push</td><td>$O(1)$</td><td>$O(n)$</td></tr>
<tr><td>Pop</td><td>$O(1)$</td><td>-</td></tr>
<tr><td>Peek</td><td>$O(1)$</td><td>-</td></tr>
<tr><td>Is Empty</td><td>$O(1)$</td><td>-</td></tr>
<tr><td>Search</td><td>$O(n)$</td><td>-</td></tr>
</tbody></table>
</div>
<h2 id="implementation-python"><a class="header" href="#implementation-python">Implementation (Python)</a></h2>
<pre><code class="language-python">class Stack:
    def __init__(self):
        self.items = []

    def push(self, data):
        self.items.append(data)

    def pop(self):
        return self.items.pop() if not self.is_empty() else None

    def peek(self):
        return self.items[-1] if not self.is_empty() else None

    def is_empty(self):
        return len(self.items) == 0

    def size(self):
        return len(self.items)

# Using deque for $O(1)$ operations
from collections import deque
stack = deque()
stack.append(1)  # Push $O(1)$
stack.pop()      # Pop $O(1)$
</code></pre>
<h2 id="common-problems-2"><a class="header" href="#common-problems-2">Common Problems</a></h2>
<h3 id="valid-parentheses"><a class="header" href="#valid-parentheses">Valid Parentheses</a></h3>
<pre><code class="language-python">def is_valid(s):
    stack = []
    pairs = {'(': ')', '[': ']', '{': '}'}

    for char in s:
        if char in pairs:
            stack.append(char)
        else:
            if not stack or pairs[stack.pop()] != char:
                return False

    return len(stack) == 0
</code></pre>
<h3 id="next-greater-element"><a class="header" href="#next-greater-element">Next Greater Element</a></h3>
<pre><code class="language-python">def next_greater(arr):
    stack = []
    result = [-1] * len(arr)

    for i in range(len(arr) - 1, -1, -1):
        while stack and stack[-1] &lt;= arr[i]:
            stack.pop()
        if stack:
            result[i] = stack[-1]
        stack.append(arr[i])

    return result
</code></pre>
<h3 id="postfix-evaluation"><a class="header" href="#postfix-evaluation">Postfix Evaluation</a></h3>
<pre><code class="language-python">def evaluate_postfix(expr):
    stack = []
    ops = {'+', '-', '*', '/'}

    for token in expr.split():
        if token not in ops:
            stack.append(int(token))
        else:
            b = stack.pop()
            a = stack.pop()
            if token == '+': stack.append(a + b)
            elif token == '-': stack.append(a - b)
            elif token == '*': stack.append(a * b)
            else: stack.append(a // b)

    return stack[0]
</code></pre>
<h2 id="real-world-uses"><a class="header" href="#real-world-uses">Real-World Uses</a></h2>
<ul>
<li><strong>Browser Back Button</strong>: Last visited page is first to go back to</li>
<li><strong>Function Call Stack</strong>: Each function call pushed, returns pop</li>
<li><strong>Undo/Redo</strong>: Last action undone first</li>
<li><strong>Expression Parsing</strong>: Manage operator precedence</li>
<li><strong>DFS (Depth-First Search)</strong>: Graph traversal</li>
</ul>
<h2 id="eli10-2"><a class="header" href="#eli10-2">ELI10</a></h2>
<p>Imagine a stack of dinner plates - you:</p>
<ul>
<li>Add new plates on <strong>top</strong></li>
<li>Take plates from <strong>top</strong></li>
<li>Can't grab from the middle without removing top plates</li>
</ul>
<p>That's LIFO! Last In = First Out. The last plate you put on is the first one you take off.</p>
<h2 id="further-resources-2"><a class="header" href="#further-resources-2">Further Resources</a></h2>
<ul>
<li><a href="https://leetcode.com/tag/stack/">LeetCode Stack Problems</a></li>
<li><a href="https://en.wikipedia.org/wiki/Stack_(abstract_data_type)">Stack Wikipedia</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><p>A queue is a linear data structure that follows the First In First Out (FIFO) principle. This means that the first element added to the queue will be the first one to be removed. Queues are commonly used in scenarios where order needs to be preserved, such as in scheduling tasks, managing requests in a server, or handling asynchronous data.</p>
<h3 id="key-operations"><a class="header" href="#key-operations">Key Operations</a></h3>
<ol>
<li><strong>Enqueue</strong>: Add an element to the end of the queue.</li>
<li><strong>Dequeue</strong>: Remove an element from the front of the queue.</li>
<li><strong>Peek/Front</strong>: Get the element at the front of the queue without removing it.</li>
<li><strong>IsEmpty</strong>: Check if the queue is empty.</li>
<li><strong>Size</strong>: Get the number of elements in the queue.</li>
</ol>
<h3 id="types-of-queues"><a class="header" href="#types-of-queues">Types of Queues</a></h3>
<ul>
<li><strong>Simple Queue</strong>: Also known as a linear queue, where insertion happens at the rear and deletion happens at the front.</li>
<li><strong>Circular Queue</strong>: A more efficient queue where the last position is connected back to the first position to make a circle.</li>
<li><strong>Priority Queue</strong>: Each element is associated with a priority, and elements are served based on their priority.</li>
<li><strong>Double-ended Queue (Deque)</strong>: Insertion and deletion can happen at both the front and the rear of the queue.</li>
</ul>
<h3 id="applications-of-queues"><a class="header" href="#applications-of-queues">Applications of Queues</a></h3>
<ul>
<li><strong>CPU Scheduling</strong>: Managing processes in operating systems.</li>
<li><strong>Disk Scheduling</strong>: Managing I/O requests.</li>
<li><strong>Breadth-First Search (BFS)</strong>: Traversing or searching tree or graph data structures.</li>
<li><strong>Print Queue</strong>: Managing print jobs in a printer.</li>
</ul>
<p>Queues are fundamental data structures that are widely used in computer science and programming for managing ordered collections of items.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="hash-tables-2"><a class="header" href="#hash-tables-2">Hash Tables</a></h1>
<h2 id="overview-27"><a class="header" href="#overview-27">Overview</a></h2>
<p>A hash table (hash map) stores key-value pairs with $O(1)$ average-case lookup, insertion, and deletion. It uses a hash function to map keys to array indices.</p>
<h2 id="how-it-works"><a class="header" href="#how-it-works">How It Works</a></h2>
<h3 id="hash-function"><a class="header" href="#hash-function">Hash Function</a></h3>
<p>Converts key to index:</p>
<pre><code>hash("name") = 5
hash(123) = 2
hash("email") = 5  (collision!)
</code></pre>
<h3 id="collision-resolution"><a class="header" href="#collision-resolution">Collision Resolution</a></h3>
<p><strong>Chaining</strong>: Store multiple values at same index</p>
<pre><code>Index 0: None
Index 1: None
Index 2: 123 -&gt; "John"
Index 3: 456 -&gt; "Jane" -&gt; 789 -&gt; "Jack"
</code></pre>
<p><strong>Open Addressing</strong>: Find next empty slot</p>
<pre><code>hash("a") = 5 (occupied)
Try 6, 7, 8... until empty
</code></pre>
<h2 id="operations"><a class="header" href="#operations">Operations</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Operation</th><th>Average</th><th>Worst</th></tr></thead><tbody>
<tr><td><strong>Get</strong></td><td>$O(1)$</td><td>$O(n)$</td></tr>
<tr><td><strong>Set</strong></td><td>$O(1)$</td><td>$O(n)$</td></tr>
<tr><td><strong>Delete</strong></td><td>$O(1)$</td><td>$O(n)$</td></tr>
</tbody></table>
</div>
<h2 id="python-implementation"><a class="header" href="#python-implementation">Python Implementation</a></h2>
<pre><code class="language-python"># Built-in dict
d = {"key": "value"}
d.get("key")  # $O(1)$
d["key"] = "new_value"
del d["key"]

# Custom
class HashTable:
    def __init__(self, size=10):
        self.table = [[] for _ in range(size)]

    def set(self, key, value):
        index = hash(key) % len(self.table)
        for i, (k, v) in enumerate(self.table[index]):
            if k == key:
                self.table[index][i] = (key, value)
                return
        self.table[index].append((key, value))

    def get(self, key):
        index = hash(key) % len(self.table)
        for k, v in self.table[index]:
            if k == key:
                return v
        return None
</code></pre>
<h2 id="common-problems-3"><a class="header" href="#common-problems-3">Common Problems</a></h2>
<h3 id="two-sum"><a class="header" href="#two-sum">Two Sum</a></h3>
<pre><code class="language-python">def two_sum(arr, target):
    seen = {}
    for num in arr:
        if target - num in seen:
            return [seen[target - num], arr.index(num)]
        seen[num] = arr.index(num)
    return []
</code></pre>
<h3 id="duplicate-detection"><a class="header" href="#duplicate-detection">Duplicate Detection</a></h3>
<pre><code class="language-python">def has_duplicates(arr):
    return len(arr) != len(set(arr))
</code></pre>
<h2 id="eli10-3"><a class="header" href="#eli10-3">ELI10</a></h2>
<p>Think of hash tables like library catalogs:</p>
<ul>
<li><strong>Hash function</strong> = catalog system (tells you which shelf)</li>
<li><strong>Index</strong> = shelf number</li>
<li><strong>Value</strong> = book</li>
</ul>
<p>Instead of searching every shelf, the system instantly tells you which one!</p>
<h2 id="further-resources-3"><a class="header" href="#further-resources-3">Further Resources</a></h2>
<ul>
<li><a href="https://leetcode.com/tag/hash-table/">LeetCode Hash Table</a></li>
<li><a href="https://en.wikipedia.org/wiki/Hash_table">Hash Table Wikipedia</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="tree-traversal-algorithms"><a class="header" href="#tree-traversal-algorithms">Tree Traversal Algorithms</a></h1>
<p>Tree traversal algorithms are methods used to visit all the nodes in a tree data structure in a specific order. These algorithms are essential for various operations on trees, such as searching, sorting, and manipulating data. There are several types of tree traversal algorithms, each with its own use cases and characteristics.</p>
<h2 id="types-of-tree-traversal-algorithms"><a class="header" href="#types-of-tree-traversal-algorithms">Types of Tree Traversal Algorithms</a></h2>
<h3 id="1-depth-first-search-dfs"><a class="header" href="#1-depth-first-search-dfs">1. Depth-First Search (DFS)</a></h3>
<p>Depth-First Search (DFS) is a traversal algorithm that explores as far as possible along each branch before backtracking. There are three common types of DFS traversals:</p>
<h4 id="a-preorder-traversal"><a class="header" href="#a-preorder-traversal">a. Preorder Traversal</a></h4>
<p>In preorder traversal, the nodes are visited in the following order:</p>
<ol>
<li>Visit the root node.</li>
<li>Traverse the left subtree.</li>
<li>Traverse the right subtree.</li>
</ol>
<p><strong>Use cases</strong>: Used for creating a copy of the tree, prefix expression evaluation, and serializing trees.</p>
<p><strong>Implementation (Recursive)</strong>:</p>
<pre><code class="language-python">class TreeNode:
    def __init__(self, val=0, left=None, right=None):
        self.val = val
        self.left = left
        self.right = right

def preorder_traversal_recursive(root):
    """
    Preorder traversal: Root -&gt; Left -&gt; Right
    Time Complexity: $O(n)$ where n is the number of nodes
    Space Complexity: $O(h)$ where h is the height (due to recursion stack)
    """
    result = []

    def traverse(node):
        if not node:
            return

        result.append(node.val)      # Visit root
        traverse(node.left)           # Traverse left subtree
        traverse(node.right)          # Traverse right subtree

    traverse(root)
    return result
</code></pre>
<p><strong>Implementation (Iterative)</strong>:</p>
<pre><code class="language-python">def preorder_traversal_iterative(root):
    """
    Iterative preorder traversal using a stack.
    Time Complexity: $O(n)$
    Space Complexity: $O(h)$ in worst case, $O(\log n)$ for balanced tree
    """
    if not root:
        return []

    result = []
    stack = [root]

    while stack:
        node = stack.pop()
        result.append(node.val)

        # Push right first so left is processed first (stack is LIFO)
        if node.right:
            stack.append(node.right)
        if node.left:
            stack.append(node.left)

    return result
</code></pre>
<p><strong>Example</strong>:</p>
<pre><code>Tree:       1
           / \
          2   3
         / \
        4   5

Preorder: [1, 2, 4, 5, 3]
Step-by-step:
1. Visit 1 (root)
2. Visit 2 (left child of 1)
3. Visit 4 (left child of 2)
4. Visit 5 (right child of 2)
5. Visit 3 (right child of 1)
</code></pre>
<h4 id="b-inorder-traversal"><a class="header" href="#b-inorder-traversal">b. Inorder Traversal</a></h4>
<p>In inorder traversal, the nodes are visited in the following order:</p>
<ol>
<li>Traverse the left subtree.</li>
<li>Visit the root node.</li>
<li>Traverse the right subtree.</li>
</ol>
<p><strong>Use cases</strong>: For Binary Search Trees, inorder traversal gives nodes in sorted (ascending) order. Also used for expression tree evaluation.</p>
<p><strong>Implementation (Recursive)</strong>:</p>
<pre><code class="language-python">def inorder_traversal_recursive(root):
    """
    Inorder traversal: Left -&gt; Root -&gt; Right
    Time Complexity: $O(n)$
    Space Complexity: $O(h)$ due to recursion stack
    """
    result = []

    def traverse(node):
        if not node:
            return

        traverse(node.left)           # Traverse left subtree
        result.append(node.val)       # Visit root
        traverse(node.right)          # Traverse right subtree

    traverse(root)
    return result
</code></pre>
<p><strong>Implementation (Iterative)</strong>:</p>
<pre><code class="language-python">def inorder_traversal_iterative(root):
    """
    Iterative inorder traversal using a stack.
    Time Complexity: $O(n)$
    Space Complexity: $O(h)$
    """
    result = []
    stack = []
    current = root

    while current or stack:
        # Go to the leftmost node
        while current:
            stack.append(current)
            current = current.left

        # Current is None, pop from stack
        current = stack.pop()
        result.append(current.val)

        # Visit the right subtree
        current = current.right

    return result
</code></pre>
<p><strong>Example</strong>:</p>
<pre><code>Tree:       1
           / \
          2   3
         / \
        4   5

Inorder: [4, 2, 5, 1, 3]
Step-by-step:
1. Visit 4 (leftmost node)
2. Visit 2 (parent of 4)
3. Visit 5 (right child of 2)
4. Visit 1 (root)
5. Visit 3 (right child of 1)

For BST, this gives sorted order!
</code></pre>
<h4 id="c-postorder-traversal"><a class="header" href="#c-postorder-traversal">c. Postorder Traversal</a></h4>
<p>In postorder traversal, the nodes are visited in the following order:</p>
<ol>
<li>Traverse the left subtree.</li>
<li>Traverse the right subtree.</li>
<li>Visit the root node.</li>
</ol>
<p><strong>Use cases</strong>: Used for deleting trees (delete children before parent), postfix expression evaluation, and calculating directory sizes.</p>
<p><strong>Implementation (Recursive)</strong>:</p>
<pre><code class="language-python">def postorder_traversal_recursive(root):
    """
    Postorder traversal: Left -&gt; Right -&gt; Root
    Time Complexity: $O(n)$
    Space Complexity: $O(h)$
    """
    result = []

    def traverse(node):
        if not node:
            return

        traverse(node.left)           # Traverse left subtree
        traverse(node.right)          # Traverse right subtree
        result.append(node.val)       # Visit root

    traverse(root)
    return result
</code></pre>
<p><strong>Implementation (Iterative)</strong>:</p>
<pre><code class="language-python">def postorder_traversal_iterative(root):
    """
    Iterative postorder traversal using two stacks.
    Time Complexity: $O(n)$
    Space Complexity: $O(h)$
    """
    if not root:
        return []

    result = []
    stack1 = [root]
    stack2 = []

    # Push nodes to stack2 in reverse postorder
    while stack1:
        node = stack1.pop()
        stack2.append(node)

        # Push left first, then right (opposite of preorder)
        if node.left:
            stack1.append(node.left)
        if node.right:
            stack1.append(node.right)

    # Pop from stack2 to get postorder
    while stack2:
        result.append(stack2.pop().val)

    return result
</code></pre>
<p><strong>Example</strong>:</p>
<pre><code>Tree:       1
           / \
          2   3
         / \
        4   5

Postorder: [4, 5, 2, 3, 1]
Step-by-step:
1. Visit 4 (leftmost leaf)
2. Visit 5 (right sibling of 4)
3. Visit 2 (parent of 4 and 5)
4. Visit 3 (leaf node)
5. Visit 1 (root, visited last)
</code></pre>
<h3 id="2-breadth-first-search-bfs--level-order-traversal"><a class="header" href="#2-breadth-first-search-bfs--level-order-traversal">2. Breadth-First Search (BFS) / Level Order Traversal</a></h3>
<p>Breadth-First Search (BFS), also known as Level Order Traversal, is a traversal algorithm that explores all nodes at the present depth before moving to nodes at the next depth level. It uses a queue data structure.</p>
<p><strong>Use cases</strong>: Finding shortest path in unweighted trees, level-by-level processing, serialization/deserialization of trees, finding all nodes at a given distance.</p>
<p><strong>Implementation (Iterative)</strong>:</p>
<pre><code class="language-python">from collections import deque

def level_order_traversal(root):
    """
    Level order traversal using a queue (BFS).
    Time Complexity: $O(n)$
    Space Complexity: $O(w)$ where w is the maximum width of the tree
    """
    if not root:
        return []

    result = []
    queue = deque([root])

    while queue:
        node = queue.popleft()
        result.append(node.val)

        # Add children to queue
        if node.left:
            queue.append(node.left)
        if node.right:
            queue.append(node.right)

    return result
</code></pre>
<p><strong>Level-by-Level Implementation</strong> (returns list of lists):</p>
<pre><code class="language-python">def level_order_by_level(root):
    """
    Returns nodes grouped by level.
    Time Complexity: $O(n)$
    Space Complexity: $O(w)$ where w is maximum width
    """
    if not root:
        return []

    result = []
    queue = deque([root])

    while queue:
        level_size = len(queue)
        current_level = []

        # Process all nodes at current level
        for _ in range(level_size):
            node = queue.popleft()
            current_level.append(node.val)

            if node.left:
                queue.append(node.left)
            if node.right:
                queue.append(node.right)

        result.append(current_level)

    return result
</code></pre>
<p><strong>Example</strong>:</p>
<pre><code>Tree:       1
           / \
          2   3
         / \   \
        4   5   6

Level Order: [1, 2, 3, 4, 5, 6]
By Level: [[1], [2, 3], [4, 5, 6]]

Step-by-step:
Queue: [1]           -&gt; Visit 1, add children -&gt; Result: [1]
Queue: [2, 3]        -&gt; Visit 2, add children -&gt; Result: [1, 2]
Queue: [3, 4, 5]     -&gt; Visit 3, add children -&gt; Result: [1, 2, 3]
Queue: [4, 5, 6]     -&gt; Visit 4             -&gt; Result: [1, 2, 3, 4]
Queue: [5, 6]        -&gt; Visit 5             -&gt; Result: [1, 2, 3, 4, 5]
Queue: [6]           -&gt; Visit 6             -&gt; Result: [1, 2, 3, 4, 5, 6]
</code></pre>
<p><strong>Variants</strong>:</p>
<pre><code class="language-python">def zigzag_level_order(root):
    """
    Zigzag level order: alternate between left-to-right and right-to-left.
    Example: [[1], [3, 2], [4, 5, 6]]
    """
    if not root:
        return []

    result = []
    queue = deque([root])
    left_to_right = True

    while queue:
        level_size = len(queue)
        current_level = deque()

        for _ in range(level_size):
            node = queue.popleft()

            # Add to front or back based on direction
            if left_to_right:
                current_level.append(node.val)
            else:
                current_level.appendleft(node.val)

            if node.left:
                queue.append(node.left)
            if node.right:
                queue.append(node.right)

        result.append(list(current_level))
        left_to_right = not left_to_right

    return result


def right_side_view(root):
    """
    Return the values of nodes visible from the right side.
    (Last node at each level)
    """
    if not root:
        return []

    result = []
    queue = deque([root])

    while queue:
        level_size = len(queue)

        for i in range(level_size):
            node = queue.popleft()

            # Add last node of each level
            if i == level_size - 1:
                result.append(node.val)

            if node.left:
                queue.append(node.left)
            if node.right:
                queue.append(node.right)

    return result
</code></pre>
<h2 id="binary-search-trees-bst"><a class="header" href="#binary-search-trees-bst">Binary Search Trees (BST)</a></h2>
<p>A Binary Search Tree is a binary tree where for each node:</p>
<ul>
<li>All values in the left subtree are less than the node's value</li>
<li>All values in the right subtree are greater than the node's value</li>
<li>Both left and right subtrees are also BSTs</li>
</ul>
<h3 id="bst-operations"><a class="header" href="#bst-operations">BST Operations</a></h3>
<pre><code class="language-python">class BSTNode:
    def __init__(self, val):
        self.val = val
        self.left = None
        self.right = None

class BST:
    def __init__(self):
        self.root = None

    def insert(self, val):
        """
        Insert a value into the BST.
        Time Complexity: $O(h)$ where h is height
        Average: $O(\log n)$, Worst: $O(n)$ for skewed tree
        """
        def _insert(node, val):
            if not node:
                return BSTNode(val)

            if val &lt; node.val:
                node.left = _insert(node.left, val)
            elif val &gt; node.val:
                node.right = _insert(node.right, val)
            # If equal, don't insert (BST with unique values)

            return node

        self.root = _insert(self.root, val)

    def search(self, val):
        """
        Search for a value in the BST.
        Time Complexity: $O(h)$
        """
        def _search(node, val):
            if not node or node.val == val:
                return node

            if val &lt; node.val:
                return _search(node.left, val)
            else:
                return _search(node.right, val)

        return _search(self.root, val)

    def delete(self, val):
        """
        Delete a value from the BST.
        Time Complexity: $O(h)$
        """
        def _min_value_node(node):
            """Find the minimum value node in a subtree."""
            current = node
            while current.left:
                current = current.left
            return current

        def _delete(node, val):
            if not node:
                return node

            # Find the node to delete
            if val &lt; node.val:
                node.left = _delete(node.left, val)
            elif val &gt; node.val:
                node.right = _delete(node.right, val)
            else:
                # Node found! Handle three cases:

                # Case 1: Node with only right child or no child
                if not node.left:
                    return node.right

                # Case 2: Node with only left child
                if not node.right:
                    return node.left

                # Case 3: Node with two children
                # Get the inorder successor (smallest in right subtree)
                successor = _min_value_node(node.right)
                node.val = successor.val
                node.right = _delete(node.right, successor.val)

            return node

        self.root = _delete(self.root, val)

    def find_min(self):
        """Find minimum value (leftmost node)."""
        if not self.root:
            return None
        current = self.root
        while current.left:
            current = current.left
        return current.val

    def find_max(self):
        """Find maximum value (rightmost node)."""
        if not self.root:
            return None
        current = self.root
        while current.right:
            current = current.right
        return current.val

    def is_valid_bst(self):
        """
        Validate if the tree is a valid BST.
        Time Complexity: $O(n)$
        """
        def _validate(node, min_val, max_val):
            if not node:
                return True

            if node.val &lt;= min_val or node.val &gt;= max_val:
                return False

            return (_validate(node.left, min_val, node.val) and
                    _validate(node.right, node.val, max_val))

        return _validate(self.root, float('-inf'), float('inf'))


# Example usage
bst = BST()
for val in [5, 3, 7, 2, 4, 6, 8]:
    bst.insert(val)

print(bst.search(4))  # Found
print(bst.find_min())  # 2
print(bst.find_max())  # 8
</code></pre>
<p><strong>BST Example</strong>:</p>
<pre><code>         5
        / \
       3   7
      / \ / \
     2  4 6  8

Inorder: [2, 3, 4, 5, 6, 7, 8] (sorted!)
Search for 4: 5 -&gt; 3 -&gt; 4 (3 steps)
</code></pre>
<h2 id="balanced-binary-search-trees"><a class="header" href="#balanced-binary-search-trees">Balanced Binary Search Trees</a></h2>
<h3 id="avl-trees"><a class="header" href="#avl-trees">AVL Trees</a></h3>
<p>AVL trees are self-balancing BSTs where the height difference between left and right subtrees (balance factor) is at most 1 for every node.</p>
<p><strong>Balance Factor</strong> = height(left subtree) - height(right subtree)</p>
<ul>
<li>Must be in {-1, 0, 1}</li>
</ul>
<pre><code class="language-python">class AVLNode:
    def __init__(self, val):
        self.val = val
        self.left = None
        self.right = None
        self.height = 1  # Height of node

class AVLTree:
    def get_height(self, node):
        """Get height of a node."""
        if not node:
            return 0
        return node.height

    def get_balance(self, node):
        """Get balance factor of a node."""
        if not node:
            return 0
        return self.get_height(node.left) - self.get_height(node.right)

    def update_height(self, node):
        """Update height of a node."""
        if not node:
            return 0
        node.height = 1 + max(self.get_height(node.left),
                               self.get_height(node.right))

    def rotate_right(self, y):
        """
        Right rotation:
             y                x
            / \              / \
           x   C    --&gt;     A   y
          / \                  / \
         A   B                B   C
        """
        x = y.left
        B = x.right

        # Perform rotation
        x.right = y
        y.left = B

        # Update heights
        self.update_height(y)
        self.update_height(x)

        return x

    def rotate_left(self, x):
        """
        Left rotation:
           x                  y
          / \                / \
         A   y      --&gt;     x   C
            / \            / \
           B   C          A   B
        """
        y = x.right
        B = y.left

        # Perform rotation
        y.left = x
        x.right = B

        # Update heights
        self.update_height(x)
        self.update_height(y)

        return y

    def insert(self, root, val):
        """
        Insert a value and rebalance the tree.
        Time Complexity: $O(\log n)$ - guaranteed!
        """
        # 1. Perform standard BST insert
        if not root:
            return AVLNode(val)

        if val &lt; root.val:
            root.left = self.insert(root.left, val)
        elif val &gt; root.val:
            root.right = self.insert(root.right, val)
        else:
            return root  # Duplicate values not allowed

        # 2. Update height of current node
        self.update_height(root)

        # 3. Get balance factor
        balance = self.get_balance(root)

        # 4. If unbalanced, there are 4 cases:

        # Left-Left Case
        if balance &gt; 1 and val &lt; root.left.val:
            return self.rotate_right(root)

        # Right-Right Case
        if balance &lt; -1 and val &gt; root.right.val:
            return self.rotate_left(root)

        # Left-Right Case
        if balance &gt; 1 and val &gt; root.left.val:
            root.left = self.rotate_left(root.left)
            return self.rotate_right(root)

        # Right-Left Case
        if balance &lt; -1 and val &lt; root.right.val:
            root.right = self.rotate_right(root.right)
            return self.rotate_left(root)

        return root
</code></pre>
<p><strong>AVL Tree Rotations Explained</strong>:</p>
<pre><code>Left-Left (LL) Imbalance:
    Insert 1, 2, 3 into BST creates:
         3              2
        /              / \
       2        --&gt;   1   3
      /
     1
    (Right rotation at 3)

Right-Right (RR) Imbalance:
    Insert 3, 2, 1:
     1                2
      \              / \
       2      --&gt;   1   3
        \
         3
    (Left rotation at 1)

Left-Right (LR) Imbalance:
       3              3              2
      /              /              / \
     1        --&gt;   2        --&gt;   1   3
      \            /
       2          1
    (Left at 1, then Right at 3)

Right-Left (RL) Imbalance:
     1              1              2
      \              \            / \
       3      --&gt;     2    --&gt;   1   3
      /                \
     2                  3
    (Right at 3, then Left at 1)
</code></pre>
<h2 id="common-tree-problems-and-patterns"><a class="header" href="#common-tree-problems-and-patterns">Common Tree Problems and Patterns</a></h2>
<h3 id="1-tree-heightdepth"><a class="header" href="#1-tree-heightdepth">1. Tree Height/Depth</a></h3>
<pre><code class="language-python">def max_depth(root):
    """
    Find the maximum depth of a binary tree.
    Time: $O(n)$, Space: $O(h)$
    """
    if not root:
        return 0
    return 1 + max(max_depth(root.left), max_depth(root.right))

def min_depth(root):
    """
    Find the minimum depth (root to nearest leaf).
    Time: $O(n)$, Space: $O(h)$
    """
    if not root:
        return 0
    if not root.left and not root.right:
        return 1
    if not root.left:
        return 1 + min_depth(root.right)
    if not root.right:
        return 1 + min_depth(root.left)
    return 1 + min(min_depth(root.left), min_depth(root.right))
</code></pre>
<h3 id="2-tree-diameter"><a class="header" href="#2-tree-diameter">2. Tree Diameter</a></h3>
<pre><code class="language-python">def diameter_of_binary_tree(root):
    """
    The diameter is the length of the longest path between any two nodes.
    The path may or may not pass through the root.
    Time: $O(n)$, Space: $O(h)$
    """
    diameter = [0]

    def height(node):
        if not node:
            return 0

        left_height = height(node.left)
        right_height = height(node.right)

        # Update diameter (path through this node)
        diameter[0] = max(diameter[0], left_height + right_height)

        return 1 + max(left_height, right_height)

    height(root)
    return diameter[0]
</code></pre>
<h3 id="3-path-sum-problems"><a class="header" href="#3-path-sum-problems">3. Path Sum Problems</a></h3>
<pre><code class="language-python">def has_path_sum(root, target_sum):
    """
    Check if tree has root-to-leaf path that sums to target.
    Time: $O(n)$, Space: $O(h)$
    """
    if not root:
        return False

    if not root.left and not root.right:
        return root.val == target_sum

    remaining = target_sum - root.val
    return (has_path_sum(root.left, remaining) or
            has_path_sum(root.right, remaining))

def path_sum_all(root, target_sum):
    """
    Find all root-to-leaf paths that sum to target.
    Time: $O(n)$, Space: $O(h)$
    """
    result = []

    def dfs(node, current_sum, path):
        if not node:
            return

        path.append(node.val)
        current_sum += node.val

        # Check if leaf node with target sum
        if not node.left and not node.right and current_sum == target_sum:
            result.append(path[:])

        dfs(node.left, current_sum, path)
        dfs(node.right, current_sum, path)

        path.pop()  # Backtrack

    dfs(root, 0, [])
    return result
</code></pre>
<h3 id="4-lowest-common-ancestor-lca"><a class="header" href="#4-lowest-common-ancestor-lca">4. Lowest Common Ancestor (LCA)</a></h3>
<pre><code class="language-python">def lowest_common_ancestor(root, p, q):
    """
    Find the lowest common ancestor of two nodes in a binary tree.
    Time: $O(n)$, Space: $O(h)$
    """
    if not root or root == p or root == q:
        return root

    left = lowest_common_ancestor(root.left, p, q)
    right = lowest_common_ancestor(root.right, p, q)

    # If both left and right are non-null, root is the LCA
    if left and right:
        return root

    # Otherwise, return the non-null child
    return left if left else right

def lca_bst(root, p, q):
    """
    LCA for Binary Search Tree (more efficient).
    Time: $O(h)$, Space: $O(1)$ iterative
    """
    while root:
        # Both nodes are in left subtree
        if p.val &lt; root.val and q.val &lt; root.val:
            root = root.left
        # Both nodes are in right subtree
        elif p.val &gt; root.val and q.val &gt; root.val:
            root = root.right
        # We've found the split point
        else:
            return root
</code></pre>
<h3 id="5-serialize-and-deserialize"><a class="header" href="#5-serialize-and-deserialize">5. Serialize and Deserialize</a></h3>
<pre><code class="language-python">def serialize(root):
    """
    Serialize a binary tree to a string.
    Time: $O(n)$, Space: $O(n)$
    """
    def dfs(node):
        if not node:
            return "None,"
        return str(node.val) + "," + dfs(node.left) + dfs(node.right)

    return dfs(root)

def deserialize(data):
    """
    Deserialize a string to a binary tree.
    Time: $O(n)$, Space: $O(n)$
    """
    def dfs(values):
        val = next(values)
        if val == "None":
            return None
        node = TreeNode(int(val))
        node.left = dfs(values)
        node.right = dfs(values)
        return node

    return dfs(iter(data.split(",")))
</code></pre>
<h3 id="6-construct-trees-from-traversals"><a class="header" href="#6-construct-trees-from-traversals">6. Construct Trees from Traversals</a></h3>
<pre><code class="language-python">def build_tree_from_inorder_preorder(preorder, inorder):
    """
    Construct binary tree from preorder and inorder traversals.
    Time: $O(n)$, Space: $O(n)$
    """
    if not preorder or not inorder:
        return None

    # First element in preorder is the root
    root_val = preorder[0]
    root = TreeNode(root_val)

    # Find root in inorder to split left/right subtrees
    mid = inorder.index(root_val)

    # Recursively build left and right subtrees
    root.left = build_tree_from_inorder_preorder(
        preorder[1:mid+1],
        inorder[:mid]
    )
    root.right = build_tree_from_inorder_preorder(
        preorder[mid+1:],
        inorder[mid+1:]
    )

    return root
</code></pre>
<h3 id="7-tree-symmetry"><a class="header" href="#7-tree-symmetry">7. Tree Symmetry</a></h3>
<pre><code class="language-python">def is_symmetric(root):
    """
    Check if a tree is symmetric (mirror of itself).
    Time: $O(n)$, Space: $O(h)$
    """
    def is_mirror(left, right):
        if not left and not right:
            return True
        if not left or not right:
            return False
        return (left.val == right.val and
                is_mirror(left.left, right.right) and
                is_mirror(left.right, right.left))

    return is_mirror(root, root)
</code></pre>
<h3 id="8-flatten-tree-to-linked-list"><a class="header" href="#8-flatten-tree-to-linked-list">8. Flatten Tree to Linked List</a></h3>
<pre><code class="language-python">def flatten_to_linked_list(root):
    """
    Flatten binary tree to a linked list (preorder).
    Time: $O(n)$, Space: $O(1)$
    """
    if not root:
        return

    current = root
    while current:
        if current.left:
            # Find the rightmost node of left subtree
            rightmost = current.left
            while rightmost.right:
                rightmost = rightmost.right

            # Connect it to current's right
            rightmost.right = current.right
            current.right = current.left
            current.left = None

        current = current.right
</code></pre>
<h2 id="complexity-cheat-sheet"><a class="header" href="#complexity-cheat-sheet">Complexity Cheat Sheet</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Operation</th><th>BST Average</th><th>BST Worst</th><th>AVL Tree</th><th>Red-Black Tree</th></tr></thead><tbody>
<tr><td>Search</td><td>$O(\log n)$</td><td>$O(n)$</td><td>$O(\log n)$</td><td>$O(\log n)$</td></tr>
<tr><td>Insert</td><td>$O(\log n)$</td><td>$O(n)$</td><td>$O(\log n)$</td><td>$O(\log n)$</td></tr>
<tr><td>Delete</td><td>$O(\log n)$</td><td>$O(n)$</td><td>$O(\log n)$</td><td>$O(\log n)$</td></tr>
<tr><td>Space</td><td>$O(n)$</td><td>$O(n)$</td><td>$O(n)$</td><td>$O(n)$</td></tr>
</tbody></table>
</div><div class="table-wrapper"><table><thead><tr><th>Traversal</th><th>Time</th><th>Space</th></tr></thead><tbody>
<tr><td>DFS (all)</td><td>$O(n)$</td><td>$O(h)$</td></tr>
<tr><td>BFS</td><td>$O(n)$</td><td>$O(w)$</td></tr>
</tbody></table>
</div>
<p>where:</p>
<ul>
<li>n = number of nodes</li>
<li>h = height of tree</li>
<li>w = maximum width of tree</li>
</ul>
<h2 id="tips-and-best-practices"><a class="header" href="#tips-and-best-practices">Tips and Best Practices</a></h2>
<h3 id="when-to-use-which-traversal"><a class="header" href="#when-to-use-which-traversal">When to Use Which Traversal?</a></h3>
<ol>
<li>
<p><strong>Preorder</strong> (Root → Left → Right):</p>
<ul>
<li>Creating a copy of the tree</li>
<li>Prefix expression of an expression tree</li>
<li>Serialization of a tree</li>
</ul>
</li>
<li>
<p><strong>Inorder</strong> (Left → Root → Right):</p>
<ul>
<li>Getting sorted order from BST</li>
<li>Validating BST</li>
<li>Finding kth smallest element in BST</li>
</ul>
</li>
<li>
<p><strong>Postorder</strong> (Left → Right → Root):</p>
<ul>
<li>Deleting a tree (delete children before parent)</li>
<li>Postfix expression evaluation</li>
<li>Calculating size/height of subtrees</li>
</ul>
</li>
<li>
<p><strong>Level Order</strong> (BFS):</p>
<ul>
<li>Finding shortest path</li>
<li>Level-by-level processing</li>
<li>Finding nodes at distance k</li>
<li>Checking if tree is complete</li>
</ul>
</li>
</ol>
<h3 id="common-patterns-11"><a class="header" href="#common-patterns-11">Common Patterns</a></h3>
<ol>
<li><strong>Two Pointer Pattern</strong>: Use two recursive calls to traverse both sides (LCA, tree symmetry)</li>
<li><strong>Path Tracking</strong>: Use backtracking to track paths (path sum, all paths)</li>
<li><strong>Bottom-Up</strong>: Process children first, then parent (tree diameter, balanced tree check)</li>
<li><strong>Level Processing</strong>: Process one level at a time (level order variants)</li>
<li><strong>Divide and Conquer</strong>: Split problem into left and right subtrees (construct tree from traversals)</li>
</ol>
<h3 id="interview-tips"><a class="header" href="#interview-tips">Interview Tips</a></h3>
<ol>
<li>
<p><strong>Always ask about tree properties</strong>:</p>
<ul>
<li>Is it a BST?</li>
<li>Is it balanced?</li>
<li>Can it have duplicate values?</li>
<li>Is it a complete/perfect binary tree?</li>
</ul>
</li>
<li>
<p><strong>Common edge cases to consider</strong>:</p>
<ul>
<li>Empty tree (root is None)</li>
<li>Single node tree</li>
<li>Skewed tree (all left or all right)</li>
<li>Complete binary tree</li>
<li>Perfect binary tree</li>
</ul>
</li>
<li>
<p><strong>Space vs Time tradeoffs</strong>:</p>
<ul>
<li>Recursive solutions: Clean code but $O(h)$ stack space</li>
<li>Iterative solutions: More complex but explicit stack control</li>
<li>Morris Traversal: $O(1)$ space but modifies tree temporarily</li>
</ul>
</li>
<li>
<p><strong>Optimization techniques</strong>:</p>
<ul>
<li>Early termination when answer is found</li>
<li>Use BST property to skip half the tree</li>
<li>Cache results to avoid recomputation</li>
<li>Use iterative DP for bottom-up approaches</li>
</ul>
</li>
</ol>
<h3 id="morris-traversal-o1-space"><a class="header" href="#morris-traversal-o1-space">Morris Traversal ($O(1)$ Space)</a></h3>
<p>For space-constrained environments, Morris Traversal allows inorder traversal with $O(1)$ space by temporarily modifying the tree:</p>
<pre><code class="language-python">def morris_inorder_traversal(root):
    """
    Inorder traversal with $O(1)$ space.
    Temporarily modifies tree structure but restores it.
    Time: $O(n)$, Space: $O(1)$
    """
    result = []
    current = root

    while current:
        if not current.left:
            # No left subtree, visit current and go right
            result.append(current.val)
            current = current.right
        else:
            # Find inorder predecessor
            predecessor = current.left
            while predecessor.right and predecessor.right != current:
                predecessor = predecessor.right

            if not predecessor.right:
                # Create temporary link
                predecessor.right = current
                current = current.left
            else:
                # Remove temporary link
                predecessor.right = None
                result.append(current.val)
                current = current.right

    return result
</code></pre>
<h2 id="conclusion-4"><a class="header" href="#conclusion-4">Conclusion</a></h2>
<p>Trees are fundamental data structures in computer science with wide-ranging applications:</p>
<ul>
<li><strong>Tree traversals</strong> provide different ways to visit nodes, each with specific use cases</li>
<li><strong>Binary Search Trees</strong> enable efficient searching, insertion, and deletion operations</li>
<li><strong>Balanced trees</strong> (AVL, Red-Black) guarantee $O(\log n)$ operations even in worst case</li>
<li><strong>Understanding tree patterns</strong> is crucial for solving complex algorithmic problems</li>
</ul>
<p>Key takeaways:</p>
<ol>
<li>Master all four traversal methods (preorder, inorder, postorder, level order)</li>
<li>Understand both recursive and iterative implementations</li>
<li>Practice common tree problems to recognize patterns</li>
<li>Know when to use which tree data structure for optimal performance</li>
<li>Always consider edge cases and space-time tradeoffs</li>
</ol>
<p>With solid understanding of tree algorithms, you'll be well-equipped to tackle a wide variety of programming challenges!</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="graphs-1"><a class="header" href="#graphs-1">Graphs</a></h1>
<p>Graphs are a fundamental data structure used to represent relationships between pairs of objects. They consist of vertices (or nodes) and edges (connections between the nodes). Graphs can be directed or undirected, weighted or unweighted, and are widely used in various applications such as social networks, transportation systems, and computer networks.</p>
<h2 id="key-concepts-7"><a class="header" href="#key-concepts-7">Key Concepts</a></h2>
<ul>
<li><strong>Vertices</strong>: The individual elements or nodes in a graph.</li>
<li><strong>Edges</strong>: The connections between the vertices, which can represent relationships or paths.</li>
<li><strong>Directed Graphs</strong>: Graphs where the edges have a direction, indicating a one-way relationship.</li>
<li><strong>Undirected Graphs</strong>: Graphs where the edges do not have a direction, indicating a two-way relationship.</li>
<li><strong>Weighted Graphs</strong>: Graphs where edges have weights, representing costs or distances associated with the connections.</li>
</ul>
<h2 id="common-algorithms-1"><a class="header" href="#common-algorithms-1">Common Algorithms</a></h2>
<ol>
<li>
<p><strong>Depth-First Search (DFS)</strong>: A traversal algorithm that explores as far as possible along each branch before backtracking. It can be implemented using recursion or a stack.</p>
</li>
<li>
<p><strong>Breadth-First Search (BFS)</strong>: A traversal algorithm that explores all neighbors at the present depth prior to moving on to nodes at the next depth level. It is typically implemented using a queue.</p>
</li>
<li>
<p><strong>Dijkstra's Algorithm</strong>: An algorithm for finding the shortest paths between nodes in a weighted graph, which may represent, for example, road networks.</p>
</li>
<li>
<p><em><em>A</em> Search Algorithm</em>*: An extension of Dijkstra's algorithm that uses heuristics to improve the efficiency of pathfinding.</p>
</li>
</ol>
<h2 id="applications-2"><a class="header" href="#applications-2">Applications</a></h2>
<p>Graphs are used in various applications, including:</p>
<ul>
<li><strong>Social Networks</strong>: Representing users as vertices and their relationships as edges.</li>
<li><strong>Routing Algorithms</strong>: Finding the shortest path in navigation systems.</li>
<li><strong>Network Topology</strong>: Analyzing the structure of computer networks.</li>
</ul>
<h2 id="conclusion-5"><a class="header" href="#conclusion-5">Conclusion</a></h2>
<p>Graphs are a versatile and powerful data structure that can model complex relationships and interactions. Understanding graph theory and its associated algorithms is essential for solving a wide range of problems in computer science and software engineering.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="heaps"><a class="header" href="#heaps">Heaps</a></h1>
<p>Heaps are a special tree-based data structure that satisfies the heap property. In a max heap, for any given node, the value of the node is greater than or equal to the values of its children, while in a min heap, the value of the node is less than or equal to the values of its children. Heaps are commonly used to implement priority queues and for efficient sorting algorithms.</p>
<h2 id="key-concepts-8"><a class="header" href="#key-concepts-8">Key Concepts</a></h2>
<ul>
<li>
<p><strong>Heap Property</strong>: The key property that defines a heap, ensuring that the parent node is either greater than (max heap) or less than (min heap) its children.</p>
</li>
<li>
<p><strong>Complete Binary Tree</strong>: Heaps are typically implemented as complete binary trees, where all levels are fully filled except possibly for the last level, which is filled from left to right.</p>
</li>
</ul>
<h2 id="common-operations-1"><a class="header" href="#common-operations-1">Common Operations</a></h2>
<ol>
<li>
<p><strong>Insertion</strong>: Adding a new element to the heap while maintaining the heap property. This is typically done by adding the element at the end of the tree and then "bubbling up" to restore the heap property.</p>
</li>
<li>
<p><strong>Deletion</strong>: Removing the root element (the maximum or minimum) from the heap. This involves replacing the root with the last element in the tree and then "bubbling down" to restore the heap property.</p>
</li>
<li>
<p><strong>Heapify</strong>: The process of converting an arbitrary array into a heap. This can be done in linear time using the bottom-up approach.</p>
</li>
</ol>
<h2 id="applications-3"><a class="header" href="#applications-3">Applications</a></h2>
<p>Heaps are widely used in various applications, including:</p>
<ul>
<li>
<p><strong>Priority Queues</strong>: Heaps provide an efficient way to implement priority queues, allowing for quick access to the highest (or lowest) priority element.</p>
</li>
<li>
<p><strong>Heap Sort</strong>: A comparison-based sorting algorithm that uses the heap data structure to sort elements in $O(n \log n)$ time.</p>
</li>
<li>
<p><strong>Graph Algorithms</strong>: Heaps are used in algorithms like Dijkstra's and Prim's to efficiently manage the set of vertices being processed.</p>
</li>
</ul>
<h2 id="conclusion-6"><a class="header" href="#conclusion-6">Conclusion</a></h2>
<p>Heaps are a versatile data structure that provides efficient solutions for various problems, particularly those involving priority management and sorting. Understanding heaps and their operations is essential for developing efficient algorithms in computer science and software engineering.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="tries"><a class="header" href="#tries">Tries</a></h1>
<p>A trie, also known as a prefix tree, is a specialized tree data structure used to store associative data structures. A common application of a trie is storing a predictive text or autocomplete dictionary.</p>
<h2 id="key-concepts-9"><a class="header" href="#key-concepts-9">Key Concepts</a></h2>
<ul>
<li>
<p><strong>Nodes</strong>: Each node in a trie represents a single character of a string. The root node represents an empty string.</p>
</li>
<li>
<p><strong>Edges</strong>: The connections between nodes represent the characters that make up the strings stored in the trie.</p>
</li>
<li>
<p><strong>Words</strong>: A word is formed by traversing from the root to a node that marks the end of a string.</p>
</li>
</ul>
<h2 id="common-operations-2"><a class="header" href="#common-operations-2">Common Operations</a></h2>
<ol>
<li>
<p><strong>Insertion</strong>: Adding a new word to the trie involves creating nodes for each character in the word and linking them together.</p>
</li>
<li>
<p><strong>Search</strong>: To check if a word exists in the trie, traverse the nodes according to the characters in the word. If you reach the end of the word and the last node is marked as a complete word, the word exists in the trie.</p>
</li>
<li>
<p><strong>Deletion</strong>: Removing a word from the trie involves traversing to the end of the word and removing nodes if they are no longer part of any other words.</p>
</li>
</ol>
<h2 id="applications-4"><a class="header" href="#applications-4">Applications</a></h2>
<p>Tries are widely used in various applications, including:</p>
<ul>
<li>
<p><strong>Autocomplete Systems</strong>: Providing suggestions based on the prefix of the input string.</p>
</li>
<li>
<p><strong>Spell Checkers</strong>: Checking the validity of words against a dictionary.</p>
</li>
<li>
<p><strong>IP Routing</strong>: Storing routing tables in networking.</p>
</li>
</ul>
<h2 id="conclusion-7"><a class="header" href="#conclusion-7">Conclusion</a></h2>
<p>Tries are a powerful data structure for managing a dynamic set of strings, particularly useful for applications involving prefix searches and dictionary implementations. Understanding tries and their operations is essential for developing efficient algorithms in computer science and software engineering.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="algorithms"><a class="header" href="#algorithms">Algorithms</a></h1>
<h2 id="overview-28"><a class="header" href="#overview-28">Overview</a></h2>
<p>An algorithm is a step-by-step procedure or formula for solving a problem. In computer science, algorithms are fundamental to writing efficient and effective code. Understanding algorithms helps you choose the right approach for solving computational problems and optimize performance.</p>
<h2 id="what-is-an-algorithm"><a class="header" href="#what-is-an-algorithm">What is an Algorithm?</a></h2>
<p>An algorithm must have these characteristics:</p>
<ol>
<li><strong>Input</strong>: Zero or more inputs</li>
<li><strong>Output</strong>: At least one output</li>
<li><strong>Definiteness</strong>: Clear and unambiguous steps</li>
<li><strong>Finiteness</strong>: Must terminate after a finite number of steps</li>
<li><strong>Effectiveness</strong>: Steps must be basic enough to be executed</li>
</ol>
<h2 id="algorithm-analysis"><a class="header" href="#algorithm-analysis">Algorithm Analysis</a></h2>
<h3 id="time-complexity-1"><a class="header" href="#time-complexity-1">Time Complexity</a></h3>
<p>Time complexity measures how the runtime of an algorithm grows with input size.</p>
<pre><code class="language-python"># O(1) - Constant time
def get_first_element(arr):
    return arr[0] if arr else None

# O(n) - Linear time
def find_element(arr, target):
    for elem in arr:
        if elem == target:
            return True
    return False

# O(n²) - Quadratic time
def bubble_sort(arr):
    n = len(arr)
    for i in range(n):
        for j in range(n - i - 1):
            if arr[j] &gt; arr[j + 1]:
                arr[j], arr[j + 1] = arr[j + 1], arr[j]
    return arr

# O(log n) - Logarithmic time
def binary_search(arr, target):
    left, right = 0, len(arr) - 1
    while left &lt;= right:
        mid = (left + right) // 2
        if arr[mid] == target:
            return mid
        elif arr[mid] &lt; target:
            left = mid + 1
        else:
            right = mid - 1
    return -1

# O(n log n) - Linearithmic time
def merge_sort(arr):
    if len(arr) &lt;= 1:
        return arr
    mid = len(arr) // 2
    left = merge_sort(arr[:mid])
    right = merge_sort(arr[mid:])
    return merge(left, right)
</code></pre>
<h3 id="space-complexity"><a class="header" href="#space-complexity">Space Complexity</a></h3>
<p>Space complexity measures the amount of memory an algorithm uses.</p>
<pre><code class="language-python"># O(1) space - In-place
def reverse_array_inplace(arr):
    left, right = 0, len(arr) - 1
    while left &lt; right:
        arr[left], arr[right] = arr[right], arr[left]
        left += 1
        right -= 1

# O(n) space - Additional array
def reverse_array_new(arr):
    return arr[::-1]

# O(n) space - Recursion stack
def factorial(n):
    if n &lt;= 1:
        return 1
    return n * factorial(n - 1)
</code></pre>
<h2 id="algorithm-categories"><a class="header" href="#algorithm-categories">Algorithm Categories</a></h2>
<h3 id="1-sorting-algorithms"><a class="header" href="#1-sorting-algorithms">1. Sorting Algorithms</a></h3>
<p>Transform data into a specific order (ascending/descending).</p>
<p><strong>Common Sorting Algorithms:</strong></p>
<ul>
<li>Bubble Sort - O(n²)</li>
<li>Selection Sort - O(n²)</li>
<li>Insertion Sort - O(n²)</li>
<li>Merge Sort - O(n log n)</li>
<li>Quick Sort - O(n log n) average</li>
<li>Heap Sort - O(n log n)</li>
</ul>
<p>See: <a href="algorithms/sorting.html">Sorting Algorithms</a></p>
<h3 id="2-searching-algorithms"><a class="header" href="#2-searching-algorithms">2. Searching Algorithms</a></h3>
<p>Find specific elements in data structures.</p>
<p><strong>Common Searching Algorithms:</strong></p>
<ul>
<li>Linear Search - O(n)</li>
<li>Binary Search - O(log n)</li>
<li>Jump Search - O(√n)</li>
<li>Interpolation Search - O(log log n) average</li>
</ul>
<p>See: <a href="algorithms/searching.html">Searching Algorithms</a></p>
<h3 id="3-graph-algorithms"><a class="header" href="#3-graph-algorithms">3. Graph Algorithms</a></h3>
<p>Solve problems related to graph structures.</p>
<p><strong>Common Graph Algorithms:</strong></p>
<ul>
<li>Breadth-First Search (BFS)</li>
<li>Depth-First Search (DFS)</li>
<li>Dijkstra's Algorithm</li>
<li>Bellman-Ford Algorithm</li>
<li>Floyd-Warshall Algorithm</li>
<li>Kruskal's Algorithm</li>
<li>Prim's Algorithm</li>
</ul>
<p>See: <a href="algorithms/graphs.html">Graph Algorithms</a></p>
<h3 id="4-tree-algorithms"><a class="header" href="#4-tree-algorithms">4. Tree Algorithms</a></h3>
<p>Operations on tree data structures.</p>
<p><strong>Common Tree Algorithms:</strong></p>
<ul>
<li>Tree Traversals (Inorder, Preorder, Postorder, Level-order)</li>
<li>Binary Search Tree Operations</li>
<li>AVL Tree Balancing</li>
<li>Red-Black Tree Operations</li>
<li>Trie Operations</li>
</ul>
<p>See: <a href="algorithms/trees.html">Tree Algorithms</a></p>
<h3 id="5-dynamic-programming"><a class="header" href="#5-dynamic-programming">5. Dynamic Programming</a></h3>
<p>Break complex problems into simpler subproblems and store results.</p>
<p><strong>Classic DP Problems:</strong></p>
<ul>
<li>Fibonacci Sequence</li>
<li>Longest Common Subsequence</li>
<li>Knapsack Problem</li>
<li>Matrix Chain Multiplication</li>
<li>Edit Distance</li>
</ul>
<p>See: <a href="algorithms/dynamic_programming.html">Dynamic Programming</a></p>
<h3 id="6-greedy-algorithms"><a class="header" href="#6-greedy-algorithms">6. Greedy Algorithms</a></h3>
<p>Make locally optimal choices at each step.</p>
<p><strong>Common Greedy Problems:</strong></p>
<ul>
<li>Activity Selection</li>
<li>Huffman Coding</li>
<li>Fractional Knapsack</li>
<li>Coin Change (greedy variant)</li>
<li>Job Sequencing</li>
</ul>
<p>See: <a href="algorithms/greedy_algorithms.html">Greedy Algorithms</a></p>
<h3 id="7-divide-and-conquer"><a class="header" href="#7-divide-and-conquer">7. Divide and Conquer</a></h3>
<p>Divide problem into subproblems, solve recursively, combine results.</p>
<p><strong>Examples:</strong></p>
<ul>
<li>Merge Sort</li>
<li>Quick Sort</li>
<li>Binary Search</li>
<li>Strassen's Matrix Multiplication</li>
<li>Closest Pair of Points</li>
</ul>
<p>See: <a href="algorithms/divide_and_conquer.html">Divide and Conquer</a></p>
<h3 id="8-backtracking"><a class="header" href="#8-backtracking">8. Backtracking</a></h3>
<p>Try all possibilities and backtrack when stuck.</p>
<p><strong>Classic Problems:</strong></p>
<ul>
<li>N-Queens Problem</li>
<li>Sudoku Solver</li>
<li>Permutations and Combinations</li>
<li>Graph Coloring</li>
<li>Hamiltonian Path</li>
</ul>
<p>See: <a href="algorithms/backtracking.html">Backtracking</a></p>
<h3 id="9-recursion"><a class="header" href="#9-recursion">9. Recursion</a></h3>
<p>Function calls itself to solve problems.</p>
<p><strong>Examples:</strong></p>
<ul>
<li>Factorial</li>
<li>Fibonacci</li>
<li>Tower of Hanoi</li>
<li>Tree Traversals</li>
<li>Divide and Conquer algorithms</li>
</ul>
<p>See: <a href="algorithms/recursion.html">Recursion</a></p>
<h2 id="common-algorithm-patterns"><a class="header" href="#common-algorithm-patterns">Common Algorithm Patterns</a></h2>
<h3 id="two-pointers"><a class="header" href="#two-pointers">Two Pointers</a></h3>
<pre><code class="language-python"># Find pair with given sum in sorted array
def find_pair_with_sum(arr, target):
    left, right = 0, len(arr) - 1
    
    while left &lt; right:
        current_sum = arr[left] + arr[right]
        if current_sum == target:
            return (arr[left], arr[right])
        elif current_sum &lt; target:
            left += 1
        else:
            right -= 1
    
    return None

# Remove duplicates from sorted array
def remove_duplicates(arr):
    if not arr:
        return 0
    
    write_index = 1
    for read_index in range(1, len(arr)):
        if arr[read_index] != arr[read_index - 1]:
            arr[write_index] = arr[read_index]
            write_index += 1
    
    return write_index
</code></pre>
<h3 id="sliding-window-1"><a class="header" href="#sliding-window-1">Sliding Window</a></h3>
<pre><code class="language-python"># Maximum sum subarray of size k
def max_sum_subarray(arr, k):
    if len(arr) &lt; k:
        return None
    
    # Calculate sum of first window
    window_sum = sum(arr[:k])
    max_sum = window_sum
    
    # Slide window
    for i in range(k, len(arr)):
        window_sum = window_sum - arr[i - k] + arr[i]
        max_sum = max(max_sum, window_sum)
    
    return max_sum

# Longest substring without repeating characters
def longest_unique_substring(s):
    char_index = {}
    max_length = 0
    start = 0
    
    for end in range(len(s)):
        if s[end] in char_index and char_index[s[end]] &gt;= start:
            start = char_index[s[end]] + 1
        
        char_index[s[end]] = end
        max_length = max(max_length, end - start + 1)
    
    return max_length
</code></pre>
<h3 id="fast-and-slow-pointers"><a class="header" href="#fast-and-slow-pointers">Fast and Slow Pointers</a></h3>
<pre><code class="language-python"># Detect cycle in linked list
def has_cycle(head):
    if not head:
        return False
    
    slow = fast = head
    
    while fast and fast.next:
        slow = slow.next
        fast = fast.next.next
        
        if slow == fast:
            return True
    
    return False

# Find middle of linked list
def find_middle(head):
    slow = fast = head
    
    while fast and fast.next:
        slow = slow.next
        fast = fast.next.next
    
    return slow
</code></pre>
<h3 id="merge-intervals"><a class="header" href="#merge-intervals">Merge Intervals</a></h3>
<pre><code class="language-python"># Merge overlapping intervals
def merge_intervals(intervals):
    if not intervals:
        return []
    
    # Sort by start time
    intervals.sort(key=lambda x: x[0])
    merged = [intervals[0]]
    
    for current in intervals[1:]:
        last = merged[-1]
        
        if current[0] &lt;= last[1]:
            # Overlapping - merge
            merged[-1] = (last[0], max(last[1], current[1]))
        else:
            # Non-overlapping - add
            merged.append(current)
    
    return merged
</code></pre>
<h3 id="binary-search-pattern"><a class="header" href="#binary-search-pattern">Binary Search Pattern</a></h3>
<pre><code class="language-python"># Find first occurrence
def find_first(arr, target):
    left, right = 0, len(arr) - 1
    result = -1
    
    while left &lt;= right:
        mid = (left + right) // 2
        
        if arr[mid] == target:
            result = mid
            right = mid - 1  # Continue searching left
        elif arr[mid] &lt; target:
            left = mid + 1
        else:
            right = mid - 1
    
    return result

# Find peak element
def find_peak(arr):
    left, right = 0, len(arr) - 1
    
    while left &lt; right:
        mid = (left + right) // 2
        
        if arr[mid] &gt; arr[mid + 1]:
            right = mid
        else:
            left = mid + 1
    
    return left
</code></pre>
<h2 id="problem-solving-approach"><a class="header" href="#problem-solving-approach">Problem-Solving Approach</a></h2>
<h3 id="1-understand-the-problem"><a class="header" href="#1-understand-the-problem">1. Understand the Problem</a></h3>
<ul>
<li>Read carefully</li>
<li>Identify inputs and outputs</li>
<li>Clarify constraints</li>
<li>Consider edge cases</li>
</ul>
<h3 id="2-plan-your-approach"><a class="header" href="#2-plan-your-approach">2. Plan Your Approach</a></h3>
<ul>
<li>Think of similar problems</li>
<li>Consider multiple solutions</li>
<li>Analyze time/space complexity</li>
<li>Choose appropriate data structures</li>
</ul>
<h3 id="3-implement"><a class="header" href="#3-implement">3. Implement</a></h3>
<ul>
<li>Write clean, readable code</li>
<li>Use meaningful variable names</li>
<li>Add comments for complex logic</li>
<li>Handle edge cases</li>
</ul>
<h3 id="4-test"><a class="header" href="#4-test">4. Test</a></h3>
<ul>
<li>Test with sample inputs</li>
<li>Test edge cases (empty, single element, large input)</li>
<li>Test boundary conditions</li>
<li>Verify correctness</li>
</ul>
<h3 id="5-optimize"><a class="header" href="#5-optimize">5. Optimize</a></h3>
<ul>
<li>Analyze bottlenecks</li>
<li>Consider trade-offs</li>
<li>Improve time/space complexity</li>
<li>Refactor for clarity</li>
</ul>
<h2 id="time-complexity-cheat-sheet"><a class="header" href="#time-complexity-cheat-sheet">Time Complexity Cheat Sheet</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Complexity</th><th>Name</th><th>Example</th></tr></thead><tbody>
<tr><td>O(1)</td><td>Constant</td><td>Array access, hash table lookup</td></tr>
<tr><td>O(log n)</td><td>Logarithmic</td><td>Binary search</td></tr>
<tr><td>O(n)</td><td>Linear</td><td>Linear search, array traversal</td></tr>
<tr><td>O(n log n)</td><td>Linearithmic</td><td>Merge sort, quick sort (average)</td></tr>
<tr><td>O(n²)</td><td>Quadratic</td><td>Bubble sort, nested loops</td></tr>
<tr><td>O(n³)</td><td>Cubic</td><td>Triple nested loops</td></tr>
<tr><td>O(2ⁿ)</td><td>Exponential</td><td>Recursive fibonacci</td></tr>
<tr><td>O(n!)</td><td>Factorial</td><td>Permutations</td></tr>
</tbody></table>
</div>
<h2 id="space-complexity-considerations"><a class="header" href="#space-complexity-considerations">Space Complexity Considerations</a></h2>
<ol>
<li><strong>In-place algorithms</strong>: O(1) space - modify input directly</li>
<li><strong>Recursion</strong>: O(n) space for call stack</li>
<li><strong>Memoization</strong>: Trade space for time</li>
<li><strong>Auxiliary data structures</strong>: Arrays, hash tables, etc.</li>
</ol>
<h2 id="interview-tips-1"><a class="header" href="#interview-tips-1">Interview Tips</a></h2>
<h3 id="common-algorithm-questions"><a class="header" href="#common-algorithm-questions">Common Algorithm Questions</a></h3>
<ol>
<li>
<p><strong>Arrays and Strings</strong></p>
<ul>
<li>Two Sum</li>
<li>Reverse String</li>
<li>Longest Substring</li>
<li>Array Rotation</li>
</ul>
</li>
<li>
<p><strong>Linked Lists</strong></p>
<ul>
<li>Reverse Linked List</li>
<li>Detect Cycle</li>
<li>Merge Two Lists</li>
<li>Find Middle</li>
</ul>
</li>
<li>
<p><strong>Trees and Graphs</strong></p>
<ul>
<li>Tree Traversals</li>
<li>Validate BST</li>
<li>Lowest Common Ancestor</li>
<li>Graph BFS/DFS</li>
</ul>
</li>
<li>
<p><strong>Dynamic Programming</strong></p>
<ul>
<li>Fibonacci</li>
<li>Climbing Stairs</li>
<li>Coin Change</li>
<li>Longest Increasing Subsequence</li>
</ul>
</li>
<li>
<p><strong>Sorting and Searching</strong></p>
<ul>
<li>Binary Search variants</li>
<li>Merge K Sorted Lists</li>
<li>Find Kth Largest</li>
<li>Quick Select</li>
</ul>
</li>
</ol>
<h3 id="best-practices-27"><a class="header" href="#best-practices-27">Best Practices</a></h3>
<ol>
<li><strong>Communication</strong>: Think aloud</li>
<li><strong>Clarification</strong>: Ask questions</li>
<li><strong>Examples</strong>: Work through examples</li>
<li><strong>Optimization</strong>: Discuss trade-offs</li>
<li><strong>Testing</strong>: Verify with test cases</li>
<li><strong>Edge Cases</strong>: Consider all scenarios</li>
<li><strong>Clean Code</strong>: Write readable code</li>
<li><strong>Time Management</strong>: Don't get stuck</li>
</ol>
<h2 id="practice-resources"><a class="header" href="#practice-resources">Practice Resources</a></h2>
<h3 id="online-platforms"><a class="header" href="#online-platforms">Online Platforms</a></h3>
<ul>
<li>LeetCode</li>
<li>HackerRank</li>
<li>CodeSignal</li>
<li>Project Euler</li>
<li>Codeforces</li>
<li>AtCoder</li>
</ul>
<h3 id="books-3"><a class="header" href="#books-3">Books</a></h3>
<ul>
<li>"Introduction to Algorithms" (CLRS)</li>
<li>"Algorithm Design Manual" (Skiena)</li>
<li>"Cracking the Coding Interview"</li>
<li>"Elements of Programming Interviews"</li>
</ul>
<h2 id="available-topics"><a class="header" href="#available-topics">Available Topics</a></h2>
<p>Explore detailed guides for specific algorithm types:</p>
<ol>
<li><a href="algorithms/big_o.html">Big O Notation</a> - Understanding algorithm complexity</li>
<li><a href="algorithms/sorting.html">Sorting Algorithms</a> - Comprehensive sorting guide</li>
<li><a href="algorithms/searching.html">Searching Algorithms</a> - Various search techniques</li>
<li><a href="algorithms/graphs.html">Graph Algorithms</a> - Graph traversal and algorithms</li>
<li><a href="algorithms/trees.html">Tree Algorithms</a> - Tree operations and traversals</li>
<li><a href="algorithms/dynamic_programming.html">Dynamic Programming</a> - DP patterns and problems</li>
<li><a href="algorithms/greedy_algorithms.html">Greedy Algorithms</a> - Greedy approach and examples</li>
<li><a href="algorithms/divide_and_conquer.html">Divide and Conquer</a> - D&amp;C strategy</li>
<li><a href="algorithms/backtracking.html">Backtracking</a> - Backtracking techniques</li>
<li><a href="algorithms/recursion.html">Recursion</a> - Recursive problem solving</li>
<li><a href="algorithms/heaps.html">Heaps</a> - Heap data structure and algorithms</li>
<li><a href="algorithms/tries.html">Tries</a> - Trie data structure and applications</li>
<li><a href="algorithms/raft.html">Raft Consensus</a> - Distributed consensus algorithm for replicated logs</li>
</ol>
<h2 id="quick-reference-4"><a class="header" href="#quick-reference-4">Quick Reference</a></h2>
<h3 id="most-important-algorithms-to-know"><a class="header" href="#most-important-algorithms-to-know">Most Important Algorithms to Know</a></h3>
<p><strong>Sorting:</strong></p>
<ul>
<li>Quick Sort</li>
<li>Merge Sort</li>
<li>Heap Sort</li>
</ul>
<p><strong>Searching:</strong></p>
<ul>
<li>Binary Search</li>
<li>Depth-First Search (DFS)</li>
<li>Breadth-First Search (BFS)</li>
</ul>
<p><strong>Graph:</strong></p>
<ul>
<li>Dijkstra's Algorithm</li>
<li>Topological Sort</li>
<li>Union-Find</li>
</ul>
<p><strong>Dynamic Programming:</strong></p>
<ul>
<li>0/1 Knapsack</li>
<li>Longest Common Subsequence</li>
<li>Edit Distance</li>
</ul>
<p><strong>String:</strong></p>
<ul>
<li>KMP Pattern Matching</li>
<li>Rabin-Karp</li>
<li>Trie Operations</li>
</ul>
<h2 id="next-steps-3"><a class="header" href="#next-steps-3">Next Steps</a></h2>
<ol>
<li>Review <a href="algorithms/big_o.html">Big O Notation</a> for complexity analysis</li>
<li>Practice with <a href="algorithms/sorting.html">Sorting</a> and <a href="algorithms/searching.html">Searching</a></li>
<li>Master <a href="algorithms/recursion.html">Recursion</a> fundamentals</li>
<li>Explore <a href="algorithms/dynamic_programming.html">Dynamic Programming</a></li>
<li>Study <a href="algorithms/graphs.html">Graph Algorithms</a> and <a href="algorithms/trees.html">Trees</a></li>
<li>Practice on coding platforms</li>
<li>Participate in coding contests</li>
<li>Review and optimize solutions</li>
</ol>
<p>Remember: The key to mastering algorithms is consistent practice and understanding the underlying patterns. Start with fundamentals and gradually tackle more complex problems.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="big-o-notation"><a class="header" href="#big-o-notation">Big O Notation</a></h1>
<p>Big O notation is a mathematical concept used to describe the performance or complexity of an algorithm. Specifically, it characterizes algorithms in terms of their time or space requirements in relation to the size of the input data. Understanding Big O notation is crucial for evaluating the efficiency of algorithms and making informed decisions about which algorithm to use in a given situation.</p>
<h2 id="key-concepts-10"><a class="header" href="#key-concepts-10">Key Concepts</a></h2>
<ul>
<li>
<p><strong>Time Complexity</strong>: This refers to the amount of time an algorithm takes to complete as a function of the length of the input. It helps in understanding how the execution time increases with the size of the input.</p>
</li>
<li>
<p><strong>Space Complexity</strong>: This refers to the amount of memory an algorithm uses in relation to the input size. It is important to consider both time and space complexity when analyzing an algorithm.</p>
</li>
</ul>
<h2 id="common-big-o-notations"><a class="header" href="#common-big-o-notations">Common Big O Notations</a></h2>
<h3 id="o1---constant-time"><a class="header" href="#o1---constant-time">$O(1)$ - Constant Time</a></h3>
<p>The execution time does not change regardless of the input size.</p>
<pre><code class="language-python">def get_first_element(arr):
    return arr[0]  # Always one operation

def hash_lookup(dictionary, key):
    return dictionary[key]  # Constant time hash table lookup

# Example
arr = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
print(get_first_element(arr))  # $O(1)$
</code></pre>
<p><strong>Examples</strong>: Array access, hash table operations, simple arithmetic</p>
<h3 id="olog-n---logarithmic-time"><a class="header" href="#olog-n---logarithmic-time">$O(\log n)$ - Logarithmic Time</a></h3>
<p>The execution time grows logarithmically as the input size increases.</p>
<pre><code class="language-python">def binary_search(arr, target):
    left, right = 0, len(arr) - 1
    
    while left &lt;= right:
        mid = (left + right) // 2
        if arr[mid] == target:
            return mid
        elif arr[mid] &lt; target:
            left = mid + 1
        else:
            right = mid - 1
    return -1

# Example: With 1000 elements, only ~10 comparisons needed
arr = list(range(1000))
print(binary_search(arr, 742))  # $O(\log n)$
</code></pre>
<p><strong>Examples</strong>: Binary search, balanced binary tree operations</p>
<h3 id="on---linear-time"><a class="header" href="#on---linear-time">$O(n)$ - Linear Time</a></h3>
<p>The execution time grows linearly with the input size.</p>
<pre><code class="language-python">def linear_search(arr, target):
    for i, element in enumerate(arr):
        if element == target:
            return i
    return -1

def find_max(arr):
    max_val = arr[0]
    for num in arr:
        if num &gt; max_val:
            max_val = num
    return max_val

# Example
arr = [3, 1, 4, 1, 5, 9, 2, 6, 5, 3]
print(linear_search(arr, 9))  # $O(n)$
print(find_max(arr))          # $O(n)$
</code></pre>
<p><strong>Examples</strong>: Linear search, array traversal, finding min/max</p>
<h3 id="on-log-n---linearithmic-time"><a class="header" href="#on-log-n---linearithmic-time">$O(n \log n)$ - Linearithmic Time</a></h3>
<p>Common in efficient sorting algorithms.</p>
<pre><code class="language-python">def merge_sort(arr):
    if len(arr) &lt;= 1:
        return arr
    
    mid = len(arr) // 2
    left = merge_sort(arr[:mid])
    right = merge_sort(arr[mid:])
    
    return merge(left, right)

def merge(left, right):
    result = []
    i = j = 0
    
    while i &lt; len(left) and j &lt; len(right):
        if left[i] &lt;= right[j]:
            result.append(left[i])
            i += 1
        else:
            result.append(right[j])
            j += 1
    
    result.extend(left[i:])
    result.extend(right[j:])
    return result

# Example
arr = [38, 27, 43, 3, 9, 82, 10]
print(merge_sort(arr))  # $O(n \log n)$
</code></pre>
<p><strong>Examples</strong>: Merge sort, heap sort, quick sort (average case)</p>
<h3 id="on2---quadratic-time"><a class="header" href="#on2---quadratic-time">$O(n^2)$ - Quadratic Time</a></h3>
<p>The execution time grows quadratically with the input size.</p>
<pre><code class="language-python">def bubble_sort(arr):
    n = len(arr)
    for i in range(n):
        for j in range(0, n - i - 1):
            if arr[j] &gt; arr[j + 1]:
                arr[j], arr[j + 1] = arr[j + 1], arr[j]
    return arr

def find_duplicates_naive(arr):
    duplicates = []
    for i in range(len(arr)):
        for j in range(i + 1, len(arr)):
            if arr[i] == arr[j]:
                duplicates.append(arr[i])
    return duplicates

# Example
arr = [64, 34, 25, 12, 22, 11, 90]
print(bubble_sort(arr.copy()))  # $O(n^2)$
</code></pre>
<p><strong>Examples</strong>: Bubble sort, selection sort, insertion sort, nested loops</p>
<h3 id="o2n---exponential-time"><a class="header" href="#o2n---exponential-time">$O(2^n)$ - Exponential Time</a></h3>
<p>The execution time doubles with each additional element.</p>
<pre><code class="language-python">def fibonacci_recursive(n):
    if n &lt;= 1:
        return n
    return fibonacci_recursive(n - 1) + fibonacci_recursive(n - 2)

def power_set(s):
    if not s:
        return [[]]
    
    subsets = power_set(s[1:])
    return subsets + [[s[0]] + subset for subset in subsets]

# Example (slow for large n!)
print(fibonacci_recursive(10))  # $O(2^n)$
print(power_set([1, 2, 3]))     # $O(2^n)$
</code></pre>
<p><strong>Examples</strong>: Recursive Fibonacci, generating all subsets</p>
<h3 id="on---factorial-time"><a class="header" href="#on---factorial-time">$O(n!)$ - Factorial Time</a></h3>
<p>The execution time grows factorially with the input size.</p>
<pre><code class="language-python">def permutations(arr):
    if len(arr) &lt;= 1:
        return [arr]
    
    result = []
    for i in range(len(arr)):
        rest = arr[:i] + arr[i+1:]
        for p in permutations(rest):
            result.append([arr[i]] + p)
    return result

# Example (very slow!)
print(permutations([1, 2, 3]))  # $O(n!)$
# For n=10, this would generate 3,628,800 permutations!
</code></pre>
<p><strong>Examples</strong>: Generating all permutations, traveling salesman (brute force)</p>
<h2 id="complexity-comparison"><a class="header" href="#complexity-comparison">Complexity Comparison</a></h2>
<pre><code class="language-python">import time
import random

def compare_complexities(n):
    # $O(1)$
    start = time.time()
    _ = n
    o1_time = time.time() - start

    # $O(\log n)$
    start = time.time()
    _ = n.bit_length()
    olog_time = time.time() - start

    # $O(n)$
    start = time.time()
    _ = sum(range(n))
    on_time = time.time() - start

    # $O(n \log n)$
    start = time.time()
    arr = list(range(n))
    random.shuffle(arr)
    _ = sorted(arr)
    onlogn_time = time.time() - start

    # $O(n^2)$
    start = time.time()
    for i in range(min(n, 1000)):  # Limited to avoid long wait
        for j in range(min(n, 1000)):
            pass
    on2_time = time.time() - start
    
    print(f"n = {n}:")
    print(f"  $O(1)$:      {o1_time:.6f}s")
    print(f"  $O(\log n)$:  {olog_time:.6f}s")
    print(f"  $O(n)$:      {on_time:.6f}s")
    print(f"  $O(n \log n)$:{onlogn_time:.6f}s")
    print(f"  $O(n^2)$:     {on2_time:.6f}s (limited)")

# Example
compare_complexities(10000)
</code></pre>
<h2 id="space-complexity-examples"><a class="header" href="#space-complexity-examples">Space Complexity Examples</a></h2>
<pre><code class="language-python"># $O(1)$ space - In-place
def reverse_array_inplace(arr):
    left, right = 0, len(arr) - 1
    while left &lt; right:
        arr[left], arr[right] = arr[right], arr[left]
        left += 1
        right -= 1

# $O(n)$ space - Additional array
def reverse_array_new(arr):
    return arr[::-1]

# $O(n)$ space - Recursion stack
def factorial_recursive(n):
    if n &lt;= 1:
        return 1
    return n * factorial_recursive(n - 1)

# $O(n^2)$ space - 2D array
def create_matrix(n):
    return [[0 for _ in range(n)] for _ in range(n)]
</code></pre>
<h2 id="best-average-and-worst-case"><a class="header" href="#best-average-and-worst-case">Best, Average, and Worst Case</a></h2>
<p>Different scenarios can have different complexities:</p>
<pre><code class="language-python">def quick_sort(arr):
    if len(arr) &lt;= 1:
        return arr
    
    pivot = arr[len(arr) // 2]
    left = [x for x in arr if x &lt; pivot]
    middle = [x for x in arr if x == pivot]
    right = [x for x in arr if x &gt; pivot]
    
    return quick_sort(left) + middle + quick_sort(right)

# Quick Sort:
# Best case:    $O(n \log n)$ - balanced partitions
# Average case: $O(n \log n)$
# Worst case:   $O(n^2)$ - already sorted array
</code></pre>
<h2 id="analyzing-algorithm-complexity"><a class="header" href="#analyzing-algorithm-complexity">Analyzing Algorithm Complexity</a></h2>
<pre><code class="language-python">def example_algorithm(arr):
    n = len(arr)

    # $O(1)$ - constant operations
    first = arr[0]
    last = arr[-1]

    # $O(n)$ - single loop
    total = sum(arr)

    # $O(n^2)$ - nested loops
    for i in range(n):
        for j in range(n):
            pass

    # $O(n \log n)$ - sorting
    sorted_arr = sorted(arr)

    # Overall: $O(1) + O(n) + O(n^2) + O(n \log n) = O(n^2)$
    # (Dominant term is $n^2$)
</code></pre>
<h2 id="big-o-rules"><a class="header" href="#big-o-rules">Big O Rules</a></h2>
<ol>
<li><strong>Drop constants</strong>: $O(2n) \to O(n)$</li>
<li><strong>Drop non-dominant terms</strong>: $O(n^2 + n) \to O(n^2)$</li>
<li><strong>Different inputs use different variables</strong>: $O(a + b)$ for two arrays</li>
<li><strong>Multiplication for nested</strong>: $O(a \times b)$ for nested loops over different arrays</li>
</ol>
<pre><code class="language-python"># Rule 1: Drop constants
def example1(arr):
    for item in arr:        # $O(n)$
        print(item)
    for item in arr:        # $O(n)$
        print(item)
    # Total: $O(2n) = O(n)$

# Rule 2: Drop non-dominant terms
def example2(arr):
    for i in range(len(arr)):           # $O(n)$
        for j in range(len(arr)):       # $O(n^2)$
            print(i, j)
    for item in arr:                    # $O(n)$
        print(item)
    # Total: $O(n^2 + n) = O(n^2)$

# Rule 3: Different inputs
def example3(arr1, arr2):
    for item in arr1:       # $O(a)$
        print(item)
    for item in arr2:       # $O(b)$
        print(item)
    # Total: $O(a + b)$

# Rule 4: Multiplication for nested
def example4(arr1, arr2):
    for item1 in arr1:              # $O(a)$
        for item2 in arr2:          # $O(b)$
            print(item1, item2)
    # Total: $O(a \times b)$
</code></pre>
<h2 id="complexity-cheat-sheet-1"><a class="header" href="#complexity-cheat-sheet-1">Complexity Cheat Sheet</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Complexity</th><th>Name</th><th>Example Operations</th></tr></thead><tbody>
<tr><td>$O(1)$</td><td>Constant</td><td>Array access, hash lookup</td></tr>
<tr><td>$O(\log n)$</td><td>Logarithmic</td><td>Binary search</td></tr>
<tr><td>$O(n)$</td><td>Linear</td><td>Loop through array</td></tr>
<tr><td>$O(n \log n)$</td><td>Linearithmic</td><td>Efficient sorting</td></tr>
<tr><td>$O(n^2)$</td><td>Quadratic</td><td>Nested loops</td></tr>
<tr><td>$O(n^3)$</td><td>Cubic</td><td>Triple nested loops</td></tr>
<tr><td>$O(2^n)$</td><td>Exponential</td><td>Recursive Fibonacci</td></tr>
<tr><td>$O(n!)$</td><td>Factorial</td><td>All permutations</td></tr>
</tbody></table>
</div>
<h2 id="growth-rates-visualization"><a class="header" href="#growth-rates-visualization">Growth Rates Visualization</a></h2>
<pre><code>For n = 100:
$O(1)$:      1 operation
$O(\log n)$:  7 operations
$O(n)$:      100 operations
$O(n \log n)$:700 operations
$O(n^2)$:     10,000 operations
$O(n^3)$:     1,000,000 operations
$O(2^n)$:    $1.27 \times 10^{30}$ operations (intractable!)
$O(n!)$:     $9.33 \times 10^{157}$ operations (impossible!)
</code></pre>
<h2 id="practical-tips"><a class="header" href="#practical-tips">Practical Tips</a></h2>
<ol>
<li><strong>Optimize bottlenecks</strong>: Focus on the most time-consuming parts</li>
<li><strong>Trade-offs</strong>: Sometimes $O(n)$ space can give $O(1)$ time (caching)</li>
<li><strong>Real-world considerations</strong>: Constants matter for small n</li>
<li><strong>Amortized analysis</strong>: Some operations are cheaper on average</li>
<li><strong>Choose appropriately</strong>: Don't over-optimize; $O(n^2)$ is fine for small n</li>
</ol>
<h2 id="conclusion-8"><a class="header" href="#conclusion-8">Conclusion</a></h2>
<p>Big O notation provides a high-level understanding of the efficiency of algorithms, allowing developers to compare and choose the most suitable algorithm for their needs. By analyzing both time and space complexity, one can make informed decisions that lead to better performance in software applications.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="recursion"><a class="header" href="#recursion">Recursion</a></h1>
<p>Recursion is a programming technique where a function calls itself in order to solve a problem. It is often used to break down complex problems into simpler subproblems.</p>
<h2 id="key-concepts-11"><a class="header" href="#key-concepts-11">Key Concepts</a></h2>
<ul>
<li>
<p><strong>Base Case</strong>: The condition under which the recursion ends. It prevents infinite loops and allows the function to return a result.</p>
</li>
<li>
<p><strong>Recursive Case</strong>: The part of the function where the recursion occurs, typically involving a call to the same function with modified arguments.</p>
</li>
</ul>
<h2 id="factorial"><a class="header" href="#factorial">Factorial</a></h2>
<p>The factorial of a non-negative integer n is the product of all positive integers less than or equal to n.</p>
<pre><code class="language-python">def factorial(n):
    # Base case
    if n == 0 or n == 1:
        return 1
    # Recursive case
    return n * factorial(n - 1)

# Example usage
print(factorial(5))  # Output: 120
</code></pre>
<h2 id="fibonacci-sequence"><a class="header" href="#fibonacci-sequence">Fibonacci Sequence</a></h2>
<p>The Fibonacci sequence where each number is the sum of the two preceding ones.</p>
<pre><code class="language-python"># Simple recursion (exponential time)
def fibonacci(n):
    if n &lt;= 1:
        return n
    return fibonacci(n - 1) + fibonacci(n - 2)

# With memoization (linear time)
def fibonacci_memo(n, memo={}):
    if n in memo:
        return memo[n]
    if n &lt;= 1:
        return n
    memo[n] = fibonacci_memo(n - 1, memo) + fibonacci_memo(n - 2, memo)
    return memo[n]

# Example usage
print(fibonacci(10))       # Output: 55
print(fibonacci_memo(100)) # Much faster for large n
</code></pre>
<h2 id="binary-search"><a class="header" href="#binary-search">Binary Search</a></h2>
<p>Recursive implementation of binary search.</p>
<pre><code class="language-python">def binary_search(arr, target, left, right):
    # Base case: element not found
    if left &gt; right:
        return -1
    
    mid = left + (right - left) // 2
    
    # Base case: element found
    if arr[mid] == target:
        return mid
    
    # Recursive cases
    if arr[mid] &gt; target:
        return binary_search(arr, target, left, mid - 1)
    else:
        return binary_search(arr, target, mid + 1, right)

# Example usage
arr = [1, 3, 5, 7, 9, 11, 13]
result = binary_search(arr, 7, 0, len(arr) - 1)
print(f"Element found at index: {result}")  # Output: 3
</code></pre>
<h2 id="sum-of-array"><a class="header" href="#sum-of-array">Sum of Array</a></h2>
<p>Calculate the sum of all elements in an array recursively.</p>
<pre><code class="language-python">def array_sum(arr):
    # Base case: empty array
    if not arr:
        return 0
    # Recursive case: first element + sum of rest
    return arr[0] + array_sum(arr[1:])

# Optimized with index
def array_sum_optimized(arr, index=0):
    if index == len(arr):
        return 0
    return arr[index] + array_sum_optimized(arr, index + 1)

# Example usage
numbers = [1, 2, 3, 4, 5]
print(array_sum(numbers))  # Output: 15
</code></pre>
<h2 id="power-function"><a class="header" href="#power-function">Power Function</a></h2>
<p>Calculate x raised to the power n.</p>
<pre><code class="language-python"># Simple recursion
def power(x, n):
    if n == 0:
        return 1
    return x * power(x, n - 1)

# Optimized (divide and conquer)
def power_optimized(x, n):
    if n == 0:
        return 1
    
    half = power_optimized(x, n // 2)
    
    if n % 2 == 0:
        return half * half
    else:
        return x * half * half

# Example usage
print(power(2, 10))           # Output: 1024
print(power_optimized(2, 10)) # Faster for large n
</code></pre>
<h2 id="string-reversal"><a class="header" href="#string-reversal">String Reversal</a></h2>
<p>Reverse a string using recursion.</p>
<pre><code class="language-python">def reverse_string(s):
    # Base case: empty or single character
    if len(s) &lt;= 1:
        return s
    # Recursive case: last char + reverse of rest
    return s[-1] + reverse_string(s[:-1])

# Alternative implementation
def reverse_string_alt(s):
    if len(s) == 0:
        return s
    return reverse_string_alt(s[1:]) + s[0]

# Example usage
print(reverse_string("hello"))  # Output: "olleh"
</code></pre>
<h2 id="palindrome-check"><a class="header" href="#palindrome-check">Palindrome Check</a></h2>
<p>Check if a string is a palindrome recursively.</p>
<pre><code class="language-python">def is_palindrome(s, left=0, right=None):
    if right is None:
        right = len(s) - 1
    
    # Base cases
    if left &gt;= right:
        return True
    
    if s[left] != s[right]:
        return False
    
    # Recursive case
    return is_palindrome(s, left + 1, right - 1)

# Example usage
print(is_palindrome("racecar"))  # Output: True
print(is_palindrome("hello"))    # Output: False
</code></pre>
<h2 id="tree-traversals"><a class="header" href="#tree-traversals">Tree Traversals</a></h2>
<p>Recursive tree traversal algorithms.</p>
<pre><code class="language-python">class TreeNode:
    def __init__(self, val=0, left=None, right=None):
        self.val = val
        self.left = left
        self.right = right

# Inorder traversal (left, root, right)
def inorder(root):
    if root is None:
        return []
    return inorder(root.left) + [root.val] + inorder(root.right)

# Preorder traversal (root, left, right)
def preorder(root):
    if root is None:
        return []
    return [root.val] + preorder(root.left) + preorder(root.right)

# Postorder traversal (left, right, root)
def postorder(root):
    if root is None:
        return []
    return postorder(root.left) + postorder(root.right) + [root.val]

# Tree height
def tree_height(root):
    if root is None:
        return 0
    return 1 + max(tree_height(root.left), tree_height(root.right))

# Example usage
#       1
#      / \
#     2   3
#    / \
#   4   5
root = TreeNode(1)
root.left = TreeNode(2)
root.right = TreeNode(3)
root.left.left = TreeNode(4)
root.left.right = TreeNode(5)

print("Inorder:", inorder(root))    # [4, 2, 5, 1, 3]
print("Preorder:", preorder(root))  # [1, 2, 4, 5, 3]
print("Postorder:", postorder(root))# [4, 5, 2, 3, 1]
print("Height:", tree_height(root)) # 3
</code></pre>
<h2 id="greatest-common-divisor-gcd"><a class="header" href="#greatest-common-divisor-gcd">Greatest Common Divisor (GCD)</a></h2>
<p>Find GCD using Euclidean algorithm.</p>
<pre><code class="language-python">def gcd(a, b):
    # Base case
    if b == 0:
        return a
    # Recursive case
    return gcd(b, a % b)

# Example usage
print(gcd(48, 18))  # Output: 6
</code></pre>
<h2 id="tower-of-hanoi"><a class="header" href="#tower-of-hanoi">Tower of Hanoi</a></h2>
<p>Classic puzzle solved recursively.</p>
<pre><code class="language-python">def tower_of_hanoi(n, source, destination, auxiliary):
    if n == 1:
        print(f"Move disk 1 from {source} to {destination}")
        return
    
    # Move n-1 disks from source to auxiliary
    tower_of_hanoi(n - 1, source, auxiliary, destination)
    
    # Move nth disk from source to destination
    print(f"Move disk {n} from {source} to {destination}")
    
    # Move n-1 disks from auxiliary to destination
    tower_of_hanoi(n - 1, auxiliary, destination, source)

# Example usage
tower_of_hanoi(3, 'A', 'C', 'B')
</code></pre>
<h2 id="flatten-nested-list"><a class="header" href="#flatten-nested-list">Flatten Nested List</a></h2>
<p>Flatten a nested list structure.</p>
<pre><code class="language-python">def flatten(nested_list):
    result = []
    for item in nested_list:
        if isinstance(item, list):
            result.extend(flatten(item))
        else:
            result.append(item)
    return result

# Example usage
nested = [1, [2, [3, 4], 5], 6, [7, 8]]
print(flatten(nested))  # Output: [1, 2, 3, 4, 5, 6, 7, 8]
</code></pre>
<h2 id="recursive-patterns"><a class="header" href="#recursive-patterns">Recursive Patterns</a></h2>
<p>Common recursive patterns to recognize:</p>
<h3 id="1-linear-recursion"><a class="header" href="#1-linear-recursion">1. Linear Recursion</a></h3>
<pre><code class="language-python">def linear_recursion(n):
    if n == 0:
        return 0
    return n + linear_recursion(n - 1)
</code></pre>
<h3 id="2-binary-recursion"><a class="header" href="#2-binary-recursion">2. Binary Recursion</a></h3>
<pre><code class="language-python">def binary_recursion(n):
    if n &lt;= 1:
        return n
    return binary_recursion(n - 1) + binary_recursion(n - 2)
</code></pre>
<h3 id="3-tail-recursion"><a class="header" href="#3-tail-recursion">3. Tail Recursion</a></h3>
<pre><code class="language-python">def tail_recursion(n, accumulator=0):
    if n == 0:
        return accumulator
    return tail_recursion(n - 1, accumulator + n)
</code></pre>
<h2 id="recursion-vs-iteration"><a class="header" href="#recursion-vs-iteration">Recursion vs Iteration</a></h2>
<pre><code class="language-python"># Recursive factorial
def factorial_recursive(n):
    if n &lt;= 1:
        return 1
    return n * factorial_recursive(n - 1)

# Iterative factorial
def factorial_iterative(n):
    result = 1
    for i in range(1, n + 1):
        result *= i
    return result
</code></pre>
<h2 id="tips-for-recursion"><a class="header" href="#tips-for-recursion">Tips for Recursion</a></h2>
<ol>
<li><strong>Always define a base case</strong>: Prevents infinite recursion</li>
<li><strong>Make progress toward base case</strong>: Each recursive call should move closer to the base case</li>
<li><strong>Trust the recursion</strong>: Assume the recursive call works correctly for smaller inputs</li>
<li><strong>Consider stack depth</strong>: Deep recursion can cause stack overflow</li>
<li><strong>Use memoization</strong>: Cache results to avoid redundant calculations</li>
<li><strong>Know when to use iteration</strong>: Sometimes iteration is clearer and more efficient</li>
</ol>
<h2 id="common-pitfalls-1"><a class="header" href="#common-pitfalls-1">Common Pitfalls</a></h2>
<pre><code class="language-python"># BAD: No base case (infinite recursion)
def bad_recursion(n):
    return 1 + bad_recursion(n - 1)  # Never stops!

# BAD: Doesn't make progress
def bad_recursion2(n):
    if n == 0:
        return 0
    return bad_recursion2(n)  # n never changes!

# GOOD: Proper base case and progress
def good_recursion(n):
    if n == 0:
        return 0
    return 1 + good_recursion(n - 1)  # n decreases
</code></pre>
<h2 id="applications-5"><a class="header" href="#applications-5">Applications</a></h2>
<p>Recursion is widely used in various applications, including:</p>
<ul>
<li><strong>Tree Traversals</strong>: Navigating through tree data structures using recursive methods</li>
<li><strong>Backtracking Algorithms</strong>: Solving problems incrementally by trying partial solutions</li>
<li><strong>Dynamic Programming</strong>: Many DP problems can be solved using recursive approaches with memoization</li>
<li><strong>Divide and Conquer</strong>: Breaking problems into smaller subproblems</li>
<li><strong>Mathematical Computations</strong>: Factorials, Fibonacci, GCD, etc.</li>
</ul>
<h2 id="conclusion-9"><a class="header" href="#conclusion-9">Conclusion</a></h2>
<p>Recursion is a powerful tool in programming that allows for elegant solutions to complex problems. Understanding how to effectively use recursion is essential for developing efficient algorithms in computer science and software engineering.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="dynamic-programming"><a class="header" href="#dynamic-programming">Dynamic Programming</a></h1>
<h2 id="overview-29"><a class="header" href="#overview-29">Overview</a></h2>
<p>Dynamic Programming (DP) solves complex problems by breaking them into simpler subproblems, solving each once, and storing results to avoid recomputation. Essential for optimization problems.</p>
<h2 id="key-concepts-12"><a class="header" href="#key-concepts-12">Key Concepts</a></h2>
<p><strong>Optimal Substructure</strong>: Optimal solution built from optimal solutions of subproblems</p>
<p><strong>Overlapping Subproblems</strong>: Same subproblem computed multiple times</p>
<h2 id="approaches"><a class="header" href="#approaches">Approaches</a></h2>
<h3 id="memoization-top-down"><a class="header" href="#memoization-top-down">Memoization (Top-Down)</a></h3>
<pre><code class="language-python">def fib(n, memo={}):
    if n in memo:
        return memo[n]
    if n &lt;= 1:
        return n
    memo[n] = fib(n-1, memo) + fib(n-2, memo)
    return memo[n]
</code></pre>
<h3 id="tabulation-bottom-up"><a class="header" href="#tabulation-bottom-up">Tabulation (Bottom-Up)</a></h3>
<pre><code class="language-python">def fib(n):
    dp = [0] * (n + 1)
    dp[1] = 1
    for i in range(2, n + 1):
        dp[i] = dp[i-1] + dp[i-2]
    return dp[n]
</code></pre>
<h2 id="classic-problems"><a class="header" href="#classic-problems">Classic Problems</a></h2>
<h3 id="coin-change"><a class="header" href="#coin-change">Coin Change</a></h3>
<pre><code class="language-python">def coin_change(coins, amount):
    dp = [float('inf')] * (amount + 1)
    dp[0] = 0
    for coin in coins:
        for i in range(coin, amount + 1):
            dp[i] = min(dp[i], dp[i - coin] + 1)
    return dp[amount] if dp[amount] != float('inf') else -1
</code></pre>
<h3 id="knapsack"><a class="header" href="#knapsack">Knapsack</a></h3>
<pre><code class="language-python">def knapsack(weights, values, capacity):
    dp = [[0] * (capacity + 1) for _ in range(len(weights) + 1)]
    for i in range(1, len(weights) + 1):
        for w in range(capacity + 1):
            if weights[i-1] &lt;= w:
                dp[i][w] = max(
                    values[i-1] + dp[i-1][w - weights[i-1]],
                    dp[i-1][w]
                )
            else:
                dp[i][w] = dp[i-1][w]
    return dp[len(weights)][capacity]
</code></pre>
<h3 id="longest-common-subsequence"><a class="header" href="#longest-common-subsequence">Longest Common Subsequence</a></h3>
<pre><code class="language-python">def lcs(text1, text2):
    m, n = len(text1), len(text2)
    dp = [[0] * (n + 1) for _ in range(m + 1)]
    for i in range(1, m + 1):
        for j in range(1, n + 1):
            if text1[i-1] == text2[j-1]:
                dp[i][j] = dp[i-1][j-1] + 1
            else:
                dp[i][j] = max(dp[i-1][j], dp[i][j-1])
    return dp[m][n]
</code></pre>
<h3 id="edit-distance"><a class="header" href="#edit-distance">Edit Distance</a></h3>
<pre><code class="language-python">def editDistance(word1, word2):
    m, n = len(word1), len(word2)
    dp = [[0] * (n + 1) for _ in range(m + 1)]

    for i in range(m + 1):
        dp[i][0] = i
    for j in range(n + 1):
        dp[0][j] = j

    for i in range(1, m + 1):
        for j in range(1, n + 1):
            if word1[i-1] == word2[j-1]:
                dp[i][j] = dp[i-1][j-1]
            else:
                dp[i][j] = 1 + min(dp[i-1][j], dp[i][j-1], dp[i-1][j-1])

    return dp[m][n]
</code></pre>
<h2 id="patterns"><a class="header" href="#patterns">Patterns</a></h2>
<p>1D DP: <code>dp[i] = f(dp[i-1], dp[i-2], ...)</code>
2D DP: <code>dp[i][j] = f(dp[i-1][j], dp[i][j-1], ...)</code></p>
<h2 id="complexity"><a class="header" href="#complexity">Complexity</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Problem</th><th>Naive</th><th>DP</th></tr></thead><tbody>
<tr><td>Fibonacci</td><td>$O(2^n)$</td><td>$O(n)$</td></tr>
<tr><td>Coin Change</td><td>$O(n^m)$</td><td>$O(n \times m)$</td></tr>
<tr><td>Knapsack</td><td>$O(2^n)$</td><td>$O(n \times w)$</td></tr>
</tbody></table>
</div>
<h2 id="eli10-4"><a class="header" href="#eli10-4">ELI10</a></h2>
<p>DP is like climbing stairs - memorize steps you've already calculated instead of redoing them!</p>
<h2 id="further-resources-4"><a class="header" href="#further-resources-4">Further Resources</a></h2>
<ul>
<li>
<p><a href="https://leetcode.com/tag/dynamic-programming/">LeetCode DP Problems</a></p>
</li>
<li>
<p>[Key Concepts</p>
</li>
<li>
<p><strong>Overlapping Subproblems</strong>: Dynamic programming is applicable when the problem can be broken down into smaller, overlapping subproblems that can be solved independently. The results of these subproblems are stored to avoid redundant calculations.</p>
</li>
<li>
<p><strong>Optimal Substructure</strong>: A problem exhibits optimal substructure if an optimal solution to the problem can be constructed from optimal solutions to its subproblems. This property allows dynamic programming to build up solutions incrementally.</p>
</li>
</ul>
<h2 id="techniques"><a class="header" href="#techniques">Techniques</a></h2>
<ol>
<li>
<p><strong>Top-Down Approach (Memoization)</strong>: This approach involves solving the problem recursively and storing the results of subproblems in a table (or cache) to avoid redundant calculations. When a subproblem is encountered again, the stored result is used instead of recalculating it.</p>
</li>
<li>
<p><strong>Bottom-Up Approach (Tabulation)</strong>: In this approach, the problem is solved iteratively by filling up a table based on previously computed values. This method typically starts with the smallest subproblems and builds up to the solution of the original problem.</p>
</li>
</ol>
<h2 id="applications-6"><a class="header" href="#applications-6">Applications</a></h2>
<p>Dynamic programming is widely used in various applications, including:</p>
<ul>
<li>
<p><strong>Fibonacci Sequence</strong>: Calculating Fibonacci numbers can be optimized using dynamic programming to avoid exponential time complexity.</p>
</li>
<li>
<p><strong>Knapsack Problem</strong>: The 0/1 knapsack problem can be efficiently solved using dynamic programming techniques to maximize the total value of items that can be carried.</p>
</li>
<li>
<p><strong>Longest Common Subsequence</strong>: Finding the longest common subsequence between two strings can be accomplished using dynamic programming to build a solution based on previously computed subsequences.</p>
</li>
</ul>
<h2 id="conclusion-10"><a class="header" href="#conclusion-10">Conclusion</a></h2>
<p>Dynamic programming is a crucial technique in algorithm design that enables efficient solutions to problems with overlapping subproblems and optimal substructure. By leveraging memoization or tabulation, developers can significantly improve the performance of their algorithms, making dynamic programming an essential tool in computer science and software engineering.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="backtracking"><a class="header" href="#backtracking">Backtracking</a></h1>
<p>Backtracking is a general algorithmic technique that incrementally builds candidates for solutions and abandons a candidate as soon as it is determined that it cannot lead to a valid solution. It is often used for solving constraint satisfaction problems, such as puzzles, combinatorial problems, and optimization problems.</p>
<h2 id="key-concepts-13"><a class="header" href="#key-concepts-13">Key Concepts</a></h2>
<ul>
<li>
<p><strong>Recursive Approach</strong>: Backtracking is typically implemented using recursion. The algorithm explores each possible option and recursively attempts to build a solution. If a solution is found, it is returned; if not, the algorithm backtracks to try the next option.</p>
</li>
<li>
<p><strong>State Space Tree</strong>: The process of backtracking can be visualized as a tree where each node represents a state of the solution. The root node represents the initial state, and each branch represents a choice made. The leaves of the tree represent complete solutions or dead ends.</p>
</li>
<li>
<p><strong>Pruning</strong>: One of the key advantages of backtracking is its ability to prune the search space. If a partial solution cannot lead to a valid complete solution, the algorithm can abandon that path early, thus saving time and resources.</p>
</li>
</ul>
<h2 id="n-queens-problem"><a class="header" href="#n-queens-problem">N-Queens Problem</a></h2>
<p>Place N queens on an N×N chessboard such that no two queens threaten each other.</p>
<pre><code class="language-python">def solve_n_queens(n):
    def is_valid(board, row, col):
        # Check column
        for i in range(row):
            if board[i][col] == 'Q':
                return False

        # Check diagonal (top-left)
        i, j = row - 1, col - 1
        while i &gt;= 0 and j &gt;= 0:
            if board[i][j] == 'Q':
                return False
            i -= 1
            j -= 1

        # Check diagonal (top-right)
        i, j = row - 1, col + 1
        while i &gt;= 0 and j &lt; n:
            if board[i][j] == 'Q':
                return False
            i -= 1
            j += 1

        return True

    def backtrack(board, row):
        if row == n:
            result.append([''.join(row) for row in board])
            return

        for col in range(n):
            if is_valid(board, row, col):
                board[row][col] = 'Q'
                backtrack(board, row + 1)
                board[row][col] = '.'  # Backtrack

    result = []
    board = [['.' for _ in range(n)] for _ in range(n)]
    backtrack(board, 0)
    return result

# Example usage
solutions = solve_n_queens(4)
print(f"Found {len(solutions)} solutions for 4-Queens")
for solution in solutions:
    for row in solution:
        print(row)
    print()
</code></pre>
<h2 id="sudoku-solver"><a class="header" href="#sudoku-solver">Sudoku Solver</a></h2>
<p>Solve a 9×9 Sudoku puzzle.</p>
<pre><code class="language-python">def solve_sudoku(board):
    def is_valid(board, row, col, num):
        # Check row
        if num in board[row]:
            return False

        # Check column
        if num in [board[i][col] for i in range(9)]:
            return False

        # Check 3x3 box
        box_row, box_col = 3 * (row // 3), 3 * (col // 3)
        for i in range(box_row, box_row + 3):
            for j in range(box_col, box_col + 3):
                if board[i][j] == num:
                    return False

        return True

    def backtrack():
        for row in range(9):
            for col in range(9):
                if board[row][col] == '.':
                    for num in '123456789':
                        if is_valid(board, row, col, num):
                            board[row][col] = num
                            if backtrack():
                                return True
                            board[row][col] = '.'  # Backtrack
                    return False
        return True

    backtrack()
    return board

# Example usage
board = [
    ["5","3",".",".","7",".",".",".","."],
    ["6",".",".","1","9","5",".",".","."],
    [".","9","8",".",".",".",".","6","."],
    ["8",".",".",".","6",".",".",".","3"],
    ["4",".",".","8",".","3",".",".","1"],
    ["7",".",".",".","2",".",".",".","6"],
    [".","6",".",".",".",".","2","8","."],
    [".",".",".","4","1","9",".",".","5"],
    [".",".",".",".","8",".",".","7","9"]
]
solve_sudoku(board)
</code></pre>
<h2 id="generate-subsets"><a class="header" href="#generate-subsets">Generate Subsets</a></h2>
<p>Generate all subsets (power set) of a given set.</p>
<pre><code class="language-python">def subsets(nums):
    result = []

    def backtrack(start, path):
        # Add current subset to result
        result.append(path[:])

        # Try adding each remaining element
        for i in range(start, len(nums)):
            path.append(nums[i])
            backtrack(i + 1, path)
            path.pop()  # Backtrack

    backtrack(0, [])
    return result

# Example usage
nums = [1, 2, 3]
print(subsets(nums))
# Output: [[], [1], [1, 2], [1, 2, 3], [1, 3], [2], [2, 3], [3]]
</code></pre>
<h2 id="generate-permutations"><a class="header" href="#generate-permutations">Generate Permutations</a></h2>
<p>Generate all permutations of a given list.</p>
<pre><code class="language-python">def permute(nums):
    result = []

    def backtrack(path, remaining):
        if not remaining:
            result.append(path[:])
            return

        for i in range(len(remaining)):
            # Choose
            path.append(remaining[i])
            # Explore
            backtrack(path, remaining[:i] + remaining[i+1:])
            # Unchoose (backtrack)
            path.pop()

    backtrack([], nums)
    return result

# Alternative implementation using swap
def permute_swap(nums):
    result = []

    def backtrack(first):
        if first == len(nums):
            result.append(nums[:])
            return

        for i in range(first, len(nums)):
            nums[first], nums[i] = nums[i], nums[first]
            backtrack(first + 1)
            nums[first], nums[i] = nums[i], nums[first]  # Backtrack

    backtrack(0)
    return result

# Example usage
nums = [1, 2, 3]
print(permute(nums))
# Output: [[1,2,3],[1,3,2],[2,1,3],[2,3,1],[3,1,2],[3,2,1]]
</code></pre>
<h2 id="combination-sum"><a class="header" href="#combination-sum">Combination Sum</a></h2>
<p>Find all combinations that sum to a target value.</p>
<pre><code class="language-python">def combination_sum(candidates, target):
    result = []

    def backtrack(start, path, current_sum):
        if current_sum == target:
            result.append(path[:])
            return

        if current_sum &gt; target:
            return  # Prune this branch

        for i in range(start, len(candidates)):
            path.append(candidates[i])
            # Can reuse same element, so pass i (not i+1)
            backtrack(i, path, current_sum + candidates[i])
            path.pop()  # Backtrack

    backtrack(0, [], 0)
    return result

# Example usage
candidates = [2, 3, 6, 7]
target = 7
print(combination_sum(candidates, target))
# Output: [[2,2,3], [7]]
</code></pre>
<h2 id="word-search"><a class="header" href="#word-search">Word Search</a></h2>
<p>Find if a word exists in a 2D board.</p>
<pre><code class="language-python">def word_search(board, word):
    rows, cols = len(board), len(board[0])

    def backtrack(row, col, index):
        # Found the word
        if index == len(word):
            return True

        # Out of bounds or wrong character
        if (row &lt; 0 or row &gt;= rows or
            col &lt; 0 or col &gt;= cols or
            board[row][col] != word[index]):
            return False

        # Mark as visited
        temp = board[row][col]
        board[row][col] = '#'

        # Explore all directions
        found = (backtrack(row + 1, col, index + 1) or
                backtrack(row - 1, col, index + 1) or
                backtrack(row, col + 1, index + 1) or
                backtrack(row, col - 1, index + 1))

        # Backtrack
        board[row][col] = temp

        return found

    # Try starting from each cell
    for row in range(rows):
        for col in range(cols):
            if backtrack(row, col, 0):
                return True
    return False

# Example usage
board = [
    ['A','B','C','E'],
    ['S','F','C','S'],
    ['A','D','E','E']
]
print(word_search(board, "ABCCED"))  # True
print(word_search(board, "SEE"))     # True
print(word_search(board, "ABCB"))    # False
</code></pre>
<h2 id="palindrome-partitioning"><a class="header" href="#palindrome-partitioning">Palindrome Partitioning</a></h2>
<p>Partition a string into all possible palindrome substrings.</p>
<pre><code class="language-python">def partition(s):
    def is_palindrome(s, left, right):
        while left &lt; right:
            if s[left] != s[right]:
                return False
            left += 1
            right -= 1
        return True

    result = []

    def backtrack(start, path):
        if start == len(s):
            result.append(path[:])
            return

        for end in range(start, len(s)):
            if is_palindrome(s, start, end):
                path.append(s[start:end+1])
                backtrack(end + 1, path)
                path.pop()  # Backtrack

    backtrack(0, [])
    return result

# Example usage
s = "aab"
print(partition(s))
# Output: [["a","a","b"], ["aa","b"]]
</code></pre>
<h2 id="backtracking-template"><a class="header" href="#backtracking-template">Backtracking Template</a></h2>
<p>General template for backtracking problems:</p>
<pre><code class="language-python">def backtrack_template(input_data):
    result = []

    def backtrack(state, ...):
        # Base case: valid solution found
        if is_valid_solution(state):
            result.append(construct_solution(state))
            return

        # Try all possible choices
        for choice in get_choices(state):
            # Make choice
            make_choice(state, choice)

            # Recurse with updated state
            backtrack(state, ...)

            # Undo choice (backtrack)
            undo_choice(state, choice)

    # Initialize and start backtracking
    initial_state = initialize()
    backtrack(initial_state)
    return result
</code></pre>
<h2 id="time-complexity-2"><a class="header" href="#time-complexity-2">Time Complexity</a></h2>
<p>Most backtracking algorithms have exponential time complexity:</p>
<ul>
<li><strong>Subsets</strong>: $O(2^n)$ - each element can be included or excluded</li>
<li><strong>Permutations</strong>: $O(n!)$ - n choices for first, n-1 for second, etc.</li>
<li><strong>N-Queens</strong>: $O(n!)$ - approximately, with pruning</li>
<li><strong>Sudoku</strong>: $O(9^m)$ where m is number of empty cells</li>
</ul>
<h2 id="applications-7"><a class="header" href="#applications-7">Applications</a></h2>
<p>Backtracking is widely used in various applications, including:</p>
<ul>
<li>
<p><strong>Puzzle Solving</strong>: Problems like Sudoku, N-Queens, and mazes can be efficiently solved using backtracking techniques.</p>
</li>
<li>
<p><strong>Combinatorial Problems</strong>: Generating permutations, combinations, and subsets of a set can be accomplished through backtracking.</p>
</li>
<li>
<p><strong>Graph Problems</strong>: Backtracking can be applied to find Hamiltonian paths, Eulerian paths, and other graph-related problems.</p>
</li>
<li>
<p><strong>Constraint Satisfaction</strong>: Solving problems with constraints like graph coloring, map coloring, and scheduling.</p>
</li>
</ul>
<h2 id="tips-for-backtracking"><a class="header" href="#tips-for-backtracking">Tips for Backtracking</a></h2>
<ol>
<li><strong>Identify the decision space</strong>: What choices can be made at each step?</li>
<li><strong>Define constraints</strong>: What makes a solution valid or invalid?</li>
<li><strong>Implement pruning</strong>: Abandon paths early when constraints are violated</li>
<li><strong>Use proper state management</strong>: Ensure state is correctly restored when backtracking</li>
<li><strong>Optimize with memoization</strong>: Cache results of repeated subproblems when possible</li>
</ol>
<h2 id="conclusion-11"><a class="header" href="#conclusion-11">Conclusion</a></h2>
<p>Backtracking is a powerful algorithmic technique that provides a systematic way to explore all possible solutions to a problem. By leveraging recursion and pruning, it can efficiently solve complex problems that would otherwise require exhaustive search methods.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="divide-and-conquer"><a class="header" href="#divide-and-conquer">Divide and Conquer</a></h1>
<p>Divide and conquer is a fundamental algorithmic technique that involves breaking a problem down into smaller subproblems, solving each subproblem independently, and then combining their solutions to solve the original problem. This approach is particularly effective for problems that can be recursively divided into similar subproblems.</p>
<h2 id="key-concepts-14"><a class="header" href="#key-concepts-14">Key Concepts</a></h2>
<ul>
<li>
<p><strong>Divide</strong>: The problem is divided into smaller subproblems that are similar to the original problem but smaller in size. This step often involves identifying a base case for the recursion.</p>
</li>
<li>
<p><strong>Conquer</strong>: Each subproblem is solved independently, often using the same divide and conquer strategy recursively. If the subproblems are small enough, they may be solved directly.</p>
</li>
<li>
<p><strong>Combine</strong>: The solutions to the subproblems are combined to form a solution to the original problem. This step is crucial as it integrates the results of the smaller problems into a coherent solution.</p>
</li>
</ul>
<h2 id="merge-sort"><a class="header" href="#merge-sort">Merge Sort</a></h2>
<p>Efficient sorting algorithm using divide and conquer.</p>
<pre><code class="language-python">def merge_sort(arr):
    # Base case: array with 0 or 1 element
    if len(arr) &lt;= 1:
        return arr
    
    # Divide: split array in half
    mid = len(arr) // 2
    left = merge_sort(arr[:mid])
    right = merge_sort(arr[mid:])
    
    # Conquer and Combine: merge sorted halves
    return merge(left, right)

def merge(left, right):
    result = []
    i = j = 0
    
    # Merge while both arrays have elements
    while i &lt; len(left) and j &lt; len(right):
        if left[i] &lt;= right[j]:
            result.append(left[i])
            i += 1
        else:
            result.append(right[j])
            j += 1
    
    # Add remaining elements
    result.extend(left[i:])
    result.extend(right[j:])
    return result

# Example usage
arr = [38, 27, 43, 3, 9, 82, 10]
sorted_arr = merge_sort(arr)
print(sorted_arr)  # Output: [3, 9, 10, 27, 38, 43, 82]
</code></pre>
<p><strong>Time Complexity</strong>: $O(n \log n)$
<strong>Space Complexity</strong>: $O(n)$</p>
<h2 id="quick-sort"><a class="header" href="#quick-sort">Quick Sort</a></h2>
<p>Efficient in-place sorting algorithm.</p>
<pre><code class="language-python">def quick_sort(arr):
    if len(arr) &lt;= 1:
        return arr
    
    # Choose pivot (middle element)
    pivot = arr[len(arr) // 2]
    
    # Divide: partition around pivot
    left = [x for x in arr if x &lt; pivot]
    middle = [x for x in arr if x == pivot]
    right = [x for x in arr if x &gt; pivot]
    
    # Conquer and Combine
    return quick_sort(left) + middle + quick_sort(right)

# In-place version
def quick_sort_inplace(arr, low, high):
    if low &lt; high:
        # Partition and get pivot index
        pi = partition(arr, low, high)
        
        # Recursively sort elements before and after partition
        quick_sort_inplace(arr, low, pi - 1)
        quick_sort_inplace(arr, pi + 1, high)

def partition(arr, low, high):
    pivot = arr[high]
    i = low - 1
    
    for j in range(low, high):
        if arr[j] &lt;= pivot:
            i += 1
            arr[i], arr[j] = arr[j], arr[i]
    
    arr[i + 1], arr[high] = arr[high], arr[i + 1]
    return i + 1

# Example usage
arr = [10, 7, 8, 9, 1, 5]
quick_sort_inplace(arr, 0, len(arr) - 1)
print(arr)  # Output: [1, 5, 7, 8, 9, 10]
</code></pre>
<p><strong>Time Complexity</strong>: $O(n \log n)$ average, $O(n^2)$ worst
<strong>Space Complexity</strong>: $O(\log n)$ for recursion stack</p>
<h2 id="binary-search-1"><a class="header" href="#binary-search-1">Binary Search</a></h2>
<p>Classic divide and conquer search algorithm.</p>
<pre><code class="language-python">def binary_search(arr, target):
    left, right = 0, len(arr) - 1
    
    while left &lt;= right:
        mid = left + (right - left) // 2
        
        if arr[mid] == target:
            return mid
        elif arr[mid] &lt; target:
            left = mid + 1  # Search right half
        else:
            right = mid - 1  # Search left half
    
    return -1  # Not found

# Recursive version
def binary_search_recursive(arr, target, left, right):
    if left &gt; right:
        return -1
    
    mid = left + (right - left) // 2
    
    if arr[mid] == target:
        return mid
    elif arr[mid] &lt; target:
        return binary_search_recursive(arr, target, mid + 1, right)
    else:
        return binary_search_recursive(arr, target, left, mid - 1)

# Example usage
arr = [1, 3, 5, 7, 9, 11, 13, 15, 17]
print(binary_search(arr, 7))  # Output: 3
print(binary_search_recursive(arr, 13, 0, len(arr) - 1))  # Output: 6
</code></pre>
<p><strong>Time Complexity</strong>: $O(\log n)$
<strong>Space Complexity</strong>: $O(1)$ iterative, $O(\log n)$ recursive</p>
<h2 id="maximum-subarray-kadanes-algorithm"><a class="header" href="#maximum-subarray-kadanes-algorithm">Maximum Subarray (Kadane's Algorithm)</a></h2>
<p>Find the contiguous subarray with the largest sum.</p>
<pre><code class="language-python">def max_subarray_divide_conquer(arr, left, right):
    # Base case: single element
    if left == right:
        return arr[left]
    
    # Divide: find middle
    mid = (left + right) // 2
    
    # Conquer: recursively find max in left and right halves
    left_max = max_subarray_divide_conquer(arr, left, mid)
    right_max = max_subarray_divide_conquer(arr, mid + 1, right)
    
    # Combine: find max crossing the middle
    cross_max = max_crossing_sum(arr, left, mid, right)
    
    return max(left_max, right_max, cross_max)

def max_crossing_sum(arr, left, mid, right):
    # Sum from mid to left
    left_sum = float('-inf')
    current_sum = 0
    for i in range(mid, left - 1, -1):
        current_sum += arr[i]
        left_sum = max(left_sum, current_sum)
    
    # Sum from mid+1 to right
    right_sum = float('-inf')
    current_sum = 0
    for i in range(mid + 1, right + 1):
        current_sum += arr[i]
        right_sum = max(right_sum, current_sum)
    
    return left_sum + right_sum

# Example usage
arr = [-2, 1, -3, 4, -1, 2, 1, -5, 4]
max_sum = max_subarray_divide_conquer(arr, 0, len(arr) - 1)
print(f"Maximum subarray sum: {max_sum}")  # Output: 6 ([4,-1,2,1])
</code></pre>
<p><strong>Time Complexity</strong>: $O(n \log n)$</p>
<h2 id="count-inversions"><a class="header" href="#count-inversions">Count Inversions</a></h2>
<p>Count how many pairs are out of order in an array.</p>
<pre><code class="language-python">def merge_count_inversions(arr):
    if len(arr) &lt;= 1:
        return arr, 0
    
    mid = len(arr) // 2
    left, left_inv = merge_count_inversions(arr[:mid])
    right, right_inv = merge_count_inversions(arr[mid:])
    
    merged, split_inv = merge_and_count(left, right)
    
    return merged, left_inv + right_inv + split_inv

def merge_and_count(left, right):
    result = []
    inversions = 0
    i = j = 0
    
    while i &lt; len(left) and j &lt; len(right):
        if left[i] &lt;= right[j]:
            result.append(left[i])
            i += 1
        else:
            result.append(right[j])
            inversions += len(left) - i  # All remaining in left are inversions
            j += 1
    
    result.extend(left[i:])
    result.extend(right[j:])
    return result, inversions

# Example usage
arr = [2, 4, 1, 3, 5]
sorted_arr, inversions = merge_count_inversions(arr)
print(f"Inversions: {inversions}")  # Output: 3
</code></pre>
<h2 id="closest-pair-of-points"><a class="header" href="#closest-pair-of-points">Closest Pair of Points</a></h2>
<p>Find the two closest points in a 2D plane.</p>
<pre><code class="language-python">import math

def closest_pair(points):
    # Sort points by x-coordinate
    px = sorted(points, key=lambda p: p[0])
    # Sort points by y-coordinate
    py = sorted(points, key=lambda p: p[1])
    
    return closest_pair_recursive(px, py)

def closest_pair_recursive(px, py):
    n = len(px)
    
    # Base case: few points, use brute force
    if n &lt;= 3:
        return brute_force_closest(px)
    
    # Divide: split by vertical line
    mid = n // 2
    midpoint = px[mid]
    
    pyl = [p for p in py if p[0] &lt;= midpoint[0]]
    pyr = [p for p in py if p[0] &gt; midpoint[0]]
    
    # Conquer: find closest in each half
    dl = closest_pair_recursive(px[:mid], pyl)
    dr = closest_pair_recursive(px[mid:], pyr)
    
    # Find minimum
    d = min(dl, dr)
    
    # Combine: check points near dividing line
    strip = [p for p in py if abs(p[0] - midpoint[0]) &lt; d]
    strip_min = strip_closest(strip, d)
    
    return min(d, strip_min)

def distance(p1, p2):
    return math.sqrt((p1[0] - p2[0])**2 + (p1[1] - p2[1])**2)

def brute_force_closest(points):
    min_dist = float('inf')
    for i in range(len(points)):
        for j in range(i + 1, len(points)):
            min_dist = min(min_dist, distance(points[i], points[j]))
    return min_dist

def strip_closest(strip, d):
    min_dist = d
    for i in range(len(strip)):
        for j in range(i + 1, min(i + 7, len(strip))):
            min_dist = min(min_dist, distance(strip[i], strip[j]))
    return min_dist

# Example usage
points = [(2, 3), (12, 30), (40, 50), (5, 1), (12, 10), (3, 4)]
min_distance = closest_pair(points)
print(f"Smallest distance: {min_distance:.2f}")
</code></pre>
<h2 id="matrix-multiplication-strassens-algorithm"><a class="header" href="#matrix-multiplication-strassens-algorithm">Matrix Multiplication (Strassen's Algorithm)</a></h2>
<p>Faster matrix multiplication algorithm.</p>
<pre><code class="language-python">import numpy as np

def strassen_matrix_multiply(A, B):
    n = len(A)
    
    # Base case: 1x1 matrix
    if n == 1:
        return [[A[0][0] * B[0][0]]]
    
    # Divide matrices into quadrants
    mid = n // 2
    A11 = [row[:mid] for row in A[:mid]]
    A12 = [row[mid:] for row in A[:mid]]
    A21 = [row[:mid] for row in A[mid:]]
    A22 = [row[mid:] for row in A[mid:]]
    
    B11 = [row[:mid] for row in B[:mid]]
    B12 = [row[mid:] for row in B[:mid]]
    B21 = [row[:mid] for row in B[mid:]]
    B22 = [row[mid:] for row in B[mid:]]
    
    # Compute 7 products (Strassen's method)
    M1 = strassen_matrix_multiply(matrix_add(A11, A22), matrix_add(B11, B22))
    M2 = strassen_matrix_multiply(matrix_add(A21, A22), B11)
    M3 = strassen_matrix_multiply(A11, matrix_sub(B12, B22))
    M4 = strassen_matrix_multiply(A22, matrix_sub(B21, B11))
    M5 = strassen_matrix_multiply(matrix_add(A11, A12), B22)
    M6 = strassen_matrix_multiply(matrix_sub(A21, A11), matrix_add(B11, B12))
    M7 = strassen_matrix_multiply(matrix_sub(A12, A22), matrix_add(B21, B22))
    
    # Combine
    C11 = matrix_add(matrix_sub(matrix_add(M1, M4), M5), M7)
    C12 = matrix_add(M3, M5)
    C21 = matrix_add(M2, M4)
    C22 = matrix_add(matrix_sub(matrix_add(M1, M3), M2), M6)
    
    # Construct result
    result = []
    for i in range(mid):
        result.append(C11[i] + C12[i])
    for i in range(mid):
        result.append(C21[i] + C22[i])
    
    return result

def matrix_add(A, B):
    return [[A[i][j] + B[i][j] for j in range(len(A[0]))] for i in range(len(A))]

def matrix_sub(A, B):
    return [[A[i][j] - B[i][j] for j in range(len(A[0]))] for i in range(len(A))]
</code></pre>
<p><strong>Time Complexity</strong>: $O(n^{2.807})$ vs $O(n^3)$ for standard multiplication</p>
<h2 id="divide-and-conquer-template"><a class="header" href="#divide-and-conquer-template">Divide and Conquer Template</a></h2>
<pre><code class="language-python">def divide_and_conquer(problem):
    # Base case
    if is_simple(problem):
        return solve_directly(problem)
    
    # Divide
    subproblems = divide(problem)
    
    # Conquer
    subsolutions = [divide_and_conquer(subproblem) for subproblem in subproblems]
    
    # Combine
    solution = combine(subsolutions)
    
    return solution
</code></pre>
<h2 id="applications-8"><a class="header" href="#applications-8">Applications</a></h2>
<p>Divide and conquer is widely used in various algorithms and applications, including:</p>
<ul>
<li>
<p><strong>Sorting Algorithms</strong>: Algorithms like Merge Sort and Quick Sort utilize the divide and conquer approach to sort elements efficiently.</p>
</li>
<li>
<p><strong>Searching Algorithms</strong>: Binary Search is a classic example of a divide and conquer algorithm that efficiently finds an element in a sorted array.</p>
</li>
<li>
<p><strong>Matrix Multiplication</strong>: Strassen's algorithm for matrix multiplication is another example where the divide and conquer technique is applied to reduce the complexity of the operation.</p>
</li>
<li>
<p><strong>Computational Geometry</strong>: Problems like finding the closest pair of points or convex hull.</p>
</li>
<li>
<p><strong>Fast Fourier Transform</strong>: FFT uses divide and conquer for efficient signal processing.</p>
</li>
</ul>
<h2 id="advantages"><a class="header" href="#advantages">Advantages</a></h2>
<ol>
<li><strong>Efficiency</strong>: Often achieves better time complexity than brute force</li>
<li><strong>Parallelization</strong>: Subproblems can be solved independently</li>
<li><strong>Cache-friendly</strong>: Works well with memory hierarchy</li>
<li><strong>Elegant solutions</strong>: Natural recursive structure</li>
</ol>
<h2 id="disadvantages"><a class="header" href="#disadvantages">Disadvantages</a></h2>
<ol>
<li><strong>Overhead</strong>: Recursive calls add overhead</li>
<li><strong>Space complexity</strong>: Requires stack space for recursion</li>
<li><strong>Not always optimal</strong>: Some problems have better iterative solutions</li>
</ol>
<h2 id="conclusion-12"><a class="header" href="#conclusion-12">Conclusion</a></h2>
<p>The divide and conquer strategy is a powerful tool in algorithm design, enabling efficient solutions to complex problems by breaking them down into manageable parts. Understanding this technique is essential for developing efficient algorithms in computer science and software engineering.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="greedy-algorithms"><a class="header" href="#greedy-algorithms">Greedy Algorithms</a></h1>
<p>Greedy algorithms are a class of algorithms that make locally optimal choices at each stage with the hope of finding a global optimum. They are often used for optimization problems where a solution can be built incrementally.</p>
<h2 id="key-concepts-15"><a class="header" href="#key-concepts-15">Key Concepts</a></h2>
<ul>
<li>
<p><strong>Greedy Choice Property</strong>: A global optimum can be reached by selecting a local optimum. This property is essential for the effectiveness of greedy algorithms.</p>
</li>
<li>
<p><strong>Optimal Substructure</strong>: A problem exhibits optimal substructure if an optimal solution to the problem contains optimal solutions to its subproblems.</p>
</li>
</ul>
<h2 id="activity-selection-problem"><a class="header" href="#activity-selection-problem">Activity Selection Problem</a></h2>
<p>Select the maximum number of activities that don't overlap in time.</p>
<pre><code class="language-python">def activity_selection(activities):
    # Sort by finish time
    activities.sort(key=lambda x: x[1])
    
    selected = [activities[0]]
    last_finish = activities[0][1]
    
    for start, finish in activities[1:]:
        if start &gt;= last_finish:
            selected.append((start, finish))
            last_finish = finish
    
    return selected

# Example usage
activities = [(1, 4), (3, 5), (0, 6), (5, 7), (3, 9), (5, 9), (6, 10), (8, 11), (8, 12), (2, 14), (12, 16)]
result = activity_selection(activities)
print(f"Selected {len(result)} activities:")
for activity in result:
    print(f"  Start: {activity[0]}, Finish: {activity[1]}")
</code></pre>
<p><strong>Time Complexity</strong>: $O(n \log n)$ for sorting
<strong>Space Complexity</strong>: $O(n)$</p>
<h2 id="fractional-knapsack"><a class="header" href="#fractional-knapsack">Fractional Knapsack</a></h2>
<p>Maximize value in knapsack by taking fractions of items.</p>
<pre><code class="language-python">def fractional_knapsack(items, capacity):
    # Calculate value per weight and sort by it
    items_with_ratio = [(value, weight, value/weight) for value, weight in items]
    items_with_ratio.sort(key=lambda x: x[2], reverse=True)
    
    total_value = 0
    remaining_capacity = capacity
    taken = []
    
    for value, weight, ratio in items_with_ratio:
        if remaining_capacity &gt;= weight:
            # Take full item
            total_value += value
            remaining_capacity -= weight
            taken.append((value, weight, 1.0))
        else:
            # Take fraction of item
            fraction = remaining_capacity / weight
            total_value += value * fraction
            taken.append((value, weight, fraction))
            break
    
    return total_value, taken

# Example usage
items = [(60, 10), (100, 20), (120, 30)]  # (value, weight)
capacity = 50
max_value, taken = fractional_knapsack(items, capacity)
print(f"Maximum value: {max_value}")
print("Items taken:")
for value, weight, fraction in taken:
    print(f"  Value={value}, Weight={weight}, Fraction={fraction:.2f}")
</code></pre>
<p><strong>Time Complexity</strong>: $O(n \log n)$</p>
<h2 id="coin-change-greedy---doesnt-always-work"><a class="header" href="#coin-change-greedy---doesnt-always-work">Coin Change (Greedy - doesn't always work!)</a></h2>
<p>Make change using minimum number of coins (works for standard coin systems).</p>
<pre><code class="language-python">def coin_change_greedy(coins, amount):
    coins.sort(reverse=True)
    count = 0
    result = []
    
    for coin in coins:
        while amount &gt;= coin:
            amount -= coin
            count += 1
            result.append(coin)
    
    if amount &gt; 0:
        return -1, []  # Cannot make exact change
    
    return count, result

# Example usage (US coins)
coins = [25, 10, 5, 1]
amount = 63
count, result = coin_change_greedy(coins, amount)
print(f"Minimum coins: {count}")
print(f"Coins used: {result}")  # [25, 25, 10, 1, 1, 1]
</code></pre>
<p><strong>Note</strong>: Greedy doesn't always give optimal solution for arbitrary coin systems.
For example, with coins [1, 3, 4] and amount 6, greedy gives [4, 1, 1] (3 coins)
but optimal is [3, 3] (2 coins).</p>
<h2 id="huffman-coding"><a class="header" href="#huffman-coding">Huffman Coding</a></h2>
<p>Optimal prefix-free encoding for data compression.</p>
<pre><code class="language-python">import heapq
from collections import defaultdict

class HuffmanNode:
    def __init__(self, char, freq):
        self.char = char
        self.freq = freq
        self.left = None
        self.right = None
    
    def __lt__(self, other):
        return self.freq &lt; other.freq

def huffman_encoding(text):
    # Count frequency
    freq = defaultdict(int)
    for char in text:
        freq[char] += 1
    
    # Create priority queue
    heap = [HuffmanNode(char, f) for char, f in freq.items()]
    heapq.heapify(heap)
    
    # Build Huffman tree
    while len(heap) &gt; 1:
        left = heapq.heappop(heap)
        right = heapq.heappop(heap)
        
        merged = HuffmanNode(None, left.freq + right.freq)
        merged.left = left
        merged.right = right
        
        heapq.heappush(heap, merged)
    
    # Generate codes
    root = heap[0]
    codes = {}
    
    def generate_codes(node, code):
        if node.char is not None:
            codes[node.char] = code
            return
        if node.left:
            generate_codes(node.left, code + '0')
        if node.right:
            generate_codes(node.right, code + '1')
    
    generate_codes(root, '')
    
    # Encode text
    encoded = ''.join(codes[char] for char in text)
    
    return encoded, codes, root

# Example usage
text = "huffman coding example"
encoded, codes, tree = huffman_encoding(text)
print("Character codes:")
for char, code in sorted(codes.items()):
    print(f"  '{char}': {code}")
print(f"\nOriginal size: {len(text) * 8} bits")
print(f"Encoded size: {len(encoded)} bits")
print(f"Compression ratio: {len(encoded) / (len(text) * 8):.2%}")
</code></pre>
<p><strong>Time Complexity</strong>: $O(n \log n)$</p>
<h2 id="job-sequencing"><a class="header" href="#job-sequencing">Job Sequencing</a></h2>
<p>Maximize profit by scheduling jobs with deadlines.</p>
<pre><code class="language-python">def job_sequencing(jobs):
    # Sort by profit (descending)
    jobs.sort(key=lambda x: x[2], reverse=True)
    
    # Find maximum deadline
    max_deadline = max(job[1] for job in jobs)
    
    # Create slot array
    slots = [-1] * max_deadline
    total_profit = 0
    scheduled_jobs = []
    
    # For each job, try to schedule it
    for job_id, deadline, profit in jobs:
        # Find a free slot before deadline
        for slot in range(min(max_deadline, deadline) - 1, -1, -1):
            if slots[slot] == -1:
                slots[slot] = job_id
                total_profit += profit
                scheduled_jobs.append((job_id, profit))
                break
    
    return total_profit, scheduled_jobs

# Example usage
# Jobs: (job_id, deadline, profit)
jobs = [
    ('a', 2, 100),
    ('b', 1, 19),
    ('c', 2, 27),
    ('d', 1, 25),
    ('e', 3, 15)
]
profit, scheduled = job_sequencing(jobs)
print(f"Maximum profit: {profit}")
print("Scheduled jobs:")
for job_id, profit in scheduled:
    print(f"  Job {job_id}: ${profit}")
</code></pre>
<p><strong>Time Complexity</strong>: $O(n^2)$</p>
<h2 id="minimum-spanning-tree---prims-algorithm"><a class="header" href="#minimum-spanning-tree---prims-algorithm">Minimum Spanning Tree - Prim's Algorithm</a></h2>
<p>Find minimum spanning tree of a weighted graph.</p>
<pre><code class="language-python">import heapq

def prim_mst(graph, start=0):
    n = len(graph)
    visited = set([start])
    edges = [(cost, start, to) for to, cost in graph[start]]
    heapq.heapify(edges)
    
    mst = []
    total_cost = 0
    
    while edges and len(visited) &lt; n:
        cost, frm, to = heapq.heappop(edges)
        
        if to not in visited:
            visited.add(to)
            mst.append((frm, to, cost))
            total_cost += cost
            
            for next_to, next_cost in graph[to]:
                if next_to not in visited:
                    heapq.heappush(edges, (next_cost, to, next_to))
    
    return mst, total_cost

# Example usage
# Graph as adjacency list: graph[node] = [(neighbor, weight), ...]
graph = [
    [(1, 2), (3, 6)],           # Node 0
    [(0, 2), (2, 3), (3, 8), (4, 5)],  # Node 1
    [(1, 3), (4, 7)],           # Node 2
    [(0, 6), (1, 8)],           # Node 3
    [(1, 5), (2, 7)]            # Node 4
]
mst, cost = prim_mst(graph)
print(f"Minimum spanning tree cost: {cost}")
print("Edges in MST:")
for frm, to, weight in mst:
    print(f"  {frm} -- {to} (weight: {weight})")
</code></pre>
<p><strong>Time Complexity</strong>: $O(E \log V)$ with binary heap</p>
<h2 id="minimum-spanning-tree---kruskals-algorithm"><a class="header" href="#minimum-spanning-tree---kruskals-algorithm">Minimum Spanning Tree - Kruskal's Algorithm</a></h2>
<p>Another MST algorithm using Union-Find.</p>
<pre><code class="language-python">class UnionFind:
    def __init__(self, n):
        self.parent = list(range(n))
        self.rank = [0] * n
    
    def find(self, x):
        if self.parent[x] != x:
            self.parent[x] = self.find(self.parent[x])
        return self.parent[x]
    
    def union(self, x, y):
        px, py = self.find(x), self.find(y)
        if px == py:
            return False
        if self.rank[px] &lt; self.rank[py]:
            px, py = py, px
        self.parent[py] = px
        if self.rank[px] == self.rank[py]:
            self.rank[px] += 1
        return True

def kruskal_mst(n, edges):
    # Sort edges by weight
    edges.sort(key=lambda x: x[2])
    
    uf = UnionFind(n)
    mst = []
    total_cost = 0
    
    for u, v, weight in edges:
        if uf.union(u, v):
            mst.append((u, v, weight))
            total_cost += weight
            if len(mst) == n - 1:
                break
    
    return mst, total_cost

# Example usage
n = 5  # Number of vertices
edges = [
    (0, 1, 2), (0, 3, 6), (1, 2, 3),
    (1, 3, 8), (1, 4, 5), (2, 4, 7)
]
mst, cost = kruskal_mst(n, edges)
print(f"Minimum spanning tree cost: {cost}")
print("Edges in MST:")
for u, v, weight in mst:
    print(f"  {u} -- {v} (weight: {weight})")
</code></pre>
<p><strong>Time Complexity</strong>: $O(E \log E)$ or $O(E \log V)$</p>
<h2 id="dijkstras-shortest-path"><a class="header" href="#dijkstras-shortest-path">Dijkstra's Shortest Path</a></h2>
<p>Find shortest path from source to all other vertices.</p>
<pre><code class="language-python">import heapq

def dijkstra(graph, start):
    n = len(graph)
    dist = [float('inf')] * n
    dist[start] = 0
    pq = [(0, start)]
    visited = set()
    
    while pq:
        d, u = heapq.heappop(pq)
        
        if u in visited:
            continue
        visited.add(u)
        
        for v, weight in graph[u]:
            if dist[u] + weight &lt; dist[v]:
                dist[v] = dist[u] + weight
                heapq.heappush(pq, (dist[v], v))
    
    return dist

# Example usage
graph = [
    [(1, 4), (2, 1)],               # Node 0
    [(3, 1)],                       # Node 1
    [(1, 2), (3, 5)],               # Node 2
    [(4, 3)],                       # Node 3
    []                              # Node 4
]
distances = dijkstra(graph, 0)
print("Shortest distances from node 0:")
for i, d in enumerate(distances):
    print(f"  To node {i}: {d}")
</code></pre>
<p><strong>Time Complexity</strong>: $O((V + E) \log V)$ with binary heap</p>
<h2 id="gas-station-problem"><a class="header" href="#gas-station-problem">Gas Station Problem</a></h2>
<p>Find starting station to complete circular route.</p>
<pre><code class="language-python">def can_complete_circuit(gas, cost):
    n = len(gas)
    total_gas = sum(gas)
    total_cost = sum(cost)
    
    # If total gas &lt; total cost, impossible
    if total_gas &lt; total_cost:
        return -1
    
    start = 0
    tank = 0
    
    for i in range(n):
        tank += gas[i] - cost[i]
        if tank &lt; 0:
            # Can't reach next station from current start
            start = i + 1
            tank = 0
    
    return start

# Example usage
gas = [1, 2, 3, 4, 5]
cost = [3, 4, 5, 1, 2]
start = can_complete_circuit(gas, cost)
print(f"Start at station: {start}")  # Output: 3
</code></pre>
<p><strong>Time Complexity</strong>: $O(n)$</p>
<h2 id="greedy-vs-dynamic-programming"><a class="header" href="#greedy-vs-dynamic-programming">Greedy vs Dynamic Programming</a></h2>
<p>Some problems can be solved by both approaches:</p>
<pre><code class="language-python"># Greedy (doesn't always work)
def coin_change_greedy(coins, amount):
    coins.sort(reverse=True)
    count = 0
    for coin in coins:
        count += amount // coin
        amount %= coin
    return count if amount == 0 else -1

# Dynamic Programming (always correct)
def coin_change_dp(coins, amount):
    dp = [float('inf')] * (amount + 1)
    dp[0] = 0
    for coin in coins:
        for i in range(coin, amount + 1):
            dp[i] = min(dp[i], dp[i - coin] + 1)
    return dp[amount] if dp[amount] != float('inf') else -1
</code></pre>
<h2 id="when-to-use-greedy"><a class="header" href="#when-to-use-greedy">When to Use Greedy</a></h2>
<p>Use greedy when:</p>
<ol>
<li>Problem has greedy choice property</li>
<li>Problem has optimal substructure</li>
<li>Local optimum leads to global optimum</li>
</ol>
<h2 id="common-greedy-patterns"><a class="header" href="#common-greedy-patterns">Common Greedy Patterns</a></h2>
<ol>
<li><strong>Sorting first</strong>: Many greedy algorithms start by sorting</li>
<li><strong>Priority queue</strong>: Use heap for best choice at each step</li>
<li><strong>Intervals</strong>: Scheduling problems often use greedy</li>
<li><strong>Graph traversal</strong>: MST, shortest path</li>
</ol>
<h2 id="applications-9"><a class="header" href="#applications-9">Applications</a></h2>
<p>Greedy algorithms are widely used in various applications, including:</p>
<ul>
<li><strong>Network Routing</strong>: Finding the shortest path in a network (Dijkstra's algorithm)</li>
<li><strong>Resource Allocation</strong>: Distributing resources in a way that maximizes efficiency</li>
<li><strong>Job Scheduling</strong>: Scheduling jobs on machines to minimize completion time</li>
<li><strong>Data Compression</strong>: Huffman coding for optimal compression</li>
<li><strong>Minimum Spanning Trees</strong>: Network design problems</li>
</ul>
<h2 id="conclusion-13"><a class="header" href="#conclusion-13">Conclusion</a></h2>
<p>Greedy algorithms provide a straightforward and efficient approach to solving optimization problems. While they do not always yield the optimal solution, they are often easier to implement and can be very effective for certain types of problems.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sorting-algorithms"><a class="header" href="#sorting-algorithms">Sorting Algorithms</a></h1>
<h2 id="overview-30"><a class="header" href="#overview-30">Overview</a></h2>
<p>Sorting arranges elements in order. Different algorithms have different trade-offs in speed, memory, and stability.</p>
<h2 id="common-algorithms-2"><a class="header" href="#common-algorithms-2">Common Algorithms</a></h2>
<h3 id="bubble-sort"><a class="header" href="#bubble-sort">Bubble Sort</a></h3>
<p><strong>Time</strong>: $O(n^2)$ | <strong>Space</strong>: $O(1)$</p>
<pre><code class="language-python">def bubble_sort(arr):
    n = len(arr)
    for i in range(n):
        for j in range(0, n - i - 1):
            if arr[j] &gt; arr[j + 1]:
                arr[j], arr[j + 1] = arr[j + 1], arr[j]
    return arr
</code></pre>
<h3 id="selection-sort"><a class="header" href="#selection-sort">Selection Sort</a></h3>
<p><strong>Time</strong>: $O(n^2)$ | <strong>Space</strong>: $O(1)$</p>
<pre><code class="language-python">def selection_sort(arr):
    for i in range(len(arr)):
        min_idx = i
        for j in range(i + 1, len(arr)):
            if arr[j] &lt; arr[min_idx]:
                min_idx = j
        arr[i], arr[min_idx] = arr[min_idx], arr[i]
    return arr
</code></pre>
<h3 id="insertion-sort"><a class="header" href="#insertion-sort">Insertion Sort</a></h3>
<p><strong>Time</strong>: $O(n^2)$ | <strong>Space</strong>: $O(1)$ | <strong>Best</strong>: $O(n)$</p>
<pre><code class="language-python">def insertion_sort(arr):
    for i in range(1, len(arr)):
        key = arr[i]
        j = i - 1
        while j &gt;= 0 and arr[j] &gt; key:
            arr[j + 1] = arr[j]
            j -= 1
        arr[j + 1] = key
    return arr
</code></pre>
<h3 id="merge-sort-1"><a class="header" href="#merge-sort-1">Merge Sort</a></h3>
<p><strong>Time</strong>: $O(n \log n)$ | <strong>Space</strong>: $O(n)$ | <strong>Stable</strong>: ✓</p>
<pre><code class="language-python">def merge_sort(arr):
    if len(arr) &lt;= 1:
        return arr

    mid = len(arr) // 2
    left = merge_sort(arr[:mid])
    right = merge_sort(arr[mid:])

    return merge(left, right)

def merge(left, right):
    result = []
    i = j = 0
    while i &lt; len(left) and j &lt; len(right):
        if left[i] &lt; right[j]:
            result.append(left[i])
            i += 1
        else:
            result.append(right[j])
            j += 1
    result.extend(left[i:])
    result.extend(right[j:])
    return result
</code></pre>
<h3 id="quick-sort-1"><a class="header" href="#quick-sort-1">Quick Sort</a></h3>
<p><strong>Time</strong>: $O(n \log n)$ avg, $O(n^2)$ worst | <strong>Space</strong>: $O(\log n)$</p>
<pre><code class="language-python">def quick_sort(arr):
    if len(arr) &lt;= 1:
        return arr

    pivot = arr[len(arr) // 2]
    left = [x for x in arr if x &lt; pivot]
    middle = [x for x in arr if x == pivot]
    right = [x for x in arr if x &gt; pivot]

    return quick_sort(left) + middle + quick_sort(right)
</code></pre>
<h3 id="heap-sort"><a class="header" href="#heap-sort">Heap Sort</a></h3>
<p><strong>Time</strong>: $O(n \log n)$ | <strong>Space</strong>: $O(1)$</p>
<pre><code class="language-python">def heap_sort(arr):
    def heapify(arr, n, i):
        largest = i
        left = 2 * i + 1
        right = 2 * i + 2

        if left &lt; n and arr[left] &gt; arr[largest]:
            largest = left
        if right &lt; n and arr[right] &gt; arr[largest]:
            largest = right

        if largest != i:
            arr[i], arr[largest] = arr[largest], arr[i]
            heapify(arr, n, largest)

    n = len(arr)
    for i in range(n // 2 - 1, -1, -1):
        heapify(arr, n, i)

    for i in range(n - 1, 0, -1):
        arr[0], arr[i] = arr[i], arr[0]
        heapify(arr, i, 0)

    return arr
</code></pre>
<h2 id="comparison"><a class="header" href="#comparison">Comparison</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Algorithm</th><th>Best</th><th>Average</th><th>Worst</th><th>Space</th><th>Stable</th></tr></thead><tbody>
<tr><td><strong>Bubble</strong></td><td>$O(n)$</td><td>$O(n^2)$</td><td>$O(n^2)$</td><td>$O(1)$</td><td>✓</td></tr>
<tr><td><strong>Selection</strong></td><td>$O(n^2)$</td><td>$O(n^2)$</td><td>$O(n^2)$</td><td>$O(1)$</td><td>✗</td></tr>
<tr><td><strong>Insertion</strong></td><td>$O(n)$</td><td>$O(n^2)$</td><td>$O(n^2)$</td><td>$O(1)$</td><td>✓</td></tr>
<tr><td><strong>Merge</strong></td><td>$O(n \log n)$</td><td>$O(n \log n)$</td><td>$O(n \log n)$</td><td>$O(n)$</td><td>✓</td></tr>
<tr><td><strong>Quick</strong></td><td>$O(n \log n)$</td><td>$O(n \log n)$</td><td>$O(n^2)$</td><td>$O(\log n)$</td><td>✗</td></tr>
<tr><td><strong>Heap</strong></td><td>$O(n \log n)$</td><td>$O(n \log n)$</td><td>$O(n \log n)$</td><td>$O(1)$</td><td>✗</td></tr>
</tbody></table>
</div>
<h2 id="when-to-use"><a class="header" href="#when-to-use">When to Use</a></h2>
<ul>
<li><strong>Insertion Sort</strong>: Small arrays, nearly sorted</li>
<li><strong>Merge Sort</strong>: Need stability, external sorting</li>
<li><strong>Quick Sort</strong>: General purpose, good cache</li>
<li><strong>Heap Sort</strong>: Guaranteed $O(n \log n)$, no extra space</li>
</ul>
<h2 id="python-built-in"><a class="header" href="#python-built-in">Python Built-in</a></h2>
<pre><code class="language-python"># Best for most cases
arr.sort()  # In-place, O(n log n)
sorted(arr)  # Returns new list

# Custom comparator
arr.sort(key=lambda x: x['age'])
</code></pre>
<h2 id="eli10-5"><a class="header" href="#eli10-5">ELI10</a></h2>
<p>Different sorting strategies:</p>
<ul>
<li><strong>Bubble</strong>: Compare neighbors (slow)</li>
<li><strong>Quick</strong>: Pick pivot, divide and conquer (fast)</li>
<li><strong>Merge</strong>: Split in half, merge back (reliable)</li>
</ul>
<p>Use built-in sorts unless learning!</p>
<h2 id="further-resources-5"><a class="header" href="#further-resources-5">Further Resources</a></h2>
<ul>
<li><a href="https://www.sortvisualizer.com/">Sorting Algorithms Visualized</a></li>
<li><a href="https://www.bigocheatsheet.com/">Big-O Cheatsheet</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="searching-algorithms"><a class="header" href="#searching-algorithms">Searching Algorithms</a></h1>
<h2 id="overview-31"><a class="header" href="#overview-31">Overview</a></h2>
<p>Searching algorithms help find elements in data structures. The choice depends on whether data is sorted and the size of the data.</p>
<h2 id="linear-search-1"><a class="header" href="#linear-search-1">Linear Search</a></h2>
<p><strong>Time</strong>: $O(n)$ | <strong>Space</strong>: $O(1)$ | <strong>Works on</strong>: Unsorted arrays</p>
<pre><code class="language-python">def linear_search(arr, target):
    for i in range(len(arr)):
        if arr[i] == target:
            return i
    return -1
</code></pre>
<p><strong>When to use</strong>: Small arrays, unsorted data</p>
<h2 id="binary-search-2"><a class="header" href="#binary-search-2">Binary Search</a></h2>
<p><strong>Time</strong>: $O(\log n)$ | <strong>Space</strong>: $O(1)$ | <strong>Requires</strong>: Sorted array</p>
<pre><code class="language-python">def binary_search(arr, target):
    left, right = 0, len(arr) - 1

    while left &lt;= right:
        mid = left + (right - left) // 2
        if arr[mid] == target:
            return mid
        elif arr[mid] &lt; target:
            left = mid + 1
        else:
            right = mid - 1

    return -1  # Not found
</code></pre>
<h3 id="variations"><a class="header" href="#variations">Variations</a></h3>
<pre><code class="language-python"># Find first occurrence
def find_first(arr, target):
    left, right = 0, len(arr) - 1
    result = -1

    while left &lt;= right:
        mid = left + (right - left) // 2
        if arr[mid] == target:
            result = mid
            right = mid - 1  # Keep searching left
        elif arr[mid] &lt; target:
            left = mid + 1
        else:
            right = mid - 1

    return result

# Find last occurrence
def find_last(arr, target):
    left, right = 0, len(arr) - 1
    result = -1

    while left &lt;= right:
        mid = left + (right - left) // 2
        if arr[mid] == target:
            result = mid
            left = mid + 1  # Keep searching right
        elif arr[mid] &lt; target:
            left = mid + 1
        else:
            right = mid - 1

    return result
</code></pre>
<h2 id="two-pointer-technique"><a class="header" href="#two-pointer-technique">Two Pointer Technique</a></h2>
<p><strong>Time</strong>: $O(n)$ | <strong>Space</strong>: $O(1)$</p>
<pre><code class="language-python">def two_sum(arr, target):
    """Find two numbers that sum to target"""
    left, right = 0, len(arr) - 1

    while left &lt; right:
        current_sum = arr[left] + arr[right]
        if current_sum == target:
            return [left, right]
        elif current_sum &lt; target:
            left += 1
        else:
            right -= 1

    return []
</code></pre>
<h2 id="jump-search"><a class="header" href="#jump-search">Jump Search</a></h2>
<p><strong>Time</strong>: O(n) | <strong>Space</strong>: $O(1)$ | <strong>Requires</strong>: Sorted array</p>
<pre><code class="language-python">import math

def jump_search(arr, target):
    n = len(arr)
    step = int(math.sqrt(n))
    prev = 0

    # Find block where target is present
    while arr[min(step, n) - 1] &lt; target:
        prev = step
        step += int(math.sqrt(n))
        if prev &gt;= n:
            return -1

    # Linear search in block
    while arr[prev] &lt; target:
        prev += 1
        if prev == min(step, n):
            return -1

    # Check if target found
    if arr[prev] == target:
        return prev

    return -1
</code></pre>
<h2 id="interpolation-search"><a class="header" href="#interpolation-search">Interpolation Search</a></h2>
<p><strong>Time</strong>: $O(\log \log n)$ average, $O(n)$ worst | <strong>Requires</strong>: Sorted uniformly distributed data</p>
<pre><code class="language-python">def interpolation_search(arr, target):
    left, right = 0, len(arr) - 1

    while (left &lt;= right and
           target &gt;= arr[left] and
           target &lt;= arr[right]):

        # Estimate position
        pos = left + int((right - left) / (arr[right] - arr[left]) *
                        (target - arr[left]))

        if arr[pos] == target:
            return pos
        elif arr[pos] &lt; target:
            left = pos + 1
        else:
            right = pos - 1

    return -1
</code></pre>
<h2 id="exponential-search"><a class="header" href="#exponential-search">Exponential Search</a></h2>
<p><strong>Time</strong>: $O(\log n)$ | <strong>Space</strong>: $O(1)$ | <strong>Requires</strong>: Sorted array</p>
<pre><code class="language-python">def exponential_search(arr, target):
    n = len(arr)

    # Find range
    i = 1
    while i &lt; n and arr[i] &lt; target:
        i *= 2

    # Binary search in range
    left = i // 2
    right = min(i, n - 1)

    while left &lt;= right:
        mid = left + (right - left) // 2
        if arr[mid] == target:
            return mid
        elif arr[mid] &lt; target:
            left = mid + 1
        else:
            right = mid - 1

    return -1
</code></pre>
<h2 id="sentinel-search"><a class="header" href="#sentinel-search">Sentinel Search</a></h2>
<p>Optimize linear search by eliminating boundary check:</p>
<pre><code class="language-python">def sentinel_search(arr, target):
    n = len(arr)
    last = arr[n - 1]
    arr[n - 1] = target

    i = 0
    while arr[i] != target:
        i += 1

    arr[n - 1] = last  # Restore

    if i &lt; n - 1 or last == target:
        return i
    return -1
</code></pre>
<h2 id="comparison-1"><a class="header" href="#comparison-1">Comparison</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Algorithm</th><th>Time (Avg)</th><th>Time (Worst)</th><th>Space</th><th>Requires Sorted</th></tr></thead><tbody>
<tr><td>Linear</td><td>$O(n)$</td><td>$O(n)$</td><td>$O(1)$</td><td>No</td></tr>
<tr><td>Binary</td><td>$O(\log n)$</td><td>$O(\log n)$</td><td>$O(1)$</td><td>Yes</td></tr>
<tr><td>Jump</td><td>O(n)</td><td>O(n)</td><td>$O(1)$</td><td>Yes</td></tr>
<tr><td>Interpolation</td><td>$O(\log \log n)$</td><td>$O(n)$</td><td>$O(1)$</td><td>Yes</td></tr>
<tr><td>Exponential</td><td>$O(\log n)$</td><td>$O(\log n)$</td><td>$O(1)$</td><td>Yes</td></tr>
</tbody></table>
</div>
<h2 id="key-takeaways"><a class="header" href="#key-takeaways">Key Takeaways</a></h2>
<ol>
<li><strong>Unsorted data?</strong> Use Linear Search or Hash Table</li>
<li><strong>Sorted data?</strong> Use Binary Search for $O(\log n)$</li>
<li><strong>Uniformly distributed?</strong> Try Interpolation Search</li>
<li><strong>Need flexibility?</strong> Build a Hash Table for $O(1)$ lookup</li>
</ol>
<h2 id="eli10-6"><a class="header" href="#eli10-6">ELI10</a></h2>
<p>Imagine finding a word in a dictionary:</p>
<ul>
<li><strong>Linear Search</strong>: Check every word from start (slow!)</li>
<li><strong>Binary Search</strong>: Open middle, go left or right, repeat (fast!)</li>
<li><strong>Interpolation</strong>: Estimate where word should be based on first letter</li>
</ul>
<p>Binary search is fastest for sorted data!</p>
<h2 id="further-resources-6"><a class="header" href="#further-resources-6">Further Resources</a></h2>
<ul>
<li><a href="https://leetcode.com/tag/binary-search/">LeetCode Binary Search</a></li>
<li><a href="https://visualgo.net/en/search">Searching Algorithms Visualization</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="graphs-2"><a class="header" href="#graphs-2">Graphs</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="trees-1"><a class="header" href="#trees-1">Trees</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="heaps-1"><a class="header" href="#heaps-1">Heaps</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="tries-1"><a class="header" href="#tries-1">Tries</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="raft-consensus-algorithm"><a class="header" href="#raft-consensus-algorithm">Raft Consensus Algorithm</a></h1>
<p>Raft is a consensus algorithm designed to be easy to understand. It's used for managing a replicated log in distributed systems.</p>
<h2 id="overview-32"><a class="header" href="#overview-32">Overview</a></h2>
<p>Raft ensures that a cluster of servers agrees on a sequence of values, even in the presence of failures.</p>
<p><strong>Key Properties:</strong></p>
<ul>
<li>Leader election</li>
<li>Log replication</li>
<li>Safety</li>
<li>Membership changes</li>
</ul>
<h2 id="server-states"><a class="header" href="#server-states">Server States</a></h2>
<pre><code>┌─────────┐    times out, starts election    ┌───────────┐
│Follower │───────────────────────────────&gt;│ Candidate │
└─────────┘                                  └───────────┘
     │                                            │
     │discovers current leader or new term         │receives votes from
     │                                            │majority of servers
     │                                            │
     │                                            ▼
     │                                       ┌────────┐
     └───────────────────────────────────────│ Leader │
                 discovers server with       └────────┘
                 higher term
</code></pre>
<h2 id="leader-election"><a class="header" href="#leader-election">Leader Election</a></h2>
<ol>
<li>Follower times out (150-300ms)</li>
<li>Becomes candidate, increments term</li>
<li>Votes for itself</li>
<li>Requests votes from other servers</li>
<li>If majority votes: becomes leader</li>
<li>If another leader found: becomes follower</li>
</ol>
<h2 id="log-replication"><a class="header" href="#log-replication">Log Replication</a></h2>
<pre><code>Leader receives command from client
  ↓
Append to local log
  ↓
Send AppendEntries RPCs to followers
  ↓
Wait for majority to acknowledge
  ↓
Apply to state machine
  ↓
Return result to client
</code></pre>
<h2 id="safety-rules"><a class="header" href="#safety-rules">Safety Rules</a></h2>
<ol>
<li><strong>Election Safety</strong>: At most one leader per term</li>
<li><strong>Leader Append-Only</strong>: Leader never overwrites entries</li>
<li><strong>Log Matching</strong>: If two logs contain entry with same index/term, entries are identical</li>
<li><strong>Leader Completeness</strong>: If entry committed in term, it's in leader's log</li>
<li><strong>State Machine Safety</strong>: If server applies entry at index, no other server applies different entry at that index</li>
</ol>
<h2 id="example-python-like-pseudocode"><a class="header" href="#example-python-like-pseudocode">Example (Python-like pseudocode)</a></h2>
<pre><code class="language-python">class RaftNode:
    def __init__(self):
        self.state = "follower"
        self.current_term = 0
        self.voted_for = None
        self.log = []
        self.commit_index = 0

    def request_vote(self, term, candidate_id):
        if term &gt; self.current_term:
            self.current_term = term
            self.voted_for = None

        if self.voted_for is None:
            self.voted_for = candidate_id
            return True
        return False

    def append_entries(self, term, leader_id, entries):
        if term &gt;= self.current_term:
            self.state = "follower"
            self.current_term = term
            self.log.extend(entries)
            return True
        return False
</code></pre>
<p>Raft provides understandable consensus for building reliable distributed systems like etcd, Consul, and CockroachDB.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="security-2"><a class="header" href="#security-2">Security</a></h1>
<p>Comprehensive security reference covering cryptography, authentication, and secure communications.</p>
<h2 id="cryptography"><a class="header" href="#cryptography">Cryptography</a></h2>
<h3 id="encryption"><a class="header" href="#encryption"><a href="security/encryption.html">Encryption</a></a></h3>
<ul>
<li>Symmetric encryption (AES, ChaCha20)</li>
<li>Asymmetric encryption (RSA, ECC)</li>
<li>Encryption modes and best practices</li>
<li>Key management</li>
</ul>
<h3 id="hashing"><a class="header" href="#hashing"><a href="security/hashing.html">Hashing</a></a></h3>
<ul>
<li>Cryptographic hash functions</li>
<li>SHA-256, SHA-3, BLAKE2</li>
<li>Password hashing (bcrypt, Argon2)</li>
<li>Hash-based applications</li>
</ul>
<h3 id="hmac"><a class="header" href="#hmac"><a href="security/hmac.html">HMAC</a></a></h3>
<ul>
<li>Hash-based Message Authentication Code</li>
<li>Message integrity and authenticity</li>
<li>HMAC construction and usage</li>
<li>Applications in APIs and tokens</li>
</ul>
<h2 id="authentication--authorization"><a class="header" href="#authentication--authorization">Authentication &amp; Authorization</a></h2>
<h3 id="oauth-20"><a class="header" href="#oauth-20"><a href="security/oauth2.html">OAuth 2.0</a></a></h3>
<ul>
<li>Authorization framework and grant types</li>
<li>Authorization Code, Client Credentials, PKCE</li>
<li>Access tokens and refresh tokens</li>
<li>OpenID Connect for authentication</li>
<li>Implementation best practices</li>
</ul>
<h3 id="jwt-json-web-tokens"><a class="header" href="#jwt-json-web-tokens"><a href="security/jwt.html">JWT (JSON Web Tokens)</a></a></h3>
<ul>
<li>Token structure (header, payload, signature)</li>
<li>Signing algorithms (HS256, RS256, ES256)</li>
<li>Token validation and verification</li>
<li>Use cases and security considerations</li>
<li>Best practices for token management</li>
</ul>
<h2 id="digital-signatures"><a class="header" href="#digital-signatures">Digital Signatures</a></h2>
<h3 id="digital-signatures-1"><a class="header" href="#digital-signatures-1"><a href="security/digital_signatures.html">Digital Signatures</a></a></h3>
<ul>
<li>RSA signatures</li>
<li>ECDSA (Elliptic Curve Digital Signature Algorithm)</li>
<li>EdDSA (Edwards-curve Digital Signature Algorithm)</li>
<li>Signature verification</li>
<li>Applications (code signing, documents)</li>
</ul>
<h3 id="certificates"><a class="header" href="#certificates"><a href="security/certificates.html">Certificates</a></a></h3>
<ul>
<li>X.509 certificates</li>
<li>Certificate Authorities (CAs)</li>
<li>Certificate chains and trust</li>
<li>Certificate management</li>
<li>Let's Encrypt and ACME protocol</li>
</ul>
<h2 id="secure-communications"><a class="header" href="#secure-communications">Secure Communications</a></h2>
<h3 id="ssltls"><a class="header" href="#ssltls"><a href="security/ssl_tls.html">SSL/TLS</a></a></h3>
<ul>
<li>TLS handshake process</li>
<li>Cipher suites</li>
<li>Certificate validation</li>
<li>TLS 1.2 vs TLS 1.3</li>
<li>Common vulnerabilities (BEAST, POODLE, Heartbleed)</li>
<li>Best practices and configuration</li>
</ul>
<h2 id="quick-reference-5"><a class="header" href="#quick-reference-5">Quick Reference</a></h2>
<h3 id="common-algorithms-3"><a class="header" href="#common-algorithms-3">Common Algorithms</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Algorithm</th><th>Type</th><th>Key Size</th><th>Use Case</th></tr></thead><tbody>
<tr><td><strong>AES</strong></td><td>Symmetric</td><td>128/192/256-bit</td><td>General encryption</td></tr>
<tr><td><strong>ChaCha20</strong></td><td>Symmetric</td><td>256-bit</td><td>Mobile/embedded</td></tr>
<tr><td><strong>RSA</strong></td><td>Asymmetric</td><td>2048/4096-bit</td><td>Key exchange, signatures</td></tr>
<tr><td><strong>ECDSA</strong></td><td>Asymmetric</td><td>256-bit</td><td>Signatures (Bitcoin)</td></tr>
<tr><td><strong>SHA-256</strong></td><td>Hash</td><td>N/A</td><td>Checksums, Bitcoin</td></tr>
<tr><td><strong>bcrypt</strong></td><td>Password Hash</td><td>N/A</td><td>Password storage</td></tr>
<tr><td><strong>Argon2</strong></td><td>Password Hash</td><td>N/A</td><td>Password storage (modern)</td></tr>
</tbody></table>
</div>
<h3 id="security-best-practices-1"><a class="header" href="#security-best-practices-1">Security Best Practices</a></h3>
<ol>
<li>
<p><strong>Use Modern Algorithms</strong></p>
<ul>
<li>AES-256 for symmetric encryption</li>
<li>RSA-2048 minimum, prefer ECC</li>
<li>SHA-256 or SHA-3 for hashing</li>
<li>Argon2 for password hashing</li>
</ul>
</li>
<li>
<p><strong>Key Management</strong></p>
<ul>
<li>Generate strong random keys</li>
<li>Rotate keys regularly</li>
<li>Use HSM for critical keys</li>
<li>Never hardcode secrets</li>
</ul>
</li>
<li>
<p><strong>TLS Configuration</strong></p>
<ul>
<li>Use TLS 1.2 minimum (prefer 1.3)</li>
<li>Disable weak cipher suites</li>
<li>Enable Perfect Forward Secrecy</li>
<li>Use strong certificate chains</li>
</ul>
</li>
<li>
<p><strong>Password Storage</strong></p>
<ul>
<li>Never store plaintext passwords</li>
<li>Use bcrypt or Argon2</li>
<li>Add unique salt per password</li>
<li>Use appropriate work factors</li>
</ul>
</li>
<li>
<p><strong>API Security</strong></p>
<ul>
<li>Use HMAC for message integrity</li>
<li>Implement rate limiting</li>
<li>Use short-lived tokens</li>
<li>Validate all inputs</li>
</ul>
</li>
</ol>
<h2 id="common-tools"><a class="header" href="#common-tools">Common Tools</a></h2>
<pre><code class="language-bash"># OpenSSL
openssl enc -aes-256-cbc -in file.txt -out file.enc
openssl req -new -x509 -days 365 -key key.pem -out cert.pem

# Generate keys
ssh-keygen -t ed25519
openssl genrsa -out private.key 2048

# Hashing
sha256sum file.txt
openssl dgst -sha256 file.txt

# Certificate inspection
openssl x509 -in cert.pem -text -noout
openssl s_client -connect example.com:443
</code></pre>
<h2 id="related-topics"><a class="header" href="#related-topics">Related Topics</a></h2>
<ul>
<li>Network security (firewalls, VPNs)</li>
<li>Application security (OWASP Top 10)</li>
<li>Authentication protocols (OAuth, SAML)</li>
<li>Blockchain and cryptocurrencies</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cryptographic-hash-functions"><a class="header" href="#cryptographic-hash-functions">Cryptographic Hash Functions</a></h1>
<h2 id="overview-33"><a class="header" href="#overview-33">Overview</a></h2>
<p>A cryptographic hash function is a mathematical algorithm that takes an input (message) of any size and produces a fixed-size output (hash digest). Hash functions are one-way functions designed to be computationally infeasible to reverse.</p>
<h2 id="key-properties"><a class="header" href="#key-properties">Key Properties</a></h2>
<h3 id="1-deterministic"><a class="header" href="#1-deterministic">1. Deterministic</a></h3>
<p>Same input always produces the same output:</p>
<pre><code>hash("hello") = 2cf24dba5fb0a30e...
hash("hello") = 2cf24dba5fb0a30e...  (always the same)
</code></pre>
<h3 id="2-fast-computation"><a class="header" href="#2-fast-computation">2. Fast Computation</a></h3>
<p>Quick to compute hash for any input</p>
<h3 id="3-pre-image-resistance-one-way"><a class="header" href="#3-pre-image-resistance-one-way">3. Pre-image Resistance (One-way)</a></h3>
<p>Given hash <code>h</code>, computationally infeasible to find message <code>m</code> where <code>hash(m) = h</code></p>
<h3 id="4-collision-resistance"><a class="header" href="#4-collision-resistance">4. Collision Resistance</a></h3>
<p>Computationally infeasible to find two different messages <code>m1</code> and <code>m2</code> where:</p>
<pre><code>hash(m1) = hash(m2)
</code></pre>
<h3 id="5-avalanche-effect"><a class="header" href="#5-avalanche-effect">5. Avalanche Effect</a></h3>
<p>Small change in input drastically changes output:</p>
<pre><code>hash("hello")  = 2cf24dba5fb0a30e26e83b2ac5b9e29e1b161e5c1fa7425e73043362938b9824
hash("helloX") = 9c70933a77f8d8d1eb5ba43c8f8c8b2e6f4c8e8a5b9e1b161e5c1fa7425e7304
</code></pre>
<h2 id="common-hash-functions"><a class="header" href="#common-hash-functions">Common Hash Functions</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Algorithm</th><th>Output Size</th><th>Status</th><th>Use Cases</th></tr></thead><tbody>
<tr><td><strong>MD5</strong></td><td>128 bits (16 bytes)</td><td>Broken</td><td>Checksums only</td></tr>
<tr><td><strong>SHA-1</strong></td><td>160 bits (20 bytes)</td><td>Deprecated</td><td>Legacy systems</td></tr>
<tr><td><strong>SHA-256</strong></td><td>256 bits (32 bytes)</td><td>Secure</td><td>General purpose</td></tr>
<tr><td><strong>SHA-512</strong></td><td>512 bits (64 bytes)</td><td>Secure</td><td>High security</td></tr>
<tr><td><strong>SHA-3</strong></td><td>Variable</td><td>Secure</td><td>Modern alternative</td></tr>
<tr><td><strong>BLAKE2</strong></td><td>Variable</td><td>Secure</td><td>Fast, modern</td></tr>
<tr><td><strong>BLAKE3</strong></td><td>256 bits</td><td>Secure</td><td>Fastest, modern</td></tr>
</tbody></table>
</div>
<h2 id="sha-256-secure-hash-algorithm-256"><a class="header" href="#sha-256-secure-hash-algorithm-256">SHA-256 (Secure Hash Algorithm 256)</a></h2>
<h3 id="algorithm-overview"><a class="header" href="#algorithm-overview">Algorithm Overview</a></h3>
<p>SHA-256 is part of the SHA-2 family, designed by the NSA and published in 2001.</p>
<p><strong>Process:</strong></p>
<ol>
<li>Pad message to multiple of 512 bits</li>
<li>Initialize hash values (8 x 32-bit words)</li>
<li>Process message in 512-bit chunks</li>
<li>Each chunk goes through 64 rounds of operations</li>
<li>Produce final 256-bit hash</li>
</ol>
<h3 id="using-sha-256"><a class="header" href="#using-sha-256">Using SHA-256</a></h3>
<h4 id="python-example"><a class="header" href="#python-example">Python Example</a></h4>
<pre><code class="language-python">import hashlib

# Hash a string
message = "Hello, World!"
hash_object = hashlib.sha256(message.encode())
hash_hex = hash_object.hexdigest()
print(f"SHA-256: {hash_hex}")
# Output: SHA-256: dffd6021bb2bd5b0af676290809ec3a53191dd81c7f70a4b28688a362182986f

# Hash a file
def hash_file(filename):
    sha256_hash = hashlib.sha256()
    with open(filename, "rb") as f:
        # Read file in chunks to handle large files
        for byte_block in iter(lambda: f.read(4096), b""):
            sha256_hash.update(byte_block)
    return sha256_hash.hexdigest()

file_hash = hash_file("document.pdf")
print(f"File hash: {file_hash}")

# Incremental hashing
hasher = hashlib.sha256()
hasher.update(b"Hello, ")
hasher.update(b"World!")
print(hasher.hexdigest())
# Same as hashing "Hello, World!" at once
</code></pre>
<h4 id="bashopenssl-example"><a class="header" href="#bashopenssl-example">Bash/OpenSSL Example</a></h4>
<pre><code class="language-bash"># Hash a string
echo -n "Hello, World!" | sha256sum
echo -n "Hello, World!" | openssl dgst -sha256

# Hash a file
sha256sum document.pdf
openssl dgst -sha256 document.pdf

# Verify file integrity
sha256sum document.pdf &gt; checksum.txt
sha256sum -c checksum.txt

# Hash multiple files
sha256sum *.pdf &gt; all_checksums.txt
</code></pre>
<h3 id="sha-256-output-format"><a class="header" href="#sha-256-output-format">SHA-256 Output Format</a></h3>
<pre><code>Input: "Hello, World!"

Binary (256 bits):
11011111111111010110000000100001...

Hexadecimal (64 characters):
dffd6021bb2bd5b0af676290809ec3a53191dd81c7f70a4b28688a362182986f

Base64 (44 characters):
3/1gIbsr1bCvZ2KQgJ7DpTGR3YHH9wpLKGiKNiGCmG8=
</code></pre>
<h2 id="sha-3-keccak"><a class="header" href="#sha-3-keccak">SHA-3 (Keccak)</a></h2>
<p>SHA-3 is based on a different construction (sponge function) than SHA-2, providing an alternative if SHA-2 is compromised.</p>
<h3 id="using-sha-3"><a class="header" href="#using-sha-3">Using SHA-3</a></h3>
<pre><code class="language-python">import hashlib

message = "Hello, World!"

# SHA-3 variants
sha3_256 = hashlib.sha3_256(message.encode()).hexdigest()
sha3_512 = hashlib.sha3_512(message.encode()).hexdigest()

print(f"SHA3-256: {sha3_256}")
print(f"SHA3-512: {sha3_512}")

# SHAKE (extendable output)
shake = hashlib.shake_256(message.encode())
# Get 32 bytes of output
print(f"SHAKE256: {shake.hexdigest(32)}")
</code></pre>
<h2 id="blake2"><a class="header" href="#blake2">BLAKE2</a></h2>
<p>Faster than SHA-2 and SHA-3, with built-in keyed hashing and salting support.</p>
<h3 id="using-blake2"><a class="header" href="#using-blake2">Using BLAKE2</a></h3>
<pre><code class="language-python">import hashlib

message = b"Hello, World!"

# BLAKE2b (optimized for 64-bit platforms)
blake2b = hashlib.blake2b(message).hexdigest()
print(f"BLAKE2b: {blake2b}")

# BLAKE2s (optimized for 8-32 bit platforms)
blake2s = hashlib.blake2s(message).hexdigest()
print(f"BLAKE2s: {blake2s}")

# Keyed hashing (MAC)
key = b"secret-key-123"
mac = hashlib.blake2b(message, key=key).hexdigest()
print(f"BLAKE2b MAC: {mac}")

# Custom digest size
digest = hashlib.blake2b(message, digest_size=16).hexdigest()
print(f"BLAKE2b-128: {digest}")

# With salt (for password hashing)
salt = b"random-salt-16bytes!"
h = hashlib.blake2b(message, salt=salt, digest_size=32)
print(f"BLAKE2b with salt: {h.hexdigest()}")
</code></pre>
<h2 id="password-hashing"><a class="header" href="#password-hashing">Password Hashing</a></h2>
<p><strong>WARNING</strong>: Never use fast hashes (SHA-256, MD5) for passwords! Use specialized password hashing functions.</p>
<h3 id="why-not-sha-256-for-passwords"><a class="header" href="#why-not-sha-256-for-passwords">Why Not SHA-256 for Passwords?</a></h3>
<pre><code class="language-python"># BAD - vulnerable to brute force
import hashlib
password = "password123"
hash = hashlib.sha256(password.encode()).hexdigest()
# Attacker can compute billions of SHA-256 hashes per second!
</code></pre>
<h3 id="password-hashing-requirements"><a class="header" href="#password-hashing-requirements">Password Hashing Requirements</a></h3>
<ol>
<li><strong>Slow</strong>: Intentionally slow to prevent brute force</li>
<li><strong>Salted</strong>: Random salt prevents rainbow tables</li>
<li><strong>Adaptive</strong>: Can increase work factor over time</li>
<li><strong>Memory-hard</strong>: Requires significant memory (for some algorithms)</li>
</ol>
<h2 id="bcrypt"><a class="header" href="#bcrypt">bcrypt</a></h2>
<h3 id="overview-34"><a class="header" href="#overview-34">Overview</a></h3>
<ul>
<li>Based on Blowfish cipher</li>
<li>Adaptive (configurable work factor)</li>
<li>Automatic salt generation</li>
<li>Maximum password length: 72 bytes</li>
</ul>
<h3 id="using-bcrypt"><a class="header" href="#using-bcrypt">Using bcrypt</a></h3>
<pre><code class="language-python">import bcrypt

# Hash a password
password = b"my_secure_password"
salt = bcrypt.gensalt(rounds=12)  # 2^12 iterations
hashed = bcrypt.hashpw(password, salt)
print(f"Hashed: {hashed}")
# Output: b'$2b$12$KIXx8Z9...'

# Verify password
if bcrypt.checkpw(password, hashed):
    print("Password matches!")
else:
    print("Invalid password")

# Increase work factor over time
def needs_rehash(hashed_password, min_rounds=12):
    # Extract current rounds from hash
    parts = hashed_password.decode().split('$')
    current_rounds = int(parts[2])
    return current_rounds &lt; min_rounds

# Complete example
def hash_password(password):
    return bcrypt.hashpw(password.encode(), bcrypt.gensalt(rounds=12))

def verify_password(password, hashed):
    return bcrypt.checkpw(password.encode(), hashed)

# Usage
user_password = "SuperSecret123!"
stored_hash = hash_password(user_password)

# Later, during login
login_password = "SuperSecret123!"
if verify_password(login_password, stored_hash):
    print("Login successful!")
</code></pre>
<h3 id="bcrypt-hash-format"><a class="header" href="#bcrypt-hash-format">bcrypt Hash Format</a></h3>
<pre><code>$2b$12$KIXx8Z9ByF7LHfG8z.yNH.Q5GF8Z9ByF7LHfG8z.yNH.Q5GF8Z9ByF7
 |  |  |                                                    |
 |  |  |                                                    |
 |  |  Salt (22 characters)                                Hash (31 chars)
 |  |
 |  Cost factor (2^12 iterations)
 |
 Algorithm identifier (2b = bcrypt)
</code></pre>
<h2 id="argon2"><a class="header" href="#argon2">Argon2</a></h2>
<h3 id="overview-35"><a class="header" href="#overview-35">Overview</a></h3>
<p>Winner of the Password Hashing Competition (2015). Memory-hard algorithm resistant to GPU/ASIC attacks.</p>
<p><strong>Variants:</strong></p>
<ul>
<li><strong>Argon2d</strong>: Resistant to GPU attacks (not side-channel resistant)</li>
<li><strong>Argon2i</strong>: Resistant to side-channel attacks</li>
<li><strong>Argon2id</strong>: Hybrid (recommended)</li>
</ul>
<h3 id="using-argon2"><a class="header" href="#using-argon2">Using Argon2</a></h3>
<pre><code class="language-python">from argon2 import PasswordHasher
from argon2.exceptions import VerifyMismatchError

# Create hasher with default parameters
ph = PasswordHasher()

# Hash password
password = "my_secure_password"
hashed = ph.hash(password)
print(f"Hashed: {hashed}")
# Output: $argon2id$v=19$m=65536,t=3,p=4$...

# Verify password
try:
    ph.verify(hashed, password)
    print("Password matches!")
except VerifyMismatchError:
    print("Invalid password")

# Check if hash needs rehashing (parameters changed)
if ph.check_needs_rehash(hashed):
    new_hash = ph.hash(password)
    # Update in database

# Custom parameters
from argon2 import PasswordHasher
custom_ph = PasswordHasher(
    time_cost=3,        # Number of iterations
    memory_cost=65536,  # Memory usage in KiB (64 MB)
    parallelism=4,      # Number of parallel threads
    hash_len=32,        # Hash length in bytes
    salt_len=16         # Salt length in bytes
)

hashed = custom_ph.hash(password)
</code></pre>
<h3 id="argon2-hash-format"><a class="header" href="#argon2-hash-format">Argon2 Hash Format</a></h3>
<pre><code>$argon2id$v=19$m=65536,t=3,p=4$c29tZXNhbHQ$hash_output_here
 |        |    |             |              |
 |        |    |             |              Hash output
 |        |    |             Salt (base64)
 |        |    Parameters (memory, time, parallelism)
 |        Version
 Variant (id, i, or d)
</code></pre>
<h3 id="argon2-parameters-guide"><a class="header" href="#argon2-parameters-guide">Argon2 Parameters Guide</a></h3>
<pre><code class="language-python"># Low security (fast, for testing)
time_cost=1, memory_cost=8192, parallelism=1

# Medium security (default)
time_cost=3, memory_cost=65536, parallelism=4

# High security
time_cost=5, memory_cost=262144, parallelism=8

# Extreme security
time_cost=10, memory_cost=1048576, parallelism=16
</code></pre>
<h2 id="salting"><a class="header" href="#salting">Salting</a></h2>
<p>A salt is random data added to passwords before hashing to prevent rainbow table attacks.</p>
<h3 id="without-salt-vulnerable"><a class="header" href="#without-salt-vulnerable">Without Salt (Vulnerable)</a></h3>
<pre><code class="language-python"># BAD - Same password = Same hash
hash("password123") = "abc123..."
hash("password123") = "abc123..."  # Attacker can precompute!
</code></pre>
<h3 id="with-salt-secure"><a class="header" href="#with-salt-secure">With Salt (Secure)</a></h3>
<pre><code class="language-python"># GOOD - Same password = Different hashes
hash("password123" + "random_salt_1") = "xyz789..."
hash("password123" + "random_salt_2") = "def456..."
</code></pre>
<h3 id="implementing-salt"><a class="header" href="#implementing-salt">Implementing Salt</a></h3>
<pre><code class="language-python">import hashlib
import os

def hash_password_with_salt(password):
    # Generate random salt (16 bytes = 128 bits)
    salt = os.urandom(16)
    
    # Combine password and salt
    pwdhash = hashlib.pbkdf2_hmac('sha256', 
                                  password.encode(), 
                                  salt, 
                                  100000)  # iterations
    
    # Store both salt and hash
    return salt + pwdhash

def verify_password(stored_password, provided_password):
    # Extract salt (first 16 bytes)
    salt = stored_password[:16]
    
    # Extract hash (remaining bytes)
    stored_hash = stored_password[16:]
    
    # Hash provided password with same salt
    pwdhash = hashlib.pbkdf2_hmac('sha256',
                                  provided_password.encode(),
                                  salt,
                                  100000)
    
    return pwdhash == stored_hash

# Usage
password = "my_password"
stored = hash_password_with_salt(password)

# Verify
if verify_password(stored, "my_password"):
    print("Correct password")
</code></pre>
<h2 id="pbkdf2-password-based-key-derivation-function-2"><a class="header" href="#pbkdf2-password-based-key-derivation-function-2">PBKDF2 (Password-Based Key Derivation Function 2)</a></h2>
<p>Standard algorithm for deriving cryptographic keys from passwords.</p>
<pre><code class="language-python">import hashlib

password = b"my_password"
salt = b"random_salt_123"

# Derive key
key = hashlib.pbkdf2_hmac(
    'sha256',           # Hash algorithm
    password,           # Password
    salt,               # Salt
    100000,             # Iterations
    dklen=32            # Desired key length in bytes
)

print(f"Derived key: {key.hex()}")

# For password storage
def store_password(password):
    salt = os.urandom(16)
    hash = hashlib.pbkdf2_hmac('sha256', password.encode(), salt, 100000)
    # Store: salt + hash
    return salt.hex() + '$' + hash.hex()

def check_password(password, stored):
    salt_hex, hash_hex = stored.split('$')
    salt = bytes.fromhex(salt_hex)
    hash = bytes.fromhex(hash_hex)
    
    new_hash = hashlib.pbkdf2_hmac('sha256', password.encode(), salt, 100000)
    return new_hash == hash
</code></pre>
<h2 id="use-cases-1"><a class="header" href="#use-cases-1">Use Cases</a></h2>
<h3 id="1-file-integrity-verification"><a class="header" href="#1-file-integrity-verification">1. File Integrity Verification</a></h3>
<pre><code class="language-bash"># Create checksum
sha256sum important_file.pdf &gt; checksum.txt

# Later, verify file hasn't changed
sha256sum -c checksum.txt
</code></pre>
<h3 id="2-git-commits"><a class="header" href="#2-git-commits">2. Git Commits</a></h3>
<p>Git uses SHA-1 (moving to SHA-256) to identify commits:</p>
<pre><code class="language-bash">git log --oneline
# a1b2c3d Fix bug in authentication
</code></pre>
<h3 id="3-digital-signatures"><a class="header" href="#3-digital-signatures">3. Digital Signatures</a></h3>
<p>Hash the message first, then sign the hash:</p>
<pre><code>message -&gt; hash -&gt; encrypt with private key -&gt; signature
</code></pre>
<h3 id="4-proof-of-work-blockchain"><a class="header" href="#4-proof-of-work-blockchain">4. Proof of Work (Blockchain)</a></h3>
<pre><code class="language-python">import hashlib
import time

def mine_block(data, difficulty=4):
    nonce = 0
    target = "0" * difficulty
    
    while True:
        message = f"{data}{nonce}"
        hash = hashlib.sha256(message.encode()).hexdigest()
        
        if hash.startswith(target):
            return nonce, hash
        
        nonce += 1

# Mine a block (find hash starting with 0000)
data = "Block data here"
nonce, hash = mine_block(data, difficulty=4)
print(f"Nonce: {nonce}, Hash: {hash}")
</code></pre>
<h3 id="5-message-deduplication"><a class="header" href="#5-message-deduplication">5. Message Deduplication</a></h3>
<pre><code class="language-python">import hashlib

def deduplicate_messages(messages):
    seen_hashes = set()
    unique_messages = []
    
    for msg in messages:
        msg_hash = hashlib.sha256(msg.encode()).hexdigest()
        if msg_hash not in seen_hashes:
            seen_hashes.add(msg_hash)
            unique_messages.append(msg)
    
    return unique_messages
</code></pre>
<h3 id="6-content-addressable-storage"><a class="header" href="#6-content-addressable-storage">6. Content-Addressable Storage</a></h3>
<pre><code class="language-python">import hashlib
import os

class ContentAddressableStorage:
    def __init__(self, storage_dir):
        self.storage_dir = storage_dir
        os.makedirs(storage_dir, exist_ok=True)
    
    def store(self, data):
        # Hash determines storage location
        hash = hashlib.sha256(data).hexdigest()
        path = os.path.join(self.storage_dir, hash)
        
        with open(path, 'wb') as f:
            f.write(data)
        
        return hash
    
    def retrieve(self, hash):
        path = os.path.join(self.storage_dir, hash)
        with open(path, 'rb') as f:
            return f.read()

# Usage
cas = ContentAddressableStorage('/tmp/cas')
content = b"Important document content"
hash = cas.store(content)
retrieved = cas.retrieve(hash)
</code></pre>
<h2 id="hash-comparison"><a class="header" href="#hash-comparison">Hash Comparison</a></h2>
<h3 id="performance-benchmark-python"><a class="header" href="#performance-benchmark-python">Performance Benchmark (Python)</a></h3>
<pre><code class="language-python">import hashlib
import time

data = b"x" * 1000000  # 1 MB of data

algorithms = ['md5', 'sha1', 'sha256', 'sha512', 'sha3_256', 'blake2b']

for algo in algorithms:
    start = time.time()
    for _ in range(100):
        hashlib.new(algo, data).digest()
    elapsed = time.time() - start
    print(f"{algo:12} {elapsed:.3f}s")

# Typical results:
# md5          0.125s  (fastest, but insecure)
# sha1         0.156s  (fast, but deprecated)
# blake2b      0.187s  (fast and secure)
# sha256       0.234s  (standard, secure)
# sha512       0.187s  (fast on 64-bit, secure)
# sha3_256     0.876s  (slower, secure)
</code></pre>
<h2 id="security-considerations-1"><a class="header" href="#security-considerations-1">Security Considerations</a></h2>
<h3 id="1-never-use-md5-or-sha-1-for-security"><a class="header" href="#1-never-use-md5-or-sha-1-for-security">1. Never Use MD5 or SHA-1 for Security</a></h3>
<pre><code class="language-python"># VULNERABLE - collision attacks exist
md5_hash = hashlib.md5(data).hexdigest()
sha1_hash = hashlib.sha1(data).hexdigest()

# USE INSTEAD
sha256_hash = hashlib.sha256(data).hexdigest()
</code></pre>
<h3 id="2-always-salt-passwords"><a class="header" href="#2-always-salt-passwords">2. Always Salt Passwords</a></h3>
<pre><code class="language-python"># BAD
password_hash = hashlib.sha256(password.encode()).hexdigest()

# GOOD
import bcrypt
password_hash = bcrypt.hashpw(password.encode(), bcrypt.gensalt())
</code></pre>
<h3 id="3-use-appropriate-hash-for-use-case"><a class="header" href="#3-use-appropriate-hash-for-use-case">3. Use Appropriate Hash for Use Case</a></h3>
<pre><code>File integrity:     SHA-256, BLAKE2
Password storage:   bcrypt, Argon2, PBKDF2
General purpose:    SHA-256, SHA-3, BLAKE2
High performance:   BLAKE2, BLAKE3
Cryptographic:      SHA-256, SHA-3
</code></pre>
<h3 id="4-timing-attacks"><a class="header" href="#4-timing-attacks">4. Timing Attacks</a></h3>
<pre><code class="language-python"># VULNERABLE - timing attack
if hash1 == hash2:
    return True

# SAFE - constant time comparison
import hmac
if hmac.compare_digest(hash1, hash2):
    return True
</code></pre>
<h3 id="5-hash-length-extension-attacks"><a class="header" href="#5-hash-length-extension-attacks">5. Hash Length Extension Attacks</a></h3>
<p>SHA-256 is vulnerable to length extension attacks. Use HMAC instead for authentication:</p>
<pre><code class="language-python"># VULNERABLE
auth_tag = sha256(secret + message)

# SAFE
import hmac
auth_tag = hmac.new(secret, message, hashlib.sha256).digest()
</code></pre>
<h2 id="best-practices-28"><a class="header" href="#best-practices-28">Best Practices</a></h2>
<h3 id="1-password-hashing-checklist"><a class="header" href="#1-password-hashing-checklist">1. Password Hashing Checklist</a></h3>
<pre><code class="language-python"># ✓ Use specialized password hash (bcrypt, Argon2)
# ✓ Use random salt (automatic in bcrypt/Argon2)
# ✓ Use sufficient work factor
# ✓ Use constant-time comparison
# ✓ Plan for rehashing when parameters change

from argon2 import PasswordHasher
import hmac

ph = PasswordHasher()

def hash_password(password):
    return ph.hash(password)

def verify_password(password, hash):
    try:
        ph.verify(hash, password)
        return True
    except:
        return False
</code></pre>
<h3 id="2-file-integrity"><a class="header" href="#2-file-integrity">2. File Integrity</a></h3>
<pre><code class="language-bash"># Generate checksums for all files
find . -type f -exec sha256sum {} \; &gt; checksums.txt

# Verify later
sha256sum -c checksums.txt
</code></pre>
<h3 id="3-secure-random-salt-generation"><a class="header" href="#3-secure-random-salt-generation">3. Secure Random Salt Generation</a></h3>
<pre><code class="language-python">import os

# Use cryptographically secure random
salt = os.urandom(16)  # 128 bits

# DON'T use regular random module
import random
salt = random.randbytes(16)  # NOT SECURE!
</code></pre>
<h3 id="4-database-schema-for-passwords"><a class="header" href="#4-database-schema-for-passwords">4. Database Schema for Passwords</a></h3>
<pre><code class="language-sql">CREATE TABLE users (
    id INT PRIMARY KEY,
    username VARCHAR(255) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,  -- Store full hash string
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    password_updated_at TIMESTAMP
);

-- bcrypt example:
-- password_hash: $2b$12$KIXx8Z9ByF7LHfG8z.yNH.Q5GF8Z9ByF7...

-- Argon2 example:
-- password_hash: $argon2id$v=19$m=65536,t=3,p=4$c29tZXNhbHQ$...
</code></pre>
<h2 id="common-mistakes"><a class="header" href="#common-mistakes">Common Mistakes</a></h2>
<h3 id="1-double-hashing"><a class="header" href="#1-double-hashing">1. Double Hashing</a></h3>
<pre><code class="language-python"># BAD - doesn't increase security
hash1 = sha256(password)
hash2 = sha256(hash1)  # No benefit!

# GOOD - use proper password hashing
hash = bcrypt.hashpw(password, bcrypt.gensalt())
</code></pre>
<h3 id="2-homemade-crypto"><a class="header" href="#2-homemade-crypto">2. Homemade Crypto</a></h3>
<pre><code class="language-python"># BAD - creating your own hash function
def my_hash(data):
    result = 0
    for byte in data:
        result = (result * 31 + byte) % 1000000007
    return result

# GOOD - use standard algorithms
import hashlib
hash = hashlib.sha256(data).hexdigest()
</code></pre>
<h3 id="3-insufficient-work-factor"><a class="header" href="#3-insufficient-work-factor">3. Insufficient Work Factor</a></h3>
<pre><code class="language-python"># BAD - too fast, vulnerable to brute force
hash = bcrypt.hashpw(password, bcrypt.gensalt(rounds=4))  # 2^4 = 16 iterations

# GOOD - sufficient work factor
hash = bcrypt.hashpw(password, bcrypt.gensalt(rounds=12))  # 2^12 = 4096 iterations
</code></pre>
<h2 id="eli10-7"><a class="header" href="#eli10-7">ELI10</a></h2>
<p>A hash function is like a magic blender for data:</p>
<ol>
<li><strong>You put something in</strong>: "Hello, World!"</li>
<li><strong>It blends it up</strong>: The blender scrambles everything</li>
<li><strong>You get a unique smoothie</strong>: "dffd6021bb2b..."</li>
</ol>
<p>Special properties:</p>
<ul>
<li><strong>Always the same</strong>: Same ingredients = Same smoothie</li>
<li><strong>One-way</strong>: Can't un-blend the smoothie to get ingredients back</li>
<li><strong>Tiny changes matter</strong>: "Hello, World!" vs "Hello, World?" = Completely different smoothies</li>
<li><strong>Same size</strong>: Whether you blend a strawberry or a watermelon, you always get the same size cup</li>
</ul>
<p><strong>For passwords</strong>, we use special slow blenders (bcrypt, Argon2):</p>
<ul>
<li>Regular blender: Makes 1 million smoothies per second (easy to guess passwords!)</li>
<li>Password blender: Makes 10 smoothies per second (hard to guess passwords!)</li>
</ul>
<p><strong>Salt</strong> is like adding random spices:</p>
<ul>
<li>Without salt: Everyone who uses "password123" gets the same smoothie</li>
<li>With salt: Everyone gets different random spices, so same password = different smoothies</li>
</ul>
<h2 id="further-resources-7"><a class="header" href="#further-resources-7">Further Resources</a></h2>
<ul>
<li><a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf">SHA-256 Specification (NIST)</a></li>
<li><a href="https://password-hashing.net/">Password Hashing Competition</a></li>
<li><a href="https://www.rfc-editor.org/rfc/rfc9106.html">Argon2 RFC 9106</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html">OWASP Password Storage Cheat Sheet</a></li>
<li><a href="https://blog.skullsecurity.org/2012/everything-you-need-to-know-about-hash-length-extension-attacks">Hash Length Extension Attacks</a></li>
<li><a href="https://github.com/pyca/bcrypt/">bcrypt Documentation</a></li>
<li><a href="https://argon2-cffi.readthedocs.io/">Argon2 Documentation</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="encryption-1"><a class="header" href="#encryption-1">Encryption</a></h1>
<h2 id="overview-36"><a class="header" href="#overview-36">Overview</a></h2>
<p>Encryption converts readable data (plaintext) into unreadable data (ciphertext) using mathematical algorithms and keys. Only those with the correct key can decrypt it.</p>
<h2 id="types-of-encryption"><a class="header" href="#types-of-encryption">Types of Encryption</a></h2>
<h3 id="symmetric-encryption"><a class="header" href="#symmetric-encryption">Symmetric Encryption</a></h3>
<p>Same key encrypts and decrypts:</p>
<pre><code>Plaintext + Key  [Encrypt] &gt; Ciphertext
Ciphertext + Key  [Decrypt] &gt; Plaintext
</code></pre>
<p><strong>Algorithms</strong>:</p>
<ul>
<li><strong>AES</strong> (Advanced Encryption Standard): Industry standard, 128/192/256-bit keys</li>
<li><strong>ChaCha20</strong>: Modern, fast, secure</li>
<li><strong>DES</strong>: Obsolete, 56-bit key (too short)</li>
</ul>
<p><strong>When to use</strong>: Database encryption, file encryption, internal communication</p>
<h3 id="asymmetric-encryption"><a class="header" href="#asymmetric-encryption">Asymmetric Encryption</a></h3>
<p>Different keys for encryption/decryption:</p>
<pre><code>Plaintext + Public Key  [Encrypt] &gt; Ciphertext
Ciphertext + Private Key  [Decrypt] &gt; Plaintext
</code></pre>
<p><strong>Algorithms</strong>:</p>
<ul>
<li><strong>RSA</strong>: Based on factoring difficulty, 2048/4096-bit keys</li>
<li><strong>ECC</strong> (Elliptic Curve): Shorter keys, same security as RSA</li>
<li><strong>Diffie-Hellman</strong>: Key exchange, not encryption</li>
</ul>
<p><strong>When to use</strong>: HTTPS, email encryption, digital signatures</p>
<h2 id="key-concepts-16"><a class="header" href="#key-concepts-16">Key Concepts</a></h2>
<h3 id="key-size"><a class="header" href="#key-size">Key Size</a></h3>
<pre><code>More bits = More security but slower

AES-128: 2^128 possible keys (feasible to break with quantum)
AES-256: 2^256 possible keys (quantum-resistant)
RSA-2048: H112-bit symmetric equivalent
ECC-256: H256-bit symmetric equivalent
</code></pre>
<h3 id="modes-of-operation-symmetric"><a class="header" href="#modes-of-operation-symmetric">Modes of Operation (Symmetric)</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Mode</th><th>Use</th><th>Properties</th></tr></thead><tbody>
<tr><td><strong>ECB</strong></td><td>L Never</td><td>Reveals patterns</td></tr>
<tr><td><strong>CBC</strong></td><td>File encryption</td><td>Needs IV, not parallel</td></tr>
<tr><td><strong>CTR</strong></td><td>Streaming</td><td>Parallelizable</td></tr>
<tr><td><strong>GCM</strong></td><td>Authenticated encryption</td><td>Authentication built-in</td></tr>
</tbody></table>
</div>
<h3 id="initialization-vector-iv"><a class="header" href="#initialization-vector-iv">Initialization Vector (IV)</a></h3>
<p>Random value ensuring same plaintext produces different ciphertext:</p>
<pre><code>Plaintext: "Hello"
IV1 + Key  [AES-CBC] &gt; "xK#$%"
IV2 + Key  [AES-CBC] &gt; "mN&amp;*@"  (different!)
</code></pre>
<h2 id="code-examples-1"><a class="header" href="#code-examples-1">Code Examples</a></h2>
<h3 id="python---symmetric-aes"><a class="header" href="#python---symmetric-aes">Python - Symmetric (AES)</a></h3>
<pre><code class="language-python">from cryptography.fernet import Fernet

# Generate key (keep secret!)
key = Fernet.generate_key()  # Save this securely
cipher = Fernet(key)

# Encrypt
plaintext = b"Secret message"
ciphertext = cipher.encrypt(plaintext)  # b'gAAAAABl...'

# Decrypt
plaintext = cipher.decrypt(ciphertext)  # b"Secret message"
</code></pre>
<h3 id="python---asymmetric-rsa"><a class="header" href="#python---asymmetric-rsa">Python - Asymmetric (RSA)</a></h3>
<pre><code class="language-python">from cryptography.hazmat.primitives.asymmetric import rsa, padding
from cryptography.hazmat.primitives import hashes

# Generate key pair
private_key = rsa.generate_private_key(
    public_exponent=65537,
    key_size=2048,
)
public_key = private_key.public_key()

# Encrypt with public key
ciphertext = public_key.encrypt(
    b"Secret",
    padding.OAEP(hashing=hashes.SHA256())
)

# Decrypt with private key
plaintext = private_key.decrypt(
    ciphertext,
    padding.OAEP(hashing=hashes.SHA256())
)
</code></pre>
<h3 id="javascript---aes-encryption"><a class="header" href="#javascript---aes-encryption">JavaScript - AES Encryption</a></h3>
<pre><code class="language-javascript">import crypto from 'crypto';

// Encrypt
const key = crypto.randomBytes(32);  // 256-bit key
const iv = crypto.randomBytes(16);   // 128-bit IV
const cipher = crypto.createCipheriv('aes-256-cbc', key, iv);

let ciphertext = cipher.update('Secret', 'utf8', 'hex');
ciphertext += cipher.final('hex');

// Decrypt
const decipher = crypto.createDecipheriv('aes-256-cbc', key, iv);
let plaintext = decipher.update(ciphertext, 'hex', 'utf8');
plaintext += decipher.final('utf8');
</code></pre>
<h2 id="common-algorithms-comparison"><a class="header" href="#common-algorithms-comparison">Common Algorithms Comparison</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Algorithm</th><th>Type</th><th>Speed</th><th>Security</th><th>Use Case</th></tr></thead><tbody>
<tr><td><strong>AES</strong></td><td>Symmetric</td><td>Fast</td><td>Very good</td><td>General encryption</td></tr>
<tr><td><strong>ChaCha20</strong></td><td>Symmetric</td><td>Very fast</td><td>Very good</td><td>Mobile/streaming</td></tr>
<tr><td><strong>RSA</strong></td><td>Asymmetric</td><td>Slow</td><td>Good</td><td>Key exchange, signatures</td></tr>
<tr><td><strong>ECC</strong></td><td>Asymmetric</td><td>Medium</td><td>Excellent</td><td>HTTPS, signatures</td></tr>
<tr><td><strong>DES</strong></td><td>Symmetric</td><td>Fast</td><td>L Broken</td><td>Legacy only</td></tr>
</tbody></table>
</div>
<h2 id="attacks-on-encryption"><a class="header" href="#attacks-on-encryption">Attacks on Encryption</a></h2>
<h3 id="brute-force"><a class="header" href="#brute-force">Brute Force</a></h3>
<p>Try all possible keys:</p>
<pre><code>Defense: Use strong key (256-bit AES)
Cost: 2^256 operations (infeasible)
</code></pre>
<h3 id="side-channel-attacks"><a class="header" href="#side-channel-attacks">Side-Channel Attacks</a></h3>
<p>Extract info from timing, power usage:</p>
<pre><code>Defense: Constant-time operations
</code></pre>
<h3 id="weak-random-number-generator"><a class="header" href="#weak-random-number-generator">Weak Random Number Generator</a></h3>
<p>Predictable keys:</p>
<pre><code>Defense: Use cryptographically secure RNG
</code></pre>
<h3 id="quantum-computing"><a class="header" href="#quantum-computing">Quantum Computing</a></h3>
<p>Threatens RSA, but not AES:</p>
<pre><code>Current RSA: 2048-bit
Post-quantum: Need other algorithms
AES-256: Still secure against quantum
</code></pre>
<h2 id="best-practices-29"><a class="header" href="#best-practices-29">Best Practices</a></h2>
<h3 id="1-choose-right-algorithm"><a class="header" href="#1-choose-right-algorithm">1. Choose Right Algorithm</a></h3>
<pre><code> AES-256 for symmetric
 RSA-2048/ECC-256 for asymmetric
 DES, MD5, SHA-1 (deprecated)
</code></pre>
<h3 id="2-secure-key-storage"><a class="header" href="#2-secure-key-storage">2. Secure Key Storage</a></h3>
<pre><code class="language-python"># Bad: Hardcoded key
key = "supersecret123"

# Good: Load from secure storage
key = os.environ.get('ENCRYPTION_KEY')
# Or use key management service (AWS KMS, HashiCorp Vault)
</code></pre>
<h3 id="3-use-authenticated-encryption"><a class="header" href="#3-use-authenticated-encryption">3. Use Authenticated Encryption</a></h3>
<pre><code class="language-python"># Use modes that verify integrity (GCM, authenticated encryption)
# Don't just encrypt without authentication
</code></pre>
<h3 id="4-random-ivs"><a class="header" href="#4-random-ivs">4. Random IVs</a></h3>
<pre><code class="language-python"># Generate new IV for each encryption
iv = os.urandom(16)  # Different each time
</code></pre>
<h2 id="key-exchange"><a class="header" href="#key-exchange">Key Exchange</a></h2>
<h3 id="diffie-hellman"><a class="header" href="#diffie-hellman">Diffie-Hellman</a></h3>
<p>Agree on shared secret over insecure channel:</p>
<pre><code>Alice: chooses a, sends: g^a mod p
Bob:   chooses b, sends: g^b mod p

Shared secret:
Alice: (g^b)^a mod p = g^ab mod p
Bob:   (g^a)^b mod p = g^ab mod p
</code></pre>
<h3 id="tls-handshake"><a class="header" href="#tls-handshake">TLS Handshake</a></h3>
<pre><code>1. Client hello
2. Server hello + certificate (contains public key)
3. Client generates pre-master secret, encrypts with public key
4. Both derive session key from pre-master secret
5. Encrypted communication begins
</code></pre>
<h2 id="eli10-8"><a class="header" href="#eli10-8">ELI10</a></h2>
<p>Think of encryption as a locked box:</p>
<p><strong>Symmetric</strong>:</p>
<ul>
<li>Same key locks and unlocks</li>
<li>Fast but you need to share the key somehow</li>
<li>Like: "Secret code 42" for both locking and unlocking</li>
</ul>
<p><strong>Asymmetric</strong>:</p>
<ul>
<li>Public key locks, private key unlocks</li>
<li>Like: Anyone can put a message in a mailbox (public), but only owner has the key (private)</li>
</ul>
<p><strong>Why both?</strong>:</p>
<ul>
<li>Asymmetric slower but solves key-sharing problem</li>
<li>Use asymmetric to exchange a symmetric key</li>
<li>Then use fast symmetric key for actual data</li>
</ul>
<h2 id="further-resources-8"><a class="header" href="#further-resources-8">Further Resources</a></h2>
<ul>
<li><a href="https://cryptography.io/">Cryptography.io Python</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html">OWASP Encryption Cheatsheet</a></li>
<li><a href="https://www.youtube.com/watch?v=Z8M2BTscoD4">3Blue1Brown Public Key Cryptography</a></li>
<li><a href="https://en.wikipedia.org/wiki/Advanced_Encryption_Standard">AES Explained</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="digital-signatures-2"><a class="header" href="#digital-signatures-2">Digital Signatures</a></h1>
<h2 id="overview-37"><a class="header" href="#overview-37">Overview</a></h2>
<p>A digital signature is a cryptographic mechanism that provides:</p>
<ul>
<li><strong>Authentication</strong>: Proves who created the signature</li>
<li><strong>Integrity</strong>: Detects any changes to the signed data</li>
<li><strong>Non-repudiation</strong>: Signer cannot deny signing (unlike HMAC)</li>
</ul>
<p>Digital signatures use <strong>asymmetric cryptography</strong> (public/private key pairs).</p>
<h2 id="digital-signature-vs-hmac"><a class="header" href="#digital-signature-vs-hmac">Digital Signature vs HMAC</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Feature</th><th>Digital Signature</th><th>HMAC</th></tr></thead><tbody>
<tr><td><strong>Keys</strong></td><td>Public/Private key pair</td><td>Shared secret key</td></tr>
<tr><td><strong>Verification</strong></td><td>Anyone with public key</td><td>Only parties with secret</td></tr>
<tr><td><strong>Non-repudiation</strong></td><td>Yes</td><td>No</td></tr>
<tr><td><strong>Performance</strong></td><td>Slower</td><td>Faster</td></tr>
<tr><td><strong>Key distribution</strong></td><td>Public key can be shared</td><td>Secret must be protected</td></tr>
<tr><td><strong>Use case</strong></td><td>Documents, software, certificates</td><td>API auth, sessions</td></tr>
</tbody></table>
</div>
<h2 id="how-digital-signatures-work"><a class="header" href="#how-digital-signatures-work">How Digital Signatures Work</a></h2>
<h3 id="signing-process"><a class="header" href="#signing-process">Signing Process</a></h3>
<pre><code>1. Hash the message
   Message → Hash Function → Digest

2. Encrypt digest with private key
   Digest → Private Key → Signature

3. Attach signature to message
   Message + Signature → Signed Document
</code></pre>
<h3 id="verification-process"><a class="header" href="#verification-process">Verification Process</a></h3>
<pre><code>1. Hash the received message
   Message → Hash Function → Digest₁

2. Decrypt signature with public key
   Signature → Public Key → Digest₂

3. Compare digests
   If Digest₁ == Digest₂ → Valid Signature
</code></pre>
<h3 id="visual-representation"><a class="header" href="#visual-representation">Visual Representation</a></h3>
<pre><code>SIGNING:
                    Message
                       |
                   Hash (SHA-256)
                       |
                    Digest
                       |
            Encrypt with Private Key
                       |
                   Signature
                       |
            Message + Signature


VERIFICATION:
            Message + Signature
                |           |
                |           |
           Hash (SHA-256)   Decrypt with Public Key
                |           |
             Digest₁     Digest₂
                |           |
                +-----+-----+
                      |
                  Compare
                      |
                Valid/Invalid
</code></pre>
<h2 id="rsa-signatures"><a class="header" href="#rsa-signatures">RSA Signatures</a></h2>
<h3 id="rsa-algorithm-overview"><a class="header" href="#rsa-algorithm-overview">RSA Algorithm Overview</a></h3>
<p>RSA uses modular arithmetic with large prime numbers:</p>
<ul>
<li><strong>Key Generation</strong>: Create public (e, n) and private (d, n) keys</li>
<li><strong>Signing</strong>: signature = (hash)^d mod n</li>
<li><strong>Verification</strong>: hash = (signature)^e mod n</li>
</ul>
<h3 id="generating-rsa-keys"><a class="header" href="#generating-rsa-keys">Generating RSA Keys</a></h3>
<h4 id="python-cryptography-library"><a class="header" href="#python-cryptography-library">Python (cryptography library)</a></h4>
<pre><code class="language-python">from cryptography.hazmat.primitives.asymmetric import rsa
from cryptography.hazmat.primitives import serialization

# Generate private key
private_key = rsa.generate_private_key(
    public_exponent=65537,
    key_size=2048,  # 2048 or 4096 bits
)

# Generate public key
public_key = private_key.public_key()

# Save private key
pem_private = private_key.private_bytes(
    encoding=serialization.Encoding.PEM,
    format=serialization.PrivateFormat.PKCS8,
    encryption_algorithm=serialization.NoEncryption()
)

with open('private_key.pem', 'wb') as f:
    f.write(pem_private)

# Save public key
pem_public = public_key.public_bytes(
    encoding=serialization.Encoding.PEM,
    format=serialization.PublicFormat.SubjectPublicKeyInfo
)

with open('public_key.pem', 'wb') as f:
    f.write(pem_public)
</code></pre>
<h4 id="openssl-bash"><a class="header" href="#openssl-bash">OpenSSL (Bash)</a></h4>
<pre><code class="language-bash"># Generate private key (2048-bit RSA)
openssl genrsa -out private_key.pem 2048

# Generate private key with password protection
openssl genrsa -aes256 -out private_key.pem 2048

# Extract public key from private key
openssl rsa -in private_key.pem -pubout -out public_key.pem

# Generate 4096-bit key (more secure)
openssl genrsa -out private_key.pem 4096

# View key details
openssl rsa -in private_key.pem -text -noout
</code></pre>
<h3 id="signing-with-rsa"><a class="header" href="#signing-with-rsa">Signing with RSA</a></h3>
<h4 id="python-example-1"><a class="header" href="#python-example-1">Python Example</a></h4>
<pre><code class="language-python">from cryptography.hazmat.primitives import hashes
from cryptography.hazmat.primitives.asymmetric import padding
from cryptography.hazmat.primitives import serialization

# Load private key
with open('private_key.pem', 'rb') as f:
    private_key = serialization.load_pem_private_key(
        f.read(),
        password=None
    )

# Message to sign
message = b"This is an important document"

# Sign message (RSA-PSS with SHA-256)
signature = private_key.sign(
    message,
    padding.PSS(
        mgf=padding.MGF1(hashes.SHA256()),
        salt_length=padding.PSS.MAX_LENGTH
    ),
    hashes.SHA256()
)

print(f"Signature: {signature.hex()}")
print(f"Signature length: {len(signature)} bytes")

# Save signature
with open('signature.bin', 'wb') as f:
    f.write(signature)
</code></pre>
<h4 id="openssl-example"><a class="header" href="#openssl-example">OpenSSL Example</a></h4>
<pre><code class="language-bash"># Sign a file
openssl dgst -sha256 -sign private_key.pem -out signature.bin document.txt

# Sign with different hash algorithms
openssl dgst -sha512 -sign private_key.pem -out signature.bin document.txt

# Create detached signature
openssl dgst -sha256 -sign private_key.pem -out document.sig document.pdf
</code></pre>
<h3 id="verifying-rsa-signatures"><a class="header" href="#verifying-rsa-signatures">Verifying RSA Signatures</a></h3>
<h4 id="python-example-2"><a class="header" href="#python-example-2">Python Example</a></h4>
<pre><code class="language-python">from cryptography.hazmat.primitives import hashes
from cryptography.hazmat.primitives.asymmetric import padding
from cryptography.hazmat.primitives import serialization
from cryptography.exceptions import InvalidSignature

# Load public key
with open('public_key.pem', 'rb') as f:
    public_key = serialization.load_pem_public_key(f.read())

# Load signature
with open('signature.bin', 'rb') as f:
    signature = f.read()

# Message to verify
message = b"This is an important document"

# Verify signature
try:
    public_key.verify(
        signature,
        message,
        padding.PSS(
            mgf=padding.MGF1(hashes.SHA256()),
            salt_length=padding.PSS.MAX_LENGTH
        ),
        hashes.SHA256()
    )
    print("✓ Signature is valid!")
except InvalidSignature:
    print("✗ Invalid signature!")

# Complete example
def verify_document(public_key_path, document, signature):
    with open(public_key_path, 'rb') as f:
        public_key = serialization.load_pem_public_key(f.read())
    
    try:
        public_key.verify(
            signature,
            document,
            padding.PSS(
                mgf=padding.MGF1(hashes.SHA256()),
                salt_length=padding.PSS.MAX_LENGTH
            ),
            hashes.SHA256()
        )
        return True
    except InvalidSignature:
        return False
</code></pre>
<h4 id="openssl-example-1"><a class="header" href="#openssl-example-1">OpenSSL Example</a></h4>
<pre><code class="language-bash"># Verify signature
openssl dgst -sha256 -verify public_key.pem -signature signature.bin document.txt

# Output:
# Verified OK  (if valid)
# Verification Failure  (if invalid)

# Verify detached signature
openssl dgst -sha256 -verify public_key.pem -signature document.sig document.pdf
</code></pre>
<h3 id="rsa-padding-schemes"><a class="header" href="#rsa-padding-schemes">RSA Padding Schemes</a></h3>
<h4 id="pkcs1-v15-legacy"><a class="header" href="#pkcs1-v15-legacy">PKCS#1 v1.5 (Legacy)</a></h4>
<pre><code class="language-python">from cryptography.hazmat.primitives.asymmetric import padding

# Sign with PKCS#1 v1.5 (not recommended)
signature = private_key.sign(
    message,
    padding.PKCS1v15(),
    hashes.SHA256()
)
</code></pre>
<h4 id="pss-recommended"><a class="header" href="#pss-recommended">PSS (Recommended)</a></h4>
<pre><code class="language-python"># Sign with PSS (Probabilistic Signature Scheme)
signature = private_key.sign(
    message,
    padding.PSS(
        mgf=padding.MGF1(hashes.SHA256()),
        salt_length=padding.PSS.MAX_LENGTH
    ),
    hashes.SHA256()
)
</code></pre>
<h2 id="ecdsa-elliptic-curve-digital-signature-algorithm"><a class="header" href="#ecdsa-elliptic-curve-digital-signature-algorithm">ECDSA (Elliptic Curve Digital Signature Algorithm)</a></h2>
<h3 id="overview-38"><a class="header" href="#overview-38">Overview</a></h3>
<p>ECDSA provides equivalent security to RSA with much smaller keys:</p>
<ul>
<li><strong>RSA 2048-bit</strong> ≈ <strong>ECDSA 224-bit</strong></li>
<li><strong>RSA 3072-bit</strong> ≈ <strong>ECDSA 256-bit</strong></li>
<li><strong>RSA 15360-bit</strong> ≈ <strong>ECDSA 512-bit</strong></li>
</ul>
<p><strong>Benefits:</strong></p>
<ul>
<li>Smaller keys</li>
<li>Faster signing</li>
<li>Less bandwidth</li>
<li>Less storage</li>
</ul>
<h3 id="common-curves"><a class="header" href="#common-curves">Common Curves</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Curve</th><th>Bits</th><th>Security</th><th>Use Case</th></tr></thead><tbody>
<tr><td><strong>P-256</strong> (secp256r1)</td><td>256</td><td>~128-bit</td><td>General purpose, TLS</td></tr>
<tr><td><strong>P-384</strong> (secp384r1)</td><td>384</td><td>~192-bit</td><td>High security</td></tr>
<tr><td><strong>P-521</strong> (secp521r1)</td><td>521</td><td>~256-bit</td><td>Maximum security</td></tr>
<tr><td><strong>secp256k1</strong></td><td>256</td><td>~128-bit</td><td>Bitcoin, cryptocurrencies</td></tr>
</tbody></table>
</div>
<h3 id="generating-ecdsa-keys"><a class="header" href="#generating-ecdsa-keys">Generating ECDSA Keys</a></h3>
<h4 id="python-example-3"><a class="header" href="#python-example-3">Python Example</a></h4>
<pre><code class="language-python">from cryptography.hazmat.primitives.asymmetric import ec
from cryptography.hazmat.primitives import serialization

# Generate private key (P-256 curve)
private_key = ec.generate_private_key(ec.SECP256R1())

# Extract public key
public_key = private_key.public_key()

# Save private key
pem_private = private_key.private_bytes(
    encoding=serialization.Encoding.PEM,
    format=serialization.PrivateFormat.PKCS8,
    encryption_algorithm=serialization.NoEncryption()
)

with open('ec_private_key.pem', 'wb') as f:
    f.write(pem_private)

# Save public key
pem_public = public_key.public_bytes(
    encoding=serialization.Encoding.PEM,
    format=serialization.PublicFormat.SubjectPublicKeyInfo
)

with open('ec_public_key.pem', 'wb') as f:
    f.write(pem_public)

# Different curves
# P-256 (most common)
key_p256 = ec.generate_private_key(ec.SECP256R1())

# P-384 (higher security)
key_p384 = ec.generate_private_key(ec.SECP384R1())

# P-521 (maximum security)
key_p521 = ec.generate_private_key(ec.SECP521R1())

# secp256k1 (Bitcoin)
key_secp256k1 = ec.generate_private_key(ec.SECP256K1())
</code></pre>
<h4 id="openssl-example-2"><a class="header" href="#openssl-example-2">OpenSSL Example</a></h4>
<pre><code class="language-bash"># Generate EC private key (P-256)
openssl ecparam -name prime256v1 -genkey -noout -out ec_private_key.pem

# Generate with P-384
openssl ecparam -name secp384r1 -genkey -noout -out ec_private_key.pem

# Generate with P-521
openssl ecparam -name secp521r1 -genkey -noout -out ec_private_key.pem

# Extract public key
openssl ec -in ec_private_key.pem -pubout -out ec_public_key.pem

# View key details
openssl ec -in ec_private_key.pem -text -noout

# List available curves
openssl ecparam -list_curves
</code></pre>
<h3 id="signing-with-ecdsa"><a class="header" href="#signing-with-ecdsa">Signing with ECDSA</a></h3>
<h4 id="python-example-4"><a class="header" href="#python-example-4">Python Example</a></h4>
<pre><code class="language-python">from cryptography.hazmat.primitives import hashes
from cryptography.hazmat.primitives.asymmetric import ec
from cryptography.hazmat.primitives import serialization

# Load private key
with open('ec_private_key.pem', 'rb') as f:
    private_key = serialization.load_pem_private_key(
        f.read(),
        password=None
    )

# Message to sign
message = b"ECDSA signature example"

# Sign message
signature = private_key.sign(
    message,
    ec.ECDSA(hashes.SHA256())
)

print(f"ECDSA Signature: {signature.hex()}")
print(f"Signature length: {len(signature)} bytes")

# For P-256, signature is ~64 bytes (vs ~256 bytes for RSA-2048!)
</code></pre>
<h4 id="openssl-example-3"><a class="header" href="#openssl-example-3">OpenSSL Example</a></h4>
<pre><code class="language-bash"># Sign with ECDSA
openssl dgst -sha256 -sign ec_private_key.pem -out ecdsa_signature.bin document.txt

# Verify ECDSA signature
openssl dgst -sha256 -verify ec_public_key.pem -signature ecdsa_signature.bin document.txt
</code></pre>
<h3 id="verifying-ecdsa-signatures"><a class="header" href="#verifying-ecdsa-signatures">Verifying ECDSA Signatures</a></h3>
<pre><code class="language-python">from cryptography.hazmat.primitives import hashes
from cryptography.hazmat.primitives.asymmetric import ec
from cryptography.hazmat.primitives import serialization
from cryptography.exceptions import InvalidSignature

# Load public key
with open('ec_public_key.pem', 'rb') as f:
    public_key = serialization.load_pem_public_key(f.read())

# Message and signature
message = b"ECDSA signature example"

with open('ecdsa_signature.bin', 'rb') as f:
    signature = f.read()

# Verify signature
try:
    public_key.verify(
        signature,
        message,
        ec.ECDSA(hashes.SHA256())
    )
    print("✓ ECDSA signature is valid!")
except InvalidSignature:
    print("✗ Invalid ECDSA signature!")
</code></pre>
<h2 id="eddsa-edwards-curve-digital-signature-algorithm"><a class="header" href="#eddsa-edwards-curve-digital-signature-algorithm">EdDSA (Edwards-curve Digital Signature Algorithm)</a></h2>
<h3 id="overview-39"><a class="header" href="#overview-39">Overview</a></h3>
<p>EdDSA is a modern signature scheme designed for high performance and security.</p>
<p><strong>Ed25519</strong> (most common):</p>
<ul>
<li>256-bit keys</li>
<li>Fast signing and verification</li>
<li>Deterministic (no random number needed)</li>
<li>Resistant to side-channel attacks</li>
</ul>
<h3 id="generating-ed25519-keys"><a class="header" href="#generating-ed25519-keys">Generating Ed25519 Keys</a></h3>
<pre><code class="language-python">from cryptography.hazmat.primitives.asymmetric import ed25519
from cryptography.hazmat.primitives import serialization

# Generate private key
private_key = ed25519.Ed25519PrivateKey.generate()

# Extract public key
public_key = private_key.public_key()

# Save private key
pem_private = private_key.private_bytes(
    encoding=serialization.Encoding.PEM,
    format=serialization.PrivateFormat.PKCS8,
    encryption_algorithm=serialization.NoEncryption()
)

with open('ed25519_private_key.pem', 'wb') as f:
    f.write(pem_private)

# Save public key
pem_public = public_key.public_bytes(
    encoding=serialization.Encoding.PEM,
    format=serialization.PublicFormat.SubjectPublicKeyInfo
)

with open('ed25519_public_key.pem', 'wb') as f:
    f.write(pem_public)

# Raw bytes format (32 bytes each)
private_bytes = private_key.private_bytes(
    encoding=serialization.Encoding.Raw,
    format=serialization.PrivateFormat.Raw,
    encryption_algorithm=serialization.NoEncryption()
)

public_bytes = public_key.public_bytes(
    encoding=serialization.Encoding.Raw,
    format=serialization.PublicFormat.Raw
)

print(f"Private key: {private_bytes.hex()} ({len(private_bytes)} bytes)")
print(f"Public key: {public_bytes.hex()} ({len(public_bytes)} bytes)")
</code></pre>
<h3 id="signing-with-ed25519"><a class="header" href="#signing-with-ed25519">Signing with Ed25519</a></h3>
<pre><code class="language-python">from cryptography.hazmat.primitives.asymmetric import ed25519

# Generate key
private_key = ed25519.Ed25519PrivateKey.generate()

# Message to sign
message = b"Ed25519 is fast and secure!"

# Sign (deterministic, no hash function needed)
signature = private_key.sign(message)

print(f"Ed25519 Signature: {signature.hex()}")
print(f"Signature length: {len(signature)} bytes")  # Always 64 bytes

# Verify
public_key = private_key.public_key()

try:
    public_key.verify(signature, message)
    print("✓ Signature valid!")
except:
    print("✗ Invalid signature!")
</code></pre>
<h3 id="performance-comparison-1"><a class="header" href="#performance-comparison-1">Performance Comparison</a></h3>
<pre><code class="language-python">import time
from cryptography.hazmat.primitives.asymmetric import rsa, ec, ed25519
from cryptography.hazmat.primitives import hashes
from cryptography.hazmat.primitives.asymmetric import padding

message = b"Performance test message"

# RSA
rsa_key = rsa.generate_private_key(public_exponent=65537, key_size=2048)
start = time.time()
for _ in range(1000):
    sig = rsa_key.sign(message, padding.PSS(mgf=padding.MGF1(hashes.SHA256()), 
                       salt_length=padding.PSS.MAX_LENGTH), hashes.SHA256())
rsa_time = time.time() - start

# ECDSA
ec_key = ec.generate_private_key(ec.SECP256R1())
start = time.time()
for _ in range(1000):
    sig = ec_key.sign(message, ec.ECDSA(hashes.SHA256()))
ecdsa_time = time.time() - start

# Ed25519
ed_key = ed25519.Ed25519PrivateKey.generate()
start = time.time()
for _ in range(1000):
    sig = ed_key.sign(message)
ed25519_time = time.time() - start

print(f"RSA-2048:  {rsa_time:.3f}s")
print(f"ECDSA-256: {ecdsa_time:.3f}s")
print(f"Ed25519:   {ed25519_time:.3f}s")

# Typical results:
# RSA-2048:  5.234s  (slowest)
# ECDSA-256: 1.876s  (fast)
# Ed25519:   0.156s  (fastest!)
</code></pre>
<h2 id="signature-verification"><a class="header" href="#signature-verification">Signature Verification</a></h2>
<h3 id="complete-verification-example"><a class="header" href="#complete-verification-example">Complete Verification Example</a></h3>
<pre><code class="language-python">from cryptography.hazmat.primitives import serialization
from cryptography.hazmat.primitives.asymmetric import rsa, padding
from cryptography.hazmat.primitives import hashes
from cryptography.exceptions import InvalidSignature

class DocumentSigner:
    def __init__(self, private_key_path=None, public_key_path=None):
        if private_key_path:
            with open(private_key_path, 'rb') as f:
                self.private_key = serialization.load_pem_private_key(
                    f.read(),
                    password=None
                )
        
        if public_key_path:
            with open(public_key_path, 'rb') as f:
                self.public_key = serialization.load_pem_public_key(f.read())
    
    def sign_document(self, document):
        signature = self.private_key.sign(
            document,
            padding.PSS(
                mgf=padding.MGF1(hashes.SHA256()),
                salt_length=padding.PSS.MAX_LENGTH
            ),
            hashes.SHA256()
        )
        return signature
    
    def verify_document(self, document, signature):
        try:
            self.public_key.verify(
                signature,
                document,
                padding.PSS(
                    mgf=padding.MGF1(hashes.SHA256()),
                    salt_length=padding.PSS.MAX_LENGTH
                ),
                hashes.SHA256()
            )
            return True, "Signature is valid"
        except InvalidSignature:
            return False, "Invalid signature - document may be tampered"
        except Exception as e:
            return False, f"Verification error: {str(e)}"
    
    def sign_file(self, filepath, signature_path):
        with open(filepath, 'rb') as f:
            document = f.read()
        
        signature = self.sign_document(document)
        
        with open(signature_path, 'wb') as f:
            f.write(signature)
        
        return signature
    
    def verify_file(self, filepath, signature_path):
        with open(filepath, 'rb') as f:
            document = f.read()
        
        with open(signature_path, 'rb') as f:
            signature = f.read()
        
        return self.verify_document(document, signature)

# Usage
# Signing
signer = DocumentSigner(private_key_path='private_key.pem')
document = b"Important contract: Alice pays Bob $1000"
signature = signer.sign_document(document)

# Verification
verifier = DocumentSigner(public_key_path='public_key.pem')
is_valid, message = verifier.verify_document(document, signature)
print(f"{message}")

# File signing
signer.sign_file('contract.pdf', 'contract.pdf.sig')
is_valid, message = verifier.verify_file('contract.pdf', 'contract.pdf.sig')
print(f"Contract verification: {message}")
</code></pre>
<h2 id="code-signing"><a class="header" href="#code-signing">Code Signing</a></h2>
<h3 id="signing-softwarescripts"><a class="header" href="#signing-softwarescripts">Signing Software/Scripts</a></h3>
<pre><code class="language-bash"># Sign a Python script
openssl dgst -sha256 -sign private_key.pem -out script.py.sig script.py

# Create a signed package
tar -czf package.tar.gz files/
openssl dgst -sha256 -sign private_key.pem -out package.tar.gz.sig package.tar.gz

# Verification script
#!/bin/bash
FILE=$1
SIG=$2
PUBKEY=$3

openssl dgst -sha256 -verify $PUBKEY -signature $SIG $FILE

if [ $? -eq 0 ]; then
    echo "✓ Signature verified - safe to run"
else
    echo "✗ Invalid signature - DO NOT RUN"
    exit 1
fi
</code></pre>
<h3 id="python-code-signing-example"><a class="header" href="#python-code-signing-example">Python Code Signing Example</a></h3>
<pre><code class="language-python">import os
import hashlib
from cryptography.hazmat.primitives import serialization
from cryptography.hazmat.primitives.asymmetric import rsa, padding
from cryptography.hazmat.primitives import hashes

class CodeSigner:
    def __init__(self, private_key_path):
        with open(private_key_path, 'rb') as f:
            self.private_key = serialization.load_pem_private_key(
                f.read(),
                password=None
            )
    
    def sign_file(self, filepath):
        # Read file
        with open(filepath, 'rb') as f:
            code = f.read()
        
        # Generate signature
        signature = self.private_key.sign(
            code,
            padding.PSS(
                mgf=padding.MGF1(hashes.SHA256()),
                salt_length=padding.PSS.MAX_LENGTH
            ),
            hashes.SHA256()
        )
        
        # Save signature
        sig_path = filepath + '.sig'
        with open(sig_path, 'wb') as f:
            f.write(signature)
        
        print(f"✓ Signed: {filepath}")
        print(f"✓ Signature: {sig_path}")
        
        return signature

class CodeVerifier:
    def __init__(self, public_key_path):
        with open(public_key_path, 'rb') as f:
            self.public_key = serialization.load_pem_public_key(f.read())
    
    def verify_file(self, filepath):
        sig_path = filepath + '.sig'
        
        # Read file and signature
        with open(filepath, 'rb') as f:
            code = f.read()
        
        with open(sig_path, 'rb') as f:
            signature = f.read()
        
        # Verify
        try:
            self.public_key.verify(
                signature,
                code,
                padding.PSS(
                    mgf=padding.MGF1(hashes.SHA256()),
                    salt_length=padding.PSS.MAX_LENGTH
                ),
                hashes.SHA256()
            )
            print(f"✓ Signature valid for {filepath}")
            return True
        except:
            print(f"✗ Invalid signature for {filepath}")
            return False

# Usage
signer = CodeSigner('private_key.pem')
signer.sign_file('important_script.py')

verifier = CodeVerifier('public_key.pem')
if verifier.verify_file('important_script.py'):
    # Safe to execute
    exec(open('important_script.py').read())
</code></pre>
<h3 id="macos-code-signing"><a class="header" href="#macos-code-signing">macOS Code Signing</a></h3>
<pre><code class="language-bash"># Sign application
codesign -s "Developer ID" MyApp.app

# Verify signature
codesign -v MyApp.app

# Deep verification
codesign -v --deep MyApp.app

# Display signature info
codesign -d -vv MyApp.app
</code></pre>
<h3 id="windows-code-signing"><a class="header" href="#windows-code-signing">Windows Code Signing</a></h3>
<pre><code class="language-powershell"># Sign executable with certificate
signtool sign /f certificate.pfx /p password /t http://timestamp.server.com app.exe

# Verify signature
signtool verify /pa app.exe
</code></pre>
<h2 id="security-considerations-2"><a class="header" href="#security-considerations-2">Security Considerations</a></h2>
<h3 id="1-key-size"><a class="header" href="#1-key-size">1. Key Size</a></h3>
<pre><code>RSA:
- Minimum: 2048 bits
- Recommended: 3072 bits
- High security: 4096 bits

ECDSA:
- Minimum: 256 bits (P-256)
- Recommended: 384 bits (P-384)
- High security: 521 bits (P-521)

Ed25519:
- Fixed: 256 bits (equivalent to ~128-bit security)
</code></pre>
<h3 id="2-hash-function"><a class="header" href="#2-hash-function">2. Hash Function</a></h3>
<pre><code class="language-python"># GOOD - SHA-256 or better
signature = private_key.sign(message, padding.PSS(...), hashes.SHA256())

# BETTER - SHA-512
signature = private_key.sign(message, padding.PSS(...), hashes.SHA512())

# BAD - SHA-1 (broken!)
signature = private_key.sign(message, padding.PSS(...), hashes.SHA1())
</code></pre>
<h3 id="3-random-number-generation"><a class="header" href="#3-random-number-generation">3. Random Number Generation</a></h3>
<pre><code class="language-python"># ECDSA requires good randomness
# Python's cryptography library handles this automatically

# NEVER implement your own random number generator!
# Use os.urandom() or secrets module for any manual crypto
import secrets
random_bytes = secrets.token_bytes(32)
</code></pre>
<h3 id="4-private-key-protection"><a class="header" href="#4-private-key-protection">4. Private Key Protection</a></h3>
<pre><code class="language-python"># Encrypt private key with password
from cryptography.hazmat.primitives import serialization

encrypted_pem = private_key.private_bytes(
    encoding=serialization.Encoding.PEM,
    format=serialization.PrivateFormat.PKCS8,
    encryption_algorithm=serialization.BestAvailableEncryption(b'strong-password')
)

# Load encrypted key
with open('encrypted_key.pem', 'rb') as f:
    private_key = serialization.load_pem_private_key(
        f.read(),
        password=b'strong-password'
    )
</code></pre>
<h3 id="5-signature-malleability"><a class="header" href="#5-signature-malleability">5. Signature Malleability</a></h3>
<pre><code>Some signature schemes allow multiple valid signatures for the same message.

Ed25519: NOT malleable (good!)
ECDSA: Can be malleable (use canonical form)
RSA-PSS: Probabilistic (different signatures each time, but all valid)
</code></pre>
<h2 id="best-practices-30"><a class="header" href="#best-practices-30">Best Practices</a></h2>
<h3 id="1-use-modern-algorithms"><a class="header" href="#1-use-modern-algorithms">1. Use Modern Algorithms</a></h3>
<pre><code>✓ RSA-PSS (not PKCS#1 v1.5)
✓ ECDSA with P-256 or better
✓ Ed25519 (best choice for new systems)
✗ DSA (obsolete)
✗ RSA with PKCS#1 v1.5 (vulnerable)
</code></pre>
<h3 id="2-protect-private-keys"><a class="header" href="#2-protect-private-keys">2. Protect Private Keys</a></h3>
<pre><code>- Never commit to version control
- Use hardware security modules (HSM) for critical keys
- Use key management services (AWS KMS, Azure Key Vault)
- Encrypt keys at rest
- Limit access with proper permissions
</code></pre>
<h3 id="3-include-metadata"><a class="header" href="#3-include-metadata">3. Include Metadata</a></h3>
<pre><code class="language-python">import json
import time

def create_signed_document(content, private_key):
    metadata = {
        'content': content,
        'timestamp': int(time.time()),
        'signer': 'John Doe',
        'version': '1.0'
    }
    
    message = json.dumps(metadata, sort_keys=True).encode()
    signature = private_key.sign(message, ...)
    
    return {
        'metadata': metadata,
        'signature': signature.hex()
    }
</code></pre>
<h3 id="4-timestamp-signatures"><a class="header" href="#4-timestamp-signatures">4. Timestamp Signatures</a></h3>
<pre><code class="language-python"># Include timestamp to prevent replay attacks
import time

def sign_with_timestamp(message, private_key):
    timestamp = str(int(time.time()))
    data = f"{timestamp}:{message}".encode()
    signature = private_key.sign(data, ...)
    
    return {
        'message': message,
        'timestamp': timestamp,
        'signature': signature.hex()
    }

def verify_with_timestamp(signed_data, public_key, max_age=3600):
    timestamp = int(signed_data['timestamp'])
    current = int(time.time())
    
    # Check if too old
    if current - timestamp &gt; max_age:
        return False, "Signature expired"
    
    # Verify signature
    data = f"{signed_data['timestamp']}:{signed_data['message']}".encode()
    # ... verify logic
</code></pre>
<h2 id="common-mistakes-1"><a class="header" href="#common-mistakes-1">Common Mistakes</a></h2>
<h3 id="1-signing-hash-vs-message"><a class="header" href="#1-signing-hash-vs-message">1. Signing Hash vs Message</a></h3>
<pre><code class="language-python"># WRONG - signing hash manually
hash_digest = hashlib.sha256(message).digest()
signature = private_key.sign(hash_digest, ...)  # May not work!

# RIGHT - let library handle hashing
signature = private_key.sign(message, ..., hashes.SHA256())
</code></pre>
<h3 id="2-not-validating-signatures"><a class="header" href="#2-not-validating-signatures">2. Not Validating Signatures</a></h3>
<pre><code class="language-python"># WRONG - trusting unsigned data
data = receive_data()
process(data)  # Danger!

# RIGHT - verify signature first
data, signature = receive_data_and_signature()
if verify_signature(data, signature):
    process(data)
else:
    reject()
</code></pre>
<h3 id="3-exposing-private-keys"><a class="header" href="#3-exposing-private-keys">3. Exposing Private Keys</a></h3>
<pre><code class="language-python"># WRONG
private_key = "-----BEGIN PRIVATE KEY-----\n..."  # Hardcoded!

# RIGHT
import os
key_path = os.environ.get('PRIVATE_KEY_PATH')
with open(key_path, 'rb') as f:
    private_key = load_key(f.read())
</code></pre>
<h2 id="eli10-9"><a class="header" href="#eli10-9">ELI10</a></h2>
<p>Digital signatures are like a special seal that only you can make:</p>
<p><strong>Regular signature (on paper):</strong></p>
<ul>
<li>Anyone can try to copy your signature</li>
<li>Hard to prove it's really yours</li>
</ul>
<p><strong>Digital signature:</strong></p>
<ol>
<li>You have a special "stamp" that only you own (private key)</li>
<li>Anyone can see your "stamp pattern" (public key)</li>
<li>When you sign a document:
<ul>
<li>You use your secret stamp to make a unique mark</li>
<li>This mark is different for every document</li>
</ul>
</li>
<li>Others can verify:
<ul>
<li>They use your public stamp pattern</li>
<li>If it matches, they know YOU signed it</li>
<li>Nobody else could have made that exact mark!</li>
</ul>
</li>
</ol>
<p><strong>Why it's secure:</strong></p>
<ul>
<li>Your secret stamp is like a lock that only you can use</li>
<li>The public pattern lets others check your work</li>
<li>Even if someone copies the signed document, they can't change it without your secret stamp!</li>
</ul>
<p><strong>Real-world example:</strong>
When you download software, the developer signs it:</p>
<ul>
<li>✓ You can verify it's really from them</li>
<li>✓ Nobody tampered with the software</li>
<li>✓ The developer can't deny they released it</li>
</ul>
<p><strong>Different from HMAC:</strong></p>
<ul>
<li>HMAC: Shared secret (like both having the same password)</li>
<li>Digital Signature: Private/public keys (like a lock and key everyone can see fits)</li>
</ul>
<h2 id="further-resources-9"><a class="header" href="#further-resources-9">Further Resources</a></h2>
<ul>
<li><a href="https://www.youtube.com/watch?v=wXB-V_Keiu8">RSA Cryptography Explained</a></li>
<li><a href="https://blog.cloudflare.com/ecdsa-the-digital-signature-algorithm-of-a-better-internet/">ECDSA Deep Dive</a></li>
<li><a href="https://ed25519.cr.yp.to/">Ed25519 Specification</a></li>
<li><a href="https://csrc.nist.gov/publications/detail/fips/186/4/final">Digital Signatures Standard (DSS)</a></li>
<li><a href="https://www.schneier.com/books/cryptography-engineering/">Cryptography Engineering (Book)</a></li>
<li><a href="https://cryptography.io/en/latest/">Python Cryptography Library</a></li>
<li><a href="https://www.openssl.org/docs/man1.1.1/man1/">OpenSSL Command Reference</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="x509-certificates-and-pki"><a class="header" href="#x509-certificates-and-pki">X.509 Certificates and PKI</a></h1>
<h2 id="overview-40"><a class="header" href="#overview-40">Overview</a></h2>
<p>X.509 certificates are digital documents that bind public keys to identities. They enable:</p>
<ul>
<li><strong>Authentication</strong>: Verify identity of servers/users</li>
<li><strong>Encryption</strong>: Establish secure connections</li>
<li><strong>Trust</strong>: Chain of trust through Certificate Authorities</li>
</ul>
<h2 id="x509-certificate-structure"><a class="header" href="#x509-certificate-structure">X.509 Certificate Structure</a></h2>
<h3 id="basic-components"><a class="header" href="#basic-components">Basic Components</a></h3>
<pre><code>Certificate:
  ├── Version (v3)
  ├── Serial Number (unique identifier)
  ├── Signature Algorithm (SHA-256 with RSA)
  ├── Issuer (who issued the certificate)
  ├── Validity Period
  │   ├── Not Before (start date)
  │   └── Not After (expiration date)
  ├── Subject (who the certificate is for)
  ├── Subject Public Key Info
  │   ├── Algorithm (RSA, ECDSA, etc.)
  │   └── Public Key (actual key data)
  ├── Extensions (v3)
  │   ├── Key Usage
  │   ├── Subject Alternative Names (SANs)
  │   ├── Basic Constraints
  │   └── Authority Key Identifier
  └── Signature (CA's signature)
</code></pre>
<h3 id="certificate-fields"><a class="header" href="#certificate-fields">Certificate Fields</a></h3>
<pre><code>Subject: CN=example.com, O=Example Inc, C=US
  CN = Common Name (domain or person name)
  O  = Organization
  OU = Organizational Unit
  C  = Country
  ST = State/Province
  L  = Locality/City

Issuer: CN=Let's Encrypt Authority, O=Let's Encrypt, C=US
  (Who signed this certificate)

Validity:
  Not Before: Jan 1 00:00:00 2024 GMT
  Not After:  Apr 1 23:59:59 2024 GMT
  (Certificate valid period)

Public Key Algorithm: RSA 2048-bit
  (Type and size of public key)

Signature Algorithm: SHA-256 with RSA
  (How CA signed the certificate)
</code></pre>
<h3 id="visual-representation-1"><a class="header" href="#visual-representation-1">Visual Representation</a></h3>
<pre><code>┌─────────────────────────────────────┐
│      X.509 Certificate              │
├─────────────────────────────────────┤
│ Version: 3                          │
│ Serial: 04:92:7f:63:ab:02:1e...     │
│                                     │
│ Issuer: CN=Let's Encrypt           │
│ Subject: CN=example.com             │
│                                     │
│ Valid: 2024-01-01 to 2024-04-01    │
│                                     │
│ Public Key: [RSA 2048-bit]         │
│   65537                             │
│   00:b8:7f:4e:91...                │
│                                     │
│ Extensions:                         │
│   - Key Usage: Digital Signature   │
│   - SANs: example.com, *.example.com│
│   - Basic Constraints: CA:FALSE    │
│                                     │
│ Signature Algorithm: sha256RSA     │
│ Signature: [CA's signature]        │
│   3a:7b:8c:9d...                   │
└─────────────────────────────────────┘
</code></pre>
<h2 id="certificate-creation"><a class="header" href="#certificate-creation">Certificate Creation</a></h2>
<h3 id="creating-a-self-signed-certificate"><a class="header" href="#creating-a-self-signed-certificate">Creating a Self-Signed Certificate</a></h3>
<h4 id="openssl-bash-1"><a class="header" href="#openssl-bash-1">OpenSSL (Bash)</a></h4>
<pre><code class="language-bash"># Generate private key and self-signed certificate in one command
openssl req -x509 -newkey rsa:2048 -keyout key.pem -out cert.pem -days 365 -nodes \
  -subj "/C=US/ST=California/L=San Francisco/O=Example Inc/CN=example.com"

# Breakdown:
# -x509: Create self-signed certificate
# -newkey rsa:2048: Generate new 2048-bit RSA key
# -keyout: Output private key file
# -out: Output certificate file
# -days: Certificate validity period
# -nodes: Don't encrypt private key
# -subj: Certificate subject information

# View certificate details
openssl x509 -in cert.pem -text -noout

# Generate key and certificate separately
openssl genrsa -out key.pem 2048
openssl req -new -x509 -key key.pem -out cert.pem -days 365 \
  -subj "/CN=example.com"
</code></pre>
<h4 id="python-1"><a class="header" href="#python-1">Python</a></h4>
<pre><code class="language-python">from cryptography import x509
from cryptography.x509.oid import NameOID, ExtensionOID
from cryptography.hazmat.primitives import hashes
from cryptography.hazmat.primitives.asymmetric import rsa
from cryptography.hazmat.primitives import serialization
import datetime

# Generate private key
private_key = rsa.generate_private_key(
    public_exponent=65537,
    key_size=2048,
)

# Create subject and issuer (same for self-signed)
subject = issuer = x509.Name([
    x509.NameAttribute(NameOID.COUNTRY_NAME, "US"),
    x509.NameAttribute(NameOID.STATE_OR_PROVINCE_NAME, "California"),
    x509.NameAttribute(NameOID.LOCALITY_NAME, "San Francisco"),
    x509.NameAttribute(NameOID.ORGANIZATION_NAME, "Example Inc"),
    x509.NameAttribute(NameOID.COMMON_NAME, "example.com"),
])

# Build certificate
cert = x509.CertificateBuilder().subject_name(
    subject
).issuer_name(
    issuer
).public_key(
    private_key.public_key()
).serial_number(
    x509.random_serial_number()
).not_valid_before(
    datetime.datetime.utcnow()
).not_valid_after(
    datetime.datetime.utcnow() + datetime.timedelta(days=365)
).add_extension(
    x509.SubjectAlternativeName([
        x509.DNSName("example.com"),
        x509.DNSName("www.example.com"),
    ]),
    critical=False,
).sign(private_key, hashes.SHA256())

# Save certificate
with open("cert.pem", "wb") as f:
    f.write(cert.public_bytes(serialization.Encoding.PEM))

# Save private key
with open("key.pem", "wb") as f:
    f.write(private_key.private_bytes(
        encoding=serialization.Encoding.PEM,
        format=serialization.PrivateFormat.PKCS8,
        encryption_algorithm=serialization.NoEncryption()
    ))

print("Certificate created successfully!")
</code></pre>
<h3 id="creating-a-certificate-signing-request-csr"><a class="header" href="#creating-a-certificate-signing-request-csr">Creating a Certificate Signing Request (CSR)</a></h3>
<h4 id="openssl"><a class="header" href="#openssl">OpenSSL</a></h4>
<pre><code class="language-bash"># Generate private key
openssl genrsa -out server.key 2048

# Create CSR
openssl req -new -key server.key -out server.csr \
  -subj "/C=US/ST=CA/L=San Francisco/O=Example Inc/CN=example.com"

# View CSR
openssl req -in server.csr -text -noout

# Create CSR with Subject Alternative Names (using config file)
cat &gt; san.cnf &lt;&lt;-END
[req]
default_bits = 2048
prompt = no
default_md = sha256
distinguished_name = dn
req_extensions = v3_req

[dn]
C=US
ST=CA
L=San Francisco
O=Example Inc
CN=example.com

[v3_req]
subjectAltName = @alt_names

[alt_names]
DNS.1 = example.com
DNS.2 = www.example.com
DNS.3 = *.example.com
END

openssl req -new -key server.key -out server.csr -config san.cnf

# Verify CSR
openssl req -in server.csr -noout -verify
</code></pre>
<h4 id="python-2"><a class="header" href="#python-2">Python</a></h4>
<pre><code class="language-python">from cryptography import x509
from cryptography.x509.oid import NameOID
from cryptography.hazmat.primitives import hashes
from cryptography.hazmat.primitives.asymmetric import rsa
from cryptography.hazmat.primitives import serialization

# Generate private key
private_key = rsa.generate_private_key(
    public_exponent=65537,
    key_size=2048,
)

# Build CSR
csr = x509.CertificateSigningRequestBuilder().subject_name(x509.Name([
    x509.NameAttribute(NameOID.COUNTRY_NAME, "US"),
    x509.NameAttribute(NameOID.STATE_OR_PROVINCE_NAME, "California"),
    x509.NameAttribute(NameOID.ORGANIZATION_NAME, "Example Inc"),
    x509.NameAttribute(NameOID.COMMON_NAME, "example.com"),
])).add_extension(
    x509.SubjectAlternativeName([
        x509.DNSName("example.com"),
        x509.DNSName("www.example.com"),
        x509.DNSName("*.example.com"),
    ]),
    critical=False,
).sign(private_key, hashes.SHA256())

# Save CSR
with open("server.csr", "wb") as f:
    f.write(csr.public_bytes(serialization.Encoding.PEM))

print("CSR created successfully!")
</code></pre>
<h2 id="certificate-authorities-cas"><a class="header" href="#certificate-authorities-cas">Certificate Authorities (CAs)</a></h2>
<h3 id="ca-hierarchy"><a class="header" href="#ca-hierarchy">CA Hierarchy</a></h3>
<pre><code>┌────────────────────────────┐
│      Root CA               │
│   (Self-signed)            │
│   Trust Anchor             │
└─────────────┬──────────────┘
              │
    ┌─────────┴─────────┐
    │                   │
┌───▼──────────┐  ┌────▼───────────┐
│ Intermediate │  │ Intermediate   │
│ CA #1        │  │ CA #2          │
└───┬──────────┘  └────┬───────────┘
    │                  │
┌───▼──────┐     ┌────▼──────┐
│ End-User │     │ End-User  │
│ Cert #1  │     │ Cert #2   │
└──────────┘     └───────────┘
</code></pre>
<h3 id="trust-chain"><a class="header" href="#trust-chain">Trust Chain</a></h3>
<pre><code>End-user certificate (example.com)
  ↓ Issued by
Intermediate CA certificate
  ↓ Issued by
Root CA certificate (in browser trust store)
  ✓ Trusted
</code></pre>
<h3 id="setting-up-a-ca"><a class="header" href="#setting-up-a-ca">Setting Up a CA</a></h3>
<h4 id="create-root-ca"><a class="header" href="#create-root-ca">Create Root CA</a></h4>
<pre><code class="language-bash"># Generate Root CA private key
openssl genrsa -aes256 -out rootCA.key 4096

# Create Root CA certificate
openssl req -x509 -new -nodes -key rootCA.key -sha256 -days 3650 \
  -out rootCA.crt \
  -subj "/C=US/ST=CA/O=Example Inc/CN=Example Root CA"

# View Root CA certificate
openssl x509 -in rootCA.crt -text -noout
</code></pre>
<h4 id="sign-certificate-with-ca"><a class="header" href="#sign-certificate-with-ca">Sign Certificate with CA</a></h4>
<pre><code class="language-bash"># You have: server.csr (from earlier)
# You have: rootCA.key and rootCA.crt

# Create extensions configuration
echo "
[ v3_req ]
basicConstraints = CA:FALSE
keyUsage = nonRepudiation, digitalSignature, keyEncipherment
subjectAltName = @alt_names

[ alt_names ]
DNS.1 = example.com
DNS.2 = www.example.com
DNS.3 = *.example.com
" &gt; server_ext.cnf

# Sign CSR with CA
openssl x509 -req -in server.csr \
  -CA rootCA.crt -CAkey rootCA.key -CAcreateserial \
  -out server.crt -days 365 -sha256 \
  -extfile server_ext.cnf -extensions v3_req

# View signed certificate
openssl x509 -in server.crt -text -noout

# Verify certificate against CA
openssl verify -CAfile rootCA.crt server.crt
</code></pre>
<h4 id="python-ca-implementation"><a class="header" href="#python-ca-implementation">Python CA Implementation</a></h4>
<pre><code class="language-python">from cryptography import x509
from cryptography.x509.oid import NameOID, ExtensionOID
from cryptography.hazmat.primitives import hashes
from cryptography.hazmat.primitives.asymmetric import rsa
from cryptography.hazmat.primitives import serialization
import datetime

class CertificateAuthority:
    def __init__(self):
        # Generate CA private key
        self.ca_key = rsa.generate_private_key(
            public_exponent=65537,
            key_size=4096,
        )

        # Create CA certificate
        subject = issuer = x509.Name([
            x509.NameAttribute(NameOID.COUNTRY_NAME, "US"),
            x509.NameAttribute(NameOID.ORGANIZATION_NAME, "Example Inc"),
            x509.NameAttribute(NameOID.COMMON_NAME, "Example Root CA"),
        ])

        self.ca_cert = x509.CertificateBuilder().subject_name(
            subject
        ).issuer_name(
            issuer
        ).public_key(
            self.ca_key.public_key()
        ).serial_number(
            x509.random_serial_number()
        ).not_valid_before(
            datetime.datetime.utcnow()
        ).not_valid_after(
            datetime.datetime.utcnow() + datetime.timedelta(days=3650)
        ).add_extension(
            x509.BasicConstraints(ca=True, path_length=None),
            critical=True,
        ).add_extension(
            x509.KeyUsage(
                digital_signature=True,
                key_cert_sign=True,
                crl_sign=True,
                key_encipherment=False,
                content_commitment=False,
                data_encipherment=False,
                key_agreement=False,
                encipher_only=False,
                decipher_only=False,
            ),
            critical=True,
        ).sign(self.ca_key, hashes.SHA256())

    def issue_certificate(self, csr, validity_days=365):
        """Issue a certificate from a CSR"""
        cert = x509.CertificateBuilder().subject_name(
            csr.subject
        ).issuer_name(
            self.ca_cert.subject
        ).public_key(
            csr.public_key()
        ).serial_number(
            x509.random_serial_number()
        ).not_valid_before(
            datetime.datetime.utcnow()
        ).not_valid_after(
            datetime.datetime.utcnow() + datetime.timedelta(days=validity_days)
        ).add_extension(
            x509.BasicConstraints(ca=False, path_length=None),
            critical=True,
        ).add_extension(
            x509.KeyUsage(
                digital_signature=True,
                key_encipherment=True,
                key_cert_sign=False,
                crl_sign=False,
                content_commitment=False,
                data_encipherment=False,
                key_agreement=False,
                encipher_only=False,
                decipher_only=False,
            ),
            critical=True,
        )

        # Copy extensions from CSR
        for extension in csr.extensions:
            cert = cert.add_extension(extension.value, extension.critical)

        # Sign with CA key
        return cert.sign(self.ca_key, hashes.SHA256())

    def save_ca_cert(self, filename):
        with open(filename, "wb") as f:
            f.write(self.ca_cert.public_bytes(serialization.Encoding.PEM))

    def save_ca_key(self, filename, password=None):
        encryption = serialization.NoEncryption()
        if password:
            encryption = serialization.BestAvailableEncryption(password)

        with open(filename, "wb") as f:
            f.write(self.ca_key.private_bytes(
                encoding=serialization.Encoding.PEM,
                format=serialization.PrivateFormat.PKCS8,
                encryption_algorithm=encryption
            ))

# Usage
ca = CertificateAuthority()
ca.save_ca_cert("ca.crt")
ca.save_ca_key("ca.key", password=b"secure-password")

# Load and sign a CSR
with open("server.csr", "rb") as f:
    csr = x509.load_pem_x509_csr(f.read())

cert = ca.issue_certificate(csr, validity_days=365)

with open("server.crt", "wb") as f:
    f.write(cert.public_bytes(serialization.Encoding.PEM))

print("Certificate issued successfully!")
</code></pre>
<h2 id="certificate-chains"><a class="header" href="#certificate-chains">Certificate Chains</a></h2>
<h3 id="understanding-certificate-chains"><a class="header" href="#understanding-certificate-chains">Understanding Certificate Chains</a></h3>
<pre><code>┌─────────────────────────────────┐
│  Server Certificate             │
│  Subject: CN=example.com        │
│  Issuer: CN=Intermediate CA     │
│  [Public Key]                   │
│  [Signature by Intermediate]    │
└────────────┬────────────────────┘
             │ Verified by
┌────────────▼────────────────────┐
│  Intermediate Certificate       │
│  Subject: CN=Intermediate CA    │
│  Issuer: CN=Root CA             │
│  [Public Key]                   │
│  [Signature by Root]            │
└────────────┬────────────────────┘
             │ Verified by
┌────────────▼────────────────────┐
│  Root Certificate               │
│  Subject: CN=Root CA            │
│  Issuer: CN=Root CA (self)      │
│  [Public Key]                   │
│  [Self Signature]               │
│  ✓ In Trust Store               │
└─────────────────────────────────┘
</code></pre>
<h3 id="building-certificate-chain"><a class="header" href="#building-certificate-chain">Building Certificate Chain</a></h3>
<pre><code class="language-bash"># Create chain file (server cert + intermediate cert)
cat server.crt intermediate.crt &gt; fullchain.pem

# Or with root CA (not usually needed)
cat server.crt intermediate.crt rootCA.crt &gt; fullchain.pem

# Verify chain
openssl verify -CAfile rootCA.crt -untrusted intermediate.crt server.crt

# Display certificate chain
openssl s_client -connect example.com:443 -showcerts
</code></pre>
<h3 id="verifying-certificate-chain-in-python"><a class="header" href="#verifying-certificate-chain-in-python">Verifying Certificate Chain in Python</a></h3>
<pre><code class="language-python">from cryptography import x509
from cryptography.hazmat.primitives import serialization
from cryptography.hazmat.primitives.asymmetric import padding
from cryptography.hazmat.primitives import hashes
from cryptography.exceptions import InvalidSignature

def verify_certificate_chain(cert_chain):
    """
    Verify a certificate chain
    cert_chain: list of certificates [leaf, intermediate, ..., root]
    """
    for i in range(len(cert_chain) - 1):
        cert = cert_chain[i]
        issuer_cert = cert_chain[i + 1]

        # Verify issuer name matches
        if cert.issuer != issuer_cert.subject:
            return False, f"Issuer mismatch at level {i}"

        # Verify signature
        try:
            issuer_public_key = issuer_cert.public_key()
            issuer_public_key.verify(
                cert.signature,
                cert.tbs_certificate_bytes,
                padding.PKCS1v15(),
                cert.signature_hash_algorithm,
            )
        except InvalidSignature:
            return False, f"Invalid signature at level {i}"

        # Verify validity period
        import datetime
        now = datetime.datetime.utcnow()
        if now &lt; cert.not_valid_before or now &gt; cert.not_valid_after:
            return False, f"Certificate expired or not yet valid at level {i}"

    return True, "Chain verified successfully"

# Load certificates
certs = []
for cert_file in ['server.crt', 'intermediate.crt', 'root.crt']:
    with open(cert_file, 'rb') as f:
        cert = x509.load_pem_x509_certificate(f.read())
        certs.append(cert)

# Verify chain
is_valid, message = verify_certificate_chain(certs)
print(message)
</code></pre>
<h2 id="lets-encrypt"><a class="header" href="#lets-encrypt">Let's Encrypt</a></h2>
<h3 id="overview-41"><a class="header" href="#overview-41">Overview</a></h3>
<p>Let's Encrypt is a free, automated Certificate Authority providing:</p>
<ul>
<li>Free SSL/TLS certificates</li>
<li>90-day validity (encourages automation)</li>
<li>Domain Validation (DV) only</li>
<li>Automated renewal</li>
</ul>
<h3 id="acme-protocol"><a class="header" href="#acme-protocol">ACME Protocol</a></h3>
<pre><code>1. Client requests certificate for example.com

2. Let's Encrypt challenges ownership:
   - HTTP-01: Place file at http://example.com/.well-known/acme-challenge/
   - DNS-01: Add TXT record to _acme-challenge.example.com
   - TLS-ALPN-01: Configure TLS server with special certificate

3. Let's Encrypt verifies challenge

4. If successful, issues certificate

5. Client installs certificate

6. Automated renewal before 90-day expiration
</code></pre>
<h3 id="using-certbot"><a class="header" href="#using-certbot">Using Certbot</a></h3>
<pre><code class="language-bash"># Install certbot
sudo apt-get install certbot

# Obtain certificate (standalone)
sudo certbot certonly --standalone -d example.com -d www.example.com

# Obtain certificate (webroot - site already running)
sudo certbot certonly --webroot -w /var/www/html -d example.com

# Obtain certificate (DNS challenge)
sudo certbot certonly --manual --preferred-challenges dns -d example.com

# Obtain certificate (with automatic nginx configuration)
sudo certbot --nginx -d example.com -d www.example.com

# Obtain certificate (with automatic apache configuration)
sudo certbot --apache -d example.com

# List certificates
sudo certbot certificates

# Renew certificates (dry run)
sudo certbot renew --dry-run

# Renew certificates
sudo certbot renew

# Revoke certificate
sudo certbot revoke --cert-path /etc/letsencrypt/live/example.com/cert.pem

# Delete certificate
sudo certbot delete --cert-name example.com
</code></pre>
<h3 id="automated-renewal"><a class="header" href="#automated-renewal">Automated Renewal</a></h3>
<pre><code class="language-bash"># Add to crontab (check renewal twice daily)
0 0,12 * * * certbot renew --quiet

# Systemd timer (if using systemd)
sudo systemctl enable certbot-renew.timer
sudo systemctl start certbot-renew.timer

# Test renewal
sudo certbot renew --dry-run
</code></pre>
<h3 id="using-acmesh-alternative"><a class="header" href="#using-acmesh-alternative">Using acme.sh (Alternative)</a></h3>
<pre><code class="language-bash"># Install acme.sh
curl https://get.acme.sh | sh

# Issue certificate (HTTP validation)
acme.sh --issue -d example.com -w /var/www/html

# Issue certificate (DNS validation with Cloudflare)
export CF_Key="your-cloudflare-api-key"
export CF_Email="your@email.com"
acme.sh --issue --dns dns_cf -d example.com -d *.example.com

# Install certificate
acme.sh --install-cert -d example.com \
  --key-file /etc/nginx/ssl/example.com.key \
  --fullchain-file /etc/nginx/ssl/example.com.crt \
  --reloadcmd "systemctl reload nginx"

# Renew all certificates
acme.sh --renew-all

# Force renew
acme.sh --renew -d example.com --force
</code></pre>
<h2 id="certificate-management"><a class="header" href="#certificate-management">Certificate Management</a></h2>
<h3 id="certificate-inspection"><a class="header" href="#certificate-inspection">Certificate Inspection</a></h3>
<pre><code class="language-bash"># View certificate details
openssl x509 -in cert.pem -text -noout

# View certificate dates
openssl x509 -in cert.pem -noout -dates

# View certificate subject
openssl x509 -in cert.pem -noout -subject

# View certificate issuer
openssl x509 -in cert.pem -noout -issuer

# View certificate fingerprint
openssl x509 -in cert.pem -noout -fingerprint -sha256

# Check certificate and key match
openssl x509 -noout -modulus -in cert.pem | openssl md5
openssl rsa -noout -modulus -in key.pem | openssl md5
# If md5 hashes match, cert and key are paired

# View certificate from server
openssl s_client -connect example.com:443 -showcerts

# Check certificate expiration
echo | openssl s_client -connect example.com:443 2&gt;/dev/null | \
  openssl x509 -noout -dates
</code></pre>
<h3 id="python-certificate-tools"><a class="header" href="#python-certificate-tools">Python Certificate Tools</a></h3>
<pre><code class="language-python">from cryptography import x509
from cryptography.hazmat.primitives import serialization
import datetime

def inspect_certificate(cert_path):
    with open(cert_path, 'rb') as f:
        cert = x509.load_pem_x509_certificate(f.read())

    print("Certificate Information:")
    print(f"Subject: {cert.subject.rfc4514_string()}")
    print(f"Issuer: {cert.issuer.rfc4514_string()}")
    print(f"Serial Number: {cert.serial_number}")
    print(f"Not Valid Before: {cert.not_valid_before}")
    print(f"Not Valid After: {cert.not_valid_after}")
    print(f"Signature Algorithm: {cert.signature_algorithm_oid._name}")

    # Check if expired
    now = datetime.datetime.utcnow()
    days_until_expiry = (cert.not_valid_after - now).days

    if now &gt; cert.not_valid_after:
        print("⚠ Certificate EXPIRED!")
    elif days_until_expiry &lt; 30:
        print(f"⚠ Certificate expires soon ({days_until_expiry} days)")
    else:
        print(f"✓ Certificate valid ({days_until_expiry} days remaining)")

    # Subject Alternative Names
    try:
        san_ext = cert.extensions.get_extension_for_oid(
            x509.oid.ExtensionOID.SUBJECT_ALTERNATIVE_NAME
        )
        print(f"SANs: {', '.join([dns.value for dns in san_ext.value])}")
    except x509.ExtensionNotFound:
        print("No SANs found")

    return cert

# Usage
cert = inspect_certificate('cert.pem')
</code></pre>
<h3 id="certificate-monitoring"><a class="header" href="#certificate-monitoring">Certificate Monitoring</a></h3>
<pre><code class="language-python">import ssl
import socket
from datetime import datetime

def check_certificate_expiry(hostname, port=443):
    """Check SSL certificate expiration"""
    context = ssl.create_default_context()

    with socket.create_connection((hostname, port)) as sock:
        with context.wrap_socket(sock, server_hostname=hostname) as ssock:
            cert = ssock.getpeercert()

            # Parse expiration date
            expires = datetime.strptime(
                cert['notAfter'],
                '%b %d %H:%M:%S %Y %GMT'
            )

            days_remaining = (expires - datetime.now()).days

            print(f"Certificate for {hostname}:")
            print(f"  Subject: {dict(x[0] for x in cert['subject'])['commonName']}")
            print(f"  Issuer: {dict(x[0] for x in cert['issuer'])['commonName']}")
            print(f"  Expires: {expires}")
            print(f"  Days remaining: {days_remaining}")

            if days_remaining &lt; 0:
                print("  ⚠ EXPIRED!")
            elif days_remaining &lt; 30:
                print("  ⚠ Expiring soon!")
            else:
                print("  ✓ Valid")

            return days_remaining

# Check multiple sites
sites = ['google.com', 'github.com', 'example.com']
for site in sites:
    try:
        check_certificate_expiry(site)
        print()
    except Exception as e:
        print(f"Error checking {site}: {e}\n")
</code></pre>
<h3 id="certificate-renewal-strategy"><a class="header" href="#certificate-renewal-strategy">Certificate Renewal Strategy</a></h3>
<pre><code class="language-bash">#!/bin/bash
# certificate-renewal.sh

# Check certificate expiration
check_expiry() {
    local domain=$1
    local days_until_expiry=$(echo | openssl s_client -connect $domain:443 2&gt;/dev/null | \
        openssl x509 -noout -checkend 2592000)  # 30 days

    if [ $? -eq 0 ]; then
        echo "$domain: Certificate valid for at least 30 days"
        return 0
    else
        echo "$domain: Certificate expires within 30 days!"
        return 1
    fi
}

# Renew if needed
renew_certificate() {
    local domain=$1

    if ! check_expiry $domain; then
        echo "Renewing certificate for $domain..."
        certbot renew --cert-name $domain

        if [ $? -eq 0 ]; then
            echo "Certificate renewed successfully"
            systemctl reload nginx
        else
            echo "Certificate renewal failed!"
            # Send alert
        fi
    fi
}

# Check all domains
for domain in example.com api.example.com www.example.com; do
    renew_certificate $domain
done
</code></pre>
<h2 id="certificate-revocation"><a class="header" href="#certificate-revocation">Certificate Revocation</a></h2>
<h3 id="certificate-revocation-lists-crl"><a class="header" href="#certificate-revocation-lists-crl">Certificate Revocation Lists (CRL)</a></h3>
<pre><code class="language-bash"># Download CRL
wget http://crl.example.com/example.crl

# View CRL
openssl crl -in example.crl -text -noout

# Check if certificate is revoked
openssl verify -crl_check -CRLfile example.crl -CAfile ca.crt cert.pem
</code></pre>
<h3 id="online-certificate-status-protocol-ocsp"><a class="header" href="#online-certificate-status-protocol-ocsp">Online Certificate Status Protocol (OCSP)</a></h3>
<pre><code class="language-bash"># Get OCSP responder URL from certificate
openssl x509 -in cert.pem -noout -ocsp_uri

# Check certificate status via OCSP
openssl ocsp -issuer ca.crt -cert cert.pem \
  -url http://ocsp.example.com \
  -resp_text

# OCSP stapling check
openssl s_client -connect example.com:443 -status
</code></pre>
<h3 id="revoking-certificate"><a class="header" href="#revoking-certificate">Revoking Certificate</a></h3>
<pre><code class="language-bash"># Revoke with certbot
sudo certbot revoke --cert-path /etc/letsencrypt/live/example.com/cert.pem

# Revoke with reason
sudo certbot revoke --cert-path cert.pem --reason keycompromise

# Revoke with custom CA
openssl ca -config ca.conf -revoke cert.pem -keyfile ca.key -cert ca.crt

# Generate CRL
openssl ca -config ca.conf -gencrl -out crl.pem
</code></pre>
<h2 id="security-considerations-3"><a class="header" href="#security-considerations-3">Security Considerations</a></h2>
<h3 id="1-key-size-1"><a class="header" href="#1-key-size-1">1. Key Size</a></h3>
<pre><code>RSA:
  Minimum: 2048 bits
  Recommended: 3072-4096 bits

ECDSA:
  Recommended: P-256 (256-bit)
  High security: P-384 (384-bit)

Ed25519:
  Fixed: 256-bit (recommended for new deployments)
</code></pre>
<h3 id="2-certificate-validity-period"><a class="header" href="#2-certificate-validity-period">2. Certificate Validity Period</a></h3>
<pre><code>Modern best practices:
- Maximum: 398 days (13 months) - enforced by browsers
- Recommended: 90 days (Let's Encrypt default)
- Automated renewal: Essential for short validity

Historical:
- Before 2020: Up to 2-3 years
- 2020: 398 days maximum
- Trend: Shorter validity periods
</code></pre>
<h3 id="3-subject-alternative-names-sans"><a class="header" href="#3-subject-alternative-names-sans">3. Subject Alternative Names (SANs)</a></h3>
<pre><code class="language-bash"># Include all domain variants
subjectAltName = DNS:example.com,DNS:www.example.com,DNS:*.example.com

# Don't rely on Common Name (CN) - deprecated
# Always use SANs
</code></pre>
<h3 id="4-certificate-pinning"><a class="header" href="#4-certificate-pinning">4. Certificate Pinning</a></h3>
<pre><code class="language-python">import ssl
import hashlib
import socket

def verify_certificate_pinning(hostname, expected_fingerprints):
    """Verify certificate matches expected fingerprint"""
    context = ssl.create_default_context()

    with socket.create_connection((hostname, 443)) as sock:
        with context.wrap_socket(sock, server_hostname=hostname) as ssock:
            cert_der = ssock.getpeercert(binary_form=True)
            fingerprint = hashlib.sha256(cert_der).hexdigest()

            if fingerprint in expected_fingerprints:
                print(f"✓ Certificate pinning verified")
                return True
            else:
                print(f"✗ Certificate pinning failed!")
                print(f"  Expected: {expected_fingerprints}")
                print(f"  Got: {fingerprint}")
                return False

# Usage
expected_pins = [
    'a1b2c3d4e5f6...',  # Primary certificate
    '9a8b7c6d5e4f...',  # Backup certificate
]

verify_certificate_pinning('example.com', expected_pins)
</code></pre>
<h2 id="best-practices-31"><a class="header" href="#best-practices-31">Best Practices</a></h2>
<h3 id="1-automate-certificate-management"><a class="header" href="#1-automate-certificate-management">1. Automate Certificate Management</a></h3>
<pre><code>✓ Use Let's Encrypt for free certificates
✓ Automate renewal (certbot, acme.sh)
✓ Monitor expiration dates
✓ Test renewal process regularly
✓ Use short validity periods (90 days)
</code></pre>
<h3 id="2-secure-private-keys"><a class="header" href="#2-secure-private-keys">2. Secure Private Keys</a></h3>
<pre><code class="language-bash"># Restrict permissions
chmod 600 private.key

# Use hardware security modules (HSM) for critical keys
# Use encrypted private keys
openssl rsa -aes256 -in private.key -out private_encrypted.key

# Never commit to version control
echo "*.key" &gt;&gt; .gitignore
echo "*.pem" &gt;&gt; .gitignore
</code></pre>
<h3 id="3-use-strong-cryptography"><a class="header" href="#3-use-strong-cryptography">3. Use Strong Cryptography</a></h3>
<pre><code>✓ RSA 2048-bit minimum (prefer 3072+)
✓ ECDSA P-256 or better
✓ SHA-256 or SHA-512 for signatures
✗ Avoid MD5, SHA-1
✗ Avoid RSA &lt;2048 bits
</code></pre>
<h3 id="4-implement-certificate-transparency"><a class="header" href="#4-implement-certificate-transparency">4. Implement Certificate Transparency</a></h3>
<pre><code class="language-bash"># Check if certificate is in CT logs
curl https://crt.sh/?q=example.com

# Monitor for unauthorized certificates
# Use tools like certstream, certificate-transparency-go
</code></pre>
<h2 id="common-mistakes-2"><a class="header" href="#common-mistakes-2">Common Mistakes</a></h2>
<h3 id="1-expired-certificates"><a class="header" href="#1-expired-certificates">1. Expired Certificates</a></h3>
<pre><code>Problem: Certificate expires unexpectedly
Solution: Automate monitoring and renewal
</code></pre>
<h3 id="2-missing-intermediate-certificates"><a class="header" href="#2-missing-intermediate-certificates">2. Missing Intermediate Certificates</a></h3>
<pre><code>Problem: Browser shows untrusted certificate
Solution: Include full chain (server + intermediate certs)

# Correct chain order
cat server.crt intermediate.crt &gt; fullchain.pem
</code></pre>
<h3 id="3-certificate-name-mismatch"><a class="header" href="#3-certificate-name-mismatch">3. Certificate Name Mismatch</a></h3>
<pre><code>Problem: Certificate for wrong domain
Solution: Use proper SANs

# Include all domains
subjectAltName = DNS:example.com,DNS:www.example.com
</code></pre>
<h3 id="4-insecure-private-key"><a class="header" href="#4-insecure-private-key">4. Insecure Private Key</a></h3>
<pre><code>Problem: Private key readable by all users
Solution: Restrict permissions

chmod 600 private.key
chown root:root private.key
</code></pre>
<h2 id="eli10-10"><a class="header" href="#eli10-10">ELI10</a></h2>
<p>Certificates are like ID cards for websites:</p>
<p><strong>Without certificates:</strong></p>
<ul>
<li>You visit "bank.com"</li>
<li>How do you know it's really your bank?</li>
<li>Attackers could pretend to be your bank!</li>
</ul>
<p><strong>With certificates:</strong></p>
<ol>
<li>
<p><strong>Website has ID card</strong> (certificate)</p>
<ul>
<li>Says: "I'm bank.com"</li>
<li>Has a special seal (signature)</li>
</ul>
</li>
<li>
<p><strong>Trusted Authority</strong> (CA like Let's Encrypt)</p>
<ul>
<li>Like a government issuing passports</li>
<li>Checks: "Yes, you really own bank.com"</li>
<li>Adds their official seal</li>
</ul>
</li>
<li>
<p><strong>Your browser checks</strong>:</p>
<ul>
<li>Is the ID card real? ✓</li>
<li>Is it expired? ✓</li>
<li>Does it match the website name? ✓</li>
<li>Is the seal from a trusted authority? ✓</li>
</ul>
</li>
<li>
<p><strong>Chain of Trust</strong>:</p>
<pre><code>Browser trusts → Root CA
Root CA trusts → Intermediate CA
Intermediate CA trusts → Website Certificate
Therefore, Browser trusts → Website!
</code></pre>
</li>
</ol>
<p><strong>Let's Encrypt made it:</strong></p>
<ul>
<li>Free (used to cost $$$)</li>
<li>Automatic (renews itself)</li>
<li>Easy (simple commands)</li>
</ul>
<p><strong>Real-world analogy:</strong></p>
<ul>
<li>Certificate = Passport</li>
<li>CA = Government passport office</li>
<li>Browser = Border control checking passports</li>
<li>Expiration date = Passport validity</li>
<li>Renewal = Getting new passport before expiry</li>
</ul>
<h2 id="further-resources-10"><a class="header" href="#further-resources-10">Further Resources</a></h2>
<ul>
<li><a href="https://letsencrypt.org/docs/">Let's Encrypt Documentation</a></li>
<li><a href="https://tools.ietf.org/html/rfc5280">X.509 Certificate Format (RFC 5280)</a></li>
<li><a href="https://tools.ietf.org/html/rfc8555">ACME Protocol (RFC 8555)</a></li>
<li><a href="https://certificate.transparency.dev/">Certificate Transparency</a></li>
<li><a href="https://www.ssllabs.com/ssltest/">SSL Labs Server Test</a></li>
<li><a href="https://certbot.eff.org/docs/">Certbot Documentation</a></li>
<li><a href="https://www.feistyduck.com/library/openssl-cookbook/">OpenSSL Cookbook</a></li>
<li><a href="https://en.wikipedia.org/wiki/Public_key_infrastructure">Public Key Infrastructure (PKI) Guide</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ssltls-secure-sockets-layer--transport-layer-security"><a class="header" href="#ssltls-secure-sockets-layer--transport-layer-security">SSL/TLS (Secure Sockets Layer / Transport Layer Security)</a></h1>
<h2 id="overview-42"><a class="header" href="#overview-42">Overview</a></h2>
<p>TLS (Transport Layer Security) is a cryptographic protocol that provides secure communication over networks. SSL is the predecessor to TLS (now deprecated).</p>
<p><strong>Key Features:</strong></p>
<ul>
<li><strong>Confidentiality</strong>: Encryption prevents eavesdropping</li>
<li><strong>Integrity</strong>: Detects message tampering</li>
<li><strong>Authentication</strong>: Verifies server (and optionally client) identity</li>
</ul>
<h2 id="ssltls-history"><a class="header" href="#ssltls-history">SSL/TLS History</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Year</th><th>Status</th><th>Notes</th></tr></thead><tbody>
<tr><td><strong>SSL 1.0</strong></td><td>-</td><td>Never released</td><td>Internal Netscape protocol</td></tr>
<tr><td><strong>SSL 2.0</strong></td><td>1995</td><td>Deprecated</td><td>Serious security flaws</td></tr>
<tr><td><strong>SSL 3.0</strong></td><td>1996</td><td>Deprecated</td><td>POODLE attack (2014)</td></tr>
<tr><td><strong>TLS 1.0</strong></td><td>1999</td><td>Deprecated</td><td>Similar to SSL 3.0</td></tr>
<tr><td><strong>TLS 1.1</strong></td><td>2006</td><td>Deprecated</td><td>Minor improvements</td></tr>
<tr><td><strong>TLS 1.2</strong></td><td>2008</td><td>Secure</td><td>Currently widely used</td></tr>
<tr><td><strong>TLS 1.3</strong></td><td>2018</td><td>Secure</td><td>Modern, fastest, most secure</td></tr>
</tbody></table>
</div>
<h2 id="tls-handshake-tls-12"><a class="header" href="#tls-handshake-tls-12">TLS Handshake (TLS 1.2)</a></h2>
<h3 id="full-handshake-process"><a class="header" href="#full-handshake-process">Full Handshake Process</a></h3>
<pre><code>Client                                Server

1. ClientHello              --------&gt;
   - TLS version
   - Cipher suites
   - Random bytes
   - Extensions

                            &lt;--------  2. ServerHello
                                          - Chosen cipher suite
                                          - Random bytes
                                          - Session ID
                                       
                                       3. Certificate
                                          - Server certificate chain
                                       
                                       4. ServerKeyExchange
                                          - Key exchange parameters
                                       
                                       5. ServerHelloDone

6. ClientKeyExchange        --------&gt;
   - Pre-master secret (encrypted)

7. ChangeCipherSpec         --------&gt;
   - Switch to encrypted communication

8. Finished                 --------&gt;
   - Verification message (encrypted)

                            &lt;--------  9. ChangeCipherSpec

                            &lt;--------  10. Finished

11. Encrypted Application Data &lt;---&gt; Encrypted Application Data
</code></pre>
<h3 id="detailed-steps"><a class="header" href="#detailed-steps">Detailed Steps</a></h3>
<h4 id="1-clienthello"><a class="header" href="#1-clienthello">1. ClientHello</a></h4>
<pre><code>Client → Server:

TLS Version: 1.2
Cipher Suites:
  - TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256
  - TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
  - TLS_RSA_WITH_AES_128_CBC_SHA256
Random: [28 bytes client random]
Session ID: [empty for new session]
Extensions:
  - server_name: example.com
  - supported_groups: P-256, P-384
  - signature_algorithms: RSA-PSS-SHA256, ECDSA-SHA256
</code></pre>
<h4 id="2-serverhello"><a class="header" href="#2-serverhello">2. ServerHello</a></h4>
<pre><code>Server → Client:

TLS Version: 1.2
Cipher Suite: TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256
Random: [28 bytes server random]
Session ID: [32 bytes for session resumption]
Extensions:
  - renegotiation_info
  - extended_master_secret
</code></pre>
<h4 id="3-certificate"><a class="header" href="#3-certificate">3. Certificate</a></h4>
<pre><code>Server → Client:

Certificate Chain:
  1. Server certificate (example.com)
  2. Intermediate CA certificate
  [Root CA not sent - client has it]
</code></pre>
<h4 id="4-serverkeyexchange-for-ecdhe"><a class="header" href="#4-serverkeyexchange-for-ecdhe">4. ServerKeyExchange (for ECDHE)</a></h4>
<pre><code>Server → Client:

Curve: P-256
Public Key: [server's ephemeral ECDH public key]
Signature: [signed with server's private key]
</code></pre>
<h4 id="5-clientkeyexchange"><a class="header" href="#5-clientkeyexchange">5. ClientKeyExchange</a></h4>
<pre><code>Client → Server:

Pre-master Secret:
  [Encrypted with server's public key (RSA) OR
   Client's ephemeral ECDH public key (ECDHE)]
</code></pre>
<h4 id="6-master-secret-derivation"><a class="header" href="#6-master-secret-derivation">6. Master Secret Derivation</a></h4>
<pre><code>Both compute:

Master Secret = PRF(
  pre-master secret,
  "master secret",
  ClientHello.random + ServerHello.random
)

Then derive:
  - Client write MAC key
  - Server write MAC key
  - Client write encryption key
  - Server write encryption key
  - Client write IV
  - Server write IV
</code></pre>
<h3 id="visual-tls-12-handshake"><a class="header" href="#visual-tls-12-handshake">Visual TLS 1.2 Handshake</a></h3>
<pre><code>┌────────┐                           ┌────────┐
│ Client │                           │ Server │
└───┬────┘                           └───┬────┘
    │                                    │
    │ ClientHello                        │
    │ (ciphers, random, SNI)             │
    ├───────────────────────────────────&gt;│
    │                                    │
    │                   ServerHello      │
    │              (chosen cipher, random)│
    │&lt;───────────────────────────────────┤
    │                                    │
    │                 Certificate        │
    │         (server cert chain)        │
    │&lt;───────────────────────────────────┤
    │                                    │
    │            ServerKeyExchange       │
    │        (DH params, signature)      │
    │&lt;───────────────────────────────────┤
    │                                    │
    │            ServerHelloDone         │
    │&lt;───────────────────────────────────┤
    │                                    │
    │ ClientKeyExchange                  │
    │ (pre-master secret)                │
    ├───────────────────────────────────&gt;│
    │                                    │
    │ ChangeCipherSpec                   │
    ├───────────────────────────────────&gt;│
    │                                    │
    │ Finished (encrypted)               │
    ├───────────────────────────────────&gt;│
    │                                    │
    │            ChangeCipherSpec        │
    │&lt;───────────────────────────────────┤
    │                                    │
    │         Finished (encrypted)       │
    │&lt;───────────────────────────────────┤
    │                                    │
    │ Application Data (encrypted)       │
    │&lt;──────────────────────────────────&gt;│
    │                                    │
</code></pre>
<h2 id="tls-13-handshake"><a class="header" href="#tls-13-handshake">TLS 1.3 Handshake</a></h2>
<p>TLS 1.3 is <strong>faster</strong> - only 1 round-trip (vs 2 in TLS 1.2):</p>
<pre><code>Client                                Server

1. ClientHello              --------&gt;
   - Key share (DH)
   - Supported versions
   - Cipher suites

                            &lt;--------  2. ServerHello
                                          - Key share (DH)
                                          - Chosen cipher
                                       
                                       {Certificate}*
                                       {CertificateVerify}*
                                       {Finished}
                                       [Application Data]

{Finished}                  --------&gt;

[Application Data]          &lt;-------&gt;  [Application Data]

* Encrypted with handshake traffic keys
[] Encrypted with application traffic keys
</code></pre>
<h3 id="key-differences-tls-13-vs-12"><a class="header" href="#key-differences-tls-13-vs-12">Key Differences TLS 1.3 vs 1.2</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Feature</th><th>TLS 1.2</th><th>TLS 1.3</th></tr></thead><tbody>
<tr><td><strong>Round trips</strong></td><td>2-RTT</td><td>1-RTT</td></tr>
<tr><td><strong>0-RTT mode</strong></td><td>No</td><td>Yes (with risks)</td></tr>
<tr><td><strong>Cipher suites</strong></td><td>Many (weak ones)</td><td>Only 5 strong ones</td></tr>
<tr><td><strong>Key exchange</strong></td><td>RSA, DHE, ECDHE</td><td>Only (EC)DHE</td></tr>
<tr><td><strong>Encryption</strong></td><td>After handshake</td><td>Most of handshake encrypted</td></tr>
<tr><td><strong>Performance</strong></td><td>Slower</td><td>Faster</td></tr>
<tr><td><strong>Security</strong></td><td>Vulnerable configs</td><td>Secure by default</td></tr>
</tbody></table>
</div>
<h3 id="tls-13-improvements"><a class="header" href="#tls-13-improvements">TLS 1.3 Improvements</a></h3>
<ol>
<li><strong>Faster handshake</strong> (1-RTT instead of 2-RTT)</li>
<li><strong>0-RTT mode</strong> (resume with no round trips)</li>
<li><strong>Removed weak crypto</strong> (RC4, MD5, SHA-1, RSA key exchange)</li>
<li><strong>Forward secrecy</strong> (mandatory ECDHE)</li>
<li><strong>Encrypted handshake</strong> (server certificate encrypted)</li>
<li><strong>Simplified cipher suites</strong></li>
</ol>
<h2 id="cipher-suites"><a class="header" href="#cipher-suites">Cipher Suites</a></h2>
<h3 id="cipher-suite-format-tls-12"><a class="header" href="#cipher-suite-format-tls-12">Cipher Suite Format (TLS 1.2)</a></h3>
<pre><code>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256
|   |     |   |    |       |   |
|   |     |   |    |       |   +-- MAC algorithm (SHA-256)
|   |     |   |    |       +------ AEAD mode (GCM)
|   |     |   |    +-------------- Encryption (AES-128)
|   |     |   +------------------- "WITH"
|   |     +----------------------- Authentication (RSA)
|   +----------------------------- Key exchange (ECDHE)
+--------------------------------- Protocol (TLS)
</code></pre>
<h3 id="common-cipher-suites-tls-12"><a class="header" href="#common-cipher-suites-tls-12">Common Cipher Suites (TLS 1.2)</a></h3>
<h4 id="strong--recommended"><a class="header" href="#strong--recommended">Strong &amp; Recommended</a></h4>
<pre><code>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256
TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256
TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256
TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384
</code></pre>
<h4 id="weak-avoid"><a class="header" href="#weak-avoid">Weak (Avoid)</a></h4>
<pre><code>TLS_RSA_WITH_RC4_128_SHA                    # RC4 broken
TLS_RSA_WITH_3DES_EDE_CBC_SHA               # 3DES weak
TLS_RSA_WITH_AES_128_CBC_SHA                # CBC mode, no forward secrecy
TLS_DHE_RSA_WITH_AES_128_CBC_SHA256         # CBC mode
</code></pre>
<h3 id="cipher-suite-components"><a class="header" href="#cipher-suite-components">Cipher Suite Components</a></h3>
<h4 id="1-key-exchange"><a class="header" href="#1-key-exchange">1. Key Exchange</a></h4>
<pre><code>RSA:     No forward secrecy (deprecated)
DHE:     Diffie-Hellman Ephemeral (slow)
ECDHE:   Elliptic Curve DHE (fast, forward secrecy) ✓
</code></pre>
<h4 id="2-authentication"><a class="header" href="#2-authentication">2. Authentication</a></h4>
<pre><code>RSA:     RSA certificate
ECDSA:   Elliptic Curve certificate (smaller, faster)
DSA:     Digital Signature Algorithm (obsolete)
</code></pre>
<h4 id="3-encryption"><a class="header" href="#3-encryption">3. Encryption</a></h4>
<pre><code>AES-128-GCM:      Fast, secure, hardware accelerated ✓
AES-256-GCM:      Higher security ✓
ChaCha20-Poly1305: Fast on mobile (no AES hardware) ✓
AES-CBC:          Vulnerable to padding oracles (avoid)
3DES:             Obsolete (avoid)
RC4:              Broken (never use)
</code></pre>
<h4 id="4-mac-message-authentication-code"><a class="header" href="#4-mac-message-authentication-code">4. MAC (Message Authentication Code)</a></h4>
<pre><code>SHA-256:  Secure ✓
SHA-384:  Secure ✓
SHA-1:    Weak (avoid)
MD5:      Broken (never use)

Note: AEAD modes (GCM, ChaCha20-Poly1305) don't need separate MAC
</code></pre>
<h3 id="tls-13-cipher-suites-simplified"><a class="header" href="#tls-13-cipher-suites-simplified">TLS 1.3 Cipher Suites (Simplified)</a></h3>
<pre><code>TLS_AES_128_GCM_SHA256
TLS_AES_256_GCM_SHA384
TLS_CHACHA20_POLY1305_SHA256
TLS_AES_128_CCM_SHA256
TLS_AES_128_CCM_8_SHA256
</code></pre>
<p>Only 5 cipher suites! Key exchange and auth determined separately.</p>
<h2 id="configuring-tls"><a class="header" href="#configuring-tls">Configuring TLS</a></h2>
<h3 id="nginx-configuration"><a class="header" href="#nginx-configuration">Nginx Configuration</a></h3>
<pre><code class="language-nginx">server {
    listen 443 ssl http2;
    server_name example.com;

    # Certificates
    ssl_certificate /etc/letsencrypt/live/example.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/example.com/privkey.pem;

    # TLS versions
    ssl_protocols TLSv1.2 TLSv1.3;

    # Cipher suites (TLS 1.2)
    ssl_ciphers 'ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-CHACHA20-POLY1305';
    ssl_prefer_server_ciphers on;

    # DH parameters (for DHE cipher suites)
    ssl_dhparam /etc/nginx/dhparam.pem;

    # OCSP Stapling
    ssl_stapling on;
    ssl_stapling_verify on;
    ssl_trusted_certificate /etc/letsencrypt/live/example.com/chain.pem;

    # Session tickets
    ssl_session_timeout 1d;
    ssl_session_cache shared:SSL:50m;
    ssl_session_tickets off;

    # HSTS (HTTP Strict Transport Security)
    add_header Strict-Transport-Security "max-age=31536000; includeSubDomains; preload" always;

    location / {
        root /var/www/html;
    }
}

# Redirect HTTP to HTTPS
server {
    listen 80;
    server_name example.com;
    return 301 https://$server_name$request_uri;
}
</code></pre>
<h3 id="apache-configuration"><a class="header" href="#apache-configuration">Apache Configuration</a></h3>
<pre><code class="language-apache">&lt;VirtualHost *:443&gt;
    ServerName example.com
    
    # Certificates
    SSLCertificateFile /etc/letsencrypt/live/example.com/cert.pem
    SSLCertificateKeyFile /etc/letsencrypt/live/example.com/privkey.pem
    SSLCertificateChainFile /etc/letsencrypt/live/example.com/chain.pem
    
    # TLS versions
    SSLProtocol -all +TLSv1.2 +TLSv1.3
    
    # Cipher suites
    SSLCipherSuite ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-CHACHA20-POLY1305
    SSLHonorCipherOrder on
    
    # OCSP Stapling
    SSLUseStapling on
    SSLStaplingCache "shmcb:logs/ssl_stapling(32768)"
    
    # HSTS
    Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
    
    DocumentRoot /var/www/html
&lt;/VirtualHost&gt;

# Redirect HTTP to HTTPS
&lt;VirtualHost *:80&gt;
    ServerName example.com
    Redirect permanent / https://example.com/
&lt;/VirtualHost&gt;
</code></pre>
<h3 id="python-https-server"><a class="header" href="#python-https-server">Python HTTPS Server</a></h3>
<pre><code class="language-python">import http.server
import ssl

# Simple HTTPS server
server_address = ('0.0.0.0', 4443)
httpd = http.server.HTTPServer(server_address, http.server.SimpleHTTPRequestHandler)

# Create SSL context
context = ssl.SSLContext(ssl.PROTOCOL_TLS_SERVER)
context.load_cert_chain('cert.pem', 'key.pem')

# Optional: Configure cipher suites
context.set_ciphers('ECDHE+AESGCM:ECDHE+CHACHA20:DHE+AESGCM:DHE+CHACHA20:!aNULL:!MD5:!DSS')

# Wrap socket with TLS
httpd.socket = context.wrap_socket(httpd.socket, server_side=True)

print("Server running on https://localhost:4443")
httpd.serve_forever()
</code></pre>
<h3 id="python-client-with-tls"><a class="header" href="#python-client-with-tls">Python Client with TLS</a></h3>
<pre><code class="language-python">import ssl
import socket

def https_request(hostname, path='/'):
    # Create SSL context
    context = ssl.create_default_context()
    
    # Optional: Verify certificate
    # context.check_hostname = True
    # context.verify_mode = ssl.CERT_REQUIRED
    
    # Optional: Pin certificate
    # context.load_verify_locations('ca-bundle.crt')
    
    # Connect
    with socket.create_connection((hostname, 443)) as sock:
        with context.wrap_socket(sock, server_hostname=hostname) as ssock:
            # Send HTTP request
            request = f"GET {path} HTTP/1.1\r\nHost: {hostname}\r\nConnection: close\r\n\r\n"
            ssock.send(request.encode())
            
            # Receive response
            response = b''
            while True:
                data = ssock.recv(4096)
                if not data:
                    break
                response += data
            
            return response.decode()

# Usage
response = https_request('example.com', '/')
print(response)
</code></pre>
<h3 id="using-python-requests-library"><a class="header" href="#using-python-requests-library">Using Python Requests Library</a></h3>
<pre><code class="language-python">import requests

# Basic HTTPS request (verifies certificates by default)
response = requests.get('https://example.com')

# Disable certificate verification (not recommended!)
response = requests.get('https://example.com', verify=False)

# Use custom CA bundle
response = requests.get('https://example.com', verify='/path/to/ca-bundle.crt')

# Client certificate authentication
response = requests.get('https://example.com', 
                       cert=('client.crt', 'client.key'))

# Specify TLS version
import ssl
from requests.adapters import HTTPAdapter
from urllib3.util.ssl_ import create_urllib3_context

class TLSAdapter(HTTPAdapter):
    def init_poolmanager(self, *args, **kwargs):
        ctx = create_urllib3_context()
        ctx.minimum_version = ssl.TLSVersion.TLSv1_2
        ctx.maximum_version = ssl.TLSVersion.TLSv1_3
        kwargs['ssl_context'] = ctx
        return super().init_poolmanager(*args, **kwargs)

session = requests.Session()
session.mount('https://', TLSAdapter())
response = session.get('https://example.com')
</code></pre>
<h2 id="testing-tls-configuration"><a class="header" href="#testing-tls-configuration">Testing TLS Configuration</a></h2>
<h3 id="openssl-command-line-tests"><a class="header" href="#openssl-command-line-tests">OpenSSL Command-Line Tests</a></h3>
<pre><code class="language-bash"># Connect to server and show TLS info
openssl s_client -connect example.com:443 -servername example.com

# Test specific TLS version
openssl s_client -connect example.com:443 -tls1_2
openssl s_client -connect example.com:443 -tls1_3

# Test if old protocols are disabled
openssl s_client -connect example.com:443 -ssl3  # Should fail
openssl s_client -connect example.com:443 -tls1  # Should fail
openssl s_client -connect example.com:443 -tls1_1  # Should fail

# Test specific cipher suite
openssl s_client -connect example.com:443 -cipher 'ECDHE-RSA-AES128-GCM-SHA256'

# Show certificate chain
openssl s_client -connect example.com:443 -showcerts

# Check OCSP stapling
openssl s_client -connect example.com:443 -status

# Check certificate expiration
echo | openssl s_client -connect example.com:443 2&gt;/dev/null | openssl x509 -noout -dates

# Full connection info
openssl s_client -connect example.com:443 -servername example.com &lt;/dev/null | grep -E 'Protocol|Cipher'
</code></pre>
<h3 id="testing-tools"><a class="header" href="#testing-tools">Testing Tools</a></h3>
<h4 id="nmap"><a class="header" href="#nmap">nmap</a></h4>
<pre><code class="language-bash"># Scan TLS versions
nmap --script ssl-enum-ciphers -p 443 example.com

# Check for vulnerabilities
nmap --script ssl-* -p 443 example.com
</code></pre>
<h4 id="testsslsh"><a class="header" href="#testsslsh">testssl.sh</a></h4>
<pre><code class="language-bash"># Install
git clone https://github.com/drwetter/testssl.sh.git
cd testssl.sh

# Run comprehensive test
./testssl.sh https://example.com

# Test specific features
./testssl.sh --protocols https://example.com
./testssl.sh --ciphers https://example.com
./testssl.sh --vulnerabilities https://example.com
</code></pre>
<h4 id="ssl-labs"><a class="header" href="#ssl-labs">SSL Labs</a></h4>
<pre><code class="language-bash"># Online tool (web interface)
# https://www.ssllabs.com/ssltest/

# API
curl "https://api.ssllabs.com/api/v3/analyze?host=example.com"
</code></pre>
<h3 id="python-tls-testing"><a class="header" href="#python-tls-testing">Python TLS Testing</a></h3>
<pre><code class="language-python">import ssl
import socket

def test_tls_version(hostname, port=443):
    """Test TLS versions supported by server"""
    versions = {
        'TLS 1.0': ssl.PROTOCOL_TLSv1,
        'TLS 1.1': ssl.PROTOCOL_TLSv1_1,
        'TLS 1.2': ssl.PROTOCOL_TLSv1_2,
        'TLS 1.3': ssl.PROTOCOL_TLS,  # Tries highest available
    }
    
    for version_name, protocol in versions.items():
        try:
            context = ssl.SSLContext(protocol)
            with socket.create_connection((hostname, port), timeout=5) as sock:
                with context.wrap_socket(sock, server_hostname=hostname) as ssock:
                    print(f"✓ {version_name}: Supported (cipher: {ssock.cipher()[0]})")
        except Exception as e:
            print(f"✗ {version_name}: Not supported")

def get_certificate_info(hostname, port=443):
    """Get server certificate information"""
    context = ssl.create_default_context()
    
    with socket.create_connection((hostname, port)) as sock:
        with context.wrap_socket(sock, server_hostname=hostname) as ssock:
            cert = ssock.getpeercert()
            
            print(f"Subject: {dict(x[0] for x in cert['subject'])}")
            print(f"Issuer: {dict(x[0] for x in cert['issuer'])}")
            print(f"Version: {cert['version']}")
            print(f"Serial: {cert['serialNumber']}")
            print(f"Not Before: {cert['notBefore']}")
            print(f"Not After: {cert['notAfter']}")
            print(f"SANs: {', '.join([x[1] for x in cert.get('subjectAltName', [])])}")
            print(f"TLS Version: {ssock.version()}")
            print(f"Cipher: {ssock.cipher()}")

# Usage
test_tls_version('example.com')
print()
get_certificate_info('example.com')
</code></pre>
<h2 id="common-tls-vulnerabilities"><a class="header" href="#common-tls-vulnerabilities">Common TLS Vulnerabilities</a></h2>
<h3 id="1-poodle-padding-oracle-on-downgraded-legacy-encryption"><a class="header" href="#1-poodle-padding-oracle-on-downgraded-legacy-encryption">1. POODLE (Padding Oracle On Downgraded Legacy Encryption)</a></h3>
<p><strong>Attack</strong>: Forces downgrade to SSL 3.0, exploits CBC padding</p>
<p><strong>Mitigation</strong>:</p>
<pre><code class="language-nginx"># Disable SSL 3.0
ssl_protocols TLSv1.2 TLSv1.3;
</code></pre>
<h3 id="2-beast-browser-exploit-against-ssltls"><a class="header" href="#2-beast-browser-exploit-against-ssltls">2. BEAST (Browser Exploit Against SSL/TLS)</a></h3>
<p><strong>Attack</strong>: Exploits CBC mode in TLS 1.0</p>
<p><strong>Mitigation</strong>:</p>
<pre><code class="language-nginx"># Disable TLS 1.0, use modern cipher suites
ssl_protocols TLSv1.2 TLSv1.3;
ssl_ciphers 'ECDHE-RSA-AES128-GCM-SHA256:...';
</code></pre>
<h3 id="3-crime-compression-ratio-info-leak-made-easy"><a class="header" href="#3-crime-compression-ratio-info-leak-made-easy">3. CRIME (Compression Ratio Info-leak Made Easy)</a></h3>
<p><strong>Attack</strong>: Exploits TLS compression</p>
<p><strong>Mitigation</strong>:</p>
<pre><code class="language-nginx"># Disable TLS compression (usually disabled by default)
ssl_compression off;
</code></pre>
<h3 id="4-heartbleed"><a class="header" href="#4-heartbleed">4. Heartbleed</a></h3>
<p><strong>Attack</strong>: Buffer over-read in OpenSSL heartbeat extension</p>
<p><strong>Mitigation</strong>:</p>
<pre><code class="language-bash"># Update OpenSSL
sudo apt-get update
sudo apt-get upgrade openssl

# Check version (must be &gt; 1.0.1g)
openssl version
</code></pre>
<h3 id="5-logjam"><a class="header" href="#5-logjam">5. Logjam</a></h3>
<p><strong>Attack</strong>: Weakness in DHE key exchange with small primes</p>
<p><strong>Mitigation</strong>:</p>
<pre><code class="language-bash"># Generate strong DH parameters
openssl dhparam -out /etc/nginx/dhparam.pem 2048

# Configure nginx
ssl_dhparam /etc/nginx/dhparam.pem;
</code></pre>
<h3 id="6-freak-factoring-rsa-export-keys"><a class="header" href="#6-freak-factoring-rsa-export-keys">6. FREAK (Factoring RSA Export Keys)</a></h3>
<p><strong>Attack</strong>: Forces use of weak export-grade encryption</p>
<p><strong>Mitigation</strong>:</p>
<pre><code class="language-nginx"># Disable export ciphers
ssl_ciphers 'ECDHE-RSA-AES128-GCM-SHA256:...';  # No EXPORT
</code></pre>
<h3 id="7-drown-decrypting-rsa-with-obsolete-and-weakened-encryption"><a class="header" href="#7-drown-decrypting-rsa-with-obsolete-and-weakened-encryption">7. DROWN (Decrypting RSA with Obsolete and Weakened eNcryption)</a></h3>
<p><strong>Attack</strong>: Exploits SSLv2 to break TLS</p>
<p><strong>Mitigation</strong>:</p>
<pre><code class="language-bash"># Ensure SSLv2 is disabled everywhere
# Check with:
nmap --script ssl-enum-ciphers -p 443 example.com
</code></pre>
<h3 id="checking-for-vulnerabilities"><a class="header" href="#checking-for-vulnerabilities">Checking for Vulnerabilities</a></h3>
<pre><code class="language-bash"># Using testssl.sh
./testssl.sh --vulnerabilities https://example.com

# Using nmap
nmap --script ssl-heartbleed,ssl-poodle,ssl-dh-params -p 443 example.com
</code></pre>
<h2 id="best-practices-32"><a class="header" href="#best-practices-32">Best Practices</a></h2>
<h3 id="1-protocol-configuration"><a class="header" href="#1-protocol-configuration">1. Protocol Configuration</a></h3>
<pre><code class="language-nginx"># ✓ GOOD - Only modern protocols
ssl_protocols TLSv1.2 TLSv1.3;

# ✗ BAD - Includes old protocols
ssl_protocols TLSv1 TLSv1.1 TLSv1.2 TLSv1.3;
</code></pre>
<h3 id="2-cipher-suite-selection"><a class="header" href="#2-cipher-suite-selection">2. Cipher Suite Selection</a></h3>
<pre><code class="language-nginx"># ✓ GOOD - Strong, forward-secret ciphers
ssl_ciphers 'ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-CHACHA20-POLY1305';

# ✗ BAD - Includes weak ciphers
ssl_ciphers 'ALL:!aNULL:!MD5';
</code></pre>
<h3 id="3-certificate-management"><a class="header" href="#3-certificate-management">3. Certificate Management</a></h3>
<pre><code class="language-bash"># ✓ Use certificates from trusted CA (Let's Encrypt)
# ✓ Automate renewal
# ✓ Monitor expiration
# ✓ Include full certificate chain
# ✗ Don't use self-signed in production
# ✗ Don't let certificates expire
</code></pre>
<h3 id="4-hsts-http-strict-transport-security"><a class="header" href="#4-hsts-http-strict-transport-security">4. HSTS (HTTP Strict Transport Security)</a></h3>
<pre><code class="language-nginx"># Enforce HTTPS for all subdomains
add_header Strict-Transport-Security "max-age=31536000; includeSubDomains; preload" always;
</code></pre>
<h3 id="5-ocsp-stapling"><a class="header" href="#5-ocsp-stapling">5. OCSP Stapling</a></h3>
<pre><code class="language-nginx"># Enable OCSP stapling for faster certificate validation
ssl_stapling on;
ssl_stapling_verify on;
ssl_trusted_certificate /path/to/chain.pem;
</code></pre>
<h3 id="6-session-management"><a class="header" href="#6-session-management">6. Session Management</a></h3>
<pre><code class="language-nginx"># Session resumption (performance)
ssl_session_timeout 1d;
ssl_session_cache shared:SSL:50m;

# Disable session tickets (forward secrecy)
ssl_session_tickets off;
</code></pre>
<h3 id="7-perfect-forward-secrecy"><a class="header" href="#7-perfect-forward-secrecy">7. Perfect Forward Secrecy</a></h3>
<pre><code>Use ECDHE or DHE key exchange:
- ECDHE: Fast, modern
- DHE: Slower, but compatible

Avoid RSA key exchange (no forward secrecy)
</code></pre>
<h3 id="8-regular-updates"><a class="header" href="#8-regular-updates">8. Regular Updates</a></h3>
<pre><code class="language-bash"># Keep OpenSSL updated
sudo apt-get update
sudo apt-get upgrade openssl libssl-dev

# Keep web server updated
sudo apt-get upgrade nginx  # or apache2
</code></pre>
<h3 id="9-monitoring-and-testing"><a class="header" href="#9-monitoring-and-testing">9. Monitoring and Testing</a></h3>
<pre><code class="language-bash"># Regular security scans
./testssl.sh https://example.com

# Monitor certificate expiration
curl https://crt.sh/?q=example.com

# Check SSL Labs rating
curl "https://api.ssllabs.com/api/v3/analyze?host=example.com"
</code></pre>
<h2 id="security-checklist"><a class="header" href="#security-checklist">Security Checklist</a></h2>
<pre><code>Certificate:
  [✓] Valid and not expired
  [✓] From trusted CA
  [✓] Matches domain name
  [✓] Includes full chain
  [✓] Strong key (RSA 2048+ or ECDSA P-256+)

Protocol:
  [✓] TLS 1.2 minimum
  [✓] TLS 1.3 enabled
  [✓] SSL 3.0 disabled
  [✓] TLS 1.0/1.1 disabled

Cipher Suites:
  [✓] Only strong ciphers
  [✓] Forward secrecy (ECDHE)
  [✓] AEAD modes (GCM, ChaCha20-Poly1305)
  [✓] No weak ciphers (RC4, 3DES, etc.)

Headers:
  [✓] HSTS enabled
  [✓] Secure cookie flags

Features:
  [✓] OCSP stapling enabled
  [✓] Session tickets disabled
  [✓] HTTP → HTTPS redirect

Vulnerabilities:
  [✓] Not vulnerable to POODLE
  [✓] Not vulnerable to BEAST
  [✓] Not vulnerable to Heartbleed
  [✓] Not vulnerable to Logjam
  [✓] Not vulnerable to FREAK
  [✓] Not vulnerable to DROWN
</code></pre>
<h2 id="common-mistakes-3"><a class="header" href="#common-mistakes-3">Common Mistakes</a></h2>
<h3 id="1-mixed-content"><a class="header" href="#1-mixed-content">1. Mixed Content</a></h3>
<pre><code class="language-html">&lt;!-- BAD - Loading HTTP resource on HTTPS page --&gt;
&lt;script src="http://example.com/script.js"&gt;&lt;/script&gt;

&lt;!-- GOOD - Use HTTPS --&gt;
&lt;script src="https://example.com/script.js"&gt;&lt;/script&gt;

&lt;!-- BETTER - Protocol-relative URL --&gt;
&lt;script src="//example.com/script.js"&gt;&lt;/script&gt;
</code></pre>
<h3 id="2-weak-cipher-configuration"><a class="header" href="#2-weak-cipher-configuration">2. Weak Cipher Configuration</a></h3>
<pre><code class="language-nginx"># BAD - Allows weak ciphers
ssl_ciphers 'ALL:!aNULL:!MD5';

# GOOD - Only strong ciphers
ssl_ciphers 'ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384';
</code></pre>
<h3 id="3-missing-certificate-chain"><a class="header" href="#3-missing-certificate-chain">3. Missing Certificate Chain</a></h3>
<pre><code class="language-nginx"># BAD - Only server certificate
ssl_certificate /path/to/cert.pem;

# GOOD - Full chain (server + intermediate)
ssl_certificate /path/to/fullchain.pem;
</code></pre>
<h3 id="4-expired-certificates"><a class="header" href="#4-expired-certificates">4. Expired Certificates</a></h3>
<pre><code class="language-bash"># Check expiration regularly
echo | openssl s_client -connect example.com:443 2&gt;/dev/null | openssl x509 -noout -dates

# Automate renewal
certbot renew
</code></pre>
<h3 id="5-not-redirecting-http-to-https"><a class="header" href="#5-not-redirecting-http-to-https">5. Not Redirecting HTTP to HTTPS</a></h3>
<pre><code class="language-nginx"># Missing HTTP → HTTPS redirect leaves users vulnerable

# GOOD - Redirect all HTTP to HTTPS
server {
    listen 80;
    server_name example.com;
    return 301 https://$server_name$request_uri;
}
</code></pre>
<h2 id="eli10-11"><a class="header" href="#eli10-11">ELI10</a></h2>
<p>TLS is like a secure tunnel for internet communication:</p>
<p><strong>Without TLS (HTTP):</strong></p>
<pre><code>You: "My password is abc123"
  ↓ (anyone can read this!)
Server: "OK, logged in"
</code></pre>
<p>Bad guys can see everything!</p>
<p><strong>With TLS (HTTPS):</strong></p>
<pre><code>Step 1: Build a secure tunnel
  You: "Let's talk securely!"
  Server: "Here's my ID card" (certificate)
  You: "OK, I trust you"
  Both: [Create secret code together]

Step 2: Talk through tunnel
  You: "xf9#k2@..." (encrypted password)
  ↓ (looks like gibberish to bad guys!)
  Server: "p8#nz..." (encrypted response)
</code></pre>
<p><strong>The Handshake (making friends):</strong></p>
<ol>
<li><strong>You</strong>: "Hi! I speak TLS 1.2 and TLS 1.3"</li>
<li><strong>Server</strong>: "Great! Let's use TLS 1.3. Here's my ID card"</li>
<li><strong>You</strong>: "ID looks good! Here's a secret number"</li>
<li><strong>Server</strong>: "Got it! Here's my secret number"</li>
<li><strong>Both</strong>: "Let's mix our secrets to make a key!"</li>
<li><strong>Both</strong>: "Tunnel ready! Let's talk!"</li>
</ol>
<p><strong>Why it's secure:</strong></p>
<ul>
<li><strong>Encryption</strong>: Messages look like random gibberish</li>
<li><strong>Authentication</strong>: Server proves it's really who it claims to be</li>
<li><strong>Integrity</strong>: Detect if someone changes messages</li>
</ul>
<p><strong>TLS 1.3 is better:</strong></p>
<ul>
<li>Faster (1 handshake step instead of 2)</li>
<li>More secure (removed old, weak options)</li>
<li>Simpler (fewer choices = fewer mistakes)</li>
</ul>
<p><strong>Real-world analogy:</strong></p>
<ul>
<li>HTTP = Postcard (anyone can read it)</li>
<li>HTTPS = Sealed letter with signature (secure and verified)</li>
</ul>
<h2 id="further-resources-11"><a class="header" href="#further-resources-11">Further Resources</a></h2>
<ul>
<li><a href="https://tools.ietf.org/html/rfc8446">TLS 1.3 RFC 8446</a></li>
<li><a href="https://tools.ietf.org/html/rfc5246">TLS 1.2 RFC 5246</a></li>
<li><a href="https://ssl-config.mozilla.org/">Mozilla SSL Configuration Generator</a></li>
<li><a href="https://www.ssllabs.com/ssltest/">SSL Labs Server Test</a></li>
<li><a href="https://github.com/drwetter/testssl.sh">testssl.sh GitHub</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html">OWASP TLS Cheat Sheet</a></li>
<li><a href="https://hpbn.co/">High Performance Browser Networking (Book)</a></li>
<li><a href="https://tls.ulfheim.net/">TLS Illustrated</a></li>
<li><a href="https://blog.cloudflare.com/rfc-8446-aka-tls-1-3/">Cloudflare TLS 1.3 Guide</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="hmac-hash-based-message-authentication-code"><a class="header" href="#hmac-hash-based-message-authentication-code">HMAC (Hash-based Message Authentication Code)</a></h1>
<h2 id="overview-43"><a class="header" href="#overview-43">Overview</a></h2>
<p>HMAC is a mechanism for message authentication using cryptographic hash functions. It provides both <strong>data integrity</strong> (message hasn't been altered) and <strong>authentication</strong> (message came from someone with the secret key).</p>
<h2 id="hmac-construction"><a class="header" href="#hmac-construction">HMAC Construction</a></h2>
<h3 id="formula"><a class="header" href="#formula">Formula</a></h3>
<pre><code>HMAC(K, m) = H((K' ⊕ opad) || H((K' ⊕ ipad) || m))
</code></pre>
<p>Where:</p>
<ul>
<li><strong>K</strong> = secret key</li>
<li><strong>m</strong> = message</li>
<li><strong>H</strong> = cryptographic hash function (SHA-256, SHA-512, etc.)</li>
<li><strong>K'</strong> = key derived from K (padded/hashed to block size)</li>
<li><strong>⊕</strong> = XOR operation</li>
<li><strong>||</strong> = concatenation</li>
<li><strong>opad</strong> = outer padding (0x5c repeated)</li>
<li><strong>ipad</strong> = inner padding (0x36 repeated)</li>
</ul>
<h3 id="simplified-steps"><a class="header" href="#simplified-steps">Simplified Steps</a></h3>
<pre><code>1. If key is longer than block size, hash it
2. If key is shorter than block size, pad with zeros
3. XOR key with inner padding (ipad)
4. Append message to result
5. Hash the result (inner hash)
6. XOR key with outer padding (opad)
7. Append inner hash to result
8. Hash the result (outer hash) = HMAC
</code></pre>
<h3 id="visual-representation-2"><a class="header" href="#visual-representation-2">Visual Representation</a></h3>
<pre><code>        Secret Key
             |
      +------+------+
      |             |
    XOR ipad     XOR opad
      |             |
      + Message     |
      |             |
   Hash (inner)     |
      |             |
      +-------------+
            |
         Hash (outer)
            |
          HMAC
</code></pre>
<h2 id="why-hmac-instead-of-hashkey--message"><a class="header" href="#why-hmac-instead-of-hashkey--message">Why HMAC Instead of Hash(Key + Message)?</a></h2>
<h3 id="vulnerable-approaches"><a class="header" href="#vulnerable-approaches">Vulnerable Approaches</a></h3>
<pre><code class="language-python"># VULNERABLE 1: Simple concatenation
tag = sha256(key + message)
# Vulnerable to length extension attacks!

# VULNERABLE 2: Wrong order
tag = sha256(message + key)
# Attacker can append data!

# SECURE: Use HMAC
tag = hmac.new(key, message, sha256).digest()
</code></pre>
<h3 id="length-extension-attack-example"><a class="header" href="#length-extension-attack-example">Length Extension Attack Example</a></h3>
<pre><code class="language-python"># With SHA-256 concatenation (VULNERABLE)
original = sha256(key + message)
# Attacker can compute: sha256(key + message + attacker_data)
# WITHOUT knowing the key!

# With HMAC (SECURE)
original = hmac(key, message)
# Attacker CANNOT extend the message without knowing the key
</code></pre>
<h2 id="using-hmac"><a class="header" href="#using-hmac">Using HMAC</a></h2>
<h3 id="python-examples"><a class="header" href="#python-examples">Python Examples</a></h3>
<h4 id="basic-hmac"><a class="header" href="#basic-hmac">Basic HMAC</a></h4>
<pre><code class="language-python">import hmac
import hashlib

# Create HMAC
key = b"secret-key-12345"
message = b"Important message"

# HMAC-SHA256
mac = hmac.new(key, message, hashlib.sha256)
tag = mac.hexdigest()
print(f"HMAC-SHA256: {tag}")

# HMAC-SHA512
mac = hmac.new(key, message, hashlib.sha512)
tag = mac.hexdigest()
print(f"HMAC-SHA512: {tag}")

# Digest as bytes
tag_bytes = hmac.new(key, message, hashlib.sha256).digest()
print(f"HMAC (bytes): {tag_bytes}")
</code></pre>
<h4 id="verify-hmac"><a class="header" href="#verify-hmac">Verify HMAC</a></h4>
<pre><code class="language-python">import hmac
import hashlib

def create_hmac(key, message):
    return hmac.new(key, message, hashlib.sha256).digest()

def verify_hmac(key, message, received_tag):
    expected_tag = hmac.new(key, message, hashlib.sha256).digest()
    # Use constant-time comparison to prevent timing attacks
    return hmac.compare_digest(expected_tag, received_tag)

# Usage
key = b"secret-key"
message = b"Transfer $100 to Alice"

# Create tag
tag = create_hmac(key, message)
print(f"Tag: {tag.hex()}")

# Verify tag (correct)
if verify_hmac(key, message, tag):
    print("Message is authentic!")

# Verify tag (tampered message)
tampered = b"Transfer $999 to Alice"
if not verify_hmac(key, tampered, tag):
    print("Message has been tampered with!")
</code></pre>
<h4 id="incremental-hmac"><a class="header" href="#incremental-hmac">Incremental HMAC</a></h4>
<pre><code class="language-python">import hmac
import hashlib

# For large messages
mac = hmac.new(b"secret-key", digestmod=hashlib.sha256)

# Update incrementally
mac.update(b"Part 1 of message ")
mac.update(b"Part 2 of message ")
mac.update(b"Part 3 of message")

tag = mac.hexdigest()
print(f"Incremental HMAC: {tag}")

# Equivalent to
mac_full = hmac.new(b"secret-key", 
                    b"Part 1 of message Part 2 of message Part 3 of message",
                    hashlib.sha256)
print(f"Full HMAC: {mac_full.hexdigest()}")
</code></pre>
<h3 id="opensslbash-examples"><a class="header" href="#opensslbash-examples">OpenSSL/Bash Examples</a></h3>
<pre><code class="language-bash"># Generate HMAC-SHA256
echo -n "Important message" | openssl dgst -sha256 -hmac "secret-key"

# HMAC-SHA512
echo -n "Important message" | openssl dgst -sha512 -hmac "secret-key"

# HMAC of a file
openssl dgst -sha256 -hmac "secret-key" document.pdf

# Output in different formats
echo -n "message" | openssl dgst -sha256 -hmac "key" -hex
echo -n "message" | openssl dgst -sha256 -hmac "key" -binary | base64
</code></pre>
<h3 id="javascript-example"><a class="header" href="#javascript-example">JavaScript Example</a></h3>
<pre><code class="language-javascript">const crypto = require('crypto');

// Create HMAC
const key = 'secret-key-12345';
const message = 'Important message';

const hmac = crypto.createHmac('sha256', key);
hmac.update(message);
const tag = hmac.digest('hex');

console.log(`HMAC-SHA256: ${tag}`);

// Verify HMAC
function verifyHMAC(key, message, receivedTag) {
    const expectedTag = crypto.createHmac('sha256', key)
                             .update(message)
                             .digest('hex');
    
    // Constant-time comparison
    return crypto.timingSafeEqual(
        Buffer.from(expectedTag, 'hex'),
        Buffer.from(receivedTag, 'hex')
    );
}
</code></pre>
<h2 id="message-authentication"><a class="header" href="#message-authentication">Message Authentication</a></h2>
<h3 id="sending-authenticated-messages"><a class="header" href="#sending-authenticated-messages">Sending Authenticated Messages</a></h3>
<pre><code class="language-python">import hmac
import hashlib
import json

class AuthenticatedMessage:
    def __init__(self, shared_key):
        self.key = shared_key
    
    def send(self, message):
        # Create HMAC tag
        tag = hmac.new(self.key, message.encode(), hashlib.sha256).hexdigest()
        
        # Package message with tag
        package = {
            'message': message,
            'hmac': tag
        }
        return json.dumps(package)
    
    def receive(self, package_json):
        # Unpack message
        package = json.loads(package_json)
        message = package['message']
        received_tag = package['hmac']
        
        # Verify HMAC
        expected_tag = hmac.new(self.key, message.encode(), hashlib.sha256).hexdigest()
        
        if hmac.compare_digest(expected_tag, received_tag):
            return message, True
        else:
            return None, False

# Usage
shared_key = b"shared-secret-key-between-alice-and-bob"

# Alice sends message
alice = AuthenticatedMessage(shared_key)
package = alice.send("Transfer $100 to Bob")
print(f"Sent: {package}")

# Bob receives message
bob = AuthenticatedMessage(shared_key)
message, is_authentic = bob.receive(package)

if is_authentic:
    print(f"Authentic message: {message}")
else:
    print("Warning: Message tampered!")

# Attacker tries to tamper
tampered_package = package.replace("$100", "$999")
message, is_authentic = bob.receive(tampered_package)
print(f"Tampered authentic: {is_authentic}")  # False
</code></pre>
<h2 id="integrity-verification"><a class="header" href="#integrity-verification">Integrity Verification</a></h2>
<h3 id="file-integrity-with-hmac"><a class="header" href="#file-integrity-with-hmac">File Integrity with HMAC</a></h3>
<pre><code class="language-python">import hmac
import hashlib
import os

class FileIntegrityChecker:
    def __init__(self, key):
        self.key = key
    
    def compute_file_hmac(self, filepath):
        mac = hmac.new(self.key, digestmod=hashlib.sha256)
        
        with open(filepath, 'rb') as f:
            while chunk := f.read(8192):
                mac.update(chunk)
        
        return mac.hexdigest()
    
    def create_manifest(self, files):
        manifest = {}
        for filepath in files:
            manifest[filepath] = self.compute_file_hmac(filepath)
        return manifest
    
    def verify_files(self, manifest):
        results = {}
        for filepath, expected_hmac in manifest.items():
            if not os.path.exists(filepath):
                results[filepath] = "MISSING"
            else:
                actual_hmac = self.compute_file_hmac(filepath)
                if hmac.compare_digest(expected_hmac, actual_hmac):
                    results[filepath] = "OK"
                else:
                    results[filepath] = "MODIFIED"
        return results

# Usage
checker = FileIntegrityChecker(b"integrity-check-key")

# Create manifest
files = ['config.json', 'app.py', 'data.db']
manifest = checker.create_manifest(files)
print("Manifest created:", manifest)

# Later, verify files
results = checker.verify_files(manifest)
for file, status in results.items():
    print(f"{file}: {status}")
</code></pre>
<h2 id="api-authentication"><a class="header" href="#api-authentication">API Authentication</a></h2>
<h3 id="api-request-signing"><a class="header" href="#api-request-signing">API Request Signing</a></h3>
<pre><code class="language-python">import hmac
import hashlib
import time
import requests
from urllib.parse import urlencode

class APIClient:
    def __init__(self, api_key, api_secret):
        self.api_key = api_key
        self.api_secret = api_secret.encode()
    
    def generate_signature(self, method, path, params):
        # Create string to sign
        timestamp = str(int(time.time()))
        params['timestamp'] = timestamp
        params['api_key'] = self.api_key
        
        # Sort parameters
        sorted_params = sorted(params.items())
        query_string = urlencode(sorted_params)
        
        # String to sign: METHOD + PATH + QUERY_STRING
        message = f"{method}{path}{query_string}"
        
        # Generate HMAC signature
        signature = hmac.new(
            self.api_secret,
            message.encode(),
            hashlib.sha256
        ).hexdigest()
        
        return signature, timestamp
    
    def make_request(self, method, path, params=None):
        if params is None:
            params = {}
        
        # Generate signature
        signature, timestamp = self.generate_signature(method, path, params)
        
        # Add authentication headers
        headers = {
            'X-API-Key': self.api_key,
            'X-API-Signature': signature,
            'X-API-Timestamp': timestamp
        }
        
        # Make request
        url = f"https://api.example.com{path}"
        response = requests.request(method, url, params=params, headers=headers)
        
        return response

# Server-side verification
class APIServer:
    def __init__(self):
        # In practice, look up secret from database based on API key
        self.api_secrets = {
            'key123': b'secret123'
        }
    
    def verify_signature(self, api_key, signature, timestamp, method, path, params):
        # Check timestamp (prevent replay attacks)
        current_time = int(time.time())
        request_time = int(timestamp)
        
        if abs(current_time - request_time) &gt; 300:  # 5 minutes
            return False, "Request expired"
        
        # Get API secret
        if api_key not in self.api_secrets:
            return False, "Invalid API key"
        
        api_secret = self.api_secrets[api_key]
        
        # Reconstruct signed message
        params['timestamp'] = timestamp
        params['api_key'] = api_key
        sorted_params = sorted(params.items())
        query_string = urlencode(sorted_params)
        message = f"{method}{path}{query_string}"
        
        # Compute expected signature
        expected_signature = hmac.new(
            api_secret,
            message.encode(),
            hashlib.sha256
        ).hexdigest()
        
        # Compare signatures (constant time)
        if hmac.compare_digest(expected_signature, signature):
            return True, "Valid"
        else:
            return False, "Invalid signature"

# Usage
client = APIClient('key123', 'secret123')
response = client.make_request('GET', '/api/users', {'limit': 10})
</code></pre>
<h3 id="rest-api-with-hmac-authentication"><a class="header" href="#rest-api-with-hmac-authentication">REST API with HMAC Authentication</a></h3>
<pre><code class="language-python">from flask import Flask, request, jsonify
import hmac
import hashlib

app = Flask(__name__)

API_SECRETS = {
    'client1': b'secret1',
    'client2': b'secret2'
}

def verify_hmac_signature():
    api_key = request.headers.get('X-API-Key')
    signature = request.headers.get('X-Signature')
    
    if not api_key or not signature:
        return False
    
    if api_key not in API_SECRETS:
        return False
    
    # Reconstruct signed data
    # Method + Path + Body (for POST/PUT)
    data = request.method + request.path
    
    if request.data:
        data += request.data.decode()
    
    # Compute expected signature
    expected = hmac.new(
        API_SECRETS[api_key],
        data.encode(),
        hashlib.sha256
    ).hexdigest()
    
    return hmac.compare_digest(expected, signature)

@app.route('/api/data', methods=['POST'])
def post_data():
    if not verify_hmac_signature():
        return jsonify({'error': 'Unauthorized'}), 401
    
    # Process request
    data = request.json
    return jsonify({'status': 'success', 'data': data})

# Client request example
import requests
import hmac
import hashlib

api_key = 'client1'
api_secret = b'secret1'
url = 'http://localhost:5000/api/data'
payload = {'key': 'value'}

# Create signature
data = 'POST' + '/api/data' + json.dumps(payload)
signature = hmac.new(api_secret, data.encode(), hashlib.sha256).hexdigest()

headers = {
    'X-API-Key': api_key,
    'X-Signature': signature,
    'Content-Type': 'application/json'
}

response = requests.post(url, json=payload, headers=headers)
</code></pre>
<h2 id="jwt-json-web-tokens-1"><a class="header" href="#jwt-json-web-tokens-1">JWT (JSON Web Tokens)</a></h2>
<p>JWTs use HMAC (or RSA) for signature verification.</p>
<h3 id="jwt-structure"><a class="header" href="#jwt-structure">JWT Structure</a></h3>
<pre><code>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c
|                                      |                                                                                |                                              |
            Header                                              Payload                                                              Signature
</code></pre>
<h3 id="jwt-with-hmac"><a class="header" href="#jwt-with-hmac">JWT with HMAC</a></h3>
<pre><code class="language-python">import hmac
import hashlib
import json
import base64

class JWT:
    def __init__(self, secret):
        self.secret = secret.encode()
    
    def base64url_encode(self, data):
        return base64.urlsafe_b64encode(data).rstrip(b'=').decode()
    
    def base64url_decode(self, data):
        padding = 4 - len(data) % 4
        data += '=' * padding
        return base64.urlsafe_b64decode(data)
    
    def create_token(self, payload):
        # Header
        header = {
            'alg': 'HS256',
            'typ': 'JWT'
        }
        
        # Encode header and payload
        header_encoded = self.base64url_encode(json.dumps(header).encode())
        payload_encoded = self.base64url_encode(json.dumps(payload).encode())
        
        # Create signature
        message = f"{header_encoded}.{payload_encoded}".encode()
        signature = hmac.new(self.secret, message, hashlib.sha256).digest()
        signature_encoded = self.base64url_encode(signature)
        
        # Combine
        token = f"{header_encoded}.{payload_encoded}.{signature_encoded}"
        return token
    
    def verify_token(self, token):
        try:
            parts = token.split('.')
            if len(parts) != 3:
                return None, False
            
            header_encoded, payload_encoded, signature_encoded = parts
            
            # Verify signature
            message = f"{header_encoded}.{payload_encoded}".encode()
            expected_signature = hmac.new(self.secret, message, hashlib.sha256).digest()
            received_signature = self.base64url_decode(signature_encoded)
            
            if not hmac.compare_digest(expected_signature, received_signature):
                return None, False
            
            # Decode payload
            payload = json.loads(self.base64url_decode(payload_encoded))
            return payload, True
            
        except Exception as e:
            return None, False

# Usage
jwt = JWT('my-secret-key')

# Create token
payload = {
    'user_id': 12345,
    'username': 'john_doe',
    'exp': int(time.time()) + 3600  # Expires in 1 hour
}

token = jwt.create_token(payload)
print(f"JWT: {token}")

# Verify token
payload, is_valid = jwt.verify_token(token)
if is_valid:
    print(f"Valid token! User: {payload['username']}")
else:
    print("Invalid token!")

# Using PyJWT library (recommended)
import jwt as pyjwt

# Create token
token = pyjwt.encode(payload, 'my-secret-key', algorithm='HS256')

# Verify token
try:
    decoded = pyjwt.decode(token, 'my-secret-key', algorithms=['HS256'])
    print(f"Valid! Payload: {decoded}")
except pyjwt.InvalidTokenError:
    print("Invalid token!")
</code></pre>
<h2 id="hmac-vs-other-macs"><a class="header" href="#hmac-vs-other-macs">HMAC vs Other MACs</a></h2>
<h3 id="comparison-2"><a class="header" href="#comparison-2">Comparison</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Feature</th><th>HMAC</th><th>CBC-MAC</th><th>GMAC</th><th>Poly1305</th></tr></thead><tbody>
<tr><td><strong>Based on</strong></td><td>Hash function</td><td>Block cipher</td><td>Block cipher</td><td>Universal hash</td></tr>
<tr><td><strong>Performance</strong></td><td>Moderate</td><td>Slow</td><td>Fast</td><td>Very fast</td></tr>
<tr><td><strong>Key reuse</strong></td><td>Safe</td><td>Dangerous</td><td>Safe</td><td>One-time key</td></tr>
<tr><td><strong>Standardized</strong></td><td>Yes (RFC 2104)</td><td>Yes</td><td>Yes (GCM)</td><td>Yes (ChaCha20)</td></tr>
<tr><td><strong>Use case</strong></td><td>General purpose</td><td>Legacy</td><td>AEAD</td><td>Modern crypto</td></tr>
</tbody></table>
</div>
<h3 id="hmac-sha256-vs-hmac-sha512"><a class="header" href="#hmac-sha256-vs-hmac-sha512">HMAC-SHA256 vs HMAC-SHA512</a></h3>
<pre><code class="language-python">import hmac
import hashlib
import time

message = b"x" * 1000000  # 1 MB
key = b"secret-key"

# HMAC-SHA256
start = time.time()
for _ in range(100):
    hmac.new(key, message, hashlib.sha256).digest()
print(f"HMAC-SHA256: {time.time() - start:.3f}s")

# HMAC-SHA512
start = time.time()
for _ in range(100):
    hmac.new(key, message, hashlib.sha512).digest()
print(f"HMAC-SHA512: {time.time() - start:.3f}s")

# Output sizes
print(f"SHA256 output: {len(hmac.new(key, b'test', hashlib.sha256).digest())} bytes")
print(f"SHA512 output: {len(hmac.new(key, b'test', hashlib.sha512).digest())} bytes")
</code></pre>
<h2 id="security-considerations-4"><a class="header" href="#security-considerations-4">Security Considerations</a></h2>
<h3 id="1-key-length"><a class="header" href="#1-key-length">1. Key Length</a></h3>
<pre><code class="language-python"># Minimum key length = hash output size
# SHA-256: minimum 32 bytes
# SHA-512: minimum 64 bytes

# GOOD
key = os.urandom(32)  # 256 bits for HMAC-SHA256

# BAD - too short
key = b"secret"  # Only 48 bits!

# Better - derive from password
from hashlib import pbkdf2_hmac
key = pbkdf2_hmac('sha256', b'user-password', b'salt', 100000)
</code></pre>
<h3 id="2-constant-time-comparison"><a class="header" href="#2-constant-time-comparison">2. Constant-Time Comparison</a></h3>
<pre><code class="language-python"># VULNERABLE - timing attack
if computed_hmac == received_hmac:
    return True

# SECURE - constant time comparison
import hmac
if hmac.compare_digest(computed_hmac, received_hmac):
    return True
</code></pre>
<h3 id="3-prevent-replay-attacks"><a class="header" href="#3-prevent-replay-attacks">3. Prevent Replay Attacks</a></h3>
<pre><code class="language-python">import time

def verify_request(hmac_tag, timestamp, max_age=300):
    # Verify HMAC first
    if not verify_hmac(hmac_tag):
        return False
    
    # Check timestamp (prevent replays)
    current_time = int(time.time())
    request_time = int(timestamp)
    
    if abs(current_time - request_time) &gt; max_age:
        return False  # Request too old
    
    # Optional: Track used nonces to prevent replay
    # if nonce in used_nonces:
    #     return False
    
    return True
</code></pre>
<h3 id="4-use-separate-keys"><a class="header" href="#4-use-separate-keys">4. Use Separate Keys</a></h3>
<pre><code class="language-python"># BAD - same key for different purposes
encryption_key = b"shared-key"
hmac_key = b"shared-key"

# GOOD - derive separate keys
from hashlib import sha256

master_key = b"master-secret-key"
encryption_key = sha256(master_key + b"encryption").digest()
hmac_key = sha256(master_key + b"authentication").digest()

# BETTER - use HKDF (HMAC-based Key Derivation)
from cryptography.hazmat.primitives import hashes
from cryptography.hazmat.primitives.kdf.hkdf import HKDF

master_key = b"master-secret-key"

hkdf = HKDF(
    algorithm=hashes.SHA256(),
    length=32,
    salt=None,
    info=b'encryption',
)
encryption_key = hkdf.derive(master_key)

hkdf = HKDF(
    algorithm=hashes.SHA256(),
    length=32,
    salt=None,
    info=b'authentication',
)
hmac_key = hkdf.derive(master_key)
</code></pre>
<h3 id="5-truncation"><a class="header" href="#5-truncation">5. Truncation</a></h3>
<pre><code class="language-python"># Full HMAC (recommended)
mac = hmac.new(key, message, hashlib.sha256).digest()  # 32 bytes

# Truncated HMAC (if needed)
mac_truncated = hmac.new(key, message, hashlib.sha256).digest()[:16]  # 16 bytes

# Minimum recommended: 128 bits (16 bytes)
# Never go below 80 bits (10 bytes)
</code></pre>
<h2 id="best-practices-33"><a class="header" href="#best-practices-33">Best Practices</a></h2>
<h3 id="1-always-use-hmac-for-message-authentication"><a class="header" href="#1-always-use-hmac-for-message-authentication">1. Always Use HMAC for Message Authentication</a></h3>
<pre><code class="language-python"># ✓ Use HMAC
tag = hmac.new(key, message, hashlib.sha256).digest()

# ✗ Don't use simple hash
tag = hashlib.sha256(key + message).digest()  # Vulnerable!
</code></pre>
<h3 id="2-choose-appropriate-hash-function"><a class="header" href="#2-choose-appropriate-hash-function">2. Choose Appropriate Hash Function</a></h3>
<pre><code class="language-python"># Modern: SHA-256 or SHA-512
hmac.new(key, message, hashlib.sha256)

# Avoid: MD5 or SHA-1
hmac.new(key, message, hashlib.md5)  # Don't use!
</code></pre>
<h3 id="3-protect-the-key"><a class="header" href="#3-protect-the-key">3. Protect the Key</a></h3>
<pre><code class="language-python"># Store keys securely
# - Use environment variables
# - Use key management service (AWS KMS, etc.)
# - Never hardcode in source code
# - Never commit to version control

import os
key = os.environ.get('HMAC_KEY').encode()

# Rotate keys periodically
# Support multiple active keys during rotation
</code></pre>
<h3 id="4-include-all-relevant-data"><a class="header" href="#4-include-all-relevant-data">4. Include All Relevant Data</a></h3>
<pre><code class="language-python"># Sign complete context
data = {
    'timestamp': timestamp,
    'user_id': user_id,
    'action': action,
    'nonce': nonce
}

message = json.dumps(data, sort_keys=True).encode()
signature = hmac.new(key, message, hashlib.sha256).hexdigest()
</code></pre>
<h2 id="common-mistakes-4"><a class="header" href="#common-mistakes-4">Common Mistakes</a></h2>
<h3 id="1-using--for-comparison"><a class="header" href="#1-using--for-comparison">1. Using == for Comparison</a></h3>
<pre><code class="language-python"># WRONG - timing attack
if hmac1 == hmac2:
    pass

# RIGHT - constant time
if hmac.compare_digest(hmac1, hmac2):
    pass
</code></pre>
<h3 id="2-not-including-timestamp"><a class="header" href="#2-not-including-timestamp">2. Not Including Timestamp</a></h3>
<pre><code class="language-python"># WRONG - vulnerable to replay
signature = hmac.new(key, message, sha256).hexdigest()

# RIGHT - include timestamp
data = f"{timestamp}:{message}"
signature = hmac.new(key, data.encode(), sha256).hexdigest()
</code></pre>
<h3 id="3-wrong-key-derivation"><a class="header" href="#3-wrong-key-derivation">3. Wrong Key Derivation</a></h3>
<pre><code class="language-python"># WRONG - weak key
key = b"password"

# RIGHT - derive from password
from hashlib import pbkdf2_hmac
key = pbkdf2_hmac('sha256', b'password', b'salt', 100000)
</code></pre>
<h2 id="eli10-12"><a class="header" href="#eli10-12">ELI10</a></h2>
<p>HMAC is like a secret handshake for messages:</p>
<p>Imagine you and your best friend have a secret code:</p>
<ol>
<li>You write a message: "Meet at the treehouse at 3pm"</li>
<li>You add your secret code and mix it all together in a special way</li>
<li>You get a "stamp": <code>a7f9e4b2...</code></li>
<li>You send: message + stamp</li>
</ol>
<p>When your friend receives it:</p>
<ol>
<li>They take the message</li>
<li>They add the SAME secret code and mix it the SAME way</li>
<li>They get their own stamp</li>
<li>If their stamp matches yours, they know:
<ul>
<li>The message really came from you (only you know the code!)</li>
<li>Nobody changed the message (the stamp would be different!)</li>
</ul>
</li>
</ol>
<p><strong>Why not just put the secret code in the message?</strong></p>
<ul>
<li>Anyone could copy your code!</li>
</ul>
<p><strong>Why not just hash the message?</strong></p>
<ul>
<li>Anyone could make their own hash!</li>
</ul>
<p><strong>HMAC is special because:</strong></p>
<ul>
<li>You need the secret code to make the stamp</li>
<li>Even a tiny change makes a completely different stamp</li>
<li>Nobody can make the right stamp without knowing your secret code!</li>
</ul>
<p><strong>Real-world example:</strong>
When you log into a website, your browser and the server use HMAC to:</p>
<ul>
<li>Make sure messages aren't tampered with</li>
<li>Prove who sent the message</li>
<li>Keep your session secure!</li>
</ul>
<h2 id="further-resources-12"><a class="header" href="#further-resources-12">Further Resources</a></h2>
<ul>
<li><a href="https://tools.ietf.org/html/rfc2104">RFC 2104 - HMAC Specification</a></li>
<li><a href="https://csrc.nist.gov/publications/detail/fips/198/1/final">HMAC Security Analysis</a></li>
<li><a href="https://tools.ietf.org/html/rfc7519">JWT Specification (RFC 7519)</a></li>
<li><a href="https://owasp.org/www-project-api-security/">API Authentication Best Practices</a></li>
<li><a href="https://codahale.com/a-lesson-in-timing-attacks/">Timing Attack Prevention</a></li>
<li><a href="https://tools.ietf.org/html/rfc5869">HKDF Specification (RFC 5869)</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="oauth-20-1"><a class="header" href="#oauth-20-1">OAuth 2.0</a></h1>
<p>OAuth 2.0 is an industry-standard authorization framework that enables applications to obtain limited access to user accounts on an HTTP service. It works by delegating user authentication to the service that hosts the user account and authorizing third-party applications to access the user account.</p>
<h2 id="table-of-contents-11"><a class="header" href="#table-of-contents-11">Table of Contents</a></h2>
<ul>
<li><a href="security/oauth2.html#introduction">Introduction</a></li>
<li><a href="security/oauth2.html#oauth-20-roles">OAuth 2.0 Roles</a></li>
<li><a href="security/oauth2.html#grant-types">Grant Types</a></li>
<li><a href="security/oauth2.html#authorization-code-flow">Authorization Code Flow</a></li>
<li><a href="security/oauth2.html#client-credentials-flow">Client Credentials Flow</a></li>
<li><a href="security/oauth2.html#implementing-oauth-20">Implementing OAuth 2.0</a></li>
<li><a href="security/oauth2.html#oauth-20-providers">OAuth 2.0 Providers</a></li>
<li><a href="security/oauth2.html#security-best-practices">Security Best Practices</a></li>
<li><a href="security/oauth2.html#common-vulnerabilities">Common Vulnerabilities</a></li>
</ul>
<hr />
<h2 id="introduction-2"><a class="header" href="#introduction-2">Introduction</a></h2>
<p><strong>What is OAuth 2.0?</strong>
OAuth 2.0 is an authorization framework, not an authentication protocol. It allows users to grant limited access to their resources on one site to another site, without sharing their credentials.</p>
<p><strong>Key Benefits:</strong></p>
<ul>
<li>Users don't share passwords with third-party apps</li>
<li>Fine-grained access control (scopes)</li>
<li>Time-limited access through tokens</li>
<li>Revocable access</li>
<li>Industry standard with wide support</li>
</ul>
<p><strong>Use Cases:</strong></p>
<ul>
<li>Social login (Sign in with Google, Facebook, etc.)</li>
<li>API access delegation</li>
<li>Third-party application integration</li>
<li>Microservices authentication</li>
<li>Mobile app authentication</li>
</ul>
<hr />
<h2 id="oauth-20-roles"><a class="header" href="#oauth-20-roles">OAuth 2.0 Roles</a></h2>
<h3 id="1-resource-owner"><a class="header" href="#1-resource-owner">1. Resource Owner</a></h3>
<p>The user who owns the data and can grant access to it.</p>
<pre><code>Example: John who has a Google account with photos
</code></pre>
<h3 id="2-client"><a class="header" href="#2-client">2. Client</a></h3>
<p>The application requesting access to resources.</p>
<pre><code>Example: A photo printing service that wants access to John's photos
</code></pre>
<h3 id="3-authorization-server"><a class="header" href="#3-authorization-server">3. Authorization Server</a></h3>
<p>Server that authenticates the resource owner and issues access tokens.</p>
<pre><code>Example: Google's OAuth 2.0 authorization server
</code></pre>
<h3 id="4-resource-server"><a class="header" href="#4-resource-server">4. Resource Server</a></h3>
<p>Server hosting the protected resources.</p>
<pre><code>Example: Google Photos API server
</code></pre>
<hr />
<h2 id="grant-types"><a class="header" href="#grant-types">Grant Types</a></h2>
<h3 id="1-authorization-code-flow"><a class="header" href="#1-authorization-code-flow">1. Authorization Code Flow</a></h3>
<p><strong>Best for:</strong> Server-side web applications</p>
<p><strong>Flow:</strong></p>
<pre><code>1. Client redirects user to authorization server
2. User authenticates and grants permission
3. Authorization server redirects back with authorization code
4. Client exchanges code for access token
5. Client uses access token to access resources
</code></pre>
<p><strong>Benefits:</strong></p>
<ul>
<li>Most secure flow</li>
<li>Refresh tokens supported</li>
<li>Client secret never exposed to browser</li>
</ul>
<h3 id="2-implicit-flow-deprecated"><a class="header" href="#2-implicit-flow-deprecated">2. Implicit Flow (Deprecated)</a></h3>
<p><strong>Status:</strong> Not recommended for new applications</p>
<p><strong>Flow:</strong></p>
<pre><code>1. Client redirects user to authorization server
2. User authenticates and grants permission
3. Authorization server redirects with access token in URL fragment
</code></pre>
<p><strong>Issues:</strong></p>
<ul>
<li>Token exposed in browser history</li>
<li>No refresh token</li>
<li>Less secure</li>
</ul>
<h3 id="3-client-credentials-flow"><a class="header" href="#3-client-credentials-flow">3. Client Credentials Flow</a></h3>
<p><strong>Best for:</strong> Server-to-server communication</p>
<p><strong>Flow:</strong></p>
<pre><code>1. Client authenticates with client_id and client_secret
2. Authorization server returns access token
3. Client uses access token for API calls
</code></pre>
<p><strong>Use cases:</strong></p>
<ul>
<li>Microservices communication</li>
<li>Batch jobs</li>
<li>CLI tools</li>
</ul>
<h3 id="4-resource-owner-password-credentials-not-recommended"><a class="header" href="#4-resource-owner-password-credentials-not-recommended">4. Resource Owner Password Credentials (Not Recommended)</a></h3>
<p><strong>Flow:</strong></p>
<pre><code>1. User provides username and password to client
2. Client exchanges credentials for access token
</code></pre>
<p><strong>Issues:</strong></p>
<ul>
<li>User shares credentials with client</li>
<li>Defeats OAuth purpose</li>
<li>Only for legacy systems</li>
</ul>
<h3 id="5-pkce-proof-key-for-code-exchange"><a class="header" href="#5-pkce-proof-key-for-code-exchange">5. PKCE (Proof Key for Code Exchange)</a></h3>
<p><strong>Best for:</strong> Mobile and SPA applications</p>
<p><strong>Enhancement to Authorization Code Flow:</strong></p>
<pre><code>1. Client generates code_verifier (random string)
2. Client creates code_challenge = hash(code_verifier)
3. Authorization request includes code_challenge
4. Token request includes code_verifier
5. Server verifies code_challenge matches code_verifier
</code></pre>
<p><strong>Benefits:</strong></p>
<ul>
<li>Protects against authorization code interception</li>
<li>No client secret needed</li>
<li>Secure for public clients</li>
</ul>
<hr />
<h2 id="authorization-code-flow"><a class="header" href="#authorization-code-flow">Authorization Code Flow</a></h2>
<h3 id="step-by-step-implementation"><a class="header" href="#step-by-step-implementation">Step-by-Step Implementation</a></h3>
<h4 id="step-1-authorization-request"><a class="header" href="#step-1-authorization-request">Step 1: Authorization Request</a></h4>
<pre><code class="language-http">GET /authorize?
  response_type=code&amp;
  client_id=YOUR_CLIENT_ID&amp;
  redirect_uri=https://yourapp.com/callback&amp;
  scope=read:user read:email&amp;
  state=random_string
  HTTP/1.1
Host: authorization-server.com
</code></pre>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>response_type</code>: Set to "code"</li>
<li><code>client_id</code>: Your application's client ID</li>
<li><code>redirect_uri</code>: Where to redirect after authorization</li>
<li><code>scope</code>: Requested permissions</li>
<li><code>state</code>: Random string to prevent CSRF</li>
</ul>
<h4 id="step-2-user-authorization"><a class="header" href="#step-2-user-authorization">Step 2: User Authorization</a></h4>
<p>User sees consent screen and approves/denies access.</p>
<h4 id="step-3-authorization-response"><a class="header" href="#step-3-authorization-response">Step 3: Authorization Response</a></h4>
<pre><code class="language-http">HTTP/1.1 302 Found
Location: https://yourapp.com/callback?
  code=AUTH_CODE&amp;
  state=random_string
</code></pre>
<h4 id="step-4-token-request"><a class="header" href="#step-4-token-request">Step 4: Token Request</a></h4>
<pre><code class="language-http">POST /token HTTP/1.1
Host: authorization-server.com
Content-Type: application/x-www-form-urlencoded

grant_type=authorization_code&amp;
code=AUTH_CODE&amp;
redirect_uri=https://yourapp.com/callback&amp;
client_id=YOUR_CLIENT_ID&amp;
client_secret=YOUR_CLIENT_SECRET
</code></pre>
<h4 id="step-5-token-response"><a class="header" href="#step-5-token-response">Step 5: Token Response</a></h4>
<pre><code class="language-json">{
  "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "token_type": "Bearer",
  "expires_in": 3600,
  "refresh_token": "refresh_token_here",
  "scope": "read:user read:email"
}
</code></pre>
<h4 id="step-6-using-access-token"><a class="header" href="#step-6-using-access-token">Step 6: Using Access Token</a></h4>
<pre><code class="language-http">GET /api/user HTTP/1.1
Host: api.example.com
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
</code></pre>
<h3 id="nodejs-implementation-express"><a class="header" href="#nodejs-implementation-express">Node.js Implementation (Express)</a></h3>
<pre><code class="language-javascript">const express = require('express');
const axios = require('axios');
const crypto = require('crypto');

const app = express();

const CLIENT_ID = process.env.CLIENT_ID;
const CLIENT_SECRET = process.env.CLIENT_SECRET;
const REDIRECT_URI = 'http://localhost:3000/callback';
const AUTHORIZATION_URL = 'https://authorization-server.com/authorize';
const TOKEN_URL = 'https://authorization-server.com/token';

// Step 1: Initiate authorization
app.get('/login', (req, res) =&gt; {
  const state = crypto.randomBytes(16).toString('hex');
  req.session.state = state;

  const authUrl = new URL(AUTHORIZATION_URL);
  authUrl.searchParams.append('response_type', 'code');
  authUrl.searchParams.append('client_id', CLIENT_ID);
  authUrl.searchParams.append('redirect_uri', REDIRECT_URI);
  authUrl.searchParams.append('scope', 'read:user read:email');
  authUrl.searchParams.append('state', state);

  res.redirect(authUrl.toString());
});

// Step 2: Handle callback
app.get('/callback', async (req, res) =&gt; {
  const { code, state } = req.query;

  // Verify state
  if (state !== req.session.state) {
    return res.status(400).send('Invalid state');
  }

  try {
    // Exchange code for token
    const tokenResponse = await axios.post(TOKEN_URL, {
      grant_type: 'authorization_code',
      code,
      redirect_uri: REDIRECT_URI,
      client_id: CLIENT_ID,
      client_secret: CLIENT_SECRET,
    });

    const { access_token, refresh_token } = tokenResponse.data;

    // Store tokens securely
    req.session.access_token = access_token;
    req.session.refresh_token = refresh_token;

    res.redirect('/dashboard');
  } catch (error) {
    res.status(500).send('Authentication failed');
  }
});

// Step 3: Use access token
app.get('/api/user', async (req, res) =&gt; {
  const { access_token } = req.session;

  if (!access_token) {
    return res.status(401).send('Not authenticated');
  }

  try {
    const userResponse = await axios.get('https://api.example.com/user', {
      headers: {
        Authorization: `Bearer ${access_token}`,
      },
    });

    res.json(userResponse.data);
  } catch (error) {
    if (error.response?.status === 401) {
      // Token expired, refresh it
      return res.redirect('/refresh');
    }
    res.status(500).send('Failed to fetch user');
  }
});

// Refresh token
app.get('/refresh', async (req, res) =&gt; {
  const { refresh_token } = req.session;

  try {
    const tokenResponse = await axios.post(TOKEN_URL, {
      grant_type: 'refresh_token',
      refresh_token,
      client_id: CLIENT_ID,
      client_secret: CLIENT_SECRET,
    });

    req.session.access_token = tokenResponse.data.access_token;

    res.redirect('/dashboard');
  } catch (error) {
    res.redirect('/login');
  }
});
</code></pre>
<hr />
<h2 id="client-credentials-flow"><a class="header" href="#client-credentials-flow">Client Credentials Flow</a></h2>
<h3 id="implementation-example"><a class="header" href="#implementation-example">Implementation Example</a></h3>
<pre><code class="language-javascript">const axios = require('axios');

async function getAccessToken() {
  const response = await axios.post(
    'https://authorization-server.com/token',
    {
      grant_type: 'client_credentials',
      client_id: process.env.CLIENT_ID,
      client_secret: process.env.CLIENT_SECRET,
      scope: 'api:read api:write',
    },
    {
      headers: {
        'Content-Type': 'application/x-www-form-urlencoded',
      },
    }
  );

  return response.data.access_token;
}

async function callAPI() {
  const token = await getAccessToken();

  const apiResponse = await axios.get('https://api.example.com/data', {
    headers: {
      Authorization: `Bearer ${token}`,
    },
  });

  return apiResponse.data;
}

// Usage
callAPI()
  .then(data =&gt; console.log(data))
  .catch(error =&gt; console.error(error));
</code></pre>
<hr />
<h2 id="implementing-oauth-20"><a class="header" href="#implementing-oauth-20">Implementing OAuth 2.0</a></h2>
<h3 id="building-an-oauth-20-server"><a class="header" href="#building-an-oauth-20-server">Building an OAuth 2.0 Server</a></h3>
<p><strong>Using Node.js with oauth2-server:</strong></p>
<pre><code class="language-bash">npm install express oauth2-server
</code></pre>
<p><strong>server.js:</strong></p>
<pre><code class="language-javascript">const express = require('express');
const OAuth2Server = require('oauth2-server');
const Request = OAuth2Server.Request;
const Response = OAuth2Server.Response;

const app = express();

// OAuth2 model
const model = {
  getClient: async (clientId, clientSecret) =&gt; {
    // Fetch client from database
    const client = await db.clients.findOne({ clientId });

    if (!client || (clientSecret &amp;&amp; client.clientSecret !== clientSecret)) {
      return null;
    }

    return {
      id: client.id,
      grants: ['authorization_code', 'refresh_token'],
      redirectUris: client.redirectUris,
    };
  },

  saveToken: async (token, client, user) =&gt; {
    // Save token to database
    await db.tokens.create({
      accessToken: token.accessToken,
      accessTokenExpiresAt: token.accessTokenExpiresAt,
      refreshToken: token.refreshToken,
      refreshTokenExpiresAt: token.refreshTokenExpiresAt,
      client: client.id,
      user: user.id,
    });

    return token;
  },

  getAccessToken: async (accessToken) =&gt; {
    const token = await db.tokens.findOne({ accessToken });

    if (!token) return null;

    return {
      accessToken: token.accessToken,
      accessTokenExpiresAt: token.accessTokenExpiresAt,
      client: { id: token.client },
      user: { id: token.user },
    };
  },

  getAuthorizationCode: async (authorizationCode) =&gt; {
    const code = await db.authCodes.findOne({ code: authorizationCode });

    if (!code) return null;

    return {
      code: code.code,
      expiresAt: code.expiresAt,
      redirectUri: code.redirectUri,
      client: { id: code.client },
      user: { id: code.user },
    };
  },

  saveAuthorizationCode: async (code, client, user) =&gt; {
    await db.authCodes.create({
      code: code.authorizationCode,
      expiresAt: code.expiresAt,
      redirectUri: code.redirectUri,
      client: client.id,
      user: user.id,
    });

    return code;
  },

  revokeAuthorizationCode: async (code) =&gt; {
    await db.authCodes.delete({ code: code.code });
    return true;
  },

  verifyScope: async (token, scope) =&gt; {
    if (!token.scope) return false;
    const requestedScopes = scope.split(' ');
    const authorizedScopes = token.scope.split(' ');
    return requestedScopes.every(s =&gt; authorizedScopes.includes(s));
  },
};

const oauth = new OAuth2Server({
  model: model,
  accessTokenLifetime: 3600,
  allowBearerTokensInQueryString: true,
});

// Authorization endpoint
app.get('/authorize', async (req, res) =&gt; {
  const request = new Request(req);
  const response = new Response(res);

  try {
    // Authenticate user (implement your own logic)
    const user = await authenticateUser(req);

    if (!user) {
      return res.redirect('/login');
    }

    const code = await oauth.authorize(request, response, {
      authenticateHandler: {
        handle: () =&gt; user,
      },
    });

    res.redirect(`${code.redirectUri}?code=${code.authorizationCode}&amp;state=${req.query.state}`);
  } catch (error) {
    res.status(error.code || 500).json(error);
  }
});

// Token endpoint
app.post('/token', async (req, res) =&gt; {
  const request = new Request(req);
  const response = new Response(res);

  try {
    const token = await oauth.token(request, response);
    res.json(token);
  } catch (error) {
    res.status(error.code || 500).json(error);
  }
});

// Protected resource
app.get('/api/resource', async (req, res) =&gt; {
  const request = new Request(req);
  const response = new Response(res);

  try {
    const token = await oauth.authenticate(request, response);
    res.json({ message: 'Protected resource', user: token.user });
  } catch (error) {
    res.status(error.code || 401).json({ error: 'Unauthorized' });
  }
});
</code></pre>
<hr />
<h2 id="oauth-20-providers"><a class="header" href="#oauth-20-providers">OAuth 2.0 Providers</a></h2>
<h3 id="google-oauth-20"><a class="header" href="#google-oauth-20">Google OAuth 2.0</a></h3>
<pre><code class="language-javascript">const passport = require('passport');
const GoogleStrategy = require('passport-google-oauth20').Strategy;

passport.use(new GoogleStrategy({
    clientID: process.env.GOOGLE_CLIENT_ID,
    clientSecret: process.env.GOOGLE_CLIENT_SECRET,
    callbackURL: "http://localhost:3000/auth/google/callback"
  },
  function(accessToken, refreshToken, profile, cb) {
    // Find or create user in your database
    User.findOrCreate({ googleId: profile.id }, function (err, user) {
      return cb(err, user);
    });
  }
));

app.get('/auth/google',
  passport.authenticate('google', { scope: ['profile', 'email'] })
);

app.get('/auth/google/callback',
  passport.authenticate('google', { failureRedirect: '/login' }),
  function(req, res) {
    res.redirect('/dashboard');
  }
);
</code></pre>
<h3 id="github-oauth-20"><a class="header" href="#github-oauth-20">GitHub OAuth 2.0</a></h3>
<pre><code class="language-javascript">const GitHubStrategy = require('passport-github2').Strategy;

passport.use(new GitHubStrategy({
    clientID: process.env.GITHUB_CLIENT_ID,
    clientSecret: process.env.GITHUB_CLIENT_SECRET,
    callbackURL: "http://localhost:3000/auth/github/callback"
  },
  function(accessToken, refreshToken, profile, done) {
    User.findOrCreate({ githubId: profile.id }, function (err, user) {
      return done(err, user);
    });
  }
));

app.get('/auth/github',
  passport.authenticate('github', { scope: [ 'user:email' ] })
);

app.get('/auth/github/callback',
  passport.authenticate('github', { failureRedirect: '/login' }),
  function(req, res) {
    res.redirect('/dashboard');
  }
);
</code></pre>
<h3 id="custom-oauth-20-client"><a class="header" href="#custom-oauth-20-client">Custom OAuth 2.0 Client</a></h3>
<pre><code class="language-javascript">class OAuth2Client {
  constructor(config) {
    this.clientId = config.clientId;
    this.clientSecret = config.clientSecret;
    this.redirectUri = config.redirectUri;
    this.authorizationUrl = config.authorizationUrl;
    this.tokenUrl = config.tokenUrl;
  }

  getAuthorizationUrl(state, scope) {
    const params = new URLSearchParams({
      response_type: 'code',
      client_id: this.clientId,
      redirect_uri: this.redirectUri,
      scope: scope.join(' '),
      state,
    });

    return `${this.authorizationUrl}?${params.toString()}`;
  }

  async exchangeCodeForToken(code) {
    const response = await fetch(this.tokenUrl, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/x-www-form-urlencoded',
      },
      body: new URLSearchParams({
        grant_type: 'authorization_code',
        code,
        redirect_uri: this.redirectUri,
        client_id: this.clientId,
        client_secret: this.clientSecret,
      }),
    });

    if (!response.ok) {
      throw new Error('Token exchange failed');
    }

    return await response.json();
  }

  async refreshToken(refreshToken) {
    const response = await fetch(this.tokenUrl, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/x-www-form-urlencoded',
      },
      body: new URLSearchParams({
        grant_type: 'refresh_token',
        refresh_token: refreshToken,
        client_id: this.clientId,
        client_secret: this.clientSecret,
      }),
    });

    if (!response.ok) {
      throw new Error('Token refresh failed');
    }

    return await response.json();
  }

  async getUserInfo(accessToken) {
    const response = await fetch('https://api.example.com/user', {
      headers: {
        Authorization: `Bearer ${accessToken}`,
      },
    });

    if (!response.ok) {
      throw new Error('Failed to fetch user info');
    }

    return await response.json();
  }
}

// Usage
const client = new OAuth2Client({
  clientId: process.env.CLIENT_ID,
  clientSecret: process.env.CLIENT_SECRET,
  redirectUri: 'http://localhost:3000/callback',
  authorizationUrl: 'https://provider.com/authorize',
  tokenUrl: 'https://provider.com/token',
});

// Generate authorization URL
const authUrl = client.getAuthorizationUrl('random_state', ['read:user', 'read:email']);

// Exchange code for token
const tokens = await client.exchangeCodeForToken('authorization_code');

// Get user info
const user = await client.getUserInfo(tokens.access_token);
</code></pre>
<hr />
<h2 id="security-best-practices-2"><a class="header" href="#security-best-practices-2">Security Best Practices</a></h2>
<h3 id="1-always-use-https"><a class="header" href="#1-always-use-https">1. Always Use HTTPS</a></h3>
<pre><code>All OAuth 2.0 endpoints must use HTTPS to prevent token interception
</code></pre>
<h3 id="2-validate-redirect-uris"><a class="header" href="#2-validate-redirect-uris">2. Validate Redirect URIs</a></h3>
<pre><code class="language-javascript">function validateRedirectUri(redirectUri, registeredUris) {
  return registeredUris.includes(redirectUri);
}
</code></pre>
<h3 id="3-use-state-parameter"><a class="header" href="#3-use-state-parameter">3. Use State Parameter</a></h3>
<pre><code class="language-javascript">const state = crypto.randomBytes(32).toString('hex');
req.session.oauthState = state;

// Verify on callback
if (req.query.state !== req.session.oauthState) {
  throw new Error('Invalid state parameter');
}
</code></pre>
<h3 id="4-implement-pkce"><a class="header" href="#4-implement-pkce">4. Implement PKCE</a></h3>
<pre><code class="language-javascript">// Generate code verifier
const codeVerifier = crypto.randomBytes(32).toString('base64url');

// Generate code challenge
const codeChallenge = crypto
  .createHash('sha256')
  .update(codeVerifier)
  .digest('base64url');

// Store code verifier
req.session.codeVerifier = codeVerifier;

// Include in authorization request
const authUrl = `${AUTHORIZATION_URL}?code_challenge=${codeChallenge}&amp;code_challenge_method=S256`;
</code></pre>
<h3 id="5-secure-token-storage"><a class="header" href="#5-secure-token-storage">5. Secure Token Storage</a></h3>
<pre><code class="language-javascript">// Never store tokens in localStorage or sessionStorage
// Use secure, httpOnly cookies
res.cookie('access_token', token, {
  httpOnly: true,
  secure: true,
  sameSite: 'strict',
  maxAge: 3600000,
});
</code></pre>
<h3 id="6-token-expiration"><a class="header" href="#6-token-expiration">6. Token Expiration</a></h3>
<pre><code class="language-javascript">// Always set token expiration
{
  "access_token": "...",
  "expires_in": 3600,
  "refresh_token": "..."
}

// Check expiration before use
if (Date.now() &gt;= tokenExpiresAt) {
  // Refresh token
  await refreshAccessToken();
}
</code></pre>
<h3 id="7-scope-limitation"><a class="header" href="#7-scope-limitation">7. Scope Limitation</a></h3>
<pre><code class="language-javascript">// Request only necessary scopes
const scopes = ['read:user', 'read:email']; // Don't request write access if not needed

// Validate scopes on the server
function validateScopes(requestedScopes, userGrantedScopes) {
  return requestedScopes.every(scope =&gt; userGrantedScopes.includes(scope));
}
</code></pre>
<hr />
<h2 id="common-vulnerabilities"><a class="header" href="#common-vulnerabilities">Common Vulnerabilities</a></h2>
<h3 id="1-authorization-code-interception"><a class="header" href="#1-authorization-code-interception">1. Authorization Code Interception</a></h3>
<p><strong>Vulnerability:</strong>
Attacker intercepts authorization code</p>
<p><strong>Mitigation:</strong>
Use PKCE (Proof Key for Code Exchange)</p>
<pre><code class="language-javascript">// Generate PKCE parameters
const codeVerifier = generateCodeVerifier();
const codeChallenge = generateCodeChallenge(codeVerifier);

// Store code_verifier securely
// Include code_challenge in authorization request
</code></pre>
<h3 id="2-redirect-uri-manipulation"><a class="header" href="#2-redirect-uri-manipulation">2. Redirect URI Manipulation</a></h3>
<p><strong>Vulnerability:</strong>
Attacker changes redirect_uri to malicious site</p>
<p><strong>Mitigation:</strong></p>
<pre><code class="language-javascript">// Strictly validate redirect URIs
const ALLOWED_REDIRECT_URIS = [
  'https://app.example.com/callback',
  'https://app.example.com/oauth/callback'
];

function validateRedirectUri(uri) {
  return ALLOWED_REDIRECT_URIS.includes(uri);
}
</code></pre>
<h3 id="3-csrf-attacks"><a class="header" href="#3-csrf-attacks">3. CSRF Attacks</a></h3>
<p><strong>Vulnerability:</strong>
Attacker tricks user into authorizing their account</p>
<p><strong>Mitigation:</strong></p>
<pre><code class="language-javascript">// Always use state parameter
const state = crypto.randomBytes(16).toString('hex');
req.session.state = state;

// Verify state on callback
if (req.query.state !== req.session.state) {
  throw new Error('CSRF detected');
}
</code></pre>
<h3 id="4-token-leakage"><a class="header" href="#4-token-leakage">4. Token Leakage</a></h3>
<p><strong>Vulnerability:</strong>
Tokens exposed in URLs, logs, or browser history</p>
<p><strong>Mitigation:</strong></p>
<pre><code class="language-javascript">// Never include tokens in URLs
// ❌ Bad
window.location.href = `/api/data?token=${accessToken}`;

// ✅ Good
fetch('/api/data', {
  headers: {
    'Authorization': `Bearer ${accessToken}`
  }
});
</code></pre>
<h3 id="5-insufficient-token-validation"><a class="header" href="#5-insufficient-token-validation">5. Insufficient Token Validation</a></h3>
<p><strong>Vulnerability:</strong>
Server doesn't properly validate tokens</p>
<p><strong>Mitigation:</strong></p>
<pre><code class="language-javascript">async function validateToken(token) {
  // 1. Verify token signature
  // 2. Check expiration
  // 3. Verify issuer
  // 4. Verify audience
  // 5. Check revocation status

  if (token.exp &lt; Date.now() / 1000) {
    throw new Error('Token expired');
  }

  if (token.iss !== EXPECTED_ISSUER) {
    throw new Error('Invalid issuer');
  }

  // Check if token is revoked
  const isRevoked = await checkRevocationList(token.jti);
  if (isRevoked) {
    throw new Error('Token revoked');
  }

  return true;
}
</code></pre>
<hr />
<h2 id="resources-8"><a class="header" href="#resources-8">Resources</a></h2>
<p><strong>Official Specifications:</strong></p>
<ul>
<li><a href="https://tools.ietf.org/html/rfc6749">RFC 6749 - OAuth 2.0</a></li>
<li><a href="https://tools.ietf.org/html/rfc7636">RFC 7636 - PKCE</a></li>
<li><a href="https://tools.ietf.org/html/draft-ietf-oauth-security-topics">OAuth 2.0 Security Best Practices</a></li>
</ul>
<p><strong>Learning Resources:</strong></p>
<ul>
<li><a href="https://aaronparecki.com/oauth-2-simplified/">OAuth 2.0 Simplified</a></li>
<li><a href="https://oauth.net/2/">OAuth.net</a></li>
<li><a href="https://auth0.com/docs">Auth0 Documentation</a></li>
</ul>
<p><strong>Tools:</strong></p>
<ul>
<li><a href="https://www.oauth.com/playground/">OAuth 2.0 Playground</a></li>
<li><a href="https://oauthdebugger.com/">OAuth Debugger</a></li>
</ul>
<p><strong>Libraries:</strong></p>
<ul>
<li><a href="http://www.passportjs.org/">Passport.js</a> (Node.js)</li>
<li><a href="https://github.com/oauthjs/node-oauth2-server">OAuth2 Server</a> (Node.js)</li>
<li><a href="https://authlib.org/">Authlib</a> (Python)</li>
<li><a href="https://spring.io/projects/spring-security-oauth">Spring Security OAuth</a> (Java)</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="jwt-json-web-tokens-2"><a class="header" href="#jwt-json-web-tokens-2">JWT (JSON Web Tokens)</a></h1>
<p>JSON Web Token (JWT) is an open standard (RFC 7519) that defines a compact and self-contained way for securely transmitting information between parties as a JSON object. This information can be verified and trusted because it is digitally signed.</p>
<h2 id="table-of-contents-12"><a class="header" href="#table-of-contents-12">Table of Contents</a></h2>
<ul>
<li><a href="security/jwt.html#introduction">Introduction</a></li>
<li><a href="security/jwt.html#jwt-structure">JWT Structure</a></li>
<li><a href="security/jwt.html#how-jwt-works">How JWT Works</a></li>
<li><a href="security/jwt.html#creating-and-verifying-jwts">Creating and Verifying JWTs</a></li>
<li><a href="security/jwt.html#jwt-authentication-flow">JWT Authentication Flow</a></li>
<li><a href="security/jwt.html#refresh-tokens">Refresh Tokens</a></li>
<li><a href="security/jwt.html#security-best-practices">Security Best Practices</a></li>
<li><a href="security/jwt.html#common-vulnerabilities">Common Vulnerabilities</a></li>
</ul>
<hr />
<h2 id="introduction-3"><a class="header" href="#introduction-3">Introduction</a></h2>
<p><strong>What is JWT?</strong>
A JWT is a string of three Base64-URL encoded parts separated by dots (<code>.</code>), representing:</p>
<ol>
<li>Header</li>
<li>Payload</li>
<li>Signature</li>
</ol>
<p><strong>Example JWT:</strong></p>
<pre><code>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c
</code></pre>
<p><strong>Use Cases:</strong></p>
<ul>
<li>Authentication</li>
<li>Information Exchange</li>
<li>Authorization</li>
<li>Single Sign-On (SSO)</li>
<li>Stateless API authentication</li>
</ul>
<p><strong>Benefits:</strong></p>
<ul>
<li>Compact size</li>
<li>Self-contained (all info in the token)</li>
<li>Stateless (no server-side session storage)</li>
<li>Cross-domain/CORS friendly</li>
<li>Mobile-friendly</li>
</ul>
<hr />
<h2 id="jwt-structure-1"><a class="header" href="#jwt-structure-1">JWT Structure</a></h2>
<h3 id="header"><a class="header" href="#header">Header</a></h3>
<p>Contains the type of token and the signing algorithm.</p>
<pre><code class="language-json">{
  "alg": "HS256",
  "typ": "JWT"
}
</code></pre>
<p><strong>Common Algorithms:</strong></p>
<ul>
<li><code>HS256</code> (HMAC with SHA-256) - Symmetric</li>
<li><code>RS256</code> (RSA with SHA-256) - Asymmetric</li>
<li><code>ES256</code> (ECDSA with SHA-256) - Asymmetric</li>
</ul>
<h3 id="payload"><a class="header" href="#payload">Payload</a></h3>
<p>Contains the claims (statements about an entity and additional data).</p>
<pre><code class="language-json">{
  "sub": "1234567890",
  "name": "John Doe",
  "email": "john@example.com",
  "iat": 1516239022,
  "exp": 1516242622,
  "roles": ["user", "admin"]
}
</code></pre>
<p><strong>Registered Claims:</strong></p>
<ul>
<li><code>iss</code> (issuer)</li>
<li><code>sub</code> (subject)</li>
<li><code>aud</code> (audience)</li>
<li><code>exp</code> (expiration time)</li>
<li><code>nbf</code> (not before)</li>
<li><code>iat</code> (issued at)</li>
<li><code>jti</code> (JWT ID)</li>
</ul>
<p><strong>Custom Claims:</strong>
Any additional data you want to include.</p>
<h3 id="signature"><a class="header" href="#signature">Signature</a></h3>
<p>Created by taking:</p>
<pre><code>HMACSHA256(
  base64UrlEncode(header) + "." +
  base64UrlEncode(payload),
  secret
)
</code></pre>
<hr />
<h2 id="how-jwt-works"><a class="header" href="#how-jwt-works">How JWT Works</a></h2>
<h3 id="authentication-flow"><a class="header" href="#authentication-flow">Authentication Flow</a></h3>
<pre><code>1. User logs in with credentials
   ↓
2. Server validates credentials
   ↓
3. Server creates JWT with user info
   ↓
4. Server sends JWT to client
   ↓
5. Client stores JWT (localStorage/cookie)
   ↓
6. Client sends JWT with each request
   ↓
7. Server verifies JWT signature
   ↓
8. Server grants/denies access
</code></pre>
<hr />
<h2 id="creating-and-verifying-jwts"><a class="header" href="#creating-and-verifying-jwts">Creating and Verifying JWTs</a></h2>
<h3 id="nodejs-implementation"><a class="header" href="#nodejs-implementation">Node.js Implementation</a></h3>
<p><strong>Installation:</strong></p>
<pre><code class="language-bash">npm install jsonwebtoken
</code></pre>
<p><strong>Creating a JWT:</strong></p>
<pre><code class="language-javascript">const jwt = require('jsonwebtoken');

const SECRET_KEY = process.env.JWT_SECRET;

function generateToken(user) {
  const payload = {
    sub: user.id,
    email: user.email,
    name: user.name,
    roles: user.roles,
  };

  const options = {
    expiresIn: '1h',
    issuer: 'your-app-name',
    audience: 'your-app-users',
  };

  return jwt.sign(payload, SECRET_KEY, options);
}

// Usage
const token = generateToken({
  id: 123,
  email: 'john@example.com',
  name: 'John Doe',
  roles: ['user'],
});

console.log(token);
</code></pre>
<p><strong>Verifying a JWT:</strong></p>
<pre><code class="language-javascript">function verifyToken(token) {
  try {
    const decoded = jwt.verify(token, SECRET_KEY, {
      issuer: 'your-app-name',
      audience: 'your-app-users',
    });

    return decoded;
  } catch (error) {
    if (error.name === 'TokenExpiredError') {
      throw new Error('Token expired');
    }
    if (error.name === 'JsonWebTokenError') {
      throw new Error('Invalid token');
    }
    throw error;
  }
}

// Usage
try {
  const decoded = verifyToken(token);
  console.log('User:', decoded);
} catch (error) {
  console.error('Verification failed:', error.message);
}
</code></pre>
<h3 id="express-middleware"><a class="header" href="#express-middleware">Express Middleware</a></h3>
<pre><code class="language-javascript">const jwt = require('jsonwebtoken');

function authenticateToken(req, res, next) {
  const authHeader = req.headers['authorization'];
  const token = authHeader &amp;&amp; authHeader.split(' ')[1]; // Bearer TOKEN

  if (!token) {
    return res.status(401).json({ error: 'Access token required' });
  }

  try {
    const user = jwt.verify(token, process.env.JWT_SECRET);
    req.user = user;
    next();
  } catch (error) {
    return res.status(403).json({ error: 'Invalid or expired token' });
  }
}

// Protected route
app.get('/api/protected', authenticateToken, (req, res) =&gt; {
  res.json({
    message: 'Protected data',
    user: req.user,
  });
});
</code></pre>
<h3 id="python-implementation-pyjwt"><a class="header" href="#python-implementation-pyjwt">Python Implementation (PyJWT)</a></h3>
<pre><code class="language-python">import jwt
import datetime
from functools import wraps
from flask import request, jsonify

SECRET_KEY = "your-secret-key"

def generate_token(user_id, email):
    payload = {
        'sub': user_id,
        'email': email,
        'exp': datetime.datetime.utcnow() + datetime.timedelta(hours=1),
        'iat': datetime.datetime.utcnow(),
        'iss': 'your-app-name'
    }

    return jwt.encode(payload, SECRET_KEY, algorithm='HS256')

def verify_token(token):
    try:
        decoded = jwt.decode(
            token,
            SECRET_KEY,
            algorithms=['HS256'],
            issuer='your-app-name'
        )
        return decoded
    except jwt.ExpiredSignatureError:
        raise Exception('Token expired')
    except jwt.InvalidTokenError:
        raise Exception('Invalid token')

# Decorator for protected routes
def token_required(f):
    @wraps(f)
    def decorated(*args, **kwargs):
        token = request.headers.get('Authorization')

        if not token:
            return jsonify({'error': 'Token missing'}), 401

        try:
            token = token.split(' ')[1]  # Remove 'Bearer '
            decoded = verify_token(token)
            request.user = decoded
        except Exception as e:
            return jsonify({'error': str(e)}), 403

        return f(*args, **kwargs)

    return decorated

# Protected route
@app.route('/api/protected')
@token_required
def protected():
    return jsonify({
        'message': 'Protected data',
        'user': request.user
    })
</code></pre>
<hr />
<h2 id="jwt-authentication-flow"><a class="header" href="#jwt-authentication-flow">JWT Authentication Flow</a></h2>
<h3 id="complete-implementation"><a class="header" href="#complete-implementation">Complete Implementation</a></h3>
<p><strong>auth.js:</strong></p>
<pre><code class="language-javascript">const express = require('express');
const jwt = require('jsonwebtoken');
const bcrypt = require('bcrypt');
const router = express.Router();

const SECRET_KEY = process.env.JWT_SECRET;
const REFRESH_SECRET = process.env.REFRESH_SECRET;

// Login
router.post('/login', async (req, res) =&gt; {
  const { email, password } = req.body;

  // Find user in database
  const user = await User.findOne({ email });

  if (!user) {
    return res.status(401).json({ error: 'Invalid credentials' });
  }

  // Verify password
  const isValidPassword = await bcrypt.compare(password, user.password);

  if (!isValidPassword) {
    return res.status(401).json({ error: 'Invalid credentials' });
  }

  // Generate tokens
  const accessToken = jwt.sign(
    {
      sub: user.id,
      email: user.email,
      roles: user.roles,
    },
    SECRET_KEY,
    { expiresIn: '15m' }
  );

  const refreshToken = jwt.sign(
    { sub: user.id },
    REFRESH_SECRET,
    { expiresIn: '7d' }
  );

  // Store refresh token in database
  await RefreshToken.create({
    token: refreshToken,
    userId: user.id,
    expiresAt: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000),
  });

  // Send tokens
  res.json({
    accessToken,
    refreshToken,
    user: {
      id: user.id,
      email: user.email,
      name: user.name,
    },
  });
});

// Refresh token
router.post('/refresh', async (req, res) =&gt; {
  const { refreshToken } = req.body;

  if (!refreshToken) {
    return res.status(401).json({ error: 'Refresh token required' });
  }

  try {
    // Verify refresh token
    const decoded = jwt.verify(refreshToken, REFRESH_SECRET);

    // Check if refresh token exists in database
    const storedToken = await RefreshToken.findOne({
      token: refreshToken,
      userId: decoded.sub,
    });

    if (!storedToken) {
      return res.status(403).json({ error: 'Invalid refresh token' });
    }

    // Get user
    const user = await User.findById(decoded.sub);

    // Generate new access token
    const accessToken = jwt.sign(
      {
        sub: user.id,
        email: user.email,
        roles: user.roles,
      },
      SECRET_KEY,
      { expiresIn: '15m' }
    );

    res.json({ accessToken });
  } catch (error) {
    return res.status(403).json({ error: 'Invalid refresh token' });
  }
});

// Logout
router.post('/logout', authenticateToken, async (req, res) =&gt; {
  const { refreshToken } = req.body;

  // Remove refresh token from database
  await RefreshToken.deleteOne({
    token: refreshToken,
    userId: req.user.sub,
  });

  res.json({ message: 'Logged out successfully' });
});

module.exports = router;
</code></pre>
<h3 id="client-side-implementation"><a class="header" href="#client-side-implementation">Client-Side Implementation</a></h3>
<pre><code class="language-javascript">class AuthService {
  constructor() {
    this.accessToken = null;
    this.refreshToken = localStorage.getItem('refreshToken');
  }

  async login(email, password) {
    const response = await fetch('/api/auth/login', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ email, password }),
    });

    if (!response.ok) {
      throw new Error('Login failed');
    }

    const data = await response.json();
    this.accessToken = data.accessToken;
    this.refreshToken = data.refreshToken;

    localStorage.setItem('refreshToken', data.refreshToken);

    return data.user;
  }

  async refreshAccessToken() {
    if (!this.refreshToken) {
      throw new Error('No refresh token');
    }

    const response = await fetch('/api/auth/refresh', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ refreshToken: this.refreshToken }),
    });

    if (!response.ok) {
      this.logout();
      throw new Error('Token refresh failed');
    }

    const data = await response.json();
    this.accessToken = data.accessToken;

    return this.accessToken;
  }

  async makeAuthenticatedRequest(url, options = {}) {
    if (!this.accessToken) {
      await this.refreshAccessToken();
    }

    const response = await fetch(url, {
      ...options,
      headers: {
        ...options.headers,
        'Authorization': `Bearer ${this.accessToken}`,
      },
    });

    // If token expired, refresh and retry
    if (response.status === 401) {
      await this.refreshAccessToken();

      return fetch(url, {
        ...options,
        headers: {
          ...options.headers,
          'Authorization': `Bearer ${this.accessToken}`,
        },
      });
    }

    return response;
  }

  logout() {
    this.accessToken = null;
    this.refreshToken = null;
    localStorage.removeItem('refreshToken');
  }
}

// Usage
const auth = new AuthService();

// Login
await auth.login('user@example.com', 'password');

// Make authenticated request
const response = await auth.makeAuthenticatedRequest('/api/user/profile');
const profile = await response.json();

// Logout
auth.logout();
</code></pre>
<hr />
<h2 id="refresh-tokens"><a class="header" href="#refresh-tokens">Refresh Tokens</a></h2>
<h3 id="why-use-refresh-tokens"><a class="header" href="#why-use-refresh-tokens">Why Use Refresh Tokens?</a></h3>
<ol>
<li><strong>Short-lived access tokens</strong> reduce the window of opportunity for token theft</li>
<li><strong>Long-lived refresh tokens</strong> improve user experience (don't have to login frequently)</li>
<li><strong>Revocable</strong> - Can invalidate refresh tokens without affecting other sessions</li>
</ol>
<h3 id="implementation-strategy"><a class="header" href="#implementation-strategy">Implementation Strategy</a></h3>
<pre><code class="language-javascript">// Token lifetimes
const ACCESS_TOKEN_LIFETIME = '15m';
const REFRESH_TOKEN_LIFETIME = '7d';

// Store refresh tokens in database
const refreshTokenSchema = new mongoose.Schema({
  token: { type: String, required: true, unique: true },
  userId: { type: ObjectId, ref: 'User', required: true },
  expiresAt: { type: Date, required: true },
  createdAt: { type: Date, default: Date.now },
  revokedAt: { type: Date },
  replacedByToken: { type: String },
});

// Automatic cleanup of expired tokens
refreshTokenSchema.index({ expiresAt: 1 }, { expireAfterSeconds: 0 });

// Token rotation
async function rotateRefreshToken(oldRefreshToken) {
  // Verify old token
  const decoded = jwt.verify(oldRefreshToken, REFRESH_SECRET);

  // Find old token in database
  const oldToken = await RefreshToken.findOne({
    token: oldRefreshToken,
    userId: decoded.sub,
  });

  if (!oldToken || oldToken.revokedAt) {
    throw new Error('Invalid refresh token');
  }

  // Create new refresh token
  const newRefreshToken = jwt.sign(
    { sub: decoded.sub },
    REFRESH_SECRET,
    { expiresIn: REFRESH_TOKEN_LIFETIME }
  );

  // Mark old token as revoked
  oldToken.revokedAt = new Date();
  oldToken.replacedByToken = newRefreshToken;
  await oldToken.save();

  // Store new token
  await RefreshToken.create({
    token: newRefreshToken,
    userId: decoded.sub,
    expiresAt: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000),
  });

  return newRefreshToken;
}
</code></pre>
<hr />
<h2 id="security-best-practices-3"><a class="header" href="#security-best-practices-3">Security Best Practices</a></h2>
<h3 id="1-use-strong-secrets"><a class="header" href="#1-use-strong-secrets">1. Use Strong Secrets</a></h3>
<pre><code class="language-javascript">// Generate a strong secret
const crypto = require('crypto');
const secret = crypto.randomBytes(64).toString('hex');

// Use environment variables
const SECRET_KEY = process.env.JWT_SECRET;

if (!SECRET_KEY || SECRET_KEY.length &lt; 32) {
  throw new Error('JWT_SECRET must be at least 32 characters');
}
</code></pre>
<h3 id="2-short-expiration-times"><a class="header" href="#2-short-expiration-times">2. Short Expiration Times</a></h3>
<pre><code class="language-javascript">// Short-lived access tokens
const accessToken = jwt.sign(payload, SECRET_KEY, {
  expiresIn: '15m', // 15 minutes
});

// Long-lived refresh tokens
const refreshToken = jwt.sign(payload, REFRESH_SECRET, {
  expiresIn: '7d', // 7 days
});
</code></pre>
<h3 id="3-secure-token-storage"><a class="header" href="#3-secure-token-storage">3. Secure Token Storage</a></h3>
<pre><code class="language-javascript">// ❌ Bad: localStorage (vulnerable to XSS)
localStorage.setItem('token', accessToken);

// ✅ Good: httpOnly cookie (protected from XSS)
res.cookie('access_token', accessToken, {
  httpOnly: true,
  secure: true,
  sameSite: 'strict',
  maxAge: 15 * 60 * 1000, // 15 minutes
});

// ✅ Good: Memory (for SPAs)
class TokenStore {
  constructor() {
    this.token = null;
  }

  setToken(token) {
    this.token = token;
  }

  getToken() {
    return this.token;
  }

  clearToken() {
    this.token = null;
  }
}
</code></pre>
<h3 id="4-validate-all-claims"><a class="header" href="#4-validate-all-claims">4. Validate All Claims</a></h3>
<pre><code class="language-javascript">function validateToken(token) {
  const decoded = jwt.verify(token, SECRET_KEY, {
    issuer: 'your-app',
    audience: 'your-users',
  });

  // Check expiration
  if (decoded.exp &lt; Date.now() / 1000) {
    throw new Error('Token expired');
  }

  // Check not before
  if (decoded.nbf &amp;&amp; decoded.nbf &gt; Date.now() / 1000) {
    throw new Error('Token not yet valid');
  }

  // Validate custom claims
  if (!decoded.roles || !Array.isArray(decoded.roles)) {
    throw new Error('Invalid token structure');
  }

  return decoded;
}
</code></pre>
<h3 id="5-use-asymmetric-algorithms-for-distributed-systems"><a class="header" href="#5-use-asymmetric-algorithms-for-distributed-systems">5. Use Asymmetric Algorithms for Distributed Systems</a></h3>
<pre><code class="language-javascript">const fs = require('fs');

// Generate RSA key pair
const { generateKeyPairSync } = require('crypto');
const { privateKey, publicKey } = generateKeyPairSync('rsa', {
  modulusLength: 2048,
});

// Sign with private key
const token = jwt.sign(payload, privateKey, {
  algorithm: 'RS256',
  expiresIn: '1h',
});

// Verify with public key (can be shared with other services)
const decoded = jwt.verify(token, publicKey, {
  algorithms: ['RS256'],
});
</code></pre>
<h3 id="6-implement-token-blacklist-for-logout"><a class="header" href="#6-implement-token-blacklist-for-logout">6. Implement Token Blacklist for Logout</a></h3>
<pre><code class="language-javascript">const blacklist = new Set();

async function logout(token) {
  const decoded = jwt.decode(token);

  // Add to blacklist with expiration
  await redis.setex(
    `blacklist:${decoded.jti}`,
    decoded.exp - Math.floor(Date.now() / 1000),
    'true'
  );
}

async function isTokenBlacklisted(token) {
  const decoded = jwt.decode(token);
  const isBlacklisted = await redis.exists(`blacklist:${decoded.jti}`);
  return isBlacklisted === 1;
}

// Middleware
async function authenticateToken(req, res, next) {
  const token = extractToken(req);

  if (await isTokenBlacklisted(token)) {
    return res.status(401).json({ error: 'Token has been revoked' });
  }

  // Verify token...
  next();
}
</code></pre>
<hr />
<h2 id="common-vulnerabilities-1"><a class="header" href="#common-vulnerabilities-1">Common Vulnerabilities</a></h2>
<h3 id="1-algorithm-confusion-attack"><a class="header" href="#1-algorithm-confusion-attack">1. Algorithm Confusion Attack</a></h3>
<p><strong>Vulnerability:</strong>
Attacker changes algorithm from RS256 to HS256 and uses public key as secret</p>
<p><strong>Mitigation:</strong></p>
<pre><code class="language-javascript">// Always specify allowed algorithms
jwt.verify(token, secret, {
  algorithms: ['RS256'], // Only allow RS256
});

// Never use 'none' algorithm
jwt.sign(payload, secret, {
  algorithm: 'HS256', // Specify algorithm explicitly
});
</code></pre>
<h3 id="2-weak-secret-keys"><a class="header" href="#2-weak-secret-keys">2. Weak Secret Keys</a></h3>
<p><strong>Vulnerability:</strong>
Short or predictable secrets can be brute-forced</p>
<p><strong>Mitigation:</strong></p>
<pre><code class="language-javascript">// Use strong, random secrets (at least 256 bits)
const crypto = require('crypto');
const secret = crypto.randomBytes(32).toString('hex');

// Store in environment variables
const SECRET_KEY = process.env.JWT_SECRET;

// Validate secret strength
if (SECRET_KEY.length &lt; 32) {
  throw new Error('Secret key too short');
}
</code></pre>
<h3 id="3-token-leakage-in-urls"><a class="header" href="#3-token-leakage-in-urls">3. Token Leakage in URLs</a></h3>
<p><strong>Vulnerability:</strong>
Tokens in URL parameters are logged and visible</p>
<p><strong>Mitigation:</strong></p>
<pre><code class="language-javascript">// ❌ Bad: Token in URL
fetch(`/api/data?token=${accessToken}`);

// ✅ Good: Token in header
fetch('/api/data', {
  headers: {
    'Authorization': `Bearer ${accessToken}`,
  },
});
</code></pre>
<h3 id="4-missing-expiration"><a class="header" href="#4-missing-expiration">4. Missing Expiration</a></h3>
<p><strong>Vulnerability:</strong>
Tokens without expiration never expire</p>
<p><strong>Mitigation:</strong></p>
<pre><code class="language-javascript">// Always set expiration
const token = jwt.sign(payload, secret, {
  expiresIn: '15m',
});

// Verify expiration on the server
jwt.verify(token, secret, {
  clockTolerance: 0, // No tolerance for expired tokens
});
</code></pre>
<h3 id="5-xss-attacks"><a class="header" href="#5-xss-attacks">5. XSS Attacks</a></h3>
<p><strong>Vulnerability:</strong>
Tokens stored in localStorage can be stolen via XSS</p>
<p><strong>Mitigation:</strong></p>
<pre><code class="language-javascript">// Use httpOnly cookies
res.cookie('token', token, {
  httpOnly: true,
  secure: true,
  sameSite: 'strict',
});

// Or store in memory (for SPAs)
// Never use localStorage or sessionStorage for sensitive tokens
</code></pre>
<h3 id="6-insufficient-token-validation"><a class="header" href="#6-insufficient-token-validation">6. Insufficient Token Validation</a></h3>
<p><strong>Vulnerability:</strong>
Not validating all claims or checking token blacklist</p>
<p><strong>Mitigation:</strong></p>
<pre><code class="language-javascript">async function validateToken(token) {
  // 1. Verify signature
  const decoded = jwt.verify(token, SECRET_KEY);

  // 2. Check blacklist
  if (await isBlacklisted(decoded.jti)) {
    throw new Error('Token revoked');
  }

  // 3. Validate issuer
  if (decoded.iss !== EXPECTED_ISSUER) {
    throw new Error('Invalid issuer');
  }

  // 4. Validate audience
  if (decoded.aud !== EXPECTED_AUDIENCE) {
    throw new Error('Invalid audience');
  }

  // 5. Additional business logic checks
  const user = await User.findById(decoded.sub);
  if (!user || !user.isActive) {
    throw new Error('User not found or inactive');
  }

  return decoded;
}
</code></pre>
<hr />
<h2 id="resources-9"><a class="header" href="#resources-9">Resources</a></h2>
<p><strong>Official Specifications:</strong></p>
<ul>
<li><a href="https://tools.ietf.org/html/rfc7519">RFC 7519 - JWT</a></li>
<li><a href="https://jwt.io/">JWT.io</a></li>
</ul>
<p><strong>Libraries:</strong></p>
<ul>
<li><a href="https://github.com/auth0/node-jsonwebtoken">jsonwebtoken</a> (Node.js)</li>
<li><a href="https://pyjwt.readthedocs.io/">PyJWT</a> (Python)</li>
<li><a href="https://github.com/panva/jose">jose</a> (Node.js, modern)</li>
<li><a href="https://github.com/auth0/java-jwt">java-jwt</a> (Java)</li>
</ul>
<p><strong>Tools:</strong></p>
<ul>
<li><a href="https://jwt.io/#debugger">JWT Debugger</a></li>
<li><a href="https://www.jwtinspector.io/">JWT Inspector</a></li>
</ul>
<p><strong>Learning Resources:</strong></p>
<ul>
<li><a href="https://jwt.io/introduction">Introduction to JWT</a></li>
<li><a href="https://auth0.com/resources/ebooks/jwt-handbook">JWT Handbook</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/JSON_Web_Token_for_Java_Cheat_Sheet.html">OWASP JWT Cheat Sheet</a></li>
</ul>
<p><strong>Security:</strong></p>
<ul>
<li><a href="https://curity.io/resources/learn/jwt-best-practices/">JWT Security Best Practices</a></li>
<li><a href="https://pragmaticwebsecurity.com/articles/apisecurity/jwt-security.html">Common JWT Security Mistakes</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="wifi"><a class="header" href="#wifi">Wifi</a></h1>
<p>Welcome to the Wifi section of the notes. Here, you will find comprehensive information about various aspects of Wifi technology, including its basics, standards, security, and more.</p>
<h2 id="table-of-contents-13"><a class="header" href="#table-of-contents-13">Table of Contents</a></h2>
<ul>
<li><a href="wifi/basics.html">Wifi Basics</a></li>
<li><a href="wifi/standards.html">Wifi Standards</a></li>
<li><a href="wifi/security.html">Wifi Security</a></li>
<li><a href="wifi/scanning.html">Scanning</a></li>
<li><a href="wifi/roaming.html">Roaming</a></li>
<li><a href="wifi/qos_management.html">QoS Management</a></li>
</ul>
<p>Explore the topics to gain a deeper understanding of Wifi technology and its applications.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="wifi-basics"><a class="header" href="#wifi-basics">Wifi Basics</a></h1>
<h2 id="aggregation"><a class="header" href="#aggregation">Aggregation</a></h2>
<p>Aggregation in Wi-Fi refers to the process of combining multiple data frames into a single transmission unit. This technique is used to improve the efficiency and throughput of wireless networks by reducing the overhead associated with each individual frame transmission. There are two main types of aggregation in Wi-Fi:</p>
<ol>
<li>
<p><strong>A-MPDU (Aggregated MAC Protocol Data Unit)</strong>:</p>
<ul>
<li>Combines multiple MAC frames into a single PHY (Physical Layer) frame.</li>
<li>Reduces the inter-frame spacing and acknowledgment overhead.</li>
<li>Improves throughput by allowing multiple frames to be sent in a single transmission burst.</li>
</ul>
</li>
<li>
<p><strong>A-MSDU (Aggregated MAC Service Data Unit)</strong>:</p>
<ul>
<li>Combines multiple MSDUs (MAC Service Data Units) into a single MPDU (MAC Protocol Data Unit).</li>
<li>Reduces the overhead by aggregating data at the MAC layer before it is passed to the PHY layer.</li>
<li>Increases efficiency by reducing the number of headers and acknowledgments required.</li>
</ul>
</li>
</ol>
<p>Both A-MPDU and A-MSDU are supported in 802.11n and later standards, such as 802.11ac and 802.11ax. These aggregation techniques are particularly beneficial in high-throughput and high-density environments, where they help to maximize the use of available bandwidth and improve overall network performance.</p>
<h2 id="wifi-bands"><a class="header" href="#wifi-bands">Wifi Bands</a></h2>
<h3 id="24-ghz"><a class="header" href="#24-ghz">2.4 GHz</a></h3>
<ul>
<li>802.11a</li>
<li>802.11b</li>
<li>802.11g</li>
</ul>
<p>The 2.4 GHz band is one of the most commonly used frequency bands for Wi-Fi communication. It is known for its longer range and better penetration through obstacles such as walls and floors. However, it is also more susceptible to interference from other devices, such as microwaves, cordless phones, and Bluetooth devices, which operate in the same frequency range.</p>
<h3 id="channels-in-24-ghz-band"><a class="header" href="#channels-in-24-ghz-band">Channels in 2.4 GHz Band</a></h3>
<p>The 2.4 GHz band is divided into multiple channels, each with a specific frequency range. The channels are spaced 5 MHz apart, but due to the width of the channels (22 MHz), there is significant overlap between adjacent channels. This can lead to interference if multiple networks are operating on overlapping channels. The commonly used channels in the 2.4 GHz band are:</p>
<ul>
<li><strong>Channel 1</strong>: 2.412 GHz</li>
<li><strong>Channel 2</strong>: 2.417 GHz</li>
<li><strong>Channel 3</strong>: 2.422 GHz</li>
<li><strong>Channel 4</strong>: 2.427 GHz</li>
<li><strong>Channel 5</strong>: 2.432 GHz</li>
<li><strong>Channel 6</strong>: 2.437 GHz</li>
<li><strong>Channel 7</strong>: 2.442 GHz</li>
<li><strong>Channel 8</strong>: 2.447 GHz</li>
<li><strong>Channel 9</strong>: 2.452 GHz</li>
<li><strong>Channel 10</strong>: 2.457 GHz</li>
<li><strong>Channel 11</strong>: 2.462 GHz</li>
</ul>
<p>In some regions, additional channels are available:</p>
<ul>
<li><strong>Channel 12</strong>: 2.467 GHz</li>
<li><strong>Channel 13</strong>: 2.472 GHz</li>
<li><strong>Channel 14</strong>: 2.484 GHz (only available in Japan)</li>
</ul>
<p>To minimize interference, it is recommended to use non-overlapping channels. In the 2.4 GHz band, the non-overlapping channels are typically channels 1, 6, and 11. By configuring Wi-Fi networks to operate on these channels, interference can be reduced, leading to improved performance and reliability.</p>
<h3 id="5-ghz"><a class="header" href="#5-ghz">5 GHz</a></h3>
<ul>
<li>802.11a</li>
<li>802.11n</li>
<li>802.11ac</li>
<li>802.11ax</li>
</ul>
<h3 id="channels-in-5-ghz-band"><a class="header" href="#channels-in-5-ghz-band">Channels in 5 GHz Band</a></h3>
<p>The 5 GHz band offers a larger number of channels compared to the 2.4 GHz band, which helps to reduce interference and congestion. The channels in the 5 GHz band are spaced 20 MHz apart, and there are several non-overlapping channels available. This band is divided into several sub-bands, each with its own set of channels:</p>
<ul>
<li>
<p><strong>UNII-1 (5150-5250 MHz)</strong>:</p>
<ul>
<li>Channel 36: 5.180 GHz</li>
<li>Channel 40: 5.200 GHz</li>
<li>Channel 44: 5.220 GHz</li>
<li>Channel 48: 5.240 GHz</li>
</ul>
</li>
<li>
<p><strong>UNII-2 (5250-5350 MHz)</strong>:</p>
<ul>
<li>Channel 52: 5.260 GHz</li>
<li>Channel 56: 5.280 GHz</li>
<li>Channel 60: 5.300 GHz</li>
<li>Channel 64: 5.320 GHz</li>
</ul>
</li>
<li>
<p><strong>UNII-2 Extended (5470-5725 MHz)</strong>:</p>
<ul>
<li>Channel 100: 5.500 GHz</li>
<li>Channel 104: 5.520 GHz</li>
<li>Channel 108: 5.540 GHz</li>
<li>Channel 112: 5.560 GHz</li>
<li>Channel 116: 5.580 GHz</li>
<li>Channel 120: 5.600 GHz</li>
<li>Channel 124: 5.620 GHz</li>
<li>Channel 128: 5.640 GHz</li>
<li>Channel 132: 5.660 GHz</li>
<li>Channel 136: 5.680 GHz</li>
<li>Channel 140: 5.700 GHz</li>
<li>Channel 144: 5.720 GHz</li>
</ul>
</li>
<li>
<p><strong>UNII-3 (5725-5850 MHz)</strong>:</p>
<ul>
<li>Channel 149: 5.745 GHz</li>
<li>Channel 153: 5.765 GHz</li>
<li>Channel 157: 5.785 GHz</li>
<li>Channel 161: 5.805 GHz</li>
<li>Channel 165: 5.825 GHz</li>
</ul>
</li>
</ul>
<p>The 5 GHz band is less crowded than the 2.4 GHz band and offers higher data rates and lower latency. However, it has a shorter range and less ability to penetrate obstacles such as walls and floors. The use of non-overlapping channels in the 5 GHz band helps to minimize interference and improve overall network performance. Additionally, Dynamic Frequency Selection (DFS) is used in some channels to avoid interference with radar systems.</p>
<h3 id="6-ghz"><a class="header" href="#6-ghz">6 GHz</a></h3>
<ul>
<li>802.11ax</li>
<li>802.11be</li>
</ul>
<h3 id="channels-in-6-ghz-band"><a class="header" href="#channels-in-6-ghz-band">Channels in 6 GHz Band</a></h3>
<p>The 6 GHz band is a new addition to the Wi-Fi spectrum, providing even more channels and bandwidth for wireless communication. This band is divided into several sub-bands, each with its own set of channels. The channels in the 6 GHz band are spaced 20 MHz apart, similar to the 5 GHz band, and there are numerous non-overlapping channels available. The 6 GHz band offers higher data rates, lower latency, and reduced interference compared to the 2.4 GHz and 5 GHz bands.</p>
<ul>
<li>
<p><strong>UNII-5 (5925-6425 MHz)</strong>:</p>
<ul>
<li>Channel 1: 5.925 GHz</li>
<li>Channel 5: 5.945 GHz</li>
<li>Channel 9: 5.965 GHz</li>
<li>Channel 13: 5.985 GHz</li>
<li>Channel 17: 6.005 GHz</li>
<li>Channel 21: 6.025 GHz</li>
<li>Channel 25: 6.045 GHz</li>
<li>Channel 29: 6.065 GHz</li>
<li>Channel 33: 6.085 GHz</li>
<li>Channel 37: 6.105 GHz</li>
<li>Channel 41: 6.125 GHz</li>
<li>Channel 45: 6.145 GHz</li>
<li>Channel 49: 6.165 GHz</li>
<li>Channel 53: 6.185 GHz</li>
<li>Channel 57: 6.205 GHz</li>
<li>Channel 61: 6.225 GHz</li>
<li>Channel 65: 6.245 GHz</li>
<li>Channel 69: 6.265 GHz</li>
<li>Channel 73: 6.285 GHz</li>
<li>Channel 77: 6.305 GHz</li>
<li>Channel 81: 6.325 GHz</li>
<li>Channel 85: 6.345 GHz</li>
<li>Channel 89: 6.365 GHz</li>
<li>Channel 93: 6.385 GHz</li>
<li>Channel 97: 6.405 GHz</li>
<li>Channel 101: 6.425 GHz</li>
</ul>
</li>
<li>
<p><strong>UNII-6 (6425-6525 MHz)</strong>:</p>
<ul>
<li>Channel 105: 6.445 GHz</li>
<li>Channel 109: 6.465 GHz</li>
<li>Channel 113: 6.485 GHz</li>
<li>Channel 117: 6.505 GHz</li>
<li>Channel 121: 6.525 GHz</li>
</ul>
</li>
<li>
<p><strong>UNII-7 (6525-6875 MHz)</strong>:</p>
<ul>
<li>Channel 125: 6.545 GHz</li>
<li>Channel 129: 6.565 GHz</li>
<li>Channel 133: 6.585 GHz</li>
<li>Channel 137: 6.605 GHz</li>
<li>Channel 141: 6.625 GHz</li>
<li>Channel 145: 6.645 GHz</li>
<li>Channel 149: 6.665 GHz</li>
<li>Channel 153: 6.685 GHz</li>
<li>Channel 157: 6.705 GHz</li>
<li>Channel 161: 6.725 GHz</li>
<li>Channel 165: 6.745 GHz</li>
<li>Channel 169: 6.765 GHz</li>
<li>Channel 173: 6.785 GHz</li>
<li>Channel 177: 6.805 GHz</li>
<li>Channel 181: 6.825 GHz</li>
<li>Channel 185: 6.845 GHz</li>
<li>Channel 189: 6.865 GHz</li>
<li>Channel 193: 6.885 GHz</li>
<li>Channel 197: 6.905 GHz</li>
<li>Channel 201: 6.925 GHz</li>
<li>Channel 205: 6.945 GHz</li>
<li>Channel 209: 6.965 GHz</li>
<li>Channel 213: 6.985 GHz</li>
</ul>
</li>
<li>
<p><strong>UNII-8 (6875-7125 MHz)</strong>:</p>
<ul>
<li>Channel 217: 7.005 GHz</li>
<li>Channel 221: 7.025 GHz</li>
<li>Channel 225: 7.045 GHz</li>
<li>Channel 229: 7.065 GHz</li>
<li>Channel 233: 7.085 GHz</li>
<li>Channel 237: 7.105 GHz</li>
<li>Channel 241: 7.125 GHz</li>
</ul>
</li>
</ul>
<p>The 6 GHz band is expected to significantly enhance Wi-Fi performance, especially in dense environments, by providing more spectrum and reducing congestion. Devices that support the 6 GHz band can take advantage of these additional channels to achieve faster speeds and more reliable connections.</p>
<h2 id="wifi-channel-width"><a class="header" href="#wifi-channel-width">Wifi channel width</a></h2>
<p>Wi-Fi channel width refers to the size of the frequency band that a Wi-Fi signal occupies. The channel width determines the data rate and the amount of data that can be transmitted over the network. Wider channels can carry more data, but they are also more susceptible to interference and congestion. The most common channel widths in Wi-Fi are 20 MHz, 40 MHz, 80 MHz, and 160 MHz.</p>
<h3 id="20-mhz-channels"><a class="header" href="#20-mhz-channels">20 MHz Channels</a></h3>
<p>20 MHz is the standard channel width for Wi-Fi and is widely used in both 2.4 GHz and 5 GHz bands. It provides a good balance between range and throughput. A 20 MHz channel is less likely to experience interference from other devices and networks, making it a reliable choice for most applications.</p>
<h3 id="40-mhz-channels"><a class="header" href="#40-mhz-channels">40 MHz Channels</a></h3>
<p>40 MHz channels are used to increase the data rate by bonding two adjacent 20 MHz channels. This effectively doubles the bandwidth, allowing for higher throughput. However, 40 MHz channels are more prone to interference, especially in the crowded 2.4 GHz band. In the 5 GHz band, 40 MHz channels are more practical due to the availability of more non-overlapping channels.</p>
<h3 id="80-mhz-channels"><a class="header" href="#80-mhz-channels">80 MHz Channels</a></h3>
<p>80 MHz channels further increase the data rate by bonding four adjacent 20 MHz channels. This provides even higher throughput, making it suitable for applications that require high data rates, such as HD video streaming and online gaming. However, 80 MHz channels are more susceptible to interference and are typically used in the 5 GHz and 6 GHz bands where more spectrum is available.</p>
<h3 id="160-mhz-channels"><a class="header" href="#160-mhz-channels">160 MHz Channels</a></h3>
<p>160 MHz channels offer the highest data rates by bonding eight adjacent 20 MHz channels. This channel width is ideal for applications that demand extremely high throughput, such as virtual reality (VR) and large file transfers. However, 160 MHz channels are highly susceptible to interference and are only practical in the 5 GHz and 6 GHz bands with sufficient spectrum availability.</p>
<h3 id="channel-width-selection"><a class="header" href="#channel-width-selection">Channel Width Selection</a></h3>
<p>The choice of channel width depends on the specific requirements of the network and the environment. In dense environments with many Wi-Fi networks, narrower channels (20 MHz or 40 MHz) are preferred to minimize interference. In less congested environments, wider channels (80 MHz or 160 MHz) can be used to achieve higher data rates.</p>
<h3 id="impact-on-performance"><a class="header" href="#impact-on-performance">Impact on Performance</a></h3>
<p>Wider channels can significantly improve Wi-Fi performance by increasing the data rate and reducing latency. However, they also require more spectrum and are more vulnerable to interference. It is essential to balance the need for higher throughput with the potential for increased interference when selecting the appropriate channel width for a Wi-Fi network.</p>
<p>In summary, Wi-Fi channel width plays a crucial role in determining the performance and reliability of a wireless network. Understanding the trade-offs between different channel widths can help optimize the network for specific applications and environments.</p>
<h2 id="identifying-channel-width-from-beacon-frames"><a class="header" href="#identifying-channel-width-from-beacon-frames">Identifying Channel Width from Beacon Frames</a></h2>
<p>To identify the channel width from Wi-Fi beacon frames, you need to analyze the information elements (IEs) within the beacon frame. Beacon frames are periodically transmitted by access points (APs) to announce the presence of a Wi-Fi network. These frames contain various IEs that provide information about the network, including the channel width.</p>
<h3 id="steps-to-identify-channel-width"><a class="header" href="#steps-to-identify-channel-width">Steps to Identify Channel Width</a></h3>
<ol>
<li>
<p><strong>Capture Beacon Frames</strong>:
Use a Wi-Fi packet capture tool (e.g., Wireshark) to capture beacon frames from the Wi-Fi network. Ensure that your capture device supports the frequency bands and channel widths used by the network.</p>
</li>
<li>
<p><strong>Locate the HT Capabilities IE</strong>:
In the captured beacon frame, locate the "HT Capabilities" information element. This IE is present in 802.11n and later standards and provides information about the supported channel widths.</p>
</li>
<li>
<p><strong>Check Supported Channel Widths</strong>:
Within the HT Capabilities IE, look for the "Supported Channel Width Set" field. This field indicates whether the AP supports 20 MHz, 40 MHz, or both channel widths. The field is typically represented as:</p>
<ul>
<li><code>0</code>: 20 MHz only</li>
<li><code>1</code>: 20 MHz and 40 MHz</li>
</ul>
</li>
<li>
<p><strong>Locate the VHT Capabilities IE</strong>:
For 802.11ac networks, locate the "VHT Capabilities" information element. This IE provides information about the supported channel widths for very high throughput (VHT) networks.</p>
</li>
<li>
<p><strong>Check VHT Supported Channel Widths</strong>:
Within the VHT Capabilities IE, look for the "Supported Channel Width Set" field. This field indicates whether the AP supports 20 MHz, 40 MHz, 80 MHz, or 160 MHz channel widths. The field is typically represented as:</p>
<ul>
<li><code>0</code>: 20 MHz and 40 MHz</li>
<li><code>1</code>: 80 MHz</li>
<li><code>2</code>: 160 MHz and 80+80 MHz</li>
</ul>
</li>
<li>
<p><strong>Analyze HE Capabilities IE</strong>:
For 802.11ax (Wi-Fi 6) networks, locate the "HE Capabilities" information element. This IE provides information about the supported channel widths for high-efficiency (HE) networks.</p>
</li>
<li>
<p><strong>Check HE Supported Channel Widths</strong>:
Within the HE Capabilities IE, look for the "Supported Channel Width Set" field. This field indicates whether the AP supports 20 MHz, 40 MHz, 80 MHz, 160 MHz, or 80+80 MHz channel widths.</p>
</li>
</ol>
<h3 id="example"><a class="header" href="#example">Example</a></h3>
<p>Here is an example of how to identify the channel width from a beacon frame using Wireshark:</p>
<ol>
<li>Open Wireshark and start capturing packets on the desired Wi-Fi interface.</li>
<li>Filter the captured packets to display only beacon frames using the filter: <code>wlan.fc.type_subtype == 0x08</code>.</li>
<li>Select a beacon frame from the list and expand the "IEEE 802.11 wireless LAN management frame" section.</li>
<li>Locate the "HT Capabilities" IE and check the "Supported Channel Width Set" field.</li>
<li>If applicable, locate the "VHT Capabilities" IE and check the "Supported Channel Width Set" field.</li>
<li>If applicable, locate the "HE Capabilities" IE and check the "Supported Channel Width Set" field.</li>
</ol>
<p>By following these steps, you can determine the channel width supported by the Wi-Fi network from the beacon frames.</p>
<h3 id="tools"><a class="header" href="#tools">Tools</a></h3>
<ul>
<li><strong>Wireshark</strong>: A popular network protocol analyzer that can capture and analyze Wi-Fi packets, including beacon frames.</li>
<li><strong>Aircrack-ng</strong>: A suite of tools for capturing and analyzing Wi-Fi packets, including airodump-ng for capturing beacon frames.</li>
</ul>
<p>Understanding the channel width from beacon frames can help optimize Wi-Fi network performance and troubleshoot connectivity issues. By analyzing the beacon frames, you can gain insights into the network's capabilities and configuration.</p>
<h3 id="types-of-frames-in-wi-fi"><a class="header" href="#types-of-frames-in-wi-fi">Types of Frames in Wi-Fi</a></h3>
<p>Wi-Fi communication relies on the exchange of various types of frames between devices. These frames are categorized into three main types: management frames, control frames, and data frames. Each type of frame serves a specific purpose in the operation and maintenance of the Wi-Fi network.</p>
<ol>
<li>
<p><strong>Management Frames</strong>:
Management frames are used to establish and maintain connections between devices in a Wi-Fi network. They facilitate the discovery, authentication, and association processes. Common types of management frames include:</p>
<ul>
<li><strong>Beacon Frames</strong>: Broadcasted periodically by access points (APs) to announce the presence and capabilities of the network.</li>
<li><strong>Probe Request Frames</strong>: Sent by clients to discover available networks.</li>
<li><strong>Probe Response Frames</strong>: Sent by APs in response to probe requests, providing information about the network.</li>
<li><strong>Authentication Frames</strong>: Used to initiate the authentication process between a client and an AP.</li>
<li><strong>Deauthentication Frames</strong>: Used to terminate an existing authentication.</li>
<li><strong>Association Request Frames</strong>: Sent by clients to request association with an AP.</li>
<li><strong>Association Response Frames</strong>: Sent by APs in response to association requests, indicating acceptance or rejection.</li>
<li><strong>Disassociation Frames</strong>: Used to terminate an existing association.</li>
</ul>
</li>
<li>
<p><strong>Control Frames</strong>:
Control frames assist in the delivery of data frames and help manage access to the wireless medium. They ensure that data frames are transmitted efficiently and without collisions. Common types of control frames include:</p>
<ul>
<li><strong>Request to Send (RTS) Frames</strong>: Used to request permission to send data, helping to avoid collisions in a busy network.</li>
<li><strong>Clear to Send (CTS) Frames</strong>: Sent in response to RTS frames, granting permission to send data.</li>
<li><strong>Acknowledgment (ACK) Frames</strong>: Sent to confirm the successful receipt of data frames.</li>
<li><strong>Power Save Poll (PS-Poll) Frames</strong>: Used by clients in power-saving mode to request buffered data from the AP.</li>
</ul>
</li>
<li>
<p><strong>Data Frames</strong>:
Data frames carry the actual data payload between devices in a Wi-Fi network. They are used for the transmission of user data, such as web pages, emails, and file transfers. Data frames can also include additional information, such as quality of service (QoS) parameters, to prioritize certain types of traffic. Common types of data frames include:</p>
<ul>
<li><strong>Data Frames</strong>: Carry user data between devices.</li>
<li><strong>Null Data Frames</strong>: Used for power management, indicating that a device is awake or entering sleep mode.</li>
<li><strong>QoS Data Frames</strong>: Include QoS parameters to prioritize certain types of traffic, such as voice or video.</li>
</ul>
</li>
</ol>
<p>Understanding the different types of frames in Wi-Fi is essential for analyzing and troubleshooting wireless networks. Each frame type plays a crucial role in the overall operation and performance of the network, ensuring reliable and efficient communication between devices.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="wifi-standards"><a class="header" href="#wifi-standards">Wifi Standards</a></h1>
<h2 id="80211"><a class="header" href="#80211">802.11</a></h2>
<h3 id="80211a"><a class="header" href="#80211a">802.11a</a></h3>
<ul>
<li>Released: 1999</li>
<li>Frequency: 5 GHz</li>
<li>Maximum Speed: 54 Mbps</li>
<li>Notes: First standard to use OFDM (Orthogonal Frequency Division Multiplexing).</li>
</ul>
<h3 id="80211b"><a class="header" href="#80211b">802.11b</a></h3>
<ul>
<li>Released: 1999</li>
<li>Frequency: 2.4 GHz</li>
<li>Maximum Speed: 11 Mbps</li>
<li>Notes: Uses DSSS (Direct Sequence Spread Spectrum) modulation.</li>
</ul>
<h3 id="80211g"><a class="header" href="#80211g">802.11g</a></h3>
<ul>
<li>Released: 2003</li>
<li>Frequency: 2.4 GHz</li>
<li>Maximum Speed: 54 Mbps</li>
<li>Notes: Backward compatible with 802.11b, uses OFDM.</li>
</ul>
<h3 id="80211n"><a class="header" href="#80211n">802.11n</a></h3>
<ul>
<li>Released: 2009</li>
<li>Frequency: 2.4 GHz and 5 GHz</li>
<li>Maximum Speed: 600 Mbps</li>
<li>Notes: Introduced MIMO (Multiple Input Multiple Output) technology.</li>
</ul>
<h3 id="80211ac"><a class="header" href="#80211ac">802.11ac</a></h3>
<ul>
<li>Released: 2013</li>
<li>Frequency: 5 GHz</li>
<li>Maximum Speed: 1.3 Gbps</li>
<li>Notes: Uses wider channels (80 or 160 MHz) and more spatial streams.</li>
</ul>
<h3 id="80211ax"><a class="header" href="#80211ax">802.11ax</a></h3>
<ul>
<li>Released: 2019</li>
<li>Frequency: 2.4 GHz and 5 GHz</li>
<li>Maximum Speed: 9.6 Gbps</li>
<li>Notes: Also known as Wi-Fi 6, introduces OFDMA (Orthogonal Frequency Division Multiple Access) and improved efficiency in dense environments.</li>
</ul>
<h3 id="80211be"><a class="header" href="#80211be">802.11be</a></h3>
<ul>
<li>Released: 2024</li>
<li>Frequency: 6 GHz</li>
<li>Maximum Speed: 48 Gbps</li>
<li>Notes: Also known as Wi-Fi 7, introduces EHT (Extremely High Throughput) technology.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="wi-fi-security"><a class="header" href="#wi-fi-security">Wi-Fi Security</a></h1>
<p>Wi-Fi security is crucial for protecting wireless networks from unauthorized access and ensuring the confidentiality and integrity of data transmitted over the air. There are several wireless security protocols and mechanisms that have been developed over the years to enhance the security of Wi-Fi networks. Here are some of the most common wireless security protocols:</p>
<h3 id="wep-wired-equivalent-privacy"><a class="header" href="#wep-wired-equivalent-privacy">WEP (Wired Equivalent Privacy)</a></h3>
<ul>
<li><strong>Introduced</strong>: 1997</li>
<li><strong>Encryption</strong>: RC4 stream cipher</li>
<li><strong>Key Length</strong>: 40-bit or 104-bit</li>
<li><strong>Notes</strong>: WEP was the first security protocol for Wi-Fi networks, designed to provide a level of security comparable to that of a wired network. However, it has significant vulnerabilities and is considered insecure. It is no longer recommended for use.</li>
</ul>
<h3 id="wpa-wi-fi-protected-access"><a class="header" href="#wpa-wi-fi-protected-access">WPA (Wi-Fi Protected Access)</a></h3>
<ul>
<li><strong>Introduced</strong>: 2003</li>
<li><strong>Encryption</strong>: TKIP (Temporal Key Integrity Protocol)</li>
<li><strong>Key Length</strong>: 128-bit</li>
<li><strong>Notes</strong>: WPA was introduced as an interim solution to address the weaknesses of WEP. It uses TKIP to improve encryption and includes mechanisms for key management and integrity checking. While more secure than WEP, WPA has been largely replaced by WPA2.</li>
</ul>
<h3 id="wpa2-wi-fi-protected-access-ii"><a class="header" href="#wpa2-wi-fi-protected-access-ii">WPA2 (Wi-Fi Protected Access II)</a></h3>
<ul>
<li><strong>Introduced</strong>: 2004</li>
<li><strong>Encryption</strong>: AES (Advanced Encryption Standard)</li>
<li><strong>Key Length</strong>: 128-bit</li>
<li><strong>Notes</strong>: WPA2 is the most widely used Wi-Fi security protocol today. It uses AES for encryption, which is considered highly secure. WPA2 also includes support for CCMP (Counter Mode with Cipher Block Chaining Message Authentication Code Protocol) for data integrity and confidentiality. It is recommended for all modern Wi-Fi networks.</li>
</ul>
<h4 id="technical-details"><a class="header" href="#technical-details">Technical Details</a></h4>
<p>WPA2 operates in two modes: Personal (WPA2-PSK) and Enterprise (WPA2-Enterprise).</p>
<ol>
<li>
<p><strong>WPA2-Personal (Pre-Shared Key - PSK)</strong>:</p>
<ul>
<li>Uses a pre-shared key for authentication.</li>
<li>Suitable for home and small office networks.</li>
<li>The pre-shared key is used to derive the Pairwise Transient Key (PTK), which is used for encrypting data between the client and the access point.</li>
</ul>
</li>
<li>
<p><strong>WPA2-Enterprise</strong>:</p>
<ul>
<li>Uses 802.1X authentication with an external RADIUS server.</li>
<li>Suitable for enterprise and large networks.</li>
<li>Provides individual authentication credentials for each user.</li>
<li>Supports various Extensible Authentication Protocol (EAP) methods, such as EAP-TLS, EAP-TTLS, and PEAP.</li>
</ul>
</li>
</ol>
<h4 id="key-management"><a class="header" href="#key-management">Key Management</a></h4>
<p>WPA2 uses a robust key management framework to ensure secure communication:</p>
<ul>
<li><strong>Pairwise Master Key (PMK)</strong>: Derived from the pre-shared key (PSK) in WPA2-Personal or obtained through 802.1X authentication in WPA2-Enterprise.</li>
<li><strong>Pairwise Transient Key (PTK)</strong>: Derived from the PMK, the client MAC address, the access point MAC address, and nonces exchanged during the 4-way handshake. The PTK is used to encrypt unicast traffic between the client and the access point.</li>
<li><strong>Group Temporal Key (GTK)</strong>: Used to encrypt broadcast and multicast traffic. The GTK is generated by the access point and distributed to clients during the 4-way handshake.</li>
</ul>
<h4 id="4-way-handshake"><a class="header" href="#4-way-handshake">4-Way Handshake</a></h4>
<p>The 4-way handshake is a crucial process in WPA2 that ensures the secure exchange of encryption keys between the client and the access point:</p>
<ol>
<li><strong>Message 1</strong>: The access point sends an ANonce (a random number) to the client.</li>
<li><strong>Message 2</strong>: The client generates an SNonce (another random number) and uses it, along with the ANonce, to derive the PTK. The client then sends the SNonce to the access point.</li>
<li><strong>Message 3</strong>: The access point uses the SNonce and ANonce to derive the PTK. It then sends the GTK (encrypted with the PTK) and a message integrity code (MIC) to the client.</li>
<li><strong>Message 4</strong>: The client sends an acknowledgment to the access point, indicating that it has successfully installed the PTK and GTK.</li>
</ol>
<h4 id="authentication-and-key-management-akm-suites"><a class="header" href="#authentication-and-key-management-akm-suites">Authentication and Key Management (AKM) Suites</a></h4>
<p>WPA2 supports various AKM suites to provide flexibility in authentication methods:</p>
<ul>
<li><strong>PSK (Pre-Shared Key)</strong>: Used in WPA2-Personal for simple passphrase-based authentication.</li>
<li><strong>802.1X</strong>: Used in WPA2-Enterprise for authentication with a RADIUS server.</li>
<li><strong>FT (Fast Transition)</strong>: Also known as 802.11r, used to enable fast roaming between access points without re-authentication.</li>
<li><strong>SAE (Simultaneous Authentication of Equals)</strong>: Introduced in WPA3 but can be used in WPA2 for enhanced security.</li>
</ul>
<h4 id="frames-in-wpa2"><a class="header" href="#frames-in-wpa2">Frames in WPA2</a></h4>
<p>WPA2 uses several types of frames to manage security and encryption:</p>
<ul>
<li><strong>Authentication Frames</strong>: Used to initiate the authentication process between the client and the access point.</li>
<li><strong>Association Frames</strong>: Used to establish a connection between the client and the access point.</li>
<li><strong>EAPOL (Extensible Authentication Protocol over LAN) Frames</strong>: Used during the 4-way handshake to exchange nonces and encryption keys.</li>
<li><strong>Data Frames</strong>: Encrypted using the PTK for unicast traffic and the GTK for broadcast/multicast traffic.</li>
</ul>
<p>By understanding the technical details and mechanisms of WPA2, users and network administrators can ensure robust security for their Wi-Fi networks, protecting against unauthorized access and ensuring the confidentiality and integrity of their data.</p>
<h3 id="wpa3-wi-fi-protected-access-iii"><a class="header" href="#wpa3-wi-fi-protected-access-iii">WPA3 (Wi-Fi Protected Access III)</a></h3>
<ul>
<li><strong>Introduced</strong>: 2018</li>
<li><strong>Encryption</strong>: AES with GCMP (Galois/Counter Mode Protocol)</li>
<li><strong>Key Length</strong>: 128-bit or 192-bit</li>
<li><strong>Notes</strong>: WPA3 is the latest Wi-Fi security protocol, designed to provide enhanced security features over WPA2. It includes improvements such as Simultaneous Authentication of Equals (SAE) for stronger password-based authentication, forward secrecy to protect data even if a key is compromised, and improved protection against brute-force attacks. WPA3 is recommended for new Wi-Fi networks and devices.</li>
</ul>
<h4 id="key-management-1"><a class="header" href="#key-management-1">Key Management</a></h4>
<p>WPA3 introduces a more robust key management framework to enhance security:</p>
<ul>
<li><strong>Simultaneous Authentication of Equals (SAE)</strong>: A secure key establishment protocol that replaces the pre-shared key (PSK) method used in WPA2-Personal. SAE provides protection against offline dictionary attacks and ensures forward secrecy.</li>
<li><strong>Pairwise Master Key (PMK)</strong>: Derived from the SAE process in WPA3-Personal or obtained through 802.1X authentication in WPA3-Enterprise.</li>
<li><strong>Pairwise Transient Key (PTK)</strong>: Derived from the PMK, the client MAC address, the access point MAC address, and nonces exchanged during the 4-way handshake. The PTK is used to encrypt unicast traffic between the client and the access point.</li>
<li><strong>Group Temporal Key (GTK)</strong>: Used to encrypt broadcast and multicast traffic. The GTK is generated by the access point and distributed to clients during the 4-way handshake.</li>
</ul>
<h4 id="4-way-handshake-1"><a class="header" href="#4-way-handshake-1">4-Way Handshake</a></h4>
<p>The 4-way handshake in WPA3 is similar to WPA2 but includes enhancements for improved security:</p>
<ol>
<li><strong>Message 1</strong>: The access point sends an ANonce (a random number) to the client.</li>
<li><strong>Message 2</strong>: The client generates an SNonce (another random number) and uses it, along with the ANonce, to derive the PTK. The client then sends the SNonce to the access point.</li>
<li><strong>Message 3</strong>: The access point uses the SNonce and ANonce to derive the PTK. It then sends the GTK (encrypted with the PTK) and a message integrity code (MIC) to the client.</li>
<li><strong>Message 4</strong>: The client sends an acknowledgment to the access point, indicating that it has successfully installed the PTK and GTK.</li>
</ol>
<h4 id="authentication-and-key-management-akm-suites-1"><a class="header" href="#authentication-and-key-management-akm-suites-1">Authentication and Key Management (AKM) Suites</a></h4>
<p>WPA3 supports various AKM suites to provide flexibility in authentication methods:</p>
<ul>
<li><strong>SAE (Simultaneous Authentication of Equals)</strong>: Used in WPA3-Personal for secure password-based authentication.</li>
<li><strong>802.1X</strong>: Used in WPA3-Enterprise for authentication with a RADIUS server.</li>
<li><strong>Suite B</strong>: A set of cryptographic algorithms approved by the National Security Agency (NSA) for use in high-security environments. Suite B includes support for 192-bit encryption keys and elliptic curve cryptography (ECC).</li>
</ul>
<h4 id="frames-in-wpa3"><a class="header" href="#frames-in-wpa3">Frames in WPA3</a></h4>
<p>WPA3 uses several types of frames to manage security and encryption:</p>
<ul>
<li><strong>Authentication Frames</strong>: Used to initiate the authentication process between the client and the access point.</li>
<li><strong>Association Frames</strong>: Used to establish a connection between the client and the access point.</li>
<li><strong>EAPOL (Extensible Authentication Protocol over LAN) Frames</strong>: Used during the 4-way handshake to exchange nonces and encryption keys.</li>
<li><strong>Data Frames</strong>: Encrypted using the PTK for unicast traffic and the GTK for broadcast/multicast traffic.</li>
</ul>
<p>By understanding the technical details and mechanisms of WPA3, users and network administrators can ensure robust security for their Wi-Fi networks, protecting against unauthorized access and ensuring the confidentiality and integrity of their data.</p>
<h3 id="8021x-port-based-network-access-control"><a class="header" href="#8021x-port-based-network-access-control">802.1X (Port-Based Network Access Control)</a></h3>
<ul>
<li><strong>Introduced</strong>: 2001</li>
<li><strong>Authentication</strong>: EAP (Extensible Authentication Protocol)</li>
<li><strong>Notes</strong>: 802.1X is a network access control protocol that provides an authentication framework for wired and wireless networks. It is commonly used in enterprise environments to authenticate users and devices before granting access to the network. 802.1X can be used in conjunction with WPA2 and WPA3 for enhanced security.</li>
</ul>
<h4 id="technical-details-1"><a class="header" href="#technical-details-1">Technical Details</a></h4>
<p>802.1X operates at the data link layer (Layer 2) of the OSI model and uses the Extensible Authentication Protocol (EAP) to facilitate authentication. The protocol involves three main components:</p>
<ol>
<li><strong>Supplicant</strong>: The device (e.g., a laptop or smartphone) that requests access to the network.</li>
<li><strong>Authenticator</strong>: The network device (e.g., a switch or wireless access point) that controls access to the network.</li>
<li><strong>Authentication Server</strong>: The server (e.g., a RADIUS server) that validates the credentials of the supplicant.</li>
</ol>
<h4 id="authentication-process"><a class="header" href="#authentication-process">Authentication Process</a></h4>
<p>The 802.1X authentication process involves the following steps:</p>
<ol>
<li><strong>Initialization</strong>: The supplicant connects to the network and the authenticator detects the connection.</li>
<li><strong>EAPOL-Start</strong>: The supplicant sends an EAPOL-Start frame to the authenticator to initiate the authentication process.</li>
<li><strong>EAP-Request/Identity</strong>: The authenticator responds with an EAP-Request/Identity frame, asking the supplicant for its identity.</li>
<li><strong>EAP-Response/Identity</strong>: The supplicant replies with an EAP-Response/Identity frame, providing its identity to the authenticator.</li>
<li><strong>RADIUS Access-Request</strong>: The authenticator forwards the identity information to the authentication server in a RADIUS Access-Request message.</li>
<li><strong>RADIUS Access-Challenge</strong>: The authentication server may respond with a RADIUS Access-Challenge message, requesting additional information (e.g., a password or token).</li>
<li><strong>EAP-Request/Challenge</strong>: The authenticator forwards the challenge to the supplicant in an EAP-Request/Challenge frame.</li>
<li><strong>EAP-Response/Challenge</strong>: The supplicant responds with the requested information in an EAP-Response/Challenge frame.</li>
<li><strong>RADIUS Access-Accept</strong>: If the authentication server successfully validates the credentials, it sends a RADIUS Access-Accept message to the authenticator.</li>
<li><strong>EAP-Success</strong>: The authenticator informs the supplicant of successful authentication with an EAP-Success frame.</li>
<li><strong>Port Authorization</strong>: The authenticator grants access to the network by opening the port for the supplicant.</li>
</ol>
<h4 id="frames-in-8021x"><a class="header" href="#frames-in-8021x">Frames in 802.1X</a></h4>
<p>802.1X uses several types of frames to manage the authentication process:</p>
<ul>
<li>
<p><strong>EAPOL (Extensible Authentication Protocol over LAN) Frames</strong>: Used for communication between the supplicant and the authenticator.</p>
<ul>
<li><strong>EAPOL-Start</strong>: Initiates the authentication process.</li>
<li><strong>EAPOL-Logoff</strong>: Terminates the authentication session.</li>
<li><strong>EAPOL-Key</strong>: Used for key management in WPA/WPA2/WPA3.</li>
<li><strong>EAPOL-Packet</strong>: Carries EAP messages between the supplicant and the authenticator.</li>
</ul>
</li>
<li>
<p><strong>EAP (Extensible Authentication Protocol) Frames</strong>: Used for communication between the supplicant and the authentication server.</p>
<ul>
<li><strong>EAP-Request</strong>: Sent by the authenticator to request information from the supplicant.</li>
<li><strong>EAP-Response</strong>: Sent by the supplicant in response to an EAP-Request.</li>
<li><strong>EAP-Success</strong>: Indicates successful authentication.</li>
<li><strong>EAP-Failure</strong>: Indicates failed authentication.</li>
</ul>
</li>
</ul>
<h4 id="authentication-and-key-management-akm-suites-2"><a class="header" href="#authentication-and-key-management-akm-suites-2">Authentication and Key Management (AKM) Suites</a></h4>
<p>802.1X supports various AKM suites to provide flexibility in authentication methods:</p>
<ul>
<li><strong>EAP-TLS (Transport Layer Security)</strong>: Uses client and server certificates for mutual authentication.</li>
<li><strong>EAP-TTLS (Tunneled Transport Layer Security)</strong>: Establishes a secure tunnel using server certificates, then uses another authentication method (e.g., PAP, CHAP) within the tunnel.</li>
<li><strong>PEAP (Protected Extensible Authentication Protocol)</strong>: Similar to EAP-TTLS, but uses a different method for establishing the secure tunnel.</li>
<li><strong>EAP-MSCHAPv2 (Microsoft Challenge Handshake Authentication Protocol version 2)</strong>: Uses a password-based authentication mechanism.</li>
<li><strong>EAP-SIM (Subscriber Identity Module)</strong>: Uses the SIM card in mobile devices for authentication.</li>
</ul>
<p>By understanding the technical details and mechanisms of 802.1X, users and network administrators can ensure robust security for their wired and wireless networks, protecting against unauthorized access and ensuring the confidentiality and integrity of their data.</p>
<h3 id="wps-wi-fi-protected-setup"><a class="header" href="#wps-wi-fi-protected-setup">WPS (Wi-Fi Protected Setup)</a></h3>
<ul>
<li><strong>Introduced</strong>: 2007</li>
<li><strong>Notes</strong>: WPS is a network security standard designed to simplify the process of connecting devices to a Wi-Fi network. It allows users to connect to a network by pressing a button on the router or entering a PIN. However, WPS has known vulnerabilities and can be exploited by attackers to gain unauthorized access to the network. It is recommended to disable WPS if security is a concern.</li>
</ul>
<h3 id="mac-address-filtering"><a class="header" href="#mac-address-filtering">MAC Address Filtering</a></h3>
<ul>
<li><strong>Notes</strong>: MAC address filtering is a security measure that allows only devices with specific MAC addresses to connect to the Wi-Fi network. While it can provide an additional layer of security, it is not foolproof, as MAC addresses can be spoofed by attackers. It should be used in conjunction with other security measures.</li>
</ul>
<h3 id="guest-networks"><a class="header" href="#guest-networks">Guest Networks</a></h3>
<ul>
<li><strong>Notes</strong>: Many modern routers support the creation of guest networks, which provide a separate Wi-Fi network for visitors. Guest networks can be isolated from the main network, preventing guests from accessing sensitive resources. This is a useful feature for enhancing security in both home and business environments.</li>
</ul>
<p>By understanding and implementing these Wi-Fi security protocols and mechanisms, users and network administrators can protect their wireless networks from unauthorized access and ensure the confidentiality and integrity of their data.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="wi-fi-scanning"><a class="header" href="#wi-fi-scanning">Wi-Fi Scanning</a></h1>
<p>Wi-Fi scanning is the process of identifying available wireless networks within range of a Wi-Fi-enabled device. This process is essential for connecting to Wi-Fi networks, troubleshooting connectivity issues, and optimizing network performance. Wi-Fi scanning can be performed using various tools and techniques, and it typically involves the following steps:</p>
<ol>
<li>
<p><strong>Initiate Scan</strong>:
The Wi-Fi-enabled device sends out probe request frames to discover available networks. These frames are broadcasted on different channels to ensure that all nearby networks are detected.</p>
</li>
<li>
<p><strong>Receive Probe Responses</strong>:
Access points (APs) within range respond to the probe request frames with probe response frames. These frames contain information about the network, such as the Service Set Identifier (SSID), supported data rates, security protocols, and other capabilities.</p>
</li>
<li>
<p><strong>Analyze Beacon Frames</strong>:
In addition to probe responses, the device can also listen for beacon frames that are periodically broadcasted by APs. Beacon frames contain similar information to probe responses and help the device identify available networks.</p>
</li>
<li>
<p><strong>Compile Network List</strong>:
The device compiles a list of available networks based on the received probe responses and beacon frames. This list includes details such as the SSID, signal strength (RSSI), channel, and security type of each network.</p>
</li>
<li>
<p><strong>Select Network</strong>:
The user or device selects a network from the list to connect to. The selection can be based on various factors, such as signal strength, network name, or security requirements.</p>
</li>
</ol>
<h3 id="tools-for-wi-fi-scanning"><a class="header" href="#tools-for-wi-fi-scanning">Tools for Wi-Fi Scanning</a></h3>
<p>Several tools and utilities can be used for Wi-Fi scanning, including:</p>
<ul>
<li><strong>Wireshark</strong>: A network protocol analyzer that can capture and analyze Wi-Fi packets, including probe requests, probe responses, and beacon frames.</li>
<li><strong>NetSpot</strong>: A Wi-Fi survey and analysis tool that provides detailed information about available networks, including signal strength, channel usage, and security settings.</li>
<li><strong>inSSIDer</strong>: A Wi-Fi scanner that displays information about nearby networks, such as SSID, signal strength, channel, and security type.</li>
<li><strong>Acrylic Wi-Fi</strong>: A Wi-Fi scanner and analyzer that provides real-time information about available networks, including signal strength, channel usage, and network performance metrics.</li>
</ul>
<h3 id="importance-of-wi-fi-scanning"><a class="header" href="#importance-of-wi-fi-scanning">Importance of Wi-Fi Scanning</a></h3>
<p>Wi-Fi scanning is crucial for several reasons:</p>
<ul>
<li><strong>Network Discovery</strong>: It allows users to discover available networks and choose the best one to connect to.</li>
<li><strong>Troubleshooting</strong>: It helps identify connectivity issues, such as weak signals, interference, or misconfigured settings.</li>
<li><strong>Optimization</strong>: It provides insights into network performance and helps optimize the configuration, such as selecting the best channel to minimize interference.</li>
<li><strong>Security</strong>: It helps identify unauthorized or rogue access points that may pose a security threat to the network.</li>
</ul>
<p>By understanding and utilizing Wi-Fi scanning techniques, users and network administrators can ensure reliable and efficient wireless connectivity.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="roaming"><a class="header" href="#roaming">Roaming</a></h1>
<h2 id="overview-44"><a class="header" href="#overview-44">Overview</a></h2>
<p>WiFi roaming is the process by which a client device (such as a smartphone or laptop) seamlessly transitions from one access point (AP) to another within the same network without losing connectivity. This is essential for maintaining uninterrupted service in environments with multiple APs, such as offices, campuses, and large homes.</p>
<h3 id="the-roaming-process"><a class="header" href="#the-roaming-process">The Roaming Process</a></h3>
<p>When a client device roams, several steps occur:</p>
<ol>
<li><strong>Discovery</strong>: The client scans for available APs and measures their signal strength (RSSI - Received Signal Strength Indicator).</li>
<li><strong>Decision</strong>: Based on signal strength, network load, and other factors, the client decides to roam to a different AP.</li>
<li><strong>Authentication</strong>: The client authenticates with the new AP.</li>
<li><strong>Reassociation</strong>: The client reassociates with the new AP, completing the handoff.</li>
<li><strong>Key Exchange</strong>: Security keys are exchanged to establish a secure connection.</li>
</ol>
<h3 id="legacy-roaming-challenges"><a class="header" href="#legacy-roaming-challenges">Legacy Roaming Challenges</a></h3>
<p>Traditional roaming (without 802.11r/k/v/w) has several challenges:</p>
<ul>
<li><strong>High Latency</strong>: Full 802.1X authentication can take 50-100ms or more, disrupting real-time applications like VoIP.</li>
<li><strong>Poor Decision Making</strong>: Clients lack information about neighboring APs and may make suboptimal roaming decisions.</li>
<li><strong>Security Vulnerabilities</strong>: Management frames are unprotected, allowing deauthentication attacks.</li>
<li><strong>Inefficient Scanning</strong>: Clients must actively scan all channels to discover APs, wasting time and battery.</li>
</ul>
<p>The 802.11r, 802.11k, 802.11v, and 802.11w standards address these challenges by introducing fast transitions, radio resource management, network management, and security enhancements.</p>
<h3 id="basic-roaming-flow-diagram"><a class="header" href="#basic-roaming-flow-diagram">Basic Roaming Flow Diagram</a></h3>
<pre><code class="language-mermaid">sequenceDiagram
    participant Client
    participant AP1 as Current AP
    participant AP2 as Target AP
    participant DS as Distribution System

    Note over Client,AP1: Client connected to AP1
    Client-&gt;&gt;Client: Monitors signal strength (RSSI)
    Client-&gt;&gt;Client: Signal from AP1 weakening

    Note over Client: Discovery Phase
    Client-&gt;&gt;Client: Scan for nearby APs
    Client-&gt;&gt;AP2: Probe Request
    AP2-&gt;&gt;Client: Probe Response

    Note over Client: Decision Phase
    Client-&gt;&gt;Client: Evaluate AP options&lt;br/&gt;(signal, load, capabilities)
    Client-&gt;&gt;Client: Select AP2 as target

    Note over Client,AP2: Reassociation Phase
    Client-&gt;&gt;AP2: Authentication Request
    AP2-&gt;&gt;Client: Authentication Response
    Client-&gt;&gt;AP2: Reassociation Request
    AP2-&gt;&gt;DS: Notify about client reassociation
    DS-&gt;&gt;AP1: Forward reassociation notice
    AP1-&gt;&gt;DS: Release client context
    AP2-&gt;&gt;Client: Reassociation Response

    Note over Client,AP2: Client now connected to AP2
</code></pre>
<h3 id="roaming-standards-comparison"><a class="header" href="#roaming-standards-comparison">Roaming Standards Comparison</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Standard</th><th>Purpose</th><th>Key Benefit</th><th>Typical Latency</th></tr></thead><tbody>
<tr><td>Legacy</td><td>Basic roaming</td><td>Simple implementation</td><td>50-100ms+</td></tr>
<tr><td>802.11r</td><td>Fast BSS Transition</td><td>Reduced authentication time</td><td>&lt;10ms</td></tr>
<tr><td>802.11k</td><td>Radio Resource Management</td><td>Better AP selection</td><td>N/A (decision aid)</td></tr>
<tr><td>802.11v</td><td>Network Management</td><td>Network-assisted roaming</td><td>Improved efficiency</td></tr>
<tr><td>802.11w</td><td>Protected Management Frames</td><td>Security against attacks</td><td>N/A (security)</td></tr>
</tbody></table>
</div>
<h2 id="80211r"><a class="header" href="#80211r">802.11r</a></h2>
<ul>
<li>Also known as Fast BSS Transition (FT).</li>
<li>Released: 2008.</li>
<li>Purpose: Improves the speed of the handoff process between access points.</li>
<li>Notes: Reduces the time required for re-authentication when a device moves from one AP to another.</li>
</ul>
<h3 id="technical-details-of-80211r"><a class="header" href="#technical-details-of-80211r">Technical Details of 802.11r</a></h3>
<p>802.11r, also known as Fast BSS Transition (FT), is a standard that aims to improve the handoff process between access points (APs) in a wireless network. This is particularly important for applications that require seamless connectivity, such as VoIP (Voice over IP) and real-time video streaming. Here are some key technical details:</p>
<ol>
<li>
<p><strong>Key Caching</strong>:</p>
<ul>
<li>802.11r introduces the concept of key caching, which allows a client device to reuse the Pairwise Master Key (PMK) from a previous connection when roaming to a new AP. This reduces the time required for re-authentication.</li>
</ul>
</li>
<li>
<p><strong>Fast Transition (FT) Protocol</strong>:</p>
<ul>
<li>The FT protocol defines two methods for fast transitions: over-the-air and over-the-DS (Distribution System).
<ul>
<li><strong>Over-the-Air</strong>: The client communicates directly with the target AP to perform the handoff.</li>
<li><strong>Over-the-DS</strong>: The client communicates with the target AP through the current AP, using the wired network (DS) as an intermediary.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Reduced Latency</strong>:</p>
<ul>
<li>By minimizing the time required for re-authentication and key exchange, 802.11r significantly reduces the latency associated with roaming. This is crucial for maintaining the quality of real-time applications.</li>
</ul>
</li>
<li>
<p><strong>FT Initial Mobility Domain Association</strong>:</p>
<ul>
<li>When a client first associates with an AP in an 802.11r-enabled network, it performs an FT Initial Mobility Domain Association. This process establishes the necessary security context and prepares the client for fast transitions within the mobility domain.</li>
</ul>
</li>
<li>
<p><strong>Mobility Domain Information Element (MDIE)</strong>:</p>
<ul>
<li>The MDIE is included in the beacon frames and probe responses of 802.11r-enabled APs. It provides information about the mobility domain, allowing client devices to identify and connect to APs that support fast transitions.</li>
</ul>
</li>
<li>
<p><strong>Fast BSS Transition Information Element (FTIE)</strong>:</p>
<ul>
<li>The FTIE is used during the authentication and reassociation processes to carry the necessary cryptographic information for fast transitions. It ensures that the security context is properly established and maintained during the handoff.</li>
</ul>
</li>
<li>
<p><strong>Compatibility</strong>:</p>
<ul>
<li>802.11r is designed to be backward compatible with non-802.11r devices. APs can support both 802.11r and non-802.11r clients simultaneously, ensuring a smooth transition for devices that do not support the standard.</li>
</ul>
</li>
<li>
<p><strong>Key Hierarchy in 802.11r</strong>:</p>
<ul>
<li>The key hierarchy in 802.11r builds upon the existing 802.11i security framework:
<ul>
<li><strong>PMK (Pairwise Master Key)</strong>: Derived from the initial 802.1X authentication, cached for reuse during fast transitions</li>
<li><strong>PMK-R0</strong>: First-level derivation from PMK, includes the mobility domain identifier (MDID)</li>
<li><strong>PMK-R1</strong>: Second-level derivation, specific to the target AP's R1 Key Holder</li>
<li><strong>PTK (Pairwise Transient Key)</strong>: Final session key derived from PMK-R1 during reassociation</li>
</ul>
</li>
<li>This hierarchical approach enables APs to derive session keys without contacting the authentication server</li>
</ul>
</li>
<li>
<p><strong>Mobility Domain</strong>:</p>
<ul>
<li>A Mobility Domain (MD) is a group of APs that share the same security context and allow fast transitions</li>
<li>All APs in the same MD advertise the same Mobility Domain Identifier (MDID) in their beacons</li>
<li>Clients that associate with an AP in an MD can roam to any other AP in the same MD using fast transitions</li>
<li>The MD eliminates the need for full re-authentication when moving between APs</li>
</ul>
</li>
<li>
<p><strong>R0 and R1 Key Holders</strong>:</p>
<ul>
<li><strong>R0 Key Holder (R0KH)</strong>: Typically the RADIUS/authentication server or a centralized controller that holds PMK-R0</li>
<li><strong>R1 Key Holder (R1KH)</strong>: Each AP in the mobility domain, holds PMK-R1 keys for clients</li>
<li>During FT, the target AP's R1KH requests the PMK-R1 from the R0KH or retrieves it from the current AP</li>
</ul>
</li>
</ol>
<p>By implementing these technical features, 802.11r enhances the efficiency and reliability of the roaming process, providing a better user experience in environments with multiple access points.</p>
<h3 id="80211r-key-hierarchy"><a class="header" href="#80211r-key-hierarchy">802.11r Key Hierarchy</a></h3>
<pre><code class="language-mermaid">graph TB
    MSK[MSK - Master Session Key&lt;br/&gt;from 802.1X/EAP Auth]

    MSK --&gt; PMK[PMK - Pairwise Master Key&lt;br/&gt;Derived via PRF]

    PMK --&gt; PMKR0[PMK-R0&lt;br/&gt;Includes: SSID + MDID + R0KHID&lt;br/&gt;Stored at R0 Key Holder]

    PMKR0 --&gt; PMKR1_AP1[PMK-R1 for AP1&lt;br/&gt;Includes: R1KHID AP1&lt;br/&gt;Stored at AP1]
    PMKR0 --&gt; PMKR1_AP2[PMK-R1 for AP2&lt;br/&gt;Includes: R1KHID AP2&lt;br/&gt;Stored at AP2]
    PMKR0 --&gt; PMKR1_AP3[PMK-R1 for AP3&lt;br/&gt;Includes: R1KHID AP3&lt;br/&gt;Stored at AP3]

    PMKR1_AP1 --&gt; PTK1[PTK for Session with AP1&lt;br/&gt;Ephemeral, per-association]
    PMKR1_AP2 --&gt; PTK2[PTK for Session with AP2&lt;br/&gt;Ephemeral, per-association]
    PMKR1_AP3 --&gt; PTK3[PTK for Session with AP3&lt;br/&gt;Ephemeral, per-association]

    PTK1 --&gt; Traffic1[Encrypted Traffic]
    PTK2 --&gt; Traffic2[Encrypted Traffic]
    PTK3 --&gt; Traffic3[Encrypted Traffic]

    style MSK fill:#FFE6E6
    style PMK fill:#FFE6E6
    style PMKR0 fill:#FFF9E6
    style PMKR1_AP1 fill:#E6F3FF
    style PMKR1_AP2 fill:#E6F3FF
    style PMKR1_AP3 fill:#E6F3FF
    style PTK1 fill:#E6FFE6
    style PTK2 fill:#E6FFE6
    style PTK3 fill:#E6FFE6
</code></pre>
<h3 id="80211r-fast-bss-transition-flow"><a class="header" href="#80211r-fast-bss-transition-flow">802.11r Fast BSS Transition Flow</a></h3>
<pre><code class="language-mermaid">sequenceDiagram
    participant Client
    participant CurrentAP as Current AP (AP1)
    participant TargetAP as Target AP (AP2)
    participant DS as Distribution System
    participant AuthServer as Authentication Server

    Note over Client,CurrentAP: Initial Association with FT
    Client-&gt;&gt;CurrentAP: Association Request (MDIE, RSN)
    CurrentAP-&gt;&gt;AuthServer: Full 802.1X Authentication
    AuthServer-&gt;&gt;CurrentAP: PMK (Pairwise Master Key)
    CurrentAP-&gt;&gt;CurrentAP: Derive PTK, GTK
    CurrentAP-&gt;&gt;Client: Association Response (MDIE, FTIE)
    Note over Client,CurrentAP: Client now part of Mobility Domain

    Note over Client: Signal weakening, client scans
    Client-&gt;&gt;TargetAP: Probe Request
    TargetAP-&gt;&gt;Client: Probe Response (MDIE, FT-capable)

    alt Over-the-Air FT
        Note over Client,TargetAP: Fast Transition (Over-the-Air)
        Client-&gt;&gt;TargetAP: FT Authentication Request (FTIE, MDIE)
        TargetAP-&gt;&gt;CurrentAP: Request PMK context (via DS)
        CurrentAP-&gt;&gt;TargetAP: Transfer PMK context
        TargetAP-&gt;&gt;TargetAP: Derive new PTK using PMK
        TargetAP-&gt;&gt;Client: FT Authentication Response (FTIE)
        Client-&gt;&gt;TargetAP: FT Reassociation Request
        TargetAP-&gt;&gt;Client: FT Reassociation Response
        Note over Client,TargetAP: Handoff complete (~10ms)
    else Over-the-DS FT
        Note over Client,DS: Fast Transition (Over-the-DS)
        Client-&gt;&gt;CurrentAP: FT Request (to TargetAP)
        CurrentAP-&gt;&gt;TargetAP: Forward FT Request + PMK
        TargetAP-&gt;&gt;TargetAP: Derive new PTK
        TargetAP-&gt;&gt;CurrentAP: FT Response
        CurrentAP-&gt;&gt;Client: FT Response
        Client-&gt;&gt;TargetAP: FT Reassociation Request
        TargetAP-&gt;&gt;Client: FT Reassociation Response
        Note over Client,TargetAP: Handoff complete (~10ms)
    end
</code></pre>
<h3 id="key-differences-legacy-vs-80211r"><a class="header" href="#key-differences-legacy-vs-80211r">Key Differences: Legacy vs 802.11r</a></h3>
<pre><code class="language-mermaid">flowchart TD
    subgraph Legacy["Legacy Roaming (50-100ms)"]
        L1[Scan &amp; Probe] --&gt; L2[Open Authentication]
        L2 --&gt; L3[Full 802.1X Auth]
        L3 --&gt; L4[4-Way Handshake]
        L4 --&gt; L5[Reassociation]
    end

    subgraph FT["802.11r Fast Transition (&lt;10ms)"]
        F1[Scan &amp; Probe] --&gt; F2[FT Authentication&lt;br/&gt;with PMK Cache]
        F2 --&gt; F3[FT Reassociation&lt;br/&gt;PTK Derived]
        style F3 fill:#90EE90
    end

    style Legacy fill:#FFB6C6
    style FT fill:#B6FFB6
</code></pre>
<h2 id="80211k"><a class="header" href="#80211k">802.11k</a></h2>
<ul>
<li>Also known as Radio Resource Management (RRM).</li>
<li>Released: 2008.</li>
<li>Purpose: Provides mechanisms for measuring and reporting the radio environment.</li>
<li>Notes: Helps devices make better roaming decisions by providing information about neighboring APs.</li>
</ul>
<h3 id="technical-details-of-80211k"><a class="header" href="#technical-details-of-80211k">Technical Details of 802.11k</a></h3>
<p>802.11k, also known as Radio Resource Management (RRM), is a standard that provides mechanisms for measuring and reporting the radio environment. This information helps client devices make better roaming decisions by providing data about neighboring access points (APs). Here are some key technical details:</p>
<ol>
<li>
<p><strong>Neighbor Reports</strong>:</p>
<ul>
<li>802.11k enables APs to provide neighbor reports to client devices. These reports contain information about nearby APs, including their signal strength, channel, and supported data rates. This helps clients identify the best AP to roam to.</li>
</ul>
</li>
<li>
<p><strong>Beacon Reports</strong>:</p>
<ul>
<li>Client devices can request beacon reports from APs. These reports include details about the beacons received from neighboring APs, such as signal strength and channel utilization. This information assists clients in making informed roaming decisions.</li>
</ul>
</li>
<li>
<p><strong>Channel Load Reports</strong>:</p>
<ul>
<li>APs can provide channel load reports, which indicate the level of traffic on a particular channel. This helps client devices avoid congested channels and select APs operating on less crowded frequencies.</li>
</ul>
</li>
<li>
<p><strong>Noise Histogram Reports</strong>:</p>
<ul>
<li>Noise histogram reports provide information about the noise levels on different channels. By analyzing these reports, client devices can avoid channels with high levels of interference, improving overall network performance.</li>
</ul>
</li>
<li>
<p><strong>Transmit Stream/Category Measurement Reports</strong>:</p>
<ul>
<li>These reports provide data on the performance of specific traffic streams or categories. This helps client devices assess the quality of service (QoS) provided by different APs and make better roaming decisions based on their specific needs.</li>
</ul>
</li>
<li>
<p><strong>Location Tracking</strong>:</p>
<ul>
<li>802.11k supports location tracking features, allowing APs to track the location of client devices within the network. This information can be used to optimize network performance and improve the accuracy of neighbor reports.</li>
</ul>
</li>
<li>
<p><strong>Link Measurement Reports</strong>:</p>
<ul>
<li>Link measurement reports provide detailed information about the quality of the wireless link between the client device and the AP. This includes metrics such as signal-to-noise ratio (SNR) and packet error rate (PER), which help clients evaluate the performance of their current connection and potential target APs.</li>
</ul>
</li>
</ol>
<p>By implementing these technical features, 802.11k enhances the ability of client devices to make informed roaming decisions, leading to improved network performance and a better user experience in environments with multiple access points.</p>
<h3 id="80211k-neighbor-discovery-and-reporting"><a class="header" href="#80211k-neighbor-discovery-and-reporting">802.11k Neighbor Discovery and Reporting</a></h3>
<pre><code class="language-mermaid">sequenceDiagram
    participant Client
    participant AP1 as Current AP
    participant AP2 as Neighbor AP
    participant AP3 as Neighbor AP

    Note over Client,AP1: Client associated with AP1

    rect rgb(230, 240, 255)
        Note over Client,AP1: Neighbor Report Request
        Client-&gt;&gt;AP1: Neighbor Report Request
        AP1-&gt;&gt;AP1: Generate neighbor list&lt;br/&gt;(AP2, AP3, etc.)
        AP1-&gt;&gt;Client: Neighbor Report Response&lt;br/&gt;(AP info: BSSID, Channel, PHY)
    end

    rect rgb(255, 240, 230)
        Note over Client: Beacon Report Request (optional)
        Client-&gt;&gt;Client: Request detailed beacon info
        AP1-&gt;&gt;Client: Beacon Request (scan AP2, AP3)
        Client-&gt;&gt;Client: Passive/Active scan
        Client-&gt;&gt;AP1: Beacon Report&lt;br/&gt;(RSSI, Channel Load, etc.)
    end

    rect rgb(240, 255, 240)
        Note over Client: Radio Measurement Reports
        Client-&gt;&gt;Client: Analyze reports:&lt;br/&gt;• Signal strength (RSSI)&lt;br/&gt;• Channel utilization&lt;br/&gt;• Noise histogram&lt;br/&gt;• Link quality
        Client-&gt;&gt;Client: Select best AP for roaming
    end

    Note over Client,AP2: Client roams to AP2
</code></pre>
<h3 id="80211k-report-types"><a class="header" href="#80211k-report-types">802.11k Report Types</a></h3>
<pre><code class="language-mermaid">graph TB
    subgraph RRM["802.11k Radio Resource Management"]
        NR[Neighbor Report]
        BR[Beacon Report]
        CLR[Channel Load Report]
        NHR[Noise Histogram]
        LMR[Link Measurement]

        NR --&gt;|Provides| NR1[BSSID, Channel,&lt;br/&gt;Operating Class]
        BR --&gt;|Provides| BR1[RSSI, Beacon Interval,&lt;br/&gt;Capability Info]
        CLR --&gt;|Provides| CLR1[Channel Busy %,&lt;br/&gt;Medium Utilization]
        NHR --&gt;|Provides| NHR1[Interference Levels&lt;br/&gt;per Channel]
        LMR --&gt;|Provides| LMR1[SNR, Packet Error Rate,&lt;br/&gt;Transmit Power]
    end

    NR1 --&gt; Decision[Intelligent&lt;br/&gt;Roaming Decision]
    BR1 --&gt; Decision
    CLR1 --&gt; Decision
    NHR1 --&gt; Decision
    LMR1 --&gt; Decision

    style Decision fill:#90EE90
    style RRM fill:#E6F3FF
</code></pre>
<h2 id="80211v"><a class="header" href="#80211v">802.11v</a></h2>
<ul>
<li>Also known as Wireless Network Management.</li>
<li>Released: 2011.</li>
<li>Purpose: Enhances network management by providing mechanisms for configuring client devices.</li>
<li>Notes: Includes features like BSS Transition Management, which helps devices roam more efficiently.</li>
</ul>
<h3 id="technical-details-of-80211v"><a class="header" href="#technical-details-of-80211v">Technical Details of 802.11v</a></h3>
<p>802.11v, also known as Wireless Network Management, is a standard that enhances network management by providing mechanisms for configuring client devices. This standard includes several features that improve the efficiency and performance of wireless networks. Here are some key technical details:</p>
<ol>
<li>
<p><strong>BSS Transition Management</strong>:</p>
<ul>
<li>802.11v provides BSS Transition Management, which helps client devices make better roaming decisions. APs can suggest the best APs for clients to roam to, based on factors like signal strength and load.</li>
</ul>
</li>
<li>
<p><strong>Network Assisted Power Savings</strong>:</p>
<ul>
<li>This feature allows APs to provide information to client devices about the best times to enter power-saving modes. By coordinating power-saving activities, 802.11v helps extend battery life for client devices.</li>
</ul>
</li>
<li>
<p><strong>Traffic Filtering Service (TFS)</strong>:</p>
<ul>
<li>TFS enables APs to filter traffic for client devices, reducing the amount of unnecessary data that clients need to process. This helps improve the efficiency of the network and reduces power consumption for client devices.</li>
</ul>
</li>
<li>
<p><strong>Wireless Network Management (WNM) Sleep Mode</strong>:</p>
<ul>
<li>WNM Sleep Mode allows client devices to enter a low-power sleep state while remaining connected to the network. APs can buffer data for sleeping clients and deliver it when they wake up, improving power efficiency without sacrificing connectivity.</li>
</ul>
</li>
<li>
<p><strong>Diagnostic and Reporting</strong>:</p>
<ul>
<li>802.11v includes mechanisms for diagnostic and reporting, allowing APs and client devices to exchange information about network performance and issues. This helps network administrators identify and resolve problems more quickly.</li>
</ul>
</li>
<li>
<p><strong>Location Services</strong>:</p>
<ul>
<li>The standard supports location services, enabling APs to provide location-based information to client devices. This can be used for applications like asset tracking and location-based services.</li>
</ul>
</li>
</ol>
<p>By implementing these technical features, 802.11v enhances the management and performance of wireless networks, leading to improved efficiency, better power management, and a more reliable user experience in environments with multiple access points.</p>
<h3 id="80211v-bss-transition-management"><a class="header" href="#80211v-bss-transition-management">802.11v BSS Transition Management</a></h3>
<pre><code class="language-mermaid">sequenceDiagram
    participant Client
    participant AP1 as Current AP
    participant AP2 as Target AP (Preferred)
    participant Controller as Network Controller

    Note over Client,AP1: Client connected to AP1

    rect rgb(255, 230, 230)
        Note over AP1,Controller: Network-Initiated Roaming
        Controller-&gt;&gt;AP1: Detect client should move&lt;br/&gt;(load balancing/signal)
        AP1-&gt;&gt;Client: BTM Request&lt;br/&gt;(Candidate List: AP2)
        Note over Client: Candidate List includes:&lt;br/&gt;• BSSID of target APs&lt;br/&gt;• Operating class &amp; channel&lt;br/&gt;• Preference values
    end

    rect rgb(230, 255, 230)
        Note over Client: Client Decision
        Client-&gt;&gt;Client: Evaluate BTM candidates&lt;br/&gt;+ own scan results
        Client-&gt;&gt;Client: Select AP2 (highest preference)
        Client-&gt;&gt;AP1: BTM Response (Accept)
    end

    rect rgb(230, 230, 255)
        Note over Client,AP2: Roaming Process
        Client-&gt;&gt;AP2: Authentication &amp; Reassociation
        AP2-&gt;&gt;Client: Association Response
        Note over Client,AP2: Client now on AP2
    end

    Client-&gt;&gt;AP2: BTM Status Report (optional)
</code></pre>
<h3 id="80211v-features-overview"><a class="header" href="#80211v-features-overview">802.11v Features Overview</a></h3>
<pre><code class="language-mermaid">graph LR
    subgraph WNM["802.11v Wireless Network Management"]
        BTM[BSS Transition&lt;br/&gt;Management]
        DMS[Directed Multicast&lt;br/&gt;Service]
        FMS[Flexible Multicast&lt;br/&gt;Service]
        TFS[Traffic Filtering&lt;br/&gt;Service]
        Sleep[WNM Sleep Mode]
    end

    BTM --&gt;|Benefit| BTM1[Network-assisted&lt;br/&gt;roaming decisions]
    DMS --&gt;|Benefit| DMS1[Efficient multicast&lt;br/&gt;delivery]
    FMS --&gt;|Benefit| FMS1[Scheduled multicast&lt;br/&gt;for power saving]
    TFS --&gt;|Benefit| TFS1[Filter unwanted&lt;br/&gt;traffic at AP]
    Sleep --&gt;|Benefit| Sleep1[Deep sleep while&lt;br/&gt;maintaining connection]

    BTM1 --&gt; Outcome[Better Performance&lt;br/&gt;&amp; Battery Life]
    DMS1 --&gt; Outcome
    FMS1 --&gt; Outcome
    TFS1 --&gt; Outcome
    Sleep1 --&gt; Outcome

    style Outcome fill:#90EE90
    style WNM fill:#FFE6F0
</code></pre>
<h3 id="client-initiated-vs-network-initiated-roaming"><a class="header" href="#client-initiated-vs-network-initiated-roaming">Client-Initiated vs Network-Initiated Roaming</a></h3>
<pre><code class="language-mermaid">flowchart TB
    subgraph Client["Client-Initiated (Legacy)"]
        C1[Client monitors RSSI] --&gt; C2[Signal weakens]
        C2 --&gt; C3[Client scans all channels]
        C3 --&gt; C4[Client selects AP]
        C4 --&gt; C5[Client initiates roam]
    end

    subgraph Network["Network-Initiated (802.11v)"]
        N1[AP/Controller monitors&lt;br/&gt;client conditions] --&gt; N2[AP detects poor signal&lt;br/&gt;or load imbalance]
        N2 --&gt; N3[AP sends BTM Request&lt;br/&gt;with candidate list]
        N3 --&gt; N4[Client evaluates&lt;br/&gt;suggestions]
        N4 --&gt; N5[Client roams to&lt;br/&gt;recommended AP]
    end

    style Client fill:#FFE6E6
    style Network fill:#E6FFE6
</code></pre>
<h2 id="80211w"><a class="header" href="#80211w">802.11w</a></h2>
<ul>
<li>Also known as Protected Management Frames (PMF).</li>
<li>Released: 2009.</li>
<li>Purpose: Enhances the security of management frames.</li>
<li>Notes: Protects against certain types of attacks, such as deauthentication and disassociation attacks.</li>
</ul>
<h3 id="technical-details-of-80211w"><a class="header" href="#technical-details-of-80211w">Technical Details of 802.11w</a></h3>
<p>802.11w, also known as Protected Management Frames (PMF), is a standard that enhances the security of management frames in wireless networks. This standard provides mechanisms to protect against certain types of attacks, such as deauthentication and disassociation attacks. Here are some key technical details:</p>
<ol>
<li>
<p><strong>Management Frame Protection</strong>:</p>
<ul>
<li>802.11w provides protection for management frames, which are used for network control and signaling. By securing these frames, the standard helps prevent attackers from disrupting network operations.</li>
</ul>
</li>
<li>
<p><strong>Protected Management Frames (PMF)</strong>:</p>
<ul>
<li>PMF ensures that management frames are both encrypted and authenticated. This prevents unauthorized devices from injecting malicious management frames into the network.</li>
</ul>
</li>
<li>
<p><strong>Robust Security Network (RSN) Associations</strong>:</p>
<ul>
<li>802.11w requires the use of RSN associations, which provide a secure method for devices to join the network. This includes the use of cryptographic techniques to protect the integrity and confidentiality of management frames.</li>
</ul>
</li>
<li>
<p><strong>Replay Protection</strong>:</p>
<ul>
<li>The standard includes mechanisms to protect against replay attacks, where an attacker captures and retransmits management frames to disrupt network operations. By using sequence numbers and timestamps, 802.11w ensures that management frames cannot be reused maliciously.</li>
</ul>
</li>
<li>
<p><strong>Deauthentication and Disassociation Protection</strong>:</p>
<ul>
<li>802.11w specifically addresses deauthentication and disassociation attacks, where an attacker forces a device to disconnect from the network. By securing these management frames, the standard helps maintain stable and reliable network connections.</li>
</ul>
</li>
<li>
<p><strong>Cryptographic Protection Mechanisms</strong>:</p>
<ul>
<li><strong>IGTK (Integrity Group Temporal Key)</strong>: Used to protect broadcast/multicast management frames</li>
<li><strong>BIP (Broadcast/Multicast Integrity Protocol)</strong>: Default integrity algorithm, uses AES-128-CMAC</li>
<li><strong>MIC (Message Integrity Code)</strong>: Appended to protected management frames to verify authenticity</li>
<li><strong>SA Query Mechanism</strong>: Allows clients to verify the authenticity of disassociation/deauthentication frames</li>
</ul>
</li>
<li>
<p><strong>Protected Frame Types</strong>:</p>
<ul>
<li><strong>Disassociation</strong>: Protected to prevent forced disconnection attacks</li>
<li><strong>Deauthentication</strong>: Protected to prevent session hijacking</li>
<li><strong>Robust Management Frames</strong>: Action frames related to QoS, spectrum management, and fast BSS transition</li>
<li><strong>Unprotected Frames</strong>: Beacon, Probe Request/Response, and Authentication frames remain unprotected for compatibility</li>
</ul>
</li>
<li>
<p><strong>PMF Modes</strong>:</p>
<ul>
<li><strong>Optional (PMF=1)</strong>: Client can connect with or without PMF support</li>
<li><strong>Required (PMF=2)</strong>: Client must support PMF to connect (WPA3 requirement)</li>
<li>Mixed mode allows gradual migration from legacy to protected networks</li>
</ul>
</li>
</ol>
<p>By implementing these technical features, 802.11w enhances the security of wireless networks, protecting against various types of attacks and ensuring the integrity and reliability of network operations.</p>
<h3 id="80211w-protected-management-frames"><a class="header" href="#80211w-protected-management-frames">802.11w Protected Management Frames</a></h3>
<pre><code class="language-mermaid">sequenceDiagram
    participant Attacker
    participant Client
    participant AP

    Note over Client,AP: Without 802.11w (Vulnerable)
    rect rgb(255, 200, 200)
        Attacker-&gt;&gt;Client: Deauth Frame (Spoofed)
        Client-&gt;&gt;Client: Disconnect from AP
        Note over Client: Connection disrupted!
    end

    Note over Client,AP: With 802.11w (Protected)
    rect rgb(200, 255, 200)
        Client-&gt;&gt;AP: Initial 4-Way Handshake
        AP-&gt;&gt;Client: Establish IGTK (Integrity Group Temporal Key)
        Attacker-&gt;&gt;Client: Deauth Frame (Spoofed)
        Client-&gt;&gt;Client: Verify frame integrity&lt;br/&gt;using MIC (Message Integrity Code)
        Client-&gt;&gt;Client: Invalid MIC - Frame rejected
        Note over Client,AP: Connection maintained!
    end
</code></pre>
<h2 id="comprehensive-roaming-comparison"><a class="header" href="#comprehensive-roaming-comparison">Comprehensive Roaming Comparison</a></h2>
<h3 id="legacy-vs-modern-roaming"><a class="header" href="#legacy-vs-modern-roaming">Legacy vs Modern Roaming</a></h3>
<pre><code class="language-mermaid">sequenceDiagram
    participant C as Client
    participant OldAP as Current AP
    participant NewAP as Target AP
    participant Auth as Auth Server

    rect rgb(255, 230, 230)
        Note over C,Auth: Legacy Roaming (~100ms)
        C-&gt;&gt;C: Scan all channels (20-50ms)
        C-&gt;&gt;NewAP: Probe Request
        NewAP-&gt;&gt;C: Probe Response
        C-&gt;&gt;NewAP: Authentication Request
        NewAP-&gt;&gt;C: Authentication Response
        C-&gt;&gt;NewAP: Association Request
        NewAP-&gt;&gt;Auth: Full 802.1X (30-50ms)
        Auth-&gt;&gt;NewAP: PMK
        NewAP-&gt;&gt;C: 4-Way Handshake (20ms)
        C-&gt;&gt;NewAP: Reassociation Complete
    end

    Note over C: ---

    rect rgb(230, 255, 230)
        Note over C,Auth: Modern Roaming with 802.11r/k/v (&lt;20ms)
        OldAP-&gt;&gt;C: Neighbor Report (802.11k)
        OldAP-&gt;&gt;C: BTM Request (802.11v)
        C-&gt;&gt;C: Targeted scan (5-10ms)
        C-&gt;&gt;NewAP: FT Authentication (802.11r)
        NewAP-&gt;&gt;OldAP: Request PMK context
        OldAP-&gt;&gt;NewAP: Transfer PMK
        NewAP-&gt;&gt;C: FT Authentication Response
        C-&gt;&gt;NewAP: FT Reassociation (&lt;10ms)
        Note over C,NewAP: Roaming complete!
    end
</code></pre>
<h3 id="how-the-standards-work-together"><a class="header" href="#how-the-standards-work-together">How the Standards Work Together</a></h3>
<pre><code class="language-mermaid">graph TB
    Client[WiFi Client Device]

    subgraph Discovery["Discovery Phase (802.11k)"]
        K1[Request Neighbor Report] --&gt; K2[Receive AP List with&lt;br/&gt;RSSI, Channel, Load]
        K2 --&gt; K3[Targeted Scanning]
    end

    subgraph Decision["Decision Phase (802.11v)"]
        V1[Receive BTM Request] --&gt; V2[Evaluate Candidates&lt;br/&gt;+ Network Suggestions]
        V2 --&gt; V3[Select Optimal AP]
    end

    subgraph Transition["Transition Phase (802.11r)"]
        R1[FT Authentication&lt;br/&gt;with PMK Cache] --&gt; R2[Fast Key Derivation]
        R2 --&gt; R3[FT Reassociation&lt;br/&gt;&lt;10ms]
    end

    subgraph Security["Security (802.11w)"]
        W1[Protected Management&lt;br/&gt;Frames] --&gt; W2[Prevent Deauth Attacks]
        W2 --&gt; W3[Secure Roaming Process]
    end

    Client --&gt; Discovery
    Discovery --&gt; Decision
    Decision --&gt; Transition
    Transition --&gt; Security
    Security --&gt; Connected[Connected to New AP]

    style Discovery fill:#E6F3FF
    style Decision fill:#FFE6F0
    style Transition fill:#E6FFE6
    style Security fill:#FFF9E6
    style Connected fill:#90EE90
</code></pre>
<h3 id="performance-comparison-table"><a class="header" href="#performance-comparison-table">Performance Comparison Table</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Roaming Aspect</th><th>Legacy</th><th>With 802.11r</th><th>With 802.11r/k/v</th><th>Full r/k/v/w</th></tr></thead><tbody>
<tr><td><strong>Latency</strong></td><td>50-100ms</td><td>&lt;10ms</td><td>&lt;10ms</td><td>&lt;10ms</td></tr>
<tr><td><strong>AP Discovery</strong></td><td>Full scan (all channels)</td><td>Full scan</td><td>Targeted scan</td><td>Targeted scan</td></tr>
<tr><td><strong>Decision Making</strong></td><td>Client-only</td><td>Client-only</td><td>Network-assisted</td><td>Network-assisted</td></tr>
<tr><td><strong>Authentication</strong></td><td>Full 802.1X</td><td>PMK caching</td><td>PMK caching</td><td>PMK caching</td></tr>
<tr><td><strong>Security</strong></td><td>Vulnerable to deauth</td><td>Vulnerable to deauth</td><td>Vulnerable to deauth</td><td>Protected</td></tr>
<tr><td><strong>VoIP Quality</strong></td><td>May experience dropouts</td><td>Seamless</td><td>Seamless</td><td>Seamless</td></tr>
<tr><td><strong>Battery Impact</strong></td><td>High (full scans)</td><td>Medium</td><td>Low (targeted)</td><td>Low (targeted)</td></tr>
<tr><td><strong>Best For</strong></td><td>Simple networks</td><td>Fast handoffs</td><td>Enterprise</td><td>Enterprise + Security</td></tr>
</tbody></table>
</div>
<h3 id="real-world-roaming-timeline"><a class="header" href="#real-world-roaming-timeline">Real-World Roaming Timeline</a></h3>
<pre><code class="language-mermaid">gantt
    title Roaming Process Timeline Comparison
    dateFormat X
    axisFormat %Lms

    section Legacy
    Channel Scanning           :0, 50
    Authentication             :50, 30
    4-Way Handshake           :80, 20
    Total (100ms)             :0, 100

    section 802.11r Only
    Channel Scanning           :0, 40
    FT Authentication         :40, 5
    FT Reassociation          :45, 5
    Total (50ms)              :0, 50

    section 802.11r+k+v
    Targeted Scanning         :0, 10
    FT Authentication         :10, 5
    FT Reassociation          :15, 5
    Total (20ms)              :0, 20
</code></pre>
<h2 id="implementation-considerations"><a class="header" href="#implementation-considerations">Implementation Considerations</a></h2>
<h3 id="enabling-fast-roaming"><a class="header" href="#enabling-fast-roaming">Enabling Fast Roaming</a></h3>
<p>To achieve optimal roaming performance, consider the following:</p>
<ol>
<li>
<p><strong>Network Requirements</strong>:</p>
<ul>
<li>All APs must support the same roaming standards (802.11r/k/v/w)</li>
<li>APs should be part of the same Mobility Domain (for 802.11r)</li>
<li>Backend infrastructure must support PMK caching and distribution</li>
</ul>
</li>
<li>
<p><strong>Configuration Best Practices</strong>:</p>
<ul>
<li>Enable FT over-the-DS for better performance in dense deployments</li>
<li>Configure neighbor reports accurately with current AP information</li>
<li>Set appropriate BTM preference values to guide client decisions</li>
<li>Ensure PMF (802.11w) is enabled for security</li>
</ul>
</li>
<li>
<p><strong>Client Support</strong>:</p>
<ul>
<li>Verify client devices support the required standards</li>
<li>Update client drivers and firmware for best compatibility</li>
<li>Test roaming behavior with target applications (VoIP, video conferencing)</li>
</ul>
</li>
<li>
<p><strong>Tuning Parameters</strong>:</p>
<ul>
<li>RSSI thresholds for roaming triggers (typically -70 to -75 dBm)</li>
<li>Channel overlap and interference considerations</li>
<li>Load balancing thresholds for BTM requests</li>
<li>Roaming retry intervals and timeouts</li>
</ul>
</li>
</ol>
<h3 id="common-deployment-scenarios"><a class="header" href="#common-deployment-scenarios">Common Deployment Scenarios</a></h3>
<pre><code class="language-mermaid">graph LR
    subgraph Scenario1["Enterprise Office"]
        S1[High Density APs] --&gt; S1A[802.11r/k/v/w&lt;br/&gt;All Enabled]
        S1A --&gt; S1B[VoIP &amp; Video&lt;br/&gt;Optimized]
    end

    subgraph Scenario2["Public Venue"]
        S2[Medium Density APs] --&gt; S2A[802.11r/k&lt;br/&gt;Minimum]
        S2A --&gt; S2B[Basic Mobility&lt;br/&gt;Support]
    end

    subgraph Scenario3["Home/Small Office"]
        S3[2-3 APs] --&gt; S3A[Legacy or&lt;br/&gt;802.11r Only]
        S3A --&gt; S3B[Simple Setup&lt;br/&gt;Acceptable]
    end

    style Scenario1 fill:#E6FFE6
    style Scenario2 fill:#FFF9E6
    style Scenario3 fill:#FFE6E6
</code></pre>
<h2 id="troubleshooting-and-monitoring"><a class="header" href="#troubleshooting-and-monitoring">Troubleshooting and Monitoring</a></h2>
<h3 id="common-roaming-issues"><a class="header" href="#common-roaming-issues">Common Roaming Issues</a></h3>
<ol>
<li>
<p><strong>Sticky Client Problem</strong>:</p>
<ul>
<li><strong>Symptom</strong>: Client stays connected to distant AP despite closer APs being available</li>
<li><strong>Cause</strong>: Client roaming algorithm too conservative, high RSSI disconnect threshold</li>
<li><strong>Solution</strong>: Use 802.11v BTM to encourage roaming, adjust AP minimum RSSI settings</li>
</ul>
</li>
<li>
<p><strong>Ping-Pong Roaming</strong>:</p>
<ul>
<li><strong>Symptom</strong>: Client rapidly switches between two APs</li>
<li><strong>Cause</strong>: APs have overlapping coverage with similar signal strength</li>
<li><strong>Solution</strong>: Adjust AP transmit power, implement roaming hysteresis, use 802.11k/v</li>
</ul>
</li>
<li>
<p><strong>Failed Fast Transitions</strong>:</p>
<ul>
<li><strong>Symptom</strong>: Roaming takes longer than expected or fails completely</li>
<li><strong>Cause</strong>: PMK not properly distributed, Mobility Domain misconfiguration</li>
<li><strong>Solution</strong>: Verify all APs share same MDID, check R0KH/R1KH communication</li>
</ul>
</li>
<li>
<p><strong>Authentication Timeouts</strong>:</p>
<ul>
<li><strong>Symptom</strong>: Client disconnects during roaming attempt</li>
<li><strong>Cause</strong>: Slow authentication server, network latency</li>
<li><strong>Solution</strong>: Enable 802.11r PMK caching, optimize RADIUS server response time</li>
</ul>
</li>
</ol>
<h3 id="monitoring-tools-and-metrics"><a class="header" href="#monitoring-tools-and-metrics">Monitoring Tools and Metrics</a></h3>
<pre><code class="language-mermaid">graph TB
    subgraph Metrics["Key Roaming Metrics"]
        M1[Roaming Latency&lt;br/&gt;Target: &lt;50ms]
        M2[Roaming Success Rate&lt;br/&gt;Target: &gt;95%]
        M3[Average RSSI&lt;br/&gt;at Roaming Decision&lt;br/&gt;Target: -70 to -75 dBm]
        M4[Failed Authentications&lt;br/&gt;Target: &lt;1%]
        M5[Client Association Time&lt;br/&gt;Target: &lt;100ms]
    end

    subgraph Tools["Monitoring Tools"]
        T1[Wireless Controller Logs]
        T2[RADIUS Server Logs]
        T3[Client-Side Tools&lt;br/&gt;iw, wpa_supplicant]
        T4[Packet Capture&lt;br/&gt;Wireshark, tcpdump]
        T5[Network Management System]
    end

    Metrics --&gt; Analysis[Roaming&lt;br/&gt;Performance Analysis]
    Tools --&gt; Analysis

    Analysis --&gt; Actions[Optimization Actions]

    style Metrics fill:#E6F3FF
    style Tools fill:#FFE6F0
    style Analysis fill:#FFF9E6
    style Actions fill:#90EE90
</code></pre>
<h3 id="debugging-commands"><a class="header" href="#debugging-commands">Debugging Commands</a></h3>
<p><strong>Linux Client (iw/wpa_supplicant)</strong>:</p>
<pre><code class="language-bash"># Check current connection and roaming capabilities
iw dev wlan0 link
iw dev wlan0 scan | grep -E "BSS|SSID|freq|signal|capability"

# Monitor roaming events in real-time
wpa_cli -i wlan0
&gt; status
&gt; bss_flush 0
&gt; scan
&gt; scan_results

# Check FT (802.11r) capabilities
iw dev wlan0 scan | grep -A 20 "your-ssid" | grep -E "FT|Mobility"

# Monitor neighbor reports (802.11k)
iw dev wlan0 station dump
</code></pre>
<p><strong>Access Point (hostapd)</strong>:</p>
<pre><code class="language-bash"># Enable debug logging for roaming events
hostapd -dd /etc/hostapd/hostapd.conf | grep -E "FT|BTM|neighbor"

# Check associated clients and their roaming status
hostapd_cli all_sta
hostapd_cli status

# Send BSS transition management request
hostapd_cli bss_tm_req &lt;client-mac&gt; neighbor=&lt;target-bssid&gt;,&lt;op-class&gt;,&lt;channel&gt;
</code></pre>
<p><strong>Wireshark Filters for Roaming Analysis</strong>:</p>
<pre><code># 802.11r Fast BSS Transition frames
wlan.fc.type_subtype == 0x000b || wlan.fc.type_subtype == 0x000c

# Authentication and Reassociation
wlan.fc.type_subtype == 0x0000 || wlan.fc.type_subtype == 0x0001 ||
wlan.fc.type_subtype == 0x0002 || wlan.fc.type_subtype == 0x0003

# 802.11k Neighbor Reports
wlan.tag.number == 52

# 802.11v BSS Transition Management
wlan.fixed.action_code == 7 || wlan.fixed.action_code == 8

# 802.11w Protected Management Frames
wlan.fc.protected == 1 &amp;&amp; (wlan.fc.type == 0)
</code></pre>
<h3 id="performance-optimization-tips"><a class="header" href="#performance-optimization-tips">Performance Optimization Tips</a></h3>
<ol>
<li>
<p><strong>Channel Planning</strong>:</p>
<ul>
<li>Use non-overlapping channels (1, 6, 11 for 2.4 GHz)</li>
<li>Minimize co-channel interference in high-density deployments</li>
<li>Consider DFS channels in 5 GHz for additional capacity</li>
</ul>
</li>
<li>
<p><strong>AP Placement and Power</strong>:</p>
<ul>
<li>Ensure 20-30% cell overlap for seamless roaming</li>
<li>Reduce AP transmit power in dense deployments to prevent sticky clients</li>
<li>Use site survey tools to validate coverage</li>
</ul>
</li>
<li>
<p><strong>RSSI Thresholds</strong>:</p>
<ul>
<li>Set roaming trigger at -70 to -75 dBm for optimal performance</li>
<li>Configure minimum RSSI for association rejection at -80 to -85 dBm</li>
<li>Implement different thresholds for 2.4 GHz vs 5 GHz</li>
</ul>
</li>
<li>
<p><strong>Fast Roaming Configuration</strong>:</p>
<ul>
<li>Enable FT over-the-DS for centralized architectures</li>
<li>Configure neighbor reports with accurate channel and BSSID information</li>
<li>Set appropriate BTM preference values to guide client decisions</li>
<li>Ensure PMK caching timeout (default 43200 seconds) is appropriate</li>
</ul>
</li>
</ol>
<h3 id="sample-wpa_supplicant-configuration"><a class="header" href="#sample-wpa_supplicant-configuration">Sample wpa_supplicant Configuration</a></h3>
<pre><code class="language-conf">network={
    ssid="YourNetwork"
    psk="YourPassword"
    key_mgmt=WPA-PSK WPA-PSK-SHA256 FT-PSK
    ieee80211w=2                    # Require PMF (802.11w)

    # Fast roaming settings
    proactive_key_caching=1         # Enable opportunistic key caching
    ft_eap_pmksa_caching=1          # Enable PMK caching for FT

    # Roaming aggressiveness (0-3, 0 = disabled, 3 = most aggressive)
    bgscan="simple:30:-70:3600"     # Background scanning

    # Scan frequency configuration
    scan_freq=2412 2437 2462 5180 5200 5220 5240 5745 5765 5785 5805
}
</code></pre>
<h3 id="sample-hostapd-configuration"><a class="header" href="#sample-hostapd-configuration">Sample hostapd Configuration</a></h3>
<pre><code class="language-conf"># Basic settings
interface=wlan0
driver=nl80211
ssid=YourNetwork
wpa=2
wpa_key_mgmt=WPA-PSK FT-PSK
wpa_pairwise=CCMP

# 802.11r Fast BSS Transition
mobility_domain=a1b2              # Same for all APs in the domain
ft_over_ds=1                       # Enable FT over Distribution System
ft_psk_generate_local=1            # Generate PMK-R0/R1 locally
nas_identifier=ap1.example.com     # Unique per AP
r0kh=02:00:00:00:03:00 ap1.example.com 000102030405060708090a0b0c0d0e0f
r1kh=02:00:00:00:03:00 00:00:00:00:03:00 000102030405060708090a0b0c0d0e0f

# 802.11k Radio Resource Management
rrm_neighbor_report=1
rrm_beacon_report=1

# 802.11v BSS Transition Management
bss_transition=1
wnm_sleep_mode=1
time_advertisement=2

# 802.11w Protected Management Frames
ieee80211w=2                       # Required (2) or Optional (1)
group_mgmt_cipher=AES-128-CMAC

# Roaming optimization
ap_max_inactivity=300
disassoc_low_ack=1
skip_inactivity_poll=0
</code></pre>
<h2 id="references-and-further-reading"><a class="header" href="#references-and-further-reading">References and Further Reading</a></h2>
<ol>
<li>
<p><strong>IEEE Standards</strong>:</p>
<ul>
<li>IEEE 802.11r-2008: Fast BSS Transition</li>
<li>IEEE 802.11k-2008: Radio Resource Measurement</li>
<li>IEEE 802.11v-2011: Wireless Network Management</li>
<li>IEEE 802.11w-2009: Protected Management Frames</li>
</ul>
</li>
<li>
<p><strong>RFCs and Documentation</strong>:</p>
<ul>
<li>RFC 5416: Control and Provisioning of Wireless Access Points (CAPWAP) Protocol</li>
<li>Wi-Fi Alliance: WPA3 Security Specification</li>
<li>hostapd documentation: https://w1.fi/hostapd/</li>
<li>wpa_supplicant documentation: https://w1.fi/wpa_supplicant/</li>
</ul>
</li>
<li>
<p><strong>Best Practices</strong>:</p>
<ul>
<li>Cisco Enterprise Mobility Design Guide</li>
<li>Aruba Best Practices for High-Density WiFi Deployments</li>
<li>Ruckus SmartRoam Technology Overview</li>
</ul>
</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="qos-management"><a class="header" href="#qos-management">QoS Management</a></h1>
<h2 id="qos-map"><a class="header" href="#qos-map">QoS Map</a></h2>
<h2 id="mscs"><a class="header" href="#mscs">MSCS</a></h2>
<h2 id="scs"><a class="header" href="#scs">SCS</a></h2>
<h2 id="dscp-policy"><a class="header" href="#dscp-policy">DSCP Policy</a></h2>
<div style="break-before: page; page-break-before: always;"></div><h1 id="machine-learning"><a class="header" href="#machine-learning">Machine Learning</a></h1>
<p>A comprehensive guide to machine learning concepts, algorithms, and implementations.</p>
<h2 id="table-of-contents-14"><a class="header" href="#table-of-contents-14">Table of Contents</a></h2>
<ol>
<li><a href="machine_learning/./supervised_learning.html">Supervised Learning</a> - Classification, regression, and supervised algorithms</li>
<li><a href="machine_learning/./unsupervised_learning.html">Unsupervised Learning</a> - Clustering and dimensionality reduction</li>
<li><a href="machine_learning/./reinforcement_learning.html">Reinforcement Learning</a> - RL concepts, Q-learning, and policy gradients</li>
<li><a href="machine_learning/./deep_learning.html">Deep Learning</a> - Neural networks, CNNs, RNNs, and training techniques</li>
<li><a href="machine_learning/./neural_networks.html">Neural Networks</a> - Architecture, backpropagation, activation functions</li>
<li><a href="machine_learning/./deep_reinforcement_learning.html">Deep Reinforcement Learning</a> - DQN, A3C, PPO, and advanced RL</li>
<li><a href="machine_learning/./generative_models.html">Generative Models</a> - GANs, VAEs, and flow-based models</li>
<li><a href="machine_learning/./deep_generative_models.html">Deep Generative Models</a> - Advanced generative architectures</li>
<li><a href="machine_learning/./transfer_learning.html">Transfer Learning</a> - Pre-training, fine-tuning, and domain adaptation</li>
<li><a href="machine_learning/./pytorch.html">PyTorch</a> - Deep learning framework, tensors, autograd, training</li>
<li><a href="machine_learning/./transformers.html">Transformers</a> - Attention mechanisms, BERT, GPT architectures</li>
<li><a href="machine_learning/./hugging_face.html">Hugging Face</a> - Transformers library, models, and datasets</li>
<li><a href="machine_learning/./interesting_papers.html">Interesting Papers</a> - Key ML papers and summaries</li>
</ol>
<h2 id="overview-45"><a class="header" href="#overview-45">Overview</a></h2>
<p>Machine Learning is a field of artificial intelligence that focuses on building systems that learn from data. The field can be broadly categorized into:</p>
<h3 id="supervised-learning"><a class="header" href="#supervised-learning">Supervised Learning</a></h3>
<p>Learning from labeled data where each example has an input-output pair. The goal is to learn a mapping from inputs to outputs.</p>
<ul>
<li><strong>Classification</strong>: Predicting discrete categories (e.g., spam/not spam)</li>
<li><strong>Regression</strong>: Predicting continuous values (e.g., house prices)</li>
</ul>
<h3 id="unsupervised-learning"><a class="header" href="#unsupervised-learning">Unsupervised Learning</a></h3>
<p>Learning patterns from unlabeled data without explicit output labels.</p>
<ul>
<li><strong>Clustering</strong>: Grouping similar data points together</li>
<li><strong>Dimensionality Reduction</strong>: Reducing the number of features while preserving information</li>
<li><strong>Anomaly Detection</strong>: Identifying outliers in data</li>
</ul>
<h3 id="reinforcement-learning"><a class="header" href="#reinforcement-learning">Reinforcement Learning</a></h3>
<p>Learning through interaction with an environment to maximize cumulative rewards.</p>
<ul>
<li><strong>Model-free RL</strong>: Learning without modeling the environment</li>
<li><strong>Model-based RL</strong>: Learning a model of the environment</li>
<li><strong>Deep RL</strong>: Combining deep learning with reinforcement learning</li>
</ul>
<h2 id="key-concepts-17"><a class="header" href="#key-concepts-17">Key Concepts</a></h2>
<h3 id="the-machine-learning-pipeline"><a class="header" href="#the-machine-learning-pipeline">The Machine Learning Pipeline</a></h3>
<pre><code class="language-python">import numpy as np
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import accuracy_score, classification_report

# 1. Load and prepare data
X, y = load_data()  # Features and labels

# 2. Split data
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42
)

# 3. Preprocess data
scaler = StandardScaler()
X_train_scaled = scaler.fit_transform(X_train)
X_test_scaled = scaler.transform(X_test)

# 4. Train model
model = LogisticRegression()
model.fit(X_train_scaled, y_train)

# 5. Evaluate
y_pred = model.predict(X_test_scaled)
print(f"Accuracy: {accuracy_score(y_test, y_pred):.4f}")
print(classification_report(y_test, y_pred))
</code></pre>
<h3 id="bias-variance-tradeoff"><a class="header" href="#bias-variance-tradeoff">Bias-Variance Tradeoff</a></h3>
<p>The bias-variance tradeoff is a fundamental concept in machine learning:</p>
<ul>
<li><strong>Bias</strong>: Error from overly simplistic assumptions (underfitting)</li>
<li><strong>Variance</strong>: Error from sensitivity to small fluctuations in training data (overfitting)</li>
<li><strong>Total Error</strong> = Bias² + Variance + Irreducible Error</li>
</ul>
<pre><code class="language-python">import matplotlib.pyplot as plt
from sklearn.model_selection import learning_curve

def plot_learning_curve(estimator, X, y):
    train_sizes, train_scores, val_scores = learning_curve(
        estimator, X, y, cv=5, n_jobs=-1,
        train_sizes=np.linspace(0.1, 1.0, 10)
    )
    
    train_mean = np.mean(train_scores, axis=1)
    train_std = np.std(train_scores, axis=1)
    val_mean = np.mean(val_scores, axis=1)
    val_std = np.std(val_scores, axis=1)
    
    plt.figure(figsize=(10, 6))
    plt.plot(train_sizes, train_mean, label='Training score')
    plt.plot(train_sizes, val_mean, label='Validation score')
    plt.fill_between(train_sizes, train_mean - train_std, 
                     train_mean + train_std, alpha=0.1)
    plt.fill_between(train_sizes, val_mean - val_std, 
                     val_mean + val_std, alpha=0.1)
    plt.xlabel('Training Set Size')
    plt.ylabel('Score')
    plt.legend()
    plt.title('Learning Curve')
    plt.show()
</code></pre>
<h3 id="cross-validation"><a class="header" href="#cross-validation">Cross-Validation</a></h3>
<p>Cross-validation helps assess model performance and reduce overfitting:</p>
<pre><code class="language-python">from sklearn.model_selection import cross_val_score, KFold

# K-Fold Cross-Validation
kfold = KFold(n_splits=5, shuffle=True, random_state=42)
scores = cross_val_score(model, X, y, cv=kfold, scoring='accuracy')
print(f"Cross-validation scores: {scores}")
print(f"Mean accuracy: {scores.mean():.4f} (+/- {scores.std() * 2:.4f})")

# Stratified K-Fold (maintains class distribution)
from sklearn.model_selection import StratifiedKFold
skfold = StratifiedKFold(n_splits=5, shuffle=True, random_state=42)
scores = cross_val_score(model, X, y, cv=skfold, scoring='accuracy')
</code></pre>
<h3 id="regularization"><a class="header" href="#regularization">Regularization</a></h3>
<p>Regularization techniques help prevent overfitting:</p>
<p><strong>L1 Regularization (Lasso)</strong>: Encourages sparsity</p>
<pre><code>Loss = MSE + λ * Σ|w_i|
</code></pre>
<p><strong>L2 Regularization (Ridge)</strong>: Penalizes large weights</p>
<pre><code>Loss = MSE + λ * Σw_i²
</code></pre>
<p><strong>Elastic Net</strong>: Combines L1 and L2</p>
<pre><code>Loss = MSE + λ₁ * Σ|w_i| + λ₂ * Σw_i²
</code></pre>
<pre><code class="language-python">from sklearn.linear_model import Lasso, Ridge, ElasticNet

# L1 Regularization
lasso = Lasso(alpha=0.1)
lasso.fit(X_train, y_train)

# L2 Regularization
ridge = Ridge(alpha=1.0)
ridge.fit(X_train, y_train)

# Elastic Net
elastic = ElasticNet(alpha=0.1, l1_ratio=0.5)
elastic.fit(X_train, y_train)
</code></pre>
<h3 id="feature-engineering"><a class="header" href="#feature-engineering">Feature Engineering</a></h3>
<p>Feature engineering is crucial for model performance:</p>
<pre><code class="language-python">import pandas as pd
from sklearn.preprocessing import PolynomialFeatures, OneHotEncoder

# Polynomial features
poly = PolynomialFeatures(degree=2, include_bias=False)
X_poly = poly.fit_transform(X)

# One-hot encoding for categorical variables
encoder = OneHotEncoder(sparse=False, drop='first')
X_encoded = encoder.fit_transform(df[['category1', 'category2']])

# Feature scaling
from sklearn.preprocessing import MinMaxScaler, RobustScaler

# Min-Max scaling (0 to 1)
minmax_scaler = MinMaxScaler()
X_minmax = minmax_scaler.fit_transform(X)

# Robust scaling (uses median and IQR)
robust_scaler = RobustScaler()
X_robust = robust_scaler.fit_transform(X)
</code></pre>
<h3 id="hyperparameter-tuning"><a class="header" href="#hyperparameter-tuning">Hyperparameter Tuning</a></h3>
<pre><code class="language-python">from sklearn.model_selection import GridSearchCV, RandomizedSearchCV
from sklearn.ensemble import RandomForestClassifier

# Grid Search
param_grid = {
    'n_estimators': [100, 200, 300],
    'max_depth': [10, 20, 30, None],
    'min_samples_split': [2, 5, 10],
    'min_samples_leaf': [1, 2, 4]
}

grid_search = GridSearchCV(
    RandomForestClassifier(),
    param_grid,
    cv=5,
    scoring='accuracy',
    n_jobs=-1
)
grid_search.fit(X_train, y_train)
print(f"Best parameters: {grid_search.best_params_}")

# Randomized Search (faster for large parameter spaces)
from scipy.stats import randint, uniform

param_distributions = {
    'n_estimators': randint(100, 500),
    'max_depth': randint(10, 50),
    'min_samples_split': randint(2, 20),
    'min_samples_leaf': randint(1, 10)
}

random_search = RandomizedSearchCV(
    RandomForestClassifier(),
    param_distributions,
    n_iter=100,
    cv=5,
    random_state=42,
    n_jobs=-1
)
random_search.fit(X_train, y_train)
</code></pre>
<h2 id="evaluation-metrics"><a class="header" href="#evaluation-metrics">Evaluation Metrics</a></h2>
<h3 id="classification-metrics"><a class="header" href="#classification-metrics">Classification Metrics</a></h3>
<pre><code class="language-python">from sklearn.metrics import (
    accuracy_score, precision_score, recall_score, f1_score,
    confusion_matrix, roc_auc_score, roc_curve
)

# Basic metrics
accuracy = accuracy_score(y_test, y_pred)
precision = precision_score(y_test, y_pred, average='weighted')
recall = recall_score(y_test, y_pred, average='weighted')
f1 = f1_score(y_test, y_pred, average='weighted')

# Confusion matrix
cm = confusion_matrix(y_test, y_pred)
print(cm)

# ROC-AUC
y_proba = model.predict_proba(X_test)[:, 1]
auc = roc_auc_score(y_test, y_proba)
fpr, tpr, thresholds = roc_curve(y_test, y_proba)

# Plot ROC curve
plt.figure(figsize=(8, 6))
plt.plot(fpr, tpr, label=f'ROC curve (AUC = {auc:.2f})')
plt.plot([0, 1], [0, 1], 'k--', label='Random classifier')
plt.xlabel('False Positive Rate')
plt.ylabel('True Positive Rate')
plt.title('ROC Curve')
plt.legend()
plt.show()
</code></pre>
<h3 id="regression-metrics"><a class="header" href="#regression-metrics">Regression Metrics</a></h3>
<pre><code class="language-python">from sklearn.metrics import mean_squared_error, mean_absolute_error, r2_score

# Mean Squared Error
mse = mean_squared_error(y_test, y_pred)
rmse = np.sqrt(mse)

# Mean Absolute Error
mae = mean_absolute_error(y_test, y_pred)

# R² Score
r2 = r2_score(y_test, y_pred)

print(f"RMSE: {rmse:.4f}")
print(f"MAE: {mae:.4f}")
print(f"R² Score: {r2:.4f}")
</code></pre>
<h2 id="common-pitfalls-and-best-practices"><a class="header" href="#common-pitfalls-and-best-practices">Common Pitfalls and Best Practices</a></h2>
<h3 id="1-data-leakage"><a class="header" href="#1-data-leakage">1. Data Leakage</a></h3>
<p>Ensure test data doesn't leak into training:</p>
<pre><code class="language-python"># WRONG: Scaling before splitting
X_scaled = scaler.fit_transform(X)
X_train, X_test = train_test_split(X_scaled)

# CORRECT: Fit scaler only on training data
X_train, X_test = train_test_split(X)
X_train_scaled = scaler.fit_transform(X_train)
X_test_scaled = scaler.transform(X_test)
</code></pre>
<h3 id="2-class-imbalance"><a class="header" href="#2-class-imbalance">2. Class Imbalance</a></h3>
<p>Handle imbalanced datasets:</p>
<pre><code class="language-python">from imblearn.over_sampling import SMOTE
from imblearn.under_sampling import RandomUnderSampler

# SMOTE (Synthetic Minority Over-sampling)
smote = SMOTE(random_state=42)
X_resampled, y_resampled = smote.fit_resample(X_train, y_train)

# Class weights
model = LogisticRegression(class_weight='balanced')
</code></pre>
<h3 id="3-feature-selection"><a class="header" href="#3-feature-selection">3. Feature Selection</a></h3>
<p>Remove irrelevant features:</p>
<pre><code class="language-python">from sklearn.feature_selection import (
    SelectKBest, f_classif, RFE, SelectFromModel
)

# Univariate feature selection
selector = SelectKBest(f_classif, k=10)
X_selected = selector.fit_transform(X_train, y_train)

# Recursive Feature Elimination
rfe = RFE(estimator=LogisticRegression(), n_features_to_select=10)
X_rfe = rfe.fit_transform(X_train, y_train)

# Model-based selection
sfm = SelectFromModel(RandomForestClassifier(), threshold='median')
X_sfm = sfm.fit_transform(X_train, y_train)
</code></pre>
<h2 id="resources-10"><a class="header" href="#resources-10">Resources</a></h2>
<ul>
<li>
<p><strong>Books</strong>:</p>
<ul>
<li>"Pattern Recognition and Machine Learning" by Christopher Bishop</li>
<li>"The Elements of Statistical Learning" by Hastie, Tibshirani, and Friedman</li>
<li>"Deep Learning" by Goodfellow, Bengio, and Courville</li>
</ul>
</li>
<li>
<p><strong>Courses</strong>:</p>
<ul>
<li>Andrew Ng's Machine Learning Course (Coursera)</li>
<li>Fast.ai Practical Deep Learning</li>
<li>Stanford CS229: Machine Learning</li>
</ul>
</li>
<li>
<p><strong>Libraries</strong>:</p>
<ul>
<li>scikit-learn: Traditional ML algorithms</li>
<li>PyTorch: Deep learning framework</li>
<li>TensorFlow/Keras: Deep learning framework</li>
<li>XGBoost/LightGBM: Gradient boosting</li>
<li>Hugging Face: Transformers and NLP</li>
</ul>
</li>
</ul>
<h2 id="quick-reference-6"><a class="header" href="#quick-reference-6">Quick Reference</a></h2>
<h3 id="model-selection-guide"><a class="header" href="#model-selection-guide">Model Selection Guide</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Problem Type</th><th>Recommended Models</th></tr></thead><tbody>
<tr><td>Linear separable data</td><td>Logistic Regression, SVM (linear)</td></tr>
<tr><td>Non-linear data</td><td>Random Forest, XGBoost, Neural Networks</td></tr>
<tr><td>High-dimensional data</td><td>Ridge/Lasso Regression, SVM</td></tr>
<tr><td>Small dataset</td><td>SVM, Naive Bayes, Linear Models</td></tr>
<tr><td>Large dataset</td><td>SGD-based models, Deep Learning</td></tr>
<tr><td>Interpretability needed</td><td>Linear Models, Decision Trees</td></tr>
<tr><td>Image data</td><td>CNNs, Vision Transformers</td></tr>
<tr><td>Text data</td><td>Transformers, RNNs, TF-IDF + Classical ML</td></tr>
<tr><td>Time series</td><td>RNNs, LSTMs, Transformers, ARIMA</td></tr>
<tr><td>Tabular data</td><td>XGBoost, LightGBM, Random Forest</td></tr>
</tbody></table>
</div>
<h3 id="performance-optimization-1"><a class="header" href="#performance-optimization-1">Performance Optimization</a></h3>
<pre><code class="language-python"># Use efficient data structures
import pandas as pd
df = pd.read_csv('data.csv', dtype={'col1': 'category'})

# Parallel processing
from joblib import Parallel, delayed
results = Parallel(n_jobs=-1)(delayed(process)(x) for x in data)

# Batch processing for large datasets
def batch_process(data, batch_size=1000):
    for i in range(0, len(data), batch_size):
        batch = data[i:i+batch_size]
        yield process_batch(batch)

# Use generators for memory efficiency
def data_generator(file_path):
    for chunk in pd.read_csv(file_path, chunksize=1000):
        yield chunk
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="deep-learning"><a class="header" href="#deep-learning">Deep Learning</a></h1>
<p>Deep learning uses artificial neural networks with multiple layers to learn hierarchical representations of data.</p>
<h2 id="table-of-contents-15"><a class="header" href="#table-of-contents-15">Table of Contents</a></h2>
<ol>
<li><a href="machine_learning/deep_learning.html#neural-networks-fundamentals">Neural Networks Fundamentals</a></li>
<li><a href="machine_learning/deep_learning.html#activation-functions">Activation Functions</a></li>
<li><a href="machine_learning/deep_learning.html#loss-functions">Loss Functions</a></li>
<li><a href="machine_learning/deep_learning.html#optimization">Optimization</a></li>
<li><a href="machine_learning/deep_learning.html#regularization">Regularization</a></li>
<li><a href="machine_learning/deep_learning.html#convolutional-neural-networks">Convolutional Neural Networks (CNNs)</a></li>
<li><a href="machine_learning/deep_learning.html#recurrent-neural-networks">Recurrent Neural Networks (RNNs)</a></li>
<li><a href="machine_learning/deep_learning.html#attention-mechanisms">Attention Mechanisms</a></li>
<li><a href="machine_learning/deep_learning.html#batch-normalization">Batch Normalization</a></li>
<li><a href="machine_learning/deep_learning.html#advanced-architectures">Advanced Architectures</a></li>
</ol>
<h2 id="neural-networks-fundamentals"><a class="header" href="#neural-networks-fundamentals">Neural Networks Fundamentals</a></h2>
<h3 id="perceptron"><a class="header" href="#perceptron">Perceptron</a></h3>
<p>The basic building block of neural networks.</p>
<p><strong>Mathematical Formulation:</strong></p>
<pre><code>y = f(Σ(w_i * x_i) + b)
</code></pre>
<p>Where:</p>
<ul>
<li>x_i: inputs</li>
<li>w_i: weights</li>
<li>b: bias</li>
<li>f: activation function</li>
</ul>
<pre><code class="language-python">import torch
import torch.nn as nn
import torch.optim as optim
import numpy as np

# Simple perceptron
class Perceptron(nn.Module):
    def __init__(self, input_dim):
        super(Perceptron, self).__init__()
        self.linear = nn.Linear(input_dim, 1)
        self.sigmoid = nn.Sigmoid()
    
    def forward(self, x):
        return self.sigmoid(self.linear(x))

# Example usage
input_dim = 4
model = Perceptron(input_dim)
x = torch.randn(32, input_dim)
output = model(x)
print(f"Output shape: {output.shape}")
</code></pre>
<h3 id="multi-layer-perceptron-mlp"><a class="header" href="#multi-layer-perceptron-mlp">Multi-Layer Perceptron (MLP)</a></h3>
<pre><code class="language-python">class MLP(nn.Module):
    def __init__(self, input_dim, hidden_dims, output_dim):
        super(MLP, self).__init__()
        
        layers = []
        prev_dim = input_dim
        
        # Hidden layers
        for hidden_dim in hidden_dims:
            layers.append(nn.Linear(prev_dim, hidden_dim))
            layers.append(nn.ReLU())
            prev_dim = hidden_dim
        
        # Output layer
        layers.append(nn.Linear(prev_dim, output_dim))
        
        self.network = nn.Sequential(*layers)
    
    def forward(self, x):
        return self.network(x)

# Example: 3-layer MLP
model = MLP(input_dim=10, hidden_dims=[64, 32], output_dim=2)
x = torch.randn(16, 10)
output = model(x)
print(f"Output shape: {output.shape}")
</code></pre>
<h3 id="backpropagation"><a class="header" href="#backpropagation">Backpropagation</a></h3>
<p><strong>Forward Pass:</strong></p>
<pre><code>z^[l] = W^[l] · a^[l-1] + b^[l]
a^[l] = g^[l](z^[l])
</code></pre>
<p><strong>Backward Pass (Chain Rule):</strong></p>
<pre><code>dL/dW^[l] = dL/da^[l] · da^[l]/dz^[l] · dz^[l]/dW^[l]
</code></pre>
<pre><code class="language-python"># Manual backpropagation example
class SimpleNN:
    def __init__(self, input_size, hidden_size, output_size):
        self.W1 = np.random.randn(input_size, hidden_size) * 0.01
        self.b1 = np.zeros((1, hidden_size))
        self.W2 = np.random.randn(hidden_size, output_size) * 0.01
        self.b2 = np.zeros((1, output_size))
    
    def sigmoid(self, z):
        return 1 / (1 + np.exp(-z))
    
    def sigmoid_derivative(self, a):
        return a * (1 - a)
    
    def forward(self, X):
        self.z1 = np.dot(X, self.W1) + self.b1
        self.a1 = self.sigmoid(self.z1)
        self.z2 = np.dot(self.a1, self.W2) + self.b2
        self.a2 = self.sigmoid(self.z2)
        return self.a2
    
    def backward(self, X, y, learning_rate=0.01):
        m = X.shape[0]
        
        # Output layer gradients
        dz2 = self.a2 - y
        dW2 = (1/m) * np.dot(self.a1.T, dz2)
        db2 = (1/m) * np.sum(dz2, axis=0, keepdims=True)
        
        # Hidden layer gradients
        dz1 = np.dot(dz2, self.W2.T) * self.sigmoid_derivative(self.a1)
        dW1 = (1/m) * np.dot(X.T, dz1)
        db1 = (1/m) * np.sum(dz1, axis=0, keepdims=True)
        
        # Update weights
        self.W2 -= learning_rate * dW2
        self.b2 -= learning_rate * db2
        self.W1 -= learning_rate * dW1
        self.b1 -= learning_rate * db1
</code></pre>
<h2 id="activation-functions"><a class="header" href="#activation-functions">Activation Functions</a></h2>
<h3 id="common-activation-functions"><a class="header" href="#common-activation-functions">Common Activation Functions</a></h3>
<pre><code class="language-python">import torch.nn.functional as F

# ReLU (Rectified Linear Unit)
def relu(x):
    return torch.max(torch.zeros_like(x), x)

# Leaky ReLU
def leaky_relu(x, alpha=0.01):
    return torch.where(x &gt; 0, x, alpha * x)

# Sigmoid
def sigmoid(x):
    return 1 / (1 + torch.exp(-x))

# Tanh
def tanh(x):
    return torch.tanh(x)

# Softmax (for multi-class classification)
def softmax(x, dim=-1):
    exp_x = torch.exp(x - torch.max(x, dim=dim, keepdim=True)[0])
    return exp_x / torch.sum(exp_x, dim=dim, keepdim=True)

# GELU (Gaussian Error Linear Unit)
def gelu(x):
    return 0.5 * x * (1 + torch.tanh(np.sqrt(2/np.pi) * (x + 0.044715 * x**3)))

# Swish/SiLU
def swish(x):
    return x * torch.sigmoid(x)

# Visualization
x = torch.linspace(-5, 5, 100)
activations = {
    'ReLU': F.relu(x),
    'Leaky ReLU': F.leaky_relu(x, 0.1),
    'Sigmoid': torch.sigmoid(x),
    'Tanh': torch.tanh(x),
    'GELU': F.gelu(x),
    'Swish': x * torch.sigmoid(x)
}

import matplotlib.pyplot as plt
fig, axes = plt.subplots(2, 3, figsize=(15, 10))
for ax, (name, y) in zip(axes.flatten(), activations.items()):
    ax.plot(x.numpy(), y.numpy())
    ax.set_title(name)
    ax.grid(True)
    ax.axhline(y=0, color='k', linestyle='--', alpha=0.3)
    ax.axvline(x=0, color='k', linestyle='--', alpha=0.3)
plt.tight_layout()
plt.show()
</code></pre>
<h2 id="loss-functions"><a class="header" href="#loss-functions">Loss Functions</a></h2>
<h3 id="classification-losses"><a class="header" href="#classification-losses">Classification Losses</a></h3>
<pre><code class="language-python"># Binary Cross-Entropy
def binary_cross_entropy(predictions, targets):
    return -torch.mean(targets * torch.log(predictions + 1e-8) + 
                      (1 - targets) * torch.log(1 - predictions + 1e-8))

# Categorical Cross-Entropy
def categorical_cross_entropy(predictions, targets):
    return -torch.mean(torch.sum(targets * torch.log(predictions + 1e-8), dim=1))

# Focal Loss (for imbalanced datasets)
class FocalLoss(nn.Module):
    def __init__(self, alpha=1, gamma=2):
        super(FocalLoss, self).__init__()
        self.alpha = alpha
        self.gamma = gamma
    
    def forward(self, inputs, targets):
        ce_loss = F.cross_entropy(inputs, targets, reduction='none')
        pt = torch.exp(-ce_loss)
        focal_loss = self.alpha * (1 - pt) ** self.gamma * ce_loss
        return focal_loss.mean()

# Using PyTorch built-in losses
criterion_bce = nn.BCELoss()
criterion_ce = nn.CrossEntropyLoss()
criterion_nll = nn.NLLLoss()

# Example
predictions = torch.rand(32, 10)
targets = torch.randint(0, 10, (32,))
loss = criterion_ce(predictions, targets)
</code></pre>
<h3 id="regression-losses"><a class="header" href="#regression-losses">Regression Losses</a></h3>
<pre><code class="language-python"># Mean Squared Error (MSE)
criterion_mse = nn.MSELoss()

# Mean Absolute Error (MAE)
criterion_mae = nn.L1Loss()

# Smooth L1 Loss (Huber Loss)
criterion_smooth = nn.SmoothL1Loss()

# Custom loss example
class CustomRegressionLoss(nn.Module):
    def __init__(self):
        super(CustomRegressionLoss, self).__init__()
    
    def forward(self, predictions, targets):
        mse = torch.mean((predictions - targets) ** 2)
        mae = torch.mean(torch.abs(predictions - targets))
        return mse + 0.1 * mae
</code></pre>
<h2 id="optimization-1"><a class="header" href="#optimization-1">Optimization</a></h2>
<h3 id="optimizers"><a class="header" href="#optimizers">Optimizers</a></h3>
<pre><code class="language-python"># Stochastic Gradient Descent (SGD)
optimizer_sgd = optim.SGD(model.parameters(), lr=0.01, momentum=0.9)

# Adam (Adaptive Moment Estimation)
optimizer_adam = optim.Adam(model.parameters(), lr=0.001, betas=(0.9, 0.999))

# AdamW (Adam with weight decay)
optimizer_adamw = optim.AdamW(model.parameters(), lr=0.001, weight_decay=0.01)

# RMSprop
optimizer_rmsprop = optim.RMSprop(model.parameters(), lr=0.001, alpha=0.99)

# Adagrad
optimizer_adagrad = optim.Adagrad(model.parameters(), lr=0.01)

# Training loop
def train_epoch(model, dataloader, criterion, optimizer, device):
    model.train()
    total_loss = 0
    
    for batch_idx, (data, target) in enumerate(dataloader):
        data, target = data.to(device), target.to(device)
        
        # Forward pass
        optimizer.zero_grad()
        output = model(data)
        loss = criterion(output, target)
        
        # Backward pass
        loss.backward()
        
        # Gradient clipping (optional)
        torch.nn.utils.clip_grad_norm_(model.parameters(), max_norm=1.0)
        
        # Update weights
        optimizer.step()
        
        total_loss += loss.item()
    
    return total_loss / len(dataloader)
</code></pre>
<h3 id="learning-rate-scheduling"><a class="header" href="#learning-rate-scheduling">Learning Rate Scheduling</a></h3>
<pre><code class="language-python">from torch.optim.lr_scheduler import (
    StepLR, ExponentialLR, CosineAnnealingLR, 
    ReduceLROnPlateau, OneCycleLR
)

# Step decay
scheduler_step = StepLR(optimizer, step_size=10, gamma=0.1)

# Exponential decay
scheduler_exp = ExponentialLR(optimizer, gamma=0.95)

# Cosine annealing
scheduler_cosine = CosineAnnealingLR(optimizer, T_max=100, eta_min=1e-6)

# Reduce on plateau
scheduler_plateau = ReduceLROnPlateau(
    optimizer, mode='min', factor=0.1, patience=10, verbose=True
)

# One Cycle Policy
scheduler_onecycle = OneCycleLR(
    optimizer, max_lr=0.01, epochs=100, steps_per_epoch=len(train_loader)
)

# Usage in training loop
for epoch in range(num_epochs):
    train_loss = train_epoch(model, train_loader, criterion, optimizer, device)
    val_loss = validate(model, val_loader, criterion, device)
    
    # Step the scheduler
    scheduler_plateau.step(val_loss)  # For ReduceLROnPlateau
    # OR
    scheduler_step.step()  # For other schedulers
    
    print(f"Epoch {epoch}: LR = {optimizer.param_groups[0]['lr']:.6f}")
</code></pre>
<h2 id="regularization-1"><a class="header" href="#regularization-1">Regularization</a></h2>
<h3 id="dropout"><a class="header" href="#dropout">Dropout</a></h3>
<pre><code class="language-python">class MLPWithDropout(nn.Module):
    def __init__(self, input_dim, hidden_dims, output_dim, dropout_rate=0.5):
        super(MLPWithDropout, self).__init__()
        
        layers = []
        prev_dim = input_dim
        
        for hidden_dim in hidden_dims:
            layers.append(nn.Linear(prev_dim, hidden_dim))
            layers.append(nn.ReLU())
            layers.append(nn.Dropout(dropout_rate))
            prev_dim = hidden_dim
        
        layers.append(nn.Linear(prev_dim, output_dim))
        self.network = nn.Sequential(*layers)
    
    def forward(self, x):
        return self.network(x)

# Dropout variants
dropout = nn.Dropout(p=0.5)  # Standard dropout
dropout_2d = nn.Dropout2d(p=0.5)  # For Conv2d
dropout_3d = nn.Dropout3d(p=0.5)  # For Conv3d
alpha_dropout = nn.AlphaDropout(p=0.5)  # For SELU activation
</code></pre>
<h3 id="weight-decay-l2-regularization"><a class="header" href="#weight-decay-l2-regularization">Weight Decay (L2 Regularization)</a></h3>
<pre><code class="language-python"># Weight decay in optimizer
optimizer = optim.Adam(model.parameters(), lr=0.001, weight_decay=0.01)

# Manual L2 regularization
def l2_regularization(model, lambda_l2=0.01):
    l2_loss = 0
    for param in model.parameters():
        l2_loss += torch.norm(param, 2)
    return lambda_l2 * l2_loss

# In training loop
loss = criterion(output, target) + l2_regularization(model)
</code></pre>
<h3 id="early-stopping"><a class="header" href="#early-stopping">Early Stopping</a></h3>
<pre><code class="language-python">class EarlyStopping:
    def __init__(self, patience=10, min_delta=0, mode='min'):
        self.patience = patience
        self.min_delta = min_delta
        self.mode = mode
        self.counter = 0
        self.best_score = None
        self.early_stop = False
    
    def __call__(self, val_loss):
        score = -val_loss if self.mode == 'min' else val_loss
        
        if self.best_score is None:
            self.best_score = score
        elif score &lt; self.best_score + self.min_delta:
            self.counter += 1
            if self.counter &gt;= self.patience:
                self.early_stop = True
        else:
            self.best_score = score
            self.counter = 0
        
        return self.early_stop

# Usage
early_stopping = EarlyStopping(patience=10)

for epoch in range(num_epochs):
    train_loss = train_epoch(model, train_loader, criterion, optimizer, device)
    val_loss = validate(model, val_loader, criterion, device)
    
    if early_stopping(val_loss):
        print(f"Early stopping at epoch {epoch}")
        break
</code></pre>
<h2 id="convolutional-neural-networks"><a class="header" href="#convolutional-neural-networks">Convolutional Neural Networks</a></h2>
<p>CNNs are specialized for processing grid-like data (images, videos).</p>
<h3 id="basic-cnn-architecture"><a class="header" href="#basic-cnn-architecture">Basic CNN Architecture</a></h3>
<pre><code class="language-python">class SimpleCNN(nn.Module):
    def __init__(self, num_classes=10):
        super(SimpleCNN, self).__init__()
        
        # Convolutional layers
        self.conv1 = nn.Conv2d(3, 32, kernel_size=3, padding=1)
        self.conv2 = nn.Conv2d(32, 64, kernel_size=3, padding=1)
        self.conv3 = nn.Conv2d(64, 128, kernel_size=3, padding=1)
        
        # Pooling
        self.pool = nn.MaxPool2d(2, 2)
        
        # Fully connected layers
        self.fc1 = nn.Linear(128 * 4 * 4, 512)
        self.fc2 = nn.Linear(512, num_classes)
        
        # Dropout
        self.dropout = nn.Dropout(0.5)
    
    def forward(self, x):
        # Conv block 1
        x = self.pool(F.relu(self.conv1(x)))  # 32x32 -&gt; 16x16
        
        # Conv block 2
        x = self.pool(F.relu(self.conv2(x)))  # 16x16 -&gt; 8x8
        
        # Conv block 3
        x = self.pool(F.relu(self.conv3(x)))  # 8x8 -&gt; 4x4
        
        # Flatten
        x = x.view(x.size(0), -1)
        
        # Fully connected
        x = F.relu(self.fc1(x))
        x = self.dropout(x)
        x = self.fc2(x)
        
        return x

# Example usage
model = SimpleCNN(num_classes=10)
x = torch.randn(4, 3, 32, 32)  # Batch of 4 RGB 32x32 images
output = model(x)
print(f"Output shape: {output.shape}")  # [4, 10]
</code></pre>
<h3 id="modern-cnn-architectures"><a class="header" href="#modern-cnn-architectures">Modern CNN Architectures</a></h3>
<h4 id="resnet-residual-networks"><a class="header" href="#resnet-residual-networks">ResNet (Residual Networks)</a></h4>
<pre><code class="language-python">class ResidualBlock(nn.Module):
    def __init__(self, in_channels, out_channels, stride=1):
        super(ResidualBlock, self).__init__()
        
        self.conv1 = nn.Conv2d(in_channels, out_channels, 3, stride, padding=1, bias=False)
        self.bn1 = nn.BatchNorm2d(out_channels)
        self.conv2 = nn.Conv2d(out_channels, out_channels, 3, 1, padding=1, bias=False)
        self.bn2 = nn.BatchNorm2d(out_channels)
        
        self.shortcut = nn.Sequential()
        if stride != 1 or in_channels != out_channels:
            self.shortcut = nn.Sequential(
                nn.Conv2d(in_channels, out_channels, 1, stride, bias=False),
                nn.BatchNorm2d(out_channels)
            )
    
    def forward(self, x):
        residual = x
        
        out = F.relu(self.bn1(self.conv1(x)))
        out = self.bn2(self.conv2(out))
        out += self.shortcut(residual)
        out = F.relu(out)
        
        return out

class ResNet(nn.Module):
    def __init__(self, num_blocks, num_classes=10):
        super(ResNet, self).__init__()
        
        self.conv1 = nn.Conv2d(3, 64, 3, 1, padding=1, bias=False)
        self.bn1 = nn.BatchNorm2d(64)
        
        self.layer1 = self._make_layer(64, 64, num_blocks[0], stride=1)
        self.layer2 = self._make_layer(64, 128, num_blocks[1], stride=2)
        self.layer3 = self._make_layer(128, 256, num_blocks[2], stride=2)
        self.layer4 = self._make_layer(256, 512, num_blocks[3], stride=2)
        
        self.avgpool = nn.AdaptiveAvgPool2d((1, 1))
        self.fc = nn.Linear(512, num_classes)
    
    def _make_layer(self, in_channels, out_channels, num_blocks, stride):
        layers = []
        layers.append(ResidualBlock(in_channels, out_channels, stride))
        for _ in range(1, num_blocks):
            layers.append(ResidualBlock(out_channels, out_channels))
        return nn.Sequential(*layers)
    
    def forward(self, x):
        x = F.relu(self.bn1(self.conv1(x)))
        x = self.layer1(x)
        x = self.layer2(x)
        x = self.layer3(x)
        x = self.layer4(x)
        x = self.avgpool(x)
        x = x.view(x.size(0), -1)
        x = self.fc(x)
        return x

# ResNet-18
model = ResNet([2, 2, 2, 2])
</code></pre>
<h4 id="inception-module"><a class="header" href="#inception-module">Inception Module</a></h4>
<pre><code class="language-python">class InceptionModule(nn.Module):
    def __init__(self, in_channels, out_1x1, red_3x3, out_3x3, red_5x5, out_5x5, out_pool):
        super(InceptionModule, self).__init__()
        
        # 1x1 conv branch
        self.branch1 = nn.Sequential(
            nn.Conv2d(in_channels, out_1x1, kernel_size=1),
            nn.ReLU()
        )
        
        # 3x3 conv branch
        self.branch2 = nn.Sequential(
            nn.Conv2d(in_channels, red_3x3, kernel_size=1),
            nn.ReLU(),
            nn.Conv2d(red_3x3, out_3x3, kernel_size=3, padding=1),
            nn.ReLU()
        )
        
        # 5x5 conv branch
        self.branch3 = nn.Sequential(
            nn.Conv2d(in_channels, red_5x5, kernel_size=1),
            nn.ReLU(),
            nn.Conv2d(red_5x5, out_5x5, kernel_size=5, padding=2),
            nn.ReLU()
        )
        
        # Max pooling branch
        self.branch4 = nn.Sequential(
            nn.MaxPool2d(kernel_size=3, stride=1, padding=1),
            nn.Conv2d(in_channels, out_pool, kernel_size=1),
            nn.ReLU()
        )
    
    def forward(self, x):
        branch1 = self.branch1(x)
        branch2 = self.branch2(x)
        branch3 = self.branch3(x)
        branch4 = self.branch4(x)
        
        return torch.cat([branch1, branch2, branch3, branch4], dim=1)
</code></pre>
<h3 id="advanced-cnn-techniques"><a class="header" href="#advanced-cnn-techniques">Advanced CNN Techniques</a></h3>
<pre><code class="language-python"># Depthwise Separable Convolution
class DepthwiseSeparableConv(nn.Module):
    def __init__(self, in_channels, out_channels, kernel_size=3):
        super(DepthwiseSeparableConv, self).__init__()
        
        # Depthwise convolution
        self.depthwise = nn.Conv2d(
            in_channels, in_channels, kernel_size, 
            padding=kernel_size//2, groups=in_channels
        )
        
        # Pointwise convolution
        self.pointwise = nn.Conv2d(in_channels, out_channels, 1)
    
    def forward(self, x):
        x = self.depthwise(x)
        x = self.pointwise(x)
        return x

# Squeeze-and-Excitation Block
class SEBlock(nn.Module):
    def __init__(self, channels, reduction=16):
        super(SEBlock, self).__init__()
        self.squeeze = nn.AdaptiveAvgPool2d(1)
        self.excitation = nn.Sequential(
            nn.Linear(channels, channels // reduction, bias=False),
            nn.ReLU(),
            nn.Linear(channels // reduction, channels, bias=False),
            nn.Sigmoid()
        )
    
    def forward(self, x):
        b, c, _, _ = x.size()
        y = self.squeeze(x).view(b, c)
        y = self.excitation(y).view(b, c, 1, 1)
        return x * y.expand_as(x)
</code></pre>
<h2 id="recurrent-neural-networks"><a class="header" href="#recurrent-neural-networks">Recurrent Neural Networks</a></h2>
<p>RNNs process sequential data by maintaining hidden state.</p>
<h3 id="basic-rnn"><a class="header" href="#basic-rnn">Basic RNN</a></h3>
<pre><code class="language-python">class SimpleRNN(nn.Module):
    def __init__(self, input_size, hidden_size, output_size, num_layers=1):
        super(SimpleRNN, self).__init__()
        self.hidden_size = hidden_size
        self.num_layers = num_layers
        
        self.rnn = nn.RNN(input_size, hidden_size, num_layers, batch_first=True)
        self.fc = nn.Linear(hidden_size, output_size)
    
    def forward(self, x):
        # x shape: (batch, seq_len, input_size)
        h0 = torch.zeros(self.num_layers, x.size(0), self.hidden_size).to(x.device)
        
        # RNN output
        out, hn = self.rnn(x, h0)
        # out shape: (batch, seq_len, hidden_size)
        
        # Use last time step
        out = self.fc(out[:, -1, :])
        return out

# Example
model = SimpleRNN(input_size=10, hidden_size=64, output_size=2)
x = torch.randn(32, 20, 10)  # (batch, seq_len, features)
output = model(x)
print(f"Output shape: {output.shape}")  # [32, 2]
</code></pre>
<h3 id="lstm-long-short-term-memory"><a class="header" href="#lstm-long-short-term-memory">LSTM (Long Short-Term Memory)</a></h3>
<pre><code class="language-python">class LSTMModel(nn.Module):
    def __init__(self, input_size, hidden_size, output_size, num_layers=2, dropout=0.2):
        super(LSTMModel, self).__init__()
        self.hidden_size = hidden_size
        self.num_layers = num_layers
        
        self.lstm = nn.LSTM(
            input_size, hidden_size, num_layers,
            batch_first=True, dropout=dropout if num_layers &gt; 1 else 0
        )
        self.fc = nn.Linear(hidden_size, output_size)
    
    def forward(self, x):
        # Initialize hidden and cell states
        h0 = torch.zeros(self.num_layers, x.size(0), self.hidden_size).to(x.device)
        c0 = torch.zeros(self.num_layers, x.size(0), self.hidden_size).to(x.device)
        
        # LSTM forward
        out, (hn, cn) = self.lstm(x, (h0, c0))
        
        # Use last time step
        out = self.fc(out[:, -1, :])
        return out

# Bidirectional LSTM
class BiLSTM(nn.Module):
    def __init__(self, input_size, hidden_size, output_size, num_layers=2):
        super(BiLSTM, self).__init__()
        
        self.lstm = nn.LSTM(
            input_size, hidden_size, num_layers,
            batch_first=True, bidirectional=True
        )
        # Multiply by 2 for bidirectional
        self.fc = nn.Linear(hidden_size * 2, output_size)
    
    def forward(self, x):
        out, _ = self.lstm(x)
        out = self.fc(out[:, -1, :])
        return out
</code></pre>
<h3 id="gru-gated-recurrent-unit"><a class="header" href="#gru-gated-recurrent-unit">GRU (Gated Recurrent Unit)</a></h3>
<pre><code class="language-python">class GRUModel(nn.Module):
    def __init__(self, input_size, hidden_size, output_size, num_layers=2, dropout=0.2):
        super(GRUModel, self).__init__()
        self.hidden_size = hidden_size
        self.num_layers = num_layers
        
        self.gru = nn.GRU(
            input_size, hidden_size, num_layers,
            batch_first=True, dropout=dropout if num_layers &gt; 1 else 0
        )
        self.fc = nn.Linear(hidden_size, output_size)
    
    def forward(self, x):
        h0 = torch.zeros(self.num_layers, x.size(0), self.hidden_size).to(x.device)
        out, hn = self.gru(x, h0)
        out = self.fc(out[:, -1, :])
        return out

# Comparison
models = {
    'RNN': SimpleRNN(10, 64, 2),
    'LSTM': LSTMModel(10, 64, 2),
    'GRU': GRUModel(10, 64, 2)
}

for name, model in models.items():
    params = sum(p.numel() for p in model.parameters())
    print(f"{name} parameters: {params}")
</code></pre>
<h2 id="attention-mechanisms"><a class="header" href="#attention-mechanisms">Attention Mechanisms</a></h2>
<p>Attention allows models to focus on relevant parts of the input.</p>
<h3 id="self-attention"><a class="header" href="#self-attention">Self-Attention</a></h3>
<pre><code class="language-python">class SelfAttention(nn.Module):
    def __init__(self, embed_dim, num_heads=8):
        super(SelfAttention, self).__init__()
        self.embed_dim = embed_dim
        self.num_heads = num_heads
        self.head_dim = embed_dim // num_heads
        
        assert self.head_dim * num_heads == embed_dim, "embed_dim must be divisible by num_heads"
        
        self.query = nn.Linear(embed_dim, embed_dim)
        self.key = nn.Linear(embed_dim, embed_dim)
        self.value = nn.Linear(embed_dim, embed_dim)
        self.out = nn.Linear(embed_dim, embed_dim)
    
    def forward(self, x, mask=None):
        batch_size = x.size(0)
        
        # Linear projections
        Q = self.query(x).view(batch_size, -1, self.num_heads, self.head_dim).transpose(1, 2)
        K = self.key(x).view(batch_size, -1, self.num_heads, self.head_dim).transpose(1, 2)
        V = self.value(x).view(batch_size, -1, self.num_heads, self.head_dim).transpose(1, 2)
        
        # Scaled dot-product attention
        scores = torch.matmul(Q, K.transpose(-2, -1)) / np.sqrt(self.head_dim)
        
        if mask is not None:
            scores = scores.masked_fill(mask == 0, -1e9)
        
        attention_weights = F.softmax(scores, dim=-1)
        attention_output = torch.matmul(attention_weights, V)
        
        # Concatenate heads
        attention_output = attention_output.transpose(1, 2).contiguous()
        attention_output = attention_output.view(batch_size, -1, self.embed_dim)
        
        # Final linear layer
        output = self.out(attention_output)
        return output, attention_weights

# Example
attention = SelfAttention(embed_dim=512, num_heads=8)
x = torch.randn(32, 10, 512)  # (batch, seq_len, embed_dim)
output, weights = attention(x)
print(f"Output shape: {output.shape}")
print(f"Attention weights shape: {weights.shape}")
</code></pre>
<h3 id="transformer-block"><a class="header" href="#transformer-block">Transformer Block</a></h3>
<pre><code class="language-python">class TransformerBlock(nn.Module):
    def __init__(self, embed_dim, num_heads, ff_dim, dropout=0.1):
        super(TransformerBlock, self).__init__()
        
        self.attention = nn.MultiheadAttention(embed_dim, num_heads, dropout=dropout)
        self.norm1 = nn.LayerNorm(embed_dim)
        self.norm2 = nn.LayerNorm(embed_dim)
        
        self.feed_forward = nn.Sequential(
            nn.Linear(embed_dim, ff_dim),
            nn.ReLU(),
            nn.Dropout(dropout),
            nn.Linear(ff_dim, embed_dim)
        )
        
        self.dropout = nn.Dropout(dropout)
    
    def forward(self, x, mask=None):
        # Multi-head attention
        attn_output, _ = self.attention(x, x, x, attn_mask=mask)
        x = self.norm1(x + self.dropout(attn_output))
        
        # Feed-forward
        ff_output = self.feed_forward(x)
        x = self.norm2(x + self.dropout(ff_output))
        
        return x
</code></pre>
<h2 id="batch-normalization"><a class="header" href="#batch-normalization">Batch Normalization</a></h2>
<p>Normalizes layer inputs to improve training.</p>
<pre><code class="language-python">class ConvBNReLU(nn.Module):
    def __init__(self, in_channels, out_channels):
        super(ConvBNReLU, self).__init__()
        self.conv = nn.Conv2d(in_channels, out_channels, 3, padding=1)
        self.bn = nn.BatchNorm2d(out_channels)
        self.relu = nn.ReLU()
    
    def forward(self, x):
        return self.relu(self.bn(self.conv(x)))

# Other normalization techniques
# Layer Normalization (better for RNNs/Transformers)
layer_norm = nn.LayerNorm(normalized_shape=[128])

# Group Normalization
group_norm = nn.GroupNorm(num_groups=8, num_channels=64)

# Instance Normalization (used in style transfer)
instance_norm = nn.InstanceNorm2d(num_features=64)
</code></pre>
<h2 id="advanced-architectures"><a class="header" href="#advanced-architectures">Advanced Architectures</a></h2>
<h3 id="vision-transformer-vit"><a class="header" href="#vision-transformer-vit">Vision Transformer (ViT)</a></h3>
<pre><code class="language-python">class PatchEmbedding(nn.Module):
    def __init__(self, img_size=224, patch_size=16, in_channels=3, embed_dim=768):
        super(PatchEmbedding, self).__init__()
        self.num_patches = (img_size // patch_size) ** 2
        self.proj = nn.Conv2d(in_channels, embed_dim, kernel_size=patch_size, stride=patch_size)
    
    def forward(self, x):
        x = self.proj(x)  # (B, embed_dim, H/P, W/P)
        x = x.flatten(2)  # (B, embed_dim, num_patches)
        x = x.transpose(1, 2)  # (B, num_patches, embed_dim)
        return x

class VisionTransformer(nn.Module):
    def __init__(self, img_size=224, patch_size=16, num_classes=1000, 
                 embed_dim=768, depth=12, num_heads=12):
        super(VisionTransformer, self).__init__()
        
        self.patch_embed = PatchEmbedding(img_size, patch_size, 3, embed_dim)
        num_patches = self.patch_embed.num_patches
        
        self.cls_token = nn.Parameter(torch.zeros(1, 1, embed_dim))
        self.pos_embed = nn.Parameter(torch.zeros(1, num_patches + 1, embed_dim))
        
        self.blocks = nn.ModuleList([
            TransformerBlock(embed_dim, num_heads, embed_dim * 4)
            for _ in range(depth)
        ])
        
        self.norm = nn.LayerNorm(embed_dim)
        self.head = nn.Linear(embed_dim, num_classes)
    
    def forward(self, x):
        B = x.shape[0]
        x = self.patch_embed(x)
        
        cls_tokens = self.cls_token.expand(B, -1, -1)
        x = torch.cat([cls_tokens, x], dim=1)
        x = x + self.pos_embed
        
        for block in self.blocks:
            x = block(x)
        
        x = self.norm(x)
        x = x[:, 0]  # Use cls token
        x = self.head(x)
        
        return x
</code></pre>
<h2 id="practical-tips-1"><a class="header" href="#practical-tips-1">Practical Tips</a></h2>
<ol>
<li><strong>Initialize Weights Properly</strong>: Use Xavier/He initialization</li>
<li><strong>Monitor Gradients</strong>: Check for vanishing/exploding gradients</li>
<li><strong>Use Mixed Precision Training</strong>: Faster training with similar accuracy</li>
<li><strong>Data Augmentation</strong>: Improves generalization</li>
<li><strong>Gradient Accumulation</strong>: Train with larger effective batch sizes</li>
<li><strong>Model Checkpointing</strong>: Save best models during training</li>
</ol>
<pre><code class="language-python"># Mixed precision training
from torch.cuda.amp import autocast, GradScaler

scaler = GradScaler()

for epoch in range(num_epochs):
    for data, target in train_loader:
        optimizer.zero_grad()
        
        with autocast():
            output = model(data)
            loss = criterion(output, target)
        
        scaler.scale(loss).backward()
        scaler.step(optimizer)
        scaler.update()
</code></pre>
<h2 id="resources-11"><a class="header" href="#resources-11">Resources</a></h2>
<ul>
<li>"Deep Learning" by Goodfellow, Bengio, and Courville</li>
<li>PyTorch Documentation: https://pytorch.org/docs/</li>
<li>TensorFlow Documentation: https://www.tensorflow.org/</li>
<li>Papers with Code: https://paperswithcode.com/</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="neural-networks"><a class="header" href="#neural-networks">Neural Networks</a></h1>
<h2 id="overview-46"><a class="header" href="#overview-46">Overview</a></h2>
<p>A neural network is a machine learning model inspired by biological brains. It consists of interconnected nodes (neurons) organized in layers that learn patterns from data.</p>
<h2 id="basic-architecture"><a class="header" href="#basic-architecture">Basic Architecture</a></h2>
<pre><code>Input Layer    Hidden Layers          Output Layer
     o              o                    o
     o              o                    o
     o              o                    o
     o              o
     o              o                    o
     o              o
   [n inputs]   [hidden units]   [output units]
</code></pre>
<h2 id="key-components-1"><a class="header" href="#key-components-1">Key Components</a></h2>
<h3 id="neurons"><a class="header" href="#neurons">Neurons</a></h3>
<p>Each neuron applies transformation: $\text{output} = \text{activation}(\text{weights} \cdot \text{inputs} + \text{bias})$</p>
<h3 id="activation-functions-1"><a class="header" href="#activation-functions-1">Activation Functions</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Function</th><th>Formula</th><th>Range</th><th>Use Case</th></tr></thead><tbody>
<tr><td>ReLU</td><td>$\max(0, x)$</td><td>$[0, \infty)$</td><td>Hidden layers</td></tr>
<tr><td>Sigmoid</td><td>$\frac{1}{1+e^{-x}}$</td><td>$(0, 1)$</td><td>Binary classification</td></tr>
<tr><td>Tanh</td><td>$\frac{e^x - e^{-x}}{e^x + e^{-x}}$</td><td>$(-1, 1)$</td><td>Hidden layers</td></tr>
<tr><td>Softmax</td><td>$\frac{e^{x_i}}{\sum_j e^{x_j}}$</td><td>$(0, 1)$ probabilities</td><td>Multi-class output</td></tr>
<tr><td>Linear</td><td>$x$</td><td>$(-\infty, \infty)$</td><td>Regression output</td></tr>
</tbody></table>
</div>
<h3 id="layers"><a class="header" href="#layers">Layers</a></h3>
<ol>
<li><strong>Input Layer</strong>: Raw data (28x28 pixels, word embeddings, etc.)</li>
<li><strong>Hidden Layers</strong>: Learn complex patterns through non-linear transformations</li>
<li><strong>Output Layer</strong>: Final predictions</li>
</ol>
<h2 id="training-process"><a class="header" href="#training-process">Training Process</a></h2>
<h3 id="forward-pass"><a class="header" href="#forward-pass">Forward Pass</a></h3>
<p>Input flows through network:</p>
<pre><code>x → w1 + b1 → activation → ... → output
</code></pre>
<h3 id="loss-function"><a class="header" href="#loss-function">Loss Function</a></h3>
<p>Measures prediction error:</p>
<ul>
<li><strong>MSE</strong> (regression): Mean squared error</li>
<li><strong>Cross-Entropy</strong> (classification): Measures probability difference</li>
</ul>
<h3 id="backpropagation-1"><a class="header" href="#backpropagation-1">Backpropagation</a></h3>
<p>Calculates gradients and updates weights:</p>
<pre><code>1. Compute loss
2. Calculate gradients: ∂(loss)/∂(weights)
3. Update weights: w = w - learning_rate × gradient
4. Repeat
</code></pre>
<h3 id="optimizers-1"><a class="header" href="#optimizers-1">Optimizers</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Optimizer</th><th>Learning</th><th>Best For</th></tr></thead><tbody>
<tr><td>SGD</td><td>Fixed or decaying</td><td>Simple tasks</td></tr>
<tr><td>Momentum</td><td>Accelerated</td><td>Faster convergence</td></tr>
<tr><td>Adam</td><td>Adaptive</td><td>Most modern tasks</td></tr>
<tr><td>RMSprop</td><td>Adaptive</td><td>Deep networks</td></tr>
</tbody></table>
</div>
<h2 id="code-example-pytorch"><a class="header" href="#code-example-pytorch">Code Example (PyTorch)</a></h2>
<pre><code class="language-python">import torch
import torch.nn as nn
from torch.optim import Adam

# Define network
class NeuralNetwork(nn.Module):
    def __init__(self, input_size, hidden_size, output_size):
        super().__init__()
        self.fc1 = nn.Linear(input_size, hidden_size)
        self.relu = nn.ReLU()
        self.fc2 = nn.Linear(hidden_size, output_size)

    def forward(self, x):
        x = self.fc1(x)
        x = self.relu(x)
        x = self.fc2(x)
        return x

# Create network
model = NeuralNetwork(input_size=784, hidden_size=128, output_size=10)
criterion = nn.CrossEntropyLoss()
optimizer = Adam(model.parameters(), lr=0.001)

# Training loop
for epoch in range(10):
    for batch_x, batch_y in train_loader:
        # Forward pass
        outputs = model(batch_x)
        loss = criterion(outputs, batch_y)

        # Backward pass
        optimizer.zero_grad()
        loss.backward()
        optimizer.step()
</code></pre>
<h2 id="network-types"><a class="header" href="#network-types">Network Types</a></h2>
<h3 id="feedforward-neural-networks-fnn"><a class="header" href="#feedforward-neural-networks-fnn">Feedforward Neural Networks (FNN)</a></h3>
<ul>
<li>Data flows one direction only</li>
<li>Simplest type, works for structured data</li>
</ul>
<h3 id="convolutional-neural-networks-cnn"><a class="header" href="#convolutional-neural-networks-cnn">Convolutional Neural Networks (CNN)</a></h3>
<ul>
<li>Specialized for image processing</li>
<li>Uses filters to extract spatial features</li>
<li>Reduces parameters through weight sharing</li>
</ul>
<h3 id="recurrent-neural-networks-rnn"><a class="header" href="#recurrent-neural-networks-rnn">Recurrent Neural Networks (RNN)</a></h3>
<ul>
<li>Processes sequences (text, time series)</li>
<li>Maintains hidden state between inputs</li>
<li>Variants: LSTM, GRU (better long-term memory)</li>
</ul>
<h3 id="transformers"><a class="header" href="#transformers">Transformers</a></h3>
<ul>
<li>Attention-based architecture</li>
<li>Parallel processing of sequences</li>
<li>Powers modern LLMs (GPT, BERT)</li>
</ul>
<h2 id="hyperparameters"><a class="header" href="#hyperparameters">Hyperparameters</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Parameter</th><th>Impact</th><th>Typical Values</th></tr></thead><tbody>
<tr><td>Learning Rate</td><td>Convergence speed, stability</td><td>0.001 - 0.1</td></tr>
<tr><td>Batch Size</td><td>Memory, stability</td><td>32 - 256</td></tr>
<tr><td>Hidden Units</td><td>Capacity</td><td>64 - 2048</td></tr>
<tr><td>Epochs</td><td>Training duration</td><td>10 - 100</td></tr>
<tr><td>Dropout</td><td>Regularization</td><td>0.3 - 0.5</td></tr>
</tbody></table>
</div>
<h2 id="training-tips"><a class="header" href="#training-tips">Training Tips</a></h2>
<h3 id="1-data-preprocessing"><a class="header" href="#1-data-preprocessing">1. Data Preprocessing</a></h3>
<pre><code class="language-python"># Normalize inputs
mean = X_train.mean()
std = X_train.std()
X_train = (X_train - mean) / std
</code></pre>
<h3 id="2-early-stopping"><a class="header" href="#2-early-stopping">2. Early Stopping</a></h3>
<pre><code class="language-python"># Stop if validation loss doesn't improve
if val_loss &gt; best_loss:
    patience -= 1
    if patience == 0:
        break
best_loss = min(best_loss, val_loss)
</code></pre>
<h3 id="3-learning-rate-scheduling"><a class="header" href="#3-learning-rate-scheduling">3. Learning Rate Scheduling</a></h3>
<pre><code class="language-python"># Decrease learning rate over time
scheduler = torch.optim.lr_scheduler.StepLR(optimizer, step_size=10, gamma=0.1)
for epoch in range(100):
    # train...
    scheduler.step()
</code></pre>
<h3 id="4-regularization"><a class="header" href="#4-regularization">4. Regularization</a></h3>
<ul>
<li><strong>L1/L2</strong>: Penalize large weights</li>
<li><strong>Dropout</strong>: Randomly disable neurons</li>
<li><strong>Batch Normalization</strong>: Normalize activations</li>
</ul>
<h2 id="common-issues-7"><a class="header" href="#common-issues-7">Common Issues</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Problem</th><th>Cause</th><th>Solution</th></tr></thead><tbody>
<tr><td>Underfitting</td><td>Model too simple</td><td>Increase hidden units, epochs</td></tr>
<tr><td>Overfitting</td><td>Model too complex</td><td>Add dropout, L2 regularization</td></tr>
<tr><td>Vanishing Gradients</td><td>Gradients $\to$ 0</td><td>Use ReLU, batch norm</td></tr>
<tr><td>Exploding Gradients</td><td>Gradients $\to \infty$</td><td>Gradient clipping</td></tr>
</tbody></table>
</div>
<h2 id="modern-architectures"><a class="header" href="#modern-architectures">Modern Architectures</a></h2>
<h3 id="resnet-residual-networks-1"><a class="header" href="#resnet-residual-networks-1">ResNet (Residual Networks)</a></h3>
<p>Skip connections prevent vanishing gradients in deep networks</p>
<h3 id="attention-mechanisms-1"><a class="header" href="#attention-mechanisms-1">Attention Mechanisms</a></h3>
<p>Query-Key-Value mechanism enables transformers</p>
<h3 id="vision-transformers-vit"><a class="header" href="#vision-transformers-vit">Vision Transformers (ViT)</a></h3>
<p>Apply transformer architecture to image patches</p>
<h2 id="eli10-13"><a class="header" href="#eli10-13">ELI10</a></h2>
<p>Think of a neural network like learning to draw:</p>
<ol>
<li><strong>Input Layer</strong>: You see a cat</li>
<li><strong>Hidden Layers</strong>: Brain recognizes ears -&gt; whiskers -&gt; tail (learns patterns)</li>
<li><strong>Output Layer</strong>: Brain says "This is a cat!"</li>
</ol>
<p>The network learns by:</p>
<ul>
<li>Making predictions (forward pass)</li>
<li>Checking if wrong (loss)</li>
<li>Adjusting "how to recognize cats" (backprop)</li>
<li>Repeating until accurate</li>
</ul>
<p>More hidden layers = learns more complex patterns!</p>
<h2 id="further-resources-13"><a class="header" href="#further-resources-13">Further Resources</a></h2>
<ul>
<li><a href="https://playground.tensorflow.org/">Neural Networks Visualization</a></li>
<li><a href="https://www.youtube.com/watch?v=aircAruvnKk">3Blue1Brown Neural Networks Series</a></li>
<li><a href="https://pytorch.org/tutorials/">PyTorch Tutorials</a></li>
<li><a href="https://www.deeplearningbook.org/">Deep Learning Book</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="supervised-learning-1"><a class="header" href="#supervised-learning-1">Supervised Learning</a></h1>
<p>Supervised learning is a type of machine learning where the model learns from labeled training data to make predictions on unseen data.</p>
<h2 id="table-of-contents-16"><a class="header" href="#table-of-contents-16">Table of Contents</a></h2>
<ol>
<li><a href="machine_learning/supervised_learning.html#classification">Classification</a></li>
<li><a href="machine_learning/supervised_learning.html#regression">Regression</a></li>
<li><a href="machine_learning/supervised_learning.html#linear-models">Linear Models</a></li>
<li><a href="machine_learning/supervised_learning.html#tree-based-models">Tree-Based Models</a></li>
<li><a href="machine_learning/supervised_learning.html#support-vector-machines">Support Vector Machines</a></li>
<li><a href="machine_learning/supervised_learning.html#ensemble-methods">Ensemble Methods</a></li>
<li><a href="machine_learning/supervised_learning.html#naive-bayes">Naive Bayes</a></li>
<li><a href="machine_learning/supervised_learning.html#k-nearest-neighbors">K-Nearest Neighbors</a></li>
</ol>
<h2 id="classification"><a class="header" href="#classification">Classification</a></h2>
<p>Classification predicts discrete class labels. The goal is to learn a decision boundary that separates different classes.</p>
<h3 id="binary-classification"><a class="header" href="#binary-classification">Binary Classification</a></h3>
<pre><code class="language-python">import numpy as np
from sklearn.datasets import make_classification
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import accuracy_score, confusion_matrix, classification_report

# Generate synthetic data
X, y = make_classification(n_samples=1000, n_features=20, n_classes=2, random_state=42)
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# Train logistic regression
model = LogisticRegression(max_iter=1000)
model.fit(X_train, y_train)

# Predictions
y_pred = model.predict(X_test)
y_proba = model.predict_proba(X_test)

# Evaluation
print(f"Accuracy: {accuracy_score(y_test, y_pred):.4f}")
print("\nConfusion Matrix:")
print(confusion_matrix(y_test, y_pred))
print("\nClassification Report:")
print(classification_report(y_test, y_pred))
</code></pre>
<h3 id="multi-class-classification"><a class="header" href="#multi-class-classification">Multi-class Classification</a></h3>
<pre><code class="language-python">from sklearn.datasets import make_classification
from sklearn.ensemble import RandomForestClassifier

# Generate multi-class data
X, y = make_classification(
    n_samples=1000,
    n_features=20,
    n_classes=5,
    n_informative=15,
    random_state=42
)

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2)

# Random Forest for multi-class
rf = RandomForestClassifier(n_estimators=100, random_state=42)
rf.fit(X_train, y_train)

# One-vs-Rest (OvR) strategy
from sklearn.multiclass import OneVsRestClassifier
from sklearn.svm import SVC

ovr = OneVsRestClassifier(SVC(kernel='rbf'))
ovr.fit(X_train, y_train)

# One-vs-One (OvO) strategy
from sklearn.multiclass import OneVsOneClassifier
ovo = OneVsOneClassifier(SVC(kernel='rbf'))
ovo.fit(X_train, y_train)
</code></pre>
<h3 id="imbalanced-classification"><a class="header" href="#imbalanced-classification">Imbalanced Classification</a></h3>
<pre><code class="language-python">from imblearn.over_sampling import SMOTE, ADASYN
from imblearn.under_sampling import RandomUnderSampler, TomekLinks
from imblearn.combine import SMOTETomek
from sklearn.utils.class_weight import compute_class_weight

# SMOTE - Synthetic Minority Over-sampling Technique
smote = SMOTE(random_state=42)
X_resampled, y_resampled = smote.fit_resample(X_train, y_train)

# ADASYN - Adaptive Synthetic Sampling
adasyn = ADASYN(random_state=42)
X_resampled, y_resampled = adasyn.fit_resample(X_train, y_train)

# Combined approach
smote_tomek = SMOTETomek(random_state=42)
X_resampled, y_resampled = smote_tomek.fit_resample(X_train, y_train)

# Class weights
class_weights = compute_class_weight('balanced', classes=np.unique(y_train), y=y_train)
model = LogisticRegression(class_weight='balanced')
model.fit(X_train, y_train)

# Custom threshold
y_proba = model.predict_proba(X_test)[:, 1]
threshold = 0.3  # Lower threshold for minority class
y_pred_custom = (y_proba &gt;= threshold).astype(int)
</code></pre>
<h2 id="regression"><a class="header" href="#regression">Regression</a></h2>
<p>Regression predicts continuous values. The goal is to learn a function that maps inputs to outputs.</p>
<h3 id="linear-regression"><a class="header" href="#linear-regression">Linear Regression</a></h3>
<p>Mathematical formulation:</p>
<pre><code>y = β₀ + β₁x₁ + β₂x₂ + ... + βₙxₙ + ε
</code></pre>
<p>Where:</p>
<ul>
<li>y is the target variable</li>
<li>x₁, x₂, ..., xₙ are features</li>
<li>β₀, β₁, ..., βₙ are coefficients</li>
<li>ε is the error term</li>
</ul>
<pre><code class="language-python">from sklearn.linear_model import LinearRegression
from sklearn.datasets import make_regression
from sklearn.metrics import mean_squared_error, r2_score, mean_absolute_error

# Generate regression data
X, y = make_regression(n_samples=1000, n_features=10, noise=10, random_state=42)
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2)

# Train linear regression
lr = LinearRegression()
lr.fit(X_train, y_train)

# Predictions
y_pred = lr.predict(X_test)

# Evaluation
mse = mean_squared_error(y_test, y_pred)
rmse = np.sqrt(mse)
mae = mean_absolute_error(y_test, y_pred)
r2 = r2_score(y_test, y_pred)

print(f"RMSE: {rmse:.4f}")
print(f"MAE: {mae:.4f}")
print(f"R² Score: {r2:.4f}")

# Coefficients
print("\nCoefficients:", lr.coef_)
print("Intercept:", lr.intercept_)
</code></pre>
<h3 id="polynomial-regression"><a class="header" href="#polynomial-regression">Polynomial Regression</a></h3>
<pre><code class="language-python">from sklearn.preprocessing import PolynomialFeatures
from sklearn.pipeline import Pipeline

# Create polynomial features
poly_features = PolynomialFeatures(degree=3, include_bias=False)
X_poly = poly_features.fit_transform(X_train)

# Using Pipeline
poly_model = Pipeline([
    ('poly_features', PolynomialFeatures(degree=3)),
    ('linear_regression', LinearRegression())
])

poly_model.fit(X_train, y_train)
y_pred_poly = poly_model.predict(X_test)

# Compare with linear
from sklearn.metrics import mean_squared_error
print(f"Linear RMSE: {np.sqrt(mean_squared_error(y_test, y_pred)):.4f}")
print(f"Polynomial RMSE: {np.sqrt(mean_squared_error(y_test, y_pred_poly)):.4f}")
</code></pre>
<h3 id="regularized-regression"><a class="header" href="#regularized-regression">Regularized Regression</a></h3>
<p><strong>Ridge Regression (L2):</strong></p>
<pre><code>Loss = Σ(y - ŷ)² + λΣβ²
</code></pre>
<p><strong>Lasso Regression (L1):</strong></p>
<pre><code>Loss = Σ(y - ŷ)² + λΣ|β|
</code></pre>
<p><strong>Elastic Net:</strong></p>
<pre><code>Loss = Σ(y - ŷ)² + λ₁Σ|β| + λ₂Σβ²
</code></pre>
<pre><code class="language-python">from sklearn.linear_model import Ridge, Lasso, ElasticNet, LassoCV, RidgeCV

# Ridge Regression
ridge = Ridge(alpha=1.0)
ridge.fit(X_train, y_train)
y_pred_ridge = ridge.predict(X_test)

# Lasso Regression (feature selection)
lasso = Lasso(alpha=0.1)
lasso.fit(X_train, y_train)
y_pred_lasso = lasso.predict(X_test)

# Check which features were selected by Lasso
feature_importance = np.abs(lasso.coef_)
selected_features = np.where(feature_importance &gt; 0)[0]
print(f"Selected features: {selected_features}")

# Elastic Net
elastic = ElasticNet(alpha=0.1, l1_ratio=0.5)
elastic.fit(X_train, y_train)

# Cross-validated alpha selection
ridge_cv = RidgeCV(alphas=[0.1, 1.0, 10.0, 100.0])
ridge_cv.fit(X_train, y_train)
print(f"Best alpha: {ridge_cv.alpha_}")

lasso_cv = LassoCV(alphas=[0.01, 0.1, 1.0, 10.0], cv=5)
lasso_cv.fit(X_train, y_train)
print(f"Best alpha: {lasso_cv.alpha_}")
</code></pre>
<h2 id="linear-models"><a class="header" href="#linear-models">Linear Models</a></h2>
<h3 id="logistic-regression"><a class="header" href="#logistic-regression">Logistic Regression</a></h3>
<p>Binary classification using the sigmoid function:</p>
<pre><code>P(y=1|x) = 1 / (1 + e^(-z))
where z = β₀ + β₁x₁ + ... + βₙxₙ
</code></pre>
<pre><code class="language-python">from sklearn.linear_model import LogisticRegression

# Binary classification
log_reg = LogisticRegression(
    penalty='l2',
    C=1.0,  # Inverse of regularization strength
    solver='lbfgs',
    max_iter=1000
)
log_reg.fit(X_train, y_train)

# Get probabilities
probabilities = log_reg.predict_proba(X_test)
print("Class probabilities shape:", probabilities.shape)

# Decision boundary
decision_scores = log_reg.decision_function(X_test)
print("Decision scores shape:", decision_scores.shape)

# Multi-class logistic regression
multi_log_reg = LogisticRegression(multi_class='multinomial', solver='lbfgs')
multi_log_reg.fit(X_train, y_train)
</code></pre>
<h3 id="perceptron-1"><a class="header" href="#perceptron-1">Perceptron</a></h3>
<pre><code class="language-python">from sklearn.linear_model import Perceptron

# Simple perceptron
perceptron = Perceptron(max_iter=1000, tol=1e-3, random_state=42)
perceptron.fit(X_train, y_train)
y_pred = perceptron.predict(X_test)

# Custom perceptron implementation
class CustomPerceptron:
    def __init__(self, learning_rate=0.01, n_iterations=1000):
        self.lr = learning_rate
        self.n_iterations = n_iterations
        self.weights = None
        self.bias = None
    
    def fit(self, X, y):
        n_samples, n_features = X.shape
        self.weights = np.zeros(n_features)
        self.bias = 0
        
        # Convert labels to -1 and 1
        y_ = np.where(y &lt;= 0, -1, 1)
        
        for _ in range(self.n_iterations):
            for idx, x_i in enumerate(X):
                linear_output = np.dot(x_i, self.weights) + self.bias
                y_predicted = np.sign(linear_output)
                
                # Update weights if misclassified
                update = self.lr * (y_[idx] - y_predicted)
                self.weights += update * x_i
                self.bias += update
    
    def predict(self, X):
        linear_output = np.dot(X, self.weights) + self.bias
        return np.sign(linear_output)

# Train custom perceptron
custom_perc = CustomPerceptron()
custom_perc.fit(X_train, y_train)
</code></pre>
<h2 id="tree-based-models"><a class="header" href="#tree-based-models">Tree-Based Models</a></h2>
<h3 id="decision-trees"><a class="header" href="#decision-trees">Decision Trees</a></h3>
<pre><code class="language-python">from sklearn.tree import DecisionTreeClassifier, DecisionTreeRegressor
from sklearn.tree import export_graphviz
import graphviz

# Classification tree
dt_clf = DecisionTreeClassifier(
    max_depth=5,
    min_samples_split=10,
    min_samples_leaf=5,
    criterion='gini'  # or 'entropy'
)
dt_clf.fit(X_train, y_train)

# Regression tree
dt_reg = DecisionTreeRegressor(
    max_depth=5,
    min_samples_split=10,
    min_samples_leaf=5
)
dt_reg.fit(X_train, y_train)

# Feature importance
importances = dt_clf.feature_importances_
indices = np.argsort(importances)[::-1]
print("Feature ranking:")
for i in range(min(10, len(indices))):
    print(f"{i+1}. Feature {indices[i]} ({importances[indices[i]]:.4f})")

# Visualize tree
dot_data = export_graphviz(
    dt_clf,
    out_file=None,
    feature_names=[f'feature_{i}' for i in range(X_train.shape[1])],
    class_names=['class_0', 'class_1'],
    filled=True,
    rounded=True
)
# graph = graphviz.Source(dot_data)
</code></pre>
<h3 id="random-forest"><a class="header" href="#random-forest">Random Forest</a></h3>
<pre><code class="language-python">from sklearn.ensemble import RandomForestClassifier, RandomForestRegressor

# Random Forest Classifier
rf_clf = RandomForestClassifier(
    n_estimators=100,
    max_depth=10,
    min_samples_split=10,
    min_samples_leaf=4,
    max_features='sqrt',  # or 'log2', None
    bootstrap=True,
    oob_score=True,  # Out-of-bag score
    n_jobs=-1,
    random_state=42
)
rf_clf.fit(X_train, y_train)

# Out-of-bag score
print(f"OOB Score: {rf_clf.oob_score_:.4f}")

# Random Forest Regressor
rf_reg = RandomForestRegressor(
    n_estimators=100,
    max_depth=10,
    n_jobs=-1,
    random_state=42
)
rf_reg.fit(X_train, y_train)

# Feature importance
feature_importance = pd.DataFrame({
    'feature': [f'feature_{i}' for i in range(X_train.shape[1])],
    'importance': rf_clf.feature_importances_
}).sort_values('importance', ascending=False)
print(feature_importance.head(10))
</code></pre>
<h3 id="gradient-boosting"><a class="header" href="#gradient-boosting">Gradient Boosting</a></h3>
<pre><code class="language-python">from sklearn.ensemble import GradientBoostingClassifier, GradientBoostingRegressor

# Gradient Boosting Classifier
gb_clf = GradientBoostingClassifier(
    n_estimators=100,
    learning_rate=0.1,
    max_depth=3,
    subsample=0.8,
    random_state=42
)
gb_clf.fit(X_train, y_train)

# Gradient Boosting Regressor
gb_reg = GradientBoostingRegressor(
    n_estimators=100,
    learning_rate=0.1,
    max_depth=3,
    random_state=42
)
gb_reg.fit(X_train, y_train)

# Feature importance
print("Feature importances:", gb_clf.feature_importances_)
</code></pre>
<h3 id="xgboost"><a class="header" href="#xgboost">XGBoost</a></h3>
<pre><code class="language-python">import xgboost as xgb
from xgboost import XGBClassifier, XGBRegressor

# XGBoost Classifier
xgb_clf = XGBClassifier(
    n_estimators=100,
    max_depth=6,
    learning_rate=0.1,
    subsample=0.8,
    colsample_bytree=0.8,
    objective='binary:logistic',
    random_state=42
)
xgb_clf.fit(X_train, y_train)

# XGBoost Regressor
xgb_reg = XGBRegressor(
    n_estimators=100,
    max_depth=6,
    learning_rate=0.1,
    subsample=0.8,
    colsample_bytree=0.8,
    random_state=42
)
xgb_reg.fit(X_train, y_train)

# Using DMatrix for better performance
dtrain = xgb.DMatrix(X_train, label=y_train)
dtest = xgb.DMatrix(X_test, label=y_test)

params = {
    'max_depth': 6,
    'eta': 0.1,
    'objective': 'binary:logistic',
    'eval_metric': 'auc'
}

# Train with early stopping
evals = [(dtrain, 'train'), (dtest, 'test')]
bst = xgb.train(
    params,
    dtrain,
    num_boost_round=1000,
    evals=evals,
    early_stopping_rounds=50,
    verbose_eval=False
)

# Predictions
y_pred_proba = bst.predict(dtest)
</code></pre>
<h3 id="lightgbm"><a class="header" href="#lightgbm">LightGBM</a></h3>
<pre><code class="language-python">import lightgbm as lgb

# LightGBM Classifier
lgb_clf = lgb.LGBMClassifier(
    n_estimators=100,
    max_depth=6,
    learning_rate=0.1,
    num_leaves=31,
    subsample=0.8,
    colsample_bytree=0.8,
    random_state=42
)
lgb_clf.fit(X_train, y_train)

# Using Dataset for better performance
train_data = lgb.Dataset(X_train, label=y_train)
test_data = lgb.Dataset(X_test, label=y_test, reference=train_data)

params = {
    'objective': 'binary',
    'metric': 'auc',
    'num_leaves': 31,
    'learning_rate': 0.1,
    'feature_fraction': 0.8,
    'bagging_fraction': 0.8,
    'bagging_freq': 5
}

# Train
gbm = lgb.train(
    params,
    train_data,
    num_boost_round=1000,
    valid_sets=[test_data],
    callbacks=[lgb.early_stopping(stopping_rounds=50)]
)
</code></pre>
<h2 id="support-vector-machines"><a class="header" href="#support-vector-machines">Support Vector Machines</a></h2>
<p>SVM finds the hyperplane that maximizes the margin between classes.</p>
<p><strong>Mathematical Formulation:</strong></p>
<pre><code>Minimize: (1/2)||w||² + C·Σξᵢ
Subject to: yᵢ(w·xᵢ + b) ≥ 1 - ξᵢ, ξᵢ ≥ 0
</code></pre>
<h3 id="linear-svm"><a class="header" href="#linear-svm">Linear SVM</a></h3>
<pre><code class="language-python">from sklearn.svm import SVC, LinearSVC

# Linear SVM
linear_svm = LinearSVC(C=1.0, max_iter=10000)
linear_svm.fit(X_train, y_train)

# SVC with linear kernel
svc_linear = SVC(kernel='linear', C=1.0)
svc_linear.fit(X_train, y_train)
</code></pre>
<h3 id="non-linear-svm-with-kernels"><a class="header" href="#non-linear-svm-with-kernels">Non-linear SVM with Kernels</a></h3>
<pre><code class="language-python"># RBF (Radial Basis Function) kernel
svc_rbf = SVC(kernel='rbf', C=1.0, gamma='scale')
svc_rbf.fit(X_train, y_train)

# Polynomial kernel
svc_poly = SVC(kernel='poly', degree=3, C=1.0)
svc_poly.fit(X_train, y_train)

# Sigmoid kernel
svc_sigmoid = SVC(kernel='sigmoid', C=1.0)
svc_sigmoid.fit(X_train, y_train)

# Custom kernel
def custom_kernel(X, Y):
    return np.dot(X, Y.T)

svc_custom = SVC(kernel=custom_kernel)
svc_custom.fit(X_train, y_train)
</code></pre>
<h3 id="svm-for-regression"><a class="header" href="#svm-for-regression">SVM for Regression</a></h3>
<pre><code class="language-python">from sklearn.svm import SVR

# Support Vector Regression
svr = SVR(kernel='rbf', C=1.0, epsilon=0.1)
svr.fit(X_train, y_train)
y_pred_svr = svr.predict(X_test)

# Linear SVR
from sklearn.svm import LinearSVR
linear_svr = LinearSVR(epsilon=0.1, C=1.0)
linear_svr.fit(X_train, y_train)
</code></pre>
<h2 id="ensemble-methods"><a class="header" href="#ensemble-methods">Ensemble Methods</a></h2>
<h3 id="bagging"><a class="header" href="#bagging">Bagging</a></h3>
<pre><code class="language-python">from sklearn.ensemble import BaggingClassifier, BaggingRegressor
from sklearn.tree import DecisionTreeClassifier

# Bagging with decision trees
bagging_clf = BaggingClassifier(
    base_estimator=DecisionTreeClassifier(),
    n_estimators=100,
    max_samples=0.8,
    max_features=0.8,
    bootstrap=True,
    oob_score=True,
    n_jobs=-1,
    random_state=42
)
bagging_clf.fit(X_train, y_train)
print(f"OOB Score: {bagging_clf.oob_score_:.4f}")
</code></pre>
<h3 id="boosting"><a class="header" href="#boosting">Boosting</a></h3>
<p><strong>AdaBoost:</strong></p>
<pre><code class="language-python">from sklearn.ensemble import AdaBoostClassifier, AdaBoostRegressor

# AdaBoost Classifier
ada_clf = AdaBoostClassifier(
    base_estimator=DecisionTreeClassifier(max_depth=1),
    n_estimators=100,
    learning_rate=1.0,
    random_state=42
)
ada_clf.fit(X_train, y_train)

# AdaBoost Regressor
ada_reg = AdaBoostRegressor(
    base_estimator=DecisionTreeRegressor(max_depth=3),
    n_estimators=100,
    learning_rate=1.0,
    random_state=42
)
ada_reg.fit(X_train, y_train)
</code></pre>
<h3 id="stacking"><a class="header" href="#stacking">Stacking</a></h3>
<pre><code class="language-python">from sklearn.ensemble import StackingClassifier, StackingRegressor
from sklearn.linear_model import LogisticRegression
from sklearn.tree import DecisionTreeClassifier
from sklearn.svm import SVC
from sklearn.naive_bayes import GaussianNB

# Define base models
base_models = [
    ('lr', LogisticRegression()),
    ('dt', DecisionTreeClassifier()),
    ('svc', SVC(probability=True)),
    ('nb', GaussianNB())
]

# Stacking Classifier
stacking_clf = StackingClassifier(
    estimators=base_models,
    final_estimator=LogisticRegression(),
    cv=5
)
stacking_clf.fit(X_train, y_train)

# Stacking Regressor
from sklearn.linear_model import Ridge, Lasso
from sklearn.tree import DecisionTreeRegressor

reg_base_models = [
    ('ridge', Ridge()),
    ('lasso', Lasso()),
    ('dt', DecisionTreeRegressor())
]

stacking_reg = StackingRegressor(
    estimators=reg_base_models,
    final_estimator=Ridge(),
    cv=5
)
stacking_reg.fit(X_train, y_train)
</code></pre>
<h3 id="voting"><a class="header" href="#voting">Voting</a></h3>
<pre><code class="language-python">from sklearn.ensemble import VotingClassifier, VotingRegressor

# Hard voting
voting_clf_hard = VotingClassifier(
    estimators=base_models,
    voting='hard'
)
voting_clf_hard.fit(X_train, y_train)

# Soft voting (uses predicted probabilities)
voting_clf_soft = VotingClassifier(
    estimators=base_models,
    voting='soft'
)
voting_clf_soft.fit(X_train, y_train)

# Voting Regressor
voting_reg = VotingRegressor(estimators=reg_base_models)
voting_reg.fit(X_train, y_train)
</code></pre>
<h2 id="naive-bayes"><a class="header" href="#naive-bayes">Naive Bayes</a></h2>
<p>Based on Bayes' theorem with the "naive" assumption of feature independence:</p>
<pre><code>P(y|x₁,...,xₙ) = P(y)·P(x₁,...,xₙ|y) / P(x₁,...,xₙ)
</code></pre>
<h3 id="gaussian-naive-bayes"><a class="header" href="#gaussian-naive-bayes">Gaussian Naive Bayes</a></h3>
<pre><code class="language-python">from sklearn.naive_bayes import GaussianNB

# Gaussian NB (assumes features follow normal distribution)
gnb = GaussianNB()
gnb.fit(X_train, y_train)
y_pred = gnb.predict(X_test)
y_proba = gnb.predict_proba(X_test)
</code></pre>
<h3 id="multinomial-naive-bayes"><a class="header" href="#multinomial-naive-bayes">Multinomial Naive Bayes</a></h3>
<pre><code class="language-python">from sklearn.naive_bayes import MultinomialNB
from sklearn.feature_extraction.text import CountVectorizer

# Example with text data
texts = ["I love this", "This is bad", "Great product", "Terrible experience"]
labels = [1, 0, 1, 0]

vectorizer = CountVectorizer()
X_text = vectorizer.fit_transform(texts)

mnb = MultinomialNB(alpha=1.0)
mnb.fit(X_text, labels)
</code></pre>
<h3 id="bernoulli-naive-bayes"><a class="header" href="#bernoulli-naive-bayes">Bernoulli Naive Bayes</a></h3>
<pre><code class="language-python">from sklearn.naive_bayes import BernoulliNB

# Bernoulli NB (for binary/boolean features)
bnb = BernoulliNB(alpha=1.0)
bnb.fit(X_train, y_train)
</code></pre>
<h2 id="k-nearest-neighbors"><a class="header" href="#k-nearest-neighbors">K-Nearest Neighbors</a></h2>
<p>KNN is a non-parametric method that classifies based on the k nearest training examples.</p>
<pre><code class="language-python">from sklearn.neighbors import KNeighborsClassifier, KNeighborsRegressor

# KNN Classifier
knn_clf = KNeighborsClassifier(
    n_neighbors=5,
    weights='uniform',  # or 'distance'
    algorithm='auto',  # 'ball_tree', 'kd_tree', 'brute'
    metric='minkowski',
    p=2  # p=2 for Euclidean, p=1 for Manhattan
)
knn_clf.fit(X_train, y_train)

# Distance-weighted KNN
knn_weighted = KNeighborsClassifier(n_neighbors=5, weights='distance')
knn_weighted.fit(X_train, y_train)

# KNN Regressor
knn_reg = KNeighborsRegressor(n_neighbors=5, weights='distance')
knn_reg.fit(X_train, y_train)

# Find optimal k
from sklearn.model_selection import cross_val_score

k_range = range(1, 31)
k_scores = []
for k in k_range:
    knn = KNeighborsClassifier(n_neighbors=k)
    scores = cross_val_score(knn, X_train, y_train, cv=5, scoring='accuracy')
    k_scores.append(scores.mean())

optimal_k = k_range[np.argmax(k_scores)]
print(f"Optimal k: {optimal_k}")
</code></pre>
<h2 id="model-comparison"><a class="header" href="#model-comparison">Model Comparison</a></h2>
<pre><code class="language-python">from sklearn.model_selection import cross_validate
import pandas as pd

# Define models to compare
models = {
    'Logistic Regression': LogisticRegression(),
    'Decision Tree': DecisionTreeClassifier(),
    'Random Forest': RandomForestClassifier(),
    'SVM': SVC(),
    'KNN': KNeighborsClassifier(),
    'Naive Bayes': GaussianNB(),
    'XGBoost': XGBClassifier()
}

# Compare models
results = []
for name, model in models.items():
    cv_results = cross_validate(
        model, X_train, y_train,
        cv=5,
        scoring=['accuracy', 'precision', 'recall', 'f1'],
        return_train_score=True
    )
    
    results.append({
        'Model': name,
        'Train Accuracy': cv_results['train_accuracy'].mean(),
        'Test Accuracy': cv_results['test_accuracy'].mean(),
        'Precision': cv_results['test_precision'].mean(),
        'Recall': cv_results['test_recall'].mean(),
        'F1': cv_results['test_f1'].mean()
    })

# Display results
comparison_df = pd.DataFrame(results)
comparison_df = comparison_df.sort_values('Test Accuracy', ascending=False)
print(comparison_df)
</code></pre>
<h2 id="practical-tips-2"><a class="header" href="#practical-tips-2">Practical Tips</a></h2>
<h3 id="1-data-preprocessing-1"><a class="header" href="#1-data-preprocessing-1">1. Data Preprocessing</a></h3>
<pre><code class="language-python">from sklearn.preprocessing import StandardScaler, MinMaxScaler
from sklearn.impute import SimpleImputer

# Handle missing values
imputer = SimpleImputer(strategy='mean')  # or 'median', 'most_frequent'
X_imputed = imputer.fit_transform(X)

# Feature scaling (important for SVM, KNN, Neural Networks)
scaler = StandardScaler()
X_scaled = scaler.fit_transform(X_train)
X_test_scaled = scaler.transform(X_test)
</code></pre>
<h3 id="2-feature-selection"><a class="header" href="#2-feature-selection">2. Feature Selection</a></h3>
<pre><code class="language-python">from sklearn.feature_selection import SelectKBest, f_classif, RFE

# Univariate selection
selector = SelectKBest(f_classif, k=10)
X_selected = selector.fit_transform(X_train, y_train)

# Recursive Feature Elimination
rfe = RFE(estimator=RandomForestClassifier(), n_features_to_select=10)
X_rfe = rfe.fit_transform(X_train, y_train)
</code></pre>
<h3 id="3-pipeline"><a class="header" href="#3-pipeline">3. Pipeline</a></h3>
<pre><code class="language-python">from sklearn.pipeline import Pipeline
from sklearn.preprocessing import StandardScaler
from sklearn.decomposition import PCA

# Create pipeline
pipe = Pipeline([
    ('scaler', StandardScaler()),
    ('pca', PCA(n_components=10)),
    ('classifier', LogisticRegression())
])

pipe.fit(X_train, y_train)
y_pred = pipe.predict(X_test)
</code></pre>
<h3 id="4-hyperparameter-tuning"><a class="header" href="#4-hyperparameter-tuning">4. Hyperparameter Tuning</a></h3>
<pre><code class="language-python">from sklearn.model_selection import GridSearchCV, RandomizedSearchCV

# Grid search
param_grid = {
    'C': [0.1, 1, 10],
    'kernel': ['rbf', 'linear'],
    'gamma': ['scale', 'auto']
}

grid_search = GridSearchCV(SVC(), param_grid, cv=5, scoring='accuracy')
grid_search.fit(X_train, y_train)
print(f"Best parameters: {grid_search.best_params_}")
</code></pre>
<h2 id="resources-12"><a class="header" href="#resources-12">Resources</a></h2>
<ul>
<li>scikit-learn documentation: https://scikit-learn.org/</li>
<li>XGBoost documentation: https://xgboost.readthedocs.io/</li>
<li>LightGBM documentation: https://lightgbm.readthedocs.io/</li>
<li>"Introduction to Statistical Learning" by James et al.</li>
<li>"Pattern Recognition and Machine Learning" by Bishop</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="unsupervised-learning-1"><a class="header" href="#unsupervised-learning-1">Unsupervised Learning</a></h1>
<p>Unsupervised learning discovers hidden patterns in data without labeled outputs.</p>
<h2 id="table-of-contents-17"><a class="header" href="#table-of-contents-17">Table of Contents</a></h2>
<ol>
<li><a href="machine_learning/unsupervised_learning.html#clustering">Clustering</a></li>
<li><a href="machine_learning/unsupervised_learning.html#dimensionality-reduction">Dimensionality Reduction</a></li>
<li><a href="machine_learning/unsupervised_learning.html#anomaly-detection">Anomaly Detection</a></li>
<li><a href="machine_learning/unsupervised_learning.html#density-estimation">Density Estimation</a></li>
<li><a href="machine_learning/unsupervised_learning.html#association-rules">Association Rules</a></li>
</ol>
<h2 id="clustering"><a class="header" href="#clustering">Clustering</a></h2>
<p>Clustering groups similar data points together without predefined labels.</p>
<h3 id="k-means-clustering"><a class="header" href="#k-means-clustering">K-Means Clustering</a></h3>
<p>K-Means partitions data into k clusters by minimizing within-cluster variance.</p>
<p><strong>Algorithm:</strong></p>
<ol>
<li>Initialize k centroids randomly</li>
<li>Assign each point to nearest centroid</li>
<li>Update centroids as mean of assigned points</li>
<li>Repeat steps 2-3 until convergence</li>
</ol>
<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from sklearn.cluster import KMeans
from sklearn.datasets import make_blobs

# Generate synthetic data
X, y_true = make_blobs(n_samples=300, centers=4, cluster_std=0.6, random_state=42)

# K-Means clustering
kmeans = KMeans(n_clusters=4, random_state=42, n_init=10)
kmeans.fit(X)

# Predictions
y_pred = kmeans.predict(X)
centers = kmeans.cluster_centers_

# Visualization
plt.figure(figsize=(10, 6))
plt.scatter(X[:, 0], X[:, 1], c=y_pred, cmap='viridis', alpha=0.6)
plt.scatter(centers[:, 0], centers[:, 1], c='red', marker='X', s=200, edgecolors='black')
plt.title('K-Means Clustering')
plt.xlabel('Feature 1')
plt.ylabel('Feature 2')
plt.show()

# Cluster characteristics
print(f"Cluster centers:\n{centers}")
print(f"Inertia (sum of squared distances): {kmeans.inertia_:.2f}")
</code></pre>
<h3 id="choosing-optimal-k"><a class="header" href="#choosing-optimal-k">Choosing Optimal K</a></h3>
<p><strong>Elbow Method:</strong></p>
<pre><code class="language-python">from sklearn.metrics import silhouette_score

# Elbow method
inertias = []
silhouettes = []
K_range = range(2, 11)

for k in K_range:
    kmeans = KMeans(n_clusters=k, random_state=42, n_init=10)
    kmeans.fit(X)
    inertias.append(kmeans.inertia_)
    silhouettes.append(silhouette_score(X, kmeans.labels_))

# Plot elbow curve
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(15, 5))

ax1.plot(K_range, inertias, 'bo-')
ax1.set_xlabel('Number of clusters (k)')
ax1.set_ylabel('Inertia')
ax1.set_title('Elbow Method')
ax1.grid(True)

ax2.plot(K_range, silhouettes, 'ro-')
ax2.set_xlabel('Number of clusters (k)')
ax2.set_ylabel('Silhouette Score')
ax2.set_title('Silhouette Analysis')
ax2.grid(True)

plt.tight_layout()
plt.show()
</code></pre>
<h3 id="k-means"><a class="header" href="#k-means">K-Means++</a></h3>
<p>Improved initialization for K-Means:</p>
<pre><code class="language-python"># K-Means++ (default in scikit-learn)
kmeans_plus = KMeans(n_clusters=4, init='k-means++', random_state=42)
kmeans_plus.fit(X)

# Mini-batch K-Means (faster for large datasets)
from sklearn.cluster import MiniBatchKMeans

mini_kmeans = MiniBatchKMeans(n_clusters=4, random_state=42, batch_size=100)
mini_kmeans.fit(X)
</code></pre>
<h3 id="hierarchical-clustering"><a class="header" href="#hierarchical-clustering">Hierarchical Clustering</a></h3>
<p>Builds a tree of clusters (dendrogram).</p>
<p><strong>Agglomerative (Bottom-up):</strong></p>
<pre><code class="language-python">from sklearn.cluster import AgglomerativeClustering
from scipy.cluster.hierarchy import dendrogram, linkage
from scipy.spatial.distance import pdist

# Agglomerative clustering
agg_clustering = AgglomerativeClustering(
    n_clusters=4,
    linkage='ward'  # 'complete', 'average', 'single'
)
y_pred_agg = agg_clustering.fit_predict(X)

# Create dendrogram
Z = linkage(X, method='ward')
plt.figure(figsize=(12, 6))
dendrogram(Z)
plt.title('Hierarchical Clustering Dendrogram')
plt.xlabel('Sample Index')
plt.ylabel('Distance')
plt.show()

# Different linkage methods
linkage_methods = ['ward', 'complete', 'average', 'single']
for method in linkage_methods:
    agg = AgglomerativeClustering(n_clusters=4, linkage=method)
    labels = agg.fit_predict(X)
    print(f"{method.capitalize()} linkage - Silhouette: {silhouette_score(X, labels):.3f}")
</code></pre>
<h3 id="dbscan"><a class="header" href="#dbscan">DBSCAN</a></h3>
<p>Density-Based Spatial Clustering finds core samples of high density.</p>
<pre><code class="language-python">from sklearn.cluster import DBSCAN

# DBSCAN
dbscan = DBSCAN(eps=0.5, min_samples=5)
y_pred_dbscan = dbscan.fit_predict(X)

# Number of clusters (excluding noise points labeled as -1)
n_clusters = len(set(y_pred_dbscan)) - (1 if -1 in y_pred_dbscan else 0)
n_noise = list(y_pred_dbscan).count(-1)

print(f"Number of clusters: {n_clusters}")
print(f"Number of noise points: {n_noise}")

# Visualization
plt.figure(figsize=(10, 6))
unique_labels = set(y_pred_dbscan)
colors = [plt.cm.Spectral(each) for each in np.linspace(0, 1, len(unique_labels))]

for k, col in zip(unique_labels, colors):
    if k == -1:
        col = [0, 0, 0, 1]  # Black for noise
    
    class_member_mask = (y_pred_dbscan == k)
    xy = X[class_member_mask]
    plt.plot(xy[:, 0], xy[:, 1], 'o', markerfacecolor=tuple(col),
             markeredgecolor='k', markersize=6)

plt.title(f'DBSCAN Clustering\n{n_clusters} clusters, {n_noise} noise points')
plt.show()

# Grid search for optimal parameters
from sklearn.model_selection import ParameterGrid

param_grid = {
    'eps': [0.3, 0.5, 0.7, 1.0],
    'min_samples': [3, 5, 10]
}

best_score = -1
best_params = None

for params in ParameterGrid(param_grid):
    dbscan = DBSCAN(**params)
    labels = dbscan.fit_predict(X)
    
    # Skip if all points are noise or only one cluster
    if len(set(labels)) &lt;= 1:
        continue
    
    score = silhouette_score(X, labels)
    if score &gt; best_score:
        best_score = score
        best_params = params

print(f"Best parameters: {best_params}")
print(f"Best silhouette score: {best_score:.3f}")
</code></pre>
<h3 id="hdbscan"><a class="header" href="#hdbscan">HDBSCAN</a></h3>
<p>Hierarchical DBSCAN with better parameter selection:</p>
<pre><code class="language-python"># pip install hdbscan
import hdbscan

# HDBSCAN
clusterer = hdbscan.HDBSCAN(min_cluster_size=5, min_samples=3)
y_pred_hdbscan = clusterer.fit_predict(X)

# Cluster probabilities
probabilities = clusterer.probabilities_

print(f"Number of clusters: {len(set(y_pred_hdbscan)) - (1 if -1 in y_pred_hdbscan else 0)}")
print(f"Noise points: {list(y_pred_hdbscan).count(-1)}")
</code></pre>
<h3 id="gaussian-mixture-models"><a class="header" href="#gaussian-mixture-models">Gaussian Mixture Models</a></h3>
<p>GMM assumes data is generated from a mixture of Gaussian distributions.</p>
<pre><code class="language-python">from sklearn.mixture import GaussianMixture

# Gaussian Mixture Model
gmm = GaussianMixture(
    n_components=4,
    covariance_type='full',  # 'tied', 'diag', 'spherical'
    random_state=42
)
gmm.fit(X)

# Predictions (hard clustering)
y_pred_gmm = gmm.predict(X)

# Soft clustering (probabilities)
probabilities = gmm.predict_proba(X)
print("Shape of probabilities:", probabilities.shape)

# Model parameters
print(f"Means:\n{gmm.means_}")
print(f"Covariances shape: {gmm.covariances_.shape}")
print(f"Weights: {gmm.weights_}")

# Bayesian Information Criterion (BIC) for model selection
n_components_range = range(2, 11)
bic_scores = []
aic_scores = []

for n_components in n_components_range:
    gmm = GaussianMixture(n_components=n_components, random_state=42)
    gmm.fit(X)
    bic_scores.append(gmm.bic(X))
    aic_scores.append(gmm.aic(X))

plt.figure(figsize=(10, 6))
plt.plot(n_components_range, bic_scores, 'bo-', label='BIC')
plt.plot(n_components_range, aic_scores, 'rs-', label='AIC')
plt.xlabel('Number of components')
plt.ylabel('Information Criterion')
plt.title('GMM Model Selection')
plt.legend()
plt.grid(True)
plt.show()

optimal_components = n_components_range[np.argmin(bic_scores)]
print(f"Optimal number of components: {optimal_components}")
</code></pre>
<h3 id="mean-shift"><a class="header" href="#mean-shift">Mean Shift</a></h3>
<p>Finds clusters by locating peaks in density.</p>
<pre><code class="language-python">from sklearn.cluster import MeanShift, estimate_bandwidth

# Estimate bandwidth
bandwidth = estimate_bandwidth(X, quantile=0.2, n_samples=500)

# Mean Shift clustering
ms = MeanShift(bandwidth=bandwidth, bin_seeding=True)
ms.fit(X)
y_pred_ms = ms.labels_
cluster_centers = ms.cluster_centers_

n_clusters = len(np.unique(y_pred_ms))
print(f"Number of clusters: {n_clusters}")
</code></pre>
<h3 id="spectral-clustering"><a class="header" href="#spectral-clustering">Spectral Clustering</a></h3>
<p>Uses eigenvalues of similarity matrix for clustering.</p>
<pre><code class="language-python">from sklearn.cluster import SpectralClustering

# Spectral clustering
spectral = SpectralClustering(
    n_clusters=4,
    affinity='rbf',  # 'nearest_neighbors', 'precomputed'
    assign_labels='discretize',  # 'kmeans'
    random_state=42
)
y_pred_spectral = spectral.fit_predict(X)

# Custom affinity matrix
from sklearn.metrics.pairwise import rbf_kernel
affinity_matrix = rbf_kernel(X, gamma=1.0)
spectral_custom = SpectralClustering(n_clusters=4, affinity='precomputed')
y_pred_spectral_custom = spectral_custom.fit_predict(affinity_matrix)
</code></pre>
<h2 id="dimensionality-reduction"><a class="header" href="#dimensionality-reduction">Dimensionality Reduction</a></h2>
<p>Reducing the number of features while preserving important information.</p>
<h3 id="principal-component-analysis-pca"><a class="header" href="#principal-component-analysis-pca">Principal Component Analysis (PCA)</a></h3>
<p>PCA finds orthogonal directions of maximum variance.</p>
<p><strong>Mathematical Formulation:</strong></p>
<pre><code>Maximize: Var(Xw) subject to ||w|| = 1
</code></pre>
<pre><code class="language-python">from sklearn.decomposition import PCA
from sklearn.datasets import load_digits

# Load high-dimensional data
digits = load_digits()
X = digits.data  # 64 features (8x8 images)
y = digits.target

# PCA
pca = PCA(n_components=2)
X_pca = pca.fit_transform(X)

# Explained variance
print(f"Explained variance ratio: {pca.explained_variance_ratio_}")
print(f"Total explained variance: {pca.explained_variance_ratio_.sum():.3f}")

# Visualization
plt.figure(figsize=(10, 6))
scatter = plt.scatter(X_pca[:, 0], X_pca[:, 1], c=y, cmap='tab10', alpha=0.6)
plt.colorbar(scatter)
plt.xlabel(f'PC1 ({pca.explained_variance_ratio_[0]:.2%} variance)')
plt.ylabel(f'PC2 ({pca.explained_variance_ratio_[1]:.2%} variance)')
plt.title('PCA of Digits Dataset')
plt.show()

# Determine number of components
pca_full = PCA()
pca_full.fit(X)

# Cumulative explained variance
cumsum_var = np.cumsum(pca_full.explained_variance_ratio_)
n_components_95 = np.argmax(cumsum_var &gt;= 0.95) + 1

plt.figure(figsize=(10, 6))
plt.plot(range(1, len(cumsum_var) + 1), cumsum_var, 'bo-')
plt.axhline(y=0.95, color='r', linestyle='--', label='95% variance')
plt.axvline(x=n_components_95, color='g', linestyle='--', 
            label=f'{n_components_95} components')
plt.xlabel('Number of Components')
plt.ylabel('Cumulative Explained Variance')
plt.title('PCA Explained Variance')
plt.legend()
plt.grid(True)
plt.show()

print(f"Components needed for 95% variance: {n_components_95}")

# Incremental PCA for large datasets
from sklearn.decomposition import IncrementalPCA

ipca = IncrementalPCA(n_components=10, batch_size=100)
X_ipca = ipca.fit_transform(X)

# Kernel PCA for non-linear dimensionality reduction
from sklearn.decomposition import KernelPCA

kpca = KernelPCA(n_components=2, kernel='rbf', gamma=0.04)
X_kpca = kpca.fit_transform(X)
</code></pre>
<h3 id="t-sne"><a class="header" href="#t-sne">t-SNE</a></h3>
<p>t-Distributed Stochastic Neighbor Embedding for visualization.</p>
<pre><code class="language-python">from sklearn.manifold import TSNE

# t-SNE
tsne = TSNE(
    n_components=2,
    perplexity=30,
    learning_rate=200,
    n_iter=1000,
    random_state=42
)
X_tsne = tsne.fit_transform(X)

# Visualization
plt.figure(figsize=(10, 6))
scatter = plt.scatter(X_tsne[:, 0], X_tsne[:, 1], c=y, cmap='tab10', alpha=0.6)
plt.colorbar(scatter)
plt.title('t-SNE of Digits Dataset')
plt.xlabel('t-SNE 1')
plt.ylabel('t-SNE 2')
plt.show()

# Try different perplexities
fig, axes = plt.subplots(2, 2, figsize=(15, 15))
perplexities = [5, 30, 50, 100]

for ax, perplexity in zip(axes.ravel(), perplexities):
    tsne = TSNE(n_components=2, perplexity=perplexity, random_state=42)
    X_embedded = tsne.fit_transform(X)
    
    scatter = ax.scatter(X_embedded[:, 0], X_embedded[:, 1], c=y, 
                        cmap='tab10', alpha=0.6)
    ax.set_title(f'Perplexity = {perplexity}')

plt.tight_layout()
plt.show()
</code></pre>
<h3 id="umap"><a class="header" href="#umap">UMAP</a></h3>
<p>Uniform Manifold Approximation and Projection (faster than t-SNE).</p>
<pre><code class="language-python"># pip install umap-learn
import umap

# UMAP
reducer = umap.UMAP(
    n_components=2,
    n_neighbors=15,
    min_dist=0.1,
    metric='euclidean',
    random_state=42
)
X_umap = reducer.fit_transform(X)

# Visualization
plt.figure(figsize=(10, 6))
scatter = plt.scatter(X_umap[:, 0], X_umap[:, 1], c=y, cmap='tab10', alpha=0.6)
plt.colorbar(scatter)
plt.title('UMAP of Digits Dataset')
plt.xlabel('UMAP 1')
plt.ylabel('UMAP 2')
plt.show()

# Compare PCA, t-SNE, and UMAP
fig, axes = plt.subplots(1, 3, figsize=(18, 5))

methods = [
    ('PCA', X_pca),
    ('t-SNE', X_tsne),
    ('UMAP', X_umap)
]

for ax, (name, X_reduced) in zip(axes, methods):
    scatter = ax.scatter(X_reduced[:, 0], X_reduced[:, 1], c=y, 
                        cmap='tab10', alpha=0.6)
    ax.set_title(name)
    ax.set_xlabel(f'{name} 1')
    ax.set_ylabel(f'{name} 2')

plt.tight_layout()
plt.show()
</code></pre>
<h3 id="linear-discriminant-analysis-lda"><a class="header" href="#linear-discriminant-analysis-lda">Linear Discriminant Analysis (LDA)</a></h3>
<p>Supervised dimensionality reduction that maximizes class separability.</p>
<pre><code class="language-python">from sklearn.discriminant_analysis import LinearDiscriminantAnalysis

# LDA (requires labels)
lda = LinearDiscriminantAnalysis(n_components=2)
X_lda = lda.fit_transform(X, y)

# Explained variance ratio
print(f"Explained variance ratio: {lda.explained_variance_ratio_}")

# Visualization
plt.figure(figsize=(10, 6))
scatter = plt.scatter(X_lda[:, 0], X_lda[:, 1], c=y, cmap='tab10', alpha=0.6)
plt.colorbar(scatter)
plt.xlabel(f'LD1 ({lda.explained_variance_ratio_[0]:.2%})')
plt.ylabel(f'LD2 ({lda.explained_variance_ratio_[1]:.2%})')
plt.title('LDA of Digits Dataset')
plt.show()
</code></pre>
<h3 id="autoencoders"><a class="header" href="#autoencoders">Autoencoders</a></h3>
<p>Neural network-based dimensionality reduction.</p>
<pre><code class="language-python">import torch
import torch.nn as nn
import torch.optim as optim
from torch.utils.data import DataLoader, TensorDataset

# Define autoencoder
class Autoencoder(nn.Module):
    def __init__(self, input_dim, encoding_dim):
        super(Autoencoder, self).__init__()
        
        # Encoder
        self.encoder = nn.Sequential(
            nn.Linear(input_dim, 128),
            nn.ReLU(),
            nn.Linear(128, 64),
            nn.ReLU(),
            nn.Linear(64, encoding_dim)
        )
        
        # Decoder
        self.decoder = nn.Sequential(
            nn.Linear(encoding_dim, 64),
            nn.ReLU(),
            nn.Linear(64, 128),
            nn.ReLU(),
            nn.Linear(128, input_dim),
            nn.Sigmoid()
        )
    
    def forward(self, x):
        encoded = self.encoder(x)
        decoded = self.decoder(encoded)
        return decoded
    
    def encode(self, x):
        return self.encoder(x)

# Prepare data
X_normalized = (X - X.min()) / (X.max() - X.min())
X_tensor = torch.FloatTensor(X_normalized)
dataset = TensorDataset(X_tensor, X_tensor)
dataloader = DataLoader(dataset, batch_size=32, shuffle=True)

# Initialize model
input_dim = X.shape[1]
encoding_dim = 2
model = Autoencoder(input_dim, encoding_dim)
criterion = nn.MSELoss()
optimizer = optim.Adam(model.parameters(), lr=0.001)

# Train
n_epochs = 50
for epoch in range(n_epochs):
    total_loss = 0
    for batch_x, _ in dataloader:
        optimizer.zero_grad()
        outputs = model(batch_x)
        loss = criterion(outputs, batch_x)
        loss.backward()
        optimizer.step()
        total_loss += loss.item()
    
    if (epoch + 1) % 10 == 0:
        print(f'Epoch [{epoch+1}/{n_epochs}], Loss: {total_loss/len(dataloader):.4f}')

# Get encoded representations
model.eval()
with torch.no_grad():
    X_encoded = model.encode(X_tensor).numpy()

# Visualization
plt.figure(figsize=(10, 6))
scatter = plt.scatter(X_encoded[:, 0], X_encoded[:, 1], c=y, cmap='tab10', alpha=0.6)
plt.colorbar(scatter)
plt.title('Autoencoder Dimensionality Reduction')
plt.xlabel('Encoded Dimension 1')
plt.ylabel('Encoded Dimension 2')
plt.show()
</code></pre>
<h3 id="non-negative-matrix-factorization-nmf"><a class="header" href="#non-negative-matrix-factorization-nmf">Non-negative Matrix Factorization (NMF)</a></h3>
<p>Decomposes data into non-negative components.</p>
<pre><code class="language-python">from sklearn.decomposition import NMF

# NMF (requires non-negative data)
X_nonneg = X - X.min() + 1e-10
nmf = NMF(n_components=10, init='random', random_state=42, max_iter=500)
W = nmf.fit_transform(X_nonneg)  # Coefficient matrix
H = nmf.components_  # Component matrix

print(f"Reconstruction error: {nmf.reconstruction_err_:.2f}")
print(f"W shape: {W.shape}, H shape: {H.shape}")

# Visualize components
fig, axes = plt.subplots(2, 5, figsize=(15, 6))
for i, ax in enumerate(axes.ravel()):
    ax.imshow(H[i].reshape(8, 8), cmap='gray')
    ax.set_title(f'Component {i+1}')
    ax.axis('off')
plt.tight_layout()
plt.show()
</code></pre>
<h3 id="truncated-svd"><a class="header" href="#truncated-svd">Truncated SVD</a></h3>
<p>Similar to PCA but works with sparse matrices.</p>
<pre><code class="language-python">from sklearn.decomposition import TruncatedSVD

# Truncated SVD
svd = TruncatedSVD(n_components=10, random_state=42)
X_svd = svd.fit_transform(X)

print(f"Explained variance ratio: {svd.explained_variance_ratio_}")
print(f"Total explained variance: {svd.explained_variance_ratio_.sum():.3f}")
</code></pre>
<h2 id="anomaly-detection"><a class="header" href="#anomaly-detection">Anomaly Detection</a></h2>
<p>Identifying unusual patterns that don't conform to expected behavior.</p>
<h3 id="isolation-forest"><a class="header" href="#isolation-forest">Isolation Forest</a></h3>
<pre><code class="language-python">from sklearn.ensemble import IsolationForest

# Isolation Forest
iso_forest = IsolationForest(
    n_estimators=100,
    contamination=0.1,  # Expected proportion of outliers
    random_state=42
)
y_pred_outliers = iso_forest.fit_predict(X)

# -1 for outliers, 1 for inliers
n_outliers = (y_pred_outliers == -1).sum()
print(f"Number of outliers detected: {n_outliers}")

# Anomaly scores
anomaly_scores = iso_forest.score_samples(X)

# Visualization
plt.figure(figsize=(10, 6))
scatter = plt.scatter(X_pca[:, 0], X_pca[:, 1], c=anomaly_scores, cmap='RdYlGn')
plt.colorbar(scatter, label='Anomaly Score')
plt.title('Isolation Forest Anomaly Scores')
plt.xlabel('PC1')
plt.ylabel('PC2')
plt.show()
</code></pre>
<h3 id="local-outlier-factor-lof"><a class="header" href="#local-outlier-factor-lof">Local Outlier Factor (LOF)</a></h3>
<pre><code class="language-python">from sklearn.neighbors import LocalOutlierFactor

# Local Outlier Factor
lof = LocalOutlierFactor(n_neighbors=20, contamination=0.1)
y_pred_lof = lof.fit_predict(X)

# Negative outlier factor (lower values = more anomalous)
outlier_scores = lof.negative_outlier_factor_

n_outliers = (y_pred_lof == -1).sum()
print(f"Number of outliers detected: {n_outliers}")
</code></pre>
<h3 id="one-class-svm"><a class="header" href="#one-class-svm">One-Class SVM</a></h3>
<pre><code class="language-python">from sklearn.svm import OneClassSVM

# One-Class SVM
oc_svm = OneClassSVM(nu=0.1, kernel='rbf', gamma='auto')
y_pred_oc = oc_svm.fit_predict(X)

n_outliers = (y_pred_oc == -1).sum()
print(f"Number of outliers detected: {n_outliers}")
</code></pre>
<h3 id="elliptic-envelope"><a class="header" href="#elliptic-envelope">Elliptic Envelope</a></h3>
<pre><code class="language-python">from sklearn.covariance import EllipticEnvelope

# Elliptic Envelope (assumes Gaussian distribution)
elliptic = EllipticEnvelope(contamination=0.1, random_state=42)
y_pred_elliptic = elliptic.fit_predict(X)

n_outliers = (y_pred_elliptic == -1).sum()
print(f"Number of outliers detected: {n_outliers}")
</code></pre>
<h2 id="density-estimation"><a class="header" href="#density-estimation">Density Estimation</a></h2>
<p>Estimating the probability density function of data.</p>
<h3 id="kernel-density-estimation"><a class="header" href="#kernel-density-estimation">Kernel Density Estimation</a></h3>
<pre><code class="language-python">from sklearn.neighbors import KernelDensity

# Kernel Density Estimation
kde = KernelDensity(kernel='gaussian', bandwidth=0.5)
kde.fit(X)

# Score samples (log-likelihood)
log_density = kde.score_samples(X)

# Sample from the learned distribution
samples = kde.sample(100, random_state=42)

# Visualization (for 2D data)
if X.shape[1] == 2:
    xx, yy = np.meshgrid(np.linspace(X[:, 0].min(), X[:, 0].max(), 100),
                         np.linspace(X[:, 1].min(), X[:, 1].max(), 100))
    Z = np.exp(kde.score_samples(np.c_[xx.ravel(), yy.ravel()]))
    Z = Z.reshape(xx.shape)
    
    plt.figure(figsize=(10, 6))
    plt.contourf(xx, yy, Z, levels=20, cmap='viridis', alpha=0.6)
    plt.scatter(X[:, 0], X[:, 1], c='red', alpha=0.3, s=10)
    plt.colorbar(label='Density')
    plt.title('Kernel Density Estimation')
    plt.show()
</code></pre>
<h2 id="association-rules"><a class="header" href="#association-rules">Association Rules</a></h2>
<p>Finding interesting relationships between variables.</p>
<h3 id="apriori-algorithm"><a class="header" href="#apriori-algorithm">Apriori Algorithm</a></h3>
<pre><code class="language-python"># pip install mlxtend
from mlxtend.frequent_patterns import apriori, association_rules
import pandas as pd

# Example transaction data
transactions = [
    ['milk', 'bread', 'butter'],
    ['milk', 'bread'],
    ['milk', 'butter'],
    ['bread', 'butter'],
    ['milk', 'bread', 'butter', 'cheese'],
    ['milk', 'cheese'],
    ['bread', 'cheese']
]

# Convert to one-hot encoded DataFrame
from mlxtend.preprocessing import TransactionEncoder

te = TransactionEncoder()
te_array = te.fit(transactions).transform(transactions)
df = pd.DataFrame(te_array, columns=te.columns_)

# Find frequent itemsets
frequent_itemsets = apriori(df, min_support=0.3, use_colnames=True)
print("Frequent Itemsets:")
print(frequent_itemsets)

# Generate association rules
rules = association_rules(frequent_itemsets, metric='confidence', min_threshold=0.5)
print("\nAssociation Rules:")
print(rules[['antecedents', 'consequents', 'support', 'confidence', 'lift']])

# Filter interesting rules
interesting_rules = rules[(rules['lift'] &gt; 1) &amp; (rules['confidence'] &gt; 0.6)]
print("\nInteresting Rules:")
print(interesting_rules)
</code></pre>
<h2 id="clustering-evaluation-metrics"><a class="header" href="#clustering-evaluation-metrics">Clustering Evaluation Metrics</a></h2>
<pre><code class="language-python">from sklearn.metrics import (
    silhouette_score, davies_bouldin_score, 
    calinski_harabasz_score, adjusted_rand_score
)

# Silhouette Score (higher is better, range: [-1, 1])
silhouette = silhouette_score(X, y_pred)

# Davies-Bouldin Index (lower is better)
davies_bouldin = davies_bouldin_score(X, y_pred)

# Calinski-Harabasz Index (higher is better)
calinski_harabasz = calinski_harabasz_score(X, y_pred)

# Adjusted Rand Index (if true labels available)
ari = adjusted_rand_score(y_true, y_pred)

print(f"Silhouette Score: {silhouette:.3f}")
print(f"Davies-Bouldin Index: {davies_bouldin:.3f}")
print(f"Calinski-Harabasz Index: {calinski_harabasz:.3f}")
print(f"Adjusted Rand Index: {ari:.3f}")

# Silhouette analysis per sample
from sklearn.metrics import silhouette_samples

silhouette_vals = silhouette_samples(X, y_pred)

# Visualize silhouette scores
fig, ax = plt.subplots(figsize=(10, 6))
y_lower = 10

for i in range(len(set(y_pred))):
    cluster_silhouette_vals = silhouette_vals[y_pred == i]
    cluster_silhouette_vals.sort()
    
    size_cluster_i = cluster_silhouette_vals.shape[0]
    y_upper = y_lower + size_cluster_i
    
    ax.fill_betweenx(np.arange(y_lower, y_upper),
                     0, cluster_silhouette_vals,
                     alpha=0.7)
    
    ax.text(-0.05, y_lower + 0.5 * size_cluster_i, str(i))
    y_lower = y_upper + 10

ax.set_xlabel("Silhouette Coefficient")
ax.set_ylabel("Cluster")
ax.axvline(x=silhouette, color="red", linestyle="--")
ax.set_title("Silhouette Analysis")
plt.show()
</code></pre>
<h2 id="practical-tips-3"><a class="header" href="#practical-tips-3">Practical Tips</a></h2>
<h3 id="1-feature-scaling"><a class="header" href="#1-feature-scaling">1. Feature Scaling</a></h3>
<pre><code class="language-python"># Always scale features for distance-based methods
from sklearn.preprocessing import StandardScaler

scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)
</code></pre>
<h3 id="2-handling-high-dimensional-data"><a class="header" href="#2-handling-high-dimensional-data">2. Handling High-Dimensional Data</a></h3>
<pre><code class="language-python"># Apply dimensionality reduction before clustering
pca = PCA(n_components=0.95)  # Keep 95% variance
X_reduced = pca.fit_transform(X_scaled)
kmeans = KMeans(n_clusters=4)
kmeans.fit(X_reduced)
</code></pre>
<h3 id="3-visualizing-clusters"><a class="header" href="#3-visualizing-clusters">3. Visualizing Clusters</a></h3>
<pre><code class="language-python">def plot_clusters_3d(X, labels, title='3D Cluster Visualization'):
    from mpl_toolkits.mplot3d import Axes3D
    
    # Reduce to 3D if needed
    if X.shape[1] &gt; 3:
        pca = PCA(n_components=3)
        X = pca.fit_transform(X)
    
    fig = plt.figure(figsize=(12, 8))
    ax = fig.add_subplot(111, projection='3d')
    scatter = ax.scatter(X[:, 0], X[:, 1], X[:, 2], c=labels, cmap='viridis')
    ax.set_title(title)
    plt.colorbar(scatter)
    plt.show()
</code></pre>
<h2 id="resources-13"><a class="header" href="#resources-13">Resources</a></h2>
<ul>
<li>scikit-learn documentation: https://scikit-learn.org/</li>
<li>"Pattern Recognition and Machine Learning" by Christopher Bishop</li>
<li>"Introduction to Data Mining" by Tan, Steinbach, Kumar</li>
<li>UMAP documentation: https://umap-learn.readthedocs.io/</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="reinforcement-learning-1"><a class="header" href="#reinforcement-learning-1">Reinforcement Learning</a></h1>
<p>Reinforcement Learning (RL) is about learning to make decisions by interacting with an environment to maximize cumulative reward.</p>
<h2 id="table-of-contents-18"><a class="header" href="#table-of-contents-18">Table of Contents</a></h2>
<ol>
<li><a href="machine_learning/reinforcement_learning.html#core-concepts">Core Concepts</a></li>
<li><a href="machine_learning/reinforcement_learning.html#markov-decision-processes">Markov Decision Processes</a></li>
<li><a href="machine_learning/reinforcement_learning.html#dynamic-programming">Dynamic Programming</a></li>
<li><a href="machine_learning/reinforcement_learning.html#monte-carlo-methods">Monte Carlo Methods</a></li>
<li><a href="machine_learning/reinforcement_learning.html#temporal-difference-learning">Temporal Difference Learning</a></li>
<li><a href="machine_learning/reinforcement_learning.html#q-learning">Q-Learning</a></li>
<li><a href="machine_learning/reinforcement_learning.html#sarsa">SARSA</a></li>
<li><a href="machine_learning/reinforcement_learning.html#policy-gradient-methods">Policy Gradient Methods</a></li>
<li><a href="machine_learning/reinforcement_learning.html#actor-critic-methods">Actor-Critic Methods</a></li>
<li><a href="machine_learning/reinforcement_learning.html#multi-armed-bandits">Multi-Armed Bandits</a></li>
</ol>
<h2 id="core-concepts-1"><a class="header" href="#core-concepts-1">Core Concepts</a></h2>
<h3 id="the-rl-framework"><a class="header" href="#the-rl-framework">The RL Framework</a></h3>
<p><strong>Key Components:</strong></p>
<ul>
<li><strong>Agent</strong>: The learner/decision maker</li>
<li><strong>Environment</strong>: What the agent interacts with</li>
<li><strong>State (s)</strong>: Current situation</li>
<li><strong>Action (a)</strong>: What the agent can do</li>
<li><strong>Reward (r)</strong>: Feedback signal</li>
<li><strong>Policy (π)</strong>: Strategy for selecting actions</li>
<li><strong>Value Function (V)</strong>: Expected future reward from a state</li>
<li><strong>Q-Function (Q)</strong>: Expected future reward for state-action pairs</li>
</ul>
<p><strong>Mathematical Framework:</strong></p>
<pre><code>At each time step t:
- Agent observes state s_t
- Agent takes action a_t
- Environment transitions to s_{t+1}
- Agent receives reward r_{t+1}
</code></pre>
<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

# Simple RL environment example
class GridWorld:
    def __init__(self, size=5):
        self.size = size
        self.state = (0, 0)
        self.goal = (size-1, size-1)
        
    def reset(self):
        self.state = (0, 0)
        return self.state
    
    def step(self, action):
        # Actions: 0=up, 1=right, 2=down, 3=left
        x, y = self.state
        
        if action == 0:  # up
            x = max(0, x - 1)
        elif action == 1:  # right
            y = min(self.size - 1, y + 1)
        elif action == 2:  # down
            x = min(self.size - 1, x + 1)
        elif action == 3:  # left
            y = max(0, y - 1)
        
        self.state = (x, y)
        
        # Reward
        if self.state == self.goal:
            reward = 1.0
            done = True
        else:
            reward = -0.01  # Small penalty for each step
            done = False
        
        return self.state, reward, done
    
    def render(self):
        grid = np.zeros((self.size, self.size))
        grid[self.state] = 1
        grid[self.goal] = 0.5
        plt.imshow(grid, cmap='hot')
        plt.title(f'State: {self.state}')
        plt.show()

# Example usage
env = GridWorld(size=5)
state = env.reset()
print(f"Initial state: {state}")

# Take random actions
for _ in range(5):
    action = np.random.randint(0, 4)
    state, reward, done = env.step(action)
    print(f"State: {state}, Reward: {reward}, Done: {done}")
    if done:
        break
</code></pre>
<h3 id="return-and-discounting"><a class="header" href="#return-and-discounting">Return and Discounting</a></h3>
<p><strong>Return (G_t)</strong>: Total cumulative reward from time t</p>
<pre><code>G_t = R_{t+1} + γR_{t+2} + γ²R_{t+3} + ... = Σ_{k=0}^∞ γ^k R_{t+k+1}
</code></pre>
<p>Where γ (gamma) is the discount factor (0 ≤ γ ≤ 1):</p>
<ul>
<li>γ = 0: Only immediate rewards matter</li>
<li>γ = 1: All future rewards equally important</li>
<li>γ closer to 1: More far-sighted agent</li>
</ul>
<pre><code class="language-python">def calculate_return(rewards, gamma=0.99):
    """Calculate discounted return from a list of rewards"""
    G = 0
    returns = []
    for r in reversed(rewards):
        G = r + gamma * G
        returns.insert(0, G)
    return returns

# Example
rewards = [1, 0, 0, 1, 0]
returns = calculate_return(rewards, gamma=0.9)
print(f"Rewards: {rewards}")
print(f"Returns: {returns}")
</code></pre>
<h2 id="markov-decision-processes"><a class="header" href="#markov-decision-processes">Markov Decision Processes</a></h2>
<p>An MDP is defined by a tuple (S, A, P, R, γ):</p>
<ul>
<li><strong>S</strong>: Set of states</li>
<li><strong>A</strong>: Set of actions</li>
<li><strong>P</strong>: Transition probability P(s'|s,a)</li>
<li><strong>R</strong>: Reward function R(s,a,s')</li>
<li><strong>γ</strong>: Discount factor</li>
</ul>
<p><strong>Markov Property</strong>: Future depends only on current state, not history</p>
<pre><code>P(s_{t+1}|s_t, a_t, s_{t-1}, a_{t-1}, ...) = P(s_{t+1}|s_t, a_t)
</code></pre>
<pre><code class="language-python">class MDP:
    def __init__(self, states, actions, transitions, rewards, gamma=0.99):
        self.states = states
        self.actions = actions
        self.transitions = transitions  # P(s'|s,a)
        self.rewards = rewards          # R(s,a,s')
        self.gamma = gamma
    
    def get_transition_prob(self, state, action, next_state):
        return self.transitions.get((state, action, next_state), 0.0)
    
    def get_reward(self, state, action, next_state):
        return self.rewards.get((state, action, next_state), 0.0)

# Example: Simple MDP
states = ['s0', 's1', 's2']
actions = ['a0', 'a1']

transitions = {
    ('s0', 'a0', 's1'): 0.8,
    ('s0', 'a0', 's0'): 0.2,
    ('s0', 'a1', 's2'): 0.9,
    ('s0', 'a1', 's0'): 0.1,
    ('s1', 'a0', 's2'): 1.0,
    ('s2', 'a0', 's2'): 1.0,
}

rewards = {
    ('s0', 'a0', 's1'): -1,
    ('s0', 'a1', 's2'): 10,
    ('s1', 'a0', 's2'): 5,
}

mdp = MDP(states, actions, transitions, rewards)
</code></pre>
<h3 id="value-functions"><a class="header" href="#value-functions">Value Functions</a></h3>
<p><strong>State-Value Function V^π(s):</strong></p>
<pre><code>V^π(s) = E_π[G_t | S_t = s]
       = E_π[Σ_{k=0}^∞ γ^k R_{t+k+1} | S_t = s]
</code></pre>
<p><strong>Action-Value Function Q^π(s,a):</strong></p>
<pre><code>Q^π(s,a) = E_π[G_t | S_t = s, A_t = a]
</code></pre>
<p><strong>Bellman Equations:</strong></p>
<pre><code>V^π(s) = Σ_a π(a|s) Σ_{s',r} p(s',r|s,a)[r + γV^π(s')]
Q^π(s,a) = Σ_{s',r} p(s',r|s,a)[r + γΣ_{a'} π(a'|s')Q^π(s',a')]
</code></pre>
<p><strong>Optimal Value Functions:</strong></p>
<pre><code>V*(s) = max_π V^π(s) = max_a Q*(s,a)
Q*(s,a) = E[R_{t+1} + γV*(S_{t+1}) | S_t=s, A_t=a]
</code></pre>
<h2 id="dynamic-programming-1"><a class="header" href="#dynamic-programming-1">Dynamic Programming</a></h2>
<p>DP methods assume full knowledge of the MDP.</p>
<h3 id="policy-evaluation"><a class="header" href="#policy-evaluation">Policy Evaluation</a></h3>
<p>Compute value function for a given policy.</p>
<pre><code class="language-python">def policy_evaluation(policy, mdp, theta=1e-6):
    """
    Evaluate a policy using iterative policy evaluation
    
    Args:
        policy: dict mapping states to action probabilities
        mdp: MDP object
        theta: convergence threshold
    """
    V = {s: 0 for s in mdp.states}
    
    while True:
        delta = 0
        for s in mdp.states:
            v = V[s]
            new_v = 0
            
            # Sum over actions
            for a in mdp.actions:
                action_prob = policy.get((s, a), 0)
                
                # Sum over next states
                for s_prime in mdp.states:
                    trans_prob = mdp.get_transition_prob(s, a, s_prime)
                    reward = mdp.get_reward(s, a, s_prime)
                    new_v += action_prob * trans_prob * (reward + mdp.gamma * V[s_prime])
            
            V[s] = new_v
            delta = max(delta, abs(v - V[s]))
        
        if delta &lt; theta:
            break
    
    return V

# Example: Uniform random policy
random_policy = {
    ('s0', 'a0'): 0.5,
    ('s0', 'a1'): 0.5,
    ('s1', 'a0'): 1.0,
    ('s2', 'a0'): 1.0,
}

V = policy_evaluation(random_policy, mdp)
print("State values:", V)
</code></pre>
<h3 id="policy-iteration"><a class="header" href="#policy-iteration">Policy Iteration</a></h3>
<pre><code class="language-python">def policy_iteration(mdp, theta=1e-6):
    """
    Find optimal policy using policy iteration
    """
    # Initialize random policy
    policy = {}
    for s in mdp.states:
        action = np.random.choice(mdp.actions)
        for a in mdp.actions:
            policy[(s, a)] = 1.0 if a == action else 0.0
    
    while True:
        # Policy Evaluation
        V = policy_evaluation(policy, mdp, theta)
        
        # Policy Improvement
        policy_stable = True
        
        for s in mdp.states:
            old_action = None
            for a in mdp.actions:
                if policy.get((s, a), 0) == 1.0:
                    old_action = a
                    break
            
            # Find best action
            action_values = {}
            for a in mdp.actions:
                q = 0
                for s_prime in mdp.states:
                    trans_prob = mdp.get_transition_prob(s, a, s_prime)
                    reward = mdp.get_reward(s, a, s_prime)
                    q += trans_prob * (reward + mdp.gamma * V[s_prime])
                action_values[a] = q
            
            best_action = max(action_values, key=action_values.get)
            
            # Update policy
            for a in mdp.actions:
                policy[(s, a)] = 1.0 if a == best_action else 0.0
            
            if best_action != old_action:
                policy_stable = False
        
        if policy_stable:
            break
    
    return policy, V

optimal_policy, optimal_V = policy_iteration(mdp)
print("Optimal policy:", optimal_policy)
print("Optimal values:", optimal_V)
</code></pre>
<h3 id="value-iteration"><a class="header" href="#value-iteration">Value Iteration</a></h3>
<pre><code class="language-python">def value_iteration(mdp, theta=1e-6):
    """
    Find optimal policy using value iteration
    """
    V = {s: 0 for s in mdp.states}
    
    while True:
        delta = 0
        for s in mdp.states:
            v = V[s]
            
            # Find max over actions
            action_values = []
            for a in mdp.actions:
                q = 0
                for s_prime in mdp.states:
                    trans_prob = mdp.get_transition_prob(s, a, s_prime)
                    reward = mdp.get_reward(s, a, s_prime)
                    q += trans_prob * (reward + mdp.gamma * V[s_prime])
                action_values.append(q)
            
            V[s] = max(action_values) if action_values else 0
            delta = max(delta, abs(v - V[s]))
        
        if delta &lt; theta:
            break
    
    # Extract policy
    policy = {}
    for s in mdp.states:
        action_values = {}
        for a in mdp.actions:
            q = 0
            for s_prime in mdp.states:
                trans_prob = mdp.get_transition_prob(s, a, s_prime)
                reward = mdp.get_reward(s, a, s_prime)
                q += trans_prob * (reward + mdp.gamma * V[s_prime])
            action_values[a] = q
        
        best_action = max(action_values, key=action_values.get)
        for a in mdp.actions:
            policy[(s, a)] = 1.0 if a == best_action else 0.0
    
    return policy, V

optimal_policy, optimal_V = value_iteration(mdp)
</code></pre>
<h2 id="monte-carlo-methods"><a class="header" href="#monte-carlo-methods">Monte Carlo Methods</a></h2>
<p>MC methods learn from complete episodes without needing environment model.</p>
<h3 id="first-visit-mc-prediction"><a class="header" href="#first-visit-mc-prediction">First-Visit MC Prediction</a></h3>
<pre><code class="language-python">def first_visit_mc_prediction(env, policy, num_episodes=1000, gamma=0.99):
    """
    Estimate state-value function using first-visit MC
    """
    returns = {s: [] for s in env.states}
    V = {s: 0 for s in env.states}
    
    for episode in range(num_episodes):
        # Generate episode
        episode_data = []
        state = env.reset()
        done = False
        
        while not done:
            action = policy[state]
            next_state, reward, done = env.step(action)
            episode_data.append((state, action, reward))
            state = next_state
        
        # Calculate returns
        G = 0
        visited_states = set()
        
        for t in reversed(range(len(episode_data))):
            state, action, reward = episode_data[t]
            G = reward + gamma * G
            
            # First-visit: only update if state not seen earlier
            if state not in visited_states:
                returns[state].append(G)
                V[state] = np.mean(returns[state])
                visited_states.add(state)
    
    return V

# Example usage with GridWorld
env = GridWorld(size=4)
# Define a simple policy
policy = {state: np.random.randint(0, 4) for state in 
          [(i, j) for i in range(4) for j in range(4)]}

V = first_visit_mc_prediction(env, policy, num_episodes=10000)
</code></pre>
<h3 id="monte-carlo-control-epsilon-greedy"><a class="header" href="#monte-carlo-control-epsilon-greedy">Monte Carlo Control (Epsilon-Greedy)</a></h3>
<pre><code class="language-python">def mc_control_epsilon_greedy(env, num_episodes=10000, gamma=0.99, epsilon=0.1):
    """
    Monte Carlo control with epsilon-greedy policy
    """
    Q = {}
    returns = {}
    
    # Initialize Q-values
    for state in env.get_all_states():
        for action in range(env.num_actions):
            Q[(state, action)] = 0
            returns[(state, action)] = []
    
    for episode in range(num_episodes):
        # Generate episode with epsilon-greedy policy
        episode_data = []
        state = env.reset()
        done = False
        
        while not done:
            # Epsilon-greedy action selection
            if np.random.random() &lt; epsilon:
                action = np.random.randint(0, env.num_actions)
            else:
                q_values = [Q.get((state, a), 0) for a in range(env.num_actions)]
                action = np.argmax(q_values)
            
            next_state, reward, done = env.step(action)
            episode_data.append((state, action, reward))
            state = next_state
        
        # Update Q-values
        G = 0
        visited = set()
        
        for t in reversed(range(len(episode_data))):
            state, action, reward = episode_data[t]
            G = reward + gamma * G
            
            if (state, action) not in visited:
                returns[(state, action)].append(G)
                Q[(state, action)] = np.mean(returns[(state, action)])
                visited.add((state, action))
    
    # Extract policy
    policy = {}
    for state in env.get_all_states():
        q_values = [Q.get((state, a), 0) for a in range(env.num_actions)]
        policy[state] = np.argmax(q_values)
    
    return policy, Q
</code></pre>
<h2 id="temporal-difference-learning"><a class="header" href="#temporal-difference-learning">Temporal Difference Learning</a></h2>
<p>TD methods learn from incomplete episodes by bootstrapping.</p>
<h3 id="td0-prediction"><a class="header" href="#td0-prediction">TD(0) Prediction</a></h3>
<p><strong>TD Update Rule:</strong></p>
<pre><code>V(S_t) ← V(S_t) + α[R_{t+1} + γV(S_{t+1}) - V(S_t)]
</code></pre>
<p>Where:</p>
<ul>
<li>α is the learning rate</li>
<li>R_{t+1} + γV(S_{t+1}) is the TD target</li>
<li>δ_t = R_{t+1} + γV(S_{t+1}) - V(S_t) is the TD error</li>
</ul>
<pre><code class="language-python">def td_0_prediction(env, policy, num_episodes=1000, alpha=0.1, gamma=0.99):
    """
    TD(0) prediction for estimating state values
    """
    V = {s: 0 for s in env.get_all_states()}
    
    for episode in range(num_episodes):
        state = env.reset()
        done = False
        
        while not done:
            action = policy[state]
            next_state, reward, done = env.step(action)
            
            # TD update
            if not done:
                td_target = reward + gamma * V[next_state]
            else:
                td_target = reward
            
            td_error = td_target - V[state]
            V[state] += alpha * td_error
            
            state = next_state
    
    return V
</code></pre>
<h3 id="tdλ---eligibility-traces"><a class="header" href="#tdλ---eligibility-traces">TD(λ) - Eligibility Traces</a></h3>
<pre><code class="language-python">def td_lambda_prediction(env, policy, num_episodes=1000, 
                        alpha=0.1, gamma=0.99, lambda_=0.9):
    """
    TD(λ) prediction with eligibility traces
    """
    V = {s: 0 for s in env.get_all_states()}
    
    for episode in range(num_episodes):
        E = {s: 0 for s in env.get_all_states()}  # Eligibility traces
        state = env.reset()
        done = False
        
        while not done:
            action = policy[state]
            next_state, reward, done = env.step(action)
            
            # Calculate TD error
            if not done:
                td_error = reward + gamma * V[next_state] - V[state]
            else:
                td_error = reward - V[state]
            
            # Update eligibility trace for current state
            E[state] += 1
            
            # Update all states
            for s in env.get_all_states():
                V[s] += alpha * td_error * E[s]
                E[s] *= gamma * lambda_
            
            state = next_state
    
    return V
</code></pre>
<h2 id="q-learning"><a class="header" href="#q-learning">Q-Learning</a></h2>
<p>Q-Learning is an off-policy TD control algorithm.</p>
<p><strong>Q-Learning Update:</strong></p>
<pre><code>Q(S_t, A_t) ← Q(S_t, A_t) + α[R_{t+1} + γ max_a Q(S_{t+1}, a) - Q(S_t, A_t)]
</code></pre>
<pre><code class="language-python">class QLearningAgent:
    def __init__(self, state_space, action_space, alpha=0.1, gamma=0.99, epsilon=0.1):
        self.state_space = state_space
        self.action_space = action_space
        self.alpha = alpha
        self.gamma = gamma
        self.epsilon = epsilon
        
        # Initialize Q-table
        self.q_table = {}
        for state in state_space:
            for action in action_space:
                self.q_table[(state, action)] = 0.0
    
    def get_action(self, state, training=True):
        """Epsilon-greedy action selection"""
        if training and np.random.random() &lt; self.epsilon:
            return np.random.choice(self.action_space)
        else:
            q_values = [self.q_table.get((state, a), 0) for a in self.action_space]
            return self.action_space[np.argmax(q_values)]
    
    def update(self, state, action, reward, next_state, done):
        """Q-learning update"""
        # Current Q-value
        current_q = self.q_table[(state, action)]
        
        # Maximum Q-value for next state
        if not done:
            max_next_q = max([self.q_table.get((next_state, a), 0) 
                            for a in self.action_space])
        else:
            max_next_q = 0
        
        # Q-learning update
        td_target = reward + self.gamma * max_next_q
        td_error = td_target - current_q
        self.q_table[(state, action)] += self.alpha * td_error
        
        return td_error
    
    def train(self, env, num_episodes=1000):
        """Train the agent"""
        episode_rewards = []
        
        for episode in range(num_episodes):
            state = env.reset()
            total_reward = 0
            done = False
            
            while not done:
                action = self.get_action(state, training=True)
                next_state, reward, done = env.step(action)
                
                self.update(state, action, reward, next_state, done)
                
                state = next_state
                total_reward += reward
            
            episode_rewards.append(total_reward)
            
            # Decay epsilon
            self.epsilon = max(0.01, self.epsilon * 0.995)
            
            if (episode + 1) % 100 == 0:
                avg_reward = np.mean(episode_rewards[-100:])
                print(f"Episode {episode + 1}, Avg Reward: {avg_reward:.2f}, Epsilon: {self.epsilon:.3f}")
        
        return episode_rewards

# Example usage
env = GridWorld(size=5)
state_space = [(i, j) for i in range(5) for j in range(5)]
action_space = [0, 1, 2, 3]  # up, right, down, left

agent = QLearningAgent(state_space, action_space)
rewards = agent.train(env, num_episodes=5000)

# Plot learning curve
plt.figure(figsize=(10, 6))
plt.plot(np.convolve(rewards, np.ones(100)/100, mode='valid'))
plt.xlabel('Episode')
plt.ylabel('Average Reward (100 episodes)')
plt.title('Q-Learning Training Progress')
plt.grid(True)
plt.show()
</code></pre>
<h3 id="double-q-learning"><a class="header" href="#double-q-learning">Double Q-Learning</a></h3>
<p>Reduces maximization bias in Q-learning.</p>
<pre><code class="language-python">class DoubleQLearningAgent:
    def __init__(self, state_space, action_space, alpha=0.1, gamma=0.99, epsilon=0.1):
        self.state_space = state_space
        self.action_space = action_space
        self.alpha = alpha
        self.gamma = gamma
        self.epsilon = epsilon
        
        # Two Q-tables
        self.q_table_1 = {(s, a): 0.0 for s in state_space for a in action_space}
        self.q_table_2 = {(s, a): 0.0 for s in state_space for a in action_space}
    
    def get_action(self, state, training=True):
        """Epsilon-greedy using average of both Q-tables"""
        if training and np.random.random() &lt; self.epsilon:
            return np.random.choice(self.action_space)
        else:
            q_values = [(self.q_table_1[(state, a)] + self.q_table_2[(state, a)]) / 2 
                       for a in self.action_space]
            return self.action_space[np.argmax(q_values)]
    
    def update(self, state, action, reward, next_state, done):
        """Double Q-learning update"""
        # Randomly choose which Q-table to update
        if np.random.random() &lt; 0.5:
            q_table_update = self.q_table_1
            q_table_target = self.q_table_2
        else:
            q_table_update = self.q_table_2
            q_table_target = self.q_table_1
        
        current_q = q_table_update[(state, action)]
        
        if not done:
            # Use one Q-table to select action, other to evaluate
            best_action = max(self.action_space, 
                            key=lambda a: q_table_update[(next_state, a)])
            max_next_q = q_table_target[(next_state, best_action)]
        else:
            max_next_q = 0
        
        td_target = reward + self.gamma * max_next_q
        td_error = td_target - current_q
        q_table_update[(state, action)] += self.alpha * td_error
        
        return td_error
</code></pre>
<h2 id="sarsa"><a class="header" href="#sarsa">SARSA</a></h2>
<p>SARSA is an on-policy TD control algorithm.</p>
<p><strong>SARSA Update:</strong></p>
<pre><code>Q(S_t, A_t) ← Q(S_t, A_t) + α[R_{t+1} + γQ(S_{t+1}, A_{t+1}) - Q(S_t, A_t)]
</code></pre>
<pre><code class="language-python">class SARSAAgent:
    def __init__(self, state_space, action_space, alpha=0.1, gamma=0.99, epsilon=0.1):
        self.state_space = state_space
        self.action_space = action_space
        self.alpha = alpha
        self.gamma = gamma
        self.epsilon = epsilon
        
        # Initialize Q-table
        self.q_table = {(s, a): 0.0 for s in state_space for a in action_space}
    
    def get_action(self, state, training=True):
        """Epsilon-greedy action selection"""
        if training and np.random.random() &lt; self.epsilon:
            return np.random.choice(self.action_space)
        else:
            q_values = [self.q_table[(state, a)] for a in self.action_space]
            return self.action_space[np.argmax(q_values)]
    
    def update(self, state, action, reward, next_state, next_action, done):
        """SARSA update"""
        current_q = self.q_table[(state, action)]
        
        if not done:
            next_q = self.q_table[(next_state, next_action)]
        else:
            next_q = 0
        
        td_target = reward + self.gamma * next_q
        td_error = td_target - current_q
        self.q_table[(state, action)] += self.alpha * td_error
        
        return td_error
    
    def train(self, env, num_episodes=1000):
        """Train the agent"""
        episode_rewards = []
        
        for episode in range(num_episodes):
            state = env.reset()
            action = self.get_action(state, training=True)
            total_reward = 0
            done = False
            
            while not done:
                next_state, reward, done = env.step(action)
                next_action = self.get_action(next_state, training=True)
                
                self.update(state, action, reward, next_state, next_action, done)
                
                state = next_state
                action = next_action
                total_reward += reward
            
            episode_rewards.append(total_reward)
            self.epsilon = max(0.01, self.epsilon * 0.995)
        
        return episode_rewards
</code></pre>
<h2 id="policy-gradient-methods"><a class="header" href="#policy-gradient-methods">Policy Gradient Methods</a></h2>
<p>Policy gradient methods directly optimize the policy.</p>
<h3 id="reinforce-algorithm"><a class="header" href="#reinforce-algorithm">REINFORCE Algorithm</a></h3>
<p><strong>Policy Gradient Theorem:</strong></p>
<pre><code>∇_θ J(θ) = E_π[∇_θ log π(a|s,θ) Q^π(s,a)]
</code></pre>
<pre><code class="language-python">import torch
import torch.nn as nn
import torch.optim as optim
import torch.nn.functional as F

class PolicyNetwork(nn.Module):
    def __init__(self, state_dim, action_dim, hidden_dim=64):
        super(PolicyNetwork, self).__init__()
        self.fc1 = nn.Linear(state_dim, hidden_dim)
        self.fc2 = nn.Linear(hidden_dim, hidden_dim)
        self.fc3 = nn.Linear(hidden_dim, action_dim)
    
    def forward(self, x):
        x = F.relu(self.fc1(x))
        x = F.relu(self.fc2(x))
        x = F.softmax(self.fc3(x), dim=-1)
        return x

class REINFORCEAgent:
    def __init__(self, state_dim, action_dim, lr=0.001, gamma=0.99):
        self.gamma = gamma
        self.policy_net = PolicyNetwork(state_dim, action_dim)
        self.optimizer = optim.Adam(self.policy_net.parameters(), lr=lr)
        
        self.saved_log_probs = []
        self.rewards = []
    
    def select_action(self, state):
        """Select action using current policy"""
        state = torch.FloatTensor(state).unsqueeze(0)
        probs = self.policy_net(state)
        action_dist = torch.distributions.Categorical(probs)
        action = action_dist.sample()
        
        # Save log probability for training
        self.saved_log_probs.append(action_dist.log_prob(action))
        
        return action.item()
    
    def update(self):
        """Update policy using REINFORCE"""
        R = 0
        returns = []
        
        # Calculate returns
        for r in reversed(self.rewards):
            R = r + self.gamma * R
            returns.insert(0, R)
        
        # Normalize returns
        returns = torch.tensor(returns)
        returns = (returns - returns.mean()) / (returns.std() + 1e-8)
        
        # Calculate loss
        policy_loss = []
        for log_prob, R in zip(self.saved_log_probs, returns):
            policy_loss.append(-log_prob * R)
        
        # Update policy
        self.optimizer.zero_grad()
        policy_loss = torch.stack(policy_loss).sum()
        policy_loss.backward()
        self.optimizer.step()
        
        # Clear saved values
        self.saved_log_probs = []
        self.rewards = []
        
        return policy_loss.item()
    
    def train(self, env, num_episodes=1000):
        """Train the agent"""
        episode_rewards = []
        
        for episode in range(num_episodes):
            state = env.reset()
            total_reward = 0
            done = False
            
            while not done:
                action = self.select_action(state)
                next_state, reward, done = env.step(action)
                
                self.rewards.append(reward)
                state = next_state
                total_reward += reward
            
            # Update policy after episode
            loss = self.update()
            episode_rewards.append(total_reward)
            
            if (episode + 1) % 100 == 0:
                avg_reward = np.mean(episode_rewards[-100:])
                print(f"Episode {episode + 1}, Avg Reward: {avg_reward:.2f}")
        
        return episode_rewards
</code></pre>
<h2 id="actor-critic-methods"><a class="header" href="#actor-critic-methods">Actor-Critic Methods</a></h2>
<p>Combine value-based and policy-based methods.</p>
<h3 id="advantage-actor-critic-a2c"><a class="header" href="#advantage-actor-critic-a2c">Advantage Actor-Critic (A2C)</a></h3>
<pre><code class="language-python">class ActorCritic(nn.Module):
    def __init__(self, state_dim, action_dim, hidden_dim=64):
        super(ActorCritic, self).__init__()
        
        self.shared = nn.Sequential(
            nn.Linear(state_dim, hidden_dim),
            nn.ReLU()
        )
        
        # Actor (policy)
        self.actor = nn.Sequential(
            nn.Linear(hidden_dim, hidden_dim),
            nn.ReLU(),
            nn.Linear(hidden_dim, action_dim),
            nn.Softmax(dim=-1)
        )
        
        # Critic (value function)
        self.critic = nn.Sequential(
            nn.Linear(hidden_dim, hidden_dim),
            nn.ReLU(),
            nn.Linear(hidden_dim, 1)
        )
    
    def forward(self, x):
        shared_features = self.shared(x)
        action_probs = self.actor(shared_features)
        state_value = self.critic(shared_features)
        return action_probs, state_value

class A2CAgent:
    def __init__(self, state_dim, action_dim, lr=0.001, gamma=0.99):
        self.gamma = gamma
        self.model = ActorCritic(state_dim, action_dim)
        self.optimizer = optim.Adam(self.model.parameters(), lr=lr)
    
    def select_action(self, state):
        """Select action and get state value"""
        state = torch.FloatTensor(state).unsqueeze(0)
        action_probs, state_value = self.model(state)
        action_dist = torch.distributions.Categorical(action_probs)
        action = action_dist.sample()
        
        return action.item(), action_dist.log_prob(action), state_value
    
    def train_step(self, log_prob, value, reward, next_value, done):
        """Single training step"""
        # Calculate advantage
        if done:
            td_target = reward
        else:
            td_target = reward + self.gamma * next_value
        
        advantage = td_target - value
        
        # Actor loss (policy gradient)
        actor_loss = -log_prob * advantage.detach()
        
        # Critic loss (value function)
        critic_loss = F.mse_loss(value, torch.tensor([td_target]))
        
        # Total loss
        loss = actor_loss + critic_loss
        
        # Update
        self.optimizer.zero_grad()
        loss.backward()
        self.optimizer.step()
        
        return loss.item()
</code></pre>
<h2 id="multi-armed-bandits"><a class="header" href="#multi-armed-bandits">Multi-Armed Bandits</a></h2>
<p>Simplified RL problem with one state.</p>
<h3 id="epsilon-greedy-bandit"><a class="header" href="#epsilon-greedy-bandit">Epsilon-Greedy Bandit</a></h3>
<pre><code class="language-python">class EpsilonGreedyBandit:
    def __init__(self, n_arms, epsilon=0.1):
        self.n_arms = n_arms
        self.epsilon = epsilon
        self.q_values = np.zeros(n_arms)  # Estimated action values
        self.action_counts = np.zeros(n_arms)  # Number of times each action selected
    
    def select_action(self):
        """Epsilon-greedy action selection"""
        if np.random.random() &lt; self.epsilon:
            return np.random.randint(self.n_arms)
        else:
            return np.argmax(self.q_values)
    
    def update(self, action, reward):
        """Update Q-value estimate"""
        self.action_counts[action] += 1
        alpha = 1 / self.action_counts[action]
        self.q_values[action] += alpha * (reward - self.q_values[action])

# Test bandit
true_rewards = [0.1, 0.5, 0.3, 0.7, 0.2]
bandit = EpsilonGreedyBandit(n_arms=5, epsilon=0.1)

total_reward = 0
for t in range(1000):
    action = bandit.select_action()
    reward = true_rewards[action] + np.random.normal(0, 0.1)
    bandit.update(action, reward)
    total_reward += reward

print(f"True rewards: {true_rewards}")
print(f"Estimated rewards: {bandit.q_values}")
print(f"Total reward: {total_reward:.2f}")
</code></pre>
<h3 id="upper-confidence-bound-ucb"><a class="header" href="#upper-confidence-bound-ucb">Upper Confidence Bound (UCB)</a></h3>
<pre><code class="language-python">class UCBBandit:
    def __init__(self, n_arms, c=2):
        self.n_arms = n_arms
        self.c = c
        self.q_values = np.zeros(n_arms)
        self.action_counts = np.zeros(n_arms)
        self.t = 0
    
    def select_action(self):
        """UCB action selection"""
        self.t += 1
        
        # Select each arm at least once
        if 0 in self.action_counts:
            return np.argmin(self.action_counts)
        
        # UCB formula
        ucb_values = self.q_values + self.c * np.sqrt(np.log(self.t) / self.action_counts)
        return np.argmax(ucb_values)
    
    def update(self, action, reward):
        """Update Q-value estimate"""
        self.action_counts[action] += 1
        alpha = 1 / self.action_counts[action]
        self.q_values[action] += alpha * (reward - self.q_values[action])
</code></pre>
<h2 id="practical-tips-4"><a class="header" href="#practical-tips-4">Practical Tips</a></h2>
<ol>
<li><strong>Start Simple</strong>: Begin with simple environments and algorithms</li>
<li><strong>Hyperparameter Tuning</strong>: Learning rate, discount factor, and exploration rate are crucial</li>
<li><strong>Experience Replay</strong>: Store and replay past experiences (covered in deep RL)</li>
<li><strong>Reward Shaping</strong>: Design rewards carefully to guide learning</li>
<li><strong>Exploration vs Exploitation</strong>: Balance is key for good performance</li>
<li><strong>Curriculum Learning</strong>: Start with easy tasks and gradually increase difficulty</li>
</ol>
<h2 id="resources-14"><a class="header" href="#resources-14">Resources</a></h2>
<ul>
<li>"Reinforcement Learning: An Introduction" by Sutton and Barto</li>
<li>OpenAI Gym: https://gym.openai.com/</li>
<li>Stable Baselines3: https://stable-baselines3.readthedocs.io/</li>
<li>David Silver's RL Course: https://www.davidsilver.uk/teaching/</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="deep-reinforcement-learning"><a class="header" href="#deep-reinforcement-learning">Deep Reinforcement Learning</a></h1>
<p>Deep RL combines deep learning with reinforcement learning to handle high-dimensional state and action spaces.</p>
<h2 id="table-of-contents-19"><a class="header" href="#table-of-contents-19">Table of Contents</a></h2>
<ol>
<li><a href="machine_learning/deep_reinforcement_learning.html#deep-q-networks-dqn">Deep Q-Networks (DQN)</a></li>
<li><a href="machine_learning/deep_reinforcement_learning.html#policy-gradient-methods">Policy Gradient Methods</a></li>
<li><a href="machine_learning/deep_reinforcement_learning.html#actor-critic-methods">Actor-Critic Methods</a></li>
<li><a href="machine_learning/deep_reinforcement_learning.html#a3c">A3C (Asynchronous Advantage Actor-Critic)</a></li>
<li><a href="machine_learning/deep_reinforcement_learning.html#ppo">PPO (Proximal Policy Optimization)</a></li>
<li><a href="machine_learning/deep_reinforcement_learning.html#ddpg">DDPG (Deep Deterministic Policy Gradient)</a></li>
<li><a href="machine_learning/deep_reinforcement_learning.html#sac">SAC (Soft Actor-Critic)</a></li>
<li><a href="machine_learning/deep_reinforcement_learning.html#td3">TD3 (Twin Delayed DDPG)</a></li>
<li><a href="machine_learning/deep_reinforcement_learning.html#model-based-rl">Model-Based RL</a></li>
<li><a href="machine_learning/deep_reinforcement_learning.html#multi-agent-rl">Multi-Agent RL</a></li>
</ol>
<h2 id="deep-q-networks-dqn"><a class="header" href="#deep-q-networks-dqn">Deep Q-Networks (DQN)</a></h2>
<p>DQN uses deep neural networks to approximate Q-values for high-dimensional states.</p>
<h3 id="basic-dqn"><a class="header" href="#basic-dqn">Basic DQN</a></h3>
<pre><code class="language-python">import torch
import torch.nn as nn
import torch.optim as optim
import torch.nn.functional as F
import numpy as np
from collections import deque, namedtuple
import random

# Q-Network
class QNetwork(nn.Module):
    def __init__(self, state_dim, action_dim, hidden_dims=[128, 128]):
        super(QNetwork, self).__init__()
        
        layers = []
        prev_dim = state_dim
        
        for hidden_dim in hidden_dims:
            layers.append(nn.Linear(prev_dim, hidden_dim))
            layers.append(nn.ReLU())
            prev_dim = hidden_dim
        
        layers.append(nn.Linear(prev_dim, action_dim))
        self.network = nn.Sequential(*layers)
    
    def forward(self, state):
        return self.network(state)

# Experience Replay Buffer
class ReplayBuffer:
    def __init__(self, capacity=100000):
        self.buffer = deque(maxlen=capacity)
        self.experience = namedtuple('Experience', 
                                    ['state', 'action', 'reward', 'next_state', 'done'])
    
    def push(self, state, action, reward, next_state, done):
        self.buffer.append(self.experience(state, action, reward, next_state, done))
    
    def sample(self, batch_size):
        experiences = random.sample(self.buffer, batch_size)
        
        states = torch.FloatTensor([e.state for e in experiences])
        actions = torch.LongTensor([e.action for e in experiences])
        rewards = torch.FloatTensor([e.reward for e in experiences])
        next_states = torch.FloatTensor([e.next_state for e in experiences])
        dones = torch.FloatTensor([e.done for e in experiences])
        
        return states, actions, rewards, next_states, dones
    
    def __len__(self):
        return len(self.buffer)

# DQN Agent
class DQNAgent:
    def __init__(self, state_dim, action_dim, lr=0.001, gamma=0.99, 
                 epsilon=1.0, epsilon_decay=0.995, epsilon_min=0.01,
                 buffer_size=100000, batch_size=64, target_update_freq=10):
        self.state_dim = state_dim
        self.action_dim = action_dim
        self.gamma = gamma
        self.epsilon = epsilon
        self.epsilon_decay = epsilon_decay
        self.epsilon_min = epsilon_min
        self.batch_size = batch_size
        self.target_update_freq = target_update_freq
        
        # Q-Networks
        self.q_network = QNetwork(state_dim, action_dim)
        self.target_network = QNetwork(state_dim, action_dim)
        self.target_network.load_state_dict(self.q_network.state_dict())
        
        self.optimizer = optim.Adam(self.q_network.parameters(), lr=lr)
        self.replay_buffer = ReplayBuffer(buffer_size)
        
        self.steps = 0
    
    def select_action(self, state, training=True):
        """Epsilon-greedy action selection"""
        if training and random.random() &lt; self.epsilon:
            return random.randint(0, self.action_dim - 1)
        
        with torch.no_grad():
            state = torch.FloatTensor(state).unsqueeze(0)
            q_values = self.q_network(state)
            return q_values.argmax(1).item()
    
    def train_step(self):
        """Single training step"""
        if len(self.replay_buffer) &lt; self.batch_size:
            return None
        
        # Sample batch
        states, actions, rewards, next_states, dones = self.replay_buffer.sample(self.batch_size)
        
        # Current Q values
        current_q_values = self.q_network(states).gather(1, actions.unsqueeze(1)).squeeze()
        
        # Target Q values
        with torch.no_grad():
            next_q_values = self.target_network(next_states).max(1)[0]
            target_q_values = rewards + (1 - dones) * self.gamma * next_q_values
        
        # Compute loss
        loss = F.mse_loss(current_q_values, target_q_values)
        
        # Optimize
        self.optimizer.zero_grad()
        loss.backward()
        torch.nn.utils.clip_grad_norm_(self.q_network.parameters(), 1.0)
        self.optimizer.step()
        
        # Update target network
        self.steps += 1
        if self.steps % self.target_update_freq == 0:
            self.target_network.load_state_dict(self.q_network.state_dict())
        
        # Decay epsilon
        self.epsilon = max(self.epsilon_min, self.epsilon * self.epsilon_decay)
        
        return loss.item()
    
    def train(self, env, num_episodes=1000, max_steps=1000):
        """Train the agent"""
        episode_rewards = []
        
        for episode in range(num_episodes):
            state = env.reset()
            total_reward = 0
            
            for step in range(max_steps):
                # Select and perform action
                action = self.select_action(state, training=True)
                next_state, reward, done, _ = env.step(action)
                
                # Store transition
                self.replay_buffer.push(state, action, reward, next_state, done)
                
                # Train
                loss = self.train_step()
                
                state = next_state
                total_reward += reward
                
                if done:
                    break
            
            episode_rewards.append(total_reward)
            
            if (episode + 1) % 10 == 0:
                avg_reward = np.mean(episode_rewards[-10:])
                print(f"Episode {episode+1}, Avg Reward: {avg_reward:.2f}, "
                      f"Epsilon: {self.epsilon:.3f}")
        
        return episode_rewards
</code></pre>
<h3 id="double-dqn"><a class="header" href="#double-dqn">Double DQN</a></h3>
<p>Reduces overestimation bias in Q-learning.</p>
<pre><code class="language-python">class DoubleDQNAgent(DQNAgent):
    def train_step(self):
        """Double DQN training step"""
        if len(self.replay_buffer) &lt; self.batch_size:
            return None
        
        states, actions, rewards, next_states, dones = self.replay_buffer.sample(self.batch_size)
        
        # Current Q values
        current_q_values = self.q_network(states).gather(1, actions.unsqueeze(1)).squeeze()
        
        # Double DQN: use online network to select actions, target network to evaluate
        with torch.no_grad():
            # Select actions using online network
            next_actions = self.q_network(next_states).argmax(1)
            # Evaluate using target network
            next_q_values = self.target_network(next_states).gather(1, next_actions.unsqueeze(1)).squeeze()
            target_q_values = rewards + (1 - dones) * self.gamma * next_q_values
        
        # Compute loss
        loss = F.mse_loss(current_q_values, target_q_values)
        
        # Optimize
        self.optimizer.zero_grad()
        loss.backward()
        torch.nn.utils.clip_grad_norm_(self.q_network.parameters(), 1.0)
        self.optimizer.step()
        
        # Update target network
        self.steps += 1
        if self.steps % self.target_update_freq == 0:
            self.target_network.load_state_dict(self.q_network.state_dict())
        
        self.epsilon = max(self.epsilon_min, self.epsilon * self.epsilon_decay)
        
        return loss.item()
</code></pre>
<h3 id="dueling-dqn"><a class="header" href="#dueling-dqn">Dueling DQN</a></h3>
<p>Separates value and advantage functions.</p>
<pre><code class="language-python">class DuelingQNetwork(nn.Module):
    def __init__(self, state_dim, action_dim, hidden_dim=128):
        super(DuelingQNetwork, self).__init__()
        
        # Feature extraction
        self.feature = nn.Sequential(
            nn.Linear(state_dim, hidden_dim),
            nn.ReLU(),
            nn.Linear(hidden_dim, hidden_dim),
            nn.ReLU()
        )
        
        # Value stream
        self.value_stream = nn.Sequential(
            nn.Linear(hidden_dim, hidden_dim),
            nn.ReLU(),
            nn.Linear(hidden_dim, 1)
        )
        
        # Advantage stream
        self.advantage_stream = nn.Sequential(
            nn.Linear(hidden_dim, hidden_dim),
            nn.ReLU(),
            nn.Linear(hidden_dim, action_dim)
        )
    
    def forward(self, state):
        features = self.feature(state)
        value = self.value_stream(features)
        advantages = self.advantage_stream(features)
        
        # Q(s,a) = V(s) + (A(s,a) - mean(A(s,a)))
        q_values = value + (advantages - advantages.mean(dim=1, keepdim=True))
        return q_values
</code></pre>
<h3 id="prioritized-experience-replay"><a class="header" href="#prioritized-experience-replay">Prioritized Experience Replay</a></h3>
<pre><code class="language-python">class PrioritizedReplayBuffer:
    def __init__(self, capacity=100000, alpha=0.6):
        self.capacity = capacity
        self.alpha = alpha
        self.buffer = []
        self.priorities = np.zeros(capacity, dtype=np.float32)
        self.position = 0
    
    def push(self, state, action, reward, next_state, done):
        max_priority = self.priorities.max() if self.buffer else 1.0
        
        if len(self.buffer) &lt; self.capacity:
            self.buffer.append((state, action, reward, next_state, done))
        else:
            self.buffer[self.position] = (state, action, reward, next_state, done)
        
        self.priorities[self.position] = max_priority
        self.position = (self.position + 1) % self.capacity
    
    def sample(self, batch_size, beta=0.4):
        if len(self.buffer) == self.capacity:
            priorities = self.priorities
        else:
            priorities = self.priorities[:self.position]
        
        # Calculate sampling probabilities
        probabilities = priorities ** self.alpha
        probabilities /= probabilities.sum()
        
        # Sample indices
        indices = np.random.choice(len(self.buffer), batch_size, p=probabilities)
        
        # Importance sampling weights
        total = len(self.buffer)
        weights = (total * probabilities[indices]) ** (-beta)
        weights /= weights.max()
        
        # Get experiences
        experiences = [self.buffer[idx] for idx in indices]
        states = torch.FloatTensor([e[0] for e in experiences])
        actions = torch.LongTensor([e[1] for e in experiences])
        rewards = torch.FloatTensor([e[2] for e in experiences])
        next_states = torch.FloatTensor([e[3] for e in experiences])
        dones = torch.FloatTensor([e[4] for e in experiences])
        weights = torch.FloatTensor(weights)
        
        return states, actions, rewards, next_states, dones, indices, weights
    
    def update_priorities(self, indices, priorities):
        for idx, priority in zip(indices, priorities):
            self.priorities[idx] = priority
    
    def __len__(self):
        return len(self.buffer)
</code></pre>
<h2 id="policy-gradient-methods-1"><a class="header" href="#policy-gradient-methods-1">Policy Gradient Methods</a></h2>
<h3 id="reinforce-with-baseline"><a class="header" href="#reinforce-with-baseline">REINFORCE with Baseline</a></h3>
<pre><code class="language-python">class PolicyNetwork(nn.Module):
    def __init__(self, state_dim, action_dim, hidden_dim=128):
        super(PolicyNetwork, self).__init__()
        
        self.network = nn.Sequential(
            nn.Linear(state_dim, hidden_dim),
            nn.ReLU(),
            nn.Linear(hidden_dim, hidden_dim),
            nn.ReLU(),
            nn.Linear(hidden_dim, action_dim),
            nn.Softmax(dim=-1)
        )
    
    def forward(self, state):
        return self.network(state)

class ValueNetwork(nn.Module):
    def __init__(self, state_dim, hidden_dim=128):
        super(ValueNetwork, self).__init__()
        
        self.network = nn.Sequential(
            nn.Linear(state_dim, hidden_dim),
            nn.ReLU(),
            nn.Linear(hidden_dim, hidden_dim),
            nn.ReLU(),
            nn.Linear(hidden_dim, 1)
        )
    
    def forward(self, state):
        return self.network(state)

class REINFORCEWithBaseline:
    def __init__(self, state_dim, action_dim, lr=0.001, gamma=0.99):
        self.gamma = gamma
        
        self.policy_net = PolicyNetwork(state_dim, action_dim)
        self.value_net = ValueNetwork(state_dim)
        
        self.policy_optimizer = optim.Adam(self.policy_net.parameters(), lr=lr)
        self.value_optimizer = optim.Adam(self.value_net.parameters(), lr=lr)
        
        self.saved_log_probs = []
        self.saved_values = []
        self.rewards = []
    
    def select_action(self, state):
        state = torch.FloatTensor(state).unsqueeze(0)
        
        # Get action probabilities and value
        probs = self.policy_net(state)
        value = self.value_net(state)
        
        # Sample action
        action_dist = torch.distributions.Categorical(probs)
        action = action_dist.sample()
        
        # Save log prob and value
        self.saved_log_probs.append(action_dist.log_prob(action))
        self.saved_values.append(value)
        
        return action.item()
    
    def train_step(self):
        R = 0
        returns = []
        
        # Calculate returns
        for r in reversed(self.rewards):
            R = r + self.gamma * R
            returns.insert(0, R)
        
        returns = torch.tensor(returns)
        returns = (returns - returns.mean()) / (returns.std() + 1e-8)
        
        policy_losses = []
        value_losses = []
        
        # Calculate losses
        for log_prob, value, R in zip(self.saved_log_probs, self.saved_values, returns):
            advantage = R - value.item()
            
            # Policy loss (REINFORCE with baseline)
            policy_losses.append(-log_prob * advantage)
            
            # Value loss
            value_losses.append(F.mse_loss(value, torch.tensor([[R]])))
        
        # Update policy network
        self.policy_optimizer.zero_grad()
        policy_loss = torch.stack(policy_losses).sum()
        policy_loss.backward()
        self.policy_optimizer.step()
        
        # Update value network
        self.value_optimizer.zero_grad()
        value_loss = torch.stack(value_losses).sum()
        value_loss.backward()
        self.value_optimizer.step()
        
        # Clear saved values
        self.saved_log_probs = []
        self.saved_values = []
        self.rewards = []
        
        return policy_loss.item(), value_loss.item()
</code></pre>
<h2 id="actor-critic-methods-1"><a class="header" href="#actor-critic-methods-1">Actor-Critic Methods</a></h2>
<h3 id="advantage-actor-critic-a2c-1"><a class="header" href="#advantage-actor-critic-a2c-1">Advantage Actor-Critic (A2C)</a></h3>
<pre><code class="language-python">class ActorCritic(nn.Module):
    def __init__(self, state_dim, action_dim, hidden_dim=128):
        super(ActorCritic, self).__init__()
        
        # Shared layers
        self.shared = nn.Sequential(
            nn.Linear(state_dim, hidden_dim),
            nn.ReLU()
        )
        
        # Actor head
        self.actor = nn.Sequential(
            nn.Linear(hidden_dim, hidden_dim),
            nn.ReLU(),
            nn.Linear(hidden_dim, action_dim),
            nn.Softmax(dim=-1)
        )
        
        # Critic head
        self.critic = nn.Sequential(
            nn.Linear(hidden_dim, hidden_dim),
            nn.ReLU(),
            nn.Linear(hidden_dim, 1)
        )
    
    def forward(self, state):
        shared_features = self.shared(state)
        action_probs = self.actor(shared_features)
        state_value = self.critic(shared_features)
        return action_probs, state_value

class A2CAgent:
    def __init__(self, state_dim, action_dim, lr=0.001, gamma=0.99, 
                 value_coef=0.5, entropy_coef=0.01):
        self.gamma = gamma
        self.value_coef = value_coef
        self.entropy_coef = entropy_coef
        
        self.model = ActorCritic(state_dim, action_dim)
        self.optimizer = optim.Adam(self.model.parameters(), lr=lr)
    
    def select_action(self, state):
        state = torch.FloatTensor(state).unsqueeze(0)
        action_probs, state_value = self.model(state)
        
        action_dist = torch.distributions.Categorical(action_probs)
        action = action_dist.sample()
        
        return action.item(), action_dist.log_prob(action), action_dist.entropy(), state_value
    
    def train_step(self, states, actions, rewards, next_states, dones):
        """Train on a batch of experiences"""
        states = torch.FloatTensor(states)
        actions = torch.LongTensor(actions)
        rewards = torch.FloatTensor(rewards)
        next_states = torch.FloatTensor(next_states)
        dones = torch.FloatTensor(dones)
        
        # Get action probabilities and values
        action_probs, values = self.model(states)
        _, next_values = self.model(next_states)
        
        # Calculate advantages
        td_targets = rewards + (1 - dones) * self.gamma * next_values.squeeze()
        advantages = td_targets - values.squeeze()
        
        # Actor loss
        action_dist = torch.distributions.Categorical(action_probs)
        log_probs = action_dist.log_prob(actions)
        actor_loss = -(log_probs * advantages.detach()).mean()
        
        # Critic loss
        critic_loss = F.mse_loss(values.squeeze(), td_targets.detach())
        
        # Entropy bonus (encourages exploration)
        entropy = action_dist.entropy().mean()
        
        # Total loss
        loss = actor_loss + self.value_coef * critic_loss - self.entropy_coef * entropy
        
        # Optimize
        self.optimizer.zero_grad()
        loss.backward()
        torch.nn.utils.clip_grad_norm_(self.model.parameters(), 0.5)
        self.optimizer.step()
        
        return loss.item(), actor_loss.item(), critic_loss.item(), entropy.item()
</code></pre>
<h2 id="a3c"><a class="header" href="#a3c">A3C</a></h2>
<p>Asynchronous Advantage Actor-Critic uses multiple parallel workers.</p>
<pre><code class="language-python">import torch.multiprocessing as mp

class A3CAgent:
    def __init__(self, state_dim, action_dim, lr=0.001, gamma=0.99):
        self.state_dim = state_dim
        self.action_dim = action_dim
        self.gamma = gamma
        
        # Global network (shared across workers)
        self.global_model = ActorCritic(state_dim, action_dim)
        self.global_model.share_memory()
        
        self.optimizer = optim.Adam(self.global_model.parameters(), lr=lr)
    
    def worker(self, worker_id, env_fn, num_episodes=1000):
        """Worker process for A3C"""
        local_model = ActorCritic(self.state_dim, self.action_dim)
        env = env_fn()
        
        for episode in range(num_episodes):
            state = env.reset()
            done = False
            
            states, actions, rewards = [], [], []
            
            while not done:
                # Sync local model with global model
                local_model.load_state_dict(self.global_model.state_dict())
                
                # Select action
                state_tensor = torch.FloatTensor(state).unsqueeze(0)
                action_probs, _ = local_model(state_tensor)
                action_dist = torch.distributions.Categorical(action_probs)
                action = action_dist.sample()
                
                # Take action
                next_state, reward, done, _ = env.step(action.item())
                
                # Store transition
                states.append(state)
                actions.append(action.item())
                rewards.append(reward)
                
                state = next_state
                
                # Update global network periodically
                if len(states) &gt;= 20 or done:
                    self._update_global(local_model, states, actions, rewards, next_state, done)
                    states, actions, rewards = [], [], []
    
    def _update_global(self, local_model, states, actions, rewards, next_state, done):
        """Update global network using local gradients"""
        states_tensor = torch.FloatTensor(states)
        actions_tensor = torch.LongTensor(actions)
        
        # Calculate returns
        R = 0
        if not done:
            _, next_value = local_model(torch.FloatTensor(next_state).unsqueeze(0))
            R = next_value.item()
        
        returns = []
        for r in reversed(rewards):
            R = r + self.gamma * R
            returns.insert(0, R)
        returns = torch.FloatTensor(returns)
        
        # Calculate loss
        action_probs, values = local_model(states_tensor)
        action_dist = torch.distributions.Categorical(action_probs)
        log_probs = action_dist.log_prob(actions_tensor)
        
        advantages = returns - values.squeeze()
        actor_loss = -(log_probs * advantages.detach()).mean()
        critic_loss = advantages.pow(2).mean()
        entropy = action_dist.entropy().mean()
        
        loss = actor_loss + 0.5 * critic_loss - 0.01 * entropy
        
        # Update global network
        self.optimizer.zero_grad()
        loss.backward()
        
        # Transfer gradients to global network
        for local_param, global_param in zip(local_model.parameters(), 
                                             self.global_model.parameters()):
            if global_param.grad is None:
                global_param.grad = local_param.grad
            else:
                global_param.grad += local_param.grad
        
        self.optimizer.step()
    
    def train(self, env_fn, num_workers=4, num_episodes=1000):
        """Train using multiple parallel workers"""
        processes = []
        
        for worker_id in range(num_workers):
            p = mp.Process(target=self.worker, args=(worker_id, env_fn, num_episodes))
            p.start()
            processes.append(p)
        
        for p in processes:
            p.join()
</code></pre>
<h2 id="ppo"><a class="header" href="#ppo">PPO</a></h2>
<p>Proximal Policy Optimization is a policy gradient method with clipped objective.</p>
<pre><code class="language-python">class PPOAgent:
    def __init__(self, state_dim, action_dim, lr=0.0003, gamma=0.99, 
                 epsilon=0.2, value_coef=0.5, entropy_coef=0.01, 
                 epochs=10, batch_size=64):
        self.gamma = gamma
        self.epsilon = epsilon
        self.value_coef = value_coef
        self.entropy_coef = entropy_coef
        self.epochs = epochs
        self.batch_size = batch_size
        
        self.model = ActorCritic(state_dim, action_dim)
        self.optimizer = optim.Adam(self.model.parameters(), lr=lr)
        
        # Storage for rollouts
        self.states = []
        self.actions = []
        self.rewards = []
        self.values = []
        self.log_probs = []
        self.dones = []
    
    def select_action(self, state):
        """Select action using current policy"""
        state_tensor = torch.FloatTensor(state).unsqueeze(0)
        
        with torch.no_grad():
            action_probs, value = self.model(state_tensor)
        
        action_dist = torch.distributions.Categorical(action_probs)
        action = action_dist.sample()
        log_prob = action_dist.log_prob(action)
        
        return action.item(), log_prob.item(), value.item()
    
    def store_transition(self, state, action, reward, log_prob, value, done):
        """Store transition in buffer"""
        self.states.append(state)
        self.actions.append(action)
        self.rewards.append(reward)
        self.log_probs.append(log_prob)
        self.values.append(value)
        self.dones.append(done)
    
    def compute_gae(self, next_value, gamma=0.99, lam=0.95):
        """Compute Generalized Advantage Estimation"""
        advantages = []
        gae = 0
        
        values = self.values + [next_value]
        
        for t in reversed(range(len(self.rewards))):
            delta = self.rewards[t] + gamma * values[t + 1] * (1 - self.dones[t]) - values[t]
            gae = delta + gamma * lam * (1 - self.dones[t]) * gae
            advantages.insert(0, gae)
        
        returns = [adv + val for adv, val in zip(advantages, self.values)]
        
        return advantages, returns
    
    def update(self, next_state):
        """PPO update"""
        # Get next value for GAE
        with torch.no_grad():
            next_state_tensor = torch.FloatTensor(next_state).unsqueeze(0)
            _, next_value = self.model(next_state_tensor)
            next_value = next_value.item()
        
        # Compute advantages and returns
        advantages, returns = self.compute_gae(next_value)
        
        # Convert to tensors
        states = torch.FloatTensor(self.states)
        actions = torch.LongTensor(self.actions)
        old_log_probs = torch.FloatTensor(self.log_probs)
        advantages = torch.FloatTensor(advantages)
        returns = torch.FloatTensor(returns)
        
        # Normalize advantages
        advantages = (advantages - advantages.mean()) / (advantages.std() + 1e-8)
        
        # PPO update for multiple epochs
        for _ in range(self.epochs):
            # Get current policy
            action_probs, values = self.model(states)
            action_dist = torch.distributions.Categorical(action_probs)
            log_probs = action_dist.log_prob(actions)
            entropy = action_dist.entropy()
            
            # Ratio for clipping
            ratio = torch.exp(log_probs - old_log_probs)
            
            # Clipped surrogate objective
            surr1 = ratio * advantages
            surr2 = torch.clamp(ratio, 1 - self.epsilon, 1 + self.epsilon) * advantages
            actor_loss = -torch.min(surr1, surr2).mean()
            
            # Value loss
            critic_loss = F.mse_loss(values.squeeze(), returns)
            
            # Entropy bonus
            entropy_loss = -entropy.mean()
            
            # Total loss
            loss = actor_loss + self.value_coef * critic_loss + self.entropy_coef * entropy_loss
            
            # Update
            self.optimizer.zero_grad()
            loss.backward()
            torch.nn.utils.clip_grad_norm_(self.model.parameters(), 0.5)
            self.optimizer.step()
        
        # Clear buffers
        self.states = []
        self.actions = []
        self.rewards = []
        self.values = []
        self.log_probs = []
        self.dones = []
        
        return loss.item()
</code></pre>
<h2 id="ddpg"><a class="header" href="#ddpg">DDPG</a></h2>
<p>Deep Deterministic Policy Gradient for continuous action spaces.</p>
<pre><code class="language-python">class Actor(nn.Module):
    def __init__(self, state_dim, action_dim, max_action, hidden_dim=256):
        super(Actor, self).__init__()
        
        self.network = nn.Sequential(
            nn.Linear(state_dim, hidden_dim),
            nn.ReLU(),
            nn.Linear(hidden_dim, hidden_dim),
            nn.ReLU(),
            nn.Linear(hidden_dim, action_dim),
            nn.Tanh()
        )
        self.max_action = max_action
    
    def forward(self, state):
        return self.max_action * self.network(state)

class Critic(nn.Module):
    def __init__(self, state_dim, action_dim, hidden_dim=256):
        super(Critic, self).__init__()
        
        self.network = nn.Sequential(
            nn.Linear(state_dim + action_dim, hidden_dim),
            nn.ReLU(),
            nn.Linear(hidden_dim, hidden_dim),
            nn.ReLU(),
            nn.Linear(hidden_dim, 1)
        )
    
    def forward(self, state, action):
        return self.network(torch.cat([state, action], dim=1))

class DDPGAgent:
    def __init__(self, state_dim, action_dim, max_action, lr=0.001, 
                 gamma=0.99, tau=0.005, noise_std=0.1):
        self.gamma = gamma
        self.tau = tau
        self.noise_std = noise_std
        self.max_action = max_action
        
        # Actor networks
        self.actor = Actor(state_dim, action_dim, max_action)
        self.actor_target = Actor(state_dim, action_dim, max_action)
        self.actor_target.load_state_dict(self.actor.state_dict())
        self.actor_optimizer = optim.Adam(self.actor.parameters(), lr=lr)
        
        # Critic networks
        self.critic = Critic(state_dim, action_dim)
        self.critic_target = Critic(state_dim, action_dim)
        self.critic_target.load_state_dict(self.critic.state_dict())
        self.critic_optimizer = optim.Adam(self.critic.parameters(), lr=lr)
        
        self.replay_buffer = ReplayBuffer()
    
    def select_action(self, state, training=True):
        """Select action with optional exploration noise"""
        state = torch.FloatTensor(state).unsqueeze(0)
        
        with torch.no_grad():
            action = self.actor(state).cpu().numpy()[0]
        
        if training:
            noise = np.random.normal(0, self.noise_std, size=action.shape)
            action = np.clip(action + noise, -self.max_action, self.max_action)
        
        return action
    
    def train_step(self, batch_size=64):
        """Single DDPG training step"""
        if len(self.replay_buffer) &lt; batch_size:
            return None, None
        
        # Sample batch
        states, actions, rewards, next_states, dones = self.replay_buffer.sample(batch_size)
        
        # Update critic
        with torch.no_grad():
            next_actions = self.actor_target(next_states)
            target_q = self.critic_target(next_states, next_actions)
            target_q = rewards.unsqueeze(1) + (1 - dones.unsqueeze(1)) * self.gamma * target_q
        
        current_q = self.critic(states, actions)
        critic_loss = F.mse_loss(current_q, target_q)
        
        self.critic_optimizer.zero_grad()
        critic_loss.backward()
        self.critic_optimizer.step()
        
        # Update actor
        actor_loss = -self.critic(states, self.actor(states)).mean()
        
        self.actor_optimizer.zero_grad()
        actor_loss.backward()
        self.actor_optimizer.step()
        
        # Soft update target networks
        self._soft_update(self.actor, self.actor_target)
        self._soft_update(self.critic, self.critic_target)
        
        return actor_loss.item(), critic_loss.item()
    
    def _soft_update(self, source, target):
        """Soft update of target network"""
        for source_param, target_param in zip(source.parameters(), target.parameters()):
            target_param.data.copy_(
                self.tau * source_param.data + (1 - self.tau) * target_param.data
            )
</code></pre>
<h2 id="sac"><a class="header" href="#sac">SAC</a></h2>
<p>Soft Actor-Critic with entropy maximization.</p>
<pre><code class="language-python">class SACAgent:
    def __init__(self, state_dim, action_dim, max_action, lr=0.0003, 
                 gamma=0.99, tau=0.005, alpha=0.2):
        self.gamma = gamma
        self.tau = tau
        self.alpha = alpha  # Temperature parameter
        self.max_action = max_action
        
        # Actor (stochastic policy)
        self.actor = Actor(state_dim, action_dim, max_action)
        self.actor_optimizer = optim.Adam(self.actor.parameters(), lr=lr)
        
        # Two Q-functions (critics)
        self.critic_1 = Critic(state_dim, action_dim)
        self.critic_2 = Critic(state_dim, action_dim)
        self.critic_1_optimizer = optim.Adam(self.critic_1.parameters(), lr=lr)
        self.critic_2_optimizer = optim.Adam(self.critic_2.parameters(), lr=lr)
        
        # Target critics
        self.critic_1_target = Critic(state_dim, action_dim)
        self.critic_2_target = Critic(state_dim, action_dim)
        self.critic_1_target.load_state_dict(self.critic_1.state_dict())
        self.critic_2_target.load_state_dict(self.critic_2.state_dict())
        
        self.replay_buffer = ReplayBuffer()
    
    def train_step(self, batch_size=256):
        """SAC training step"""
        if len(self.replay_buffer) &lt; batch_size:
            return None
        
        states, actions, rewards, next_states, dones = self.replay_buffer.sample(batch_size)
        
        # Update critics
        with torch.no_grad():
            next_actions, next_log_probs = self.actor.sample(next_states)
            target_q1 = self.critic_1_target(next_states, next_actions)
            target_q2 = self.critic_2_target(next_states, next_actions)
            target_q = torch.min(target_q1, target_q2) - self.alpha * next_log_probs
            target_q = rewards.unsqueeze(1) + (1 - dones.unsqueeze(1)) * self.gamma * target_q
        
        current_q1 = self.critic_1(states, actions)
        current_q2 = self.critic_2(states, actions)
        
        critic_1_loss = F.mse_loss(current_q1, target_q)
        critic_2_loss = F.mse_loss(current_q2, target_q)
        
        self.critic_1_optimizer.zero_grad()
        critic_1_loss.backward()
        self.critic_1_optimizer.step()
        
        self.critic_2_optimizer.zero_grad()
        critic_2_loss.backward()
        self.critic_2_optimizer.step()
        
        # Update actor
        new_actions, log_probs = self.actor.sample(states)
        q1 = self.critic_1(states, new_actions)
        q2 = self.critic_2(states, new_actions)
        q = torch.min(q1, q2)
        
        actor_loss = (self.alpha * log_probs - q).mean()
        
        self.actor_optimizer.zero_grad()
        actor_loss.backward()
        self.actor_optimizer.step()
        
        # Soft update target networks
        self._soft_update(self.critic_1, self.critic_1_target)
        self._soft_update(self.critic_2, self.critic_2_target)
        
        return actor_loss.item(), critic_1_loss.item(), critic_2_loss.item()
</code></pre>
<h2 id="td3"><a class="header" href="#td3">TD3</a></h2>
<p>Twin Delayed Deep Deterministic Policy Gradient.</p>
<pre><code class="language-python">class TD3Agent(DDPGAgent):
    def __init__(self, state_dim, action_dim, max_action, lr=0.001, 
                 gamma=0.99, tau=0.005, policy_noise=0.2, 
                 noise_clip=0.5, policy_delay=2):
        super().__init__(state_dim, action_dim, max_action, lr, gamma, tau)
        
        # Twin critics
        self.critic_2 = Critic(state_dim, action_dim)
        self.critic_2_target = Critic(state_dim, action_dim)
        self.critic_2_target.load_state_dict(self.critic_2.state_dict())
        self.critic_2_optimizer = optim.Adam(self.critic_2.parameters(), lr=lr)
        
        self.policy_noise = policy_noise
        self.noise_clip = noise_clip
        self.policy_delay = policy_delay
        self.total_iterations = 0
    
    def train_step(self, batch_size=64):
        """TD3 training step"""
        self.total_iterations += 1
        
        if len(self.replay_buffer) &lt; batch_size:
            return None, None
        
        states, actions, rewards, next_states, dones = self.replay_buffer.sample(batch_size)
        
        # Update critics
        with torch.no_grad():
            # Target policy smoothing
            noise = torch.randn_like(actions) * self.policy_noise
            noise = torch.clamp(noise, -self.noise_clip, self.noise_clip)
            
            next_actions = self.actor_target(next_states)
            next_actions = torch.clamp(next_actions + noise, -self.max_action, self.max_action)
            
            # Twin Q targets
            target_q1 = self.critic_target(next_states, next_actions)
            target_q2 = self.critic_2_target(next_states, next_actions)
            target_q = torch.min(target_q1, target_q2)
            target_q = rewards.unsqueeze(1) + (1 - dones.unsqueeze(1)) * self.gamma * target_q
        
        current_q1 = self.critic(states, actions)
        current_q2 = self.critic_2(states, actions)
        
        critic_1_loss = F.mse_loss(current_q1, target_q)
        critic_2_loss = F.mse_loss(current_q2, target_q)
        
        self.critic_optimizer.zero_grad()
        critic_1_loss.backward()
        self.critic_optimizer.step()
        
        self.critic_2_optimizer.zero_grad()
        critic_2_loss.backward()
        self.critic_2_optimizer.step()
        
        # Delayed policy updates
        actor_loss = None
        if self.total_iterations % self.policy_delay == 0:
            # Update actor
            actor_loss = -self.critic(states, self.actor(states)).mean()
            
            self.actor_optimizer.zero_grad()
            actor_loss.backward()
            self.actor_optimizer.step()
            
            # Soft update target networks
            self._soft_update(self.actor, self.actor_target)
            self._soft_update(self.critic, self.critic_target)
            self._soft_update(self.critic_2, self.critic_2_target)
        
        return actor_loss.item() if actor_loss else None, critic_1_loss.item()
</code></pre>
<h2 id="practical-tips-5"><a class="header" href="#practical-tips-5">Practical Tips</a></h2>
<ol>
<li><strong>Hyperparameter Tuning</strong>: Learning rates, discount factors crucial</li>
<li><strong>Reward Scaling</strong>: Normalize rewards for stable training</li>
<li><strong>Network Architecture</strong>: Start simple, increase complexity as needed</li>
<li><strong>Exploration</strong>: Balance exploration vs exploitation</li>
<li><strong>Curriculum Learning</strong>: Start with easier tasks</li>
<li><strong>Distributed Training</strong>: Use parallel environments for faster learning</li>
</ol>
<h2 id="resources-15"><a class="header" href="#resources-15">Resources</a></h2>
<ul>
<li>OpenAI Spinning Up: https://spinningup.openai.com/</li>
<li>Stable Baselines3: https://stable-baselines3.readthedocs.io/</li>
<li>"Deep Reinforcement Learning Hands-On" by Maxim Lapan</li>
<li>DeepMind papers: https://www.deepmind.com/research</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="generative-models"><a class="header" href="#generative-models">Generative Models</a></h1>
<p>Generative models learn to create new data samples that resemble the training data distribution.</p>
<h2 id="table-of-contents-20"><a class="header" href="#table-of-contents-20">Table of Contents</a></h2>
<ol>
<li><a href="machine_learning/generative_models.html#introduction">Introduction</a></li>
<li><a href="machine_learning/generative_models.html#generative-adversarial-networks">Generative Adversarial Networks (GANs)</a></li>
<li><a href="machine_learning/generative_models.html#variational-autoencoders">Variational Autoencoders (VAEs)</a></li>
<li><a href="machine_learning/generative_models.html#normalizing-flows">Normalizing Flows</a></li>
<li><a href="machine_learning/generative_models.html#autoregressive-models">Autoregressive Models</a></li>
<li><a href="machine_learning/generative_models.html#energy-based-models">Energy-Based Models</a></li>
<li><a href="machine_learning/generative_models.html#diffusion-models">Diffusion Models</a></li>
</ol>
<h2 id="introduction-4"><a class="header" href="#introduction-4">Introduction</a></h2>
<p><strong>Types of Generative Models:</strong></p>
<ul>
<li><strong>Explicit Density</strong>: Models that define explicit probability distribution (VAE, Flow models)</li>
<li><strong>Implicit Density</strong>: Models that can sample without explicit density (GANs)</li>
<li><strong>Tractable</strong>: Can compute exact likelihoods (Autoregressive, Flow models)</li>
<li><strong>Approximate</strong>: Use approximate inference (VAEs)</li>
</ul>
<h2 id="generative-adversarial-networks"><a class="header" href="#generative-adversarial-networks">Generative Adversarial Networks</a></h2>
<p>GANs use two networks competing against each other: Generator and Discriminator.</p>
<h3 id="basic-gan"><a class="header" href="#basic-gan">Basic GAN</a></h3>
<p><strong>Objective Function:</strong></p>
<pre><code>min_G max_D V(D,G) = E_x[log D(x)] + E_z[log(1 - D(G(z)))]
</code></pre>
<pre><code class="language-python">import torch
import torch.nn as nn
import torch.optim as optim
import torchvision
import torchvision.transforms as transforms
from torch.utils.data import DataLoader

# Generator Network
class Generator(nn.Module):
    def __init__(self, latent_dim=100, img_shape=(1, 28, 28)):
        super(Generator, self).__init__()
        self.img_shape = img_shape
        
        def block(in_feat, out_feat, normalize=True):
            layers = [nn.Linear(in_feat, out_feat)]
            if normalize:
                layers.append(nn.BatchNorm1d(out_feat))
            layers.append(nn.LeakyReLU(0.2))
            return layers
        
        self.model = nn.Sequential(
            *block(latent_dim, 128, normalize=False),
            *block(128, 256),
            *block(256, 512),
            *block(512, 1024),
            nn.Linear(1024, int(np.prod(img_shape))),
            nn.Tanh()
        )
    
    def forward(self, z):
        img = self.model(z)
        img = img.view(img.size(0), *self.img_shape)
        return img

# Discriminator Network
class Discriminator(nn.Module):
    def __init__(self, img_shape=(1, 28, 28)):
        super(Discriminator, self).__init__()
        
        self.model = nn.Sequential(
            nn.Linear(int(np.prod(img_shape)), 512),
            nn.LeakyReLU(0.2),
            nn.Dropout(0.3),
            nn.Linear(512, 256),
            nn.LeakyReLU(0.2),
            nn.Dropout(0.3),
            nn.Linear(256, 1),
            nn.Sigmoid()
        )
    
    def forward(self, img):
        img_flat = img.view(img.size(0), -1)
        validity = self.model(img_flat)
        return validity

# Training GAN
class GANTrainer:
    def __init__(self, generator, discriminator, latent_dim=100, 
                 lr=0.0002, betas=(0.5, 0.999)):
        self.generator = generator
        self.discriminator = discriminator
        self.latent_dim = latent_dim
        
        # Optimizers
        self.optimizer_G = optim.Adam(generator.parameters(), lr=lr, betas=betas)
        self.optimizer_D = optim.Adam(discriminator.parameters(), lr=lr, betas=betas)
        
        # Loss function
        self.adversarial_loss = nn.BCELoss()
    
    def train_step(self, real_imgs):
        batch_size = real_imgs.size(0)
        
        # Adversarial ground truths
        valid = torch.ones(batch_size, 1)
        fake = torch.zeros(batch_size, 1)
        
        # ---------------------
        #  Train Discriminator
        # ---------------------
        self.optimizer_D.zero_grad()
        
        # Loss for real images
        real_loss = self.adversarial_loss(self.discriminator(real_imgs), valid)
        
        # Loss for fake images
        z = torch.randn(batch_size, self.latent_dim)
        fake_imgs = self.generator(z)
        fake_loss = self.adversarial_loss(self.discriminator(fake_imgs.detach()), fake)
        
        # Total discriminator loss
        d_loss = (real_loss + fake_loss) / 2
        d_loss.backward()
        self.optimizer_D.step()
        
        # -----------------
        #  Train Generator
        # -----------------
        self.optimizer_G.zero_grad()
        
        # Generate fake images
        z = torch.randn(batch_size, self.latent_dim)
        gen_imgs = self.generator(z)
        
        # Generator loss (fool discriminator)
        g_loss = self.adversarial_loss(self.discriminator(gen_imgs), valid)
        g_loss.backward()
        self.optimizer_G.step()
        
        return d_loss.item(), g_loss.item()
    
    def train(self, dataloader, num_epochs=100):
        """Train GAN"""
        for epoch in range(num_epochs):
            for i, (imgs, _) in enumerate(dataloader):
                d_loss, g_loss = self.train_step(imgs)
                
                if i % 100 == 0:
                    print(f"[Epoch {epoch}/{num_epochs}] [Batch {i}] "
                          f"[D loss: {d_loss:.4f}] [G loss: {g_loss:.4f}]")
            
            # Sample images
            if epoch % 10 == 0:
                self.sample_images(epoch)
    
    def sample_images(self, epoch, n_row=10):
        """Generate and save sample images"""
        z = torch.randn(n_row**2, self.latent_dim)
        gen_imgs = self.generator(z)
        
        import torchvision.utils as vutils
        vutils.save_image(gen_imgs.data, f"images/epoch_{epoch}.png", 
                         nrow=n_row, normalize=True)

# Example usage
img_shape = (1, 28, 28)
generator = Generator(latent_dim=100, img_shape=img_shape)
discriminator = Discriminator(img_shape=img_shape)

trainer = GANTrainer(generator, discriminator)
# trainer.train(dataloader, num_epochs=100)
</code></pre>
<h3 id="deep-convolutional-gan-dcgan"><a class="header" href="#deep-convolutional-gan-dcgan">Deep Convolutional GAN (DCGAN)</a></h3>
<pre><code class="language-python">class DCGANGenerator(nn.Module):
    def __init__(self, latent_dim=100, channels=3):
        super(DCGANGenerator, self).__init__()
        
        self.init_size = 4
        self.l1 = nn.Linear(latent_dim, 128 * self.init_size ** 2)
        
        self.conv_blocks = nn.Sequential(
            nn.BatchNorm2d(128),
            nn.Upsample(scale_factor=2),  # 4x4 -&gt; 8x8
            nn.Conv2d(128, 128, 3, stride=1, padding=1),
            nn.BatchNorm2d(128),
            nn.LeakyReLU(0.2),
            
            nn.Upsample(scale_factor=2),  # 8x8 -&gt; 16x16
            nn.Conv2d(128, 64, 3, stride=1, padding=1),
            nn.BatchNorm2d(64),
            nn.LeakyReLU(0.2),
            
            nn.Upsample(scale_factor=2),  # 16x16 -&gt; 32x32
            nn.Conv2d(64, channels, 3, stride=1, padding=1),
            nn.Tanh()
        )
    
    def forward(self, z):
        out = self.l1(z)
        out = out.view(out.shape[0], 128, self.init_size, self.init_size)
        img = self.conv_blocks(out)
        return img

class DCGANDiscriminator(nn.Module):
    def __init__(self, channels=3):
        super(DCGANDiscriminator, self).__init__()
        
        def discriminator_block(in_filters, out_filters, bn=True):
            block = [nn.Conv2d(in_filters, out_filters, 3, 2, 1),
                    nn.LeakyReLU(0.2),
                    nn.Dropout2d(0.25)]
            if bn:
                block.append(nn.BatchNorm2d(out_filters))
            return block
        
        self.model = nn.Sequential(
            *discriminator_block(channels, 16, bn=False),  # 32x32 -&gt; 16x16
            *discriminator_block(16, 32),                   # 16x16 -&gt; 8x8
            *discriminator_block(32, 64),                   # 8x8 -&gt; 4x4
            *discriminator_block(64, 128),                  # 4x4 -&gt; 2x2
        )
        
        # Output layer
        ds_size = 2
        self.adv_layer = nn.Sequential(
            nn.Linear(128 * ds_size ** 2, 1),
            nn.Sigmoid()
        )
    
    def forward(self, img):
        out = self.model(img)
        out = out.view(out.shape[0], -1)
        validity = self.adv_layer(out)
        return validity
</code></pre>
<h3 id="conditional-gan-cgan"><a class="header" href="#conditional-gan-cgan">Conditional GAN (cGAN)</a></h3>
<pre><code class="language-python">class ConditionalGenerator(nn.Module):
    def __init__(self, latent_dim=100, n_classes=10, img_shape=(1, 28, 28)):
        super(ConditionalGenerator, self).__init__()
        self.img_shape = img_shape
        
        self.label_emb = nn.Embedding(n_classes, n_classes)
        
        def block(in_feat, out_feat, normalize=True):
            layers = [nn.Linear(in_feat, out_feat)]
            if normalize:
                layers.append(nn.BatchNorm1d(out_feat))
            layers.append(nn.LeakyReLU(0.2))
            return layers
        
        self.model = nn.Sequential(
            *block(latent_dim + n_classes, 128, normalize=False),
            *block(128, 256),
            *block(256, 512),
            *block(512, 1024),
            nn.Linear(1024, int(np.prod(img_shape))),
            nn.Tanh()
        )
    
    def forward(self, noise, labels):
        # Concatenate label embedding and noise
        gen_input = torch.cat((self.label_emb(labels), noise), -1)
        img = self.model(gen_input)
        img = img.view(img.size(0), *self.img_shape)
        return img

class ConditionalDiscriminator(nn.Module):
    def __init__(self, n_classes=10, img_shape=(1, 28, 28)):
        super(ConditionalDiscriminator, self).__init__()
        
        self.label_embedding = nn.Embedding(n_classes, n_classes)
        
        self.model = nn.Sequential(
            nn.Linear(n_classes + int(np.prod(img_shape)), 512),
            nn.LeakyReLU(0.2),
            nn.Dropout(0.3),
            nn.Linear(512, 256),
            nn.LeakyReLU(0.2),
            nn.Dropout(0.3),
            nn.Linear(256, 1),
            nn.Sigmoid()
        )
    
    def forward(self, img, labels):
        # Concatenate label embedding and image
        d_in = torch.cat((img.view(img.size(0), -1), self.label_embedding(labels)), -1)
        validity = self.model(d_in)
        return validity
</code></pre>
<h3 id="wasserstein-gan-wgan"><a class="header" href="#wasserstein-gan-wgan">Wasserstein GAN (WGAN)</a></h3>
<pre><code class="language-python">class WGANTrainer:
    def __init__(self, generator, discriminator, latent_dim=100, 
                 lr=0.00005, n_critic=5, clip_value=0.01):
        self.generator = generator
        self.discriminator = discriminator
        self.latent_dim = latent_dim
        self.n_critic = n_critic
        self.clip_value = clip_value
        
        # RMSprop optimizers
        self.optimizer_G = optim.RMSprop(generator.parameters(), lr=lr)
        self.optimizer_D = optim.RMSprop(discriminator.parameters(), lr=lr)
    
    def train_step(self, real_imgs):
        batch_size = real_imgs.size(0)
        
        # ---------------------
        #  Train Discriminator
        # ---------------------
        self.optimizer_D.zero_grad()
        
        # Sample noise
        z = torch.randn(batch_size, self.latent_dim)
        fake_imgs = self.generator(z).detach()
        
        # Wasserstein loss
        loss_D = -torch.mean(self.discriminator(real_imgs)) + \
                  torch.mean(self.discriminator(fake_imgs))
        
        loss_D.backward()
        self.optimizer_D.step()
        
        # Clip weights
        for p in self.discriminator.parameters():
            p.data.clamp_(-self.clip_value, self.clip_value)
        
        # Train generator every n_critic iterations
        if self.n_critic &gt; 0:
            self.n_critic -= 1
            return loss_D.item(), None
        
        # -----------------
        #  Train Generator
        # -----------------
        self.optimizer_G.zero_grad()
        
        z = torch.randn(batch_size, self.latent_dim)
        gen_imgs = self.generator(z)
        
        # Generator loss
        loss_G = -torch.mean(self.discriminator(gen_imgs))
        
        loss_G.backward()
        self.optimizer_G.step()
        
        self.n_critic = 5  # Reset
        
        return loss_D.item(), loss_G.item()
</code></pre>
<h3 id="stylegan-concepts"><a class="header" href="#stylegan-concepts">StyleGAN Concepts</a></h3>
<pre><code class="language-python">class StyleGANGenerator(nn.Module):
    """Simplified StyleGAN architecture"""
    def __init__(self, latent_dim=512, style_dim=512, n_mlp=8):
        super(StyleGANGenerator, self).__init__()
        
        # Mapping network (converts z to w)
        layers = []
        for i in range(n_mlp):
            layers.append(nn.Linear(latent_dim if i == 0 else style_dim, style_dim))
            layers.append(nn.LeakyReLU(0.2))
        self.mapping = nn.Sequential(*layers)
        
        # Synthesis network (generates image from w)
        self.const_input = nn.Parameter(torch.randn(1, 512, 4, 4))
        
        # Progressive layers with AdaIN
        self.prog_blocks = nn.ModuleList()
        self.style_blocks = nn.ModuleList()
        
        channels = [512, 512, 512, 256, 128, 64, 32]
        for i in range(len(channels) - 1):
            self.prog_blocks.append(
                nn.Sequential(
                    nn.Upsample(scale_factor=2),
                    nn.Conv2d(channels[i], channels[i+1], 3, padding=1),
                    nn.LeakyReLU(0.2)
                )
            )
            self.style_blocks.append(
                nn.Linear(style_dim, channels[i+1] * 2)  # For AdaIN
            )
        
        self.to_rgb = nn.Conv2d(channels[-1], 3, 1)
    
    def forward(self, z):
        # Map to style space
        w = self.mapping(z)
        
        # Start with constant
        x = self.const_input.repeat(z.size(0), 1, 1, 1)
        
        # Apply progressive blocks with style modulation
        for prog_block, style_block in zip(self.prog_blocks, self.style_blocks):
            x = prog_block(x)
            
            # AdaIN (Adaptive Instance Normalization)
            style = style_block(w).unsqueeze(2).unsqueeze(3)
            style_mean, style_std = style.chunk(2, 1)
            
            x = F.instance_norm(x)
            x = x * (style_std + 1) + style_mean
        
        # Convert to RGB
        img = self.to_rgb(x)
        return torch.tanh(img)
</code></pre>
<h2 id="variational-autoencoders"><a class="header" href="#variational-autoencoders">Variational Autoencoders</a></h2>
<p>VAEs learn a latent representation by maximizing a variational lower bound on the data likelihood.</p>
<p><strong>Objective (ELBO):</strong></p>
<pre><code>log p(x) ≥ E_q[log p(x|z)] - KL(q(z|x) || p(z))
</code></pre>
<h3 id="basic-vae"><a class="header" href="#basic-vae">Basic VAE</a></h3>
<pre><code class="language-python">class VAE(nn.Module):
    def __init__(self, input_dim=784, latent_dim=20, hidden_dim=400):
        super(VAE, self).__init__()
        
        # Encoder
        self.fc1 = nn.Linear(input_dim, hidden_dim)
        self.fc_mu = nn.Linear(hidden_dim, latent_dim)
        self.fc_logvar = nn.Linear(hidden_dim, latent_dim)
        
        # Decoder
        self.fc3 = nn.Linear(latent_dim, hidden_dim)
        self.fc4 = nn.Linear(hidden_dim, input_dim)
    
    def encode(self, x):
        """Encode input to latent distribution parameters"""
        h = F.relu(self.fc1(x))
        mu = self.fc_mu(h)
        logvar = self.fc_logvar(h)
        return mu, logvar
    
    def reparameterize(self, mu, logvar):
        """Reparameterization trick"""
        std = torch.exp(0.5 * logvar)
        eps = torch.randn_like(std)
        return mu + eps * std
    
    def decode(self, z):
        """Decode latent to output"""
        h = F.relu(self.fc3(z))
        return torch.sigmoid(self.fc4(h))
    
    def forward(self, x):
        mu, logvar = self.encode(x.view(-1, 784))
        z = self.reparameterize(mu, logvar)
        recon = self.decode(z)
        return recon, mu, logvar

def vae_loss(recon_x, x, mu, logvar):
    """VAE loss function"""
    # Reconstruction loss (binary cross-entropy)
    BCE = F.binary_cross_entropy(recon_x, x.view(-1, 784), reduction='sum')
    
    # KL divergence
    KLD = -0.5 * torch.sum(1 + logvar - mu.pow(2) - logvar.exp())
    
    return BCE + KLD

# Training
model = VAE()
optimizer = optim.Adam(model.parameters(), lr=0.001)

def train_vae(model, dataloader, num_epochs=10):
    model.train()
    for epoch in range(num_epochs):
        train_loss = 0
        for batch_idx, (data, _) in enumerate(dataloader):
            optimizer.zero_grad()
            
            recon_batch, mu, logvar = model(data)
            loss = vae_loss(recon_batch, data, mu, logvar)
            
            loss.backward()
            train_loss += loss.item()
            optimizer.step()
            
            if batch_idx % 100 == 0:
                print(f'Epoch: {epoch} [{batch_idx * len(data)}/{len(dataloader.dataset)}] '
                      f'Loss: {loss.item() / len(data):.4f}')
        
        print(f'Epoch {epoch} Average loss: {train_loss / len(dataloader.dataset):.4f}')
</code></pre>
<h3 id="convolutional-vae"><a class="header" href="#convolutional-vae">Convolutional VAE</a></h3>
<pre><code class="language-python">class ConvVAE(nn.Module):
    def __init__(self, latent_dim=128, channels=3):
        super(ConvVAE, self).__init__()
        
        # Encoder
        self.encoder = nn.Sequential(
            nn.Conv2d(channels, 32, 4, 2, 1),  # 32x32 -&gt; 16x16
            nn.ReLU(),
            nn.Conv2d(32, 64, 4, 2, 1),        # 16x16 -&gt; 8x8
            nn.ReLU(),
            nn.Conv2d(64, 128, 4, 2, 1),       # 8x8 -&gt; 4x4
            nn.ReLU(),
            nn.Conv2d(128, 256, 4, 2, 1),      # 4x4 -&gt; 2x2
            nn.ReLU()
        )
        
        self.fc_mu = nn.Linear(256 * 2 * 2, latent_dim)
        self.fc_logvar = nn.Linear(256 * 2 * 2, latent_dim)
        
        # Decoder
        self.fc_decode = nn.Linear(latent_dim, 256 * 2 * 2)
        
        self.decoder = nn.Sequential(
            nn.ConvTranspose2d(256, 128, 4, 2, 1),  # 2x2 -&gt; 4x4
            nn.ReLU(),
            nn.ConvTranspose2d(128, 64, 4, 2, 1),   # 4x4 -&gt; 8x8
            nn.ReLU(),
            nn.ConvTranspose2d(64, 32, 4, 2, 1),    # 8x8 -&gt; 16x16
            nn.ReLU(),
            nn.ConvTranspose2d(32, channels, 4, 2, 1),  # 16x16 -&gt; 32x32
            nn.Sigmoid()
        )
    
    def encode(self, x):
        h = self.encoder(x)
        h = h.view(h.size(0), -1)
        return self.fc_mu(h), self.fc_logvar(h)
    
    def reparameterize(self, mu, logvar):
        std = torch.exp(0.5 * logvar)
        eps = torch.randn_like(std)
        return mu + eps * std
    
    def decode(self, z):
        h = self.fc_decode(z)
        h = h.view(h.size(0), 256, 2, 2)
        return self.decoder(h)
    
    def forward(self, x):
        mu, logvar = self.encode(x)
        z = self.reparameterize(mu, logvar)
        return self.decode(z), mu, logvar
</code></pre>
<h3 id="beta-vae"><a class="header" href="#beta-vae">Beta-VAE</a></h3>
<pre><code class="language-python">def beta_vae_loss(recon_x, x, mu, logvar, beta=4.0):
    """Beta-VAE loss with adjustable KL weight"""
    # Reconstruction loss
    BCE = F.binary_cross_entropy(recon_x, x.view(-1, 784), reduction='sum')
    
    # KL divergence with beta weight
    KLD = -0.5 * torch.sum(1 + logvar - mu.pow(2) - logvar.exp())
    
    return BCE + beta * KLD
</code></pre>
<h2 id="normalizing-flows"><a class="header" href="#normalizing-flows">Normalizing Flows</a></h2>
<p>Flow models use invertible transformations to model complex distributions.</p>
<h3 id="simple-flow"><a class="header" href="#simple-flow">Simple Flow</a></h3>
<pre><code class="language-python">class CouplingLayer(nn.Module):
    """Affine coupling layer"""
    def __init__(self, dim, hidden_dim=256):
        super(CouplingLayer, self).__init__()
        self.dim = dim
        self.split = dim // 2
        
        # Scale and translate networks
        self.scale_net = nn.Sequential(
            nn.Linear(self.split, hidden_dim),
            nn.ReLU(),
            nn.Linear(hidden_dim, hidden_dim),
            nn.ReLU(),
            nn.Linear(hidden_dim, dim - self.split),
            nn.Tanh()
        )
        
        self.translate_net = nn.Sequential(
            nn.Linear(self.split, hidden_dim),
            nn.ReLU(),
            nn.Linear(hidden_dim, hidden_dim),
            nn.ReLU(),
            nn.Linear(hidden_dim, dim - self.split)
        )
    
    def forward(self, x, reverse=False):
        x1, x2 = x[:, :self.split], x[:, self.split:]
        
        if not reverse:
            # Forward pass
            s = self.scale_net(x1)
            t = self.translate_net(x1)
            y2 = x2 * torch.exp(s) + t
            y = torch.cat([x1, y2], dim=1)
            log_det = torch.sum(s, dim=1)
        else:
            # Inverse pass
            s = self.scale_net(x1)
            t = self.translate_net(x1)
            y2 = (x2 - t) * torch.exp(-s)
            y = torch.cat([x1, y2], dim=1)
            log_det = -torch.sum(s, dim=1)
        
        return y, log_det

class NormalizingFlow(nn.Module):
    def __init__(self, dim, num_layers=8):
        super(NormalizingFlow, self).__init__()
        
        self.layers = nn.ModuleList([
            CouplingLayer(dim) for _ in range(num_layers)
        ])
    
    def forward(self, x, reverse=False):
        log_det_sum = 0
        
        layers = reversed(self.layers) if reverse else self.layers
        
        for layer in layers:
            x, log_det = layer(x, reverse=reverse)
            log_det_sum += log_det
        
        return x, log_det_sum
    
    def log_prob(self, x):
        """Compute log probability"""
        z, log_det = self.forward(x, reverse=False)
        
        # Base distribution (standard normal)
        log_prob_z = -0.5 * (z ** 2 + np.log(2 * np.pi)).sum(dim=1)
        
        return log_prob_z + log_det
</code></pre>
<h2 id="autoregressive-models"><a class="header" href="#autoregressive-models">Autoregressive Models</a></h2>
<p>Generate data sequentially, one element at a time.</p>
<h3 id="pixelcnn"><a class="header" href="#pixelcnn">PixelCNN</a></h3>
<pre><code class="language-python">class MaskedConv2d(nn.Conv2d):
    """Masked convolution for autoregressive generation"""
    def __init__(self, mask_type, *args, **kwargs):
        super(MaskedConv2d, self).__init__(*args, **kwargs)
        self.register_buffer('mask', torch.zeros_like(self.weight))
        
        self.mask[:, :, :self.kernel_size[0] // 2] = 1
        self.mask[:, :, self.kernel_size[0] // 2, :self.kernel_size[1] // 2] = 1
        
        if mask_type == 'A':
            # Mask type A: exclude center pixel
            self.mask[:, :, self.kernel_size[0] // 2, self.kernel_size[1] // 2] = 0
    
    def forward(self, x):
        self.weight.data *= self.mask
        return super(MaskedConv2d, self).forward(x)

class PixelCNN(nn.Module):
    def __init__(self, n_channels=1, n_filters=64, n_layers=7):
        super(PixelCNN, self).__init__()
        
        self.layers = nn.ModuleList()
        
        # First layer (mask type A)
        self.layers.append(
            nn.Sequential(
                MaskedConv2d('A', n_channels, n_filters, 7, padding=3),
                nn.BatchNorm2d(n_filters),
                nn.ReLU()
            )
        )
        
        # Hidden layers (mask type B)
        for _ in range(n_layers):
            self.layers.append(
                nn.Sequential(
                    MaskedConv2d('B', n_filters, n_filters, 7, padding=3),
                    nn.BatchNorm2d(n_filters),
                    nn.ReLU()
                )
            )
        
        # Output layer
        self.output = nn.Conv2d(n_filters, n_channels * 256, 1)
    
    def forward(self, x):
        for layer in self.layers:
            x = layer(x)
        
        x = self.output(x)
        
        # Reshape for pixel-wise softmax
        b, _, h, w = x.size()
        x = x.view(b, 256, -1, h, w)
        
        return x
</code></pre>
<h2 id="energy-based-models"><a class="header" href="#energy-based-models">Energy-Based Models</a></h2>
<p>Model probability as energy function: p(x) ∝ exp(-E(x))</p>
<pre><code class="language-python">class EnergyBasedModel(nn.Module):
    def __init__(self, input_dim):
        super(EnergyBasedModel, self).__init__()
        
        self.energy_net = nn.Sequential(
            nn.Linear(input_dim, 256),
            nn.ReLU(),
            nn.Linear(256, 256),
            nn.ReLU(),
            nn.Linear(256, 1)
        )
    
    def energy(self, x):
        """Compute energy E(x)"""
        return self.energy_net(x)
    
    def sample_langevin(self, x, n_steps=100, step_size=0.01):
        """Sample using Langevin dynamics"""
        x = x.clone().detach().requires_grad_(True)
        
        for _ in range(n_steps):
            energy = self.energy(x).sum()
            grad = torch.autograd.grad(energy, x)[0]
            
            noise = torch.randn_like(x) * np.sqrt(step_size * 2)
            x = x - step_size * grad + noise
        
        return x.detach()
</code></pre>
<h2 id="diffusion-models"><a class="header" href="#diffusion-models">Diffusion Models</a></h2>
<p>Gradually add noise then learn to denoise.</p>
<h3 id="ddpm-denoising-diffusion-probabilistic-models"><a class="header" href="#ddpm-denoising-diffusion-probabilistic-models">DDPM (Denoising Diffusion Probabilistic Models)</a></h3>
<pre><code class="language-python">class DiffusionModel(nn.Module):
    def __init__(self, timesteps=1000):
        super(DiffusionModel, self).__init__()
        self.timesteps = timesteps
        
        # Linear beta schedule
        self.betas = torch.linspace(0.0001, 0.02, timesteps)
        self.alphas = 1 - self.betas
        self.alphas_cumprod = torch.cumprod(self.alphas, dim=0)
        
        # Noise prediction network (U-Net)
        self.noise_predictor = self._build_unet()
    
    def _build_unet(self):
        """Simple U-Net for noise prediction"""
        # Simplified version
        return nn.Sequential(
            nn.Conv2d(3, 64, 3, padding=1),
            nn.ReLU(),
            nn.Conv2d(64, 64, 3, padding=1),
            nn.ReLU(),
            nn.Conv2d(64, 3, 3, padding=1)
        )
    
    def q_sample(self, x0, t, noise=None):
        """Forward diffusion: add noise to x0"""
        if noise is None:
            noise = torch.randn_like(x0)
        
        sqrt_alphas_cumprod_t = self.alphas_cumprod[t].sqrt()
        sqrt_one_minus_alphas_cumprod_t = (1 - self.alphas_cumprod[t]).sqrt()
        
        return sqrt_alphas_cumprod_t * x0 + sqrt_one_minus_alphas_cumprod_t * noise
    
    def p_sample(self, xt, t):
        """Reverse diffusion: denoise xt"""
        # Predict noise
        predicted_noise = self.noise_predictor(xt)
        
        # Compute x_{t-1}
        alpha_t = self.alphas[t]
        alpha_cumprod_t = self.alphas_cumprod[t]
        beta_t = self.betas[t]
        
        x0_pred = (xt - ((1 - alpha_t) / (1 - alpha_cumprod_t).sqrt()) * predicted_noise) / alpha_t.sqrt()
        
        if t &gt; 0:
            noise = torch.randn_like(xt)
            x_prev = x0_pred * alpha_t.sqrt() + (1 - alpha_t).sqrt() * noise
        else:
            x_prev = x0_pred
        
        return x_prev
    
    def sample(self, shape):
        """Generate samples"""
        device = next(self.parameters()).device
        
        # Start from random noise
        x = torch.randn(shape).to(device)
        
        # Iteratively denoise
        for t in reversed(range(self.timesteps)):
            x = self.p_sample(x, t)
        
        return x
</code></pre>
<h2 id="evaluation-metrics-1"><a class="header" href="#evaluation-metrics-1">Evaluation Metrics</a></h2>
<pre><code class="language-python"># Inception Score (IS)
def inception_score(imgs, splits=10):
    """Higher is better"""
    from torchvision.models import inception_v3
    
    inception_model = inception_v3(pretrained=True, transform_input=False)
    inception_model.eval()
    
    # Get predictions
    with torch.no_grad():
        preds = inception_model(imgs)
        preds = F.softmax(preds, dim=1)
    
    # Compute IS
    split_scores = []
    for k in range(splits):
        part = preds[k * (len(preds) // splits): (k + 1) * (len(preds) // splits)]
        py = part.mean(dim=0)
        scores = []
        for i in range(part.shape[0]):
            pyx = part[i]
            scores.append((pyx * (torch.log(pyx) - torch.log(py))).sum())
        split_scores.append(torch.exp(torch.mean(torch.stack(scores))))
    
    return torch.mean(torch.stack(split_scores)), torch.std(torch.stack(split_scores))

# Fréchet Inception Distance (FID)
def calculate_fid(real_imgs, fake_imgs):
    """Lower is better"""
    # Extract features using Inception network
    # Calculate mean and covariance
    # Compute FID score
    pass
</code></pre>
<h2 id="practical-tips-6"><a class="header" href="#practical-tips-6">Practical Tips</a></h2>
<ol>
<li><strong>GAN Training</strong>: Balance G and D, use label smoothing, add noise to inputs</li>
<li><strong>VAE</strong>: Choose appropriate beta value, use warm-up for KL term</li>
<li><strong>Stability</strong>: Monitor losses, use spectral normalization</li>
<li><strong>Architecture</strong>: Start simple, gradually add complexity</li>
<li><strong>Evaluation</strong>: Use multiple metrics (IS, FID, visual inspection)</li>
</ol>
<h2 id="resources-16"><a class="header" href="#resources-16">Resources</a></h2>
<ul>
<li>"Generative Deep Learning" by David Foster</li>
<li>OpenAI papers: https://openai.com/research/</li>
<li>Distill.pub: https://distill.pub/</li>
<li>Papers with Code: https://paperswithcode.com/</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="deep-generative-models"><a class="header" href="#deep-generative-models">Deep Generative Models</a></h1>
<p>Advanced architectures and techniques for generating high-quality data.</p>
<h2 id="table-of-contents-21"><a class="header" href="#table-of-contents-21">Table of Contents</a></h2>
<ol>
<li><a href="machine_learning/deep_generative_models.html#transformer-based-generative-models">Transformer-based Generative Models</a></li>
<li><a href="machine_learning/deep_generative_models.html#diffusion-models">Diffusion Models</a></li>
<li><a href="machine_learning/deep_generative_models.html#vector-quantized-models">Vector Quantized Models</a></li>
<li><a href="machine_learning/deep_generative_models.html#nerf-and-3d-generation">NeRF and 3D Generation</a></li>
<li><a href="machine_learning/deep_generative_models.html#multimodal-generative-models">Multimodal Generative Models</a></li>
</ol>
<h2 id="transformer-based-generative-models"><a class="header" href="#transformer-based-generative-models">Transformer-based Generative Models</a></h2>
<h3 id="gpt-generative-pre-trained-transformer"><a class="header" href="#gpt-generative-pre-trained-transformer">GPT (Generative Pre-trained Transformer)</a></h3>
<pre><code class="language-python">import torch
import torch.nn as nn
import torch.nn.functional as F
import math

class MultiHeadAttention(nn.Module):
    def __init__(self, d_model, num_heads, dropout=0.1):
        super(MultiHeadAttention, self).__init__()
        assert d_model % num_heads == 0
        
        self.d_model = d_model
        self.num_heads = num_heads
        self.d_k = d_model // num_heads
        
        self.W_q = nn.Linear(d_model, d_model)
        self.W_k = nn.Linear(d_model, d_model)
        self.W_v = nn.Linear(d_model, d_model)
        self.W_o = nn.Linear(d_model, d_model)
        
        self.dropout = nn.Dropout(dropout)
    
    def forward(self, query, key, value, mask=None):
        batch_size = query.size(0)
        
        # Linear projections
        Q = self.W_q(query).view(batch_size, -1, self.num_heads, self.d_k).transpose(1, 2)
        K = self.W_k(key).view(batch_size, -1, self.num_heads, self.d_k).transpose(1, 2)
        V = self.W_v(value).view(batch_size, -1, self.num_heads, self.d_k).transpose(1, 2)
        
        # Scaled dot-product attention
        scores = torch.matmul(Q, K.transpose(-2, -1)) / math.sqrt(self.d_k)
        
        if mask is not None:
            scores = scores.masked_fill(mask == 0, -1e9)
        
        attn_weights = F.softmax(scores, dim=-1)
        attn_weights = self.dropout(attn_weights)
        
        context = torch.matmul(attn_weights, V)
        
        # Concatenate heads
        context = context.transpose(1, 2).contiguous().view(batch_size, -1, self.d_model)
        
        # Final linear projection
        output = self.W_o(context)
        
        return output, attn_weights

class FeedForward(nn.Module):
    def __init__(self, d_model, d_ff, dropout=0.1):
        super(FeedForward, self).__init__()
        self.linear1 = nn.Linear(d_model, d_ff)
        self.linear2 = nn.Linear(d_ff, d_model)
        self.dropout = nn.Dropout(dropout)
    
    def forward(self, x):
        return self.linear2(self.dropout(F.gelu(self.linear1(x))))

class TransformerBlock(nn.Module):
    def __init__(self, d_model, num_heads, d_ff, dropout=0.1):
        super(TransformerBlock, self).__init__()
        
        self.attention = MultiHeadAttention(d_model, num_heads, dropout)
        self.feed_forward = FeedForward(d_model, d_ff, dropout)
        
        self.norm1 = nn.LayerNorm(d_model)
        self.norm2 = nn.LayerNorm(d_model)
        
        self.dropout1 = nn.Dropout(dropout)
        self.dropout2 = nn.Dropout(dropout)
    
    def forward(self, x, mask=None):
        # Multi-head attention with residual connection
        attn_output, _ = self.attention(x, x, x, mask)
        x = self.norm1(x + self.dropout1(attn_output))
        
        # Feed-forward with residual connection
        ff_output = self.feed_forward(x)
        x = self.norm2(x + self.dropout2(ff_output))
        
        return x

class GPTModel(nn.Module):
    def __init__(self, vocab_size, d_model=768, num_heads=12, num_layers=12, 
                 d_ff=3072, max_seq_length=1024, dropout=0.1):
        super(GPTModel, self).__init__()
        
        self.d_model = d_model
        self.max_seq_length = max_seq_length
        
        # Token and position embeddings
        self.token_embedding = nn.Embedding(vocab_size, d_model)
        self.position_embedding = nn.Embedding(max_seq_length, d_model)
        
        # Transformer blocks
        self.blocks = nn.ModuleList([
            TransformerBlock(d_model, num_heads, d_ff, dropout)
            for _ in range(num_layers)
        ])
        
        # Output projection
        self.ln_f = nn.LayerNorm(d_model)
        self.head = nn.Linear(d_model, vocab_size, bias=False)
        
        self.dropout = nn.Dropout(dropout)
    
    def forward(self, input_ids, targets=None):
        batch_size, seq_length = input_ids.size()
        
        # Create position ids
        position_ids = torch.arange(seq_length, dtype=torch.long, device=input_ids.device)
        position_ids = position_ids.unsqueeze(0).expand_as(input_ids)
        
        # Embeddings
        token_embeds = self.token_embedding(input_ids)
        position_embeds = self.position_embedding(position_ids)
        x = self.dropout(token_embeds + position_embeds)
        
        # Causal mask
        mask = torch.tril(torch.ones(seq_length, seq_length, device=input_ids.device))
        mask = mask.view(1, 1, seq_length, seq_length)
        
        # Transformer blocks
        for block in self.blocks:
            x = block(x, mask)
        
        # Output
        x = self.ln_f(x)
        logits = self.head(x)
        
        loss = None
        if targets is not None:
            loss = F.cross_entropy(logits.view(-1, logits.size(-1)), targets.view(-1))
        
        return logits, loss
    
    def generate(self, input_ids, max_new_tokens=50, temperature=1.0, top_k=None):
        """Generate text autoregressively"""
        for _ in range(max_new_tokens):
            # Crop context if needed
            idx_cond = input_ids if input_ids.size(1) &lt;= self.max_seq_length else input_ids[:, -self.max_seq_length:]
            
            # Forward pass
            logits, _ = self.forward(idx_cond)
            logits = logits[:, -1, :] / temperature
            
            # Top-k sampling
            if top_k is not None:
                v, _ = torch.topk(logits, min(top_k, logits.size(-1)))
                logits[logits &lt; v[:, [-1]]] = -float('Inf')
            
            # Sample
            probs = F.softmax(logits, dim=-1)
            next_token = torch.multinomial(probs, num_samples=1)
            
            # Append
            input_ids = torch.cat([input_ids, next_token], dim=1)
        
        return input_ids

# Training example
model = GPTModel(vocab_size=50257, d_model=768, num_heads=12, num_layers=12)
optimizer = torch.optim.AdamW(model.parameters(), lr=6e-4, betas=(0.9, 0.95))

def train_step(input_ids, targets):
    optimizer.zero_grad()
    logits, loss = model(input_ids, targets)
    loss.backward()
    torch.nn.utils.clip_grad_norm_(model.parameters(), 1.0)
    optimizer.step()
    return loss.item()
</code></pre>
<h3 id="vision-transformer-for-generation-vit-vqgan"><a class="header" href="#vision-transformer-for-generation-vit-vqgan">Vision Transformer for Generation (ViT-VQGAN)</a></h3>
<pre><code class="language-python">class VisionTransformerGenerator(nn.Module):
    def __init__(self, img_size=256, patch_size=16, embed_dim=768, num_heads=12, depth=12):
        super(VisionTransformerGenerator, self).__init__()
        
        self.patch_size = patch_size
        self.num_patches = (img_size // patch_size) ** 2
        
        # Patch embedding
        self.patch_embed = nn.Conv2d(3, embed_dim, kernel_size=patch_size, stride=patch_size)
        
        # Position embedding
        self.pos_embed = nn.Parameter(torch.zeros(1, self.num_patches, embed_dim))
        
        # Transformer blocks
        self.blocks = nn.ModuleList([
            TransformerBlock(embed_dim, num_heads, embed_dim * 4)
            for _ in range(depth)
        ])
        
        # Decoder
        self.decoder = nn.Sequential(
            nn.ConvTranspose2d(embed_dim, 512, 4, 2, 1),
            nn.ReLU(),
            nn.ConvTranspose2d(512, 256, 4, 2, 1),
            nn.ReLU(),
            nn.ConvTranspose2d(256, 128, 4, 2, 1),
            nn.ReLU(),
            nn.ConvTranspose2d(128, 64, 4, 2, 1),
            nn.ReLU(),
            nn.ConvTranspose2d(64, 3, 4, 2, 1),
            nn.Tanh()
        )
    
    def forward(self, x):
        # Patch embedding
        x = self.patch_embed(x)
        x = x.flatten(2).transpose(1, 2)
        
        # Add position embedding
        x = x + self.pos_embed
        
        # Transformer blocks
        for block in self.blocks:
            x = block(x)
        
        # Reshape for decoder
        b, n, c = x.shape
        h = w = int(math.sqrt(n))
        x = x.transpose(1, 2).reshape(b, c, h, w)
        
        # Decode
        x = self.decoder(x)
        
        return x
</code></pre>
<h2 id="diffusion-models-1"><a class="header" href="#diffusion-models-1">Diffusion Models</a></h2>
<h3 id="improved-ddpm"><a class="header" href="#improved-ddpm">Improved DDPM</a></h3>
<pre><code class="language-python">class ImprovedDDPM(nn.Module):
    def __init__(self, img_channels=3, base_channels=128, timesteps=1000):
        super(ImprovedDDPM, self).__init__()
        
        self.timesteps = timesteps
        
        # Variance schedule (cosine)
        self.betas = self._cosine_beta_schedule(timesteps)
        self.alphas = 1.0 - self.betas
        self.alphas_cumprod = torch.cumprod(self.alphas, dim=0)
        self.alphas_cumprod_prev = F.pad(self.alphas_cumprod[:-1], (1, 0), value=1.0)
        
        # U-Net architecture
        self.time_embed = nn.Sequential(
            nn.Linear(base_channels, base_channels * 4),
            nn.SiLU(),
            nn.Linear(base_channels * 4, base_channels * 4)
        )
        
        # Encoder
        self.down1 = self._make_down_block(img_channels, base_channels)
        self.down2 = self._make_down_block(base_channels, base_channels * 2)
        self.down3 = self._make_down_block(base_channels * 2, base_channels * 4)
        
        # Bottleneck
        self.mid = self._make_res_block(base_channels * 4)
        
        # Decoder
        self.up3 = self._make_up_block(base_channels * 4, base_channels * 2)
        self.up2 = self._make_up_block(base_channels * 2, base_channels)
        self.up1 = self._make_up_block(base_channels, img_channels)
    
    def _cosine_beta_schedule(self, timesteps, s=0.008):
        """Cosine schedule for betas"""
        steps = timesteps + 1
        x = torch.linspace(0, timesteps, steps)
        alphas_cumprod = torch.cos(((x / timesteps) + s) / (1 + s) * math.pi * 0.5) ** 2
        alphas_cumprod = alphas_cumprod / alphas_cumprod[0]
        betas = 1 - (alphas_cumprod[1:] / alphas_cumprod[:-1])
        return torch.clip(betas, 0.0001, 0.9999)
    
    def _make_down_block(self, in_channels, out_channels):
        return nn.Sequential(
            nn.Conv2d(in_channels, out_channels, 3, padding=1),
            nn.GroupNorm(8, out_channels),
            nn.SiLU(),
            nn.Conv2d(out_channels, out_channels, 3, padding=1),
            nn.GroupNorm(8, out_channels),
            nn.SiLU(),
            nn.MaxPool2d(2)
        )
    
    def _make_up_block(self, in_channels, out_channels):
        return nn.Sequential(
            nn.Upsample(scale_factor=2),
            nn.Conv2d(in_channels, out_channels, 3, padding=1),
            nn.GroupNorm(8, out_channels),
            nn.SiLU(),
            nn.Conv2d(out_channels, out_channels, 3, padding=1),
            nn.GroupNorm(8, out_channels),
            nn.SiLU()
        )
    
    def _make_res_block(self, channels):
        return nn.Sequential(
            nn.Conv2d(channels, channels, 3, padding=1),
            nn.GroupNorm(8, channels),
            nn.SiLU(),
            nn.Conv2d(channels, channels, 3, padding=1),
            nn.GroupNorm(8, channels),
            nn.SiLU()
        )
    
    def forward(self, x, t):
        """Predict noise"""
        # Time embedding
        t_emb = self._get_timestep_embedding(t, x.device)
        t_emb = self.time_embed(t_emb)
        
        # U-Net forward
        h1 = self.down1(x)
        h2 = self.down2(h1)
        h3 = self.down3(h2)
        
        h = self.mid(h3)
        
        h = self.up3(h + h3)
        h = self.up2(h + h2)
        h = self.up1(h + h1)
        
        return h
    
    def _get_timestep_embedding(self, timesteps, device, dim=128):
        """Sinusoidal positional embedding"""
        half_dim = dim // 2
        emb = math.log(10000) / (half_dim - 1)
        emb = torch.exp(torch.arange(half_dim, device=device) * -emb)
        emb = timesteps[:, None] * emb[None, :]
        emb = torch.cat([torch.sin(emb), torch.cos(emb)], dim=-1)
        return emb
    
    @torch.no_grad()
    def sample(self, batch_size, img_size, device):
        """DDPM sampling"""
        # Start from random noise
        img = torch.randn(batch_size, 3, img_size, img_size, device=device)
        
        for t in reversed(range(self.timesteps)):
            t_batch = torch.full((batch_size,), t, device=device, dtype=torch.long)
            
            # Predict noise
            predicted_noise = self.forward(img, t_batch)
            
            # Compute x_{t-1}
            alpha_t = self.alphas[t]
            alpha_cumprod_t = self.alphas_cumprod[t]
            beta_t = self.betas[t]
            
            if t &gt; 0:
                noise = torch.randn_like(img)
            else:
                noise = torch.zeros_like(img)
            
            img = (1 / alpha_t.sqrt()) * (img - ((1 - alpha_t) / (1 - alpha_cumprod_t).sqrt()) * predicted_noise)
            img = img + beta_t.sqrt() * noise
        
        return img
</code></pre>
<h3 id="latent-diffusion-models-stable-diffusion"><a class="header" href="#latent-diffusion-models-stable-diffusion">Latent Diffusion Models (Stable Diffusion)</a></h3>
<pre><code class="language-python">class LatentDiffusion(nn.Module):
    def __init__(self, vae, unet, text_encoder):
        super(LatentDiffusion, self).__init__()
        
        self.vae = vae  # VAE for encoding/decoding images
        self.unet = unet  # U-Net for denoising in latent space
        self.text_encoder = text_encoder  # CLIP text encoder
        
        self.timesteps = 1000
        self.betas = torch.linspace(0.0001, 0.02, self.timesteps)
        self.alphas = 1.0 - self.betas
        self.alphas_cumprod = torch.cumprod(self.alphas, dim=0)
    
    def forward(self, images, text_embeddings, t):
        """Training forward pass"""
        # Encode images to latent space
        with torch.no_grad():
            latents = self.vae.encode(images)
        
        # Add noise
        noise = torch.randn_like(latents)
        noisy_latents = self._add_noise(latents, noise, t)
        
        # Predict noise conditioned on text
        predicted_noise = self.unet(noisy_latents, t, text_embeddings)
        
        # Loss
        loss = F.mse_loss(predicted_noise, noise)
        
        return loss
    
    def _add_noise(self, latents, noise, t):
        """Add noise according to schedule"""
        sqrt_alpha_prod = self.alphas_cumprod[t] ** 0.5
        sqrt_one_minus_alpha_prod = (1 - self.alphas_cumprod[t]) ** 0.5
        
        return sqrt_alpha_prod * latents + sqrt_one_minus_alpha_prod * noise
    
    @torch.no_grad()
    def generate(self, text, batch_size=1, guidance_scale=7.5):
        """Text-to-image generation"""
        # Encode text
        text_embeddings = self.text_encoder(text)
        
        # Start from random noise in latent space
        latents = torch.randn(batch_size, 4, 64, 64)
        
        # Denoising loop
        for t in reversed(range(self.timesteps)):
            t_batch = torch.full((batch_size,), t)
            
            # Predict noise with and without conditioning (classifier-free guidance)
            noise_pred_text = self.unet(latents, t_batch, text_embeddings)
            noise_pred_uncond = self.unet(latents, t_batch, None)
            
            # Apply guidance
            noise_pred = noise_pred_uncond + guidance_scale * (noise_pred_text - noise_pred_uncond)
            
            # Update latents
            latents = self._denoise_step(latents, noise_pred, t)
        
        # Decode latents to images
        images = self.vae.decode(latents)
        
        return images
    
    def _denoise_step(self, latents, noise, t):
        """Single denoising step"""
        alpha_t = self.alphas[t]
        alpha_cumprod_t = self.alphas_cumprod[t]
        beta_t = self.betas[t]
        
        pred_original = (latents - ((1 - alpha_t) / (1 - alpha_cumprod_t).sqrt()) * noise) / alpha_t.sqrt()
        
        if t &gt; 0:
            noise = torch.randn_like(latents)
            latents = pred_original * alpha_t.sqrt() + (1 - alpha_t).sqrt() * noise
        else:
            latents = pred_original
        
        return latents
</code></pre>
<h2 id="vector-quantized-models"><a class="header" href="#vector-quantized-models">Vector Quantized Models</a></h2>
<h3 id="vq-vae"><a class="header" href="#vq-vae">VQ-VAE</a></h3>
<pre><code class="language-python">class VectorQuantizer(nn.Module):
    def __init__(self, num_embeddings, embedding_dim, commitment_cost=0.25):
        super(VectorQuantizer, self).__init__()
        
        self.embedding_dim = embedding_dim
        self.num_embeddings = num_embeddings
        self.commitment_cost = commitment_cost
        
        self.embeddings = nn.Embedding(num_embeddings, embedding_dim)
        self.embeddings.weight.data.uniform_(-1/num_embeddings, 1/num_embeddings)
    
    def forward(self, inputs):
        # Flatten input
        flat_input = inputs.view(-1, self.embedding_dim)
        
        # Calculate distances
        distances = (torch.sum(flat_input**2, dim=1, keepdim=True)
                    + torch.sum(self.embeddings.weight**2, dim=1)
                    - 2 * torch.matmul(flat_input, self.embeddings.weight.t()))
        
        # Get closest embeddings
        encoding_indices = torch.argmin(distances, dim=1).unsqueeze(1)
        encodings = torch.zeros(encoding_indices.shape[0], self.num_embeddings, device=inputs.device)
        encodings.scatter_(1, encoding_indices, 1)
        
        # Quantize
        quantized = torch.matmul(encodings, self.embeddings.weight)
        quantized = quantized.view_as(inputs)
        
        # Loss
        e_latent_loss = F.mse_loss(quantized.detach(), inputs)
        q_latent_loss = F.mse_loss(quantized, inputs.detach())
        loss = q_latent_loss + self.commitment_cost * e_latent_loss
        
        # Straight-through estimator
        quantized = inputs + (quantized - inputs).detach()
        
        return quantized, loss, encoding_indices

class VQVAE(nn.Module):
    def __init__(self, num_embeddings=512, embedding_dim=64):
        super(VQVAE, self).__init__()
        
        # Encoder
        self.encoder = nn.Sequential(
            nn.Conv2d(3, 64, 4, 2, 1),
            nn.ReLU(),
            nn.Conv2d(64, 128, 4, 2, 1),
            nn.ReLU(),
            nn.Conv2d(128, embedding_dim, 3, 1, 1)
        )
        
        # Vector quantizer
        self.vq = VectorQuantizer(num_embeddings, embedding_dim)
        
        # Decoder
        self.decoder = nn.Sequential(
            nn.ConvTranspose2d(embedding_dim, 128, 3, 1, 1),
            nn.ReLU(),
            nn.ConvTranspose2d(128, 64, 4, 2, 1),
            nn.ReLU(),
            nn.ConvTranspose2d(64, 3, 4, 2, 1),
            nn.Tanh()
        )
    
    def forward(self, x):
        z = self.encoder(x)
        quantized, vq_loss, _ = self.vq(z)
        recon = self.decoder(quantized)
        
        recon_loss = F.mse_loss(recon, x)
        
        return recon, recon_loss + vq_loss
</code></pre>
<h2 id="nerf-and-3d-generation"><a class="header" href="#nerf-and-3d-generation">NeRF and 3D Generation</a></h2>
<h3 id="neural-radiance-fields"><a class="header" href="#neural-radiance-fields">Neural Radiance Fields</a></h3>
<pre><code class="language-python">class NeRF(nn.Module):
    def __init__(self, pos_dim=3, dir_dim=3, hidden_dim=256):
        super(NeRF, self).__init__()
        
        # Position encoding
        self.pos_encoder = self._positional_encoding
        self.dir_encoder = self._positional_encoding
        
        # MLP for density and features
        self.density_net = nn.Sequential(
            nn.Linear(pos_dim * 2 * 10, hidden_dim),
            nn.ReLU(),
            nn.Linear(hidden_dim, hidden_dim),
            nn.ReLU(),
            nn.Linear(hidden_dim, hidden_dim),
            nn.ReLU(),
            nn.Linear(hidden_dim, hidden_dim + 1)  # density + features
        )
        
        # MLP for color
        self.color_net = nn.Sequential(
            nn.Linear(hidden_dim + dir_dim * 2 * 4, hidden_dim // 2),
            nn.ReLU(),
            nn.Linear(hidden_dim // 2, 3),
            nn.Sigmoid()
        )
    
    def _positional_encoding(self, x, L=10):
        """Positional encoding for coordinates"""
        encoding = []
        for l in range(L):
            encoding.append(torch.sin(2**l * math.pi * x))
            encoding.append(torch.cos(2**l * math.pi * x))
        return torch.cat(encoding, dim=-1)
    
    def forward(self, positions, directions):
        # Encode positions and directions
        pos_enc = self.pos_encoder(positions)
        dir_enc = self.dir_encoder(directions)
        
        # Get density and features
        density_features = self.density_net(pos_enc)
        density = F.relu(density_features[:, :1])
        features = density_features[:, 1:]
        
        # Get color
        color_input = torch.cat([features, dir_enc], dim=-1)
        color = self.color_net(color_input)
        
        return density, color
    
    def render_rays(self, ray_origins, ray_directions, near=2.0, far=6.0, n_samples=64):
        """Volume rendering along rays"""
        # Sample points along rays
        t_vals = torch.linspace(near, far, n_samples, device=ray_origins.device)
        points = ray_origins[:, None, :] + ray_directions[:, None, :] * t_vals[None, :, None]
        
        # Flatten for network
        points_flat = points.reshape(-1, 3)
        dirs_flat = ray_directions[:, None, :].expand_as(points).reshape(-1, 3)
        
        # Get density and color
        density, color = self.forward(points_flat, dirs_flat)
        
        # Reshape
        density = density.reshape(points.shape[0], n_samples)
        color = color.reshape(points.shape[0], n_samples, 3)
        
        # Volume rendering
        dists = t_vals[1:] - t_vals[:-1]
        dists = torch.cat([dists, torch.tensor([1e10], device=dists.device)])
        
        alpha = 1.0 - torch.exp(-density * dists)
        transmittance = torch.cumprod(1.0 - alpha + 1e-10, dim=-1)
        transmittance = torch.cat([torch.ones_like(transmittance[:, :1]), transmittance[:, :-1]], dim=-1)
        
        weights = alpha * transmittance
        rgb = torch.sum(weights[:, :, None] * color, dim=1)
        
        return rgb
</code></pre>
<h2 id="multimodal-generative-models"><a class="header" href="#multimodal-generative-models">Multimodal Generative Models</a></h2>
<h3 id="clip-guided-generation"><a class="header" href="#clip-guided-generation">CLIP-guided Generation</a></h3>
<pre><code class="language-python">class CLIPGuidedGenerator:
    def __init__(self, generator, clip_model):
        self.generator = generator
        self.clip_model = clip_model
    
    def generate(self, text_prompt, num_steps=100, lr=0.1):
        """Generate image guided by CLIP text embedding"""
        # Encode text
        with torch.no_grad():
            text_features = self.clip_model.encode_text(text_prompt)
        
        # Start with random latent
        latent = torch.randn(1, 512, requires_grad=True)
        optimizer = torch.optim.Adam([latent], lr=lr)
        
        for step in range(num_steps):
            optimizer.zero_grad()
            
            # Generate image
            image = self.generator(latent)
            
            # Encode image with CLIP
            image_features = self.clip_model.encode_image(image)
            
            # CLIP loss (maximize similarity)
            loss = -torch.cosine_similarity(text_features, image_features).mean()
            
            loss.backward()
            optimizer.step()
            
            if step % 10 == 0:
                print(f"Step {step}, Loss: {loss.item():.4f}")
        
        # Generate final image
        with torch.no_grad():
            final_image = self.generator(latent)
        
        return final_image
</code></pre>
<h2 id="practical-tips-7"><a class="header" href="#practical-tips-7">Practical Tips</a></h2>
<ol>
<li><strong>Model Size</strong>: Start small, scale up gradually</li>
<li><strong>Training Stability</strong>: Use gradient clipping, EMA</li>
<li><strong>Quality Metrics</strong>: FID, IS, LPIPS for evaluation</li>
<li><strong>Computational Efficiency</strong>: Use mixed precision, model parallelism</li>
<li><strong>Fine-tuning</strong>: Transfer from pre-trained models</li>
</ol>
<h2 id="resources-17"><a class="header" href="#resources-17">Resources</a></h2>
<ul>
<li>Stable Diffusion: https://github.com/CompVis/stable-diffusion</li>
<li>DALL-E 2 paper: https://arxiv.org/abs/2204.06125</li>
<li>Imagen paper: https://arxiv.org/abs/2205.11487</li>
<li>NeRF: https://www.matthewtancik.com/nerf</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="transfer-learning"><a class="header" href="#transfer-learning">Transfer Learning</a></h1>
<p>Transfer learning leverages knowledge from pre-trained models to solve new tasks with limited data.</p>
<h2 id="table-of-contents-22"><a class="header" href="#table-of-contents-22">Table of Contents</a></h2>
<ol>
<li><a href="machine_learning/transfer_learning.html#introduction">Introduction</a></li>
<li><a href="machine_learning/transfer_learning.html#pre-training-strategies">Pre-training Strategies</a></li>
<li><a href="machine_learning/transfer_learning.html#fine-tuning-techniques">Fine-tuning Techniques</a></li>
<li><a href="machine_learning/transfer_learning.html#domain-adaptation">Domain Adaptation</a></li>
<li><a href="machine_learning/transfer_learning.html#few-shot-learning">Few-Shot Learning</a></li>
<li><a href="machine_learning/transfer_learning.html#model-distillation">Model Distillation</a></li>
</ol>
<h2 id="introduction-5"><a class="header" href="#introduction-5">Introduction</a></h2>
<p><strong>Key Concepts:</strong></p>
<ul>
<li><strong>Pre-training</strong>: Training on large dataset for general features</li>
<li><strong>Fine-tuning</strong>: Adapting pre-trained model to specific task</li>
<li><strong>Feature Extraction</strong>: Using pre-trained model as fixed feature extractor</li>
<li><strong>Domain Shift</strong>: Difference between source and target distributions</li>
</ul>
<p><strong>When to Use Transfer Learning:</strong></p>
<ul>
<li>Limited target data</li>
<li>Similar source and target tasks</li>
<li>Computational constraints</li>
<li>Need for faster convergence</li>
</ul>
<h2 id="pre-training-strategies"><a class="header" href="#pre-training-strategies">Pre-training Strategies</a></h2>
<h3 id="self-supervised-pre-training"><a class="header" href="#self-supervised-pre-training">Self-Supervised Pre-training</a></h3>
<pre><code class="language-python">import torch
import torch.nn as nn
import torch.optim as optim
import torchvision.models as models
import torchvision.transforms as transforms

# Contrastive Learning (SimCLR)
class SimCLR(nn.Module):
    def __init__(self, base_encoder, projection_dim=128):
        super(SimCLR, self).__init__()
        
        self.encoder = base_encoder
        
        # Remove classification head
        self.encoder.fc = nn.Identity()
        
        # Projection head
        self.projection = nn.Sequential(
            nn.Linear(512, 512),
            nn.ReLU(),
            nn.Linear(512, projection_dim)
        )
    
    def forward(self, x):
        h = self.encoder(x)
        z = self.projection(h)
        return F.normalize(z, dim=1)

def contrastive_loss(z_i, z_j, temperature=0.5):
    """NT-Xent loss for contrastive learning"""
    batch_size = z_i.shape[0]
    
    # Concatenate representations
    z = torch.cat([z_i, z_j], dim=0)
    
    # Compute similarity matrix
    similarity_matrix = torch.matmul(z, z.T) / temperature
    
    # Create labels
    labels = torch.arange(batch_size, device=z.device)
    labels = torch.cat([labels + batch_size, labels])
    
    # Mask out self-similarity
    mask = torch.eye(2 * batch_size, device=z.device).bool()
    similarity_matrix = similarity_matrix.masked_fill(mask, -float('inf'))
    
    # Compute loss
    loss = F.cross_entropy(similarity_matrix, labels)
    
    return loss

# Training SimCLR
def train_simclr(model, train_loader, num_epochs=100):
    optimizer = optim.Adam(model.parameters(), lr=0.001)
    
    for epoch in range(num_epochs):
        total_loss = 0
        
        for (x1, x2), _ in train_loader:  # x1, x2 are augmented views
            optimizer.zero_grad()
            
            # Get representations
            z1 = model(x1)
            z2 = model(x2)
            
            # Compute loss
            loss = contrastive_loss(z1, z2)
            
            loss.backward()
            optimizer.step()
            
            total_loss += loss.item()
        
        print(f"Epoch {epoch+1}, Loss: {total_loss/len(train_loader):.4f}")
    
    return model

# Create augmented pairs
class ContrastiveTransform:
    def __init__(self):
        self.transform = transforms.Compose([
            transforms.RandomResizedCrop(224),
            transforms.RandomHorizontalFlip(),
            transforms.ColorJitter(0.4, 0.4, 0.4, 0.1),
            transforms.RandomGrayscale(p=0.2),
            transforms.ToTensor(),
            transforms.Normalize([0.485, 0.456, 0.406], [0.229, 0.224, 0.225])
        ])
    
    def __call__(self, x):
        return self.transform(x), self.transform(x)
</code></pre>
<h3 id="masked-language-modeling-bert-style"><a class="header" href="#masked-language-modeling-bert-style">Masked Language Modeling (BERT-style)</a></h3>
<pre><code class="language-python">class MaskedLanguageModel(nn.Module):
    def __init__(self, vocab_size, d_model=768, num_heads=12, num_layers=12):
        super(MaskedLanguageModel, self).__init__()
        
        self.embedding = nn.Embedding(vocab_size, d_model)
        self.position_embedding = nn.Embedding(512, d_model)
        
        encoder_layer = nn.TransformerEncoderLayer(d_model, num_heads, dim_feedforward=3072)
        self.transformer = nn.TransformerEncoder(encoder_layer, num_layers)
        
        self.lm_head = nn.Linear(d_model, vocab_size)
    
    def forward(self, input_ids, attention_mask=None):
        # Embeddings
        seq_length = input_ids.size(1)
        position_ids = torch.arange(seq_length, device=input_ids.device).unsqueeze(0)
        
        embeddings = self.embedding(input_ids) + self.position_embedding(position_ids)
        
        # Transformer
        hidden_states = self.transformer(embeddings.transpose(0, 1)).transpose(0, 1)
        
        # Prediction
        logits = self.lm_head(hidden_states)
        
        return logits

def mask_tokens(inputs, tokenizer, mlm_probability=0.15):
    """Prepare masked tokens for MLM"""
    labels = inputs.clone()
    
    # Create random mask
    probability_matrix = torch.full(labels.shape, mlm_probability)
    masked_indices = torch.bernoulli(probability_matrix).bool()
    
    # Only mask non-special tokens
    special_tokens_mask = tokenizer.get_special_tokens_mask(
        labels.tolist(), already_has_special_tokens=True
    )
    probability_matrix.masked_fill_(torch.tensor(special_tokens_mask, dtype=torch.bool), value=0.0)
    masked_indices = torch.bernoulli(probability_matrix).bool()
    
    # Set labels for non-masked tokens to -100
    labels[~masked_indices] = -100
    
    # Replace masked tokens
    # 80% [MASK], 10% random, 10% original
    indices_replaced = torch.bernoulli(torch.full(labels.shape, 0.8)).bool() &amp; masked_indices
    inputs[indices_replaced] = tokenizer.mask_token_id
    
    indices_random = torch.bernoulli(torch.full(labels.shape, 0.5)).bool() &amp; masked_indices &amp; ~indices_replaced
    random_words = torch.randint(len(tokenizer), labels.shape, dtype=torch.long)
    inputs[indices_random] = random_words[indices_random]
    
    return inputs, labels

# Training loop
def train_mlm(model, train_loader, tokenizer, num_epochs=10):
    optimizer = optim.Adam(model.parameters(), lr=5e-5)
    criterion = nn.CrossEntropyLoss(ignore_index=-100)
    
    for epoch in range(num_epochs):
        total_loss = 0
        
        for batch in train_loader:
            input_ids = batch['input_ids']
            
            # Mask tokens
            masked_inputs, labels = mask_tokens(input_ids, tokenizer)
            
            # Forward pass
            logits = model(masked_inputs)
            
            # Compute loss
            loss = criterion(logits.view(-1, logits.size(-1)), labels.view(-1))
            
            # Backward pass
            optimizer.zero_grad()
            loss.backward()
            optimizer.step()
            
            total_loss += loss.item()
        
        print(f"Epoch {epoch+1}, Loss: {total_loss/len(train_loader):.4f}")
</code></pre>
<h2 id="fine-tuning-techniques"><a class="header" href="#fine-tuning-techniques">Fine-tuning Techniques</a></h2>
<h3 id="standard-fine-tuning"><a class="header" href="#standard-fine-tuning">Standard Fine-tuning</a></h3>
<pre><code class="language-python">def fine_tune_model(pretrained_model, train_loader, val_loader, num_classes, num_epochs=10):
    """Fine-tune pre-trained model on new task"""
    
    # Load pre-trained model
    model = models.resnet50(pretrained=True)
    
    # Replace classification head
    num_features = model.fc.in_features
    model.fc = nn.Linear(num_features, num_classes)
    
    # Optimizer with different learning rates
    params = [
        {'params': model.fc.parameters(), 'lr': 1e-3},  # New layer: higher LR
        {'params': [p for n, p in model.named_parameters() if 'fc' not in n], 
         'lr': 1e-4}  # Pre-trained layers: lower LR
    ]
    optimizer = optim.Adam(params)
    criterion = nn.CrossEntropyLoss()
    
    # Training loop
    best_val_acc = 0
    for epoch in range(num_epochs):
        # Training
        model.train()
        train_loss = 0
        
        for images, labels in train_loader:
            optimizer.zero_grad()
            outputs = model(images)
            loss = criterion(outputs, labels)
            loss.backward()
            optimizer.step()
            train_loss += loss.item()
        
        # Validation
        model.eval()
        correct = 0
        total = 0
        
        with torch.no_grad():
            for images, labels in val_loader:
                outputs = model(images)
                _, predicted = torch.max(outputs, 1)
                total += labels.size(0)
                correct += (predicted == labels).sum().item()
        
        val_acc = 100 * correct / total
        print(f"Epoch {epoch+1}, Train Loss: {train_loss/len(train_loader):.4f}, "
              f"Val Acc: {val_acc:.2f}%")
        
        # Save best model
        if val_acc &gt; best_val_acc:
            best_val_acc = val_acc
            torch.save(model.state_dict(), 'best_model.pth')
    
    return model
</code></pre>
<h3 id="progressive-unfreezing"><a class="header" href="#progressive-unfreezing">Progressive Unfreezing</a></h3>
<pre><code class="language-python">def progressive_unfreezing(model, train_loader, num_epochs=20, unfreeze_every=5):
    """Gradually unfreeze layers during fine-tuning"""
    
    # Initially freeze all layers
    for param in model.parameters():
        param.requires_grad = False
    
    # Only train classification head
    for param in model.fc.parameters():
        param.requires_grad = True
    
    optimizer = optim.Adam(filter(lambda p: p.requires_grad, model.parameters()), lr=1e-3)
    criterion = nn.CrossEntropyLoss()
    
    # Get layer groups (from top to bottom)
    layer_groups = [
        model.fc,
        model.layer4,
        model.layer3,
        model.layer2,
        model.layer1
    ]
    
    for epoch in range(num_epochs):
        # Unfreeze next layer group
        if epoch % unfreeze_every == 0 and epoch &gt; 0:
            group_idx = min(epoch // unfreeze_every, len(layer_groups) - 1)
            print(f"Unfreezing layer group {group_idx}")
            
            for param in layer_groups[group_idx].parameters():
                param.requires_grad = True
            
            # Update optimizer
            optimizer = optim.Adam(filter(lambda p: p.requires_grad, model.parameters()), 
                                 lr=1e-3 / (2 ** group_idx))
        
        # Training
        model.train()
        for images, labels in train_loader:
            optimizer.zero_grad()
            outputs = model(images)
            loss = criterion(outputs, labels)
            loss.backward()
            optimizer.step()
</code></pre>
<h3 id="discriminative-learning-rates"><a class="header" href="#discriminative-learning-rates">Discriminative Learning Rates</a></h3>
<pre><code class="language-python">def get_discriminative_lr_params(model, base_lr=1e-3, lr_mult=2.6):
    """Different learning rates for different layers"""
    
    params = []
    
    # Get all layer names
    layer_names = [name for name, _ in model.named_parameters()]
    
    # Group layers
    num_layers = len(layer_names)
    
    for idx, (name, param) in enumerate(model.named_parameters()):
        # Exponentially decreasing learning rate from top to bottom
        layer_lr = base_lr * (lr_mult ** (num_layers - idx - 1))
        params.append({'params': param, 'lr': layer_lr})
    
    return params

# Usage
model = models.resnet50(pretrained=True)
params = get_discriminative_lr_params(model)
optimizer = optim.Adam(params)
</code></pre>
<h3 id="adapter-layers"><a class="header" href="#adapter-layers">Adapter Layers</a></h3>
<pre><code class="language-python">class AdapterLayer(nn.Module):
    """Lightweight adapter for efficient fine-tuning"""
    def __init__(self, input_dim, bottleneck_dim=64):
        super(AdapterLayer, self).__init__()
        
        self.down_project = nn.Linear(input_dim, bottleneck_dim)
        self.up_project = nn.Linear(bottleneck_dim, input_dim)
        self.activation = nn.ReLU()
    
    def forward(self, x):
        residual = x
        x = self.down_project(x)
        x = self.activation(x)
        x = self.up_project(x)
        return x + residual

class ModelWithAdapters(nn.Module):
    """Add adapters to pre-trained model"""
    def __init__(self, base_model, adapter_dim=64):
        super(ModelWithAdapters, self).__init__()
        
        self.base_model = base_model
        
        # Freeze base model
        for param in base_model.parameters():
            param.requires_grad = False
        
        # Add adapters after each transformer block
        self.adapters = nn.ModuleList([
            AdapterLayer(768, adapter_dim)  # Assuming 768 hidden dim
            for _ in range(12)  # For each layer
        ])
    
    def forward(self, x):
        # Forward through base model with adapters
        for i, (layer, adapter) in enumerate(zip(self.base_model.layers, self.adapters)):
            x = layer(x)
            x = adapter(x)
        
        return x
</code></pre>
<h3 id="lora-low-rank-adaptation"><a class="header" href="#lora-low-rank-adaptation">LoRA (Low-Rank Adaptation)</a></h3>
<pre><code class="language-python">class LoRALayer(nn.Module):
    """Low-Rank Adaptation layer"""
    def __init__(self, input_dim, output_dim, rank=4, alpha=1):
        super(LoRALayer, self).__init__()
        
        self.rank = rank
        self.alpha = alpha
        
        # Low-rank matrices
        self.lora_A = nn.Parameter(torch.randn(input_dim, rank) * 0.01)
        self.lora_B = nn.Parameter(torch.zeros(rank, output_dim))
        
        self.scaling = alpha / rank
    
    def forward(self, x):
        # Low-rank update: x @ A @ B
        return (x @ self.lora_A @ self.lora_B) * self.scaling

class LinearWithLoRA(nn.Module):
    """Linear layer with LoRA adaptation"""
    def __init__(self, linear_layer, rank=4):
        super(LinearWithLoRA, self).__init__()
        
        self.linear = linear_layer
        
        # Freeze original weights
        self.linear.weight.requires_grad = False
        if self.linear.bias is not None:
            self.linear.bias.requires_grad = False
        
        # Add LoRA
        self.lora = LoRALayer(
            self.linear.in_features,
            self.linear.out_features,
            rank=rank
        )
    
    def forward(self, x):
        return self.linear(x) + self.lora(x)

def add_lora_to_model(model, rank=4):
    """Add LoRA to all linear layers"""
    for name, module in model.named_modules():
        if isinstance(module, nn.Linear):
            parent_name = '.'.join(name.split('.')[:-1])
            child_name = name.split('.')[-1]
            
            parent = dict(model.named_modules())[parent_name] if parent_name else model
            setattr(parent, child_name, LinearWithLoRA(module, rank))
    
    return model
</code></pre>
<h2 id="domain-adaptation"><a class="header" href="#domain-adaptation">Domain Adaptation</a></h2>
<h3 id="domain-adversarial-neural-network-dann"><a class="header" href="#domain-adversarial-neural-network-dann">Domain Adversarial Neural Network (DANN)</a></h3>
<pre><code class="language-python">class GradientReversalLayer(torch.autograd.Function):
    """Gradient reversal layer for domain adaptation"""
    @staticmethod
    def forward(ctx, x, alpha):
        ctx.alpha = alpha
        return x.view_as(x)
    
    @staticmethod
    def backward(ctx, grad_output):
        return -ctx.alpha * grad_output, None

class DomainAdversarialNetwork(nn.Module):
    def __init__(self, feature_extractor, num_classes, num_domains=2):
        super(DomainAdversarialNetwork, self).__init__()
        
        self.feature_extractor = feature_extractor
        
        # Label classifier
        self.label_classifier = nn.Sequential(
            nn.Linear(512, 256),
            nn.ReLU(),
            nn.Dropout(0.5),
            nn.Linear(256, num_classes)
        )
        
        # Domain classifier
        self.domain_classifier = nn.Sequential(
            nn.Linear(512, 256),
            nn.ReLU(),
            nn.Dropout(0.5),
            nn.Linear(256, num_domains)
        )
    
    def forward(self, x, alpha=1.0):
        # Extract features
        features = self.feature_extractor(x)
        
        # Label prediction
        label_pred = self.label_classifier(features)
        
        # Domain prediction with gradient reversal
        reversed_features = GradientReversalLayer.apply(features, alpha)
        domain_pred = self.domain_classifier(reversed_features)
        
        return label_pred, domain_pred

def train_dann(model, source_loader, target_loader, num_epochs=50):
    """Train DANN for domain adaptation"""
    optimizer = optim.Adam(model.parameters(), lr=0.001)
    label_criterion = nn.CrossEntropyLoss()
    domain_criterion = nn.CrossEntropyLoss()
    
    for epoch in range(num_epochs):
        model.train()
        
        for (source_data, source_labels), (target_data, _) in zip(source_loader, target_loader):
            batch_size = source_data.size(0)
            
            # Compute alpha for gradient reversal
            p = float(epoch) / num_epochs
            alpha = 2. / (1. + np.exp(-10 * p)) - 1
            
            # Source domain
            source_label_pred, source_domain_pred = model(source_data, alpha)
            source_label_loss = label_criterion(source_label_pred, source_labels)
            source_domain_loss = domain_criterion(
                source_domain_pred,
                torch.zeros(batch_size, dtype=torch.long)
            )
            
            # Target domain
            _, target_domain_pred = model(target_data, alpha)
            target_domain_loss = domain_criterion(
                target_domain_pred,
                torch.ones(target_data.size(0), dtype=torch.long)
            )
            
            # Total loss
            loss = source_label_loss + source_domain_loss + target_domain_loss
            
            optimizer.zero_grad()
            loss.backward()
            optimizer.step()
        
        print(f"Epoch {epoch+1}, Loss: {loss.item():.4f}")
</code></pre>
<h3 id="maximum-mean-discrepancy-mmd"><a class="header" href="#maximum-mean-discrepancy-mmd">Maximum Mean Discrepancy (MMD)</a></h3>
<pre><code class="language-python">def mmd_loss(source_features, target_features, kernel='rbf', gamma=1.0):
    """Compute MMD between source and target distributions"""
    
    def gaussian_kernel(x, y, gamma):
        """RBF kernel"""
        x_size = x.size(0)
        y_size = y.size(0)
        dim = x.size(1)
        
        x = x.unsqueeze(1)  # (x_size, 1, dim)
        y = y.unsqueeze(0)  # (1, y_size, dim)
        
        tiled_x = x.expand(x_size, y_size, dim)
        tiled_y = y.expand(x_size, y_size, dim)
        
        kernel_input = (tiled_x - tiled_y).pow(2).sum(2)
        return torch.exp(-gamma * kernel_input)
    
    # Compute kernels
    xx = gaussian_kernel(source_features, source_features, gamma).mean()
    yy = gaussian_kernel(target_features, target_features, gamma).mean()
    xy = gaussian_kernel(source_features, target_features, gamma).mean()
    
    # MMD
    return xx + yy - 2 * xy

class MMDDomainAdaptation(nn.Module):
    def __init__(self, feature_extractor, num_classes):
        super(MMDDomainAdaptation, self).__init__()
        self.feature_extractor = feature_extractor
        self.classifier = nn.Linear(512, num_classes)
    
    def forward(self, x):
        features = self.feature_extractor(x)
        output = self.classifier(features)
        return output, features

def train_mmd(model, source_loader, target_loader, num_epochs=50, lambda_mmd=0.1):
    """Train with MMD for domain adaptation"""
    optimizer = optim.Adam(model.parameters(), lr=0.001)
    criterion = nn.CrossEntropyLoss()
    
    for epoch in range(num_epochs):
        for (source_data, source_labels), (target_data, _) in zip(source_loader, target_loader):
            optimizer.zero_grad()
            
            # Forward pass
            source_pred, source_features = model(source_data)
            _, target_features = model(target_data)
            
            # Classification loss
            class_loss = criterion(source_pred, source_labels)
            
            # MMD loss
            mmd = mmd_loss(source_features, target_features)
            
            # Total loss
            loss = class_loss + lambda_mmd * mmd
            
            loss.backward()
            optimizer.step()
</code></pre>
<h2 id="few-shot-learning"><a class="header" href="#few-shot-learning">Few-Shot Learning</a></h2>
<h3 id="prototypical-networks"><a class="header" href="#prototypical-networks">Prototypical Networks</a></h3>
<pre><code class="language-python">class PrototypicalNetwork(nn.Module):
    def __init__(self, encoder):
        super(PrototypicalNetwork, self).__init__()
        self.encoder = encoder
    
    def forward(self, support_set, support_labels, query_set, n_way, k_shot):
        """
        support_set: (n_way * k_shot, C, H, W)
        query_set: (n_query, C, H, W)
        """
        # Encode support and query sets
        support_embeddings = self.encoder(support_set)
        query_embeddings = self.encoder(query_set)
        
        # Compute prototypes (class centroids)
        prototypes = []
        for c in range(n_way):
            class_embeddings = support_embeddings[c * k_shot:(c + 1) * k_shot]
            prototype = class_embeddings.mean(dim=0)
            prototypes.append(prototype)
        
        prototypes = torch.stack(prototypes)
        
        # Compute distances
        distances = torch.cdist(query_embeddings, prototypes)
        
        # Convert to probabilities
        log_p_y = F.log_softmax(-distances, dim=1)
        
        return log_p_y

def train_prototypical(model, train_loader, num_episodes=1000, n_way=5, k_shot=5):
    """Train prototypical network"""
    optimizer = optim.Adam(model.parameters(), lr=0.001)
    
    for episode in range(num_episodes):
        # Sample episode
        support_set, support_labels, query_set, query_labels = train_loader.sample_episode(n_way, k_shot)
        
        # Forward pass
        log_p_y = model(support_set, support_labels, query_set, n_way, k_shot)
        
        # Loss
        loss = F.nll_loss(log_p_y, query_labels)
        
        # Backward pass
        optimizer.zero_grad()
        loss.backward()
        optimizer.step()
        
        if episode % 100 == 0:
            print(f"Episode {episode}, Loss: {loss.item():.4f}")
</code></pre>
<h3 id="maml-model-agnostic-meta-learning"><a class="header" href="#maml-model-agnostic-meta-learning">MAML (Model-Agnostic Meta-Learning)</a></h3>
<pre><code class="language-python">class MAML:
    def __init__(self, model, inner_lr=0.01, outer_lr=0.001):
        self.model = model
        self.inner_lr = inner_lr
        self.outer_optimizer = optim.Adam(model.parameters(), lr=outer_lr)
    
    def inner_update(self, support_x, support_y, num_steps=5):
        """Adapt model on support set"""
        # Clone model for inner loop
        adapted_params = {name: param.clone() for name, param in self.model.named_parameters()}
        
        for step in range(num_steps):
            # Forward pass with adapted parameters
            logits = self.model(support_x)
            loss = F.cross_entropy(logits, support_y)
            
            # Compute gradients
            grads = torch.autograd.grad(loss, adapted_params.values(), create_graph=True)
            
            # Update adapted parameters
            adapted_params = {
                name: param - self.inner_lr * grad
                for (name, param), grad in zip(adapted_params.items(), grads)
            }
        
        return adapted_params
    
    def meta_update(self, tasks):
        """Meta-update on batch of tasks"""
        self.outer_optimizer.zero_grad()
        
        meta_loss = 0
        
        for support_x, support_y, query_x, query_y in tasks:
            # Inner loop: adapt to task
            adapted_params = self.inner_update(support_x, support_y)
            
            # Outer loop: evaluate on query set
            with torch.set_grad_enabled(True):
                query_logits = self.model.forward_with_params(query_x, adapted_params)
                task_loss = F.cross_entropy(query_logits, query_y)
                meta_loss += task_loss
        
        # Meta-gradient step
        meta_loss /= len(tasks)
        meta_loss.backward()
        self.outer_optimizer.step()
        
        return meta_loss.item()
</code></pre>
<h2 id="model-distillation"><a class="header" href="#model-distillation">Model Distillation</a></h2>
<p>Knowledge distillation transfers knowledge from large teacher to small student.</p>
<pre><code class="language-python">class DistillationTrainer:
    def __init__(self, teacher_model, student_model, temperature=3.0, alpha=0.5):
        self.teacher = teacher_model
        self.student = student_model
        self.temperature = temperature
        self.alpha = alpha
        
        # Freeze teacher
        for param in self.teacher.parameters():
            param.requires_grad = False
        
        self.teacher.eval()
    
    def distillation_loss(self, student_logits, teacher_logits, labels):
        """Compute distillation loss"""
        # Hard loss (student vs true labels)
        hard_loss = F.cross_entropy(student_logits, labels)
        
        # Soft loss (student vs teacher)
        soft_student = F.log_softmax(student_logits / self.temperature, dim=1)
        soft_teacher = F.softmax(teacher_logits / self.temperature, dim=1)
        soft_loss = F.kl_div(soft_student, soft_teacher, reduction='batchmean')
        soft_loss *= self.temperature ** 2
        
        # Combined loss
        loss = self.alpha * hard_loss + (1 - self.alpha) * soft_loss
        
        return loss
    
    def train(self, train_loader, num_epochs=10):
        """Train student with distillation"""
        optimizer = optim.Adam(self.student.parameters(), lr=0.001)
        
        for epoch in range(num_epochs):
            self.student.train()
            total_loss = 0
            
            for images, labels in train_loader:
                # Teacher predictions
                with torch.no_grad():
                    teacher_logits = self.teacher(images)
                
                # Student predictions
                student_logits = self.student(images)
                
                # Distillation loss
                loss = self.distillation_loss(student_logits, teacher_logits, labels)
                
                # Backward pass
                optimizer.zero_grad()
                loss.backward()
                optimizer.step()
                
                total_loss += loss.item()
            
            print(f"Epoch {epoch+1}, Loss: {total_loss/len(train_loader):.4f}")

# Example usage
teacher = models.resnet50(pretrained=True)
student = models.resnet18(pretrained=False)

trainer = DistillationTrainer(teacher, student, temperature=3.0, alpha=0.5)
# trainer.train(train_loader, num_epochs=10)
</code></pre>
<h2 id="practical-tips-8"><a class="header" href="#practical-tips-8">Practical Tips</a></h2>
<ol>
<li><strong>Start with Pre-trained Models</strong>: Use ImageNet, BERT, GPT weights</li>
<li><strong>Learning Rate</strong>: Use smaller LR for pre-trained layers</li>
<li><strong>Gradual Unfreezing</strong>: Unfreeze layers progressively</li>
<li><strong>Data Augmentation</strong>: Critical when fine-tuning with limited data</li>
<li><strong>Early Stopping</strong>: Monitor validation to prevent overfitting</li>
<li><strong>Adapter Methods</strong>: More efficient than full fine-tuning</li>
</ol>
<h2 id="resources-18"><a class="header" href="#resources-18">Resources</a></h2>
<ul>
<li>Hugging Face Transformers: https://huggingface.co/transformers/</li>
<li>timm (PyTorch Image Models): https://github.com/rwightman/pytorch-image-models</li>
<li>"Transfer Learning" book by Tan et al.</li>
<li>Papers with Code Transfer Learning: https://paperswithcode.com/task/transfer-learning</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="transformers-1"><a class="header" href="#transformers-1">Transformers</a></h1>
<p>Transformers are a type of deep learning model introduced in the paper "Attention is All You Need" by Vaswani et al. in 2017. They have revolutionized the field of natural language processing (NLP) and have been widely adopted in various applications, including machine translation, text summarization, and sentiment analysis.</p>
<h2 id="key-concepts-18"><a class="header" href="#key-concepts-18">Key Concepts</a></h2>
<ul>
<li>
<p><strong>Attention Mechanism</strong>: The core innovation of transformers is the self-attention mechanism, which allows the model to weigh the importance of different words in a sentence when making predictions. This enables the model to capture long-range dependencies and relationships between words more effectively than previous architectures like RNNs and LSTMs.</p>
</li>
<li>
<p><strong>Encoder-Decoder Architecture</strong>: The transformer model consists of two main components: the encoder and the decoder. The encoder processes the input data and generates a set of attention-based representations, while the decoder uses these representations to produce the output sequence.</p>
</li>
<li>
<p><strong>Positional Encoding</strong>: Since transformers do not have a built-in notion of sequence order (unlike RNNs), they use positional encodings to inject information about the position of each word in the input sequence. This allows the model to understand the order of words.</p>
</li>
</ul>
<h2 id="attention-mechanism-deep-dive"><a class="header" href="#attention-mechanism-deep-dive">Attention Mechanism: Deep Dive</a></h2>
<p>The attention mechanism is the heart of the transformer architecture. It allows the model to focus on different parts of the input sequence when processing each element. Let's explore this in detail with mathematical formulations and PyTorch implementations.</p>
<h3 id="scaled-dot-product-attention"><a class="header" href="#scaled-dot-product-attention">Scaled Dot-Product Attention</a></h3>
<p>The fundamental building block of transformer attention is the <strong>Scaled Dot-Product Attention</strong>. Given three matrices:</p>
<ul>
<li>$Q$ (Query): What we're looking for</li>
<li>$K$ (Key): What we're matching against</li>
<li>$V$ (Value): The actual information we want to retrieve</li>
</ul>
<p>The attention mechanism computes:</p>
<p>$$\text{Attention}(Q, K, V) = \text{softmax}\left(\frac{QK^T}{\sqrt{d_k}}\right) V$$</p>
<p>Where:</p>
<ul>
<li>$d_k$ is the dimension of the key vectors</li>
<li>The division by $\sqrt{d_k}$ is scaling to prevent the dot products from growing too large</li>
<li>softmax normalizes the scores to create a probability distribution</li>
</ul>
<h4 id="pytorch-implementation-scaled-dot-product-attention"><a class="header" href="#pytorch-implementation-scaled-dot-product-attention">PyTorch Implementation: Scaled Dot-Product Attention</a></h4>
<pre><code class="language-python">import torch
import torch.nn as nn
import torch.nn.functional as F
import math

def scaled_dot_product_attention(query, key, value, mask=None):
    """
    Compute scaled dot-product attention.

    Args:
        query: Query tensor of shape (batch_size, num_heads, seq_len_q, d_k)
        key: Key tensor of shape (batch_size, num_heads, seq_len_k, d_k)
        value: Value tensor of shape (batch_size, num_heads, seq_len_v, d_v)
        mask: Optional mask tensor

    Returns:
        output: Attention output (batch_size, num_heads, seq_len_q, d_v)
        attention_weights: Attention weights (batch_size, num_heads, seq_len_q, seq_len_k)
    """
    # Get the dimension of keys
    d_k = query.size(-1)

    # Step 1: Compute Q @ K^T
    # query: (batch, heads, seq_len_q, d_k)
    # key.transpose(-2, -1): (batch, heads, d_k, seq_len_k)
    # scores: (batch, heads, seq_len_q, seq_len_k)
    scores = torch.matmul(query, key.transpose(-2, -1))
    print(f"After Q @ K^T - Shape: {scores.shape}")
    print(f"Sample scores (first 3x3):\n{scores[0, 0, :3, :3]}\n")

    # Step 2: Scale by sqrt(d_k)
    scores = scores / math.sqrt(d_k)
    print(f"After scaling by √{d_k} = {math.sqrt(d_k):.2f}")
    print(f"Scaled scores (first 3x3):\n{scores[0, 0, :3, :3]}\n")

    # Step 3: Apply mask (if provided)
    if mask is not None:
        scores = scores.masked_fill(mask == 0, -1e9)
        print(f"After masking - Shape: {scores.shape}")

    # Step 4: Apply softmax to get attention weights
    # Softmax is applied over the last dimension (seq_len_k)
    attention_weights = F.softmax(scores, dim=-1)
    print(f"Attention weights - Shape: {attention_weights.shape}")
    print(f"Sample attention weights (first 3x3):\n{attention_weights[0, 0, :3, :3]}")
    print(f"Sum of first row (should be 1.0): {attention_weights[0, 0, 0].sum()}\n")

    # Step 5: Multiply by values
    # attention_weights: (batch, heads, seq_len_q, seq_len_k)
    # value: (batch, heads, seq_len_v, d_v)  [seq_len_v == seq_len_k]
    # output: (batch, heads, seq_len_q, d_v)
    output = torch.matmul(attention_weights, value)
    print(f"Final output - Shape: {output.shape}\n")

    return output, attention_weights


# Example: Let's trace through a simple example
batch_size = 2
num_heads = 1
seq_len = 4
d_k = 8
d_v = 8

# Create sample tensors
torch.manual_seed(42)
query = torch.randn(batch_size, num_heads, seq_len, d_k)
key = torch.randn(batch_size, num_heads, seq_len, d_k)
value = torch.randn(batch_size, num_heads, seq_len, d_v)

print("="*60)
print("SCALED DOT-PRODUCT ATTENTION - STEP BY STEP")
print("="*60)
print(f"Query shape: {query.shape}")
print(f"Key shape: {key.shape}")
print(f"Value shape: {value.shape}\n")

output, attn_weights = scaled_dot_product_attention(query, key, value)

print(f"Final output shape: {output.shape}")
print(f"Final attention weights shape: {attn_weights.shape}")
</code></pre>
<p><strong>Output explanation:</strong></p>
<pre><code>============================================================
SCALED DOT-PRODUCT ATTENTION - STEP BY STEP
============================================================
Query shape: torch.Size([2, 1, 4, 8])
Key shape: torch.Size([2, 1, 4, 8])
Value shape: torch.Size([2, 1, 4, 8])

After Q @ K^T - Shape: torch.Size([2, 1, 4, 4])
Sample scores (first 3x3):
tensor([[ 0.6240, -1.2613,  1.4199],
        [-1.8847,  4.0367, -0.5234],
        [ 2.1563, -2.5678,  0.8234]])

After scaling by √8 = 2.83
Scaled scores (first 3x3):
tensor([[ 0.2207, -0.4460,  0.5021],
        [-0.6661,  1.4271, -0.1850],
        [ 0.7624, -0.9078,  0.2911]])

Attention weights - Shape: torch.Size([2, 1, 4, 4])
Sample attention weights (first 3x3):
tensor([[0.2789, 0.1425, 0.3672],
        [0.1056, 0.8236, 0.1680],
        [0.3924, 0.0731, 0.2458]])
Sum of first row (should be 1.0): 1.0

Final output - Shape: torch.Size([2, 1, 4, 8])
</code></pre>
<h3 id="understanding-the-matrix-operations"><a class="header" href="#understanding-the-matrix-operations">Understanding the Matrix Operations</a></h3>
<p>Let's break down what's happening at each step:</p>
<ol>
<li>
<p><strong>Query-Key Dot Product ($QK^T$)</strong>:</p>
<ul>
<li>Each query vector (row in $Q$) is compared against all key vectors (rows in $K$)</li>
<li>The dot product measures similarity: higher values = more similar</li>
<li>Shape: <code>(batch, heads, seq_len_q, d_k) @ (batch, heads, d_k, seq_len_k) → (batch, heads, seq_len_q, seq_len_k)</code></li>
</ul>
</li>
<li>
<p><strong>Scaling</strong>:</p>
<ul>
<li>Dividing by $\sqrt{d_k}$ prevents the dot products from becoming too large</li>
<li>Large dot products → very small gradients after softmax → slow learning</li>
<li>This is crucial for stable training</li>
</ul>
</li>
<li>
<p><strong>Softmax</strong>:</p>
<ul>
<li>Converts raw scores into a probability distribution</li>
<li>Each row sums to 1.0</li>
<li>Higher scores get higher probabilities (attention weights)</li>
</ul>
</li>
<li>
<p><strong>Weighted Sum (Attention @ Value)</strong>:</p>
<ul>
<li>Uses attention weights to create a weighted combination of value vectors</li>
<li>Each output position is a mixture of all value vectors</li>
<li>The weights determine how much each value contributes</li>
</ul>
</li>
</ol>
<h3 id="multi-head-attention"><a class="header" href="#multi-head-attention">Multi-Head Attention</a></h3>
<p>Multi-head attention runs multiple attention operations in parallel, allowing the model to attend to different aspects of the input simultaneously.</p>
<pre><code class="language-python">class MultiHeadAttention(nn.Module):
    def __init__(self, d_model, num_heads):
        """
        Multi-Head Attention module.

        Args:
            d_model: Total dimension of the model (e.g., 512)
            num_heads: Number of attention heads (e.g., 8)
        """
        super(MultiHeadAttention, self).__init__()
        assert d_model % num_heads == 0, "d_model must be divisible by num_heads"

        self.d_model = d_model
        self.num_heads = num_heads
        self.d_k = d_model // num_heads  # Dimension per head

        # Linear projections for Q, K, V
        self.W_q = nn.Linear(d_model, d_model)  # Query projection
        self.W_k = nn.Linear(d_model, d_model)  # Key projection
        self.W_v = nn.Linear(d_model, d_model)  # Value projection

        # Output projection
        self.W_o = nn.Linear(d_model, d_model)

    def split_heads(self, x):
        """
        Split the last dimension into (num_heads, d_k).
        Transpose to get shape: (batch_size, num_heads, seq_len, d_k)
        """
        batch_size, seq_len, d_model = x.size()
        # Reshape to (batch_size, seq_len, num_heads, d_k)
        x = x.view(batch_size, seq_len, self.num_heads, self.d_k)
        # Transpose to (batch_size, num_heads, seq_len, d_k)
        return x.transpose(1, 2)

    def combine_heads(self, x):
        """
        Inverse of split_heads.
        Input: (batch_size, num_heads, seq_len, d_k)
        Output: (batch_size, seq_len, d_model)
        """
        batch_size, num_heads, seq_len, d_k = x.size()
        # Transpose to (batch_size, seq_len, num_heads, d_k)
        x = x.transpose(1, 2).contiguous()
        # Reshape to (batch_size, seq_len, d_model)
        return x.view(batch_size, seq_len, self.d_model)

    def forward(self, query, key, value, mask=None):
        """
        Forward pass of multi-head attention.

        Args:
            query: (batch_size, seq_len_q, d_model)
            key: (batch_size, seq_len_k, d_model)
            value: (batch_size, seq_len_v, d_model)
            mask: Optional mask

        Returns:
            output: (batch_size, seq_len_q, d_model)
            attention_weights: (batch_size, num_heads, seq_len_q, seq_len_k)
        """
        batch_size = query.size(0)

        # Step 1: Linear projections
        # Each of these operations: (batch, seq_len, d_model) → (batch, seq_len, d_model)
        Q = self.W_q(query)
        K = self.W_k(key)
        V = self.W_v(value)

        print(f"\n{'='*60}")
        print("MULTI-HEAD ATTENTION - DETAILED STEPS")
        print(f"{'='*60}")
        print(f"Input shapes - Q: {query.shape}, K: {key.shape}, V: {value.shape}")
        print(f"\nAfter linear projections:")
        print(f"Q: {Q.shape}, K: {K.shape}, V: {V.shape}")

        # Step 2: Split into multiple heads
        # (batch, seq_len, d_model) → (batch, num_heads, seq_len, d_k)
        Q = self.split_heads(Q)
        K = self.split_heads(K)
        V = self.split_heads(V)

        print(f"\nAfter splitting into {self.num_heads} heads:")
        print(f"Q: {Q.shape}, K: {K.shape}, V: {V.shape}")
        print(f"Each head has dimension: {self.d_k}")

        # Step 3: Scaled dot-product attention
        # For each head: (batch, 1, seq_len_q, d_k) with (batch, 1, seq_len_k, d_k)
        d_k = Q.size(-1)
        scores = torch.matmul(Q, K.transpose(-2, -1)) / math.sqrt(d_k)

        if mask is not None:
            scores = scores.masked_fill(mask == 0, -1e9)

        attention_weights = F.softmax(scores, dim=-1)
        output = torch.matmul(attention_weights, V)

        print(f"\nAfter attention computation:")
        print(f"Attention scores: {scores.shape}")
        print(f"Attention weights: {attention_weights.shape}")
        print(f"Attention output: {output.shape}")

        # Step 4: Concatenate heads
        # (batch, num_heads, seq_len, d_k) → (batch, seq_len, d_model)
        output = self.combine_heads(output)
        print(f"\nAfter combining heads: {output.shape}")

        # Step 5: Final linear projection
        # (batch, seq_len, d_model) → (batch, seq_len, d_model)
        output = self.W_o(output)
        print(f"After final projection: {output.shape}")
        print(f"{'='*60}\n")

        return output, attention_weights


# Example usage with detailed tracking
d_model = 512
num_heads = 8
batch_size = 2
seq_len = 10

# Create sample input
x = torch.randn(batch_size, seq_len, d_model)

# Initialize multi-head attention
mha = MultiHeadAttention(d_model, num_heads)

# Forward pass (using x for query, key, and value - this is self-attention)
output, attn_weights = mha(x, x, x)

print(f"\nFinal Results:")
print(f"Input shape: {x.shape}")
print(f"Output shape: {output.shape}")
print(f"Attention weights shape: {attn_weights.shape}")
print(f"\nAttention weights for first head, first query position:")
print(attn_weights[0, 0, 0, :])  # Should sum to 1.0
print(f"Sum: {attn_weights[0, 0, 0, :].sum()}")
</code></pre>
<h3 id="visualizing-attention-a-concrete-example"><a class="header" href="#visualizing-attention-a-concrete-example">Visualizing Attention: A Concrete Example</a></h3>
<p>Let's see how attention works on actual text:</p>
<pre><code class="language-python">import torch
import torch.nn.functional as F

# Simple example: "The cat sat on the mat"
sentence = ["The", "cat", "sat", "on", "the", "mat"]
seq_len = len(sentence)
d_model = 4  # Small for visualization

# Create simple embeddings (normally these would be learned)
# Each word gets a random vector
torch.manual_seed(42)
embeddings = torch.randn(1, seq_len, d_model)

# Simple attention (1 head for clarity)
class SimpleAttention(nn.Module):
    def __init__(self, d_model):
        super().__init__()
        self.W_q = nn.Linear(d_model, d_model)
        self.W_k = nn.Linear(d_model, d_model)
        self.W_v = nn.Linear(d_model, d_model)

    def forward(self, x):
        Q = self.W_q(x)
        K = self.W_k(x)
        V = self.W_v(x)

        d_k = Q.size(-1)
        scores = torch.matmul(Q, K.transpose(-2, -1)) / torch.sqrt(torch.tensor(d_k, dtype=torch.float32))
        attn_weights = F.softmax(scores, dim=-1)
        output = torch.matmul(attn_weights, V)

        return output, attn_weights

# Create and run the attention
attn = SimpleAttention(d_model)
output, weights = attn(embeddings)

# Visualize attention weights
print("Attention Weight Matrix:")
print("(Each row shows where that word 'attends to')\n")
print("        ", "  ".join(f"{w:&gt;5}" for w in sentence))
print("-" * 50)
for i, word in enumerate(sentence):
    print(f"{word:&gt;7} |", "  ".join(f"{weights[0, i, j].item():5.3f}" for j in range(seq_len)))

print("\nInterpretation:")
print("- Each row represents a query word")
print("- Each column represents a key word")
print("- Values show how much the query word 'attends to' each key word")
print("- Higher values = stronger attention")
print("- Each row sums to 1.0")
</code></pre>
<h3 id="masked-attention-for-decoder"><a class="header" href="#masked-attention-for-decoder">Masked Attention (for Decoder)</a></h3>
<p>In the decoder, we use masked attention to prevent positions from attending to future positions:</p>
<pre><code class="language-python">def create_causal_mask(seq_len):
    """
    Create a causal mask for decoder self-attention.
    Prevents attending to future positions.

    Returns a lower triangular matrix:
    [[1, 0, 0, 0],
     [1, 1, 0, 0],
     [1, 1, 1, 0],
     [1, 1, 1, 1]]
    """
    mask = torch.tril(torch.ones(seq_len, seq_len))
    return mask.unsqueeze(0).unsqueeze(0)  # Add batch and head dimensions


# Example with masking
seq_len = 4
mask = create_causal_mask(seq_len)

print("Causal Mask:")
print(mask[0, 0])
print("\nThis ensures that:")
print("- Position 0 can only see position 0")
print("- Position 1 can see positions 0-1")
print("- Position 2 can see positions 0-2")
print("- Position 3 can see all positions 0-3")

# Apply masked attention
query = torch.randn(1, 1, seq_len, 8)
key = torch.randn(1, 1, seq_len, 8)
value = torch.randn(1, 1, seq_len, 8)

output, attn_weights = scaled_dot_product_attention(query, key, value, mask)

print("\nAttention weights with masking:")
print(attn_weights[0, 0])
print("\nNotice how future positions (upper triangle) have ~0 attention weight")
</code></pre>
<h3 id="complete-self-attention-layer-with-pytorch"><a class="header" href="#complete-self-attention-layer-with-pytorch">Complete Self-Attention Layer with PyTorch</a></h3>
<p>Here's a complete implementation you can use in practice:</p>
<pre><code class="language-python">import torch
import torch.nn as nn
import math

class SelfAttention(nn.Module):
    """
    Complete self-attention layer with all components.
    """
    def __init__(self, d_model, num_heads, dropout=0.1):
        super().__init__()
        assert d_model % num_heads == 0

        self.d_model = d_model
        self.num_heads = num_heads
        self.d_k = d_model // num_heads

        # Combined QKV projection (more efficient)
        self.qkv_proj = nn.Linear(d_model, 3 * d_model)
        self.out_proj = nn.Linear(d_model, d_model)
        self.dropout = nn.Dropout(dropout)

    def forward(self, x, mask=None):
        batch_size, seq_len, d_model = x.shape

        # Project to Q, K, V all at once
        qkv = self.qkv_proj(x)  # (batch, seq_len, 3 * d_model)

        # Split into Q, K, V and reshape for multi-head
        qkv = qkv.reshape(batch_size, seq_len, 3, self.num_heads, self.d_k)
        qkv = qkv.permute(2, 0, 3, 1, 4)  # (3, batch, heads, seq_len, d_k)
        q, k, v = qkv[0], qkv[1], qkv[2]

        # Scaled dot-product attention
        scores = torch.matmul(q, k.transpose(-2, -1)) / math.sqrt(self.d_k)

        if mask is not None:
            scores = scores.masked_fill(mask == 0, float('-inf'))

        attn = torch.softmax(scores, dim=-1)
        attn = self.dropout(attn)

        # Combine heads
        out = torch.matmul(attn, v)  # (batch, heads, seq_len, d_k)
        out = out.transpose(1, 2).contiguous()  # (batch, seq_len, heads, d_k)
        out = out.reshape(batch_size, seq_len, d_model)  # (batch, seq_len, d_model)

        # Final projection
        out = self.out_proj(out)

        return out, attn


# Test the complete implementation
model = SelfAttention(d_model=512, num_heads=8, dropout=0.1)
x = torch.randn(2, 10, 512)  # (batch=2, seq_len=10, d_model=512)
output, attention = model(x)

print(f"Input shape: {x.shape}")
print(f"Output shape: {output.shape}")
print(f"Attention shape: {attention.shape}")
</code></pre>
<h2 id="architecture-3"><a class="header" href="#architecture-3">Architecture</a></h2>
<ol>
<li>
<p><strong>Encoder</strong>: The encoder is composed of multiple identical layers, each containing two main sub-layers:</p>
<ul>
<li><strong>Multi-Head Self-Attention</strong>: This mechanism allows the model to focus on different parts of the input sequence simultaneously, capturing various relationships between words.</li>
<li><strong>Feed-Forward Neural Network</strong>: After the attention mechanism, the output is passed through a feed-forward neural network, which applies a non-linear transformation.</li>
</ul>
</li>
<li>
<p><strong>Decoder</strong>: The decoder also consists of multiple identical layers, with an additional sub-layer for attending to the encoder's output:</p>
<ul>
<li><strong>Masked Multi-Head Self-Attention</strong>: This prevents the decoder from attending to future tokens in the output sequence during training.</li>
<li><strong>Encoder-Decoder Attention</strong>: This layer allows the decoder to focus on relevant parts of the encoder's output while generating the output sequence.</li>
</ul>
</li>
</ol>
<h3 id="complete-transformer-implementation-in-pytorch"><a class="header" href="#complete-transformer-implementation-in-pytorch">Complete Transformer Implementation in PyTorch</a></h3>
<p>Here's a full implementation of the transformer architecture with detailed comments on matrix operations:</p>
<pre><code class="language-python">import torch
import torch.nn as nn
import torch.nn.functional as F
import math

class PositionalEncoding(nn.Module):
    """
    Adds positional information to the input embeddings.
    Uses sine and cosine functions of different frequencies.
    """
    def __init__(self, d_model, max_len=5000):
        super().__init__()

        # Create positional encoding matrix
        pe = torch.zeros(max_len, d_model)
        position = torch.arange(0, max_len, dtype=torch.float).unsqueeze(1)

        # Compute the div term for sine and cosine
        div_term = torch.exp(torch.arange(0, d_model, 2).float() * (-math.log(10000.0) / d_model))

        # Apply sine to even indices
        pe[:, 0::2] = torch.sin(position * div_term)
        # Apply cosine to odd indices
        pe[:, 1::2] = torch.cos(position * div_term)

        # Add batch dimension: (1, max_len, d_model)
        pe = pe.unsqueeze(0)

        # Register as buffer (not a parameter, but should be saved with model)
        self.register_buffer('pe', pe)

    def forward(self, x):
        """
        Args:
            x: Tensor of shape (batch_size, seq_len, d_model)
        Returns:
            x + positional encoding
        """
        # Add positional encoding to input
        # x: (batch, seq_len, d_model)
        # self.pe[:, :x.size(1)]: (1, seq_len, d_model)
        return x + self.pe[:, :x.size(1)]


class FeedForward(nn.Module):
    """
    Position-wise Feed-Forward Network.
    Consists of two linear transformations with ReLU activation.

    $$\text{FFN}(x) = \max(0, xW_1 + b_1)W_2 + b_2$$
    """
    def __init__(self, d_model, d_ff, dropout=0.1):
        super().__init__()
        self.linear1 = nn.Linear(d_model, d_ff)
        self.linear2 = nn.Linear(d_ff, d_model)
        self.dropout = nn.Dropout(dropout)

    def forward(self, x):
        """
        Args:
            x: (batch_size, seq_len, d_model)
        Returns:
            output: (batch_size, seq_len, d_model)
        """
        # x: (batch, seq_len, d_model)
        # After linear1: (batch, seq_len, d_ff)
        # After ReLU: (batch, seq_len, d_ff)
        # After linear2: (batch, seq_len, d_model)
        return self.linear2(self.dropout(F.relu(self.linear1(x))))


class MultiHeadAttentionLayer(nn.Module):
    """
    Multi-head attention layer with proper matrix dimension tracking.
    """
    def __init__(self, d_model, num_heads, dropout=0.1):
        super().__init__()
        assert d_model % num_heads == 0

        self.d_model = d_model
        self.num_heads = num_heads
        self.d_k = d_model // num_heads

        # Linear layers for Q, K, V projections
        self.W_q = nn.Linear(d_model, d_model)
        self.W_k = nn.Linear(d_model, d_model)
        self.W_v = nn.Linear(d_model, d_model)
        self.W_o = nn.Linear(d_model, d_model)

        self.dropout = nn.Dropout(dropout)
        self.scale = math.sqrt(self.d_k)

    def forward(self, query, key, value, mask=None):
        """
        Args:
            query: (batch_size, seq_len_q, d_model)
            key: (batch_size, seq_len_k, d_model)
            value: (batch_size, seq_len_v, d_model)
            mask: (batch_size, 1, seq_len_q, seq_len_k) or similar
        """
        batch_size = query.size(0)

        # Linear projections: (batch, seq_len, d_model) → (batch, seq_len, d_model)
        Q = self.W_q(query)
        K = self.W_k(key)
        V = self.W_v(value)

        # Reshape for multi-head attention
        # (batch, seq_len, d_model) → (batch, seq_len, num_heads, d_k)
        Q = Q.view(batch_size, -1, self.num_heads, self.d_k)
        K = K.view(batch_size, -1, self.num_heads, self.d_k)
        V = V.view(batch_size, -1, self.num_heads, self.d_k)

        # Transpose to (batch, num_heads, seq_len, d_k)
        Q = Q.transpose(1, 2)
        K = K.transpose(1, 2)
        V = V.transpose(1, 2)

        # Scaled dot-product attention
        # Q @ K^T: (batch, num_heads, seq_len_q, d_k) @ (batch, num_heads, d_k, seq_len_k)
        #        → (batch, num_heads, seq_len_q, seq_len_k)
        scores = torch.matmul(Q, K.transpose(-2, -1)) / self.scale

        # Apply mask if provided
        if mask is not None:
            scores = scores.masked_fill(mask == 0, float('-inf'))

        # Softmax over the last dimension
        attn_weights = F.softmax(scores, dim=-1)
        attn_weights = self.dropout(attn_weights)

        # Apply attention to values
        # attn_weights @ V: (batch, num_heads, seq_len_q, seq_len_k) @ (batch, num_heads, seq_len_v, d_k)
        #                 → (batch, num_heads, seq_len_q, d_k)
        output = torch.matmul(attn_weights, V)

        # Concatenate heads
        # Transpose: (batch, num_heads, seq_len_q, d_k) → (batch, seq_len_q, num_heads, d_k)
        output = output.transpose(1, 2).contiguous()
        # Reshape: (batch, seq_len_q, num_heads, d_k) → (batch, seq_len_q, d_model)
        output = output.view(batch_size, -1, self.d_model)

        # Final linear projection
        output = self.W_o(output)

        return output, attn_weights


class EncoderLayer(nn.Module):
    """
    Single encoder layer consisting of:
    1. Multi-head self-attention
    2. Add &amp; Norm (residual connection + layer normalization)
    3. Feed-forward network
    4. Add &amp; Norm
    """
    def __init__(self, d_model, num_heads, d_ff, dropout=0.1):
        super().__init__()
        self.self_attn = MultiHeadAttentionLayer(d_model, num_heads, dropout)
        self.feed_forward = FeedForward(d_model, d_ff, dropout)
        self.norm1 = nn.LayerNorm(d_model)
        self.norm2 = nn.LayerNorm(d_model)
        self.dropout1 = nn.Dropout(dropout)
        self.dropout2 = nn.Dropout(dropout)

    def forward(self, x, mask=None):
        """
        Args:
            x: (batch_size, seq_len, d_model)
            mask: Attention mask
        Returns:
            output: (batch_size, seq_len, d_model)
        """
        # Self-attention with residual connection
        attn_output, _ = self.self_attn(x, x, x, mask)
        x = x + self.dropout1(attn_output)
        x = self.norm1(x)

        # Feed-forward with residual connection
        ff_output = self.feed_forward(x)
        x = x + self.dropout2(ff_output)
        x = self.norm2(x)

        return x


class DecoderLayer(nn.Module):
    """
    Single decoder layer consisting of:
    1. Masked multi-head self-attention
    2. Add &amp; Norm
    3. Multi-head cross-attention (attending to encoder output)
    4. Add &amp; Norm
    5. Feed-forward network
    6. Add &amp; Norm
    """
    def __init__(self, d_model, num_heads, d_ff, dropout=0.1):
        super().__init__()
        self.self_attn = MultiHeadAttentionLayer(d_model, num_heads, dropout)
        self.cross_attn = MultiHeadAttentionLayer(d_model, num_heads, dropout)
        self.feed_forward = FeedForward(d_model, d_ff, dropout)
        self.norm1 = nn.LayerNorm(d_model)
        self.norm2 = nn.LayerNorm(d_model)
        self.norm3 = nn.LayerNorm(d_model)
        self.dropout1 = nn.Dropout(dropout)
        self.dropout2 = nn.Dropout(dropout)
        self.dropout3 = nn.Dropout(dropout)

    def forward(self, x, encoder_output, src_mask=None, tgt_mask=None):
        """
        Args:
            x: Decoder input (batch_size, tgt_seq_len, d_model)
            encoder_output: Encoder output (batch_size, src_seq_len, d_model)
            src_mask: Source mask for encoder-decoder attention
            tgt_mask: Target mask for masked self-attention
        """
        # Masked self-attention
        attn_output, _ = self.self_attn(x, x, x, tgt_mask)
        x = x + self.dropout1(attn_output)
        x = self.norm1(x)

        # Cross-attention to encoder output
        # Query from decoder, Key and Value from encoder
        attn_output, _ = self.cross_attn(x, encoder_output, encoder_output, src_mask)
        x = x + self.dropout2(attn_output)
        x = self.norm2(x)

        # Feed-forward
        ff_output = self.feed_forward(x)
        x = x + self.dropout3(ff_output)
        x = self.norm3(x)

        return x


class Transformer(nn.Module):
    """
    Complete Transformer model for sequence-to-sequence tasks.
    """
    def __init__(
        self,
        src_vocab_size,
        tgt_vocab_size,
        d_model=512,
        num_heads=8,
        num_encoder_layers=6,
        num_decoder_layers=6,
        d_ff=2048,
        dropout=0.1,
        max_len=5000
    ):
        super().__init__()

        # Embeddings
        self.src_embedding = nn.Embedding(src_vocab_size, d_model)
        self.tgt_embedding = nn.Embedding(tgt_vocab_size, d_model)
        self.positional_encoding = PositionalEncoding(d_model, max_len)

        # Encoder
        self.encoder_layers = nn.ModuleList([
            EncoderLayer(d_model, num_heads, d_ff, dropout)
            for _ in range(num_encoder_layers)
        ])

        # Decoder
        self.decoder_layers = nn.ModuleList([
            DecoderLayer(d_model, num_heads, d_ff, dropout)
            for _ in range(num_decoder_layers)
        ])

        # Output projection
        self.output_projection = nn.Linear(d_model, tgt_vocab_size)

        self.dropout = nn.Dropout(dropout)
        self.d_model = d_model

        # Initialize weights
        self._init_weights()

    def _init_weights(self):
        """Initialize weights using Xavier initialization."""
        for p in self.parameters():
            if p.dim() &gt; 1:
                nn.init.xavier_uniform_(p)

    def make_src_mask(self, src):
        """
        Create mask for source sequence (padding mask).
        Args:
            src: (batch_size, src_seq_len)
        Returns:
            mask: (batch_size, 1, 1, src_seq_len)
        """
        src_mask = (src != 0).unsqueeze(1).unsqueeze(2)
        return src_mask

    def make_tgt_mask(self, tgt):
        """
        Create mask for target sequence (padding + causal mask).
        Args:
            tgt: (batch_size, tgt_seq_len)
        Returns:
            mask: (batch_size, 1, tgt_seq_len, tgt_seq_len)
        """
        tgt_seq_len = tgt.size(1)

        # Padding mask
        tgt_padding_mask = (tgt != 0).unsqueeze(1).unsqueeze(2)

        # Causal mask (prevent attending to future tokens)
        tgt_sub_mask = torch.tril(
            torch.ones((tgt_seq_len, tgt_seq_len), device=tgt.device)
        ).bool()

        # Combine both masks
        tgt_mask = tgt_padding_mask &amp; tgt_sub_mask
        return tgt_mask

    def encode(self, src, src_mask):
        """
        Encode source sequence.
        Args:
            src: (batch_size, src_seq_len)
            src_mask: (batch_size, 1, 1, src_seq_len)
        Returns:
            encoder_output: (batch_size, src_seq_len, d_model)
        """
        # Embedding + Positional encoding
        # src: (batch, src_seq_len) → (batch, src_seq_len, d_model)
        x = self.src_embedding(src) * math.sqrt(self.d_model)
        x = self.positional_encoding(x)
        x = self.dropout(x)

        # Pass through encoder layers
        for layer in self.encoder_layers:
            x = layer(x, src_mask)

        return x

    def decode(self, tgt, encoder_output, src_mask, tgt_mask):
        """
        Decode target sequence.
        Args:
            tgt: (batch_size, tgt_seq_len)
            encoder_output: (batch_size, src_seq_len, d_model)
            src_mask: (batch_size, 1, 1, src_seq_len)
            tgt_mask: (batch_size, 1, tgt_seq_len, tgt_seq_len)
        Returns:
            decoder_output: (batch_size, tgt_seq_len, d_model)
        """
        # Embedding + Positional encoding
        x = self.tgt_embedding(tgt) * math.sqrt(self.d_model)
        x = self.positional_encoding(x)
        x = self.dropout(x)

        # Pass through decoder layers
        for layer in self.decoder_layers:
            x = layer(x, encoder_output, src_mask, tgt_mask)

        return x

    def forward(self, src, tgt):
        """
        Forward pass through the entire transformer.
        Args:
            src: Source sequence (batch_size, src_seq_len)
            tgt: Target sequence (batch_size, tgt_seq_len)
        Returns:
            output: Logits (batch_size, tgt_seq_len, tgt_vocab_size)
        """
        # Create masks
        src_mask = self.make_src_mask(src)
        tgt_mask = self.make_tgt_mask(tgt)

        # Encode
        encoder_output = self.encode(src, src_mask)

        # Decode
        decoder_output = self.decode(tgt, encoder_output, src_mask, tgt_mask)

        # Project to vocabulary
        output = self.output_projection(decoder_output)

        return output


# Example usage
if __name__ == "__main__":
    # Model hyperparameters
    src_vocab_size = 10000
    tgt_vocab_size = 10000
    d_model = 512
    num_heads = 8
    num_encoder_layers = 6
    num_decoder_layers = 6
    d_ff = 2048
    dropout = 0.1

    # Create model
    model = Transformer(
        src_vocab_size=src_vocab_size,
        tgt_vocab_size=tgt_vocab_size,
        d_model=d_model,
        num_heads=num_heads,
        num_encoder_layers=num_encoder_layers,
        num_decoder_layers=num_decoder_layers,
        d_ff=d_ff,
        dropout=dropout
    )

    # Example input (batch_size=2, sequences of length 10)
    src = torch.randint(1, src_vocab_size, (2, 10))
    tgt = torch.randint(1, tgt_vocab_size, (2, 12))

    print("="*60)
    print("TRANSFORMER MODEL SUMMARY")
    print("="*60)
    print(f"Source sequence shape: {src.shape}")
    print(f"Target sequence shape: {tgt.shape}")
    print(f"\nModel parameters:")
    total_params = sum(p.numel() for p in model.parameters())
    trainable_params = sum(p.numel() for p in model.parameters() if p.requires_grad)
    print(f"Total parameters: {total_params:,}")
    print(f"Trainable parameters: {trainable_params:,}")

    # Forward pass
    output = model(src, tgt)

    print(f"\nOutput shape: {output.shape}")
    print(f"Expected: (batch_size={src.size(0)}, tgt_seq_len={tgt.size(1)}, tgt_vocab_size={tgt_vocab_size})")

    # Show dimension flow through the model
    print("\n" + "="*60)
    print("DIMENSION FLOW THROUGH TRANSFORMER")
    print("="*60)

    print("\nENCODER:")
    print(f"1. Input tokens: {src.shape}")
    print(f"2. After embedding: (batch={src.size(0)}, seq={src.size(1)}, d_model={d_model})")
    print(f"3. After positional encoding: Same shape")
    print(f"4. Through {num_encoder_layers} encoder layers: Same shape")
    print(f"5. Encoder output: (batch={src.size(0)}, seq={src.size(1)}, d_model={d_model})")

    print("\nDECODER:")
    print(f"1. Input tokens: {tgt.shape}")
    print(f"2. After embedding: (batch={tgt.size(0)}, seq={tgt.size(1)}, d_model={d_model})")
    print(f"3. After positional encoding: Same shape")
    print(f"4. Through {num_decoder_layers} decoder layers: Same shape")
    print(f"5. After output projection: (batch={tgt.size(0)}, seq={tgt.size(1)}, vocab={tgt_vocab_size})")

    print("\n" + "="*60)
</code></pre>
<h3 id="training-the-transformer"><a class="header" href="#training-the-transformer">Training the Transformer</a></h3>
<p>Here's how you would train this transformer for a translation task:</p>
<pre><code class="language-python">import torch.optim as optim

# Initialize model, loss, and optimizer
model = Transformer(
    src_vocab_size=10000,
    tgt_vocab_size=10000,
    d_model=512,
    num_heads=8,
    num_encoder_layers=6,
    num_decoder_layers=6,
    d_ff=2048,
    dropout=0.1
)

criterion = nn.CrossEntropyLoss(ignore_index=0)  # Ignore padding token
optimizer = optim.Adam(model.parameters(), lr=0.0001, betas=(0.9, 0.98), eps=1e-9)

# Training loop
def train_step(model, src, tgt, optimizer, criterion):
    """
    Single training step.

    Args:
        src: Source sequences (batch_size, src_seq_len)
        tgt: Target sequences (batch_size, tgt_seq_len)
    """
    model.train()
    optimizer.zero_grad()

    # Forward pass
    # Input to decoder is target shifted right (teacher forcing)
    tgt_input = tgt[:, :-1]  # Remove last token
    tgt_output = tgt[:, 1:]   # Remove first token (usually &lt;sos&gt;)

    # Get model predictions
    # output: (batch_size, tgt_seq_len-1, vocab_size)
    output = model(src, tgt_input)

    # Reshape for loss calculation
    # output: (batch_size * (tgt_seq_len-1), vocab_size)
    # tgt_output: (batch_size * (tgt_seq_len-1))
    output = output.reshape(-1, output.size(-1))
    tgt_output = tgt_output.reshape(-1)

    # Calculate loss
    loss = criterion(output, tgt_output)

    # Backward pass
    loss.backward()

    # Gradient clipping (prevents exploding gradients)
    torch.nn.utils.clip_grad_norm_(model.parameters(), max_norm=1.0)

    # Update weights
    optimizer.step()

    return loss.item()


# Example training
for epoch in range(10):
    # Generate dummy batch
    src = torch.randint(1, 10000, (32, 20))  # batch_size=32, seq_len=20
    tgt = torch.randint(1, 10000, (32, 25))  # batch_size=32, seq_len=25

    loss = train_step(model, src, tgt, optimizer, criterion)
    print(f"Epoch {epoch+1}, Loss: {loss:.4f}")
</code></pre>
<h3 id="inference-with-the-transformer"><a class="header" href="#inference-with-the-transformer">Inference with the Transformer</a></h3>
<pre><code class="language-python">def greedy_decode(model, src, max_len, start_token, end_token):
    """
    Greedy decoding: always select the most likely next token.

    Args:
        model: Trained transformer model
        src: Source sequence (1, src_seq_len)
        max_len: Maximum length of generated sequence
        start_token: Start token ID
        end_token: End token ID

    Returns:
        Generated sequence
    """
    model.eval()

    # Encode the source
    src_mask = model.make_src_mask(src)
    encoder_output = model.encode(src, src_mask)

    # Initialize decoder input with start token
    tgt = torch.tensor([[start_token]], device=src.device)

    for _ in range(max_len):
        # Create target mask
        tgt_mask = model.make_tgt_mask(tgt)

        # Decode
        decoder_output = model.decode(tgt, encoder_output, src_mask, tgt_mask)

        # Get predictions for the last token
        # decoder_output: (1, current_seq_len, d_model)
        # We only need the last position: (1, 1, d_model)
        output = model.output_projection(decoder_output[:, -1:, :])

        # Get the token with highest probability
        # output: (1, 1, vocab_size) → (1, 1)
        next_token = output.argmax(dim=-1)

        # Append to target sequence
        tgt = torch.cat([tgt, next_token], dim=1)

        # Stop if we generate the end token
        if next_token.item() == end_token:
            break

    return tgt


# Example inference
src_sequence = torch.randint(1, 10000, (1, 20))
generated = greedy_decode(
    model=model,
    src=src_sequence,
    max_len=50,
    start_token=1,  # &lt;sos&gt; token
    end_token=2     # &lt;eos&gt; token
)
print(f"Generated sequence: {generated}")
print(f"Generated sequence shape: {generated.shape}")
</code></pre>
<h2 id="applications-10"><a class="header" href="#applications-10">Applications</a></h2>
<p>Transformers have been successfully applied in various domains, including:</p>
<ul>
<li>
<p><strong>Natural Language Processing</strong>: Models like BERT, GPT, and T5 are based on the transformer architecture and have achieved state-of-the-art results in numerous NLP tasks.</p>
</li>
<li>
<p><strong>Computer Vision</strong>: Vision Transformers (ViTs) have adapted the transformer architecture for image classification and other vision tasks, demonstrating competitive performance with traditional convolutional neural networks (CNNs).</p>
</li>
<li>
<p><strong>Speech Processing</strong>: Transformers are also being explored for tasks in speech recognition and synthesis, leveraging their ability to model sequential data.</p>
</li>
</ul>
<h2 id="conclusion-14"><a class="header" href="#conclusion-14">Conclusion</a></h2>
<p>Transformers have transformed the landscape of machine learning, particularly in NLP, by providing a powerful and flexible framework for modeling complex relationships in data. Their ability to handle long-range dependencies and parallelize training has made them a go-to choice for many modern AI applications.</p>
<h1 id="eli10-what-are-transformers"><a class="header" href="#eli10-what-are-transformers">ELI10: What are Transformers?</a></h1>
<p>Transformers are like super-smart assistants that help computers understand and generate human language. Imagine you have a friend who can read a whole book at once and remember everything about it. That's what transformers do! They look at all the words in a sentence and figure out how they relate to each other, which helps them answer questions, translate languages, or even write stories.</p>
<h2 id="example-usage-1"><a class="header" href="#example-usage-1">Example Usage</a></h2>
<ol>
<li><strong>Text Generation</strong>: Given a prompt, transformers can generate coherent and contextually relevant text.</li>
<li><strong>Translation</strong>: They can translate sentences from one language to another by understanding the meaning of the words in context.</li>
<li><strong>Summarization</strong>: Transformers can read long articles and provide concise summaries, capturing the main points effectively.</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="hugging-face-transformers"><a class="header" href="#hugging-face-transformers">Hugging Face Transformers</a></h1>
<p>Comprehensive guide to using the Hugging Face ecosystem for NLP and beyond.</p>
<h2 id="table-of-contents-23"><a class="header" href="#table-of-contents-23">Table of Contents</a></h2>
<ol>
<li><a href="machine_learning/hugging_face.html#introduction">Introduction</a></li>
<li><a href="machine_learning/hugging_face.html#transformers-library">Transformers Library</a></li>
<li><a href="machine_learning/hugging_face.html#model-hub">Model Hub</a></li>
<li><a href="machine_learning/hugging_face.html#datasets-library">Datasets Library</a></li>
<li><a href="machine_learning/hugging_face.html#tokenizers">Tokenizers</a></li>
<li><a href="machine_learning/hugging_face.html#training-and-fine-tuning">Training and Fine-tuning</a></li>
<li><a href="machine_learning/hugging_face.html#inference-and-deployment">Inference and Deployment</a></li>
</ol>
<h2 id="introduction-6"><a class="header" href="#introduction-6">Introduction</a></h2>
<p><strong>Hugging Face Ecosystem:</strong></p>
<ul>
<li><strong>Transformers</strong>: State-of-the-art NLP models</li>
<li><strong>Datasets</strong>: Easy access to datasets</li>
<li><strong>Tokenizers</strong>: Fast tokenization</li>
<li><strong>Accelerate</strong>: Distributed training</li>
<li><strong>Optimum</strong>: Hardware optimization</li>
</ul>
<pre><code class="language-bash"># Installation
pip install transformers datasets tokenizers accelerate
pip install torch torchvision torchaudio  # PyTorch
# OR
pip install tensorflow  # TensorFlow
</code></pre>
<h2 id="transformers-library"><a class="header" href="#transformers-library">Transformers Library</a></h2>
<h3 id="basic-usage-1"><a class="header" href="#basic-usage-1">Basic Usage</a></h3>
<pre><code class="language-python">from transformers import (
    AutoTokenizer, 
    AutoModel, 
    AutoModelForSequenceClassification,
    pipeline
)

# Quick start with pipelines
classifier = pipeline("sentiment-analysis")
result = classifier("I love using Hugging Face!")
print(result)
# [{'label': 'POSITIVE', 'score': 0.9998}]

# Multiple examples
results = classifier([
    "I love this!",
    "I hate this!",
    "This is okay."
])
print(results)
</code></pre>
<h3 id="loading-models-and-tokenizers"><a class="header" href="#loading-models-and-tokenizers">Loading Models and Tokenizers</a></h3>
<pre><code class="language-python"># Load pre-trained model and tokenizer
model_name = "bert-base-uncased"

tokenizer = AutoTokenizer.from_pretrained(model_name)
model = AutoModel.from_pretrained(model_name)

# Tokenize text
text = "Hello, how are you?"
inputs = tokenizer(text, return_tensors="pt", padding=True, truncation=True)

# Get embeddings
with torch.no_grad():
    outputs = model(**inputs)
    last_hidden_states = outputs.last_hidden_state
    pooler_output = outputs.pooler_output

print(f"Last hidden state shape: {last_hidden_states.shape}")
print(f"Pooler output shape: {pooler_output.shape}")
</code></pre>
<h3 id="common-model-types"><a class="header" href="#common-model-types">Common Model Types</a></h3>
<pre><code class="language-python"># Sequence Classification (e.g., sentiment analysis)
model = AutoModelForSequenceClassification.from_pretrained(
    "distilbert-base-uncased-finetuned-sst-2-english"
)

# Token Classification (e.g., NER)
from transformers import AutoModelForTokenClassification
model = AutoModelForTokenClassification.from_pretrained("dslim/bert-base-NER")

# Question Answering
from transformers import AutoModelForQuestionAnswering
model = AutoModelForQuestionAnswering.from_pretrained("distilbert-base-cased-distilled-squad")

# Text Generation
from transformers import AutoModelForCausalLM
model = AutoModelForCausalLM.from_pretrained("gpt2")

# Masked Language Modeling
from transformers import AutoModelForMaskedLM
model = AutoModelForMaskedLM.from_pretrained("bert-base-uncased")

# Sequence-to-Sequence (e.g., translation, summarization)
from transformers import AutoModelForSeq2SeqLM
model = AutoModelForSeq2SeqLM.from_pretrained("t5-base")
</code></pre>
<h3 id="pipelines"><a class="header" href="#pipelines">Pipelines</a></h3>
<pre><code class="language-python"># Sentiment Analysis
sentiment = pipeline("sentiment-analysis")
print(sentiment("This movie is great!"))

# Named Entity Recognition
ner = pipeline("ner", grouped_entities=True)
print(ner("My name is John and I live in New York"))

# Question Answering
qa = pipeline("question-answering")
context = "The Eiffel Tower is located in Paris, France."
question = "Where is the Eiffel Tower?"
print(qa(question=question, context=context))

# Text Generation
generator = pipeline("text-generation", model="gpt2")
print(generator("Once upon a time", max_length=50, num_return_sequences=2))

# Translation
translator = pipeline("translation_en_to_fr", model="t5-base")
print(translator("Hello, how are you?"))

# Summarization
summarizer = pipeline("summarization", model="facebook/bart-large-cnn")
article = """Long article text here..."""
print(summarizer(article, max_length=130, min_length=30))

# Zero-shot Classification
classifier = pipeline("zero-shot-classification")
text = "This is a course about Python programming"
labels = ["education", "politics", "business"]
print(classifier(text, candidate_labels=labels))

# Fill Mask
unmasker = pipeline("fill-mask", model="bert-base-uncased")
print(unmasker("The capital of France is [MASK]."))

# Feature Extraction
feature_extractor = pipeline("feature-extraction")
features = feature_extractor("Hello world!")
print(f"Features shape: {len(features[0])}")

# Image Classification
from transformers import pipeline
image_classifier = pipeline("image-classification", model="google/vit-base-patch16-224")
result = image_classifier("path/to/image.jpg")

# Object Detection
object_detector = pipeline("object-detection", model="facebook/detr-resnet-50")
results = object_detector("path/to/image.jpg")
</code></pre>
<h3 id="custom-pipeline"><a class="header" href="#custom-pipeline">Custom Pipeline</a></h3>
<pre><code class="language-python">from transformers import pipeline, AutoModelForSequenceClassification, AutoTokenizer
import torch

class CustomSentimentPipeline:
    def __init__(self, model_name="distilbert-base-uncased-finetuned-sst-2-english"):
        self.tokenizer = AutoTokenizer.from_pretrained(model_name)
        self.model = AutoModelForSequenceClassification.from_pretrained(model_name)
        self.model.eval()
    
    def __call__(self, texts, batch_size=8):
        if isinstance(texts, str):
            texts = [texts]
        
        results = []
        
        for i in range(0, len(texts), batch_size):
            batch = texts[i:i+batch_size]
            
            # Tokenize
            inputs = self.tokenizer(
                batch, 
                return_tensors="pt", 
                padding=True, 
                truncation=True,
                max_length=512
            )
            
            # Forward pass
            with torch.no_grad():
                outputs = self.model(**inputs)
                logits = outputs.logits
                probs = torch.softmax(logits, dim=-1)
            
            # Convert to results
            for j, prob in enumerate(probs):
                label_id = prob.argmax().item()
                score = prob[label_id].item()
                label = self.model.config.id2label[label_id]
                
                results.append({
                    'text': batch[j],
                    'label': label,
                    'score': score
                })
        
        return results

# Usage
custom_pipeline = CustomSentimentPipeline()
results = custom_pipeline(["I love this!", "I hate this!"])
print(results)
</code></pre>
<h2 id="model-hub"><a class="header" href="#model-hub">Model Hub</a></h2>
<h3 id="searching-and-filtering-models"><a class="header" href="#searching-and-filtering-models">Searching and Filtering Models</a></h3>
<pre><code class="language-python">from huggingface_hub import HfApi, list_models

api = HfApi()

# List models
models = list_models(
    filter="text-classification",
    sort="downloads",
    direction=-1,
    limit=10
)

for model in models:
    print(f"{model.modelId}: {model.downloads} downloads")

# Search for specific models
models = list_models(search="bert", filter="fill-mask")
for model in models:
    print(model.modelId)
</code></pre>
<h3 id="uploading-models"><a class="header" href="#uploading-models">Uploading Models</a></h3>
<pre><code class="language-python">from huggingface_hub import HfApi, create_repo

# Create repository
api = HfApi()
repo_url = create_repo(
    repo_id="username/model-name",
    token="your_token_here",
    private=False
)

# Upload model
api.upload_file(
    path_or_fileobj="path/to/model.bin",
    path_in_repo="model.bin",
    repo_id="username/model-name",
    token="your_token_here"
)

# Or use model.push_to_hub()
model.push_to_hub("username/model-name", token="your_token_here")
tokenizer.push_to_hub("username/model-name", token="your_token_here")
</code></pre>
<h2 id="datasets-library"><a class="header" href="#datasets-library">Datasets Library</a></h2>
<h3 id="loading-datasets"><a class="header" href="#loading-datasets">Loading Datasets</a></h3>
<pre><code class="language-python">from datasets import load_dataset, load_metric

# Load popular datasets
dataset = load_dataset("glue", "mrpc")
print(dataset)

# Load specific split
train_dataset = load_dataset("imdb", split="train")
test_dataset = load_dataset("imdb", split="test")

# Load subset
small_train = load_dataset("imdb", split="train[:1000]")

# Stream large datasets
dataset = load_dataset("c4", "en", streaming=True)
for example in dataset:
    print(example)
    break

# Load from CSV
dataset = load_dataset("csv", data_files="path/to/file.csv")

# Load from JSON
dataset = load_dataset("json", data_files="path/to/file.json")

# Load from multiple files
dataset = load_dataset(
    "json", 
    data_files={
        "train": "train.json",
        "test": "test.json"
    }
)
</code></pre>
<h3 id="dataset-operations"><a class="header" href="#dataset-operations">Dataset Operations</a></h3>
<pre><code class="language-python">from datasets import Dataset, DatasetDict

# Create custom dataset
data = {
    "text": ["Hello", "World", "!"],
    "label": [0, 1, 0]
}
dataset = Dataset.from_dict(data)

# Map function
def tokenize_function(examples):
    return tokenizer(examples["text"], padding="max_length", truncation=True)

tokenized_dataset = dataset.map(tokenize_function, batched=True)

# Filter
filtered_dataset = dataset.filter(lambda x: x["label"] == 1)

# Select
small_dataset = dataset.select(range(100))

# Shuffle
shuffled = dataset.shuffle(seed=42)

# Split
split_dataset = dataset.train_test_split(test_size=0.2)

# Sort
sorted_dataset = dataset.sort("label")

# Add column
dataset = dataset.map(lambda x: {"length": len(x["text"])})

# Remove columns
dataset = dataset.remove_columns(["length"])

# Save and load
dataset.save_to_disk("path/to/save")
loaded_dataset = Dataset.load_from_disk("path/to/save")
</code></pre>
<h3 id="data-collators"><a class="header" href="#data-collators">Data Collators</a></h3>
<pre><code class="language-python">from transformers import DataCollatorWithPadding, DataCollatorForLanguageModeling

# Dynamic padding
data_collator = DataCollatorWithPadding(tokenizer=tokenizer)

# For MLM (masked language modeling)
data_collator = DataCollatorForLanguageModeling(
    tokenizer=tokenizer, 
    mlm=True, 
    mlm_probability=0.15
)

# For sequence-to-sequence
from transformers import DataCollatorForSeq2Seq
data_collator = DataCollatorForSeq2Seq(tokenizer=tokenizer, model=model)

# Custom data collator
from dataclasses import dataclass
from typing import Dict, List
import torch

@dataclass
class CustomDataCollator:
    tokenizer: AutoTokenizer
    
    def __call__(self, features: List[Dict[str, any]]) -&gt; Dict[str, torch.Tensor]:
        batch = {}
        
        # Extract and pad text
        texts = [f["text"] for f in features]
        tokenized = self.tokenizer(
            texts, 
            padding=True, 
            truncation=True, 
            return_tensors="pt"
        )
        
        batch.update(tokenized)
        
        # Add labels
        if "label" in features[0]:
            batch["labels"] = torch.tensor([f["label"] for f in features])
        
        return batch
</code></pre>
<h2 id="tokenizers"><a class="header" href="#tokenizers">Tokenizers</a></h2>
<h3 id="using-tokenizers"><a class="header" href="#using-tokenizers">Using Tokenizers</a></h3>
<pre><code class="language-python">from transformers import AutoTokenizer

tokenizer = AutoTokenizer.from_pretrained("bert-base-uncased")

# Basic tokenization
text = "Hello, how are you?"
tokens = tokenizer.tokenize(text)
print(f"Tokens: {tokens}")

# Encode (text to IDs)
input_ids = tokenizer.encode(text)
print(f"Input IDs: {input_ids}")

# Decode (IDs to text)
decoded = tokenizer.decode(input_ids)
print(f"Decoded: {decoded}")

# Full tokenization with special tokens
encoded = tokenizer(
    text,
    padding="max_length",
    truncation=True,
    max_length=128,
    return_tensors="pt"
)
print(f"Input IDs shape: {encoded['input_ids'].shape}")
print(f"Attention mask shape: {encoded['attention_mask'].shape}")

# Batch tokenization
texts = ["Hello!", "How are you?", "Nice to meet you."]
batch_encoded = tokenizer(
    texts,
    padding=True,
    truncation=True,
    return_tensors="pt"
)

# Token type IDs (for sentence pairs)
text_a = "This is sentence A"
text_b = "This is sentence B"
encoded = tokenizer(text_a, text_b, return_tensors="pt")
print(f"Token type IDs: {encoded['token_type_ids']}")
</code></pre>
<h3 id="fast-tokenizers"><a class="header" href="#fast-tokenizers">Fast Tokenizers</a></h3>
<pre><code class="language-python">from tokenizers import Tokenizer
from tokenizers.models import BPE, WordPiece
from tokenizers.trainers import BpeTrainer, WordPieceTrainer
from tokenizers.pre_tokenizers import Whitespace

# Create BPE tokenizer
tokenizer = Tokenizer(BPE())
tokenizer.pre_tokenizer = Whitespace()

# Train tokenizer
trainer = BpeTrainer(vocab_size=30000, special_tokens=["[PAD]", "[UNK]", "[CLS]", "[SEP]", "[MASK]"])
files = ["path/to/text1.txt", "path/to/text2.txt"]
tokenizer.train(files, trainer)

# Save tokenizer
tokenizer.save("path/to/tokenizer.json")

# Load tokenizer
from transformers import PreTrainedTokenizerFast
fast_tokenizer = PreTrainedTokenizerFast(tokenizer_file="path/to/tokenizer.json")
</code></pre>
<h2 id="training-and-fine-tuning"><a class="header" href="#training-and-fine-tuning">Training and Fine-tuning</a></h2>
<h3 id="using-trainer-api"><a class="header" href="#using-trainer-api">Using Trainer API</a></h3>
<pre><code class="language-python">from transformers import Trainer, TrainingArguments, AutoModelForSequenceClassification
from datasets import load_dataset, load_metric
import numpy as np

# Load dataset and model
dataset = load_dataset("glue", "mrpc")
model = AutoModelForSequenceClassification.from_pretrained("bert-base-uncased", num_labels=2)
tokenizer = AutoTokenizer.from_pretrained("bert-base-uncased")

# Tokenize dataset
def tokenize_function(examples):
    return tokenizer(examples["sentence1"], examples["sentence2"], padding="max_length", truncation=True)

tokenized_datasets = dataset.map(tokenize_function, batched=True)

# Define metrics
metric = load_metric("accuracy")

def compute_metrics(eval_pred):
    logits, labels = eval_pred
    predictions = np.argmax(logits, axis=-1)
    return metric.compute(predictions=predictions, references=labels)

# Training arguments
training_args = TrainingArguments(
    output_dir="./results",
    evaluation_strategy="epoch",
    save_strategy="epoch",
    learning_rate=2e-5,
    per_device_train_batch_size=16,
    per_device_eval_batch_size=16,
    num_train_epochs=3,
    weight_decay=0.01,
    load_best_model_at_end=True,
    metric_for_best_model="accuracy",
    logging_dir="./logs",
    logging_steps=100,
    save_total_limit=2,
    fp16=True,  # Mixed precision training
    dataloader_num_workers=4,
    gradient_accumulation_steps=2,
    warmup_steps=500,
)

# Create trainer
trainer = Trainer(
    model=model,
    args=training_args,
    train_dataset=tokenized_datasets["train"],
    eval_dataset=tokenized_datasets["validation"],
    compute_metrics=compute_metrics,
)

# Train
trainer.train()

# Evaluate
results = trainer.evaluate()
print(results)

# Predict
predictions = trainer.predict(tokenized_datasets["test"])
print(predictions.metrics)

# Save model
trainer.save_model("./final_model")
</code></pre>
<h3 id="custom-training-loop"><a class="header" href="#custom-training-loop">Custom Training Loop</a></h3>
<pre><code class="language-python">from torch.utils.data import DataLoader
from transformers import AdamW, get_linear_schedule_with_warmup
from tqdm import tqdm

def train_custom(model, train_dataset, eval_dataset, num_epochs=3):
    device = torch.device("cuda" if torch.cuda.is_available() else "cpu")
    model.to(device)
    
    # Data loaders
    train_loader = DataLoader(train_dataset, batch_size=16, shuffle=True)
    eval_loader = DataLoader(eval_dataset, batch_size=16)
    
    # Optimizer and scheduler
    optimizer = AdamW(model.parameters(), lr=2e-5)
    total_steps = len(train_loader) * num_epochs
    scheduler = get_linear_schedule_with_warmup(
        optimizer,
        num_warmup_steps=0.1 * total_steps,
        num_training_steps=total_steps
    )
    
    # Training loop
    for epoch in range(num_epochs):
        model.train()
        total_loss = 0
        
        progress_bar = tqdm(train_loader, desc=f"Epoch {epoch+1}")
        for batch in progress_bar:
            # Move to device
            batch = {k: v.to(device) for k, v in batch.items()}
            
            # Forward pass
            outputs = model(**batch)
            loss = outputs.loss
            
            # Backward pass
            optimizer.zero_grad()
            loss.backward()
            torch.nn.utils.clip_grad_norm_(model.parameters(), 1.0)
            optimizer.step()
            scheduler.step()
            
            total_loss += loss.item()
            progress_bar.set_postfix({"loss": loss.item()})
        
        # Evaluation
        model.eval()
        eval_loss = 0
        predictions, true_labels = [], []
        
        with torch.no_grad():
            for batch in eval_loader:
                batch = {k: v.to(device) for k, v in batch.items()}
                outputs = model(**batch)
                
                eval_loss += outputs.loss.item()
                
                logits = outputs.logits
                preds = torch.argmax(logits, dim=-1)
                
                predictions.extend(preds.cpu().numpy())
                true_labels.extend(batch["labels"].cpu().numpy())
        
        # Compute metrics
        accuracy = np.mean(np.array(predictions) == np.array(true_labels))
        
        print(f"Epoch {epoch+1}:")
        print(f"  Train Loss: {total_loss/len(train_loader):.4f}")
        print(f"  Eval Loss: {eval_loss/len(eval_loader):.4f}")
        print(f"  Accuracy: {accuracy:.4f}")
    
    return model
</code></pre>
<h2 id="inference-and-deployment"><a class="header" href="#inference-and-deployment">Inference and Deployment</a></h2>
<h3 id="optimized-inference"><a class="header" href="#optimized-inference">Optimized Inference</a></h3>
<pre><code class="language-python"># Model optimization
from transformers import pipeline
from optimum.onnxruntime import ORTModelForSequenceClassification, ORTOptimizer
from optimum.onnxruntime.configuration import OptimizationConfig

# Convert to ONNX
model = ORTModelForSequenceClassification.from_pretrained(
    "distilbert-base-uncased-finetuned-sst-2-english",
    from_transformers=True
)

# Optimize
optimizer = ORTOptimizer.from_pretrained(model)
optimization_config = OptimizationConfig(optimization_level=2)
optimizer.optimize(save_dir="optimized_model", optimization_config=optimization_config)

# Use optimized model
optimized_pipeline = pipeline(
    "sentiment-analysis",
    model=model,
    tokenizer=tokenizer
)

# Quantization
from optimum.onnxruntime import ORTQuantizer
from optimum.onnxruntime.configuration import AutoQuantizationConfig

quantizer = ORTQuantizer.from_pretrained(model)
qconfig = AutoQuantizationConfig.avx512_vnni(is_static=False)
quantizer.quantize(save_dir="quantized_model", quantization_config=qconfig)
</code></pre>
<h3 id="batch-inference"><a class="header" href="#batch-inference">Batch Inference</a></h3>
<pre><code class="language-python">def batch_predict(texts, model, tokenizer, batch_size=32):
    """Efficient batch prediction"""
    device = torch.device("cuda" if torch.cuda.is_available() else "cpu")
    model.to(device)
    model.eval()
    
    all_predictions = []
    
    for i in range(0, len(texts), batch_size):
        batch_texts = texts[i:i+batch_size]
        
        # Tokenize
        inputs = tokenizer(
            batch_texts,
            padding=True,
            truncation=True,
            max_length=512,
            return_tensors="pt"
        )
        inputs = {k: v.to(device) for k, v in inputs.items()}
        
        # Predict
        with torch.no_grad():
            outputs = model(**inputs)
            logits = outputs.logits
            predictions = torch.argmax(logits, dim=-1)
        
        all_predictions.extend(predictions.cpu().numpy())
    
    return all_predictions

# Usage
texts = ["text1", "text2", "text3"] * 1000
predictions = batch_predict(texts, model, tokenizer)
</code></pre>
<h3 id="api-deployment"><a class="header" href="#api-deployment">API Deployment</a></h3>
<pre><code class="language-python">from fastapi import FastAPI
from pydantic import BaseModel
from transformers import pipeline

app = FastAPI()

# Load model once
classifier = pipeline("sentiment-analysis")

class TextRequest(BaseModel):
    text: str

class PredictionResponse(BaseModel):
    label: str
    score: float

@app.post("/predict", response_model=PredictionResponse)
def predict(request: TextRequest):
    result = classifier(request.text)[0]
    return PredictionResponse(label=result['label'], score=result['score'])

# Run with: uvicorn app:app --host 0.0.0.0 --port 8000
</code></pre>
<h2 id="practical-tips-9"><a class="header" href="#practical-tips-9">Practical Tips</a></h2>
<ol>
<li><strong>Model Selection</strong>: Choose based on task, speed, and accuracy requirements</li>
<li><strong>Tokenization</strong>: Handle special characters and multiple languages carefully</li>
<li><strong>Batch Size</strong>: Adjust based on GPU memory</li>
<li><strong>Mixed Precision</strong>: Use fp16 for faster training</li>
<li><strong>Gradient Accumulation</strong>: Simulate larger batch sizes</li>
<li><strong>Model Evaluation</strong>: Use appropriate metrics for your task</li>
</ol>
<h2 id="resources-19"><a class="header" href="#resources-19">Resources</a></h2>
<ul>
<li>Hugging Face Documentation: https://huggingface.co/docs</li>
<li>Course: https://huggingface.co/course</li>
<li>Model Hub: https://huggingface.co/models</li>
<li>Datasets Hub: https://huggingface.co/datasets</li>
<li>Forums: https://discuss.huggingface.co/</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="pytorch"><a class="header" href="#pytorch">PyTorch</a></h1>
<h2 id="overview-47"><a class="header" href="#overview-47">Overview</a></h2>
<p>PyTorch is a deep learning framework developed by Meta (Facebook) that provides:</p>
<ul>
<li><strong>Dynamic computation graphs</strong>: Build networks on-the-fly (unlike static graphs in TensorFlow)</li>
<li><strong>Pythonic API</strong>: Natural, intuitive syntax for building neural networks</li>
<li><strong>GPU acceleration</strong>: Seamless CUDA support for fast training</li>
<li><strong>Rich ecosystem</strong>: Tools for NLP, computer vision, reinforcement learning</li>
<li><strong>Production ready</strong>: Deploy with TorchScript, ONNX, or mobile</li>
</ul>
<h2 id="installation-5"><a class="header" href="#installation-5">Installation</a></h2>
<pre><code class="language-bash"># CPU only
pip install torch torchvision torchaudio

# GPU (CUDA 11.8)
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118

# GPU (CUDA 12.1)
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu121

# Check installation
python -c "import torch; print(torch.__version__); print(torch.cuda.is_available())"
</code></pre>
<h2 id="core-concepts-2"><a class="header" href="#core-concepts-2">Core Concepts</a></h2>
<h3 id="tensors"><a class="header" href="#tensors">Tensors</a></h3>
<p>Tensors are the fundamental building blocks - N-dimensional arrays:</p>
<pre><code class="language-python">import torch

# Creating tensors
t1 = torch.tensor([1, 2, 3])           # From list
t2 = torch.zeros(3, 4)                 # Zeros tensor
t3 = torch.ones(2, 3)                  # Ones tensor
t4 = torch.randn(3, 4)                 # Random normal distribution
t5 = torch.arange(0, 10, 2)            # Range: [0, 2, 4, 6, 8]

# Tensor properties
print(t1.shape)                         # torch.Size([3])
print(t1.dtype)                         # torch.int64
print(t1.device)                        # cpu

# Move to GPU
if torch.cuda.is_available():
    t1 = t1.cuda()                      # or t1.to('cuda')
    print(t1.device)                    # cuda:0

# Tensor operations
a = torch.tensor([1.0, 2.0, 3.0])
b = torch.tensor([4.0, 5.0, 6.0])

c = a + b                               # Element-wise addition
d = a * b                               # Element-wise multiplication
e = torch.dot(a, b)                     # Dot product: 32.0
f = torch.matmul(a.view(3, 1), b.view(1, 3))  # Matrix multiplication

# Reshaping
x = torch.randn(2, 3, 4)
y = x.view(6, 4)                        # Reshape to (6, 4)
z = x.reshape(-1)                       # Flatten (auto-infer dimension)
</code></pre>
<h3 id="autograd-automatic-differentiation"><a class="header" href="#autograd-automatic-differentiation">Autograd (Automatic Differentiation)</a></h3>
<p>PyTorch computes gradients automatically:</p>
<pre><code class="language-python">import torch

# Enable gradient tracking
x = torch.tensor([2.0, 3.0], requires_grad=True)
y = torch.tensor([1.0, 2.0], requires_grad=True)

# Forward pass
z = x.pow(2).sum() + (y * x).sum()      # z = x^2 + y*x

# Backward pass (compute gradients)
z.backward()

print(x.grad)                           # dz/dx
print(y.grad)                           # dz/dy

# Example: dz/dx = 2*x + y = [5, 8] for x=[2,3], y=[1,2]
</code></pre>
<h3 id="neural-network-building"><a class="header" href="#neural-network-building">Neural Network Building</a></h3>
<pre><code class="language-python">import torch
import torch.nn as nn
import torch.nn.functional as F

# Define a simple network
class SimpleNet(nn.Module):
    def __init__(self):
        super(SimpleNet, self).__init__()
        self.fc1 = nn.Linear(784, 128)  # Input: 28*28=784, Output: 128
        self.fc2 = nn.Linear(128, 64)
        self.fc3 = nn.Linear(64, 10)    # 10 output classes

    def forward(self, x):
        x = x.view(x.size(0), -1)       # Flatten: (batch, 784)
        x = F.relu(self.fc1(x))         # ReLU activation
        x = F.relu(self.fc2(x))
        x = self.fc3(x)                 # No activation (raw logits)
        return x

# Create model and move to device
device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')
model = SimpleNet().to(device)

# Check model architecture
print(model)

# Count parameters
total_params = sum(p.numel() for p in model.parameters())
print(f"Total parameters: {total_params}")
</code></pre>
<h2 id="datasets-and-dataloaders"><a class="header" href="#datasets-and-dataloaders">Datasets and DataLoaders</a></h2>
<h3 id="custom-dataset"><a class="header" href="#custom-dataset">Custom Dataset</a></h3>
<p>Create custom datasets by inheriting from <code>torch.utils.data.Dataset</code>:</p>
<pre><code class="language-python">from torch.utils.data import Dataset, DataLoader
import torch

class CustomDataset(Dataset):
    def __init__(self, data, labels, transform=None):
        """
        Args:
            data: List or array of inputs
            labels: List or array of labels
            transform: Optional transformations to apply
        """
        self.data = data
        self.labels = labels
        self.transform = transform

    def __len__(self):
        """Return total number of samples"""
        return len(self.data)

    def __getitem__(self, idx):
        """Return sample at index idx"""
        sample = self.data[idx]
        label = self.labels[idx]

        if self.transform:
            sample = self.transform(sample)

        return sample, label


# Usage
X = torch.randn(1000, 28, 28)  # 1000 images of 28x28
y = torch.randint(0, 10, (1000,))  # 1000 labels (10 classes)

dataset = CustomDataset(X, y)
print(f"Dataset size: {len(dataset)}")
sample, label = dataset[0]
print(f"Sample shape: {sample.shape}, Label: {label}")
</code></pre>
<h3 id="image-dataset-with-transforms"><a class="header" href="#image-dataset-with-transforms">Image Dataset with Transforms</a></h3>
<pre><code class="language-python">from torchvision import transforms
from PIL import Image

class ImageDataset(Dataset):
    def __init__(self, image_paths, labels, transform=None):
        self.image_paths = image_paths
        self.labels = labels
        self.transform = transform

    def __len__(self):
        return len(self.image_paths)

    def __getitem__(self, idx):
        # Load image
        image = Image.open(self.image_paths[idx]).convert('RGB')

        # Apply transforms
        if self.transform:
            image = self.transform(image)

        label = self.labels[idx]
        return image, label


# Define transforms
train_transform = transforms.Compose([
    transforms.Resize((224, 224)),
    transforms.RandomHorizontalFlip(p=0.5),
    transforms.RandomRotation(10),
    transforms.ToTensor(),
    transforms.Normalize(
        mean=[0.485, 0.456, 0.406],
        std=[0.229, 0.224, 0.225]
    )
])

test_transform = transforms.Compose([
    transforms.Resize((224, 224)),
    transforms.ToTensor(),
    transforms.Normalize(
        mean=[0.485, 0.456, 0.406],
        std=[0.229, 0.224, 0.225]
    )
])

# Create datasets
train_dataset = ImageDataset(train_paths, train_labels, transform=train_transform)
test_dataset = ImageDataset(test_paths, test_labels, transform=test_transform)
</code></pre>
<h3 id="built-in-datasets"><a class="header" href="#built-in-datasets">Built-in Datasets</a></h3>
<p>PyTorch provides common datasets in <code>torchvision.datasets</code>:</p>
<pre><code class="language-python">from torchvision import datasets, transforms

# MNIST
mnist_train = datasets.MNIST(
    root='./data',
    train=True,
    download=True,
    transform=transforms.ToTensor()
)

mnist_test = datasets.MNIST(
    root='./data',
    train=False,
    download=True,
    transform=transforms.ToTensor()
)

# CIFAR-10
cifar10 = datasets.CIFAR10(
    root='./data',
    train=True,
    download=True,
    transform=transforms.ToTensor()
)

# ImageNet (large, requires manual download)
imagenet = datasets.ImageNet(
    root='./data',
    split='train',
    transform=transforms.ToTensor()
)

# Print dataset info
print(f"Dataset size: {len(mnist_train)}")
sample, label = mnist_train[0]
print(f"Sample shape: {sample.shape}, Label: {label}")
</code></pre>
<h3 id="dataloader"><a class="header" href="#dataloader">DataLoader</a></h3>
<p>DataLoader handles batching, shuffling, and parallel loading:</p>
<pre><code class="language-python">from torch.utils.data import DataLoader

# Create DataLoader
train_loader = DataLoader(
    dataset=train_dataset,
    batch_size=32,              # Samples per batch
    shuffle=True,               # Shuffle order every epoch
    num_workers=4,              # Parallel workers for data loading
    pin_memory=True,            # Pin memory for faster GPU transfer
    drop_last=True              # Drop last incomplete batch
)

test_loader = DataLoader(
    dataset=test_dataset,
    batch_size=32,
    shuffle=False,              # Don't shuffle test data
    num_workers=4,
    pin_memory=True,
    drop_last=False
)

# Iterate through batches
for batch_idx, (batch_x, batch_y) in enumerate(train_loader):
    print(f"Batch {batch_idx}")
    print(f"  Input shape: {batch_x.shape}")  # (32, 1, 28, 28)
    print(f"  Labels shape: {batch_y.shape}")  # (32,)

    if batch_idx == 0:
        break
</code></pre>
<h3 id="data-splits"><a class="header" href="#data-splits">Data Splits</a></h3>
<pre><code class="language-python">from torch.utils.data import random_split

# Original dataset
dataset = CustomDataset(X, y)

# Split into train (70%), val (15%), test (15%)
total_size = len(dataset)
train_size = int(0.7 * total_size)
val_size = int(0.15 * total_size)
test_size = total_size - train_size - val_size

train_set, val_set, test_set = random_split(
    dataset,
    [train_size, val_size, test_size]
)

# Create loaders
train_loader = DataLoader(train_set, batch_size=32, shuffle=True)
val_loader = DataLoader(val_set, batch_size=32, shuffle=False)
test_loader = DataLoader(test_set, batch_size=32, shuffle=False)
</code></pre>
<h3 id="data-augmentation-strategies"><a class="header" href="#data-augmentation-strategies">Data Augmentation Strategies</a></h3>
<pre><code class="language-python">from torchvision import transforms

# For images
augmentation = transforms.Compose([
    transforms.RandomCrop(32, padding=4),
    transforms.RandomHorizontalFlip(p=0.5),
    transforms.RandomVerticalFlip(p=0.2),
    transforms.RandomRotation(15),
    transforms.ColorJitter(brightness=0.2, contrast=0.2),
    transforms.GaussianBlur(kernel_size=3),
    transforms.ToTensor(),
    transforms.Normalize(mean=[0.5], std=[0.5])
])

# For text (custom)
class TextAugmentation:
    def __init__(self, vocab_size=10000):
        self.vocab_size = vocab_size

    def __call__(self, tokens):
        # Random dropout of tokens
        if torch.rand(1) &gt; 0.5:
            mask = torch.rand(len(tokens)) &gt; 0.1
            tokens = tokens[mask]
        return tokens

# Custom augmentation
class MixupAugmentation:
    def __init__(self, alpha=1.0):
        self.alpha = alpha

    def __call__(self, batch_x, batch_y):
        """Mixup data augmentation"""
        lam = torch.distributions.Beta(self.alpha, self.alpha).sample()
        batch_size = batch_x.size(0)

        index = torch.randperm(batch_size)
        mixed_x = lam * batch_x + (1 - lam) * batch_x[index]
        mixed_y = lam * batch_y.float() + (1 - lam) * batch_y[index].float()

        return mixed_x, mixed_y
</code></pre>
<h3 id="dataloader-performance-tips"><a class="header" href="#dataloader-performance-tips">DataLoader Performance Tips</a></h3>
<pre><code class="language-python"># Good configuration
loader = DataLoader(
    dataset,
    batch_size=64,              # Larger batches for efficiency
    shuffle=True,
    num_workers=4,              # Use multiple workers (2-4 per GPU)
    pin_memory=True,            # Pin to CPU memory for GPU transfer
    persistent_workers=True,    # Keep workers alive between epochs
    prefetch_factor=2           # Prefetch batches (2-4 recommended)
)

# Monitor data loading performance
import time

start = time.time()
for batch in loader:
    pass
elapsed = time.time() - start
print(f"Time to load {len(loader)} batches: {elapsed:.2f}s")

# If loading is slow:
# - Increase num_workers
# - Check disk speed (SSD vs HDD)
# - Use pin_memory=True
# - Reduce image resolution if possible
# - Use data compression
</code></pre>
<h3 id="combining-datasets"><a class="header" href="#combining-datasets">Combining Datasets</a></h3>
<pre><code class="language-python">from torch.utils.data import ConcatDataset, Subset

# Concatenate multiple datasets
combined_dataset = ConcatDataset([dataset1, dataset2, dataset3])

# Subset of dataset
indices = list(range(0, 100))  # First 100 samples
subset = Subset(dataset, indices)

# Weighted sampling (e.g., for imbalanced data)
from torch.utils.data import WeightedRandomSampler

weights = [1.0 if label == 0 else 10.0 for label in dataset.labels]
sampler = WeightedRandomSampler(weights, len(dataset), replacement=True)

loader = DataLoader(
    dataset,
    batch_size=32,
    sampler=sampler  # Use sampler instead of shuffle
)
</code></pre>
<h2 id="training-loop"><a class="header" href="#training-loop">Training Loop</a></h2>
<pre><code class="language-python">import torch
import torch.nn as nn
import torch.optim as optim
from torch.utils.data import DataLoader, TensorDataset

# Dummy data
X_train = torch.randn(1000, 784)
y_train = torch.randint(0, 10, (1000,))

# Create dataloader
dataset = TensorDataset(X_train, y_train)
dataloader = DataLoader(dataset, batch_size=32, shuffle=True)

# Model, loss, optimizer
model = SimpleNet().to(device)
criterion = nn.CrossEntropyLoss()
optimizer = optim.Adam(model.parameters(), lr=0.001)

# Training loop
num_epochs = 5
for epoch in range(num_epochs):
    total_loss = 0
    for batch_x, batch_y in dataloader:
        batch_x, batch_y = batch_x.to(device), batch_y.to(device)

        # Forward pass
        logits = model(batch_x)
        loss = criterion(logits, batch_y)

        # Backward pass
        optimizer.zero_grad()           # Clear old gradients
        loss.backward()                 # Compute new gradients
        optimizer.step()                # Update parameters

        total_loss += loss.item()

    avg_loss = total_loss / len(dataloader)
    print(f"Epoch {epoch+1}/{num_epochs}, Loss: {avg_loss:.4f}")
</code></pre>
<h2 id="convolutional-neural-networks-1"><a class="header" href="#convolutional-neural-networks-1">Convolutional Neural Networks</a></h2>
<pre><code class="language-python">class CNN(nn.Module):
    def __init__(self):
        super(CNN, self).__init__()
        # Input: (batch, 3, 32, 32) - 3 channels, 32x32 images
        self.conv1 = nn.Conv2d(3, 32, kernel_size=3, padding=1)
        self.conv2 = nn.Conv2d(32, 64, kernel_size=3, padding=1)
        self.pool = nn.MaxPool2d(2, 2)
        self.fc1 = nn.Linear(64 * 8 * 8, 128)
        self.fc2 = nn.Linear(128, 10)
        self.dropout = nn.Dropout(0.5)

    def forward(self, x):
        # Conv block 1
        x = self.conv1(x)               # (batch, 32, 32, 32)
        x = F.relu(x)
        x = self.pool(x)                # (batch, 32, 16, 16)

        # Conv block 2
        x = self.conv2(x)               # (batch, 64, 16, 16)
        x = F.relu(x)
        x = self.pool(x)                # (batch, 64, 8, 8)

        # Flatten and FC layers
        x = x.view(x.size(0), -1)       # (batch, 64*8*8)
        x = F.relu(self.fc1(x))
        x = self.dropout(x)
        x = self.fc2(x)
        return x

model = CNN().to(device)
</code></pre>
<h2 id="recurrent-neural-networks-1"><a class="header" href="#recurrent-neural-networks-1">Recurrent Neural Networks</a></h2>
<pre><code class="language-python">class RNN(nn.Module):
    def __init__(self, input_size, hidden_size, num_layers, output_size):
        super(RNN, self).__init__()
        self.hidden_size = hidden_size
        self.num_layers = num_layers

        self.lstm = nn.LSTM(
            input_size=input_size,
            hidden_size=hidden_size,
            num_layers=num_layers,
            batch_first=True,           # Input shape: (batch, seq_len, input_size)
            dropout=0.5
        )
        self.fc = nn.Linear(hidden_size, output_size)

    def forward(self, x):
        # x shape: (batch, seq_len, input_size)
        lstm_out, (h_n, c_n) = self.lstm(x)
        # lstm_out: (batch, seq_len, hidden_size)
        # h_n: (num_layers, batch, hidden_size) - final hidden state

        # Use last hidden state for classification
        last_hidden = h_n[-1]           # (batch, hidden_size)
        out = self.fc(last_hidden)      # (batch, output_size)
        return out

model = RNN(input_size=100, hidden_size=256, num_layers=2, output_size=10).to(device)
</code></pre>
<h2 id="model-evaluation"><a class="header" href="#model-evaluation">Model Evaluation</a></h2>
<pre><code class="language-python"># Evaluation mode (disables dropout, batch norm uses running stats)
model.eval()

correct = 0
total = 0

with torch.no_grad():                   # Disable gradient computation
    for batch_x, batch_y in test_dataloader:
        batch_x, batch_y = batch_x.to(device), batch_y.to(device)

        logits = model(batch_x)
        predictions = torch.argmax(logits, dim=1)

        correct += (predictions == batch_y).sum().item()
        total += batch_y.size(0)

accuracy = correct / total
print(f"Accuracy: {accuracy:.4f}")

# Switch back to training mode
model.train()
</code></pre>
<h2 id="saving-and-loading-models"><a class="header" href="#saving-and-loading-models">Saving and Loading Models</a></h2>
<pre><code class="language-python"># Save model
torch.save(model.state_dict(), 'model.pth')

# Load model
model = SimpleNet().to(device)
model.load_state_dict(torch.load('model.pth'))

# Save entire checkpoint
checkpoint = {
    'epoch': epoch,
    'model_state_dict': model.state_dict(),
    'optimizer_state_dict': optimizer.state_dict(),
    'loss': loss,
}
torch.save(checkpoint, 'checkpoint.pth')

# Load checkpoint
checkpoint = torch.load('checkpoint.pth')
model.load_state_dict(checkpoint['model_state_dict'])
optimizer.load_state_dict(checkpoint['optimizer_state_dict'])
epoch = checkpoint['epoch']
</code></pre>
<h2 id="common-optimizers"><a class="header" href="#common-optimizers">Common Optimizers</a></h2>
<pre><code class="language-python">import torch.optim as optim

# SGD with momentum
optimizer = optim.SGD(model.parameters(), lr=0.01, momentum=0.9)

# Adam (adaptive learning rate)
optimizer = optim.Adam(model.parameters(), lr=0.001, betas=(0.9, 0.999))

# RMSprop
optimizer = optim.RMSprop(model.parameters(), lr=0.01, alpha=0.99)

# Learning rate scheduling
scheduler = optim.lr_scheduler.StepLR(optimizer, step_size=10, gamma=0.1)

# In training loop:
for epoch in range(num_epochs):
    # ... training code ...
    scheduler.step()                    # Decay learning rate
</code></pre>
<h2 id="loss-functions-1"><a class="header" href="#loss-functions-1">Loss Functions</a></h2>
<pre><code class="language-python"># Classification
criterion = nn.CrossEntropyLoss()       # Combines LogSoftmax + NLLLoss
criterion = nn.BCEWithLogitsLoss()      # Binary classification

# Regression
criterion = nn.MSELoss()                # Mean Squared Error
criterion = nn.L1Loss()                 # Mean Absolute Error
criterion = nn.SmoothL1Loss()           # Huber loss

# Custom loss
class CustomLoss(nn.Module):
    def forward(self, pred, target):
        return (pred - target).pow(2).mean()
</code></pre>
<h2 id="advanced-techniques"><a class="header" href="#advanced-techniques">Advanced Techniques</a></h2>
<h3 id="batch-normalization-1"><a class="header" href="#batch-normalization-1">Batch Normalization</a></h3>
<pre><code class="language-python">class BNNetwork(nn.Module):
    def __init__(self):
        super(BNNetwork, self).__init__()
        self.fc1 = nn.Linear(784, 256)
        self.bn1 = nn.BatchNorm1d(256)  # Normalize features
        self.fc2 = nn.Linear(256, 128)
        self.bn2 = nn.BatchNorm1d(128)
        self.fc3 = nn.Linear(128, 10)

    def forward(self, x):
        x = x.view(x.size(0), -1)
        x = self.fc1(x)
        x = self.bn1(x)                 # Normalize after linear layer
        x = F.relu(x)

        x = self.fc2(x)
        x = self.bn2(x)
        x = F.relu(x)

        x = self.fc3(x)
        return x
</code></pre>
<h3 id="gradient-clipping"><a class="header" href="#gradient-clipping">Gradient Clipping</a></h3>
<pre><code class="language-python"># Prevent exploding gradients
torch.nn.utils.clip_grad_norm_(model.parameters(), max_norm=1.0)
torch.nn.utils.clip_grad_value_(model.parameters(), clip_value=0.1)
</code></pre>
<h3 id="mixed-precision-training"><a class="header" href="#mixed-precision-training">Mixed Precision Training</a></h3>
<pre><code class="language-python">from torch.cuda.amp import autocast, GradScaler

scaler = GradScaler()

for batch_x, batch_y in dataloader:
    optimizer.zero_grad()

    with autocast():                    # Automatically cast to float16 where safe
        logits = model(batch_x)
        loss = criterion(logits, batch_y)

    scaler.scale(loss).backward()
    scaler.step(optimizer)
    scaler.update()
</code></pre>
<h2 id="time-complexity-3"><a class="header" href="#time-complexity-3">Time Complexity</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Operation</th><th>Time Complexity</th></tr></thead><tbody>
<tr><td><strong>Forward pass</strong></td><td>O(n * hidden_size) for dense layers</td></tr>
<tr><td><strong>Backward pass</strong></td><td>O(n * hidden_size) (2-3x forward)</td></tr>
<tr><td><strong>Conv2D</strong></td><td>O(H * W * C_in * K^2) per sample</td></tr>
<tr><td><strong>LSTM</strong></td><td>O(seq_len * hidden_size^2) per sample</td></tr>
</tbody></table>
</div>
<h2 id="best-practices-34"><a class="header" href="#best-practices-34">Best Practices</a></h2>
<ol>
<li><strong>Use DataLoader</strong> for batching and shuffling</li>
<li><strong>Track metrics</strong> with tensorboard or wandb</li>
<li><strong>Use gradient clipping</strong> for unstable training</li>
<li><strong>Normalize inputs</strong> (mean=0, std=1)</li>
<li><strong>Monitor learning</strong> - plot loss and metrics</li>
<li><strong>Save checkpoints</strong> periodically during training</li>
<li><strong>Use model.eval()</strong> during validation/testing</li>
<li><strong>Pin memory</strong> for faster data loading: <code>DataLoader(..., pin_memory=True)</code></li>
</ol>
<h2 id="common-issues-8"><a class="header" href="#common-issues-8">Common Issues</a></h2>
<h3 id="out-of-memory"><a class="header" href="#out-of-memory">Out of Memory</a></h3>
<pre><code class="language-python"># Solution 1: Reduce batch size
batch_size = 16  # Instead of 32

# Solution 2: Gradient accumulation
accumulation_steps = 4
for i, (batch_x, batch_y) in enumerate(dataloader):
    logits = model(batch_x)
    loss = criterion(logits, batch_y) / accumulation_steps
    loss.backward()

    if (i + 1) % accumulation_steps == 0:
        optimizer.step()
        optimizer.zero_grad()
</code></pre>
<h3 id="nan-loss"><a class="header" href="#nan-loss">NaN Loss</a></h3>
<ul>
<li>Learning rate too high</li>
<li>Batch normalization issues</li>
<li>Unstable loss function</li>
<li>Check for gradient clipping</li>
</ul>
<h3 id="slow-training"><a class="header" href="#slow-training">Slow Training</a></h3>
<ul>
<li>Use GPU (move model and data to CUDA)</li>
<li>Increase batch size</li>
<li>Use mixed precision training</li>
<li>Profile with <code>torch.profiler</code></li>
</ul>
<h2 id="eli10-14"><a class="header" href="#eli10-14">ELI10</a></h2>
<p>PyTorch is like a smart building assistant:</p>
<ol>
<li><strong>You design the blueprint</strong> (define the network architecture)</li>
<li><strong>PyTorch remembers every step</strong> (autograd tracks all operations)</li>
<li><strong>You show examples</strong> (training data)</li>
<li><strong>PyTorch automatically learns</strong> (backpropagation adjusts weights)</li>
<li><strong>It gets better each time</strong> (more epochs = better performance)</li>
</ol>
<p>It's like learning to cook - you follow the recipe, taste the result, adjust ingredients, and get better over time!</p>
<h2 id="further-resources-14"><a class="header" href="#further-resources-14">Further Resources</a></h2>
<ul>
<li><a href="https://pytorch.org/docs/stable/index.html">PyTorch Official Documentation</a></li>
<li><a href="https://pytorch.org/tutorials/">PyTorch Tutorials</a></li>
<li><a href="https://www.coursera.org/learn/neural-networks-deep-learning">Deep Learning Specialization with PyTorch</a></li>
<li><a href="https://lightning.ai/">PyTorch Lightning</a> - High-level wrapper</li>
<li><a href="https://huggingface.co/transformers/">Hugging Face Transformers</a> - NLP with PyTorch</li>
<li><a href="https://course.fast.ai/">Fast.ai</a> - Practical deep learning course</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="interesting-machine-learning-papers"><a class="header" href="#interesting-machine-learning-papers">Interesting Machine Learning Papers</a></h1>
<p>Key papers that shaped the field of machine learning and deep learning.</p>
<h2 id="table-of-contents-24"><a class="header" href="#table-of-contents-24">Table of Contents</a></h2>
<ol>
<li><a href="machine_learning/interesting_papers.html#computer-vision">Computer Vision</a></li>
<li><a href="machine_learning/interesting_papers.html#natural-language-processing">Natural Language Processing</a></li>
<li><a href="machine_learning/interesting_papers.html#generative-models">Generative Models</a></li>
<li><a href="machine_learning/interesting_papers.html#reinforcement-learning">Reinforcement Learning</a></li>
<li><a href="machine_learning/interesting_papers.html#general-machine-learning">General Machine Learning</a></li>
<li><a href="machine_learning/interesting_papers.html#optimization">Optimization</a></li>
</ol>
<h2 id="computer-vision"><a class="header" href="#computer-vision">Computer Vision</a></h2>
<h3 id="alexnet-2012"><a class="header" href="#alexnet-2012">AlexNet (2012)</a></h3>
<p><strong>ImageNet Classification with Deep Convolutional Neural Networks</strong></p>
<ul>
<li>Authors: Alex Krizhevsky, Ilya Sutskever, Geoffrey Hinton</li>
<li>Key Contributions:
<ul>
<li>First deep CNN to win ImageNet competition</li>
<li>Used ReLU activation, dropout, and data augmentation</li>
<li>GPU training for deep networks</li>
<li>Reduced error rate from 26% to 15.3%</li>
</ul>
</li>
<li>Impact: Sparked deep learning revolution</li>
</ul>
<h3 id="vggnet-2014"><a class="header" href="#vggnet-2014">VGGNet (2014)</a></h3>
<p><strong>Very Deep Convolutional Networks for Large-Scale Image Recognition</strong></p>
<ul>
<li>Authors: Karen Simonyan, Andrew Zisserman</li>
<li>Key Contributions:
<ul>
<li>Showed depth is crucial (16-19 layers)</li>
<li>Used small 3x3 filters throughout</li>
<li>Simple, homogeneous architecture</li>
</ul>
</li>
<li>Architecture: Stacked 3x3 conv layers, 2x2 max pooling</li>
</ul>
<h3 id="resnet-2015"><a class="header" href="#resnet-2015">ResNet (2015)</a></h3>
<p><strong>Deep Residual Learning for Image Recognition</strong></p>
<ul>
<li>Authors: Kaiming He, Xiangyu Zhang, Shaoqing Ren, Jian Sun</li>
<li>Key Contributions:
<ul>
<li>Residual connections solve vanishing gradient problem</li>
<li>Enabled training of networks with 100+ layers</li>
<li>Won ImageNet 2015 with 152 layers</li>
<li>Skip connections: y = F(x) + x</li>
</ul>
</li>
<li>Impact: Fundamental building block for modern architectures</li>
</ul>
<h3 id="vision-transformer-vit-2020"><a class="header" href="#vision-transformer-vit-2020">Vision Transformer (ViT) (2020)</a></h3>
<p><strong>An Image is Worth 16x16 Words: Transformers for Image Recognition at Scale</strong></p>
<ul>
<li>Authors: Alexey Dosovitskiy et al. (Google Research)</li>
<li>Key Contributions:
<ul>
<li>Applied transformers directly to image patches</li>
<li>Competitive with CNNs on large datasets</li>
<li>Self-attention for vision tasks</li>
</ul>
</li>
<li>Architecture:
<ul>
<li>Split image into patches</li>
<li>Linear embedding of patches</li>
<li>Add position embeddings</li>
<li>Standard transformer encoder</li>
</ul>
</li>
</ul>
<h3 id="yolo-2015"><a class="header" href="#yolo-2015">YOLO (2015)</a></h3>
<p><strong>You Only Look Once: Unified, Real-Time Object Detection</strong></p>
<ul>
<li>Authors: Joseph Redmon et al.</li>
<li>Key Contributions:
<ul>
<li>Single-stage object detection</li>
<li>Real-time performance (45 FPS)</li>
<li>End-to-end training</li>
<li>Grid-based prediction</li>
</ul>
</li>
</ul>
<h3 id="mask-r-cnn-2017"><a class="header" href="#mask-r-cnn-2017">Mask R-CNN (2017)</a></h3>
<p><strong>Mask R-CNN</strong></p>
<ul>
<li>Authors: Kaiming He, Georgia Gkioxari, Piotr Dollár, Ross Girshick</li>
<li>Key Contributions:
<ul>
<li>Instance segmentation framework</li>
<li>Extends Faster R-CNN with mask branch</li>
<li>Parallel prediction of masks and classes</li>
</ul>
</li>
</ul>
<h2 id="natural-language-processing"><a class="header" href="#natural-language-processing">Natural Language Processing</a></h2>
<h3 id="word2vec-2013"><a class="header" href="#word2vec-2013">Word2Vec (2013)</a></h3>
<p><strong>Efficient Estimation of Word Representations in Vector Space</strong></p>
<ul>
<li>Authors: Tomas Mikolov et al. (Google)</li>
<li>Key Contributions:
<ul>
<li>Distributed word representations</li>
<li>Skip-gram and CBOW architectures</li>
<li>Captures semantic relationships</li>
<li>king - man + woman ≈ queen</li>
</ul>
</li>
<li>Impact: Foundation for modern NLP embeddings</li>
</ul>
<h3 id="attention-is-all-you-need-2017"><a class="header" href="#attention-is-all-you-need-2017">Attention Is All You Need (2017)</a></h3>
<p><strong>Attention Is All You Need</strong></p>
<ul>
<li>Authors: Ashish Vaswani et al. (Google Brain)</li>
<li>Key Contributions:
<ul>
<li>Introduced Transformer architecture</li>
<li>Self-attention mechanism</li>
<li>No recurrence or convolution</li>
<li>Parallel training</li>
</ul>
</li>
<li>Architecture:
<ul>
<li>Multi-head self-attention</li>
<li>Position-wise feed-forward networks</li>
<li>Positional encoding</li>
<li>Encoder-decoder structure</li>
</ul>
</li>
<li>Impact: Revolutionized NLP and beyond</li>
</ul>
<h3 id="bert-2018"><a class="header" href="#bert-2018">BERT (2018)</a></h3>
<p><strong>BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding</strong></p>
<ul>
<li>Authors: Jacob Devlin et al. (Google AI)</li>
<li>Key Contributions:
<ul>
<li>Bidirectional pre-training</li>
<li>Masked Language Modeling (MLM)</li>
<li>Next Sentence Prediction (NSP)</li>
<li>Transfer learning for NLP</li>
</ul>
</li>
<li>Pre-training objectives:
<ul>
<li>Mask 15% of tokens, predict them</li>
<li>Predict if sentence B follows A</li>
</ul>
</li>
<li>Impact: Set new SOTA on 11 NLP tasks</li>
</ul>
<h3 id="gpt-2018-2023"><a class="header" href="#gpt-2018-2023">GPT (2018-2023)</a></h3>
<p><strong>Improving Language Understanding by Generative Pre-Training</strong></p>
<ul>
<li>GPT-1 (2018): 117M parameters, unsupervised pre-training</li>
<li>GPT-2 (2019): 1.5B parameters, zero-shot learning</li>
<li>GPT-3 (2020): 175B parameters, few-shot learning</li>
<li>GPT-4 (2023): Multimodal, improved reasoning</li>
</ul>
<p>Key Contributions:</p>
<ul>
<li>Autoregressive language modeling</li>
<li>Scaling laws for language models</li>
<li>In-context learning</li>
<li>Emergent capabilities at scale</li>
</ul>
<h3 id="t5-2019"><a class="header" href="#t5-2019">T5 (2019)</a></h3>
<p><strong>Exploring the Limits of Transfer Learning with a Unified Text-to-Text Transformer</strong></p>
<ul>
<li>Authors: Colin Raffel et al. (Google)</li>
<li>Key Contributions:
<ul>
<li>Unified text-to-text framework</li>
<li>All NLP tasks as text generation</li>
<li>Comprehensive study of transfer learning</li>
</ul>
</li>
<li>Format: "translate English to German: text" → "translation"</li>
</ul>
<h3 id="electra-2020"><a class="header" href="#electra-2020">ELECTRA (2020)</a></h3>
<p><strong>ELECTRA: Pre-training Text Encoders as Discriminators Rather Than Generators</strong></p>
<ul>
<li>Authors: Kevin Clark et al. (Stanford/Google)</li>
<li>Key Contributions:
<ul>
<li>Replaced token detection (RTD)</li>
<li>More sample-efficient than BERT</li>
<li>Generator-discriminator framework</li>
<li>Discriminator predicts which tokens are replaced</li>
</ul>
</li>
</ul>
<h2 id="generative-models-1"><a class="header" href="#generative-models-1">Generative Models</a></h2>
<h3 id="gan-2014"><a class="header" href="#gan-2014">GAN (2014)</a></h3>
<p><strong>Generative Adversarial Networks</strong></p>
<ul>
<li>Authors: Ian Goodfellow et al.</li>
<li>Key Contributions:
<ul>
<li>Two-player minimax game</li>
<li>Generator vs Discriminator</li>
<li>Implicit density modeling</li>
</ul>
</li>
<li>Objective: min_G max_D V(D,G) = E[log D(x)] + E[log(1-D(G(z)))]</li>
<li>Impact: New paradigm for generative modeling</li>
</ul>
<h3 id="dcgan-2015"><a class="header" href="#dcgan-2015">DCGAN (2015)</a></h3>
<p><strong>Unsupervised Representation Learning with Deep Convolutional GANs</strong></p>
<ul>
<li>Authors: Alec Radford, Luke Metz, Soumith Chintala</li>
<li>Key Contributions:
<ul>
<li>Architectural guidelines for stable GAN training</li>
<li>All convolutional network</li>
<li>Batch normalization</li>
<li>No fully connected layers</li>
</ul>
</li>
<li>Best practices: Strided convolutions, BatchNorm, LeakyReLU</li>
</ul>
<h3 id="stylegan-2018-2020"><a class="header" href="#stylegan-2018-2020">StyleGAN (2018-2020)</a></h3>
<p><strong>A Style-Based Generator Architecture for GANs</strong></p>
<ul>
<li>Authors: Tero Karras et al. (NVIDIA)</li>
<li>Key Contributions:
<ul>
<li>Style-based generator</li>
<li>Adaptive Instance Normalization (AdaIN)</li>
<li>Progressive growing</li>
<li>High-quality face generation</li>
</ul>
</li>
<li>StyleGAN2 improvements: Weight demodulation, path length regularization</li>
</ul>
<h3 id="vae-2013"><a class="header" href="#vae-2013">VAE (2013)</a></h3>
<p><strong>Auto-Encoding Variational Bayes</strong></p>
<ul>
<li>Authors: Diederik Kingma, Max Welling</li>
<li>Key Contributions:
<ul>
<li>Variational inference for latent variable models</li>
<li>Reparameterization trick</li>
<li>ELBO objective</li>
<li>Probabilistic encoder-decoder</li>
</ul>
</li>
<li>Objective: Maximize ELBO = E[log p(x|z)] - KL(q(z|x)||p(z))</li>
</ul>
<h3 id="diffusion-models-2020"><a class="header" href="#diffusion-models-2020">Diffusion Models (2020)</a></h3>
<p><strong>Denoising Diffusion Probabilistic Models</strong></p>
<ul>
<li>Authors: Jonathan Ho, Ajay Jain, Pieter Abbeel</li>
<li>Key Contributions:
<ul>
<li>Iterative denoising process</li>
<li>High-quality image generation</li>
<li>Stable training</li>
</ul>
</li>
<li>Process:
<ul>
<li>Forward: Gradually add noise</li>
<li>Reverse: Learn to denoise</li>
</ul>
</li>
</ul>
<h3 id="dall-e-2-2022"><a class="header" href="#dall-e-2-2022">DALL-E 2 (2022)</a></h3>
<p><strong>Hierarchical Text-Conditional Image Generation with CLIP Latents</strong></p>
<ul>
<li>Authors: Aditya Ramesh et al. (OpenAI)</li>
<li>Key Contributions:
<ul>
<li>Text-to-image generation</li>
<li>CLIP guidance</li>
<li>Prior and decoder models</li>
<li>Improved image quality and text alignment</li>
</ul>
</li>
</ul>
<h3 id="stable-diffusion-2022"><a class="header" href="#stable-diffusion-2022">Stable Diffusion (2022)</a></h3>
<p><strong>High-Resolution Image Synthesis with Latent Diffusion Models</strong></p>
<ul>
<li>Authors: Robin Rombach et al.</li>
<li>Key Contributions:
<ul>
<li>Diffusion in latent space</li>
<li>More efficient than pixel-space diffusion</li>
<li>Text-conditional generation</li>
<li>Open source</li>
</ul>
</li>
</ul>
<h2 id="reinforcement-learning-2"><a class="header" href="#reinforcement-learning-2">Reinforcement Learning</a></h2>
<h3 id="dqn-2013"><a class="header" href="#dqn-2013">DQN (2013)</a></h3>
<p><strong>Playing Atari with Deep Reinforcement Learning</strong></p>
<ul>
<li>Authors: Volodymyr Mnih et al. (DeepMind)</li>
<li>Key Contributions:
<ul>
<li>Deep Q-learning</li>
<li>Experience replay</li>
<li>Target network</li>
<li>End-to-end RL from pixels</li>
</ul>
</li>
<li>Impact: First deep RL to master Atari games</li>
</ul>
<h3 id="alphago-2016"><a class="header" href="#alphago-2016">AlphaGo (2016)</a></h3>
<p><strong>Mastering the game of Go with deep neural networks and tree search</strong></p>
<ul>
<li>Authors: David Silver et al. (DeepMind)</li>
<li>Key Contributions:
<ul>
<li>Combined deep learning with Monte Carlo Tree Search</li>
<li>Policy and value networks</li>
<li>Self-play training</li>
<li>Beat world champion Lee Sedol</li>
</ul>
</li>
<li>AlphaZero (2017): Generalized to chess and shogi</li>
</ul>
<h3 id="ppo-2017"><a class="header" href="#ppo-2017">PPO (2017)</a></h3>
<p><strong>Proximal Policy Optimization Algorithms</strong></p>
<ul>
<li>Authors: John Schulman et al. (OpenAI)</li>
<li>Key Contributions:
<ul>
<li>Clipped surrogate objective</li>
<li>Stable policy updates</li>
<li>Sample efficient</li>
<li>Easy to implement</li>
</ul>
</li>
<li>Widely used in practice</li>
</ul>
<h3 id="muzero-2019"><a class="header" href="#muzero-2019">MuZero (2019)</a></h3>
<p><strong>Mastering Atari, Go, Chess and Shogi by Planning with a Learned Model</strong></p>
<ul>
<li>Authors: Julian Schrittwieser et al. (DeepMind)</li>
<li>Key Contributions:
<ul>
<li>Model-based RL without knowing rules</li>
<li>Learns dynamics model</li>
<li>Plans in latent space</li>
<li>Superhuman performance</li>
</ul>
</li>
</ul>
<h3 id="decision-transformer-2021"><a class="header" href="#decision-transformer-2021">Decision Transformer (2021)</a></h3>
<p><strong>Decision Transformer: Reinforcement Learning via Sequence Modeling</strong></p>
<ul>
<li>Authors: Lili Chen et al. (Berkeley)</li>
<li>Key Contributions:
<ul>
<li>RL as sequence modeling</li>
<li>Conditional generation of actions</li>
<li>Leverages transformer architecture</li>
<li>Offline RL</li>
</ul>
</li>
</ul>
<h2 id="general-machine-learning"><a class="header" href="#general-machine-learning">General Machine Learning</a></h2>
<h3 id="dropout-2014"><a class="header" href="#dropout-2014">Dropout (2014)</a></h3>
<p><strong>Dropout: A Simple Way to Prevent Neural Networks from Overfitting</strong></p>
<ul>
<li>Authors: Nitish Srivastava et al.</li>
<li>Key Contributions:
<ul>
<li>Randomly drop units during training</li>
<li>Reduces overfitting</li>
<li>Ensemble effect</li>
<li>Simple and effective regularization</li>
</ul>
</li>
</ul>
<h3 id="batch-normalization-2015"><a class="header" href="#batch-normalization-2015">Batch Normalization (2015)</a></h3>
<p><strong>Batch Normalization: Accelerating Deep Network Training</strong></p>
<ul>
<li>Authors: Sergey Ioffe, Christian Szegedy (Google)</li>
<li>Key Contributions:
<ul>
<li>Normalize layer inputs</li>
<li>Reduces internal covariate shift</li>
<li>Enables higher learning rates</li>
<li>Acts as regularizer</li>
</ul>
</li>
<li>Operation: Normalize, then scale and shift</li>
</ul>
<h3 id="adam-optimizer-2014"><a class="header" href="#adam-optimizer-2014">Adam Optimizer (2014)</a></h3>
<p><strong>Adam: A Method for Stochastic Optimization</strong></p>
<ul>
<li>Authors: Diederik Kingma, Jimmy Ba</li>
<li>Key Contributions:
<ul>
<li>Adaptive learning rates</li>
<li>Combines momentum and RMSprop</li>
<li>Bias correction</li>
<li>Default optimizer for many tasks</li>
</ul>
</li>
</ul>
<h3 id="layer-normalization-2016"><a class="header" href="#layer-normalization-2016">Layer Normalization (2016)</a></h3>
<p><strong>Layer Normalization</strong></p>
<ul>
<li>Authors: Jimmy Lei Ba, Jamie Ryan Kiros, Geoffrey Hinton</li>
<li>Key Contributions:
<ul>
<li>Normalize across features</li>
<li>Better for RNNs and Transformers</li>
<li>No batch dependence</li>
</ul>
</li>
</ul>
<h3 id="elu-2015"><a class="header" href="#elu-2015">ELU (2015)</a></h3>
<p><strong>Fast and Accurate Deep Network Learning by Exponential Linear Units</strong></p>
<ul>
<li>Authors: Djork-Arné Clevert et al.</li>
<li>Key Contributions:
<ul>
<li>Negative values push mean towards zero</li>
<li>Reduces bias shift</li>
<li>Faster learning</li>
</ul>
</li>
</ul>
<h2 id="optimization-2"><a class="header" href="#optimization-2">Optimization</a></h2>
<h3 id="sgd-with-momentum-1999"><a class="header" href="#sgd-with-momentum-1999">SGD with Momentum (1999)</a></h3>
<p><strong>On the momentum term in gradient descent learning algorithms</strong></p>
<ul>
<li>Key Contributions:
<ul>
<li>Accumulate gradients</li>
<li>Faster convergence</li>
<li>Reduces oscillations</li>
</ul>
</li>
</ul>
<h3 id="rmsprop-2012"><a class="header" href="#rmsprop-2012">RMSprop (2012)</a></h3>
<p><strong>Neural Networks for Machine Learning - Lecture 6</strong></p>
<ul>
<li>Author: Geoffrey Hinton</li>
<li>Key Contributions:
<ul>
<li>Adaptive learning rates per parameter</li>
<li>Divides by running average of gradient magnitudes</li>
</ul>
</li>
</ul>
<h3 id="learning-rate-schedules"><a class="header" href="#learning-rate-schedules">Learning Rate Schedules</a></h3>
<p><strong>Cosine Annealing (2016)</strong></p>
<ul>
<li>SGDR: Stochastic Gradient Descent with Warm Restarts</li>
<li>Cosine decay with restarts</li>
<li>Enables finding multiple local minima</li>
</ul>
<p><strong>One Cycle Policy (2018)</strong></p>
<ul>
<li>Super-Convergence: Very Fast Training of Neural Networks</li>
<li>Cyclical learning rate with momentum</li>
<li>Train faster with fewer epochs</li>
</ul>
<h2 id="interpretability-and-explainability"><a class="header" href="#interpretability-and-explainability">Interpretability and Explainability</a></h2>
<h3 id="grad-cam-2016"><a class="header" href="#grad-cam-2016">Grad-CAM (2016)</a></h3>
<p><strong>Grad-CAM: Visual Explanations from Deep Networks</strong></p>
<ul>
<li>Authors: Ramprasaath Selvaraju et al.</li>
<li>Key Contributions:
<ul>
<li>Visualize what CNN looks at</li>
<li>Gradient-weighted class activation mapping</li>
<li>Works with any CNN architecture</li>
</ul>
</li>
</ul>
<h3 id="lime-2016"><a class="header" href="#lime-2016">LIME (2016)</a></h3>
<p><strong>"Why Should I Trust You?": Explaining Predictions of Any Classifier</strong></p>
<ul>
<li>Authors: Marco Tulio Ribeiro et al.</li>
<li>Key Contributions:
<ul>
<li>Local interpretable model-agnostic explanations</li>
<li>Approximate complex models locally</li>
<li>Works with any classifier</li>
</ul>
</li>
</ul>
<h3 id="shap-2017"><a class="header" href="#shap-2017">SHAP (2017)</a></h3>
<p><strong>A Unified Approach to Interpreting Model Predictions</strong></p>
<ul>
<li>Authors: Scott Lundberg, Su-In Lee</li>
<li>Key Contributions:
<ul>
<li>Shapley values for feature importance</li>
<li>Game-theoretic approach</li>
<li>Consistent and locally accurate</li>
</ul>
</li>
</ul>
<h2 id="efficiency-and-compression"><a class="header" href="#efficiency-and-compression">Efficiency and Compression</a></h2>
<h3 id="mobilenets-2017"><a class="header" href="#mobilenets-2017">MobileNets (2017)</a></h3>
<p><strong>MobileNets: Efficient Convolutional Neural Networks for Mobile Vision</strong></p>
<ul>
<li>Authors: Andrew Howard et al. (Google)</li>
<li>Key Contributions:
<ul>
<li>Depthwise separable convolutions</li>
<li>Width and resolution multipliers</li>
<li>Efficient for mobile devices</li>
</ul>
</li>
</ul>
<h3 id="squeezenet-2016"><a class="header" href="#squeezenet-2016">SqueezeNet (2016)</a></h3>
<p><strong>SqueezeNet: AlexNet-level accuracy with 50x fewer parameters</strong></p>
<ul>
<li>Authors: Forrest Iandola et al.</li>
<li>Key Contributions:
<ul>
<li>Fire modules (squeeze and expand)</li>
<li>50x fewer parameters than AlexNet</li>
<li>Small model size</li>
</ul>
</li>
</ul>
<h3 id="knowledge-distillation-2015"><a class="header" href="#knowledge-distillation-2015">Knowledge Distillation (2015)</a></h3>
<p><strong>Distilling the Knowledge in a Neural Network</strong></p>
<ul>
<li>Authors: Geoffrey Hinton, Oriol Vinyals, Jeff Dean</li>
<li>Key Contributions:
<ul>
<li>Transfer knowledge from large to small model</li>
<li>Soft targets from teacher</li>
<li>Temperature scaling</li>
</ul>
</li>
</ul>
<h3 id="pruning-2015"><a class="header" href="#pruning-2015">Pruning (2015)</a></h3>
<p><strong>Learning both Weights and Connections for Efficient Neural Networks</strong></p>
<ul>
<li>Authors: Song Han et al.</li>
<li>Key Contributions:
<ul>
<li>Remove unimportant weights</li>
<li>Magnitude-based pruning</li>
<li>Reduce model size and computation</li>
</ul>
</li>
</ul>
<h2 id="meta-learning"><a class="header" href="#meta-learning">Meta-Learning</a></h2>
<h3 id="maml-2017"><a class="header" href="#maml-2017">MAML (2017)</a></h3>
<p><strong>Model-Agnostic Meta-Learning for Fast Adaptation</strong></p>
<ul>
<li>Authors: Chelsea Finn, Pieter Abbeel, Sergey Levine</li>
<li>Key Contributions:
<ul>
<li>Learn good initialization</li>
<li>Fast adaptation to new tasks</li>
<li>Few-shot learning</li>
<li>Bi-level optimization</li>
</ul>
</li>
</ul>
<h3 id="prototypical-networks-2017"><a class="header" href="#prototypical-networks-2017">Prototypical Networks (2017)</a></h3>
<p><strong>Prototypical Networks for Few-shot Learning</strong></p>
<ul>
<li>Authors: Jake Snell, Kevin Swersky, Richard Zemel</li>
<li>Key Contributions:
<ul>
<li>Learn metric space</li>
<li>Class prototypes as centroids</li>
<li>Simple and effective</li>
</ul>
</li>
</ul>
<h2 id="self-supervised-learning"><a class="header" href="#self-supervised-learning">Self-Supervised Learning</a></h2>
<h3 id="simclr-2020"><a class="header" href="#simclr-2020">SimCLR (2020)</a></h3>
<p><strong>A Simple Framework for Contrastive Learning of Visual Representations</strong></p>
<ul>
<li>Authors: Ting Chen et al. (Google)</li>
<li>Key Contributions:
<ul>
<li>Contrastive learning framework</li>
<li>Large batch sizes crucial</li>
<li>Strong data augmentation</li>
<li>No labels needed</li>
</ul>
</li>
</ul>
<h3 id="byol-2020"><a class="header" href="#byol-2020">BYOL (2020)</a></h3>
<p><strong>Bootstrap Your Own Latent: A New Approach to Self-Supervised Learning</strong></p>
<ul>
<li>Authors: Jean-Bastien Grill et al. (DeepMind)</li>
<li>Key Contributions:
<ul>
<li>No negative pairs needed</li>
<li>Online and target networks</li>
<li>Momentum encoder</li>
<li>State-of-the-art representations</li>
</ul>
</li>
</ul>
<h3 id="mae-2021"><a class="header" href="#mae-2021">MAE (2021)</a></h3>
<p><strong>Masked Autoencoders Are Scalable Vision Learners</strong></p>
<ul>
<li>Authors: Kaiming He et al. (Facebook AI)</li>
<li>Key Contributions:
<ul>
<li>Mask random patches</li>
<li>Reconstruct missing pixels</li>
<li>Simple and scalable</li>
<li>Asymmetric encoder-decoder</li>
</ul>
</li>
</ul>
<h2 id="papers-to-read"><a class="header" href="#papers-to-read">Papers to Read</a></h2>
<h3 id="foundational"><a class="header" href="#foundational">Foundational</a></h3>
<ol>
<li>Neural Networks and Deep Learning (Nielsen)</li>
<li>Deep Learning Book (Goodfellow et al.)</li>
<li>Pattern Recognition and Machine Learning (Bishop)</li>
</ol>
<h3 id="recent-surveys"><a class="header" href="#recent-surveys">Recent Surveys</a></h3>
<ul>
<li>Attention mechanisms survey</li>
<li>Transfer learning survey</li>
<li>Self-supervised learning survey</li>
<li>Efficient deep learning survey</li>
</ul>
<h3 id="follow-these-venues"><a class="header" href="#follow-these-venues">Follow These Venues</a></h3>
<ul>
<li>NeurIPS, ICML, ICLR (ML conferences)</li>
<li>CVPR, ICCV, ECCV (Computer Vision)</li>
<li>ACL, EMNLP, NAACL (NLP)</li>
<li>AAAI, IJCAI (AI)</li>
</ul>
<h2 id="resources-20"><a class="header" href="#resources-20">Resources</a></h2>
<ul>
<li>arXiv.org: Pre-prints of latest research</li>
<li>Papers with Code: Papers with implementations</li>
<li>Google Scholar: Citation tracking</li>
<li>Semantic Scholar: AI-powered search</li>
<li>Distill.pub: Clear explanations</li>
<li>Two Minute Papers: Video summaries</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="artificial-intelligence-ai-documentation"><a class="header" href="#artificial-intelligence-ai-documentation">Artificial Intelligence (AI) Documentation</a></h1>
<p>A comprehensive guide to modern AI technologies, tools, and best practices.</p>
<h2 id="overview-48"><a class="header" href="#overview-48">Overview</a></h2>
<p>This directory contains documentation on various AI topics, focusing on practical applications, implementation guides, and best practices for working with modern AI systems.</p>
<h2 id="contents"><a class="header" href="#contents">Contents</a></h2>
<h3 id="1-prompt-engineering"><a class="header" href="#1-prompt-engineering">1. <a href="ai/./prompt_engineering.html">Prompt Engineering</a></a></h3>
<p>Learn the art and science of crafting effective prompts for Large Language Models (LLMs):</p>
<ul>
<li>Core principles and techniques</li>
<li>Prompt patterns and templates</li>
<li>Chain-of-Thought reasoning</li>
<li>Few-shot and zero-shot learning</li>
<li>Advanced strategies for different tasks</li>
</ul>
<h3 id="2-generative-ai"><a class="header" href="#2-generative-ai">2. <a href="ai/./generative_ai.html">Generative AI</a></a></h3>
<p>Comprehensive overview of generative AI models and applications:</p>
<ul>
<li>Text generation (GPT, Claude, PaLM)</li>
<li>Image generation (DALL-E, Midjourney, Stable Diffusion)</li>
<li>Audio and video synthesis</li>
<li>Multimodal models</li>
<li>Real-world applications and use cases</li>
</ul>
<h3 id="3-stable-diffusion"><a class="header" href="#3-stable-diffusion">3. <a href="ai/./stable_diffusion.html">Stable Diffusion</a></a></h3>
<p>Detailed guide to Stable Diffusion for image generation:</p>
<ul>
<li>Installation and setup</li>
<li>Prompt engineering for images</li>
<li>Parameters and settings</li>
<li>ControlNet and extensions</li>
<li>Optimization tips</li>
</ul>
<h3 id="4-flux1"><a class="header" href="#4-flux1">4. <a href="ai/./fluxdev.html">Flux.1</a></a></h3>
<p>Documentation for Black Forest Labs' Flux.1 model:</p>
<ul>
<li>Model variants (Dev, Schnell, Pro)</li>
<li>Setup and usage</li>
<li>Comparison with other models</li>
<li>Advanced techniques</li>
</ul>
<h3 id="5-llama-models"><a class="header" href="#5-llama-models">5. <a href="ai/./llama.html">Llama Models</a></a></h3>
<p>Complete guide to Meta's Llama family of models:</p>
<ul>
<li>Model architecture and variants</li>
<li>Installation and setup</li>
<li>Fine-tuning techniques</li>
<li>Inference optimization</li>
<li>Deployment strategies</li>
</ul>
<h3 id="6-large-language-models-llms"><a class="header" href="#6-large-language-models-llms">6. <a href="ai/./llms.html">Large Language Models (LLMs)</a></a></h3>
<p>Comprehensive overview of Large Language Models:</p>
<ul>
<li>LLM fundamentals and architecture</li>
<li>Transformer models and attention mechanisms</li>
<li>Training and inference</li>
<li>Prompt engineering techniques</li>
<li>API usage and best practices</li>
</ul>
<h3 id="7-comfyui"><a class="header" href="#7-comfyui">7. <a href="ai/./comfyui.html">ComfyUI</a></a></h3>
<p>Node-based interface for Stable Diffusion workflows:</p>
<ul>
<li>Installation and setup</li>
<li>Workflow creation</li>
<li>Custom nodes and extensions</li>
<li>Advanced generation techniques</li>
<li>Integration with other tools</li>
</ul>
<h3 id="8-fine-tuning"><a class="header" href="#8-fine-tuning">8. <a href="ai/./fine_tuning.html">Fine-Tuning</a></a></h3>
<p>Model adaptation and customization:</p>
<ul>
<li>Fine-tuning strategies and approaches</li>
<li>Parameter-efficient methods (LoRA, QLoRA)</li>
<li>Dataset preparation and quality</li>
<li>Training configuration and optimization</li>
<li>Evaluation and deployment</li>
</ul>
<h2 id="key-ai-concepts"><a class="header" href="#key-ai-concepts">Key AI Concepts</a></h2>
<h3 id="large-language-models-llms"><a class="header" href="#large-language-models-llms">Large Language Models (LLMs)</a></h3>
<p>LLMs are neural networks trained on vast amounts of text data to understand and generate human-like text. Key characteristics:</p>
<ul>
<li><strong>Scale</strong>: Billions to trillions of parameters</li>
<li><strong>Training</strong>: Self-supervised learning on diverse text corpora</li>
<li><strong>Capabilities</strong>: Text generation, reasoning, code writing, translation, etc.</li>
<li><strong>Examples</strong>: GPT-4, Claude, Llama, PaLM, Mistral</li>
</ul>
<h3 id="transformer-architecture"><a class="header" href="#transformer-architecture">Transformer Architecture</a></h3>
<p>The foundation of modern LLMs:</p>
<pre><code>Input → Tokenization → Embedding → 
  Positional Encoding → 
  Multi-Head Attention → 
  Feed Forward → 
  Layer Norm → 
  Output
</code></pre>
<p>Key components:</p>
<ul>
<li><strong>Self-Attention</strong>: Allows model to weigh importance of different tokens</li>
<li><strong>Positional Encoding</strong>: Provides sequence order information</li>
<li><strong>Feed-Forward Networks</strong>: Process attention outputs</li>
<li><strong>Residual Connections</strong>: Enable training of deep networks</li>
</ul>
<h3 id="diffusion-models-2"><a class="header" href="#diffusion-models-2">Diffusion Models</a></h3>
<p>State-of-the-art image generation approach:</p>
<ol>
<li><strong>Forward Process</strong>: Gradually add noise to images</li>
<li><strong>Reverse Process</strong>: Learn to denoise, generating new images</li>
<li><strong>Conditioning</strong>: Guide generation with text, images, or other inputs</li>
</ol>
<h2 id="popular-ai-tools--frameworks"><a class="header" href="#popular-ai-tools--frameworks">Popular AI Tools &amp; Frameworks</a></h2>
<h3 id="for-llms"><a class="header" href="#for-llms">For LLMs</a></h3>
<pre><code class="language-bash"># OpenAI API
pip install openai

# Anthropic Claude
pip install anthropic

# Hugging Face Transformers
pip install transformers torch

# LangChain for LLM applications
pip install langchain langchain-community

# LlamaIndex for RAG
pip install llama-index
</code></pre>
<h3 id="for-image-generation"><a class="header" href="#for-image-generation">For Image Generation</a></h3>
<pre><code class="language-bash"># Stable Diffusion WebUI (AUTOMATIC1111)
git clone https://github.com/AUTOMATIC1111/stable-diffusion-webui
cd stable-diffusion-webui
./webui.sh

# ComfyUI (node-based interface)
git clone https://github.com/comfyanonymous/ComfyUI
cd ComfyUI
pip install -r requirements.txt

# Diffusers library
pip install diffusers transformers accelerate
</code></pre>
<h3 id="for-model-training--fine-tuning"><a class="header" href="#for-model-training--fine-tuning">For Model Training &amp; Fine-tuning</a></h3>
<pre><code class="language-bash"># Hugging Face ecosystem
pip install transformers datasets accelerate peft bitsandbytes

# PyTorch
pip install torch torchvision torchaudio

# DeepSpeed for distributed training
pip install deepspeed

# Axolotl for fine-tuning
git clone https://github.com/OpenAccess-AI-Collective/axolotl
</code></pre>
<h2 id="quick-start-examples"><a class="header" href="#quick-start-examples">Quick Start Examples</a></h2>
<h3 id="using-openai-api"><a class="header" href="#using-openai-api">Using OpenAI API</a></h3>
<pre><code class="language-python">from openai import OpenAI

client = OpenAI(api_key="your-api-key")

response = client.chat.completions.create(
    model="gpt-4",
    messages=[
        {"role": "system", "content": "You are a helpful assistant."},
        {"role": "user", "content": "Explain quantum computing in simple terms."}
    ]
)

print(response.choices[0].message.content)
</code></pre>
<h3 id="using-anthropic-claude"><a class="header" href="#using-anthropic-claude">Using Anthropic Claude</a></h3>
<pre><code class="language-python">import anthropic

client = anthropic.Anthropic(api_key="your-api-key")

message = client.messages.create(
    model="claude-sonnet-4-5-20250929",
    max_tokens=1024,
    messages=[
        {"role": "user", "content": "Write a Python function to calculate Fibonacci numbers."}
    ]
)

print(message.content[0].text)
</code></pre>
<h3 id="using-hugging-face-transformers"><a class="header" href="#using-hugging-face-transformers">Using Hugging Face Transformers</a></h3>
<pre><code class="language-python">from transformers import AutoTokenizer, AutoModelForCausalLM
import torch

# Load model and tokenizer
model_name = "meta-llama/Llama-3.2-3B-Instruct"
tokenizer = AutoTokenizer.from_pretrained(model_name)
model = AutoModelForCausalLM.from_pretrained(
    model_name,
    torch_dtype=torch.float16,
    device_map="auto"
)

# Generate text
prompt = "What is the theory of relativity?"
inputs = tokenizer(prompt, return_tensors="pt").to(model.device)
outputs = model.generate(**inputs, max_length=200)
print(tokenizer.decode(outputs[0], skip_special_tokens=True))
</code></pre>
<h3 id="using-stable-diffusion"><a class="header" href="#using-stable-diffusion">Using Stable Diffusion</a></h3>
<pre><code class="language-python">from diffusers import StableDiffusionPipeline
import torch

# Load pipeline
pipe = StableDiffusionPipeline.from_pretrained(
    "stabilityai/stable-diffusion-2-1",
    torch_dtype=torch.float16
)
pipe = pipe.to("cuda")

# Generate image
prompt = "a serene mountain landscape at sunset, oil painting style"
image = pipe(prompt, num_inference_steps=50, guidance_scale=7.5).images[0]
image.save("output.png")
</code></pre>
<h2 id="best-practices-35"><a class="header" href="#best-practices-35">Best Practices</a></h2>
<h3 id="1-prompt-engineering-1"><a class="header" href="#1-prompt-engineering-1">1. Prompt Engineering</a></h3>
<ul>
<li>Be specific and clear in your instructions</li>
<li>Provide context and examples</li>
<li>Use system prompts to set behavior</li>
<li>Iterate and refine based on outputs</li>
</ul>
<h3 id="2-model-selection"><a class="header" href="#2-model-selection">2. Model Selection</a></h3>
<ul>
<li>Choose the right model for your task</li>
<li>Balance capability vs. cost vs. speed</li>
<li>Consider fine-tuning for specialized tasks</li>
<li>Use quantization for resource constraints</li>
</ul>
<h3 id="3-safety--ethics"><a class="header" href="#3-safety--ethics">3. Safety &amp; Ethics</a></h3>
<ul>
<li>Implement content filtering</li>
<li>Monitor for bias and fairness</li>
<li>Respect copyright and attribution</li>
<li>Ensure data privacy and security</li>
</ul>
<h3 id="4-performance-optimization"><a class="header" href="#4-performance-optimization">4. Performance Optimization</a></h3>
<ul>
<li>Use batch processing when possible</li>
<li>Implement caching for repeated queries</li>
<li>Optimize prompts for token efficiency</li>
<li>Use streaming for real-time responses</li>
</ul>
<h2 id="resources-21"><a class="header" href="#resources-21">Resources</a></h2>
<h3 id="official-documentation-2"><a class="header" href="#official-documentation-2">Official Documentation</a></h3>
<ul>
<li><a href="https://platform.openai.com/docs">OpenAI Documentation</a></li>
<li><a href="https://docs.anthropic.com">Anthropic Documentation</a></li>
<li><a href="https://huggingface.co/docs">Hugging Face Documentation</a></li>
<li><a href="https://stability.ai/documentation">Stability AI</a></li>
</ul>
<h3 id="learning-resources-1"><a class="header" href="#learning-resources-1">Learning Resources</a></h3>
<ul>
<li><a href="https://www.deeplearning.ai/">DeepLearning.AI Courses</a></li>
<li><a href="https://www.fast.ai/">Fast.ai</a></li>
<li><a href="https://huggingface.co/learn">Hugging Face Course</a></li>
<li><a href="https://paperswithcode.com/">Papers with Code</a></li>
</ul>
<h3 id="community-1"><a class="header" href="#community-1">Community</a></h3>
<ul>
<li><a href="https://www.reddit.com/r/MachineLearning/">r/MachineLearning</a></li>
<li><a href="https://www.reddit.com/r/StableDiffusion/">r/StableDiffusion</a></li>
<li><a href="https://discuss.huggingface.co/">Hugging Face Forums</a></li>
<li><a href="https://discord.gg/stablediffusion">Discord Communities</a></li>
</ul>
<h2 id="contributing-1"><a class="header" href="#contributing-1">Contributing</a></h2>
<p>This documentation is continuously updated with new techniques, models, and best practices. Each section contains practical examples and code snippets that you can use immediately.</p>
<h2 id="license"><a class="header" href="#license">License</a></h2>
<p>This documentation is provided for educational purposes. Please refer to individual model and tool licenses for usage terms.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="generative-ai"><a class="header" href="#generative-ai">Generative AI</a></h1>
<p>A comprehensive guide to generative AI models, applications, and practical implementations.</p>
<h2 id="table-of-contents-25"><a class="header" href="#table-of-contents-25">Table of Contents</a></h2>
<ul>
<li><a href="ai/generative_ai.html#introduction">Introduction</a></li>
<li><a href="ai/generative_ai.html#core-concepts">Core Concepts</a></li>
<li><a href="ai/generative_ai.html#text-generation">Text Generation</a></li>
<li><a href="ai/generative_ai.html#image-generation">Image Generation</a></li>
<li><a href="ai/generative_ai.html#audio-generation">Audio Generation</a></li>
<li><a href="ai/generative_ai.html#video-generation">Video Generation</a></li>
<li><a href="ai/generative_ai.html#multimodal-models">Multimodal Models</a></li>
<li><a href="ai/generative_ai.html#applications">Applications</a></li>
<li><a href="ai/generative_ai.html#implementation-examples">Implementation Examples</a></li>
</ul>
<h2 id="introduction-7"><a class="header" href="#introduction-7">Introduction</a></h2>
<p>Generative AI refers to artificial intelligence systems that can create new content—text, images, audio, video, code, and more. Unlike discriminative models that classify or predict, generative models learn to produce novel outputs that resemble their training data.</p>
<h3 id="key-characteristics"><a class="header" href="#key-characteristics">Key Characteristics</a></h3>
<ul>
<li><strong>Content Creation</strong>: Generate new, original content</li>
<li><strong>Pattern Learning</strong>: Understand and replicate complex patterns</li>
<li><strong>Conditional Generation</strong>: Create outputs based on specific inputs/prompts</li>
<li><strong>Iterative Refinement</strong>: Improve outputs through multiple passes</li>
</ul>
<h2 id="core-concepts-3"><a class="header" href="#core-concepts-3">Core Concepts</a></h2>
<h3 id="1-generative-models"><a class="header" href="#1-generative-models">1. Generative Models</a></h3>
<h4 id="autoregressive-models-1"><a class="header" href="#autoregressive-models-1">Autoregressive Models</a></h4>
<p>Generate sequences one token at a time, using previous tokens as context:</p>
<pre><code>P(x₁, x₂, ..., xₙ) = P(x₁) × P(x₂|x₁) × P(x₃|x₁,x₂) × ... × P(xₙ|x₁,...,xₙ₋₁)
</code></pre>
<p>Examples: GPT series, LLaMA</p>
<h4 id="diffusion-models-3"><a class="header" href="#diffusion-models-3">Diffusion Models</a></h4>
<p>Learn to denoise data through iterative refinement:</p>
<pre><code>Forward process: x₀ → x₁ → ... → xₜ (add noise)
Reverse process: xₜ → xₜ₋₁ → ... → x₀ (remove noise)
</code></pre>
<p>Examples: Stable Diffusion, DALL-E 3, Midjourney</p>
<h4 id="variational-autoencoders-vae"><a class="header" href="#variational-autoencoders-vae">Variational Autoencoders (VAE)</a></h4>
<p>Learn compressed representations in latent space:</p>
<pre><code>Encoder: x → z (data to latent space)
Decoder: z → x' (latent space to reconstruction)
</code></pre>
<h4 id="generative-adversarial-networks-gan"><a class="header" href="#generative-adversarial-networks-gan">Generative Adversarial Networks (GAN)</a></h4>
<p>Two networks compete—generator creates, discriminator evaluates:</p>
<pre><code>Generator: z → x (noise to data)
Discriminator: x → [0,1] (real vs fake)
</code></pre>
<p>Examples: StyleGAN, BigGAN</p>
<h3 id="2-foundation-models"><a class="header" href="#2-foundation-models">2. Foundation Models</a></h3>
<p>Large-scale models trained on vast datasets, adaptable to many tasks:</p>
<ul>
<li><strong>Scale</strong>: Billions to trillions of parameters</li>
<li><strong>Transfer Learning</strong>: Fine-tune for specific tasks</li>
<li><strong>Few-Shot Learning</strong>: Adapt with minimal examples</li>
<li><strong>Emergent Abilities</strong>: Capabilities not explicitly trained</li>
</ul>
<h2 id="text-generation"><a class="header" href="#text-generation">Text Generation</a></h2>
<h3 id="large-language-models-llms-1"><a class="header" href="#large-language-models-llms-1">Large Language Models (LLMs)</a></h3>
<h4 id="gpt-family-openai"><a class="header" href="#gpt-family-openai">GPT Family (OpenAI)</a></h4>
<pre><code class="language-python">from openai import OpenAI

client = OpenAI(api_key="your-key")

# GPT-4 Turbo - Most capable
response = client.chat.completions.create(
    model="gpt-4-turbo-preview",
    messages=[
        {"role": "system", "content": "You are a creative writer."},
        {"role": "user", "content": "Write a short sci-fi story about AI."}
    ],
    temperature=0.8,
    max_tokens=500
)

print(response.choices[0].message.content)
</code></pre>
<p><strong>Models:</strong></p>
<ul>
<li><code>gpt-4-turbo</code>: Most capable, best for complex tasks</li>
<li><code>gpt-4</code>: High capability, slower and more expensive</li>
<li><code>gpt-3.5-turbo</code>: Fast, cost-effective for simple tasks</li>
</ul>
<h4 id="claude-anthropic"><a class="header" href="#claude-anthropic">Claude (Anthropic)</a></h4>
<pre><code class="language-python">import anthropic

client = anthropic.Anthropic(api_key="your-key")

# Claude Sonnet 4.5 - Latest model
message = client.messages.create(
    model="claude-sonnet-4-5-20250929",
    max_tokens=1024,
    messages=[
        {
            "role": "user", 
            "content": "Analyze this code and suggest improvements: [code]"
        }
    ]
)

print(message.content[0].text)
</code></pre>
<p><strong>Models:</strong></p>
<ul>
<li><code>claude-sonnet-4-5</code>: Balanced performance and capability</li>
<li><code>claude-opus-4</code>: Most capable, deep analysis</li>
<li><code>claude-haiku-4</code>: Fastest, most cost-effective</li>
</ul>
<h4 id="llama-meta"><a class="header" href="#llama-meta">Llama (Meta)</a></h4>
<pre><code class="language-python">from transformers import AutoTokenizer, AutoModelForCausalLM
import torch

model_name = "meta-llama/Llama-3.2-3B-Instruct"
tokenizer = AutoTokenizer.from_pretrained(model_name)
model = AutoModelForCausalLM.from_pretrained(
    model_name,
    torch_dtype=torch.float16,
    device_map="auto"
)

# Chat format
messages = [
    {"role": "system", "content": "You are a helpful assistant."},
    {"role": "user", "content": "Explain quantum computing."}
]

input_ids = tokenizer.apply_chat_template(
    messages,
    return_tensors="pt"
).to(model.device)

outputs = model.generate(
    input_ids,
    max_new_tokens=256,
    temperature=0.7,
    top_p=0.9
)

print(tokenizer.decode(outputs[0], skip_special_tokens=True))
</code></pre>
<h4 id="mistral"><a class="header" href="#mistral">Mistral</a></h4>
<pre><code class="language-python">from mistralai.client import MistralClient
from mistralai.models.chat_completion import ChatMessage

client = MistralClient(api_key="your-key")

messages = [
    ChatMessage(role="user", content="What is machine learning?")
]

# Mistral Large - Most capable
response = client.chat(
    model="mistral-large-latest",
    messages=messages
)

print(response.choices[0].message.content)
</code></pre>
<h3 id="use-cases-for-text-generation"><a class="header" href="#use-cases-for-text-generation">Use Cases for Text Generation</a></h3>
<h4 id="1-content-creation"><a class="header" href="#1-content-creation">1. Content Creation</a></h4>
<pre><code class="language-python"># Blog post generation
prompt = """
Write a 500-word blog post about sustainable living.

Include:
- Engaging introduction
- 3 practical tips
- Statistics or facts
- Call to action

Tone: Informative but conversational
"""
</code></pre>
<h4 id="2-code-generation"><a class="header" href="#2-code-generation">2. Code Generation</a></h4>
<pre><code class="language-python"># Function generation
prompt = """
Create a Python function that:
- Takes a list of dictionaries
- Filters by a key-value pair
- Sorts by another key
- Returns top N results

Include type hints and docstring.
"""
</code></pre>
<h4 id="3-data-analysis"><a class="header" href="#3-data-analysis">3. Data Analysis</a></h4>
<pre><code class="language-python"># Analysis prompt
prompt = """
Analyze this sales data and provide:
1. Key trends
2. Anomalies
3. Predictions
4. Recommendations

Data: [CSV or JSON data]
"""
</code></pre>
<h4 id="4-translation"><a class="header" href="#4-translation">4. Translation</a></h4>
<pre><code class="language-python"># Contextual translation
prompt = """
Translate this technical documentation from English to Spanish:

[text]

Maintain:
- Technical terminology accuracy
- Professional tone
- Code examples unchanged
"""
</code></pre>
<h2 id="image-generation"><a class="header" href="#image-generation">Image Generation</a></h2>
<h3 id="stable-diffusion"><a class="header" href="#stable-diffusion">Stable Diffusion</a></h3>
<pre><code class="language-python">from diffusers import StableDiffusionPipeline, DPMSolverMultistepScheduler
import torch

# Load model
model_id = "stabilityai/stable-diffusion-2-1"
pipe = StableDiffusionPipeline.from_pretrained(
    model_id,
    torch_dtype=torch.float16
)
pipe.scheduler = DPMSolverMultistepScheduler.from_config(
    pipe.scheduler.config
)
pipe = pipe.to("cuda")

# Generate image
prompt = "a serene japanese garden with cherry blossoms, koi pond, stone lanterns, soft morning light, highly detailed, 4k"
negative_prompt = "blurry, distorted, low quality, watermark"

image = pipe(
    prompt=prompt,
    negative_prompt=negative_prompt,
    num_inference_steps=30,
    guidance_scale=7.5,
    width=768,
    height=768
).images[0]

image.save("japanese_garden.png")
</code></pre>
<h3 id="dall-e-3-openai"><a class="header" href="#dall-e-3-openai">DALL-E 3 (OpenAI)</a></h3>
<pre><code class="language-python">from openai import OpenAI

client = OpenAI()

response = client.images.generate(
    model="dall-e-3",
    prompt="A futuristic city with flying cars and neon lights, cyberpunk style, detailed, high quality",
    size="1024x1024",
    quality="hd",
    n=1
)

image_url = response.data[0].url
print(f"Generated image: {image_url}")
</code></pre>
<h3 id="midjourney"><a class="header" href="#midjourney">Midjourney</a></h3>
<p>Accessed through Discord bot:</p>
<pre><code>/imagine prompt: a mystical forest with glowing mushrooms, ethereal lighting, fantasy art style, intricate details --v 6 --ar 16:9 --q 2
</code></pre>
<p>Parameters:</p>
<ul>
<li><code>--v</code>: Version (6 is latest)</li>
<li><code>--ar</code>: Aspect ratio</li>
<li><code>--q</code>: Quality (0.25, 0.5, 1, 2)</li>
<li><code>--s</code>: Stylization (0-1000)</li>
</ul>
<h3 id="image-to-image"><a class="header" href="#image-to-image">Image-to-Image</a></h3>
<pre><code class="language-python">from diffusers import StableDiffusionImg2ImgPipeline
from PIL import Image

pipe = StableDiffusionImg2ImgPipeline.from_pretrained(
    "stabilityai/stable-diffusion-2-1",
    torch_dtype=torch.float16
).to("cuda")

# Load initial image
init_image = Image.open("sketch.png").convert("RGB")
init_image = init_image.resize((768, 768))

# Transform image
prompt = "a professional photograph of a modern building, architectural photography"
images = pipe(
    prompt=prompt,
    image=init_image,
    strength=0.75,  # How much to transform (0=no change, 1=complete regeneration)
    guidance_scale=7.5,
    num_inference_steps=50
).images

images[0].save("transformed.png")
</code></pre>
<h3 id="inpainting"><a class="header" href="#inpainting">Inpainting</a></h3>
<pre><code class="language-python">from diffusers import StableDiffusionInpaintPipeline

pipe = StableDiffusionInpaintPipeline.from_pretrained(
    "stabilityai/stable-diffusion-2-inpainting",
    torch_dtype=torch.float16
).to("cuda")

# Load image and mask
image = Image.open("photo.png")
mask = Image.open("mask.png")  # White areas will be regenerated

prompt = "a red sports car"
result = pipe(
    prompt=prompt,
    image=image,
    mask_image=mask,
    num_inference_steps=50
).images[0]

result.save("inpainted.png")
</code></pre>
<h2 id="audio-generation"><a class="header" href="#audio-generation">Audio Generation</a></h2>
<h3 id="text-to-speech"><a class="header" href="#text-to-speech">Text-to-Speech</a></h3>
<h4 id="openai-tts"><a class="header" href="#openai-tts">OpenAI TTS</a></h4>
<pre><code class="language-python">from openai import OpenAI
from pathlib import Path

client = OpenAI()

speech_file_path = Path("output.mp3")

response = client.audio.speech.create(
    model="tts-1-hd",
    voice="nova",  # alloy, echo, fable, onyx, nova, shimmer
    input="Hello! This is a generated voice. AI can now speak naturally."
)

response.stream_to_file(speech_file_path)
</code></pre>
<h4 id="elevenlabs"><a class="header" href="#elevenlabs">ElevenLabs</a></h4>
<pre><code class="language-python">from elevenlabs import generate, play, set_api_key

set_api_key("your-api-key")

audio = generate(
    text="Welcome to the future of voice synthesis.",
    voice="Bella",
    model="eleven_monolingual_v1"
)

play(audio)
</code></pre>
<h3 id="music-generation"><a class="header" href="#music-generation">Music Generation</a></h3>
<h4 id="musicgen-meta"><a class="header" href="#musicgen-meta">MusicGen (Meta)</a></h4>
<pre><code class="language-python">from audiocraft.models import MusicGen
import torchaudio

model = MusicGen.get_pretrained('facebook/musicgen-medium')

# Generate music
descriptions = ['upbeat electronic dance music with strong bass']
duration = 30  # seconds

model.set_generation_params(duration=duration)
wav = model.generate(descriptions)

# Save
for idx, one_wav in enumerate(wav):
    torchaudio.save(f'generated_{idx}.wav', one_wav.cpu(), model.sample_rate)
</code></pre>
<h2 id="video-generation"><a class="header" href="#video-generation">Video Generation</a></h2>
<h3 id="stable-video-diffusion"><a class="header" href="#stable-video-diffusion">Stable Video Diffusion</a></h3>
<pre><code class="language-python">from diffusers import StableVideoDiffusionPipeline
from PIL import Image

pipe = StableVideoDiffusionPipeline.from_pretrained(
    "stabilityai/stable-video-diffusion-img2vid-xt",
    torch_dtype=torch.float16,
    variant="fp16"
)
pipe.to("cuda")

# Load initial image
image = Image.open("first_frame.png")

# Generate video frames
frames = pipe(image, decode_chunk_size=8, num_frames=25).frames[0]

# Save as video
from diffusers.utils import export_to_video
export_to_video(frames, "output_video.mp4", fps=7)
</code></pre>
<h3 id="runwayml-gen-2"><a class="header" href="#runwayml-gen-2">RunwayML Gen-2</a></h3>
<p>API-based video generation:</p>
<pre><code class="language-python">import runwayml

client = runwayml.RunwayML(api_key="your-key")

# Text to video
task = client.image_generation.create(
    prompt="a serene ocean at sunset with waves gently crashing",
    model="gen2",
    duration=4
)

# Wait for completion and download
video_url = task.get_output_url()
</code></pre>
<h2 id="multimodal-models"><a class="header" href="#multimodal-models">Multimodal Models</a></h2>
<h3 id="gpt-4-vision"><a class="header" href="#gpt-4-vision">GPT-4 Vision</a></h3>
<pre><code class="language-python">from openai import OpenAI

client = OpenAI()

response = client.chat.completions.create(
    model="gpt-4-vision-preview",
    messages=[
        {
            "role": "user",
            "content": [
                {"type": "text", "text": "What's in this image?"},
                {
                    "type": "image_url",
                    "image_url": {
                        "url": "https://example.com/image.jpg"
                    }
                }
            ]
        }
    ],
    max_tokens=300
)

print(response.choices[0].message.content)
</code></pre>
<h3 id="claude-vision"><a class="header" href="#claude-vision">Claude Vision</a></h3>
<pre><code class="language-python">import anthropic
import base64

client = anthropic.Anthropic()

# Read and encode image
with open("image.jpg", "rb") as image_file:
    image_data = base64.standard_b64encode(image_file.read()).decode("utf-8")

message = client.messages.create(
    model="claude-sonnet-4-5-20250929",
    max_tokens=1024,
    messages=[
        {
            "role": "user",
            "content": [
                {
                    "type": "image",
                    "source": {
                        "type": "base64",
                        "media_type": "image/jpeg",
                        "data": image_data,
                    },
                },
                {
                    "type": "text",
                    "text": "Describe this image in detail."
                }
            ],
        }
    ],
)

print(message.content[0].text)
</code></pre>
<h3 id="llava-open-source"><a class="header" href="#llava-open-source">LLaVA (Open Source)</a></h3>
<pre><code class="language-python">from llava.model.builder import load_pretrained_model
from llava.mm_utils import get_model_name_from_path, process_images
from PIL import Image

model_path = "liuhaotian/llava-v1.5-7b"
tokenizer, model, image_processor, context_len = load_pretrained_model(
    model_path=model_path,
    model_base=None,
    model_name=get_model_name_from_path(model_path)
)

# Load and process image
image = Image.open("photo.jpg")
image_tensor = process_images([image], image_processor, model.config)

# Generate description
prompt = "Describe this image in detail."
outputs = model.generate(
    image_tensor,
    prompt,
    max_new_tokens=512
)
</code></pre>
<h2 id="applications-11"><a class="header" href="#applications-11">Applications</a></h2>
<h3 id="1-content-creation-1"><a class="header" href="#1-content-creation-1">1. Content Creation</a></h3>
<pre><code class="language-python"># Automated blog writing pipeline
def generate_blog_post(topic):
    # Research
    outline_prompt = f"Create a detailed outline for a blog post about {topic}"
    outline = llm.generate(outline_prompt)
    
    # Write sections
    sections = []
    for section in outline.sections:
        content = llm.generate(f"Write about: {section}")
        sections.append(content)
    
    # Generate image
    image_prompt = f"blog header image for {topic}, professional, modern"
    image = image_generator.generate(image_prompt)
    
    return {
        'outline': outline,
        'content': sections,
        'image': image
    }
</code></pre>
<h3 id="2-education--training"><a class="header" href="#2-education--training">2. Education &amp; Training</a></h3>
<pre><code class="language-python"># Personalized tutoring
def create_lesson(topic, student_level, learning_style):
    prompt = f"""
    Create a {student_level}-level lesson on {topic} for a {learning_style} learner.
    
    Include:
    - Clear explanations with analogies
    - 3 practice problems
    - Visual aids descriptions
    """
    
    lesson = llm.generate(prompt)
    
    # Generate visual aids
    visuals = [
        image_gen.generate(desc) 
        for desc in lesson.visual_descriptions
    ]
    
    return lesson, visuals
</code></pre>
<h3 id="3-software-development"><a class="header" href="#3-software-development">3. Software Development</a></h3>
<pre><code class="language-python"># AI-assisted coding
def code_assistant(task_description, language="python"):
    # Generate code
    code_prompt = f"Write {language} code for: {task_description}"
    code = llm.generate(code_prompt)
    
    # Generate tests
    test_prompt = f"Write unit tests for this code:\n{code}"
    tests = llm.generate(test_prompt)
    
    # Generate documentation
    doc_prompt = f"Write comprehensive documentation for:\n{code}"
    docs = llm.generate(doc_prompt)
    
    return {
        'code': code,
        'tests': tests,
        'docs': docs
    }
</code></pre>
<h3 id="4-marketing--advertising"><a class="header" href="#4-marketing--advertising">4. Marketing &amp; Advertising</a></h3>
<pre><code class="language-python"># Campaign generation
def create_marketing_campaign(product, target_audience):
    # Generate copy variations
    copy_prompt = f"""
    Create 5 ad copy variations for {product} targeting {target_audience}.
    Each should be:
    - Under 100 characters
    - Compelling call-to-action
    - Different emotional angle
    """
    copies = llm.generate(copy_prompt)
    
    # Generate visuals
    for copy in copies:
        visual_prompt = f"advertising image for: {copy}, {product}, professional photography"
        image = image_gen.generate(visual_prompt)
        
    return campaign
</code></pre>
<h3 id="5-data-augmentation"><a class="header" href="#5-data-augmentation">5. Data Augmentation</a></h3>
<pre><code class="language-python"># Expand training dataset
def augment_dataset(original_data):
    augmented = []
    
    for item in original_data:
        # Text augmentation
        variations = llm.generate(
            f"Create 5 paraphrases of: {item.text}"
        )
        augmented.extend(variations)
        
        # Image augmentation (if applicable)
        if item.image:
            synthetic_images = image_gen.generate(
                f"similar to: {item.image_description}"
            )
            augmented.extend(synthetic_images)
    
    return augmented
</code></pre>
<h3 id="6-accessibility"><a class="header" href="#6-accessibility">6. Accessibility</a></h3>
<pre><code class="language-python"># Multi-modal accessibility
def make_accessible(content):
    if content.is_text():
        # Text to speech
        audio = tts.generate(content.text)
        
        # Generate descriptive images
        image = image_gen.generate(f"illustration of: {content.text}")
        
    elif content.is_image():
        # Image to text description
        description = vision_model.describe(content.image)
        
        # Text to speech
        audio = tts.generate(description)
    
    return {
        'text': description,
        'audio': audio,
        'image': image
    }
</code></pre>
<h2 id="best-practices-36"><a class="header" href="#best-practices-36">Best Practices</a></h2>
<h3 id="1-prompt-engineering-2"><a class="header" href="#1-prompt-engineering-2">1. Prompt Engineering</a></h3>
<pre><code class="language-python"># Good prompt structure
prompt = """
Role: You are an expert {domain} specialist

Task: {specific_task}

Context: {relevant_background}

Requirements:
- {requirement_1}
- {requirement_2}
- {requirement_3}

Format: {output_format}
"""
</code></pre>
<h3 id="2-temperature--sampling"><a class="header" href="#2-temperature--sampling">2. Temperature &amp; Sampling</a></h3>
<pre><code class="language-python"># Creative tasks: High temperature
creative_config = {
    "temperature": 0.8,
    "top_p": 0.9,
    "top_k": 50
}

# Factual tasks: Low temperature
factual_config = {
    "temperature": 0.2,
    "top_p": 0.95,
    "top_k": 40
}
</code></pre>
<h3 id="3-error-handling"><a class="header" href="#3-error-handling">3. Error Handling</a></h3>
<pre><code class="language-python">def generate_with_retry(prompt, max_retries=3):
    for attempt in range(max_retries):
        try:
            response = llm.generate(prompt)
            
            # Validate response
            if validate(response):
                return response
                
        except Exception as e:
            if attempt == max_retries - 1:
                raise
            continue
    
    return fallback_response
</code></pre>
<h3 id="4-cost-optimization"><a class="header" href="#4-cost-optimization">4. Cost Optimization</a></h3>
<pre><code class="language-python"># Cache responses
from functools import lru_cache

@lru_cache(maxsize=1000)
def generate_cached(prompt):
    return llm.generate(prompt)

# Batch requests
def generate_batch(prompts):
    return llm.batch_generate(prompts)

# Use appropriate model
def select_model(task_complexity):
    if task_complexity == "simple":
        return "gpt-3.5-turbo"  # Cheaper
    else:
        return "gpt-4"  # More capable
</code></pre>
<h2 id="ethical-considerations"><a class="header" href="#ethical-considerations">Ethical Considerations</a></h2>
<h3 id="1-content-authenticity"><a class="header" href="#1-content-authenticity">1. Content Authenticity</a></h3>
<pre><code class="language-python"># Add watermarks to generated content
def generate_with_watermark(prompt):
    content = llm.generate(prompt)
    metadata = {
        'generated_by': 'AI',
        'model': 'gpt-4',
        'timestamp': datetime.now(),
        'watermark': True
    }
    return content, metadata
</code></pre>
<h3 id="2-bias-detection"><a class="header" href="#2-bias-detection">2. Bias Detection</a></h3>
<pre><code class="language-python"># Check for biased outputs
def check_bias(generated_content):
    bias_check_prompt = f"""
    Analyze this content for potential bias:
    {generated_content}
    
    Check for:
    - Gender bias
    - Racial bias
    - Cultural bias
    - Age bias
    """
    
    analysis = llm.generate(bias_check_prompt)
    return analysis
</code></pre>
<h3 id="3-safety-filters"><a class="header" href="#3-safety-filters">3. Safety Filters</a></h3>
<pre><code class="language-python"># Content filtering
def safe_generate(prompt):
    # Check input
    if contains_unsafe_content(prompt):
        return "Request rejected: unsafe content"
    
    # Generate
    output = llm.generate(prompt)
    
    # Check output
    if contains_unsafe_content(output):
        return "Generation failed: unsafe output"
    
    return output
</code></pre>
<h2 id="future-trends"><a class="header" href="#future-trends">Future Trends</a></h2>
<h3 id="1-multimodal-foundation-models"><a class="header" href="#1-multimodal-foundation-models">1. Multimodal Foundation Models</a></h3>
<ul>
<li>Unified models handling text, image, audio, video</li>
<li>Seamless cross-modal generation</li>
</ul>
<h3 id="2-personalization"><a class="header" href="#2-personalization">2. Personalization</a></h3>
<ul>
<li>Models adapting to individual user preferences</li>
<li>Context-aware generation</li>
</ul>
<h3 id="3-efficiency"><a class="header" href="#3-efficiency">3. Efficiency</a></h3>
<ul>
<li>Smaller, faster models with comparable quality</li>
<li>Edge deployment of generative models</li>
</ul>
<h3 id="4-controllability"><a class="header" href="#4-controllability">4. Controllability</a></h3>
<ul>
<li>Fine-grained control over generation</li>
<li>Steering models toward specific outputs</li>
</ul>
<h3 id="5-collaboration"><a class="header" href="#5-collaboration">5. Collaboration</a></h3>
<ul>
<li>Human-AI co-creation workflows</li>
<li>Interactive refinement systems</li>
</ul>
<h2 id="resources-22"><a class="header" href="#resources-22">Resources</a></h2>
<h3 id="learning"><a class="header" href="#learning">Learning</a></h3>
<ul>
<li><a href="https://huggingface.co/docs/diffusers">Hugging Face Diffusers Course</a></li>
<li><a href="https://www.deeplearning.ai/">DeepLearning.AI Generative AI Courses</a></li>
<li><a href="https://platform.stability.ai/docs">Stability AI Documentation</a></li>
</ul>
<h3 id="tools-1"><a class="header" href="#tools-1">Tools</a></h3>
<ul>
<li><a href="https://huggingface.co/spaces">Hugging Face Spaces</a></li>
<li><a href="https://replicate.com/">Replicate</a></li>
<li><a href="https://gradio.app/">Gradio</a></li>
</ul>
<h3 id="communities"><a class="header" href="#communities">Communities</a></h3>
<ul>
<li>r/StableDiffusion</li>
<li>r/LocalLLaMA</li>
<li>Discord: Stable Diffusion, Midjourney</li>
<li>Twitter/X: AI researchers and practitioners</li>
</ul>
<h2 id="conclusion-15"><a class="header" href="#conclusion-15">Conclusion</a></h2>
<p>Generative AI is rapidly evolving, with new models and capabilities emerging constantly. Success comes from understanding the fundamentals, choosing appropriate tools, and applying ethical practices. Experiment, iterate, and stay updated with the latest developments.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="large-language-models-llms-2"><a class="header" href="#large-language-models-llms-2">Large Language Models (LLMs)</a></h1>
<h2 id="overview-49"><a class="header" href="#overview-49">Overview</a></h2>
<p>Large Language Models are transformer-based neural networks trained on massive text corpora to predict and generate human language. They've revolutionized AI with capabilities in translation, summarization, question-answering, and reasoning.</p>
<h2 id="architecture-basics"><a class="header" href="#architecture-basics">Architecture Basics</a></h2>
<h3 id="transformers-2"><a class="header" href="#transformers-2">Transformers</a></h3>
<p>Built on <strong>self-attention</strong> mechanism:</p>
<ul>
<li><strong>Query-Key-Value</strong>: "What am I looking for?" -&gt; "Where's the relevant info?" -&gt; "Get the info"</li>
<li><strong>Multi-head Attention</strong>: Multiple attention patterns in parallel</li>
<li><strong>Feed-forward Networks</strong>: Non-linear transformations</li>
<li><strong>Layer Normalization</strong>: Stabilizes training</li>
</ul>
<h3 id="scaling-laws"><a class="header" href="#scaling-laws">Scaling Laws</a></h3>
<p>Performance improves predictably with:</p>
<ul>
<li><strong>Model size</strong> (parameters): 7B -&gt; 70B -&gt; 700B</li>
<li><strong>Dataset size</strong>: More tokens = better performance</li>
<li><strong>Compute</strong>: More training = better convergence</li>
</ul>
<h2 id="popular-models"><a class="header" href="#popular-models">Popular Models</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Model</th><th>Size</th><th>Training Data</th><th>Strengths</th></tr></thead><tbody>
<tr><td>GPT-4</td><td>~1.7T params</td><td>~13T tokens</td><td>Reasoning, coding, creative</td></tr>
<tr><td>Claude</td><td>~100B params</td><td>High quality data</td><td>Instruction following, safety</td></tr>
<tr><td>Llama 2</td><td>7B-70B</td><td>2T tokens</td><td>Open-source, efficient</td></tr>
<tr><td>Mistral</td><td>7B-8x7B</td><td>7T tokens</td><td>Fast, efficient</td></tr>
<tr><td>Palm 2</td><td>~340B</td><td>High quality</td><td>Reasoning, math</td></tr>
</tbody></table>
</div>
<h2 id="training-process-1"><a class="header" href="#training-process-1">Training Process</a></h2>
<h3 id="1-pre-training"><a class="header" href="#1-pre-training">1. Pre-training</a></h3>
<pre><code>Objective: Predict next token
Input: "The cat sat on the"
Target: "mat"

Loss = -log P(mat | previous tokens)
</code></pre>
<p>Train on unlabeled internet text (unsupervised)</p>
<h3 id="2-supervised-fine-tuning"><a class="header" href="#2-supervised-fine-tuning">2. Supervised Fine-tuning</a></h3>
<pre><code>Input: "What is 2+2?"
Target: "2+2=4"
</code></pre>
<p>Train on labeled examples (supervised)</p>
<h3 id="3-rlhf-reinforcement-learning-from-human-feedback"><a class="header" href="#3-rlhf-reinforcement-learning-from-human-feedback">3. RLHF (Reinforcement Learning from Human Feedback)</a></h3>
<pre><code>1. Generate multiple responses
2. Humans rank by quality
3. Train reward model
4. Use reward to optimize policy
</code></pre>
<h2 id="key-concepts-19"><a class="header" href="#key-concepts-19">Key Concepts</a></h2>
<h3 id="tokenization"><a class="header" href="#tokenization">Tokenization</a></h3>
<p>Convert text to numbers:</p>
<pre><code>"Hello world" -&gt; [15339, 1159]
</code></pre>
<h3 id="embeddings"><a class="header" href="#embeddings">Embeddings</a></h3>
<p>Represent tokens as vectors in semantic space:</p>
<pre><code>king - man + woman ~= queen
</code></pre>
<h3 id="context-window"><a class="header" href="#context-window">Context Window</a></h3>
<p>Maximum tokens model can consider:</p>
<ul>
<li>GPT-3: 2K tokens</li>
<li>GPT-4: 32K - 128K tokens</li>
<li>Claude: 100K+ tokens</li>
<li>Llama 2: 4K tokens</li>
</ul>
<h3 id="temperature"><a class="header" href="#temperature">Temperature</a></h3>
<p>Controls randomness of output:</p>
<ul>
<li><strong>0</strong>: Deterministic (always same answer)</li>
<li><strong>0.7</strong>: Balanced (varied but coherent)</li>
<li><strong>1+</strong>: Creative (more random)</li>
</ul>
<h2 id="prompting-techniques"><a class="header" href="#prompting-techniques">Prompting Techniques</a></h2>
<h3 id="1-zero-shot"><a class="header" href="#1-zero-shot">1. Zero-Shot</a></h3>
<pre><code>Question: What is 2+2?
Answer: 4
</code></pre>
<h3 id="2-few-shot"><a class="header" href="#2-few-shot">2. Few-Shot</a></h3>
<pre><code>Question: What is 3+3?
Answer: 6

Question: What is 2+2?
Answer:
</code></pre>
<h3 id="3-chain-of-thought"><a class="header" href="#3-chain-of-thought">3. Chain-of-Thought</a></h3>
<pre><code>Q: If there are 3 apples and you add 2 more, how many are there?

A: Let me think step by step:
1. Start with 3 apples
2. Add 2 more
3. Total: 3 + 2 = 5
</code></pre>
<h3 id="4-role-based"><a class="header" href="#4-role-based">4. Role-Based</a></h3>
<pre><code>You are a helpful Python expert.
Q: How do I reverse a list?
A: [explanations as Python expert]
</code></pre>
<h2 id="limitations"><a class="header" href="#limitations">Limitations</a></h2>
<h3 id="hallucinations"><a class="header" href="#hallucinations">Hallucinations</a></h3>
<p>Making up false information confidently:</p>
<pre><code>Q: What's the capital of Atlantis?
A: The capital is Poseidiopolis. (Made up!)
</code></pre>
<h3 id="knowledge-cutoff"><a class="header" href="#knowledge-cutoff">Knowledge Cutoff</a></h3>
<p>No information beyond training data:</p>
<pre><code>Q: Who won the 2025 World Cup?
A: I don't have info beyond April 2024.
</code></pre>
<h3 id="context-length"><a class="header" href="#context-length">Context Length</a></h3>
<p>Can't process extremely long documents</p>
<h3 id="reasoning"><a class="header" href="#reasoning">Reasoning</a></h3>
<p>Struggles with:</p>
<ul>
<li>Multi-step complex logic</li>
<li>Mathematics (prone to errors)</li>
<li>Counting tokens accurately</li>
</ul>
<h2 id="fine-tuning-approaches"><a class="header" href="#fine-tuning-approaches">Fine-tuning Approaches</a></h2>
<h3 id="full-fine-tuning"><a class="header" href="#full-fine-tuning">Full Fine-tuning</a></h3>
<p>Update all parameters (expensive):</p>
<pre><code>Memory: O(parameters)
Time: O(tokens)
</code></pre>
<h3 id="lora-low-rank-adaptation-1"><a class="header" href="#lora-low-rank-adaptation-1">LoRA (Low-Rank Adaptation)</a></h3>
<p>Add small trainable matrices (efficient):</p>
<pre><code class="language-python"># Instead of: W' = W + delta_W
# Use: W' = W + A*B (where A, B &lt;&lt; W)
</code></pre>
<h3 id="qlora"><a class="header" href="#qlora">QLoRA</a></h3>
<p>Quantized LoRA (even more efficient):</p>
<ul>
<li>4-bit quantization</li>
<li>Reduces memory to ~6GB for 7B model</li>
</ul>
<h2 id="applications-12"><a class="header" href="#applications-12">Applications</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Use Case</th><th>Technique</th><th>Example</th></tr></thead><tbody>
<tr><td><strong>Chat</strong></td><td>Conversation history</td><td>ChatGPT</td></tr>
<tr><td><strong>Code</strong></td><td>In-context learning</td><td>GitHub Copilot</td></tr>
<tr><td><strong>Search</strong></td><td>Semantic ranking</td><td>Perplexity AI</td></tr>
<tr><td><strong>Translation</strong></td><td>Multilingual models</td><td>Google Translate</td></tr>
<tr><td><strong>Summarization</strong></td><td>Extractive/abstractive</td><td>Claude summarization</td></tr>
</tbody></table>
</div>
<h2 id="costs--efficiency"><a class="header" href="#costs--efficiency">Costs &amp; Efficiency</a></h2>
<h3 id="api-usage"><a class="header" href="#api-usage">API Usage</a></h3>
<pre><code>Pricing: $ per 1M tokens
GPT-4: $30 input, $60 output
Claude: $8 input, $24 output
</code></pre>
<h3 id="running-locally"><a class="header" href="#running-locally">Running Locally</a></h3>
<pre><code>Model Size | VRAM Needed | Speed
7B params  | 16GB        | Fast
13B params | 24GB        | Medium
70B params | 80GB (GPU)  | Slow
</code></pre>
<h2 id="evaluation-metrics-2"><a class="header" href="#evaluation-metrics-2">Evaluation Metrics</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Metric</th><th>What It Measures</th></tr></thead><tbody>
<tr><td><strong>Perplexity</strong></td><td>How well model predicts text</td></tr>
<tr><td><strong>BLEU</strong></td><td>Translation quality</td></tr>
<tr><td><strong>ROUGE</strong></td><td>Summarization quality</td></tr>
<tr><td><strong>Human Eval</strong></td><td>Actual user satisfaction</td></tr>
</tbody></table>
</div>
<h2 id="best-practices-37"><a class="header" href="#best-practices-37">Best Practices</a></h2>
<h3 id="1-prompt-engineering-3"><a class="header" href="#1-prompt-engineering-3">1. Prompt Engineering</a></h3>
<pre><code>X Bad: "Write code"
Checkmark Good: "Write Python function that takes list and returns sorted list in ascending order"
</code></pre>
<h3 id="2-breaking-complex-tasks"><a class="header" href="#2-breaking-complex-tasks">2. Breaking Complex Tasks</a></h3>
<pre><code>Instead of: "Analyze this company and give investment advice"
Try:
1. "Summarize this company's financials"
2. "What are the main risks?"
3. "What are growth opportunities?"
4. "Should we invest?"
</code></pre>
<h3 id="3-verification"><a class="header" href="#3-verification">3. Verification</a></h3>
<p>Always verify facts from authoritative sources</p>
<h2 id="eli10-15"><a class="header" href="#eli10-15">ELI10</a></h2>
<p>Imagine teaching a child language by:</p>
<ol>
<li>Reading millions of books</li>
<li>Learning to predict next word</li>
<li>Getting feedback on quality</li>
<li>Adjusting understanding</li>
</ol>
<p>That's basically how LLMs learn! They become really good at continuing conversations in natural human language.</p>
<p>The trick: They learn statistics of language, not true understanding. So they might confidently say wrong things (hallucinations).</p>
<h2 id="future-directions"><a class="header" href="#future-directions">Future Directions</a></h2>
<ul>
<li><strong>Multimodal</strong>: Understanding images + text + audio</li>
<li><strong>Long Context</strong>: Processing entire books</li>
<li><strong>Reasoning</strong>: Better at logic puzzles</li>
<li><strong>Efficiency</strong>: Running on phones/devices</li>
<li><strong>Robotics</strong>: Language guiding physical actions</li>
</ul>
<h2 id="further-resources-15"><a class="header" href="#further-resources-15">Further Resources</a></h2>
<ul>
<li><a href="https://arxiv.org/abs/1706.03762">Transformer Paper</a></li>
<li><a href="https://openai.com/research/">OpenAI GPT Blog</a></li>
<li><a href="https://huggingface.co/">Hugging Face</a></li>
<li><a href="https://www.promptingguide.ai/">Prompt Engineering Guide</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="prompt-engineering"><a class="header" href="#prompt-engineering">Prompt Engineering</a></h1>
<p>A comprehensive guide to crafting effective prompts for Large Language Models (LLMs).</p>
<h2 id="table-of-contents-26"><a class="header" href="#table-of-contents-26">Table of Contents</a></h2>
<ul>
<li><a href="ai/prompt_engineering.html#introduction">Introduction</a></li>
<li><a href="ai/prompt_engineering.html#core-principles">Core Principles</a></li>
<li><a href="ai/prompt_engineering.html#fundamental-techniques">Fundamental Techniques</a></li>
<li><a href="ai/prompt_engineering.html#advanced-techniques">Advanced Techniques</a></li>
<li><a href="ai/prompt_engineering.html#prompt-patterns">Prompt Patterns</a></li>
<li><a href="ai/prompt_engineering.html#best-practices">Best Practices</a></li>
<li><a href="ai/prompt_engineering.html#common-pitfalls">Common Pitfalls</a></li>
<li><a href="ai/prompt_engineering.html#examples-by-task">Examples by Task</a></li>
</ul>
<h2 id="introduction-8"><a class="header" href="#introduction-8">Introduction</a></h2>
<p>Prompt engineering is the practice of designing inputs to get desired outputs from LLMs. It's both an art and a science, requiring understanding of:</p>
<ul>
<li>How models process and interpret text</li>
<li>What patterns yield consistent results</li>
<li>How to balance specificity with flexibility</li>
</ul>
<h2 id="core-principles"><a class="header" href="#core-principles">Core Principles</a></h2>
<h3 id="1-clarity-and-specificity"><a class="header" href="#1-clarity-and-specificity">1. Clarity and Specificity</a></h3>
<p>Be explicit about what you want:</p>
<pre><code>❌ Bad: "Write about dogs"
✅ Good: "Write a 300-word informative article about the benefits of adopting rescue dogs, including health, cost, and emotional aspects."
</code></pre>
<h3 id="2-context-provision"><a class="header" href="#2-context-provision">2. Context Provision</a></h3>
<p>Give the model necessary background:</p>
<pre><code>❌ Bad: "What should I do?"
✅ Good: "I'm a Python developer with 3 years of experience. I want to transition into machine learning. What skills should I prioritize learning first?"
</code></pre>
<h3 id="3-format-specification"><a class="header" href="#3-format-specification">3. Format Specification</a></h3>
<p>Define the desired output structure:</p>
<pre><code>❌ Bad: "Tell me about the solar system"
✅ Good: "List the planets in our solar system in a markdown table with columns: Name, Distance from Sun (AU), and One Interesting Fact."
</code></pre>
<h3 id="4-role-assignment"><a class="header" href="#4-role-assignment">4. Role Assignment</a></h3>
<p>Set the model's perspective:</p>
<pre><code>"You are an experienced DevOps engineer. Explain Kubernetes deployments to a junior developer who has only worked with traditional hosting."
</code></pre>
<h2 id="fundamental-techniques"><a class="header" href="#fundamental-techniques">Fundamental Techniques</a></h2>
<h3 id="zero-shot-prompting"><a class="header" href="#zero-shot-prompting">Zero-Shot Prompting</a></h3>
<p>Direct instruction without examples:</p>
<pre><code>Prompt: "Classify the sentiment of this review: 'The product arrived damaged but customer service was helpful.' Choose: positive, negative, or mixed."

Output: "mixed"
</code></pre>
<h3 id="few-shot-prompting"><a class="header" href="#few-shot-prompting">Few-Shot Prompting</a></h3>
<p>Provide examples to guide the model:</p>
<pre><code>Classify movie reviews as positive or negative:

Review: "A masterpiece of cinema!"
Sentiment: positive

Review: "Boring and predictable plot."
Sentiment: negative

Review: "Waste of time and money."
Sentiment: negative

Review: "Incredible performances by the cast."
Sentiment: positive

Review: "The special effects were amazing but the story was weak."
Sentiment: 
</code></pre>
<h3 id="chain-of-thought-cot"><a class="header" href="#chain-of-thought-cot">Chain-of-Thought (CoT)</a></h3>
<p>Encourage step-by-step reasoning:</p>
<pre><code>Prompt: "A cafeteria has 23 apples. If they used 20 to make lunch and bought 6 more, how many apples do they have? Let's think step by step."

Output:
"Let's solve this step by step:
1. Starting apples: 23
2. Used for lunch: 23 - 20 = 3 apples remaining
3. Bought more: 3 + 6 = 9 apples
Answer: The cafeteria has 9 apples."
</code></pre>
<h3 id="zero-shot-chain-of-thought"><a class="header" href="#zero-shot-chain-of-thought">Zero-Shot Chain-of-Thought</a></h3>
<p>Add "Let's think step by step" to enable reasoning:</p>
<pre><code>Prompt: "If a train travels 120 miles in 2 hours, then speeds up and travels 180 miles in the next 2 hours, what's the average speed for the entire journey? Let's think step by step."
</code></pre>
<h3 id="self-consistency"><a class="header" href="#self-consistency">Self-Consistency</a></h3>
<p>Generate multiple reasoning paths and choose the most consistent:</p>
<pre><code class="language-python"># Ask the same question with slight variations
prompts = [
    "Calculate 15% tip on $47.50. Show your work.",
    "What's a 15% tip on a $47.50 bill? Explain your calculation.",
    "If my bill is $47.50 and I want to leave 15%, how much is the tip?"
]

# The most common answer is likely correct
</code></pre>
<h2 id="advanced-techniques-1"><a class="header" href="#advanced-techniques-1">Advanced Techniques</a></h2>
<h3 id="tree-of-thoughts-tot"><a class="header" href="#tree-of-thoughts-tot">Tree of Thoughts (ToT)</a></h3>
<p>Explore multiple reasoning branches:</p>
<pre><code>Problem: Design a marketing campaign for a new eco-friendly water bottle.

Let's explore three different approaches:

Approach 1: Sustainability Focus
- Highlight environmental impact
- Partner with conservation organizations
- Target eco-conscious millennials
[Evaluate pros/cons]

Approach 2: Innovation Focus
- Emphasize unique design features
- Tech-forward marketing
- Target early adopters
[Evaluate pros/cons]

Approach 3: Health &amp; Wellness Focus
- Connect to healthy lifestyle
- Partner with fitness influencers
- Target health-conscious consumers
[Evaluate pros/cons]

Now, let's combine the best elements...
</code></pre>
<h3 id="react-reasoning--acting"><a class="header" href="#react-reasoning--acting">ReAct (Reasoning + Acting)</a></h3>
<p>Interleave reasoning with actions:</p>
<pre><code>Task: Find information about the latest Python version

Thought: I need to find current Python version information
Action: Search for "latest Python version 2025"
Observation: Python 3.13 was released in October 2024
Thought: I should verify this is the most recent stable version
Action: Check Python.org official releases
Observation: Confirmed, Python 3.13 is the latest stable version
Answer: The latest Python version is 3.13, released in October 2024
</code></pre>
<h3 id="prompt-chaining"><a class="header" href="#prompt-chaining">Prompt Chaining</a></h3>
<p>Break complex tasks into steps:</p>
<pre><code class="language-python"># Step 1: Research
prompt1 = "List 5 key features of electric vehicles vs gasoline cars"

# Step 2: Analyze (using output from step 1)
prompt2 = f"Given these EV features: {output1}, which three are most important for urban commuters?"

# Step 3: Synthesize
prompt3 = f"Based on these priority features: {output2}, write a 100-word recommendation"
</code></pre>
<h3 id="automatic-prompt-engineering-ape"><a class="header" href="#automatic-prompt-engineering-ape">Automatic Prompt Engineering (APE)</a></h3>
<p>Let the model optimize its own prompts:</p>
<pre><code>Meta-prompt: "I want to classify customer support tickets into categories: billing, technical, general inquiry. Generate 5 different prompts that would work well for this classification task."
</code></pre>
<h2 id="prompt-patterns"><a class="header" href="#prompt-patterns">Prompt Patterns</a></h2>
<h3 id="the-persona-pattern"><a class="header" href="#the-persona-pattern">The Persona Pattern</a></h3>
<pre><code>"Act as [role] with [characteristics]. Your task is to [objective]."

Example:
"Act as a senior software architect with 15 years of experience in microservices. Review this code design and suggest improvements for scalability."
</code></pre>
<h3 id="the-template-pattern"><a class="header" href="#the-template-pattern">The Template Pattern</a></h3>
<pre><code>"[Action] about [topic] in [format] with [constraints]."

Example:
"Write about artificial intelligence in a blog post format with a friendly tone, 500 words max, aimed at non-technical readers."
</code></pre>
<h3 id="the-constraint-pattern"><a class="header" href="#the-constraint-pattern">The Constraint Pattern</a></h3>
<pre><code>"[Task]. You must [requirement 1]. You must [requirement 2]. You cannot [restriction]."

Example:
"Write a product description. You must include benefits, not just features. You must use active voice. You cannot use technical jargon."
</code></pre>
<h3 id="the-refinement-pattern"><a class="header" href="#the-refinement-pattern">The Refinement Pattern</a></h3>
<pre><code>Initial prompt → Generate → Critique → Revise

Example:
"Write a haiku about coding."
[output]
"Now critique this haiku for syllable count and imagery."
[critique]
"Revise the haiku based on the critique."
</code></pre>
<h3 id="the-comparative-pattern"><a class="header" href="#the-comparative-pattern">The Comparative Pattern</a></h3>
<pre><code>"Compare [A] and [B] in terms of [criteria 1], [criteria 2], and [criteria 3]. Present as [format]."

Example:
"Compare REST API and GraphQL in terms of performance, flexibility, and ease of use. Present as a comparison table."
</code></pre>
<h3 id="the-instruction-context-format-icf-pattern"><a class="header" href="#the-instruction-context-format-icf-pattern">The Instruction-Context-Format (ICF) Pattern</a></h3>
<pre><code># Instruction
[What to do]

# Context
[Background information]

# Format
[How to structure the output]

Example:
# Instruction
Explain how photosynthesis works

# Context
The audience is 5th-grade students learning about plant biology for the first time

# Format
Use an analogy with a familiar concept, then provide 3-5 simple bullet points
</code></pre>
<h2 id="best-practices-38"><a class="header" href="#best-practices-38">Best Practices</a></h2>
<h3 id="1-use-delimiters"><a class="header" href="#1-use-delimiters">1. Use Delimiters</a></h3>
<p>Clearly separate different parts of your prompt:</p>
<pre><code>Summarize the text delimited by triple quotes.

Text: """
[long text here]
"""

Requirements:
- 3 sentences maximum
- Highlight main argument
- Use neutral tone
</code></pre>
<h3 id="2-specify-output-format"><a class="header" href="#2-specify-output-format">2. Specify Output Format</a></h3>
<pre><code>"Provide your answer as a JSON object with the following structure:
{
  "summary": "brief overview",
  "key_points": ["point1", "point2", "point3"],
  "recommendation": "actionable advice"
}"
</code></pre>
<h3 id="3-request-step-by-step-thinking"><a class="header" href="#3-request-step-by-step-thinking">3. Request Step-by-Step Thinking</a></h3>
<pre><code>"Before answering, explain your reasoning process. Then provide the final answer clearly labeled."
</code></pre>
<h3 id="4-use-examples-strategically"><a class="header" href="#4-use-examples-strategically">4. Use Examples Strategically</a></h3>
<pre><code># For few-shot learning, provide diverse examples:
Input: "The cat sat on the mat" → Simple sentence
Input: "Although tired, she completed the marathon" → Complex sentence
Input: "Run!" → Imperative sentence
Input: "Is it raining?" → Interrogative sentence
Input: "What a beautiful day!" → 
</code></pre>
<h3 id="5-iterate-and-refine"><a class="header" href="#5-iterate-and-refine">5. Iterate and Refine</a></h3>
<pre><code class="language-python"># Version 1: Too vague
"Write code for a web scraper"

# Version 2: More specific
"Write Python code for a web scraper using BeautifulSoup"

# Version 3: Complete specification
"Write Python code using BeautifulSoup to scrape product names and prices from an e-commerce site. Include error handling for missing elements and rate limiting to respect the server."
</code></pre>
<h3 id="6-control-length"><a class="header" href="#6-control-length">6. Control Length</a></h3>
<pre><code>"Explain quantum entanglement in [50/100/200] words"
"Provide a [brief/moderate/detailed] explanation"
"Summarize in [2-3 sentences/one paragraph/300 words]"
</code></pre>
<h3 id="7-set-the-temperature"><a class="header" href="#7-set-the-temperature">7. Set the Temperature</a></h3>
<p>Understand model parameters:</p>
<pre><code class="language-python"># Creative tasks (high temperature: 0.7-1.0)
{"temperature": 0.9}
# "Write a creative story about a time-traveling cat"

# Factual tasks (low temperature: 0.0-0.3)
{"temperature": 0.1}
# "What is the capital of France?"

# Balanced tasks (medium temperature: 0.4-0.6)
{"temperature": 0.5}
# "Explain the pros and cons of remote work"
</code></pre>
<h2 id="common-pitfalls-2"><a class="header" href="#common-pitfalls-2">Common Pitfalls</a></h2>
<h3 id="1-ambiguity"><a class="header" href="#1-ambiguity">1. Ambiguity</a></h3>
<pre><code>❌ "Tell me about Python"
✅ "Explain Python's list comprehension syntax with 3 examples"
</code></pre>
<h3 id="2-conflicting-instructions"><a class="header" href="#2-conflicting-instructions">2. Conflicting Instructions</a></h3>
<pre><code>❌ "Write a detailed brief summary"
✅ "Write a summary in 2-3 sentences covering the main points"
</code></pre>
<h3 id="3-assuming-knowledge"><a class="header" href="#3-assuming-knowledge">3. Assuming Knowledge</a></h3>
<pre><code>❌ "Debug this code" [without context]
✅ "This Python function should sort a list but returns an error. Debug it: [code]. The error message is: [error]"
</code></pre>
<h3 id="4-overcomplicating"><a class="header" href="#4-overcomplicating">4. Overcomplicating</a></h3>
<pre><code>❌ [500-word prompt with 20 constraints]
✅ [Clear, focused prompt with 3-5 key requirements]
</code></pre>
<h3 id="5-not-testing-variations"><a class="header" href="#5-not-testing-variations">5. Not Testing Variations</a></h3>
<p>Always try multiple phrasings:</p>
<ul>
<li>"List the benefits"</li>
<li>"What are the advantages"</li>
<li>"Explain why this is useful"</li>
</ul>
<h2 id="examples-by-task"><a class="header" href="#examples-by-task">Examples by Task</a></h2>
<h3 id="code-generation"><a class="header" href="#code-generation">Code Generation</a></h3>
<pre><code>Task: Create a Python function

Prompt:
"Write a Python function named 'calculate_statistics' that:
- Takes a list of numbers as input
- Returns a dictionary with: mean, median, mode, and standard deviation
- Handles edge cases (empty list, single value)
- Includes docstring with examples
- Uses only standard library modules"
</code></pre>
<h3 id="data-analysis"><a class="header" href="#data-analysis">Data Analysis</a></h3>
<pre><code>Task: Analyze sales data

Prompt:
"Given this sales data in CSV format:
[data]

Perform the following analysis:
1. Calculate total revenue by product category
2. Identify the top 3 performing products
3. Calculate month-over-month growth rate
4. Provide 3 actionable insights

Present findings in a structured format with clear headers."
</code></pre>
<h3 id="content-writing"><a class="header" href="#content-writing">Content Writing</a></h3>
<pre><code>Task: Write a blog post

Prompt:
"Write a 600-word blog post about 'The Future of Remote Work'

Structure:
- Engaging headline
- Hook in first paragraph
- 3 main sections with subheadings
- Include statistics or examples
- Conclude with actionable takeaway

Tone: Professional yet conversational
Audience: Mid-level professionals and managers
SEO keywords: remote work, hybrid model, workplace flexibility"
</code></pre>
<h3 id="summarization"><a class="header" href="#summarization">Summarization</a></h3>
<pre><code>Task: Summarize a technical document

Prompt:
"Summarize the following technical documentation:

[document]

Create two versions:
1. Executive Summary (100 words): High-level overview for non-technical stakeholders
2. Technical Summary (300 words): Key technical details for engineering team

Highlight any critical warnings or breaking changes."
</code></pre>
<h3 id="translation-with-context"><a class="header" href="#translation-with-context">Translation with Context</a></h3>
<pre><code>Task: Contextual translation

Prompt:
"Translate the following English text to Spanish:

'The system is down'

Context: This is an IT status message displayed to users during an outage.
Requirements:
- Use appropriate technical terminology
- Maintain professional tone
- Ensure clarity for non-technical users"
</code></pre>
<h3 id="code-review"><a class="header" href="#code-review">Code Review</a></h3>
<pre><code>Task: Review code quality

Prompt:
"Review this Python code for:

[code]

Evaluate:
1. Code quality and readability
2. Performance considerations
3. Potential bugs or edge cases
4. Security issues
5. Best practices adherence

Provide specific suggestions with code examples where applicable.
Rate each category from 1-5 and explain your ratings."
</code></pre>
<h3 id="question-answering"><a class="header" href="#question-answering">Question Answering</a></h3>
<pre><code>Task: Answer with citations

Prompt:
"Answer the following question using only information from the provided text. Quote relevant passages to support your answer.

Text: [document]

Question: [question]

Format:
- Direct answer (1-2 sentences)
- Supporting evidence (2-3 quoted passages)
- Confidence level (high/medium/low)"
</code></pre>
<h3 id="creative-writing"><a class="header" href="#creative-writing">Creative Writing</a></h3>
<pre><code>Task: Story generation

Prompt:
"Write a short story (500 words) with these elements:

Setting: Cyberpunk city in 2150
Protagonist: AI rights activist
Conflict: Choice between following the law or doing what's right
Theme: Question of consciousness and personhood
Tone: Noir detective style

Include:
- Vivid sensory details
- Internal monologue
- Unexpected twist ending"
</code></pre>
<h2 id="advanced-prompt-engineering"><a class="header" href="#advanced-prompt-engineering">Advanced Prompt Engineering</a></h2>
<h3 id="meta-prompting"><a class="header" href="#meta-prompting">Meta-Prompting</a></h3>
<pre><code>"I need to create prompts for classifying customer emails. First, analyze what makes a good classification prompt, then generate 3 examples of effective prompts for this task."
</code></pre>
<h3 id="prompt-optimization-loop"><a class="header" href="#prompt-optimization-loop">Prompt Optimization Loop</a></h3>
<pre><code class="language-python">initial_prompt = "Explain machine learning"

optimization_prompt = f"""
Original prompt: "{initial_prompt}"

This prompt is too vague. Improve it by:
1. Adding specific focus area
2. Defining target audience
3. Specifying depth of explanation
4. Setting output format

Provide an optimized version.
"""
</code></pre>
<h3 id="system-prompts-api-usage"><a class="header" href="#system-prompts-api-usage">System Prompts (API Usage)</a></h3>
<pre><code class="language-python"># For chat-based models
system_prompt = """You are a Python expert specializing in data science.
Your responses should:
- Include working code examples
- Explain complex concepts simply
- Suggest best practices
- Warn about common pitfalls
- Use type hints and documentation"""

user_prompt = "How do I handle missing data in pandas?"

# API call structure
response = client.chat.completions.create(
    model="gpt-4",
    messages=[
        {"role": "system", "content": system_prompt},
        {"role": "user", "content": user_prompt}
    ]
)
</code></pre>
<h3 id="constitutional-ai-prompting"><a class="header" href="#constitutional-ai-prompting">Constitutional AI Prompting</a></h3>
<p>Build in safety and ethical guidelines:</p>
<pre><code>"[Task description]

Guidelines:
- Provide factual, unbiased information
- Acknowledge uncertainty when appropriate
- Avoid harmful or discriminatory content
- Cite sources when making factual claims
- Respect privacy and confidentiality"
</code></pre>
<h2 id="prompt-engineering-tools"><a class="header" href="#prompt-engineering-tools">Prompt Engineering Tools</a></h2>
<h3 id="langchain-prompt-templates"><a class="header" href="#langchain-prompt-templates">LangChain Prompt Templates</a></h3>
<pre><code class="language-python">from langchain import PromptTemplate

template = """
You are a {role} with expertise in {domain}.

Task: {task}

Context: {context}

Provide your response in {format} format.
"""

prompt = PromptTemplate(
    input_variables=["role", "domain", "task", "context", "format"],
    template=template
)

final_prompt = prompt.format(
    role="data scientist",
    domain="machine learning",
    task="explain overfitting",
    context="teaching beginners",
    format="simple terms with examples"
)
</code></pre>
<h3 id="prompt-versioning"><a class="header" href="#prompt-versioning">Prompt Versioning</a></h3>
<pre><code class="language-python"># Track prompt iterations
prompts = {
    "v1.0": "Summarize this text",
    "v1.1": "Summarize this text in 100 words",
    "v1.2": "Summarize this text in 100 words, focusing on key insights",
    "v2.0": "Provide a 100-word summary highlighting: 1) main argument, 2) supporting evidence, 3) conclusions"
}
</code></pre>
<h2 id="measuring-prompt-quality"><a class="header" href="#measuring-prompt-quality">Measuring Prompt Quality</a></h2>
<h3 id="evaluation-criteria"><a class="header" href="#evaluation-criteria">Evaluation Criteria</a></h3>
<ol>
<li><strong>Consistency</strong>: Same prompt → similar outputs</li>
<li><strong>Accuracy</strong>: Outputs match expected results</li>
<li><strong>Efficiency</strong>: Minimal tokens for desired result</li>
<li><strong>Robustness</strong>: Works with variations in input</li>
<li><strong>Clarity</strong>: Unambiguous instructions</li>
</ol>
<h3 id="testing-framework"><a class="header" href="#testing-framework">Testing Framework</a></h3>
<pre><code class="language-python">def test_prompt(prompt, test_cases, model):
    results = []
    
    for test_input, expected_output in test_cases:
        full_prompt = prompt.format(input=test_input)
        actual_output = model.generate(full_prompt)
        
        results.append({
            'input': test_input,
            'expected': expected_output,
            'actual': actual_output,
            'match': evaluate_match(expected_output, actual_output)
        })
    
    return results
</code></pre>
<h2 id="resources-23"><a class="header" href="#resources-23">Resources</a></h2>
<h3 id="practice-platforms"><a class="header" href="#practice-platforms">Practice Platforms</a></h3>
<ul>
<li><a href="https://promptperfect.jina.ai/">PromptPerfect</a></li>
<li><a href="https://learnprompting.org/">Learn Prompting</a></li>
<li><a href="https://platform.openai.com/playground">OpenAI Playground</a></li>
<li><a href="https://console.anthropic.com/">Anthropic Console</a></li>
</ul>
<h3 id="reading"><a class="header" href="#reading">Reading</a></h3>
<ul>
<li><a href="https://platform.openai.com/docs/guides/prompt-engineering">OpenAI Prompt Engineering Guide</a></li>
<li><a href="https://docs.anthropic.com/claude/prompt-library">Anthropic Prompt Library</a></li>
<li><a href="https://www.promptingguide.ai/">Prompt Engineering Guide</a></li>
<li>Research papers on prompting techniques</li>
</ul>
<h3 id="communities-1"><a class="header" href="#communities-1">Communities</a></h3>
<ul>
<li>r/PromptEngineering</li>
<li>Discord servers for AI tools</li>
<li>Twitter/X AI communities</li>
</ul>
<h2 id="conclusion-16"><a class="header" href="#conclusion-16">Conclusion</a></h2>
<p>Prompt engineering is an iterative process. Start simple, test thoroughly, and refine based on results. The key is understanding both your task requirements and how the model interprets instructions.</p>
<p>Remember: The best prompt is the one that consistently produces the results you need with minimal tokens and maximum clarity.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="llama-models---meta-ai"><a class="header" href="#llama-models---meta-ai">Llama Models - Meta AI</a></h1>
<p>Complete guide to Meta's Llama family of open-source language models, from setup to fine-tuning and deployment.</p>
<h2 id="table-of-contents-27"><a class="header" href="#table-of-contents-27">Table of Contents</a></h2>
<ul>
<li><a href="ai/llama.html#introduction">Introduction</a></li>
<li><a href="ai/llama.html#model-versions">Model Versions</a></li>
<li><a href="ai/llama.html#installation--setup">Installation &amp; Setup</a></li>
<li><a href="ai/llama.html#basic-usage">Basic Usage</a></li>
<li><a href="ai/llama.html#fine-tuning">Fine-tuning</a></li>
<li><a href="ai/llama.html#quantization">Quantization</a></li>
<li><a href="ai/llama.html#inference-optimization">Inference Optimization</a></li>
<li><a href="ai/llama.html#deployment">Deployment</a></li>
<li><a href="ai/llama.html#advanced-techniques">Advanced Techniques</a></li>
</ul>
<h2 id="introduction-9"><a class="header" href="#introduction-9">Introduction</a></h2>
<p>Llama (Large Language Model Meta AI) is Meta's family of open-source foundation language models. Released as open-weights models, they've become the foundation for countless applications and fine-tuned variants.</p>
<h3 id="key-features-4"><a class="header" href="#key-features-4">Key Features</a></h3>
<ul>
<li><strong>Open Source</strong>: Freely available weights</li>
<li><strong>Strong Performance</strong>: Competitive with closed models</li>
<li><strong>Multiple Sizes</strong>: From 1B to 70B+ parameters</li>
<li><strong>Commercial Friendly</strong>: Permissive license</li>
<li><strong>Active Ecosystem</strong>: Huge community support</li>
<li><strong>Efficient</strong>: Optimized for deployment</li>
</ul>
<h3 id="architecture-4"><a class="header" href="#architecture-4">Architecture</a></h3>
<ul>
<li><strong>Transformer-based</strong>: Decoder-only architecture</li>
<li><strong>RMSNorm</strong>: Root Mean Square Layer Normalization</li>
<li><strong>SwiGLU</strong>: Activation function</li>
<li><strong>Rotary Embeddings</strong>: Position encoding</li>
<li><strong>Grouped-Query Attention</strong>: Efficient attention mechanism</li>
</ul>
<h2 id="model-versions"><a class="header" href="#model-versions">Model Versions</a></h2>
<h3 id="llama-32-latest"><a class="header" href="#llama-32-latest">Llama 3.2 (Latest)</a></h3>
<p><strong>Released</strong>: September 2024</p>
<h4 id="llama-32-1b3b-edge-models"><a class="header" href="#llama-32-1b3b-edge-models">Llama 3.2 1B/3B (Edge Models)</a></h4>
<pre><code class="language-python">from transformers import AutoTokenizer, AutoModelForCausalLM
import torch

model_name = "meta-llama/Llama-3.2-1B-Instruct"
tokenizer = AutoTokenizer.from_pretrained(model_name)
model = AutoModelForCausalLM.from_pretrained(
    model_name,
    torch_dtype=torch.float16,
    device_map="auto"
)

# Chat
messages = [
    {"role": "system", "content": "You are a helpful assistant."},
    {"role": "user", "content": "What is Python?"}
]

input_ids = tokenizer.apply_chat_template(
    messages,
    return_tensors="pt"
).to(model.device)

outputs = model.generate(
    input_ids,
    max_new_tokens=256,
    temperature=0.7
)

print(tokenizer.decode(outputs[0], skip_special_tokens=True))
</code></pre>
<p><strong>Features:</strong></p>
<ul>
<li>1B and 3B parameter versions</li>
<li>Optimized for mobile and edge devices</li>
<li>Multilingual support</li>
<li>128K context length</li>
<li>Excellent for on-device inference</li>
</ul>
<h4 id="llama-32-11b90b-vision-models"><a class="header" href="#llama-32-11b90b-vision-models">Llama 3.2 11B/90B (Vision Models)</a></h4>
<pre><code class="language-python">from transformers import MllamaForConditionalGeneration, AutoProcessor
from PIL import Image

model = MllamaForConditionalGeneration.from_pretrained(
    "meta-llama/Llama-3.2-11B-Vision-Instruct",
    torch_dtype=torch.bfloat16,
    device_map="auto"
)
processor = AutoProcessor.from_pretrained("meta-llama/Llama-3.2-11B-Vision-Instruct")

# Load image
image = Image.open("photo.jpg")

# Create prompt
messages = [
    {
        "role": "user",
        "content": [
            {"type": "image"},
            {"type": "text", "text": "What's in this image?"}
        ]
    }
]

# Process and generate
input_text = processor.apply_chat_template(messages, add_generation_prompt=True)
inputs = processor(image, input_text, return_tensors="pt").to(model.device)

output = model.generate(**inputs, max_new_tokens=256)
print(processor.decode(output[0], skip_special_tokens=True))
</code></pre>
<p><strong>Features:</strong></p>
<ul>
<li>Multimodal (text + vision)</li>
<li>11B and 90B variants</li>
<li>Image understanding</li>
<li>Visual question answering</li>
</ul>
<h3 id="llama-31"><a class="header" href="#llama-31">Llama 3.1</a></h3>
<p><strong>Released</strong>: July 2024</p>
<pre><code class="language-python"># 8B - Fast, efficient
model_name = "meta-llama/Llama-3.1-8B-Instruct"

# 70B - High capability
model_name = "meta-llama/Llama-3.1-70B-Instruct"

# 405B - Most capable (requires multiple GPUs)
model_name = "meta-llama/Llama-3.1-405B-Instruct"
</code></pre>
<p><strong>Features:</strong></p>
<ul>
<li>128K context window</li>
<li>Multilingual (8 languages)</li>
<li>Tool use capabilities</li>
<li>Improved reasoning</li>
<li>8B, 70B, and 405B sizes</li>
</ul>
<h3 id="llama-3"><a class="header" href="#llama-3">Llama 3</a></h3>
<p><strong>Released</strong>: April 2024</p>
<pre><code class="language-python"># 8B
model_name = "meta-llama/Meta-Llama-3-8B-Instruct"

# 70B
model_name = "meta-llama/Meta-Llama-3-70B-Instruct"
</code></pre>
<p><strong>Features:</strong></p>
<ul>
<li>8K context window</li>
<li>Strong performance</li>
<li>Better instruction following</li>
<li>8B and 70B sizes</li>
</ul>
<h3 id="llama-2"><a class="header" href="#llama-2">Llama 2</a></h3>
<p><strong>Released</strong>: July 2023</p>
<pre><code class="language-python"># 7B
model_name = "meta-llama/Llama-2-7b-chat-hf"

# 13B
model_name = "meta-llama/Llama-2-13b-chat-hf"

# 70B
model_name = "meta-llama/Llama-2-70b-chat-hf"
</code></pre>
<p><strong>Features:</strong></p>
<ul>
<li>4K context window</li>
<li>7B, 13B, and 70B sizes</li>
<li>Still widely used</li>
</ul>
<h3 id="model-comparison-1"><a class="header" href="#model-comparison-1">Model Comparison</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Model</th><th>Parameters</th><th>Context</th><th>VRAM (FP16)</th><th>Use Case</th></tr></thead><tbody>
<tr><td>Llama 3.2 1B</td><td>1B</td><td>128K</td><td>2GB</td><td>Edge/Mobile</td></tr>
<tr><td>Llama 3.2 3B</td><td>3B</td><td>128K</td><td>6GB</td><td>Edge/Desktop</td></tr>
<tr><td>Llama 3.1 8B</td><td>8B</td><td>128K</td><td>16GB</td><td>Standard</td></tr>
<tr><td>Llama 3.2 11B Vision</td><td>11B</td><td>128K</td><td>22GB</td><td>Multimodal</td></tr>
<tr><td>Llama 3.1 70B</td><td>70B</td><td>128K</td><td>140GB</td><td>High-end</td></tr>
<tr><td>Llama 3.2 90B Vision</td><td>90B</td><td>128K</td><td>180GB</td><td>Vision tasks</td></tr>
<tr><td>Llama 3.1 405B</td><td>405B</td><td>128K</td><td>810GB</td><td>Best quality</td></tr>
</tbody></table>
</div>
<h2 id="installation--setup"><a class="header" href="#installation--setup">Installation &amp; Setup</a></h2>
<h3 id="via-hugging-face-transformers"><a class="header" href="#via-hugging-face-transformers">Via Hugging Face Transformers</a></h3>
<pre><code class="language-bash"># Install dependencies
pip install transformers torch accelerate

# For quantization
pip install bitsandbytes

# For training
pip install peft datasets
</code></pre>
<h3 id="via-ollama-easy-local-setup"><a class="header" href="#via-ollama-easy-local-setup">Via Ollama (Easy Local Setup)</a></h3>
<pre><code class="language-bash"># Install Ollama
curl -fsSL https://ollama.com/install.sh | sh

# Pull model
ollama pull llama3.2

# Run
ollama run llama3.2
</code></pre>
<p>Python usage:</p>
<pre><code class="language-python">import requests

def query_ollama(prompt):
    response = requests.post('http://localhost:11434/api/generate', 
        json={
            "model": "llama3.2",
            "prompt": prompt,
            "stream": False
        }
    )
    return response.json()['response']

result = query_ollama("What is machine learning?")
print(result)
</code></pre>
<h3 id="via-llamacpp-efficient-c-implementation"><a class="header" href="#via-llamacpp-efficient-c-implementation">Via llama.cpp (Efficient C++ Implementation)</a></h3>
<pre><code class="language-bash"># Clone and build
git clone https://github.com/ggerganov/llama.cpp
cd llama.cpp
make

# Download model (GGUF format)
# From Hugging Face or converted locally

# Run inference
./main -m models/llama-3.2-1B-Instruct-Q4_K_M.gguf -p "Hello, how are you?"
</code></pre>
<p>Python bindings:</p>
<pre><code class="language-bash">pip install llama-cpp-python
</code></pre>
<pre><code class="language-python">from llama_cpp import Llama

llm = Llama(
    model_path="models/llama-3.2-3B-Instruct-Q4_K_M.gguf",
    n_ctx=2048,
    n_gpu_layers=35  # Adjust for GPU
)

output = llm(
    "Explain quantum computing",
    max_tokens=256,
    temperature=0.7,
    top_p=0.95,
)

print(output['choices'][0]['text'])
</code></pre>
<h3 id="via-vllm-production-inference"><a class="header" href="#via-vllm-production-inference">Via vLLM (Production Inference)</a></h3>
<pre><code class="language-bash">pip install vllm
</code></pre>
<pre><code class="language-python">from vllm import LLM, SamplingParams

# Load model
llm = LLM(
    model="meta-llama/Llama-3.2-3B-Instruct",
    tensor_parallel_size=1
)

# Sampling parameters
sampling_params = SamplingParams(
    temperature=0.7,
    top_p=0.95,
    max_tokens=256
)

# Generate
prompts = ["What is AI?", "Explain Python"]
outputs = llm.generate(prompts, sampling_params)

for output in outputs:
    print(output.outputs[0].text)
</code></pre>
<h2 id="basic-usage-2"><a class="header" href="#basic-usage-2">Basic Usage</a></h2>
<h3 id="simple-text-generation"><a class="header" href="#simple-text-generation">Simple Text Generation</a></h3>
<pre><code class="language-python">from transformers import AutoTokenizer, AutoModelForCausalLM
import torch

# Load model
model_name = "meta-llama/Llama-3.2-3B-Instruct"
tokenizer = AutoTokenizer.from_pretrained(model_name)
model = AutoModelForCausalLM.from_pretrained(
    model_name,
    torch_dtype=torch.float16,
    device_map="auto"
)

# Generate
prompt = "Write a Python function to calculate factorial:"
inputs = tokenizer(prompt, return_tensors="pt").to(model.device)

outputs = model.generate(
    **inputs,
    max_new_tokens=256,
    temperature=0.7,
    top_p=0.9,
    do_sample=True
)

result = tokenizer.decode(outputs[0], skip_special_tokens=True)
print(result)
</code></pre>
<h3 id="chat-format"><a class="header" href="#chat-format">Chat Format</a></h3>
<pre><code class="language-python"># Proper chat formatting
messages = [
    {"role": "system", "content": "You are a helpful AI assistant."},
    {"role": "user", "content": "What is the capital of France?"},
]

# Apply chat template
input_ids = tokenizer.apply_chat_template(
    messages,
    add_generation_prompt=True,
    return_tensors="pt"
).to(model.device)

# Generate
outputs = model.generate(
    input_ids,
    max_new_tokens=256,
    temperature=0.7,
    top_p=0.9,
    do_sample=True,
    pad_token_id=tokenizer.eos_token_id
)

response = tokenizer.decode(outputs[0][input_ids.shape[-1]:], skip_special_tokens=True)
print(response)
</code></pre>
<h3 id="multi-turn-conversation"><a class="header" href="#multi-turn-conversation">Multi-turn Conversation</a></h3>
<pre><code class="language-python">conversation = [
    {"role": "system", "content": "You are a helpful assistant."}
]

def chat(user_message):
    # Add user message
    conversation.append({"role": "user", "content": user_message})
    
    # Generate response
    input_ids = tokenizer.apply_chat_template(
        conversation,
        add_generation_prompt=True,
        return_tensors="pt"
    ).to(model.device)
    
    outputs = model.generate(
        input_ids,
        max_new_tokens=256,
        temperature=0.7,
        pad_token_id=tokenizer.eos_token_id
    )
    
    response = tokenizer.decode(
        outputs[0][input_ids.shape[-1]:],
        skip_special_tokens=True
    )
    
    # Add assistant response
    conversation.append({"role": "assistant", "content": response})
    
    return response

# Use
print(chat("What is Python?"))
print(chat("How do I install it?"))
print(chat("Give me a simple example."))
</code></pre>
<h3 id="streaming-generation"><a class="header" href="#streaming-generation">Streaming Generation</a></h3>
<pre><code class="language-python">from transformers import TextIteratorStreamer
from threading import Thread

streamer = TextIteratorStreamer(tokenizer, skip_special_tokens=True)

# Prepare input
messages = [{"role": "user", "content": "Write a short story about AI"}]
input_ids = tokenizer.apply_chat_template(messages, return_tensors="pt").to(model.device)

# Generate in thread
generation_kwargs = {
    "input_ids": input_ids,
    "max_new_tokens": 512,
    "temperature": 0.8,
    "streamer": streamer
}

thread = Thread(target=model.generate, kwargs=generation_kwargs)
thread.start()

# Stream output
for text in streamer:
    print(text, end="", flush=True)

thread.join()
</code></pre>
<h2 id="fine-tuning"><a class="header" href="#fine-tuning">Fine-tuning</a></h2>
<h3 id="qlora-fine-tuning-most-popular"><a class="header" href="#qlora-fine-tuning-most-popular">QLoRA Fine-tuning (Most Popular)</a></h3>
<p>Efficient fine-tuning with quantization:</p>
<pre><code class="language-bash">pip install transformers peft accelerate bitsandbytes datasets
</code></pre>
<pre><code class="language-python">from transformers import (
    AutoTokenizer,
    AutoModelForCausalLM,
    TrainingArguments,
    Trainer,
    BitsAndBytesConfig
)
from peft import LoraConfig, get_peft_model, prepare_model_for_kbit_training
from datasets import load_dataset
import torch

# Load model with quantization
model_name = "meta-llama/Llama-3.2-3B-Instruct"

bnb_config = BitsAndBytesConfig(
    load_in_4bit=True,
    bnb_4bit_quant_type="nf4",
    bnb_4bit_compute_dtype=torch.bfloat16,
    bnb_4bit_use_double_quant=True
)

model = AutoModelForCausalLM.from_pretrained(
    model_name,
    quantization_config=bnb_config,
    device_map="auto"
)

tokenizer = AutoTokenizer.from_pretrained(model_name)
tokenizer.pad_token = tokenizer.eos_token

# Prepare model
model = prepare_model_for_kbit_training(model)

# LoRA configuration
lora_config = LoraConfig(
    r=16,  # Rank
    lora_alpha=32,  # Scaling factor
    target_modules=["q_proj", "k_proj", "v_proj", "o_proj"],
    lora_dropout=0.05,
    bias="none",
    task_type="CAUSAL_LM"
)

model = get_peft_model(model, lora_config)
model.print_trainable_parameters()
# Output: trainable params: ~16M / total: 3B (~0.5%)

# Prepare dataset
dataset = load_dataset("your-dataset")

def format_instruction(example):
    text = f"### Instruction:\n{example['instruction']}\n\n### Response:\n{example['response']}"
    return {"text": text}

dataset = dataset.map(format_instruction)

# Tokenize
def tokenize(examples):
    return tokenizer(
        examples["text"],
        truncation=True,
        max_length=512,
        padding="max_length"
    )

tokenized_dataset = dataset.map(tokenize, batched=True)

# Training arguments
training_args = TrainingArguments(
    output_dir="./llama-finetuned",
    num_train_epochs=3,
    per_device_train_batch_size=4,
    gradient_accumulation_steps=4,
    learning_rate=2e-4,
    fp16=True,
    logging_steps=10,
    save_strategy="epoch",
    optim="paged_adamw_8bit"
)

# Train
trainer = Trainer(
    model=model,
    args=training_args,
    train_dataset=tokenized_dataset["train"],
    data_collator=lambda data: {
        'input_ids': torch.stack([f['input_ids'] for f in data]),
        'attention_mask': torch.stack([f['attention_mask'] for f in data]),
        'labels': torch.stack([f['input_ids'] for f in data])
    }
)

trainer.train()

# Save
model.save_pretrained("./llama-lora")
tokenizer.save_pretrained("./llama-lora")
</code></pre>
<h3 id="using-fine-tuned-model"><a class="header" href="#using-fine-tuned-model">Using Fine-tuned Model</a></h3>
<pre><code class="language-python">from peft import PeftModel

# Load base model
base_model = AutoModelForCausalLM.from_pretrained(
    "meta-llama/Llama-3.2-3B-Instruct",
    torch_dtype=torch.float16,
    device_map="auto"
)

# Load LoRA
model = PeftModel.from_pretrained(base_model, "./llama-lora")

# Generate
tokenizer = AutoTokenizer.from_pretrained("./llama-lora")
inputs = tokenizer("Your prompt here", return_tensors="pt").to(model.device)
outputs = model.generate(**inputs, max_new_tokens=256)
print(tokenizer.decode(outputs[0], skip_special_tokens=True))
</code></pre>
<h3 id="full-fine-tuning-requires-more-resources"><a class="header" href="#full-fine-tuning-requires-more-resources">Full Fine-tuning (Requires More Resources)</a></h3>
<pre><code class="language-python">from transformers import Trainer, TrainingArguments

# Load model normally (no quantization)
model = AutoModelForCausalLM.from_pretrained(
    "meta-llama/Llama-3.2-3B-Instruct",
    torch_dtype=torch.bfloat16,
    device_map="auto"
)

# Training arguments
training_args = TrainingArguments(
    output_dir="./llama-fullft",
    num_train_epochs=3,
    per_device_train_batch_size=2,
    gradient_accumulation_steps=8,
    learning_rate=1e-5,
    bf16=True,
    logging_steps=10,
    save_strategy="epoch",
    deepspeed="ds_config.json"  # For multi-GPU
)

# Train
trainer = Trainer(
    model=model,
    args=training_args,
    train_dataset=tokenized_dataset["train"]
)

trainer.train()
</code></pre>
<h3 id="using-axolotl-simplified-training"><a class="header" href="#using-axolotl-simplified-training">Using Axolotl (Simplified Training)</a></h3>
<pre><code class="language-bash"># Install
git clone https://github.com/OpenAccess-AI-Collective/axolotl
cd axolotl
pip install -e .
</code></pre>
<p>Create config <code>llama_qlora.yml</code>:</p>
<pre><code class="language-yaml">base_model: meta-llama/Llama-3.2-3B-Instruct
model_type: LlamaForCausalLM

load_in_4bit: true
adapter: qlora
lora_r: 16
lora_alpha: 32
lora_dropout: 0.05
lora_target_modules:
  - q_proj
  - k_proj
  - v_proj
  - o_proj

datasets:
  - path: your-dataset
    type: alpaca

num_epochs: 3
micro_batch_size: 4
gradient_accumulation_steps: 4
learning_rate: 0.0002

output_dir: ./llama-qlora-out
</code></pre>
<p>Train:</p>
<pre><code class="language-bash">accelerate launch -m axolotl.cli.train llama_qlora.yml
</code></pre>
<h2 id="quantization"><a class="header" href="#quantization">Quantization</a></h2>
<h3 id="bitsandbytes-quantization"><a class="header" href="#bitsandbytes-quantization">BitsAndBytes Quantization</a></h3>
<pre><code class="language-python">from transformers import BitsAndBytesConfig

# 8-bit
bnb_config_8bit = BitsAndBytesConfig(
    load_in_8bit=True,
    llm_int8_threshold=6.0
)

# 4-bit (QLoRA)
bnb_config_4bit = BitsAndBytesConfig(
    load_in_4bit=True,
    bnb_4bit_quant_type="nf4",  # or "fp4"
    bnb_4bit_compute_dtype=torch.bfloat16,
    bnb_4bit_use_double_quant=True
)

model = AutoModelForCausalLM.from_pretrained(
    "meta-llama/Llama-3.2-3B-Instruct",
    quantization_config=bnb_config_4bit,
    device_map="auto"
)
</code></pre>
<h3 id="gguf-quantization-llamacpp"><a class="header" href="#gguf-quantization-llamacpp">GGUF Quantization (llama.cpp)</a></h3>
<pre><code class="language-bash"># Convert to GGUF
python convert_hf_to_gguf.py \
    --model-dir models/Llama-3.2-3B-Instruct \
    --outfile llama-3.2-3b-instruct.gguf

# Quantize
./quantize \
    llama-3.2-3b-instruct.gguf \
    llama-3.2-3b-instruct-Q4_K_M.gguf \
    Q4_K_M
</code></pre>
<p>Quantization formats:</p>
<ul>
<li><code>Q4_0</code>: 4-bit, fastest, lowest quality</li>
<li><code>Q4_K_M</code>: 4-bit, good quality (recommended)</li>
<li><code>Q5_K_M</code>: 5-bit, better quality</li>
<li><code>Q8_0</code>: 8-bit, high quality</li>
</ul>
<h3 id="gptq-quantization"><a class="header" href="#gptq-quantization">GPTQ Quantization</a></h3>
<pre><code class="language-bash">pip install auto-gptq
</code></pre>
<pre><code class="language-python">from auto_gptq import AutoGPTQForCausalLM, BaseQuantizeConfig

# Quantize
quantize_config = BaseQuantizeConfig(
    bits=4,
    group_size=128,
    desc_act=False
)

model = AutoGPTQForCausalLM.from_pretrained(
    "meta-llama/Llama-3.2-3B-Instruct",
    quantize_config=quantize_config
)

# Save
model.save_quantized("llama-3.2-3b-gptq")

# Load
model = AutoGPTQForCausalLM.from_quantized(
    "llama-3.2-3b-gptq",
    device_map="auto"
)
</code></pre>
<h3 id="awq-quantization"><a class="header" href="#awq-quantization">AWQ Quantization</a></h3>
<pre><code class="language-bash">pip install autoawq
</code></pre>
<pre><code class="language-python">from awq import AutoAWQForCausalLM

# Quantize
model = AutoAWQForCausalLM.from_pretrained("meta-llama/Llama-3.2-3B-Instruct")
model.quantize(tokenizer, quant_config={"zero_point": True, "q_group_size": 128})
model.save_quantized("llama-3.2-3b-awq")

# Load
model = AutoAWQForCausalLM.from_quantized("llama-3.2-3b-awq")
</code></pre>
<h2 id="inference-optimization"><a class="header" href="#inference-optimization">Inference Optimization</a></h2>
<h3 id="flash-attention-2"><a class="header" href="#flash-attention-2">Flash Attention 2</a></h3>
<pre><code class="language-bash">pip install flash-attn --no-build-isolation
</code></pre>
<pre><code class="language-python">model = AutoModelForCausalLM.from_pretrained(
    "meta-llama/Llama-3.2-3B-Instruct",
    torch_dtype=torch.float16,
    attn_implementation="flash_attention_2",
    device_map="auto"
)
</code></pre>
<h3 id="batch-inference-1"><a class="header" href="#batch-inference-1">Batch Inference</a></h3>
<pre><code class="language-python"># Process multiple prompts efficiently
prompts = [
    "What is Python?",
    "Explain machine learning",
    "How do computers work?"
]

# Tokenize with padding
inputs = tokenizer(
    prompts,
    return_tensors="pt",
    padding=True,
    truncation=True,
    max_length=512
).to(model.device)

# Generate
outputs = model.generate(
    **inputs,
    max_new_tokens=256,
    temperature=0.7,
    do_sample=True,
    pad_token_id=tokenizer.pad_token_id
)

# Decode
results = tokenizer.batch_decode(outputs, skip_special_tokens=True)
for prompt, result in zip(prompts, results):
    print(f"Q: {prompt}\nA: {result}\n")
</code></pre>
<h3 id="kv-cache-optimization"><a class="header" href="#kv-cache-optimization">KV Cache Optimization</a></h3>
<pre><code class="language-python"># Enable static KV cache for faster inference
model.generation_config.cache_implementation = "static"
model.generation_config.max_length = 512

# Or use with generate
outputs = model.generate(
    input_ids,
    max_new_tokens=256,
    use_cache=True,
    cache_implementation="static"
)
</code></pre>
<h3 id="tensorrt-llm"><a class="header" href="#tensorrt-llm">TensorRT-LLM</a></h3>
<pre><code class="language-bash"># Build TensorRT engine
git clone https://github.com/NVIDIA/TensorRT-LLM.git
cd TensorRT-LLM

# Convert and build
python examples/llama/convert_checkpoint.py \
    --model_dir models/Llama-3.2-3B-Instruct \
    --output_dir ./trt_ckpt \
    --dtype float16

trtllm-build \
    --checkpoint_dir ./trt_ckpt \
    --output_dir ./trt_engine \
    --gemm_plugin float16
</code></pre>
<h2 id="deployment"><a class="header" href="#deployment">Deployment</a></h2>
<h3 id="fastapi-server"><a class="header" href="#fastapi-server">FastAPI Server</a></h3>
<pre><code class="language-python">from fastapi import FastAPI
from pydantic import BaseModel
from transformers import AutoTokenizer, AutoModelForCausalLM
import torch

app = FastAPI()

# Load model once at startup
model_name = "meta-llama/Llama-3.2-3B-Instruct"
tokenizer = AutoTokenizer.from_pretrained(model_name)
model = AutoModelForCausalLM.from_pretrained(
    model_name,
    torch_dtype=torch.float16,
    device_map="auto"
)

class GenerateRequest(BaseModel):
    prompt: str
    max_tokens: int = 256
    temperature: float = 0.7

@app.post("/generate")
async def generate(request: GenerateRequest):
    inputs = tokenizer(request.prompt, return_tensors="pt").to(model.device)
    
    outputs = model.generate(
        **inputs,
        max_new_tokens=request.max_tokens,
        temperature=request.temperature,
        do_sample=True
    )
    
    result = tokenizer.decode(outputs[0], skip_special_tokens=True)
    return {"response": result}

# Run: uvicorn server:app --host 0.0.0.0 --port 8000
</code></pre>
<h3 id="vllm-server"><a class="header" href="#vllm-server">vLLM Server</a></h3>
<pre><code class="language-bash"># Start server
vllm serve meta-llama/Llama-3.2-3B-Instruct \
    --host 0.0.0.0 \
    --port 8000 \
    --tensor-parallel-size 1

# Client
curl http://localhost:8000/v1/completions \
    -H "Content-Type: application/json" \
    -d '{
        "model": "meta-llama/Llama-3.2-3B-Instruct",
        "prompt": "What is AI?",
        "max_tokens": 256
    }'
</code></pre>
<p>Python client:</p>
<pre><code class="language-python">from openai import OpenAI

client = OpenAI(
    base_url="http://localhost:8000/v1",
    api_key="dummy"
)

response = client.completions.create(
    model="meta-llama/Llama-3.2-3B-Instruct",
    prompt="Explain quantum computing",
    max_tokens=256
)

print(response.choices[0].text)
</code></pre>
<h3 id="text-generation-inference-tgi"><a class="header" href="#text-generation-inference-tgi">Text Generation Inference (TGI)</a></h3>
<pre><code class="language-bash"># Docker
docker run --gpus all --shm-size 1g -p 8080:80 \
    -v $PWD/data:/data \
    ghcr.io/huggingface/text-generation-inference:latest \
    --model-id meta-llama/Llama-3.2-3B-Instruct

# Client
curl http://localhost:8080/generate \
    -X POST \
    -d '{"inputs":"What is Python?","parameters":{"max_new_tokens":256}}' \
    -H 'Content-Type: application/json'
</code></pre>
<h3 id="langchain-integration"><a class="header" href="#langchain-integration">LangChain Integration</a></h3>
<pre><code class="language-bash">pip install langchain langchain-community
</code></pre>
<pre><code class="language-python">from langchain_community.llms import HuggingFacePipeline
from langchain.chains import LLMChain
from langchain.prompts import PromptTemplate
from transformers import AutoTokenizer, AutoModelForCausalLM, pipeline

# Load model
model = AutoModelForCausalLM.from_pretrained(
    "meta-llama/Llama-3.2-3B-Instruct",
    torch_dtype=torch.float16,
    device_map="auto"
)
tokenizer = AutoTokenizer.from_pretrained("meta-llama/Llama-3.2-3B-Instruct")

# Create pipeline
pipe = pipeline(
    "text-generation",
    model=model,
    tokenizer=tokenizer,
    max_new_tokens=256,
    temperature=0.7
)

# LangChain LLM
llm = HuggingFacePipeline(pipeline=pipe)

# Create chain
template = "Question: {question}\n\nAnswer:"
prompt = PromptTemplate(template=template, input_variables=["question"])
chain = LLMChain(llm=llm, prompt=prompt)

# Use
result = chain.run("What is machine learning?")
print(result)
</code></pre>
<h2 id="advanced-techniques-2"><a class="header" href="#advanced-techniques-2">Advanced Techniques</a></h2>
<h3 id="retrieval-augmented-generation-rag"><a class="header" href="#retrieval-augmented-generation-rag">Retrieval-Augmented Generation (RAG)</a></h3>
<pre><code class="language-bash">pip install langchain chromadb sentence-transformers
</code></pre>
<pre><code class="language-python">from langchain.embeddings import HuggingFaceEmbeddings
from langchain.vectorstores import Chroma
from langchain.text_splitter import RecursiveCharacterTextSplitter
from langchain.chains import RetrievalQA
from langchain_community.llms import HuggingFacePipeline

# Load documents
documents = ["Your document text here..."]

# Split text
text_splitter = RecursiveCharacterTextSplitter(chunk_size=500, chunk_overlap=50)
texts = text_splitter.create_documents(documents)

# Create embeddings
embeddings = HuggingFaceEmbeddings(model_name="sentence-transformers/all-MiniLM-L6-v2")

# Create vector store
vectorstore = Chroma.from_documents(texts, embeddings)

# Create QA chain
qa_chain = RetrievalQA.from_chain_type(
    llm=llm,
    chain_type="stuff",
    retriever=vectorstore.as_retriever()
)

# Query
query = "What does the document say about AI?"
result = qa_chain.run(query)
print(result)
</code></pre>
<h3 id="function-calling"><a class="header" href="#function-calling">Function Calling</a></h3>
<pre><code class="language-python">import json

def get_current_weather(location: str, unit: str = "celsius"):
    """Get current weather for a location"""
    # Simulated function
    return {"location": location, "temperature": 22, "unit": unit}

# Define tools
tools = [
    {
        "name": "get_current_weather",
        "description": "Get the current weather in a given location",
        "parameters": {
            "type": "object",
            "properties": {
                "location": {"type": "string", "description": "City name"},
                "unit": {"type": "string", "enum": ["celsius", "fahrenheit"]}
            },
            "required": ["location"]
        }
    }
]

# System prompt
system_prompt = f"""You are a helpful assistant with access to tools.
Available tools: {json.dumps(tools, indent=2)}

When you need to use a tool, output JSON: {{"tool": "tool_name", "parameters": {{...}}}}
"""

messages = [
    {"role": "system", "content": system_prompt},
    {"role": "user", "content": "What's the weather in Paris?"}
]

# Generate
input_ids = tokenizer.apply_chat_template(messages, return_tensors="pt").to(model.device)
outputs = model.generate(input_ids, max_new_tokens=256)
response = tokenizer.decode(outputs[0][input_ids.shape[-1]:], skip_special_tokens=True)

# Parse and execute tool call
if "tool" in response:
    tool_call = json.loads(response)
    if tool_call["tool"] == "get_current_weather":
        result = get_current_weather(**tool_call["parameters"])
        print(f"Weather: {result}")
</code></pre>
<h3 id="constrained-generation"><a class="header" href="#constrained-generation">Constrained Generation</a></h3>
<pre><code class="language-bash">pip install outlines
</code></pre>
<pre><code class="language-python">import outlines

# Load model
model = outlines.models.transformers("meta-llama/Llama-3.2-1B-Instruct")

# JSON schema constraint
schema = """{
    "type": "object",
    "properties": {
        "name": {"type": "string"},
        "age": {"type": "integer"},
        "skills": {"type": "array", "items": {"type": "string"}}
    }
}"""

generator = outlines.generate.json(model, schema)
result = generator("Generate a person profile:")
print(result)

# Regex constraint
phone_pattern = r"\d{3}-\d{3}-\d{4}"
generator = outlines.generate.regex(model, phone_pattern)
phone = generator("Generate a US phone number:")
print(phone)
</code></pre>
<h2 id="best-practices-39"><a class="header" href="#best-practices-39">Best Practices</a></h2>
<h3 id="1-model-selection"><a class="header" href="#1-model-selection">1. Model Selection</a></h3>
<pre><code class="language-python"># Choose based on requirements
model_selection = {
    "mobile/edge": "meta-llama/Llama-3.2-1B-Instruct",
    "desktop/low_vram": "meta-llama/Llama-3.2-3B-Instruct",
    "standard": "meta-llama/Llama-3.1-8B-Instruct",
    "high_quality": "meta-llama/Llama-3.1-70B-Instruct",
    "vision": "meta-llama/Llama-3.2-11B-Vision-Instruct"
}
</code></pre>
<h3 id="2-prompt-templates"><a class="header" href="#2-prompt-templates">2. Prompt Templates</a></h3>
<pre><code class="language-python"># Use consistent templates
SYSTEM_PROMPT = "You are a helpful, respectful and honest assistant."

def format_chat(user_message, system=SYSTEM_PROMPT):
    return [
        {"role": "system", "content": system},
        {"role": "user", "content": user_message}
    ]
</code></pre>
<h3 id="3-memory-management"><a class="header" href="#3-memory-management">3. Memory Management</a></h3>
<pre><code class="language-python">import torch
import gc

def clear_memory():
    gc.collect()
    torch.cuda.empty_cache()

# After large operations
outputs = model.generate(...)
result = tokenizer.decode(outputs[0])
del outputs
clear_memory()
</code></pre>
<h3 id="4-error-handling"><a class="header" href="#4-error-handling">4. Error Handling</a></h3>
<pre><code class="language-python">def safe_generate(prompt, max_retries=3):
    for attempt in range(max_retries):
        try:
            inputs = tokenizer(prompt, return_tensors="pt").to(model.device)
            outputs = model.generate(**inputs, max_new_tokens=256)
            return tokenizer.decode(outputs[0], skip_special_tokens=True)
        except RuntimeError as e:
            if "out of memory" in str(e) and attempt &lt; max_retries - 1:
                torch.cuda.empty_cache()
                continue
            raise
</code></pre>
<h2 id="resources-24"><a class="header" href="#resources-24">Resources</a></h2>
<h3 id="official"><a class="header" href="#official">Official</a></h3>
<ul>
<li><a href="https://llama.meta.com/">Meta Llama</a></li>
<li><a href="https://huggingface.co/meta-llama">Hugging Face Models</a></li>
<li><a href="https://github.com/facebookresearch/llama-recipes">Llama Recipes</a></li>
</ul>
<h3 id="tools-2"><a class="header" href="#tools-2">Tools</a></h3>
<ul>
<li><a href="https://github.com/ggerganov/llama.cpp">llama.cpp</a></li>
<li><a href="https://ollama.com/">Ollama</a></li>
<li><a href="https://github.com/vllm-project/vllm">vLLM</a></li>
<li><a href="https://github.com/huggingface/text-generation-inference">Text Generation Inference</a></li>
</ul>
<h3 id="fine-tuning-1"><a class="header" href="#fine-tuning-1">Fine-tuning</a></h3>
<ul>
<li><a href="https://github.com/OpenAccess-AI-Collective/axolotl">Axolotl</a></li>
<li><a href="https://github.com/hiyouga/LLaMA-Factory">LLaMA-Factory</a></li>
<li><a href="https://github.com/huggingface/peft">PEFT</a></li>
</ul>
<h3 id="community-2"><a class="header" href="#community-2">Community</a></h3>
<ul>
<li>r/LocalLLaMA</li>
<li>Hugging Face Forums</li>
<li>Discord communities</li>
</ul>
<h2 id="conclusion-17"><a class="header" href="#conclusion-17">Conclusion</a></h2>
<p>Llama models provide a powerful, open-source foundation for AI applications. Whether you're running a 1B model on a mobile device or deploying a 70B model in production, the ecosystem offers tools and techniques for every use case.</p>
<p>Key takeaways:</p>
<ul>
<li><strong>Start small</strong>: Test with 1B/3B models first</li>
<li><strong>Quantize</strong>: Use 4-bit for efficient inference</li>
<li><strong>Fine-tune</strong>: QLoRA for custom domains</li>
<li><strong>Optimize</strong>: vLLM/TGI for production</li>
<li><strong>Monitor</strong>: Watch memory and performance</li>
</ul>
<p>The open-source nature and active community make Llama models an excellent choice for both research and production applications.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="stable-diffusion-1"><a class="header" href="#stable-diffusion-1">Stable Diffusion</a></h1>
<p>Complete guide to Stable Diffusion for image generation, from setup to advanced techniques.</p>
<h2 id="table-of-contents-28"><a class="header" href="#table-of-contents-28">Table of Contents</a></h2>
<ul>
<li><a href="ai/stable_diffusion.html#introduction">Introduction</a></li>
<li><a href="ai/stable_diffusion.html#installation--setup">Installation &amp; Setup</a></li>
<li><a href="ai/stable_diffusion.html#model-versions">Model Versions</a></li>
<li><a href="ai/stable_diffusion.html#prompt-engineering">Prompt Engineering</a></li>
<li><a href="ai/stable_diffusion.html#parameters">Parameters</a></li>
<li><a href="ai/stable_diffusion.html#advanced-techniques">Advanced Techniques</a></li>
<li><a href="ai/stable_diffusion.html#extensions--tools">Extensions &amp; Tools</a></li>
<li><a href="ai/stable_diffusion.html#optimization">Optimization</a></li>
<li><a href="ai/stable_diffusion.html#common-issues">Common Issues</a></li>
</ul>
<h2 id="introduction-10"><a class="header" href="#introduction-10">Introduction</a></h2>
<p>Stable Diffusion is an open-source text-to-image diffusion model capable of generating high-quality images from text descriptions. Unlike proprietary alternatives, it can run locally on consumer hardware.</p>
<h3 id="key-features-5"><a class="header" href="#key-features-5">Key Features</a></h3>
<ul>
<li><strong>Open Source</strong>: Free to use and modify</li>
<li><strong>Local Execution</strong>: Run on your own hardware</li>
<li><strong>Extensible</strong>: ControlNet, LoRA, extensions</li>
<li><strong>Fast</strong>: Optimized inference with various schedulers</li>
<li><strong>Flexible</strong>: Text-to-image, image-to-image, inpainting</li>
</ul>
<h2 id="installation--setup-1"><a class="header" href="#installation--setup-1">Installation &amp; Setup</a></h2>
<h3 id="option-1-automatic1111-webui-most-popular"><a class="header" href="#option-1-automatic1111-webui-most-popular">Option 1: AUTOMATIC1111 WebUI (Most Popular)</a></h3>
<pre><code class="language-bash"># Clone repository
git clone https://github.com/AUTOMATIC1111/stable-diffusion-webui.git
cd stable-diffusion-webui

# Install (Linux/Mac)
./webui.sh

# Install (Windows)
# Double-click webui-user.bat

# With custom arguments
# Edit webui-user.sh or webui-user.bat:
export COMMANDLINE_ARGS="--xformers --medvram --api"
</code></pre>
<p><strong>System Requirements:</strong></p>
<ul>
<li>GPU: NVIDIA (8GB+ VRAM recommended)</li>
<li>RAM: 16GB+ system RAM</li>
<li>Storage: 10GB+ for models</li>
</ul>
<h3 id="option-2-comfyui-node-based"><a class="header" href="#option-2-comfyui-node-based">Option 2: ComfyUI (Node-Based)</a></h3>
<pre><code class="language-bash"># Clone repository
git clone https://github.com/comfyanonymous/ComfyUI.git
cd ComfyUI

# Install dependencies
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu121
pip install -r requirements.txt

# Run
python main.py

# With arguments
python main.py --listen --port 8188
</code></pre>
<h3 id="option-3-python-library-diffusers"><a class="header" href="#option-3-python-library-diffusers">Option 3: Python Library (Diffusers)</a></h3>
<pre><code class="language-bash">pip install diffusers transformers accelerate torch torchvision
</code></pre>
<pre><code class="language-python">from diffusers import StableDiffusionPipeline
import torch

# Load model
model_id = "stabilityai/stable-diffusion-2-1"
pipe = StableDiffusionPipeline.from_pretrained(
    model_id,
    torch_dtype=torch.float16
)
pipe = pipe.to("cuda")

# Enable optimizations
pipe.enable_attention_slicing()
pipe.enable_vae_slicing()

# Generate
prompt = "a beautiful landscape"
image = pipe(prompt).images[0]
image.save("output.png")
</code></pre>
<h3 id="option-4-invoke-ai"><a class="header" href="#option-4-invoke-ai">Option 4: Invoke AI</a></h3>
<pre><code class="language-bash">pip install invokeai
invokeai-configure
invokeai --web
</code></pre>
<h2 id="model-versions-1"><a class="header" href="#model-versions-1">Model Versions</a></h2>
<h3 id="stable-diffusion-1x"><a class="header" href="#stable-diffusion-1x">Stable Diffusion 1.x</a></h3>
<p><strong>SD 1.4</strong></p>
<pre><code class="language-bash"># Download location
models/Stable-diffusion/sd-v1-4.ckpt
</code></pre>
<ul>
<li>Resolution: 512x512</li>
<li>Training: LAION-2B subset</li>
<li>Good for: General use</li>
</ul>
<p><strong>SD 1.5</strong></p>
<pre><code class="language-bash"># Most popular 1.x version
wget https://huggingface.co/runwayml/stable-diffusion-v1-5
</code></pre>
<ul>
<li>Improved over 1.4</li>
<li>Massive ecosystem of fine-tunes</li>
<li>Best model support</li>
</ul>
<h3 id="stable-diffusion-2x"><a class="header" href="#stable-diffusion-2x">Stable Diffusion 2.x</a></h3>
<p><strong>SD 2.0</strong></p>
<ul>
<li>Resolution: 768x768</li>
<li>New text encoder (OpenCLIP)</li>
<li>Better quality but different style</li>
</ul>
<p><strong>SD 2.1</strong></p>
<pre><code class="language-python">from diffusers import StableDiffusionPipeline

pipe = StableDiffusionPipeline.from_pretrained(
    "stabilityai/stable-diffusion-2-1",
    torch_dtype=torch.float16
)
</code></pre>
<ul>
<li>Improvements over 2.0</li>
<li>Recommended 2.x version</li>
</ul>
<h3 id="stable-diffusion-xl-sdxl"><a class="header" href="#stable-diffusion-xl-sdxl">Stable Diffusion XL (SDXL)</a></h3>
<pre><code class="language-python">from diffusers import StableDiffusionXLPipeline

# Base model
base = StableDiffusionXLPipeline.from_pretrained(
    "stabilityai/stable-diffusion-xl-base-1.0",
    torch_dtype=torch.float16,
    variant="fp16"
)
base.to("cuda")

# Refiner (optional, improves quality)
refiner = StableDiffusionXLImg2ImgPipeline.from_pretrained(
    "stabilityai/stable-diffusion-xl-refiner-1.0",
    torch_dtype=torch.float16,
    variant="fp16"
)
refiner.to("cuda")

# Generate
image = base(prompt="a futuristic city").images[0]
image = refiner(prompt="a futuristic city", image=image).images[0]
</code></pre>
<p><strong>Features:</strong></p>
<ul>
<li>Resolution: 1024x1024</li>
<li>Higher quality</li>
<li>Better text rendering</li>
<li>Dual text encoders</li>
<li>Requires more VRAM (8GB+)</li>
</ul>
<h3 id="stable-diffusion-3"><a class="header" href="#stable-diffusion-3">Stable Diffusion 3</a></h3>
<p>Latest version with improved architecture:</p>
<ul>
<li>Multimodal diffusion transformer</li>
<li>Better prompt understanding</li>
<li>Improved composition</li>
</ul>
<h2 id="prompt-engineering-1"><a class="header" href="#prompt-engineering-1">Prompt Engineering</a></h2>
<h3 id="basic-structure"><a class="header" href="#basic-structure">Basic Structure</a></h3>
<pre><code>[Subject] [Action/Scene] [Environment] [Lighting] [Style] [Quality]
</code></pre>
<h3 id="effective-prompts"><a class="header" href="#effective-prompts">Effective Prompts</a></h3>
<pre><code>Basic:
"a cat"

Better:
"a fluffy orange cat sitting on a windowsill"

Best:
"a fluffy orange tabby cat sitting on a wooden windowsill, looking outside at falling snow, soft natural lighting, cozy atmosphere, detailed fur texture, photorealistic, 4k, highly detailed"
</code></pre>
<h3 id="prompt-components"><a class="header" href="#prompt-components">Prompt Components</a></h3>
<h4 id="1-subject"><a class="header" href="#1-subject">1. Subject</a></h4>
<pre><code>"portrait of a young woman"
"a medieval castle"
"a steampunk airship"
"cyberpunk street scene"
</code></pre>
<h4 id="2-actionpose"><a class="header" href="#2-actionpose">2. Action/Pose</a></h4>
<pre><code>"running through a field"
"sitting in contemplation"
"dancing under moonlight"
"reading a book by firelight"
</code></pre>
<h4 id="3-environment"><a class="header" href="#3-environment">3. Environment</a></h4>
<pre><code>"in a mystical forest"
"on a alien planet"
"in a Victorian library"
"at a bustling marketplace"
</code></pre>
<h4 id="4-lighting"><a class="header" href="#4-lighting">4. Lighting</a></h4>
<pre><code>"golden hour lighting"
"dramatic rim lighting"
"soft diffused light"
"neon lights reflecting on wet streets"
"volumetric fog with god rays"
</code></pre>
<h4 id="5-style"><a class="header" href="#5-style">5. Style</a></h4>
<pre><code>"oil painting style"
"anime art style"
"photorealistic"
"watercolor painting"
"digital art, trending on artstation"
"in the style of Greg Rutkowski"
</code></pre>
<h4 id="6-quality-boosters"><a class="header" href="#6-quality-boosters">6. Quality Boosters</a></h4>
<pre><code>"highly detailed"
"8k resolution"
"masterpiece"
"professional photography"
"award-winning"
"intricate details"
"sharp focus"
</code></pre>
<h3 id="negative-prompts"><a class="header" href="#negative-prompts">Negative Prompts</a></h3>
<p>What to avoid in generation:</p>
<pre><code>Negative Prompt:
"ugly, blurry, low quality, distorted, deformed, bad anatomy, poorly drawn, low resolution, watermark, signature, text, cropped, worst quality, jpeg artifacts"
</code></pre>
<p><strong>Common Negative Terms:</strong></p>
<ul>
<li>Quality: <code>blurry, low quality, pixelated, grainy</code></li>
<li>Anatomy: <code>bad anatomy, extra limbs, malformed hands</code></li>
<li>Artifacts: <code>watermark, text, signature, logo</code></li>
<li>Style: <code>cartoon (for photorealistic), realistic (for artistic)</code></li>
</ul>
<h3 id="prompt-weighting"><a class="header" href="#prompt-weighting">Prompt Weighting</a></h3>
<p>Emphasize or de-emphasize parts:</p>
<pre><code># AUTOMATIC1111 syntax
(keyword)       # 1.1x weight
((keyword))     # 1.21x weight
(keyword:1.5)   # 1.5x weight
[keyword]       # 0.9x weight

Example:
"a (beautiful:1.3) landscape with (mountains:1.2) and [trees:0.8]"
</code></pre>
<h3 id="prompt-editing"><a class="header" href="#prompt-editing">Prompt Editing</a></h3>
<p>Change prompts during generation:</p>
<pre><code># AUTOMATIC1111 syntax
[keyword1:keyword2:step]

Example:
"a [dog:cat:0.5]"
# Generates dog for first 50% of steps, then cat

"photo of a woman [smiling:serious:10]"
# Smiling for first 10 steps, then serious
</code></pre>
<h3 id="artist-styles"><a class="header" href="#artist-styles">Artist Styles</a></h3>
<p>Reference famous artists:</p>
<pre><code>"in the style of Van Gogh"
"by Greg Rutkowski"
"by Alphonse Mucha"
"by Simon Stalenhag"
"by Artgerm"
"by Ilya Kuvshinov"
</code></pre>
<h2 id="parameters-1"><a class="header" href="#parameters-1">Parameters</a></h2>
<h3 id="core-parameters"><a class="header" href="#core-parameters">Core Parameters</a></h3>
<h4 id="steps-num_inference_steps"><a class="header" href="#steps-num_inference_steps">Steps (num_inference_steps)</a></h4>
<pre><code class="language-python"># Fewer steps = faster, less refined
image = pipe(prompt, num_inference_steps=20)

# More steps = slower, more refined
image = pipe(prompt, num_inference_steps=50)
</code></pre>
<p><strong>Recommendations:</strong></p>
<ul>
<li>Quick preview: 15-20 steps</li>
<li>Standard quality: 25-35 steps</li>
<li>High quality: 40-60 steps</li>
<li>Diminishing returns after 60</li>
</ul>
<h4 id="cfg-scale-guidance_scale"><a class="header" href="#cfg-scale-guidance_scale">CFG Scale (guidance_scale)</a></h4>
<p>How closely to follow the prompt:</p>
<pre><code class="language-python"># Low CFG = creative, less adherence
image = pipe(prompt, guidance_scale=3.5)

# Medium CFG = balanced
image = pipe(prompt, guidance_scale=7.5)

# High CFG = strict adherence, may oversaturate
image = pipe(prompt, guidance_scale=15)
</code></pre>
<p><strong>Recommendations:</strong></p>
<ul>
<li>Creative/artistic: 5-7</li>
<li>Balanced: 7-10</li>
<li>Strict/detailed: 10-15</li>
<li>Avoid: &gt;20 (over-saturated)</li>
</ul>
<h4 id="seed"><a class="header" href="#seed">Seed</a></h4>
<p>Reproducible results:</p>
<pre><code class="language-python"># Random seed
image = pipe(prompt)

# Fixed seed for reproducibility
generator = torch.Generator("cuda").manual_seed(42)
image = pipe(prompt, generator=generator)
</code></pre>
<h4 id="samplerscheduler"><a class="header" href="#samplerscheduler">Sampler/Scheduler</a></h4>
<p>Different algorithms for denoising:</p>
<pre><code class="language-python">from diffusers import (
    DPMSolverMultistepScheduler,
    EulerAncestralDiscreteScheduler,
    DDIMScheduler
)

# Fast and high quality (recommended)
pipe.scheduler = DPMSolverMultistepScheduler.from_config(
    pipe.scheduler.config
)

# More creative, varied
pipe.scheduler = EulerAncestralDiscreteScheduler.from_config(
    pipe.scheduler.config
)

# Stable, predictable
pipe.scheduler = DDIMScheduler.from_config(
    pipe.scheduler.config
)
</code></pre>
<p><strong>Popular Samplers:</strong></p>
<ul>
<li><strong>DPM++ 2M Karras</strong>: Fast, high quality (recommended)</li>
<li><strong>Euler a</strong>: Creative, varied results</li>
<li><strong>DDIM</strong>: Stable, reproducible</li>
<li><strong>UniPC</strong>: Very fast, good quality</li>
<li><strong>DPM++ SDE Karras</strong>: High quality, slower</li>
</ul>
<h4 id="resolution"><a class="header" href="#resolution">Resolution</a></h4>
<pre><code class="language-python"># SD 1.5 native: 512x512
image = pipe(prompt, width=512, height=512)

# SD 2.1 native: 768x768
image = pipe(prompt, width=768, height=768)

# SDXL native: 1024x1024
image = pipe(prompt, width=1024, height=1024)

# Portrait
image = pipe(prompt, width=512, height=768)

# Landscape
image = pipe(prompt, width=768, height=512)
</code></pre>
<p><strong>Tips:</strong></p>
<ul>
<li>Stick to multiples of 8 or 64</li>
<li>Native resolution gives best results</li>
<li>Higher resolution needs more VRAM</li>
<li>Use upscaling for ultra-high resolution</li>
</ul>
<h3 id="batch-settings"><a class="header" href="#batch-settings">Batch Settings</a></h3>
<pre><code class="language-python"># Generate multiple images
images = pipe(
    prompt,
    num_images_per_prompt=4,
    guidance_scale=7.5
).images

# Save all
for i, img in enumerate(images):
    img.save(f"output_{i}.png")
</code></pre>
<h2 id="advanced-techniques-3"><a class="header" href="#advanced-techniques-3">Advanced Techniques</a></h2>
<h3 id="image-to-image-1"><a class="header" href="#image-to-image-1">Image-to-Image</a></h3>
<p>Transform existing images:</p>
<pre><code class="language-python">from diffusers import StableDiffusionImg2ImgPipeline
from PIL import Image

pipe = StableDiffusionImg2ImgPipeline.from_pretrained(
    "stabilityai/stable-diffusion-2-1",
    torch_dtype=torch.float16
).to("cuda")

# Load image
init_image = Image.open("input.jpg").convert("RGB")
init_image = init_image.resize((768, 768))

# Transform
prompt = "a fantasy castle, magical, highly detailed"
images = pipe(
    prompt=prompt,
    image=init_image,
    strength=0.75,  # 0=no change, 1=complete regeneration
    guidance_scale=7.5,
    num_inference_steps=50
).images[0]

images.save("transformed.png")
</code></pre>
<p><strong>Strength Parameter:</strong></p>
<ul>
<li>0.1-0.3: Minor adjustments, preserve structure</li>
<li>0.4-0.6: Moderate changes, guided by original</li>
<li>0.7-0.9: Major changes, loose interpretation</li>
<li>1.0: Complete regeneration</li>
</ul>
<h3 id="inpainting-1"><a class="header" href="#inpainting-1">Inpainting</a></h3>
<p>Edit specific parts of images:</p>
<pre><code class="language-python">from diffusers import StableDiffusionInpaintPipeline

pipe = StableDiffusionInpaintPipeline.from_pretrained(
    "stabilityai/stable-diffusion-2-inpainting",
    torch_dtype=torch.float16
).to("cuda")

# Load image and mask
image = Image.open("photo.png")
mask = Image.open("mask.png")  # White = inpaint, Black = keep

prompt = "a red vintage car"
result = pipe(
    prompt=prompt,
    image=image,
    mask_image=mask,
    num_inference_steps=50,
    guidance_scale=7.5
).images[0]

result.save("inpainted.png")
</code></pre>
<h3 id="controlnet"><a class="header" href="#controlnet">ControlNet</a></h3>
<p>Precise control over generation:</p>
<pre><code class="language-python">from diffusers import StableDiffusionControlNetPipeline, ControlNetModel
from PIL import Image
import cv2
import numpy as np

# Load ControlNet model
controlnet = ControlNetModel.from_pretrained(
    "lllyasviel/sd-controlnet-canny",
    torch_dtype=torch.float16
)

pipe = StableDiffusionControlNetPipeline.from_pretrained(
    "runwayml/stable-diffusion-v1-5",
    controlnet=controlnet,
    torch_dtype=torch.float16
).to("cuda")

# Load image and create canny edge map
image = Image.open("input.jpg")
image = np.array(image)
canny_edges = cv2.Canny(image, 100, 200)
canny_edges = Image.fromarray(canny_edges)

# Generate with control
prompt = "a professional architectural photograph"
output = pipe(
    prompt=prompt,
    image=canny_edges,
    num_inference_steps=30
).images[0]
</code></pre>
<p><strong>ControlNet Models:</strong></p>
<ul>
<li><strong>Canny</strong>: Edge detection</li>
<li><strong>Depth</strong>: Depth map</li>
<li><strong>OpenPose</strong>: Human pose</li>
<li><strong>Scribble</strong>: Hand-drawn sketches</li>
<li><strong>Normal</strong>: Normal maps</li>
<li><strong>Segmentation</strong>: Semantic segmentation</li>
<li><strong>MLSD</strong>: Line detection (architecture)</li>
</ul>
<h3 id="lora-low-rank-adaptation-2"><a class="header" href="#lora-low-rank-adaptation-2">LoRA (Low-Rank Adaptation)</a></h3>
<p>Fine-tuned models with small file size:</p>
<pre><code class="language-python">from diffusers import StableDiffusionPipeline

pipe = StableDiffusionPipeline.from_pretrained(
    "runwayml/stable-diffusion-v1-5",
    torch_dtype=torch.float16
).to("cuda")

# Load LoRA
pipe.load_lora_weights("path/to/lora.safetensors")

# Generate with LoRA style
prompt = "a portrait in the style of &lt;lora-trigger-word&gt;"
image = pipe(prompt).images[0]

# Unload LoRA
pipe.unload_lora_weights()
</code></pre>
<p><strong>Popular LoRA Types:</strong></p>
<ul>
<li>Character/celebrity faces</li>
<li>Art styles</li>
<li>Concepts</li>
<li>Objects/clothing</li>
</ul>
<h3 id="textual-inversion"><a class="header" href="#textual-inversion">Textual Inversion</a></h3>
<p>Custom concepts/embeddings:</p>
<pre><code class="language-python"># Load embedding
pipe.load_textual_inversion("path/to/embedding.pt", token="&lt;special-token&gt;")

# Use in prompt
prompt = "a photo of &lt;special-token&gt; in a forest"
image = pipe(prompt).images[0]
</code></pre>
<h3 id="upscaling"><a class="header" href="#upscaling">Upscaling</a></h3>
<p>Increase resolution with detail:</p>
<pre><code class="language-python">from diffusers import StableDiffusionUpscalePipeline

# Load upscaler
upscaler = StableDiffusionUpscalePipeline.from_pretrained(
    "stabilityai/stable-diffusion-x4-upscaler",
    torch_dtype=torch.float16
).to("cuda")

# Load low-res image
low_res = Image.open("output_512.png")

# Upscale
prompt = "highly detailed, sharp, professional"
upscaled = upscaler(
    prompt=prompt,
    image=low_res,
    num_inference_steps=50
).images[0]

upscaled.save("output_2048.png")
</code></pre>
<p><strong>Upscaling Options:</strong></p>
<ol>
<li><strong>SD Upscale</strong>: Built-in SD upscaler</li>
<li><strong>Real-ESRGAN</strong>: Traditional upscaler</li>
<li><strong>Ultimate SD Upscale</strong>: Tiled upscaling</li>
<li><strong>ControlNet Tile</strong>: Detail-preserving upscale</li>
</ol>
<h2 id="extensions--tools"><a class="header" href="#extensions--tools">Extensions &amp; Tools</a></h2>
<h3 id="automatic1111-extensions"><a class="header" href="#automatic1111-extensions">AUTOMATIC1111 Extensions</a></h3>
<p>Install via Extensions tab or:</p>
<pre><code class="language-bash">cd extensions
git clone [extension-repo-url]
</code></pre>
<h4 id="essential-extensions"><a class="header" href="#essential-extensions">Essential Extensions</a></h4>
<p><strong>ControlNet</strong></p>
<pre><code class="language-bash">git clone https://github.com/Mikubill/sd-webui-controlnet.git
</code></pre>
<p><strong>Dynamic Prompts</strong></p>
<pre><code class="language-bash">git clone https://github.com/adieyal/sd-dynamic-prompts.git
</code></pre>
<ul>
<li>Wildcard support: <code>{red|blue|green} car</code></li>
<li>Combinatorial generation</li>
</ul>
<p><strong>Image Browser</strong></p>
<pre><code class="language-bash">git clone https://github.com/AlUlkesh/stable-diffusion-webui-images-browser.git
</code></pre>
<ul>
<li>Browse generated images</li>
<li>Search by metadata</li>
</ul>
<p><strong>Cutoff</strong></p>
<pre><code class="language-bash">git clone https://github.com/hnmr293/sd-webui-cutoff.git
</code></pre>
<ul>
<li>Prevent color bleeding between subjects</li>
</ul>
<p><strong>Regional Prompter</strong></p>
<pre><code class="language-bash">git clone https://github.com/hako-mikan/sd-webui-regional-prompter.git
</code></pre>
<ul>
<li>Different prompts for image regions</li>
</ul>
<h3 id="checkpoint-merging"><a class="header" href="#checkpoint-merging">Checkpoint Merging</a></h3>
<p>Combine models:</p>
<pre><code class="language-python">from diffusers import StableDiffusionPipeline
import torch

# Load two models
pipe1 = StableDiffusionPipeline.from_pretrained("model1")
pipe2 = StableDiffusionPipeline.from_pretrained("model2")

# Merge (0.5 = 50/50 blend)
alpha = 0.5
for key in pipe1.unet.state_dict():
    pipe1.unet.state_dict()[key] = (
        alpha * pipe1.unet.state_dict()[key] +
        (1 - alpha) * pipe2.unet.state_dict()[key]
    )

# Save merged model
pipe1.save_pretrained("merged_model")
</code></pre>
<h3 id="prompt-matrix"><a class="header" href="#prompt-matrix">Prompt Matrix</a></h3>
<p>Test multiple prompts:</p>
<pre><code># In AUTOMATIC1111
Prompt: a |red, blue, green| |car, house| in a forest

Generates:
- a red car in a forest
- a red house in a forest
- a blue car in a forest
- a blue house in a forest
- a green car in a forest
- a green house in a forest
</code></pre>
<h2 id="optimization-3"><a class="header" href="#optimization-3">Optimization</a></h2>
<h3 id="memory-optimization"><a class="header" href="#memory-optimization">Memory Optimization</a></h3>
<pre><code class="language-python">from diffusers import StableDiffusionPipeline
import torch

pipe = StableDiffusionPipeline.from_pretrained(
    "runwayml/stable-diffusion-v1-5",
    torch_dtype=torch.float16  # Half precision
).to("cuda")

# Enable memory optimizations
pipe.enable_attention_slicing()  # Reduce memory
pipe.enable_vae_slicing()  # Reduce VAE memory
pipe.enable_xformers_memory_efficient_attention()  # Faster attention

# For very low VRAM (4GB)
pipe.enable_sequential_cpu_offload()
</code></pre>
<h3 id="speed-optimization"><a class="header" href="#speed-optimization">Speed Optimization</a></h3>
<pre><code class="language-python"># Use faster scheduler
from diffusers import DPMSolverMultistepScheduler

pipe.scheduler = DPMSolverMultistepScheduler.from_config(
    pipe.scheduler.config
)

# Compile model (PyTorch 2.0+)
pipe.unet = torch.compile(pipe.unet, mode="reduce-overhead")

# Reduce steps with quality scheduler
image = pipe(prompt, num_inference_steps=20)  # vs 50 with others
</code></pre>
<h3 id="vram-requirements"><a class="header" href="#vram-requirements">VRAM Requirements</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Configuration</th><th>Minimum VRAM</th></tr></thead><tbody>
<tr><td>SD 1.5 (512x512)</td><td>4GB</td></tr>
<tr><td>SD 1.5 (512x512, optimized)</td><td>2GB</td></tr>
<tr><td>SD 2.1 (768x768)</td><td>6GB</td></tr>
<tr><td>SDXL (1024x1024)</td><td>8GB</td></tr>
<tr><td>SDXL (1024x1024, optimized)</td><td>6GB</td></tr>
<tr><td>ControlNet + SD</td><td>+2GB</td></tr>
<tr><td>Batch size 2</td><td>+2GB per image</td></tr>
</tbody></table>
</div>
<h3 id="launch-arguments-automatic1111"><a class="header" href="#launch-arguments-automatic1111">Launch Arguments (AUTOMATIC1111)</a></h3>
<pre><code class="language-bash"># Basic optimization
--xformers              # Memory-efficient attention
--medvram               # Medium VRAM optimization
--lowvram               # Low VRAM optimization
--no-half-vae           # Fix black images on some GPUs

# API
--api                   # Enable API
--listen                # Allow network connections

# Performance
--opt-sdp-attention     # Scaled dot product attention
--no-gradio-queue       # Disable queue

# Example combination
./webui.sh --xformers --medvram --api --no-half-vae
</code></pre>
<h2 id="common-issues-9"><a class="header" href="#common-issues-9">Common Issues</a></h2>
<h3 id="black-images"><a class="header" href="#black-images">Black Images</a></h3>
<pre><code class="language-bash"># Solution: Disable half precision for VAE
--no-half-vae
</code></pre>
<p>Or in Python:</p>
<pre><code class="language-python">pipe.vae.to(torch.float32)
</code></pre>
<h3 id="out-of-memory-oom"><a class="header" href="#out-of-memory-oom">Out of Memory (OOM)</a></h3>
<pre><code class="language-python"># Enable all optimizations
pipe.enable_attention_slicing()
pipe.enable_vae_slicing()
pipe.enable_sequential_cpu_offload()

# Reduce resolution
image = pipe(prompt, width=512, height=512)

# Reduce batch size
image = pipe(prompt, num_images_per_prompt=1)
</code></pre>
<h3 id="bad-handsanatomy"><a class="header" href="#bad-handsanatomy">Bad Hands/Anatomy</a></h3>
<pre><code>Negative prompt: "bad hands, bad anatomy, extra fingers, missing fingers, deformed hands, poorly drawn hands"

# Or use inpainting to fix
# Or use ControlNet OpenPose for guidance
</code></pre>
<h3 id="inconsistent-results"><a class="header" href="#inconsistent-results">Inconsistent Results</a></h3>
<pre><code class="language-python"># Use fixed seed
generator = torch.Generator("cuda").manual_seed(42)
image = pipe(prompt, generator=generator)

# Use lower temperature sampler (DDIM instead of Euler a)
</code></pre>
<h3 id="prompt-not-working"><a class="header" href="#prompt-not-working">Prompt Not Working</a></h3>
<ol>
<li>Check prompt weighting: <code>(keyword:1.3)</code></li>
<li>Use negative prompt to exclude unwanted elements</li>
<li>Increase CFG scale</li>
<li>Try different sampler</li>
<li>Add quality boosters: "highly detailed, 8k"</li>
</ol>
<h2 id="best-practices-40"><a class="header" href="#best-practices-40">Best Practices</a></h2>
<h3 id="1-prompt-structure"><a class="header" href="#1-prompt-structure">1. Prompt Structure</a></h3>
<pre><code>[Quality] [Style] [Subject] [Action] [Environment] [Lighting] [Details]

Example:
"masterpiece, best quality, photorealistic, portrait of a young woman, smiling, in a sunlit garden, golden hour lighting, detailed facial features, professional photography, 8k uhd"
</code></pre>
<h3 id="2-iterative-refinement"><a class="header" href="#2-iterative-refinement">2. Iterative Refinement</a></h3>
<pre><code class="language-python"># Start with low steps for preview
preview = pipe(prompt, num_inference_steps=15).images[0]

# Refine with more steps
final = pipe(prompt, num_inference_steps=50).images[0]

# Upscale for details
upscaled = upscale(final)
</code></pre>
<h3 id="3-seed-management"><a class="header" href="#3-seed-management">3. Seed Management</a></h3>
<pre><code class="language-python"># Save seeds for good results
good_seeds = []

for seed in range(100):
    gen = torch.Generator("cuda").manual_seed(seed)
    image = pipe(prompt, generator=gen).images[0]
    
    if is_good(image):
        good_seeds.append(seed)
        image.save(f"good_{seed}.png")
</code></pre>
<h3 id="4-negative-prompts-library"><a class="header" href="#4-negative-prompts-library">4. Negative Prompts Library</a></h3>
<pre><code class="language-python">negative_prompts = {
    'photorealistic': "anime, cartoon, drawing, painting, low quality",
    'artistic': "photorealistic, photo, realistic, low quality",
    'quality': "ugly, blurry, low quality, low resolution, pixelated",
    'anatomy': "bad anatomy, extra limbs, poorly drawn, deformed",
    'artifacts': "watermark, signature, text, logo, copyright"
}

# Combine as needed
negative = ", ".join([
    negative_prompts['quality'],
    negative_prompts['anatomy'],
    negative_prompts['artifacts']
])
</code></pre>
<h2 id="resources-25"><a class="header" href="#resources-25">Resources</a></h2>
<h3 id="models"><a class="header" href="#models">Models</a></h3>
<ul>
<li><a href="https://huggingface.co/models?pipeline_tag=text-to-image">Hugging Face</a></li>
<li><a href="https://civitai.com/">Civitai</a> - Community models, LoRAs</li>
<li><a href="https://huggingface.co/stabilityai">Stability AI</a></li>
</ul>
<h3 id="tools-3"><a class="header" href="#tools-3">Tools</a></h3>
<ul>
<li><a href="https://github.com/AUTOMATIC1111/stable-diffusion-webui">AUTOMATIC1111 WebUI</a></li>
<li><a href="https://github.com/comfyanonymous/ComfyUI">ComfyUI</a></li>
<li><a href="https://github.com/invoke-ai/InvokeAI">InvokeAI</a></li>
</ul>
<h3 id="learning-1"><a class="header" href="#learning-1">Learning</a></h3>
<ul>
<li><a href="https://stable-diffusion-art.com/">Stable Diffusion Art</a></li>
<li><a href="https://www.reddit.com/r/StableDiffusion/">r/StableDiffusion</a></li>
<li><a href="https://openart.ai/promptbook">OpenArt Prompt Book</a></li>
</ul>
<h3 id="communities-2"><a class="header" href="#communities-2">Communities</a></h3>
<ul>
<li>Discord: Stable Diffusion</li>
<li>Reddit: r/StableDiffusion</li>
<li>Twitter/X: #StableDiffusion</li>
</ul>
<h2 id="conclusion-18"><a class="header" href="#conclusion-18">Conclusion</a></h2>
<p>Stable Diffusion offers incredible flexibility and power for image generation. Success comes from understanding the fundamentals, experimenting with parameters, and iterating on prompts. Start simple, learn the basics, then explore advanced techniques like ControlNet and LoRA for professional results.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="flux1---black-forest-labs"><a class="header" href="#flux1---black-forest-labs">Flux.1 - Black Forest Labs</a></h1>
<p>Complete guide to Flux.1, the next-generation image generation model from the creators of Stable Diffusion.</p>
<h2 id="table-of-contents-29"><a class="header" href="#table-of-contents-29">Table of Contents</a></h2>
<ul>
<li><a href="ai/fluxdev.html#introduction">Introduction</a></li>
<li><a href="ai/fluxdev.html#model-variants">Model Variants</a></li>
<li><a href="ai/fluxdev.html#installation--setup">Installation &amp; Setup</a></li>
<li><a href="ai/fluxdev.html#usage">Usage</a></li>
<li><a href="ai/fluxdev.html#prompt-engineering">Prompt Engineering</a></li>
<li><a href="ai/fluxdev.html#parameters">Parameters</a></li>
<li><a href="ai/fluxdev.html#comparison-with-other-models">Comparison with Other Models</a></li>
<li><a href="ai/fluxdev.html#advanced-techniques">Advanced Techniques</a></li>
<li><a href="ai/fluxdev.html#optimization">Optimization</a></li>
</ul>
<h2 id="introduction-11"><a class="header" href="#introduction-11">Introduction</a></h2>
<p>Flux.1 is a state-of-the-art image generation model developed by Black Forest Labs, the team behind the original Stable Diffusion. Released in 2024, it represents a significant advancement in image quality, prompt adherence, and detail preservation.</p>
<h3 id="key-features-6"><a class="header" href="#key-features-6">Key Features</a></h3>
<ul>
<li><strong>Superior Image Quality</strong>: Enhanced detail and realism</li>
<li><strong>Better Prompt Understanding</strong>: More accurate interpretation</li>
<li><strong>Improved Text Rendering</strong>: Readable text in images</li>
<li><strong>Flexible Architecture</strong>: Multiple variants for different needs</li>
<li><strong>Advanced Control</strong>: Fine-grained control over generation</li>
<li><strong>Fast Inference</strong>: Optimized for speed</li>
</ul>
<h3 id="model-architecture"><a class="header" href="#model-architecture">Model Architecture</a></h3>
<ul>
<li><strong>Flow Matching</strong>: Advanced diffusion technique</li>
<li><strong>Hybrid Architecture</strong>: Combines transformer and diffusion</li>
<li><strong>12B Parameters</strong>: Larger than SD models</li>
<li><strong>Parallel Attention</strong>: Efficient processing</li>
<li><strong>Rotation Position Embeddings (RoPE)</strong>: Better spatial understanding</li>
</ul>
<h2 id="model-variants"><a class="header" href="#model-variants">Model Variants</a></h2>
<h3 id="flux1-pro"><a class="header" href="#flux1-pro">Flux.1 [pro]</a></h3>
<p><strong>Commercial, API-only</strong></p>
<pre><code class="language-python">import requests

API_URL = "https://api.bfl.ml/v1/flux-pro"
API_KEY = "your-api-key"

def generate_flux_pro(prompt):
    headers = {
        "Authorization": f"Bearer {API_KEY}",
        "Content-Type": "application/json"
    }
    
    payload = {
        "prompt": prompt,
        "width": 1024,
        "height": 1024,
        "steps": 30
    }
    
    response = requests.post(API_URL, json=payload, headers=headers)
    return response.json()

# Generate
result = generate_flux_pro(
    "a professional photograph of a modern office, natural lighting, detailed"
)
</code></pre>
<p><strong>Features:</strong></p>
<ul>
<li>Highest quality</li>
<li>Best prompt adherence</li>
<li>Commercial use allowed</li>
<li>API access only</li>
<li>Pay per generation</li>
</ul>
<p><strong>Best for:</strong></p>
<ul>
<li>Professional work</li>
<li>Commercial projects</li>
<li>Maximum quality needs</li>
</ul>
<h3 id="flux1-dev"><a class="header" href="#flux1-dev">Flux.1 [dev]</a></h3>
<p><strong>Non-commercial, open-weight</strong></p>
<pre><code class="language-python">import torch
from diffusers import FluxPipeline

# Load model
pipe = FluxPipeline.from_pretrained(
    "black-forest-labs/FLUX.1-dev",
    torch_dtype=torch.bfloat16
)
pipe.to("cuda")

# Generate
prompt = "a majestic lion in the savanna at sunset, highly detailed"
image = pipe(
    prompt,
    guidance_scale=3.5,
    num_inference_steps=30,
    height=1024,
    width=1024,
).images[0]

image.save("flux_output.png")
</code></pre>
<p><strong>Features:</strong></p>
<ul>
<li>High quality</li>
<li>Open weights</li>
<li>Non-commercial license</li>
<li>Requires Hugging Face auth</li>
<li>Can run locally</li>
</ul>
<p><strong>Requirements:</strong></p>
<ul>
<li>GPU: 24GB+ VRAM (recommended)</li>
<li>RAM: 32GB+ system RAM</li>
<li>Storage: ~30GB for model</li>
</ul>
<p><strong>Best for:</strong></p>
<ul>
<li>Research and development</li>
<li>Personal projects</li>
<li>Learning and experimentation</li>
</ul>
<h3 id="flux1-schnell"><a class="header" href="#flux1-schnell">Flux.1 [schnell]</a></h3>
<p><strong>Apache 2.0 license, fastest</strong></p>
<pre><code class="language-python">from diffusers import FluxPipeline
import torch

# Load schnell variant
pipe = FluxPipeline.from_pretrained(
    "black-forest-labs/FLUX.1-schnell",
    torch_dtype=torch.bfloat16
)
pipe.to("cuda")

# Fast generation (1-4 steps)
prompt = "a portrait of a person, professional photography"
image = pipe(
    prompt,
    num_inference_steps=4,  # Very few steps needed
    guidance_scale=0.0,  # No guidance needed
    height=1024,
    width=1024,
).images[0]

image.save("schnell_output.png")
</code></pre>
<p><strong>Features:</strong></p>
<ul>
<li>Very fast (1-4 steps)</li>
<li>Good quality</li>
<li>Apache 2.0 license</li>
<li>Commercial use allowed</li>
<li>Lower VRAM requirements</li>
</ul>
<p><strong>Best for:</strong></p>
<ul>
<li>Real-time applications</li>
<li>High-volume generation</li>
<li>Commercial projects</li>
<li>Resource-constrained environments</li>
</ul>
<h2 id="installation--setup-2"><a class="header" href="#installation--setup-2">Installation &amp; Setup</a></h2>
<h3 id="option-1-diffusers-recommended"><a class="header" href="#option-1-diffusers-recommended">Option 1: Diffusers (Recommended)</a></h3>
<pre><code class="language-bash"># Install dependencies
pip install diffusers transformers accelerate torch

# Install from latest
pip install git+https://github.com/huggingface/diffusers.git
</code></pre>
<pre><code class="language-python">from diffusers import FluxPipeline
import torch

# Authenticate with Hugging Face
from huggingface_hub import login
login(token="your_hf_token")

# Load model
pipe = FluxPipeline.from_pretrained(
    "black-forest-labs/FLUX.1-dev",
    torch_dtype=torch.bfloat16
)
pipe.enable_model_cpu_offload()  # Save VRAM

# Generate
image = pipe("a beautiful landscape").images[0]
</code></pre>
<h3 id="option-2-comfyui"><a class="header" href="#option-2-comfyui">Option 2: ComfyUI</a></h3>
<pre><code class="language-bash"># Update ComfyUI
cd ComfyUI
git pull

# Download Flux models to:
# models/unet/flux1-dev.safetensors
# models/unet/flux1-schnell.safetensors

# Download CLIP and T5 encoders to:
# models/clip/clip_l.safetensors
# models/clip/t5xxl_fp16.safetensors

# Download VAE to:
# models/vae/ae.safetensors
</code></pre>
<h3 id="option-3-automatic1111-via-extension"><a class="header" href="#option-3-automatic1111-via-extension">Option 3: AUTOMATIC1111 (via extension)</a></h3>
<pre><code class="language-bash">cd extensions
git clone https://github.com/XLabs-AI/x-flux-comfyui.git
# Restart WebUI
</code></pre>
<h3 id="hardware-requirements"><a class="header" href="#hardware-requirements">Hardware Requirements</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Variant</th><th>Minimum VRAM</th><th>Recommended VRAM</th><th>Storage</th></tr></thead><tbody>
<tr><td>Schnell</td><td>12GB</td><td>16GB</td><td>30GB</td></tr>
<tr><td>Dev</td><td>16GB</td><td>24GB</td><td>30GB</td></tr>
<tr><td>Pro</td><td>N/A (API)</td><td>N/A (API)</td><td>N/A</td></tr>
</tbody></table>
</div>
<p><strong>Optimizations:</strong></p>
<ul>
<li>bfloat16: Reduces VRAM by ~50%</li>
<li>CPU offload: Reduces VRAM usage further</li>
<li>Quantization: 8-bit or 4-bit for lower VRAM</li>
</ul>
<h2 id="usage"><a class="header" href="#usage">Usage</a></h2>
<h3 id="basic-generation"><a class="header" href="#basic-generation">Basic Generation</a></h3>
<pre><code class="language-python">from diffusers import FluxPipeline
import torch

pipe = FluxPipeline.from_pretrained(
    "black-forest-labs/FLUX.1-dev",
    torch_dtype=torch.bfloat16
)
pipe.to("cuda")

# Simple generation
prompt = "a serene mountain lake at sunrise"
image = pipe(prompt).images[0]
image.save("output.png")
</code></pre>
<h3 id="with-parameters"><a class="header" href="#with-parameters">With Parameters</a></h3>
<pre><code class="language-python">image = pipe(
    prompt="a futuristic city with flying cars, neon lights, cyberpunk",
    height=1024,
    width=1024,
    num_inference_steps=30,
    guidance_scale=3.5,
    max_sequence_length=256,
).images[0]
</code></pre>
<h3 id="batch-generation"><a class="header" href="#batch-generation">Batch Generation</a></h3>
<pre><code class="language-python"># Multiple images from one prompt
images = pipe(
    prompt="a cute cat",
    num_images_per_prompt=4,
    num_inference_steps=30,
).images

for i, img in enumerate(images):
    img.save(f"cat_{i}.png")
</code></pre>
<h3 id="seed-control"><a class="header" href="#seed-control">Seed Control</a></h3>
<pre><code class="language-python"># Fixed seed for reproducibility
generator = torch.Generator("cuda").manual_seed(42)

image = pipe(
    prompt="a magical forest",
    generator=generator,
    num_inference_steps=30,
).images[0]
</code></pre>
<h3 id="memory-efficient-generation"><a class="header" href="#memory-efficient-generation">Memory-Efficient Generation</a></h3>
<pre><code class="language-python"># For lower VRAM
pipe.enable_model_cpu_offload()
pipe.enable_sequential_cpu_offload()
pipe.vae.enable_slicing()
pipe.vae.enable_tiling()

# Generate
image = pipe(
    prompt="a detailed landscape",
    height=1024,
    width=1024,
).images[0]
</code></pre>
<h2 id="prompt-engineering-2"><a class="header" href="#prompt-engineering-2">Prompt Engineering</a></h2>
<h3 id="prompt-structure"><a class="header" href="#prompt-structure">Prompt Structure</a></h3>
<p>Flux.1 has excellent prompt understanding. Use natural language:</p>
<pre><code class="language-python"># Simple and effective
prompt = "a portrait of a woman with red hair, wearing a blue dress, in a garden"

# Detailed
prompt = """
a professional photograph of a young woman with flowing red hair, 
wearing an elegant blue silk dress, standing in a lush garden 
with blooming roses, soft natural lighting, golden hour, 
depth of field, bokeh background, shot on Canon EOS R5
"""

# With style
prompt = """
oil painting of a medieval knight in full armor, 
standing on a cliff overlooking the ocean at sunset,
dramatic lighting, renaissance art style, 
highly detailed, masterpiece
"""
</code></pre>
<h3 id="natural-language"><a class="header" href="#natural-language">Natural Language</a></h3>
<p>Flux excels with conversational prompts:</p>
<pre><code class="language-python">prompts = [
    "Show me a cat wearing sunglasses at the beach",
    "Create an image of a steampunk airship flying over Victorian London",
    "Paint a serene Japanese garden in autumn with falling maple leaves",
    "Design a futuristic sports car that looks fast even when standing still"
]
</code></pre>
<h3 id="text-in-images"><a class="header" href="#text-in-images">Text in Images</a></h3>
<p>Flux.1 can render text (unlike most other models):</p>
<pre><code class="language-python"># Text rendering
prompt = '''
a modern cafe storefront with a neon sign that says "COFFEE SHOP",
rainy evening, reflections on wet pavement, cinematic lighting
'''

# Book cover
prompt = '''
a fantasy book cover with the title "The Dragon's Tale" 
written in elegant golden letters at the top,
featuring a majestic dragon flying over mountains
'''

# Product mockup
prompt = '''
a white t-shirt with the text "FLUX.1" printed in bold black letters,
product photography, plain white background, professional lighting
'''
</code></pre>
<h3 id="aspect-ratios"><a class="header" href="#aspect-ratios">Aspect Ratios</a></h3>
<pre><code class="language-python"># Portrait
image = pipe(prompt, height=1344, width=768).images[0]

# Landscape
image = pipe(prompt, height=768, width=1344).images[0]

# Square
image = pipe(prompt, height=1024, width=1024).images[0]

# Cinematic
image = pipe(prompt, height=576, width=1024).images[0]

# Ultra-wide
image = pipe(prompt, height=512, width=1536).images[0]
</code></pre>
<h3 id="prompt-tips"><a class="header" href="#prompt-tips">Prompt Tips</a></h3>
<ol>
<li><strong>Be Specific</strong>: More detail = better results</li>
<li><strong>Natural Language</strong>: Write as you would describe to a person</li>
<li><strong>Quality Terms</strong>: "professional", "detailed", "high quality"</li>
<li><strong>Style References</strong>: "photograph", "oil painting", "digital art"</li>
<li><strong>Lighting</strong>: "golden hour", "dramatic lighting", "soft light"</li>
<li><strong>Camera/Lens</strong>: "50mm lens", "wide angle", "macro"</li>
</ol>
<h3 id="example-prompts"><a class="header" href="#example-prompts">Example Prompts</a></h3>
<pre><code class="language-python"># Photorealistic
prompt = """
a cinematic photograph of a lone astronaut standing on mars, 
red desert landscape, distant sun on horizon, 
dust particles in air, dramatic lighting, 
shot on ARRI Alexa, anamorphic lens
"""

# Artistic
prompt = """
watercolor painting of a coastal village, 
Mediterranean architecture, boats in harbor, 
soft pastel colors, impressionist style, 
painted by Claude Monet
"""

# Product
prompt = """
professional product photography of a luxury watch, 
silver metal band, blue dial face, 
on marble surface with dramatic side lighting, 
reflections, 8k resolution, advertising quality
"""

# Character
prompt = """
character design of a cyberpunk hacker, 
purple mohawk, neon goggles, leather jacket with patches, 
detailed facial features, full body illustration, 
concept art style, trending on artstation
"""

# Architecture
prompt = """
modern minimalist house in forest setting, 
large glass windows, wooden exterior, 
surrounded by tall pine trees, morning mist, 
architectural photography, professional real estate photo
"""
</code></pre>
<h2 id="parameters-2"><a class="header" href="#parameters-2">Parameters</a></h2>
<h3 id="num_inference_steps"><a class="header" href="#num_inference_steps">num_inference_steps</a></h3>
<p>Number of denoising steps:</p>
<pre><code class="language-python"># Schnell: 1-4 steps (optimized for speed)
image = pipe(prompt, num_inference_steps=4).images[0]

# Dev: 20-50 steps (balance)
image = pipe(prompt, num_inference_steps=30).images[0]

# Pro: API manages automatically
</code></pre>
<p><strong>Recommendations:</strong></p>
<ul>
<li>Schnell: 1-4 (4 recommended)</li>
<li>Dev: 20-30 (30 recommended)</li>
<li>More steps = better quality but slower</li>
</ul>
<h3 id="guidance_scale"><a class="header" href="#guidance_scale">guidance_scale</a></h3>
<p>How closely to follow the prompt:</p>
<pre><code class="language-python"># Schnell: 0.0 (no guidance needed)
image = pipe(prompt, guidance_scale=0.0).images[0]

# Dev: 3.0-5.0 (3.5 recommended)
image = pipe(prompt, guidance_scale=3.5).images[0]
</code></pre>
<p><strong>Flux uses lower guidance than SD:</strong></p>
<ul>
<li>SD typical: 7-10</li>
<li>Flux typical: 3-5</li>
</ul>
<h3 id="max_sequence_length"><a class="header" href="#max_sequence_length">max_sequence_length</a></h3>
<p>Token limit for prompt:</p>
<pre><code class="language-python"># Standard
image = pipe(prompt, max_sequence_length=256).images[0]

# Long prompts
image = pipe(prompt, max_sequence_length=512).images[0]
</code></pre>
<h3 id="resolution-1"><a class="header" href="#resolution-1">Resolution</a></h3>
<pre><code class="language-python"># Standard resolutions (in pixels)
resolutions = {
    "square": (1024, 1024),
    "portrait": (768, 1344),
    "landscape": (1344, 768),
    "wide": (1536, 640),
    "tall": (640, 1536),
}

# Use
image = pipe(
    prompt,
    height=resolutions["landscape"][0],
    width=resolutions["landscape"][1]
).images[0]
</code></pre>
<p><strong>Notes:</strong></p>
<ul>
<li>Keep dimensions divisible by 16</li>
<li>Total pixels should be ~1MP for best results</li>
<li>Higher resolutions need more VRAM</li>
</ul>
<h2 id="comparison-with-other-models"><a class="header" href="#comparison-with-other-models">Comparison with Other Models</a></h2>
<h3 id="flux1-vs-stable-diffusion"><a class="header" href="#flux1-vs-stable-diffusion">Flux.1 vs Stable Diffusion</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Feature</th><th>Flux.1</th><th>SD 1.5</th><th>SDXL</th></tr></thead><tbody>
<tr><td>Image Quality</td><td>⭐⭐⭐⭐⭐</td><td>⭐⭐⭐</td><td>⭐⭐⭐⭐</td></tr>
<tr><td>Prompt Adherence</td><td>⭐⭐⭐⭐⭐</td><td>⭐⭐⭐</td><td>⭐⭐⭐⭐</td></tr>
<tr><td>Text Rendering</td><td>⭐⭐⭐⭐⭐</td><td>⭐</td><td>⭐⭐</td></tr>
<tr><td>Speed (Dev)</td><td>⭐⭐⭐</td><td>⭐⭐⭐⭐</td><td>⭐⭐⭐</td></tr>
<tr><td>Speed (Schnell)</td><td>⭐⭐⭐⭐⭐</td><td>⭐⭐⭐⭐</td><td>⭐⭐⭐</td></tr>
<tr><td>VRAM Usage</td><td>⭐⭐</td><td>⭐⭐⭐⭐⭐</td><td>⭐⭐⭐</td></tr>
<tr><td>Ecosystem</td><td>⭐⭐</td><td>⭐⭐⭐⭐⭐</td><td>⭐⭐⭐⭐</td></tr>
<tr><td>License</td><td>Varies</td><td>Open</td><td>Open</td></tr>
</tbody></table>
</div>
<h3 id="quality-comparison"><a class="header" href="#quality-comparison">Quality Comparison</a></h3>
<pre><code class="language-python"># Same prompt across models
prompt = "a detailed portrait of a person with glasses"

# Flux.1 Dev
flux_image = flux_pipe(prompt, num_inference_steps=30).images[0]
# Result: High detail, accurate glasses, natural lighting

# SDXL
sdxl_image = sdxl_pipe(prompt, num_inference_steps=30).images[0]
# Result: Good quality, some artifacts

# SD 1.5
sd15_image = sd15_pipe(prompt, num_inference_steps=30).images[0]
# Result: Lower quality, potential distortions
</code></pre>
<h3 id="strengths-of-flux1"><a class="header" href="#strengths-of-flux1">Strengths of Flux.1</a></h3>
<ol>
<li><strong>Superior Detail</strong>: Finer details in textures, faces, objects</li>
<li><strong>Better Composition</strong>: More coherent scene layouts</li>
<li><strong>Text Rendering</strong>: Can actually render readable text</li>
<li><strong>Prompt Understanding</strong>: Better interpretation of complex prompts</li>
<li><strong>Natural Images</strong>: More photorealistic when requested</li>
</ol>
<h3 id="strengths-of-stable-diffusion"><a class="header" href="#strengths-of-stable-diffusion">Strengths of Stable Diffusion</a></h3>
<ol>
<li><strong>Ecosystem</strong>: Vast library of models, LoRAs, tools</li>
<li><strong>VRAM Efficiency</strong>: Runs on lower-end hardware</li>
<li><strong>Community</strong>: Large community, extensive documentation</li>
<li><strong>Extensions</strong>: ControlNet, regional prompting, etc.</li>
<li><strong>Customization</strong>: Easy to fine-tune and merge</li>
</ol>
<h3 id="when-to-use-each"><a class="header" href="#when-to-use-each">When to Use Each</a></h3>
<p><strong>Use Flux.1 when:</strong></p>
<ul>
<li>Maximum quality is priority</li>
<li>Need text in images</li>
<li>Want natural, detailed results</li>
<li>Have adequate hardware</li>
<li>Creating professional content</li>
</ul>
<p><strong>Use Stable Diffusion when:</strong></p>
<ul>
<li>Need specific styles (anime, etc.)</li>
<li>Want to use LoRAs/embeddings</li>
<li>Limited VRAM (&lt;12GB)</li>
<li>Need extensive control (ControlNet)</li>
<li>Large existing workflow</li>
</ul>
<h2 id="advanced-techniques-4"><a class="header" href="#advanced-techniques-4">Advanced Techniques</a></h2>
<h3 id="image-to-image-via-diffusers"><a class="header" href="#image-to-image-via-diffusers">Image-to-Image (via Diffusers)</a></h3>
<pre><code class="language-python">from diffusers import FluxImg2ImgPipeline
from PIL import Image

# Load pipeline
pipe = FluxImg2ImgPipeline.from_pretrained(
    "black-forest-labs/FLUX.1-dev",
    torch_dtype=torch.bfloat16
)
pipe.to("cuda")

# Load input image
init_image = Image.open("input.jpg").convert("RGB")

# Transform
prompt = "transform into an oil painting, artistic style"
image = pipe(
    prompt=prompt,
    image=init_image,
    strength=0.75,
    num_inference_steps=30,
    guidance_scale=3.5
).images[0]
</code></pre>
<h3 id="controlnet-via-third-party"><a class="header" href="#controlnet-via-third-party">ControlNet (via third-party)</a></h3>
<pre><code class="language-python"># Note: Official ControlNet not yet released
# Community implementations available

# Example with X-Labs implementation
from flux_control import FluxControlNetPipeline

pipe = FluxControlNetPipeline.from_pretrained(
    "XLabs-AI/flux-controlnet-canny",
    torch_dtype=torch.bfloat16
)

# Use canny edge detection
control_image = generate_canny(input_image)
output = pipe(prompt, control_image=control_image).images[0]
</code></pre>
<h3 id="lora-fine-tuning"><a class="header" href="#lora-fine-tuning">LoRA Fine-tuning</a></h3>
<pre><code class="language-python">from diffusers import FluxPipeline

pipe = FluxPipeline.from_pretrained(
    "black-forest-labs/FLUX.1-dev",
    torch_dtype=torch.bfloat16
)

# Load LoRA (when available)
pipe.load_lora_weights("path/to/flux-lora.safetensors")

# Generate with LoRA style
prompt = "a portrait in the custom style"
image = pipe(prompt).images[0]
</code></pre>
<h3 id="batching-for-efficiency"><a class="header" href="#batching-for-efficiency">Batching for Efficiency</a></h3>
<pre><code class="language-python"># Generate multiple variations
prompts = [
    "a red car",
    "a blue car",
    "a green car",
    "a yellow car"
]

images = []
for prompt in prompts:
    image = pipe(prompt, num_inference_steps=30).images[0]
    images.append(image)
    
# Or use batch processing if memory allows
</code></pre>
<h2 id="optimization-4"><a class="header" href="#optimization-4">Optimization</a></h2>
<h3 id="memory-optimization-1"><a class="header" href="#memory-optimization-1">Memory Optimization</a></h3>
<pre><code class="language-python">from diffusers import FluxPipeline
import torch

pipe = FluxPipeline.from_pretrained(
    "black-forest-labs/FLUX.1-schnell",
    torch_dtype=torch.bfloat16
)

# Enable CPU offloading
pipe.enable_model_cpu_offload()

# Enable VAE optimizations
pipe.vae.enable_slicing()
pipe.vae.enable_tiling()

# For extreme memory savings
pipe.enable_sequential_cpu_offload()
</code></pre>
<h3 id="speed-optimization-1"><a class="header" href="#speed-optimization-1">Speed Optimization</a></h3>
<pre><code class="language-python"># Use Schnell for speed
pipe_schnell = FluxPipeline.from_pretrained(
    "black-forest-labs/FLUX.1-schnell",
    torch_dtype=torch.bfloat16
)

# Compile for faster inference (PyTorch 2.0+)
pipe.unet = torch.compile(pipe.unet, mode="reduce-overhead")

# Use fewer steps
image = pipe_schnell(prompt, num_inference_steps=4).images[0]
</code></pre>
<h3 id="quantization-1"><a class="header" href="#quantization-1">Quantization</a></h3>
<pre><code class="language-python"># 8-bit quantization
from transformers import BitsAndBytesConfig

quantization_config = BitsAndBytesConfig(
    load_in_8bit=True,
    bnb_4bit_compute_dtype=torch.bfloat16
)

pipe = FluxPipeline.from_pretrained(
    "black-forest-labs/FLUX.1-dev",
    quantization_config=quantization_config,
    torch_dtype=torch.bfloat16
)
</code></pre>
<h3 id="multi-gpu"><a class="header" href="#multi-gpu">Multi-GPU</a></h3>
<pre><code class="language-python"># Distribute across GPUs
from accelerate import PartialState

pipe = FluxPipeline.from_pretrained(
    "black-forest-labs/FLUX.1-dev",
    torch_dtype=torch.bfloat16
)

distributed_state = PartialState()
pipe.to(distributed_state.device)
</code></pre>
<h2 id="api-usage-flux-pro"><a class="header" href="#api-usage-flux-pro">API Usage (Flux Pro)</a></h2>
<h3 id="rest-api"><a class="header" href="#rest-api">REST API</a></h3>
<pre><code class="language-python">import requests
import base64
from io import BytesIO
from PIL import Image

API_URL = "https://api.bfl.ml/v1/flux-pro"
API_KEY = "your-api-key"

def generate_flux_pro(
    prompt,
    width=1024,
    height=1024,
    steps=30,
    guidance=3.5
):
    headers = {
        "Authorization": f"Bearer {API_KEY}",
        "Content-Type": "application/json"
    }
    
    payload = {
        "prompt": prompt,
        "width": width,
        "height": height,
        "steps": steps,
        "guidance": guidance
    }
    
    response = requests.post(API_URL, json=payload, headers=headers)
    
    if response.status_code == 200:
        image_data = response.json()["image"]
        image = Image.open(BytesIO(base64.b64decode(image_data)))
        return image
    else:
        raise Exception(f"API Error: {response.text}")

# Generate
image = generate_flux_pro(
    "a beautiful sunset over mountains",
    width=1344,
    height=768
)
image.save("pro_output.png")
</code></pre>
<h3 id="async-api"><a class="header" href="#async-api">Async API</a></h3>
<pre><code class="language-python">import asyncio
import aiohttp

async def generate_async(prompt):
    async with aiohttp.ClientSession() as session:
        headers = {"Authorization": f"Bearer {API_KEY}"}
        payload = {"prompt": prompt}
        
        async with session.post(API_URL, json=payload, headers=headers) as resp:
            return await resp.json()

# Use
image_data = asyncio.run(generate_async("a futuristic city"))
</code></pre>
<h2 id="tips--best-practices"><a class="header" href="#tips--best-practices">Tips &amp; Best Practices</a></h2>
<h3 id="1-prompt-quality"><a class="header" href="#1-prompt-quality">1. Prompt Quality</a></h3>
<pre><code class="language-python"># Good prompts for Flux
good_prompts = [
    "a cinematic photograph of [subject], [details], [lighting], [camera]",
    "an oil painting of [scene], [style], by [artist]",
    "product photography of [item], [background], professional lighting",
    "character design of [character], [details], concept art"
]
</code></pre>
<h3 id="2-iteration-strategy"><a class="header" href="#2-iteration-strategy">2. Iteration Strategy</a></h3>
<pre><code class="language-python"># Start with Schnell for quick iterations
quick_pipe = FluxPipeline.from_pretrained(
    "black-forest-labs/FLUX.1-schnell",
    torch_dtype=torch.bfloat16
)

# Iterate quickly
for variation in range(5):
    gen = torch.Generator("cuda").manual_seed(variation)
    preview = quick_pipe(
        prompt,
        num_inference_steps=4,
        generator=gen
    ).images[0]
    preview.save(f"preview_{variation}.png")

# Refine winner with Dev
final = dev_pipe(
    final_prompt,
    num_inference_steps=30,
    generator=torch.Generator("cuda").manual_seed(winning_seed)
).images[0]
</code></pre>
<h3 id="3-vram-management"><a class="header" href="#3-vram-management">3. VRAM Management</a></h3>
<pre><code class="language-python"># Monitor VRAM
import torch

print(f"Allocated: {torch.cuda.memory_allocated() / 1e9:.2f} GB")
print(f"Reserved: {torch.cuda.memory_reserved() / 1e9:.2f} GB")

# Clear cache between generations
torch.cuda.empty_cache()
</code></pre>
<h3 id="4-prompt-templates"><a class="header" href="#4-prompt-templates">4. Prompt Templates</a></h3>
<pre><code class="language-python">templates = {
    "portrait": "{subject}, {expression}, {clothing}, {background}, portrait photography, {lighting}",
    "landscape": "{location}, {time_of_day}, {weather}, {style}, landscape photography",
    "product": "product photography of {product}, {surface}, {lighting}, professional, commercial",
    "artistic": "{style} of {subject}, {details}, by {artist}, masterpiece"
}

# Use
prompt = templates["portrait"].format(
    subject="a young woman",
    expression="slight smile",
    clothing="elegant dress",
    background="bokeh lights",
    lighting="soft natural light"
)
</code></pre>
<h2 id="resources-26"><a class="header" href="#resources-26">Resources</a></h2>
<h3 id="official-1"><a class="header" href="#official-1">Official</a></h3>
<ul>
<li><a href="https://blackforestlabs.ai/">Black Forest Labs Website</a></li>
<li><a href="https://huggingface.co/black-forest-labs">Hugging Face Models</a></li>
<li><a href="https://docs.bfl.ml/">API Documentation</a></li>
</ul>
<h3 id="community-3"><a class="header" href="#community-3">Community</a></h3>
<ul>
<li>r/FluxAI</li>
<li>Hugging Face Discussions</li>
<li>Discord communities</li>
</ul>
<h3 id="tools-4"><a class="header" href="#tools-4">Tools</a></h3>
<ul>
<li><a href="https://github.com/XLabs-AI/x-flux-comfyui">ComfyUI Flux Nodes</a></li>
<li><a href="https://github.com/huggingface/diffusers">Diffusers Integration</a></li>
</ul>
<h3 id="learning-2"><a class="header" href="#learning-2">Learning</a></h3>
<ul>
<li><a href="https://blackforestlabs.ai/announcing-flux-1/">Flux.1 Paper</a></li>
<li>Comparison benchmarks</li>
<li>Community prompts</li>
</ul>
<h2 id="conclusion-19"><a class="header" href="#conclusion-19">Conclusion</a></h2>
<p>Flux.1 represents a significant leap in image generation quality. While it requires more resources than Stable Diffusion, the results are often worth it for professional applications. The Schnell variant offers excellent speed-to-quality ratio, while Dev provides maximum quality for local generation.</p>
<p>Key takeaways:</p>
<ul>
<li><strong>Schnell</strong>: Fast, commercial-friendly, good quality</li>
<li><strong>Dev</strong>: Best local quality, non-commercial</li>
<li><strong>Pro</strong>: Highest quality, API-only, commercial</li>
</ul>
<p>Choose based on your needs, hardware, and use case. Experiment with natural language prompts and leverage Flux's superior understanding for best results.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="comfyui"><a class="header" href="#comfyui">ComfyUI</a></h1>
<p>https://github.com/comfyanonymous/ComfyUI</p>
<p>https://docs.comfy.org/get_started/manual_install</p>
<p>git clone https://github.com/comfyanonymous/ComfyUI.git
https://comfyui-wiki.com/tutorial/advanced/flux1-comfyui-guide-workflow-and-examples</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="fine-tuning-2"><a class="header" href="#fine-tuning-2">Fine-Tuning</a></h1>
<p>Fine-tuning is the process of taking a pre-trained model and further training it on a specific task or dataset.</p>
<h2 id="overview-50"><a class="header" href="#overview-50">Overview</a></h2>
<p>Fine-tuning adapts a general-purpose model to a specific domain or task with much less data and compute than training from scratch.</p>
<p><strong>Approaches:</strong></p>
<ul>
<li>Full fine-tuning: Update all parameters</li>
<li>Parameter-efficient: Update subset (LoRA, adapters)</li>
<li>Few-shot prompting: No parameter updates</li>
</ul>
<h2 id="when-to-fine-tune"><a class="header" href="#when-to-fine-tune">When to Fine-Tune</a></h2>
<p>✅ <strong>Good use cases:</strong></p>
<ul>
<li>Domain-specific language (medical, legal)</li>
<li>Specific output format requirements</li>
<li>Improved performance on narrow tasks</li>
<li>Style adaptation</li>
</ul>
<p>❌ <strong>Bad use cases:</strong></p>
<ul>
<li>General knowledge (use prompting)</li>
<li>Limited data (&lt; 100 examples)</li>
<li>When prompting works well enough</li>
</ul>
<h2 id="fine-tuning-process"><a class="header" href="#fine-tuning-process">Fine-Tuning Process</a></h2>
<pre><code class="language-python"># Example with Hugging Face
from transformers import AutoModelForCausalLM, AutoTokenizer, Trainer

# 1. Load pre-trained model
model = AutoModelForCausalLM.from_pretrained("gpt2")
tokenizer = AutoTokenizer.from_pretrained("gpt2")

# 2. Prepare dataset
train_dataset = load_dataset("your_dataset")

# 3. Configure training
training_args = TrainingArguments(
    output_dir="./results",
    num_train_epochs=3,
    per_device_train_batch_size=4,
    learning_rate=2e-5,
)

# 4. Train
trainer = Trainer(
    model=model,
    args=training_args,
    train_dataset=train_dataset,
)

trainer.train()
</code></pre>
<h2 id="lora-low-rank-adaptation-3"><a class="header" href="#lora-low-rank-adaptation-3">LoRA (Low-Rank Adaptation)</a></h2>
<pre><code class="language-python">from peft import LoraConfig, get_peft_model

# Configure LoRA
config = LoraConfig(
    r=8,                    # Rank
    lora_alpha=32,
    target_modules=["q_proj", "v_proj"],
    lora_dropout=0.1,
)

# Apply LoRA to model
model = get_peft_model(model, config)
model.print_trainable_parameters()
# trainable params: 0.1% (vs 100% for full fine-tuning)
</code></pre>
<h2 id="data-preparation"><a class="header" href="#data-preparation">Data Preparation</a></h2>
<pre><code class="language-jsonl">{"prompt": "Translate to French: Hello", "completion": "Bonjour"}
{"prompt": "Translate to French: Goodbye", "completion": "Au revoir"}
{"prompt": "Translate to French: Thank you", "completion": "Merci"}
</code></pre>
<h2 id="best-practices-41"><a class="header" href="#best-practices-41">Best Practices</a></h2>
<ol>
<li><strong>Start with quality data</strong>: 100-1000 high-quality examples</li>
<li><strong>Use parameter-efficient methods</strong>: LoRA for large models</li>
<li><strong>Monitor overfitting</strong>: Validate on held-out data</li>
<li><strong>Experiment with hyperparameters</strong>: Learning rate, batch size</li>
<li><strong>Evaluate systematically</strong>: Don't just rely on loss</li>
<li><strong>Consider data augmentation</strong>: Increase training data</li>
<li><strong>Version control</strong>: Track model versions and data</li>
</ol>
<h2 id="evaluation"><a class="header" href="#evaluation">Evaluation</a></h2>
<pre><code class="language-python">from sklearn.metrics import accuracy_score

predictions = model.generate(test_inputs)
accuracy = accuracy_score(test_labels, predictions)
print(f"Accuracy: {accuracy}")
</code></pre>
<p>Fine-tuning enables customization of powerful pre-trained models for specific applications with minimal resources.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cloud-computing-overview"><a class="header" href="#cloud-computing-overview">Cloud Computing Overview</a></h1>
<h2 id="table-of-contents-30"><a class="header" href="#table-of-contents-30">Table of Contents</a></h2>
<ul>
<li><a href="cloud/index.html#introduction">Introduction</a></li>
<li><a href="cloud/index.html#cloud-service-models">Cloud Service Models</a></li>
<li><a href="cloud/index.html#cloud-deployment-models">Cloud Deployment Models</a></li>
<li><a href="cloud/index.html#major-cloud-providers">Major Cloud Providers</a></li>
<li><a href="cloud/index.html#common-cloud-services">Common Cloud Services</a></li>
<li><a href="cloud/index.html#cloud-architecture-patterns">Cloud Architecture Patterns</a></li>
<li><a href="cloud/index.html#cost-optimization">Cost Optimization</a></li>
<li><a href="cloud/index.html#security-best-practices">Security Best Practices</a></li>
<li><a href="cloud/index.html#choosing-a-cloud-provider">Choosing a Cloud Provider</a></li>
</ul>
<h2 id="introduction-12"><a class="header" href="#introduction-12">Introduction</a></h2>
<p>Cloud computing is the delivery of computing services—including servers, storage, databases, networking, software, analytics, and intelligence—over the Internet ("the cloud") to offer faster innovation, flexible resources, and economies of scale.</p>
<h3 id="key-benefits"><a class="header" href="#key-benefits">Key Benefits</a></h3>
<ul>
<li><strong>Cost Savings</strong>: Pay only for what you use (OpEx vs CapEx)</li>
<li><strong>Scalability</strong>: Scale up or down based on demand</li>
<li><strong>Performance</strong>: Access to latest hardware and global infrastructure</li>
<li><strong>Speed</strong>: Deploy resources in minutes</li>
<li><strong>Reliability</strong>: Data backup, disaster recovery, business continuity</li>
<li><strong>Security</strong>: Enterprise-grade security features</li>
</ul>
<h2 id="cloud-service-models"><a class="header" href="#cloud-service-models">Cloud Service Models</a></h2>
<pre><code>┌─────────────────────────────────────────────────────────────┐
│                     Cloud Service Models                     │
├─────────────────────────────────────────────────────────────┤
│                                                               │
│  IaaS (Infrastructure as a Service)                          │
│  ├─ You Manage: Applications, Data, Runtime, Middleware, OS │
│  └─ Provider Manages: Virtualization, Servers, Storage, Net │
│                                                               │
│  PaaS (Platform as a Service)                                │
│  ├─ You Manage: Applications, Data                          │
│  └─ Provider Manages: Runtime, Middleware, OS, Infra        │
│                                                               │
│  SaaS (Software as a Service)                                │
│  ├─ You Manage: Data/Configuration                          │
│  └─ Provider Manages: Everything else                       │
│                                                               │
│  FaaS (Function as a Service / Serverless)                   │
│  ├─ You Manage: Code/Functions                              │
│  └─ Provider Manages: Everything else + Auto-scaling        │
└─────────────────────────────────────────────────────────────┘
</code></pre>
<h3 id="iaas---infrastructure-as-a-service"><a class="header" href="#iaas---infrastructure-as-a-service">IaaS - Infrastructure as a Service</a></h3>
<p><strong>Examples</strong>: AWS EC2, Azure VMs, Google Compute Engine</p>
<p><strong>Use Cases</strong>:</p>
<ul>
<li>Hosting websites and web applications</li>
<li>High-performance computing</li>
<li>Big data analysis</li>
<li>Backup and recovery</li>
</ul>
<p><strong>Control Level</strong>: High
<strong>Management Overhead</strong>: High</p>
<h3 id="paas---platform-as-a-service"><a class="header" href="#paas---platform-as-a-service">PaaS - Platform as a Service</a></h3>
<p><strong>Examples</strong>: AWS Elastic Beanstalk, Azure App Service, Google App Engine</p>
<p><strong>Use Cases</strong>:</p>
<ul>
<li>Application development and deployment</li>
<li>API development and management</li>
<li>Business analytics/intelligence</li>
</ul>
<p><strong>Control Level</strong>: Medium
<strong>Management Overhead</strong>: Medium</p>
<h3 id="saas---software-as-a-service"><a class="header" href="#saas---software-as-a-service">SaaS - Software as a Service</a></h3>
<p><strong>Examples</strong>: Gmail, Office 365, Salesforce, Dropbox</p>
<p><strong>Use Cases</strong>:</p>
<ul>
<li>Email and collaboration</li>
<li>CRM and ERP systems</li>
<li>Productivity applications</li>
</ul>
<p><strong>Control Level</strong>: Low
<strong>Management Overhead</strong>: Low</p>
<h3 id="faas---function-as-a-service"><a class="header" href="#faas---function-as-a-service">FaaS - Function as a Service</a></h3>
<p><strong>Examples</strong>: AWS Lambda, Azure Functions, Google Cloud Functions</p>
<p><strong>Use Cases</strong>:</p>
<ul>
<li>Event-driven applications</li>
<li>Real-time file processing</li>
<li>Scheduled tasks</li>
<li>Microservices</li>
</ul>
<p><strong>Control Level</strong>: Low (code only)
<strong>Management Overhead</strong>: Very Low</p>
<h2 id="cloud-deployment-models"><a class="header" href="#cloud-deployment-models">Cloud Deployment Models</a></h2>
<h3 id="public-cloud"><a class="header" href="#public-cloud">Public Cloud</a></h3>
<ul>
<li>Resources owned and operated by third-party provider</li>
<li>Services delivered over the internet</li>
<li>Examples: AWS, Azure, GCP</li>
</ul>
<p><strong>Pros</strong>: Cost-effective, scalable, no maintenance
<strong>Cons</strong>: Less control, potential security concerns</p>
<h3 id="private-cloud"><a class="header" href="#private-cloud">Private Cloud</a></h3>
<ul>
<li>Infrastructure used exclusively by a single organization</li>
<li>Can be hosted on-premises or by third party</li>
</ul>
<p><strong>Pros</strong>: More control, enhanced security, compliance
<strong>Cons</strong>: Higher cost, maintenance overhead</p>
<h3 id="hybrid-cloud"><a class="header" href="#hybrid-cloud">Hybrid Cloud</a></h3>
<ul>
<li>Combination of public and private clouds</li>
<li>Data and applications shared between them</li>
</ul>
<p><strong>Pros</strong>: Flexibility, cost optimization, compliance options
<strong>Cons</strong>: Complexity, integration challenges</p>
<h3 id="multi-cloud"><a class="header" href="#multi-cloud">Multi-Cloud</a></h3>
<ul>
<li>Using multiple cloud providers simultaneously</li>
<li>Avoid vendor lock-in</li>
</ul>
<p><strong>Pros</strong>: Best-of-breed services, redundancy
<strong>Cons</strong>: Increased complexity, management overhead</p>
<h2 id="major-cloud-providers"><a class="header" href="#major-cloud-providers">Major Cloud Providers</a></h2>
<h3 id="comparison-matrix"><a class="header" href="#comparison-matrix">Comparison Matrix</a></h3>
<pre><code>┌────────────────┬──────────────┬──────────────┬──────────────┐
│ Feature        │ AWS          │ Azure        │ GCP          │
├────────────────┼──────────────┼──────────────┼──────────────┤
│ Market Share   │ ~32%         │ ~23%         │ ~10%         │
│ Launch Year    │ 2006         │ 2010         │ 2008         │
│ Regions        │ 30+          │ 60+          │ 35+          │
│ Services       │ 200+         │ 200+         │ 100+         │
│ Strengths      │ Maturity     │ Enterprise   │ ML/Data      │
│                │ Breadth      │ Integration  │ Analytics    │
│ Best For       │ Startups     │ .NET/Windows │ Big Data     │
│                │ Flexibility  │ Hybrid       │ ML/AI        │
└────────────────┴──────────────┴──────────────┴──────────────┘
</code></pre>
<h3 id="aws-amazon-web-services"><a class="header" href="#aws-amazon-web-services">AWS (Amazon Web Services)</a></h3>
<ul>
<li><strong>Founded</strong>: 2006</li>
<li><strong>Market Leader</strong>: Largest market share</li>
<li><strong>Strengths</strong>: Broad service portfolio, mature ecosystem, extensive documentation</li>
<li><strong>Popular Services</strong>: EC2, S3, Lambda, RDS, DynamoDB</li>
</ul>
<h3 id="microsoft-azure"><a class="header" href="#microsoft-azure">Microsoft Azure</a></h3>
<ul>
<li><strong>Founded</strong>: 2010</li>
<li><strong>Second Largest</strong>: Strong enterprise presence</li>
<li><strong>Strengths</strong>: Hybrid cloud, Windows/Microsoft integration, Active Directory</li>
<li><strong>Popular Services</strong>: Virtual Machines, Blob Storage, Azure Functions, SQL Database</li>
</ul>
<h3 id="google-cloud-platform-gcp"><a class="header" href="#google-cloud-platform-gcp">Google Cloud Platform (GCP)</a></h3>
<ul>
<li><strong>Founded</strong>: 2008</li>
<li><strong>Third Largest</strong>: Growing rapidly</li>
<li><strong>Strengths</strong>: Data analytics, machine learning, Kubernetes (GKE)</li>
<li><strong>Popular Services</strong>: Compute Engine, Cloud Storage, BigQuery, Cloud Functions</li>
</ul>
<h3 id="other-providers"><a class="header" href="#other-providers">Other Providers</a></h3>
<ul>
<li><strong>IBM Cloud</strong>: Enterprise focus, AI (Watson)</li>
<li><strong>Oracle Cloud</strong>: Database workloads</li>
<li><strong>Alibaba Cloud</strong>: Asia-Pacific region</li>
<li><strong>DigitalOcean</strong>: Simple, developer-friendly</li>
</ul>
<h2 id="common-cloud-services"><a class="header" href="#common-cloud-services">Common Cloud Services</a></h2>
<h3 id="compute-services"><a class="header" href="#compute-services">Compute Services</a></h3>
<pre><code>Service Type          AWS                Azure              GCP
─────────────────────────────────────────────────────────────
Virtual Machines      EC2                Virtual Machines   Compute Engine
Containers            ECS/EKS/Fargate    Container Inst.    GKE/Cloud Run
Serverless           Lambda              Functions          Cloud Functions
Auto Scaling         Auto Scaling        VM Scale Sets      Autoscaler
</code></pre>
<h3 id="storage-services"><a class="header" href="#storage-services">Storage Services</a></h3>
<pre><code>Service Type          AWS                Azure              GCP
─────────────────────────────────────────────────────────────
Object Storage       S3                  Blob Storage       Cloud Storage
Block Storage        EBS                 Disk Storage       Persistent Disk
File Storage         EFS                 Files              Filestore
Archive              Glacier             Archive Storage    Archive Storage
</code></pre>
<h3 id="database-services"><a class="header" href="#database-services">Database Services</a></h3>
<pre><code>Service Type          AWS                Azure              GCP
─────────────────────────────────────────────────────────────
Relational DB        RDS                 SQL Database       Cloud SQL
NoSQL Document       DocumentDB          Cosmos DB          Firestore
NoSQL Key-Value      DynamoDB            Table Storage      Datastore
In-Memory Cache      ElastiCache         Cache for Redis    Memorystore
Data Warehouse       Redshift            Synapse Analytics  BigQuery
</code></pre>
<h3 id="networking-services"><a class="header" href="#networking-services">Networking Services</a></h3>
<pre><code>Service Type          AWS                Azure              GCP
─────────────────────────────────────────────────────────────
Virtual Network      VPC                 Virtual Network    VPC
Load Balancer        ELB/ALB             Load Balancer      Cloud Load Bal.
CDN                  CloudFront          CDN                Cloud CDN
DNS                  Route 53            DNS                Cloud DNS
VPN                  VPN Gateway         VPN Gateway        Cloud VPN
</code></pre>
<h2 id="cloud-architecture-patterns"><a class="header" href="#cloud-architecture-patterns">Cloud Architecture Patterns</a></h2>
<h3 id="1-multi-tier-architecture"><a class="header" href="#1-multi-tier-architecture">1. Multi-Tier Architecture</a></h3>
<pre><code>                         ┌─────────────────┐
                         │  Load Balancer  │
                         └────────┬────────┘
                                  │
              ┌───────────────────┼───────────────────┐
              │                   │                   │
         ┌────▼────┐         ┌────▼────┐       ┌────▼────┐
         │  Web    │         │  Web    │       │  Web    │
         │ Server  │         │ Server  │       │ Server  │
         └────┬────┘         └────┬────┘       └────┬────┘
              │                   │                  │
              └───────────────────┼──────────────────┘
                                  │
                         ┌────────▼────────┐
                         │  App Tier       │
                         │  (Business      │
                         │   Logic)        │
                         └────────┬────────┘
                                  │
                         ┌────────▼────────┐
                         │  Database Tier  │
                         │  (Primary +     │
                         │   Replica)      │
                         └─────────────────┘
</code></pre>
<h3 id="2-microservices-architecture"><a class="header" href="#2-microservices-architecture">2. Microservices Architecture</a></h3>
<pre><code>┌─────────┐    ┌──────────────────────────────────────────┐
│ API     │───▶│           API Gateway                    │
│ Client  │    └──────────┬───────────────────────────────┘
└─────────┘               │
                          │
        ┌─────────────────┼─────────────────┬─────────────┐
        │                 │                 │             │
   ┌────▼─────┐     ┌────▼─────┐     ┌────▼─────┐  ┌────▼─────┐
   │ User     │     │ Product  │     │ Order    │  │ Payment  │
   │ Service  │     │ Service  │     │ Service  │  │ Service  │
   └────┬─────┘     └────┬─────┘     └────┬─────┘  └────┬─────┘
        │                │                │             │
   ┌────▼─────┐     ┌────▼─────┐     ┌────▼─────┐  ┌────▼─────┐
   │ User DB  │     │Product DB│     │ Order DB │  │Payment DB│
   └──────────┘     └──────────┘     └──────────┘  └──────────┘
</code></pre>
<h3 id="3-event-driven-architecture"><a class="header" href="#3-event-driven-architecture">3. Event-Driven Architecture</a></h3>
<pre><code>┌──────────┐      ┌──────────────┐      ┌──────────────┐
│ Producer │─────▶│ Message      │─────▶│  Consumer 1  │
│ Service  │      │ Queue/Topic  │      └──────────────┘
└──────────┘      │ (SQS/SNS/    │      ┌──────────────┐
                  │  EventBridge)│─────▶│  Consumer 2  │
                  └──────────────┘      └──────────────┘
                         │              ┌──────────────┐
                         └─────────────▶│  Consumer 3  │
                                        └──────────────┘
</code></pre>
<h3 id="4-serverless-architecture"><a class="header" href="#4-serverless-architecture">4. Serverless Architecture</a></h3>
<pre><code>┌─────────┐    ┌──────────┐    ┌─────────────┐    ┌──────────┐
│ Client  │───▶│ API      │───▶│  Lambda     │───▶│ Database │
│         │    │ Gateway  │    │  Functions  │    │ (DynamoDB│
└─────────┘    └──────────┘    └─────────────┘    │  /RDS)   │
                                      │            └──────────┘
                                      │
                                      ▼
                               ┌─────────────┐
                               │   Storage   │
                               │    (S3)     │
                               └─────────────┘
</code></pre>
<h2 id="cost-optimization"><a class="header" href="#cost-optimization">Cost Optimization</a></h2>
<h3 id="pricing-models"><a class="header" href="#pricing-models">Pricing Models</a></h3>
<h4 id="1-on-demand"><a class="header" href="#1-on-demand">1. On-Demand</a></h4>
<ul>
<li>Pay for compute capacity by the hour/second</li>
<li>No long-term commitments</li>
<li>Best for: Short-term, unpredictable workloads</li>
</ul>
<h4 id="2-reserved-instances"><a class="header" href="#2-reserved-instances">2. Reserved Instances</a></h4>
<ul>
<li>1 or 3-year commitment</li>
<li>Up to 75% discount vs on-demand</li>
<li>Best for: Steady-state workloads</li>
</ul>
<h4 id="3-spotpreemptible-instances"><a class="header" href="#3-spotpreemptible-instances">3. Spot/Preemptible Instances</a></h4>
<ul>
<li>Up to 90% discount vs on-demand</li>
<li>Can be terminated with short notice</li>
<li>Best for: Batch jobs, fault-tolerant workloads</li>
</ul>
<h4 id="4-savings-plans"><a class="header" href="#4-savings-plans">4. Savings Plans</a></h4>
<ul>
<li>Flexible pricing model</li>
<li>Commitment to consistent usage</li>
<li>Up to 72% discount</li>
</ul>
<h3 id="cost-optimization-strategies"><a class="header" href="#cost-optimization-strategies">Cost Optimization Strategies</a></h3>
<pre><code>┌──────────────────────────────────────────────────────────┐
│ Cost Optimization Best Practices                         │
├──────────────────────────────────────────────────────────┤
│ 1. Right-sizing                                          │
│    └─ Match instance types to actual needs              │
│                                                           │
│ 2. Auto-scaling                                          │
│    └─ Scale resources based on demand                   │
│                                                           │
│ 3. Reserved Instances                                    │
│    └─ Commit to predictable workloads                   │
│                                                           │
│ 4. Spot Instances                                        │
│    └─ Use for fault-tolerant workloads                  │
│                                                           │
│ 5. Storage Lifecycle Policies                           │
│    └─ Move data to cheaper tiers over time              │
│                                                           │
│ 6. Delete Unused Resources                               │
│    └─ Regular audits and cleanup                        │
│                                                           │
│ 7. Use Serverless                                        │
│    └─ Pay only for execution time                       │
│                                                           │
│ 8. Monitor and Alert                                     │
│    └─ Set up cost budgets and alerts                    │
└──────────────────────────────────────────────────────────┘
</code></pre>
<h3 id="monthly-cost-estimation-example"><a class="header" href="#monthly-cost-estimation-example">Monthly Cost Estimation Example</a></h3>
<pre><code>Service              Configuration           Monthly Cost (Approx)
─────────────────────────────────────────────────────────────────
EC2 (t3.medium)      730 hours on-demand    $30
EBS (100 GB)         General Purpose SSD    $10
RDS (db.t3.small)    PostgreSQL, 730 hours  $25
S3 (100 GB)          Standard storage       $2.30
Data Transfer        50 GB outbound         $4.50
                                            ─────────
                     Total:                 ~$72/month
</code></pre>
<h2 id="security-best-practices-4"><a class="header" href="#security-best-practices-4">Security Best Practices</a></h2>
<h3 id="1-identity-and-access-management-iam"><a class="header" href="#1-identity-and-access-management-iam">1. Identity and Access Management (IAM)</a></h3>
<pre><code>Best Practices:
├─ Use principle of least privilege
├─ Enable Multi-Factor Authentication (MFA)
├─ Rotate credentials regularly
├─ Use roles instead of access keys when possible
├─ Implement password policies
└─ Audit permissions regularly
</code></pre>
<h3 id="2-network-security"><a class="header" href="#2-network-security">2. Network Security</a></h3>
<pre><code>┌─────────────────────────────────────────────┐
│              VPC Security                    │
├─────────────────────────────────────────────┤
│                                              │
│  Public Subnet                               │
│  ┌──────────────────────────────────┐       │
│  │  Load Balancer                   │       │
│  │  (Security Group: HTTP/HTTPS)    │       │
│  └──────────────┬───────────────────┘       │
│                 │                            │
│  Private Subnet │                            │
│  ┌──────────────▼───────────────┐           │
│  │  Application Servers         │           │
│  │  (SG: From LB only)          │           │
│  └──────────────┬───────────────┘           │
│                 │                            │
│  Database Subnet│                            │
│  ┌──────────────▼───────────────┐           │
│  │  Database                    │           │
│  │  (SG: From App only)         │           │
│  └──────────────────────────────┘           │
└─────────────────────────────────────────────┘
</code></pre>
<h3 id="3-data-protection"><a class="header" href="#3-data-protection">3. Data Protection</a></h3>
<ul>
<li><strong>Encryption at Rest</strong>: Enable for all storage services</li>
<li><strong>Encryption in Transit</strong>: Use TLS/SSL for all communications</li>
<li><strong>Backup and Recovery</strong>: Regular automated backups</li>
<li><strong>Data Classification</strong>: Tag and classify sensitive data</li>
</ul>
<h3 id="4-monitoring-and-logging"><a class="header" href="#4-monitoring-and-logging">4. Monitoring and Logging</a></h3>
<pre><code>Security Monitoring Stack:
├─ CloudWatch/Azure Monitor - Metrics and logs
├─ CloudTrail/Activity Log - API call auditing
├─ GuardDuty/Defender - Threat detection
├─ Security Hub/Security Center - Compliance
└─ SIEM Integration - Centralized monitoring
</code></pre>
<h3 id="5-compliance"><a class="header" href="#5-compliance">5. Compliance</a></h3>
<p>Common compliance frameworks:</p>
<ul>
<li><strong>GDPR</strong>: European data protection</li>
<li><strong>HIPAA</strong>: Healthcare data</li>
<li><strong>PCI DSS</strong>: Payment card data</li>
<li><strong>SOC 2</strong>: Security and availability</li>
<li><strong>ISO 27001</strong>: Information security</li>
</ul>
<h2 id="choosing-a-cloud-provider"><a class="header" href="#choosing-a-cloud-provider">Choosing a Cloud Provider</a></h2>
<h3 id="decision-matrix"><a class="header" href="#decision-matrix">Decision Matrix</a></h3>
<pre><code>Factor                Weight    AWS    Azure   GCP
─────────────────────────────────────────────────
Existing Ecosystem    High      ★★★★   ★★★★★   ★★★
Services Breadth      High      ★★★★★  ★★★★★   ★★★★
Pricing              Medium     ★★★★   ★★★★    ★★★★★
Documentation        Medium     ★★★★★  ★★★★    ★★★★
Support              Medium     ★★★★   ★★★★★   ★★★
ML/AI Capabilities   Varies     ★★★★   ★★★★    ★★★★★
Kubernetes          Varies     ★★★★   ★★★★    ★★★★★
Global Reach        High       ★★★★★  ★★★★★   ★★★★
</code></pre>
<h3 id="use-case-recommendations"><a class="header" href="#use-case-recommendations">Use Case Recommendations</a></h3>
<p><strong>Choose AWS if</strong>:</p>
<ul>
<li>Need broadest service selection</li>
<li>Want mature ecosystem and tooling</li>
<li>Building greenfield applications</li>
<li>Need strong serverless capabilities</li>
</ul>
<p><strong>Choose Azure if</strong>:</p>
<ul>
<li>Heavy Microsoft/Windows workloads</li>
<li>Need hybrid cloud capabilities</li>
<li>Enterprise Active Directory integration</li>
<li>Existing Microsoft licensing</li>
</ul>
<p><strong>Choose GCP if</strong>:</p>
<ul>
<li>Focus on data analytics and ML</li>
<li>Need best-in-class Kubernetes</li>
<li>Want innovative technologies</li>
<li>Prioritize BigQuery for analytics</li>
</ul>
<p><strong>Use Multi-Cloud if</strong>:</p>
<ul>
<li>Need to avoid vendor lock-in</li>
<li>Want best-of-breed services</li>
<li>Have compliance requirements</li>
<li>Can manage the complexity</li>
</ul>
<h2 id="getting-started-1"><a class="header" href="#getting-started-1">Getting Started</a></h2>
<h3 id="learning-path-1"><a class="header" href="#learning-path-1">Learning Path</a></h3>
<pre><code>1. Fundamentals (1-2 weeks)
   ├─ Cloud concepts and terminology
   ├─ Choose a primary provider
   └─ Complete free tier tutorial

2. Core Services (2-4 weeks)
   ├─ Compute (EC2/VMs)
   ├─ Storage (S3/Blob)
   ├─ Databases (RDS/SQL)
   └─ Networking (VPC)

3. Advanced Topics (4-8 weeks)
   ├─ Security and IAM
   ├─ Monitoring and logging
   ├─ CI/CD pipelines
   └─ Infrastructure as Code

4. Specialization (Ongoing)
   ├─ Serverless
   ├─ Containers and Kubernetes
   ├─ ML/AI services
   └─ Cost optimization
</code></pre>
<h3 id="recommended-certifications"><a class="header" href="#recommended-certifications">Recommended Certifications</a></h3>
<p><strong>AWS</strong>:</p>
<ul>
<li>AWS Certified Solutions Architect - Associate</li>
<li>AWS Certified Developer - Associate</li>
<li>AWS Certified SysOps Administrator</li>
</ul>
<p><strong>Azure</strong>:</p>
<ul>
<li>Azure Fundamentals (AZ-900)</li>
<li>Azure Administrator (AZ-104)</li>
<li>Azure Solutions Architect (AZ-305)</li>
</ul>
<p><strong>GCP</strong>:</p>
<ul>
<li>Google Cloud Digital Leader</li>
<li>Associate Cloud Engineer</li>
<li>Professional Cloud Architect</li>
</ul>
<h2 id="resources-27"><a class="header" href="#resources-27">Resources</a></h2>
<h3 id="free-tiers"><a class="header" href="#free-tiers">Free Tiers</a></h3>
<ul>
<li><strong>AWS</strong>: 12 months free tier + always free services</li>
<li><strong>Azure</strong>: $200 credit for 30 days + always free services</li>
<li><strong>GCP</strong>: $300 credit for 90 days + always free services</li>
</ul>
<h3 id="documentation-4"><a class="header" href="#documentation-4">Documentation</a></h3>
<ul>
<li>AWS: https://docs.aws.amazon.com</li>
<li>Azure: https://docs.microsoft.com/azure</li>
<li>GCP: https://cloud.google.com/docs</li>
</ul>
<h3 id="community-4"><a class="header" href="#community-4">Community</a></h3>
<ul>
<li>AWS: r/aws, AWS Forums</li>
<li>Azure: r/azure, Microsoft Tech Community</li>
<li>GCP: r/googlecloud, Google Cloud Community</li>
</ul>
<h3 id="tools-5"><a class="header" href="#tools-5">Tools</a></h3>
<ul>
<li><strong>Terraform</strong>: Multi-cloud IaC</li>
<li><strong>Ansible</strong>: Configuration management</li>
<li><strong>Kubernetes</strong>: Container orchestration</li>
<li><strong>Prometheus/Grafana</strong>: Monitoring</li>
<li><strong>Cost Management</strong>: CloudHealth, CloudCheckr</li>
</ul>
<hr />
<p><strong>Next Steps</strong>: Choose a cloud provider and explore provider-specific documentation:</p>
<ul>
<li><a href="cloud/./aws.html">AWS Documentation</a></li>
<li><a href="cloud/./azure.html">Azure Documentation</a></li>
<li><a href="cloud/./google_cloud.html">Google Cloud Documentation</a></li>
<li><a href="cloud/./setup.html">Cloud Setup Guide</a> - Getting started with cloud environments</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="setup"><a class="header" href="#setup">Setup</a></h1>
<h2 id="setup-gpu-instances"><a class="header" href="#setup-gpu-instances">Setup GPU instances</a></h2>
<p>Make sure the hardisk size is at least 30GB</p>
<pre><code class="language-bash">curl https://raw.githubusercontent.com/GoogleCloudPlatform/compute-gpu-installation/main/linux/install_gpu_driver.py --output install_gpu_driver.py 

#if required Change driver version in the py file from (DRIVER_VERSION = "525.125.06") to	550.54.15
sed -i 's/525.125.06/550.54.15/' install_gpu_driver.py

#run the script
sudo apt install python3-venv python3-dev
sudo python3 install_gpu_driver.py

#verify the installation
nvidia-smi

#install pytorch
pip3 install torch torchvision torchaudio

#install cuda toolkit
sudo apt install nvidia-cuda-toolkit
nvcc --version
</code></pre>
<p>Swap file</p>
<pre><code class="language-bash">sudo fallocate -l 32G /swapfile
sudo chmod 600 /swapfile
sudo mkswap /swapfile
sudo swapon /swapfile
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="google-cloud"><a class="header" href="#google-cloud">Google Cloud</a></h1>
<p>Image storage (per GB / month) $0.05</p>
<ul>
<li>Custom image storage is based on Archive Size (which will be less).
<ul>
<li>Note: 10G is not enough to install.</li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="amazon-web-services-aws"><a class="header" href="#amazon-web-services-aws">Amazon Web Services (AWS)</a></h1>
<h2 id="table-of-contents-31"><a class="header" href="#table-of-contents-31">Table of Contents</a></h2>
<ul>
<li><a href="cloud/aws.html#introduction">Introduction</a></li>
<li><a href="cloud/aws.html#aws-global-infrastructure">AWS Global Infrastructure</a></li>
<li><a href="cloud/aws.html#getting-started">Getting Started</a></li>
<li><a href="cloud/aws.html#core-compute-services">Core Compute Services</a></li>
<li><a href="cloud/aws.html#storage-services">Storage Services</a></li>
<li><a href="cloud/aws.html#database-services">Database Services</a></li>
<li><a href="cloud/aws.html#networking-services">Networking Services</a></li>
<li><a href="cloud/aws.html#serverless-services">Serverless Services</a></li>
<li><a href="cloud/aws.html#container-services">Container Services</a></li>
<li><a href="cloud/aws.html#security-services">Security Services</a></li>
<li><a href="cloud/aws.html#monitoring-and-management">Monitoring and Management</a></li>
<li><a href="cloud/aws.html#devops-and-cicd">DevOps and CI/CD</a></li>
<li><a href="cloud/aws.html#machine-learning-services">Machine Learning Services</a></li>
<li><a href="cloud/aws.html#architecture-examples">Architecture Examples</a></li>
<li><a href="cloud/aws.html#cost-optimization">Cost Optimization</a></li>
<li><a href="cloud/aws.html#best-practices">Best Practices</a></li>
<li><a href="cloud/aws.html#cli-reference">CLI Reference</a></li>
</ul>
<h2 id="introduction-13"><a class="header" href="#introduction-13">Introduction</a></h2>
<p>Amazon Web Services (AWS) is the world's most comprehensive and broadly adopted cloud platform, offering over 200 fully featured services from data centers globally.</p>
<h3 id="key-advantages"><a class="header" href="#key-advantages">Key Advantages</a></h3>
<ul>
<li><strong>Market Leader</strong>: Largest market share (~32%)</li>
<li><strong>Mature Ecosystem</strong>: Launched in 2006</li>
<li><strong>Service Breadth</strong>: 200+ services</li>
<li><strong>Global Reach</strong>: 30+ regions, 90+ availability zones</li>
<li><strong>Innovation</strong>: Rapid release of new features</li>
<li><strong>Community</strong>: Largest developer community</li>
</ul>
<h3 id="aws-account-structure"><a class="header" href="#aws-account-structure">AWS Account Structure</a></h3>
<pre><code>┌─────────────────────────────────────────────┐
│         AWS Organization (Root)              │
├─────────────────────────────────────────────┤
│                                              │
│  ┌──────────────┐    ┌──────────────┐      │
│  │  Production  │    │  Development │      │
│  │  OU          │    │  OU          │      │
│  ├──────────────┤    ├──────────────┤      │
│  │ Account 1    │    │ Account 3    │      │
│  │ Account 2    │    │ Account 4    │      │
│  └──────────────┘    └──────────────┘      │
│                                              │
│  ┌──────────────┐    ┌──────────────┐      │
│  │  Security    │    │  Sandbox     │      │
│  │  OU          │    │  OU          │      │
│  └──────────────┘    └──────────────┘      │
└─────────────────────────────────────────────┘
</code></pre>
<h2 id="aws-global-infrastructure"><a class="header" href="#aws-global-infrastructure">AWS Global Infrastructure</a></h2>
<h3 id="hierarchy"><a class="header" href="#hierarchy">Hierarchy</a></h3>
<pre><code>Region
  └─ Availability Zones (AZs)
      └─ Data Centers
          └─ Edge Locations (CloudFront CDN)
</code></pre>
<h3 id="key-concepts-20"><a class="header" href="#key-concepts-20">Key Concepts</a></h3>
<p><strong>Region</strong>: Geographic area with multiple AZs</p>
<ul>
<li>Examples: us-east-1 (Virginia), eu-west-1 (Ireland)</li>
<li>Completely independent</li>
<li>Data doesn't leave region unless explicitly configured</li>
</ul>
<p><strong>Availability Zone</strong>: Isolated data center(s) within a region</p>
<ul>
<li>2-6 AZs per region</li>
<li>Low-latency connections between AZs</li>
<li>Physical separation for fault tolerance</li>
</ul>
<p><strong>Edge Location</strong>: CDN endpoint for CloudFront</p>
<ul>
<li>400+ edge locations globally</li>
<li>Caches content closer to users</li>
</ul>
<h3 id="region-selection-criteria"><a class="header" href="#region-selection-criteria">Region Selection Criteria</a></h3>
<pre><code>Factor              Consideration
──────────────────────────────────────────────
Latency             Distance to users
Compliance          Data residency laws
Services            Not all services in all regions
Cost                Pricing varies by region
</code></pre>
<h2 id="getting-started-2"><a class="header" href="#getting-started-2">Getting Started</a></h2>
<h3 id="aws-cli-installation"><a class="header" href="#aws-cli-installation">AWS CLI Installation</a></h3>
<pre><code class="language-bash"># Install AWS CLI v2 (Linux/macOS)
curl "https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip" -o "awscliv2.zip"
unzip awscliv2.zip
sudo ./aws/install

# Verify installation
aws --version

# Configure AWS CLI
aws configure
# Enter:
# - AWS Access Key ID
# - AWS Secret Access Key
# - Default region (e.g., us-east-1)
# - Default output format (json/yaml/text/table)

# Alternative: Use environment variables
export AWS_ACCESS_KEY_ID="your-access-key"
export AWS_SECRET_ACCESS_KEY="your-secret-key"
export AWS_DEFAULT_REGION="us-east-1"

# Or use AWS profiles
aws configure --profile production
aws s3 ls --profile production
</code></pre>
<h3 id="aws-cli-configuration-files"><a class="header" href="#aws-cli-configuration-files">AWS CLI Configuration Files</a></h3>
<pre><code class="language-bash"># View configuration
cat ~/.aws/config
# [default]
# region = us-east-1
# output = json
#
# [profile production]
# region = us-west-2
# output = yaml

cat ~/.aws/credentials
# [default]
# aws_access_key_id = AKIAIOSFODNN7EXAMPLE
# aws_secret_access_key = wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY
#
# [production]
# aws_access_key_id = AKIAI44QH8DHBEXAMPLE
# aws_secret_access_key = je7MtGbClwBF/2Zp9Utk/h3yCo8nvbEXAMPLEKEY
</code></pre>
<h3 id="basic-aws-cli-commands"><a class="header" href="#basic-aws-cli-commands">Basic AWS CLI Commands</a></h3>
<pre><code class="language-bash"># Get caller identity
aws sts get-caller-identity

# List all regions
aws ec2 describe-regions --output table

# List available services
aws help

# Get help for specific service
aws ec2 help
aws s3 help
</code></pre>
<h2 id="core-compute-services"><a class="header" href="#core-compute-services">Core Compute Services</a></h2>
<h3 id="amazon-ec2-elastic-compute-cloud"><a class="header" href="#amazon-ec2-elastic-compute-cloud">Amazon EC2 (Elastic Compute Cloud)</a></h3>
<p>Virtual servers in the cloud.</p>
<h4 id="instance-types"><a class="header" href="#instance-types">Instance Types</a></h4>
<pre><code>Category        Type         vCPU    Memory    Use Case
──────────────────────────────────────────────────────────────
General         t3.micro     2       1 GB      Development
Purpose         t3.medium    2       4 GB      Web servers
                m5.large     2       8 GB      Applications

Compute         c5.large     2       4 GB      Batch processing
Optimized       c5.xlarge    4       8 GB      High-performance

Memory          r5.large     2       16 GB     Databases
Optimized       r5.xlarge    4       32 GB     Caching

Storage         i3.large     2       15.25 GB  NoSQL databases
Optimized       d2.xlarge    4       30.5 GB   Data warehousing

GPU             p3.2xlarge   8       61 GB     ML training
Instances       g4dn.xlarge  4       16 GB     ML inference
</code></pre>
<h4 id="ec2-pricing-models"><a class="header" href="#ec2-pricing-models">EC2 Pricing Models</a></h4>
<pre><code>Model               Discount    Commitment    Use Case
─────────────────────────────────────────────────────────────
On-Demand           Baseline    None          Unpredictable
Reserved Instance   Up to 75%   1-3 years     Steady state
Spot Instance       Up to 90%   None          Fault-tolerant
Savings Plan        Up to 72%   1-3 years     Flexible
</code></pre>
<h4 id="ec2-cli-examples"><a class="header" href="#ec2-cli-examples">EC2 CLI Examples</a></h4>
<pre><code class="language-bash"># List all instances
aws ec2 describe-instances

# List instances with specific state
aws ec2 describe-instances \
  --filters "Name=instance-state-name,Values=running" \
  --query 'Reservations[].Instances[].[InstanceId,InstanceType,State.Name,PublicIpAddress]' \
  --output table

# Launch an instance
aws ec2 run-instances \
  --image-id ami-0c55b159cbfafe1f0 \
  --instance-type t3.micro \
  --key-name my-key-pair \
  --security-group-ids sg-0123456789abcdef0 \
  --subnet-id subnet-0123456789abcdef0 \
  --tag-specifications 'ResourceType=instance,Tags=[{Key=Name,Value=MyWebServer}]'

# Stop an instance
aws ec2 stop-instances --instance-ids i-1234567890abcdef0

# Start an instance
aws ec2 start-instances --instance-ids i-1234567890abcdef0

# Terminate an instance
aws ec2 terminate-instances --instance-ids i-1234567890abcdef0

# Create AMI from instance
aws ec2 create-image \
  --instance-id i-1234567890abcdef0 \
  --name "MyWebServer-Backup-$(date +%Y%m%d)" \
  --description "Backup of MyWebServer"

# List AMIs
aws ec2 describe-images --owners self

# Get instance metadata (from within instance)
curl http://169.254.169.254/latest/meta-data/
curl http://169.254.169.254/latest/meta-data/instance-id
curl http://169.254.169.254/latest/meta-data/public-ipv4
</code></pre>
<h4 id="user-data-script-example"><a class="header" href="#user-data-script-example">User Data Script Example</a></h4>
<pre><code class="language-bash">#!/bin/bash
# User data script for EC2 instance initialization

# Update system
yum update -y

# Install Apache web server
yum install -y httpd

# Start Apache
systemctl start httpd
systemctl enable httpd

# Create simple web page
echo "&lt;h1&gt;Hello from EC2!&lt;/h1&gt;" &gt; /var/www/html/index.html

# Install CloudWatch agent
wget https://s3.amazonaws.com/amazoncloudwatch-agent/amazon_linux/amd64/latest/amazon-cloudwatch-agent.rpm
rpm -U ./amazon-cloudwatch-agent.rpm
</code></pre>
<h3 id="auto-scaling"><a class="header" href="#auto-scaling">Auto Scaling</a></h3>
<p>Automatically adjust capacity to maintain performance and costs.</p>
<h4 id="auto-scaling-architecture"><a class="header" href="#auto-scaling-architecture">Auto Scaling Architecture</a></h4>
<pre><code>┌─────────────────────────────────────────────────────┐
│              Application Load Balancer              │
└──────────────────────┬──────────────────────────────┘
                       │
    ┌──────────────────┼──────────────────┐
    │                  │                  │
┌───▼────┐        ┌───▼────┐        ┌───▼────┐
│  EC2   │        │  EC2   │        │  EC2   │
│ (Min)  │        │ (Curr) │        │ (Max)  │
└────────┘        └────────┘        └────────┘
    │                  │                  │
    └──────────────────┼──────────────────┘
                       │
            ┌──────────▼──────────┐
            │  Auto Scaling Group │
            │                     │
            │  Min: 2             │
            │  Desired: 3         │
            │  Max: 10            │
            │                     │
            │  Scale Up: CPU&gt;70%  │
            │  Scale Down: CPU&lt;30%│
            └─────────────────────┘
</code></pre>
<h4 id="auto-scaling-cli-examples"><a class="header" href="#auto-scaling-cli-examples">Auto Scaling CLI Examples</a></h4>
<pre><code class="language-bash"># Create launch template
aws ec2 create-launch-template \
  --launch-template-name my-template \
  --version-description "Initial version" \
  --launch-template-data '{
    "ImageId": "ami-0c55b159cbfafe1f0",
    "InstanceType": "t3.micro",
    "KeyName": "my-key-pair",
    "SecurityGroupIds": ["sg-0123456789abcdef0"]
  }'

# Create Auto Scaling group
aws autoscaling create-auto-scaling-group \
  --auto-scaling-group-name my-asg \
  --launch-template "LaunchTemplateName=my-template,Version=1" \
  --min-size 2 \
  --max-size 10 \
  --desired-capacity 3 \
  --vpc-zone-identifier "subnet-12345,subnet-67890" \
  --target-group-arns arn:aws:elasticloadbalancing:region:account-id:targetgroup/my-targets/73e2d6bc24d8a067 \
  --health-check-type ELB \
  --health-check-grace-period 300

# Create scaling policy (target tracking)
aws autoscaling put-scaling-policy \
  --auto-scaling-group-name my-asg \
  --policy-name cpu-target-tracking \
  --policy-type TargetTrackingScaling \
  --target-tracking-configuration '{
    "PredefinedMetricSpecification": {
      "PredefinedMetricType": "ASGAverageCPUUtilization"
    },
    "TargetValue": 70.0
  }'

# Describe Auto Scaling groups
aws autoscaling describe-auto-scaling-groups \
  --auto-scaling-group-names my-asg

# Update Auto Scaling group capacity
aws autoscaling set-desired-capacity \
  --auto-scaling-group-name my-asg \
  --desired-capacity 5

# Delete Auto Scaling group
aws autoscaling delete-auto-scaling-group \
  --auto-scaling-group-name my-asg \
  --force-delete
</code></pre>
<h3 id="aws-lambda-serverless"><a class="header" href="#aws-lambda-serverless">AWS Lambda (Serverless)</a></h3>
<p>Run code without provisioning servers. Covered in detail in <a href="cloud/aws.html#serverless-services">Serverless Services</a>.</p>
<h2 id="storage-services-1"><a class="header" href="#storage-services-1">Storage Services</a></h2>
<h3 id="amazon-s3-simple-storage-service"><a class="header" href="#amazon-s3-simple-storage-service">Amazon S3 (Simple Storage Service)</a></h3>
<p>Object storage service with 99.999999999% (11 9's) durability.</p>
<h4 id="s3-storage-classes"><a class="header" href="#s3-storage-classes">S3 Storage Classes</a></h4>
<pre><code>Class                   Use Case                    Retrieval      Cost
────────────────────────────────────────────────────────────────────────
Standard                Frequently accessed         Instant        $$$
Intelligent-Tiering     Unknown/changing patterns   Instant        $$+
Standard-IA             Infrequently accessed       Instant        $$
One Zone-IA             Non-critical, infrequent    Instant        $
Glacier Instant         Archive, instant retrieval  Instant        $
Glacier Flexible        Archive, min-hour retrieval Minutes-Hours  ¢¢
Glacier Deep Archive    Long-term archive (7-10yr)  12 hours       ¢
</code></pre>
<h4 id="s3-architecture"><a class="header" href="#s3-architecture">S3 Architecture</a></h4>
<pre><code>┌─────────────────────────────────────────────┐
│  Bucket: my-application-bucket              │
│  Region: us-east-1                          │
├─────────────────────────────────────────────┤
│                                              │
│  /images/                                   │
│    ├─ logo.png                              │
│    └─ banner.jpg                            │
│                                              │
│  /documents/                                │
│    ├─ report.pdf                            │
│    └─ invoice.xlsx                          │
│                                              │
│  /backups/                                  │
│    └─ database-backup-2024-01-01.sql       │
│                                              │
│  Features:                                  │
│  ├─ Versioning: Enabled                    │
│  ├─ Encryption: AES-256                    │
│  ├─ Lifecycle: Move to Glacier after 90d   │
│  ├─ Replication: Cross-region enabled      │
│  └─ Access Logs: Enabled                   │
└─────────────────────────────────────────────┘
</code></pre>
<h4 id="s3-cli-examples"><a class="header" href="#s3-cli-examples">S3 CLI Examples</a></h4>
<pre><code class="language-bash"># Create bucket
aws s3 mb s3://my-unique-bucket-name-12345

# List buckets
aws s3 ls

# Upload file
aws s3 cp local-file.txt s3://my-bucket/
aws s3 cp local-file.txt s3://my-bucket/folder/

# Upload directory recursively
aws s3 cp ./my-directory s3://my-bucket/path/ --recursive

# Download file
aws s3 cp s3://my-bucket/file.txt ./

# Sync local directory with S3 (like rsync)
aws s3 sync ./local-dir s3://my-bucket/remote-dir/
aws s3 sync s3://my-bucket/remote-dir/ ./local-dir

# List objects in bucket
aws s3 ls s3://my-bucket/
aws s3 ls s3://my-bucket/folder/ --recursive

# Delete object
aws s3 rm s3://my-bucket/file.txt

# Delete all objects in folder
aws s3 rm s3://my-bucket/folder/ --recursive

# Make object public
aws s3api put-object-acl \
  --bucket my-bucket \
  --key file.txt \
  --acl public-read

# Generate presigned URL (temporary access)
aws s3 presign s3://my-bucket/private-file.pdf --expires-in 3600

# Enable versioning
aws s3api put-bucket-versioning \
  --bucket my-bucket \
  --versioning-configuration Status=Enabled

# Enable server-side encryption
aws s3api put-bucket-encryption \
  --bucket my-bucket \
  --server-side-encryption-configuration '{
    "Rules": [{
      "ApplyServerSideEncryptionByDefault": {
        "SSEAlgorithm": "AES256"
      }
    }]
  }'

# Set lifecycle policy
aws s3api put-bucket-lifecycle-configuration \
  --bucket my-bucket \
  --lifecycle-configuration file://lifecycle.json
</code></pre>
<h4 id="s3-lifecycle-policy-example"><a class="header" href="#s3-lifecycle-policy-example">S3 Lifecycle Policy Example</a></h4>
<pre><code class="language-json">{
  "Rules": [
    {
      "Id": "MoveOldFilesToGlacier",
      "Status": "Enabled",
      "Filter": {
        "Prefix": "logs/"
      },
      "Transitions": [
        {
          "Days": 30,
          "StorageClass": "STANDARD_IA"
        },
        {
          "Days": 90,
          "StorageClass": "GLACIER"
        }
      ],
      "Expiration": {
        "Days": 365
      }
    },
    {
      "Id": "DeleteOldVersions",
      "Status": "Enabled",
      "NoncurrentVersionExpiration": {
        "NoncurrentDays": 30
      }
    }
  ]
}
</code></pre>
<h4 id="s3-bucket-policy-example"><a class="header" href="#s3-bucket-policy-example">S3 Bucket Policy Example</a></h4>
<pre><code class="language-json">{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "PublicReadGetObject",
      "Effect": "Allow",
      "Principal": "*",
      "Action": "s3:GetObject",
      "Resource": "arn:aws:s3:::my-bucket/public/*"
    },
    {
      "Sid": "DenyInsecureTransport",
      "Effect": "Deny",
      "Principal": "*",
      "Action": "s3:*",
      "Resource": [
        "arn:aws:s3:::my-bucket",
        "arn:aws:s3:::my-bucket/*"
      ],
      "Condition": {
        "Bool": {
          "aws:SecureTransport": "false"
        }
      }
    }
  ]
}
</code></pre>
<h4 id="s3-sdk-example-pythonboto3"><a class="header" href="#s3-sdk-example-pythonboto3">S3 SDK Example (Python/Boto3)</a></h4>
<pre><code class="language-python">import boto3
from botocore.exceptions import ClientError

# Create S3 client
s3 = boto3.client('s3')

# Upload file
def upload_file(file_name, bucket, object_name=None):
    if object_name is None:
        object_name = file_name
    
    try:
        s3.upload_file(file_name, bucket, object_name)
        print(f"Uploaded {file_name} to {bucket}/{object_name}")
    except ClientError as e:
        print(f"Error: {e}")
        return False
    return True

# Download file
def download_file(bucket, object_name, file_name):
    try:
        s3.download_file(bucket, object_name, file_name)
        print(f"Downloaded {bucket}/{object_name} to {file_name}")
    except ClientError as e:
        print(f"Error: {e}")
        return False
    return True

# List objects
def list_objects(bucket, prefix=''):
    try:
        response = s3.list_objects_v2(Bucket=bucket, Prefix=prefix)
        if 'Contents' in response:
            for obj in response['Contents']:
                print(f"{obj['Key']}: {obj['Size']} bytes")
    except ClientError as e:
        print(f"Error: {e}")

# Generate presigned URL
def create_presigned_url(bucket, object_name, expiration=3600):
    try:
        url = s3.generate_presigned_url(
            'get_object',
            Params={'Bucket': bucket, 'Key': object_name},
            ExpiresIn=expiration
        )
        return url
    except ClientError as e:
        print(f"Error: {e}")
        return None

# Usage
upload_file('local-file.txt', 'my-bucket', 'uploads/file.txt')
download_file('my-bucket', 'uploads/file.txt', 'downloaded-file.txt')
list_objects('my-bucket', 'uploads/')
url = create_presigned_url('my-bucket', 'uploads/file.txt')
print(f"Presigned URL: {url}")
</code></pre>
<h3 id="amazon-ebs-elastic-block-store"><a class="header" href="#amazon-ebs-elastic-block-store">Amazon EBS (Elastic Block Store)</a></h3>
<p>Block storage for EC2 instances.</p>
<h4 id="ebs-volume-types"><a class="header" href="#ebs-volume-types">EBS Volume Types</a></h4>
<pre><code>Type         IOPS          Throughput    Use Case              Cost
────────────────────────────────────────────────────────────────────
gp3          3,000-16,000  125-1000 MB/s General purpose       $$
gp2          3,000-16,000  Baseline      General purpose       $$
io2          64,000+       1,000 MB/s    Mission-critical DB   $$$$
io1          32,000+       500 MB/s      High-performance DB   $$$
st1          500           500 MB/s      Big data, logs        $
sc1          250           250 MB/s      Cold data             ¢
</code></pre>
<h4 id="ebs-cli-examples"><a class="header" href="#ebs-cli-examples">EBS CLI Examples</a></h4>
<pre><code class="language-bash"># Create EBS volume
aws ec2 create-volume \
  --volume-type gp3 \
  --size 100 \
  --availability-zone us-east-1a \
  --tag-specifications 'ResourceType=volume,Tags=[{Key=Name,Value=MyVolume}]'

# List volumes
aws ec2 describe-volumes

# Attach volume to instance
aws ec2 attach-volume \
  --volume-id vol-0123456789abcdef0 \
  --instance-id i-1234567890abcdef0 \
  --device /dev/sdf

# Detach volume
aws ec2 detach-volume --volume-id vol-0123456789abcdef0

# Create snapshot
aws ec2 create-snapshot \
  --volume-id vol-0123456789abcdef0 \
  --description "Backup of MyVolume"

# List snapshots
aws ec2 describe-snapshots --owner-ids self

# Create volume from snapshot
aws ec2 create-volume \
  --snapshot-id snap-0123456789abcdef0 \
  --availability-zone us-east-1a

# Delete snapshot
aws ec2 delete-snapshot --snapshot-id snap-0123456789abcdef0

# Delete volume
aws ec2 delete-volume --volume-id vol-0123456789abcdef0
</code></pre>
<h3 id="amazon-efs-elastic-file-system"><a class="header" href="#amazon-efs-elastic-file-system">Amazon EFS (Elastic File System)</a></h3>
<p>Managed NFS file system for EC2.</p>
<pre><code class="language-bash"># Create EFS file system
aws efs create-file-system \
  --performance-mode generalPurpose \
  --throughput-mode bursting \
  --encrypted \
  --tags Key=Name,Value=MyEFS

# Create mount target
aws efs create-mount-target \
  --file-system-id fs-0123456789abcdef0 \
  --subnet-id subnet-0123456789abcdef0 \
  --security-groups sg-0123456789abcdef0

# Mount EFS on EC2 instance
sudo mkdir /mnt/efs
sudo mount -t nfs4 -o nfsvers=4.1,rsize=1048576,wsize=1048576,hard,timeo=600,retrans=2 \
  fs-0123456789abcdef0.efs.us-east-1.amazonaws.com:/ /mnt/efs

# Add to /etc/fstab for persistent mount
echo "fs-0123456789abcdef0.efs.us-east-1.amazonaws.com:/ /mnt/efs nfs4 defaults,_netdev 0 0" | sudo tee -a /etc/fstab
</code></pre>
<h2 id="database-services-1"><a class="header" href="#database-services-1">Database Services</a></h2>
<h3 id="amazon-rds-relational-database-service"><a class="header" href="#amazon-rds-relational-database-service">Amazon RDS (Relational Database Service)</a></h3>
<p>Managed relational databases.</p>
<h4 id="supported-engines"><a class="header" href="#supported-engines">Supported Engines</a></h4>
<pre><code>Engine          Versions        Use Case
───────────────────────────────────────────────────────
MySQL           5.7, 8.0        Web applications
PostgreSQL      11-15           Advanced features
MariaDB         10.3-10.6       MySQL alternative
Oracle          12c, 19c        Enterprise apps
SQL Server      2016-2022       Microsoft stack
Amazon Aurora   MySQL/PG compat High performance
</code></pre>
<h4 id="rds-architecture-multi-az"><a class="header" href="#rds-architecture-multi-az">RDS Architecture (Multi-AZ)</a></h4>
<pre><code>┌─────────────────────────────────────────────────┐
│             Application Servers                  │
└───────────────────┬─────────────────────────────┘
                    │
         ┌──────────▼──────────┐
         │   RDS Endpoint      │
         │   (DNS CNAME)       │
         └──────────┬──────────┘
                    │
    ┌───────────────┼───────────────┐
    │               │               │
┌───▼────┐    Sync Repl    ┌───────▼─────┐
│Primary │◄──────────────►│  Standby    │
│Instance│                 │  Instance   │
│(AZ-A)  │                 │  (AZ-B)     │
└────────┘                 └─────────────┘
    │                            │
    │      Automatic Failover    │
    └────────────────────────────┘
</code></pre>
<h4 id="rds-cli-examples"><a class="header" href="#rds-cli-examples">RDS CLI Examples</a></h4>
<pre><code class="language-bash"># Create RDS instance
aws rds create-db-instance \
  --db-instance-identifier mydb \
  --db-instance-class db.t3.micro \
  --engine postgres \
  --engine-version 14.7 \
  --master-username admin \
  --master-user-password MySecurePassword123 \
  --allocated-storage 20 \
  --storage-type gp3 \
  --vpc-security-group-ids sg-0123456789abcdef0 \
  --db-subnet-group-name my-db-subnet-group \
  --backup-retention-period 7 \
  --preferred-backup-window "03:00-04:00" \
  --preferred-maintenance-window "sun:04:00-sun:05:00" \
  --multi-az \
  --storage-encrypted \
  --enable-cloudwatch-logs-exports '["postgresql"]'

# List RDS instances
aws rds describe-db-instances

# Get specific instance details
aws rds describe-db-instances \
  --db-instance-identifier mydb \
  --query 'DBInstances[0].[DBInstanceIdentifier,DBInstanceStatus,Endpoint.Address,Endpoint.Port]'

# Create read replica
aws rds create-db-instance-read-replica \
  --db-instance-identifier mydb-replica \
  --source-db-instance-identifier mydb \
  --db-instance-class db.t3.micro \
  --availability-zone us-east-1b

# Create snapshot
aws rds create-db-snapshot \
  --db-instance-identifier mydb \
  --db-snapshot-identifier mydb-snapshot-$(date +%Y%m%d)

# Restore from snapshot
aws rds restore-db-instance-from-db-snapshot \
  --db-instance-identifier mydb-restored \
  --db-snapshot-identifier mydb-snapshot-20240101

# Modify instance
aws rds modify-db-instance \
  --db-instance-identifier mydb \
  --db-instance-class db.t3.small \
  --apply-immediately

# Stop instance (up to 7 days)
aws rds stop-db-instance --db-instance-identifier mydb

# Start instance
aws rds start-db-instance --db-instance-identifier mydb

# Delete instance
aws rds delete-db-instance \
  --db-instance-identifier mydb \
  --skip-final-snapshot
  # Or with final snapshot:
  # --final-db-snapshot-identifier mydb-final-snapshot

# Connect to RDS
psql -h mydb.c9akciq32.us-east-1.rds.amazonaws.com -U admin -d postgres
mysql -h mydb.c9akciq32.us-east-1.rds.amazonaws.com -u admin -p
</code></pre>
<h3 id="amazon-dynamodb"><a class="header" href="#amazon-dynamodb">Amazon DynamoDB</a></h3>
<p>Fully managed NoSQL database.</p>
<h4 id="dynamodb-concepts"><a class="header" href="#dynamodb-concepts">DynamoDB Concepts</a></h4>
<pre><code>Table: Users
┌──────────────┬─────────────┬───────────┬─────────┬──────────┐
│ UserId (PK)  │ Email (SK)  │ Name      │ Age     │ Status   │
├──────────────┼─────────────┼───────────┼─────────┼──────────┤
│ user-001     │ a@ex.com    │ Alice     │ 30      │ active   │
│ user-002     │ b@ex.com    │ Bob       │ 25      │ active   │
│ user-003     │ c@ex.com    │ Charlie   │ 35      │ inactive │
└──────────────┴─────────────┴───────────┴─────────┴──────────┘

PK = Partition Key (required, determines data distribution)
SK = Sort Key (optional, enables range queries)
</code></pre>
<h4 id="dynamodb-capacity-modes"><a class="header" href="#dynamodb-capacity-modes">DynamoDB Capacity Modes</a></h4>
<pre><code>Mode          Billing      Use Case                Cost
─────────────────────────────────────────────────────────────
On-Demand     Per request  Unpredictable traffic   $$$$
Provisioned   Per hour     Predictable traffic     $$-$$$
  + Auto      Per hour     Variable patterns       $$-$$$
    Scaling
</code></pre>
<h4 id="dynamodb-cli-examples"><a class="header" href="#dynamodb-cli-examples">DynamoDB CLI Examples</a></h4>
<pre><code class="language-bash"># Create table
aws dynamodb create-table \
  --table-name Users \
  --attribute-definitions \
    AttributeName=UserId,AttributeType=S \
    AttributeName=Email,AttributeType=S \
  --key-schema \
    AttributeName=UserId,KeyType=HASH \
    AttributeName=Email,KeyType=RANGE \
  --billing-mode PAY_PER_REQUEST \
  --tags Key=Environment,Value=Production

# List tables
aws dynamodb list-tables

# Describe table
aws dynamodb describe-table --table-name Users

# Put item
aws dynamodb put-item \
  --table-name Users \
  --item '{
    "UserId": {"S": "user-001"},
    "Email": {"S": "alice@example.com"},
    "Name": {"S": "Alice"},
    "Age": {"N": "30"},
    "Status": {"S": "active"}
  }'

# Get item
aws dynamodb get-item \
  --table-name Users \
  --key '{
    "UserId": {"S": "user-001"},
    "Email": {"S": "alice@example.com"}
  }'

# Query items (by partition key)
aws dynamodb query \
  --table-name Users \
  --key-condition-expression "UserId = :userId" \
  --expression-attribute-values '{
    ":userId": {"S": "user-001"}
  }'

# Scan table (read all items - expensive!)
aws dynamodb scan --table-name Users

# Update item
aws dynamodb update-item \
  --table-name Users \
  --key '{
    "UserId": {"S": "user-001"},
    "Email": {"S": "alice@example.com"}
  }' \
  --update-expression "SET #status = :newStatus, Age = Age + :inc" \
  --expression-attribute-names '{"#status": "Status"}' \
  --expression-attribute-values '{
    ":newStatus": {"S": "inactive"},
    ":inc": {"N": "1"}
  }'

# Delete item
aws dynamodb delete-item \
  --table-name Users \
  --key '{
    "UserId": {"S": "user-001"},
    "Email": {"S": "alice@example.com"}
  }'

# Batch write
aws dynamodb batch-write-item --request-items file://batch-write.json

# Create global secondary index
aws dynamodb update-table \
  --table-name Users \
  --attribute-definitions AttributeName=Status,AttributeType=S \
  --global-secondary-index-updates '[{
    "Create": {
      "IndexName": "StatusIndex",
      "KeySchema": [{"AttributeName": "Status", "KeyType": "HASH"}],
      "Projection": {"ProjectionType": "ALL"},
      "ProvisionedThroughput": {
        "ReadCapacityUnits": 5,
        "WriteCapacityUnits": 5
      }
    }
  }]'

# Enable Point-in-Time Recovery
aws dynamodb update-continuous-backups \
  --table-name Users \
  --point-in-time-recovery-specification PointInTimeRecoveryEnabled=true
</code></pre>
<h4 id="dynamodb-sdk-example-pythonboto3"><a class="header" href="#dynamodb-sdk-example-pythonboto3">DynamoDB SDK Example (Python/Boto3)</a></h4>
<pre><code class="language-python">import boto3
from boto3.dynamodb.conditions import Key, Attr
from decimal import Decimal

# Create DynamoDB resource
dynamodb = boto3.resource('dynamodb')
table = dynamodb.Table('Users')

# Put item
def create_user(user_id, email, name, age):
    response = table.put_item(
        Item={
            'UserId': user_id,
            'Email': email,
            'Name': name,
            'Age': age,
            'Status': 'active'
        }
    )
    return response

# Get item
def get_user(user_id, email):
    response = table.get_item(
        Key={
            'UserId': user_id,
            'Email': email
        }
    )
    return response.get('Item')

# Query by partition key
def get_user_emails(user_id):
    response = table.query(
        KeyConditionExpression=Key('UserId').eq(user_id)
    )
    return response['Items']

# Query with sort key condition
def get_user_by_email_prefix(user_id, email_prefix):
    response = table.query(
        KeyConditionExpression=Key('UserId').eq(user_id) &amp; 
                               Key('Email').begins_with(email_prefix)
    )
    return response['Items']

# Scan with filter
def get_active_users():
    response = table.scan(
        FilterExpression=Attr('Status').eq('active')
    )
    return response['Items']

# Update item
def update_user_status(user_id, email, new_status):
    response = table.update_item(
        Key={
            'UserId': user_id,
            'Email': email
        },
        UpdateExpression='SET #status = :status',
        ExpressionAttributeNames={
            '#status': 'Status'
        },
        ExpressionAttributeValues={
            ':status': new_status
        },
        ReturnValues='ALL_NEW'
    )
    return response['Attributes']

# Batch write
def batch_create_users(users):
    with table.batch_writer() as batch:
        for user in users:
            batch.put_item(Item=user)

# Usage
create_user('user-001', 'alice@example.com', 'Alice', 30)
user = get_user('user-001', 'alice@example.com')
print(user)

emails = get_user_emails('user-001')
update_user_status('user-001', 'alice@example.com', 'inactive')
</code></pre>
<h3 id="amazon-elasticache"><a class="header" href="#amazon-elasticache">Amazon ElastiCache</a></h3>
<p>Managed in-memory cache (Redis/Memcached).</p>
<pre><code class="language-bash"># Create Redis cluster
aws elasticache create-cache-cluster \
  --cache-cluster-id my-redis-cluster \
  --cache-node-type cache.t3.micro \
  --engine redis \
  --engine-version 7.0 \
  --num-cache-nodes 1 \
  --cache-subnet-group-name my-cache-subnet-group \
  --security-group-ids sg-0123456789abcdef0

# Create Redis replication group (cluster mode)
aws elasticache create-replication-group \
  --replication-group-id my-redis-cluster \
  --replication-group-description "My Redis cluster" \
  --engine redis \
  --cache-node-type cache.t3.micro \
  --num-cache-clusters 3 \
  --automatic-failover-enabled \
  --multi-az-enabled

# Describe clusters
aws elasticache describe-cache-clusters \
  --show-cache-node-info

# Get endpoint
aws elasticache describe-cache-clusters \
  --cache-cluster-id my-redis-cluster \
  --query 'CacheClusters[0].CacheNodes[0].Endpoint'
</code></pre>
<h2 id="networking-services-1"><a class="header" href="#networking-services-1">Networking Services</a></h2>
<h3 id="amazon-vpc-virtual-private-cloud"><a class="header" href="#amazon-vpc-virtual-private-cloud">Amazon VPC (Virtual Private Cloud)</a></h3>
<p>Isolated network for your AWS resources.</p>
<h4 id="vpc-architecture"><a class="header" href="#vpc-architecture">VPC Architecture</a></h4>
<pre><code>┌─────────────────────────────────────────────────────────────┐
│  VPC: 10.0.0.0/16                                           │
│  Region: us-east-1                                          │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  ┌───────────────────────────┐  ┌──────────────────────┐   │
│  │ Public Subnet (AZ-A)      │  │ Public Subnet (AZ-B) │   │
│  │ 10.0.1.0/24               │  │ 10.0.2.0/24          │   │
│  │                           │  │                      │   │
│  │ ┌─────┐ ┌──────┐         │  │ ┌─────┐ ┌──────┐    │   │
│  │ │ NAT │ │ ALB  │         │  │ │ NAT │ │ ALB  │    │   │
│  │ └─────┘ └──────┘         │  │ └─────┘ └──────┘    │   │
│  └───────────┬───────────────┘  └──────────┬───────────┘   │
│              │                              │               │
│              │     Internet Gateway         │               │
│              └──────────────┬───────────────┘               │
│                             │                               │
│  ┌───────────────────────────┐  ┌──────────────────────┐   │
│  │ Private Subnet (AZ-A)     │  │ Private Subnet (AZ-B)│   │
│  │ 10.0.11.0/24              │  │ 10.0.12.0/24         │   │
│  │                           │  │                      │   │
│  │ ┌─────┐ ┌─────┐          │  │ ┌─────┐ ┌─────┐     │   │
│  │ │ EC2 │ │ EC2 │          │  │ │ EC2 │ │ EC2 │     │   │
│  │ └─────┘ └─────┘          │  │ └─────┘ └─────┘     │   │
│  └───────────────────────────┘  └──────────────────────┘   │
│                                                              │
│  ┌───────────────────────────┐  ┌──────────────────────┐   │
│  │ Database Subnet (AZ-A)    │  │ Database Subnet (AZ-B│   │
│  │ 10.0.21.0/24              │  │ 10.0.22.0/24         │   │
│  │                           │  │                      │   │
│  │ ┌─────────┐               │  │ ┌─────────┐         │   │
│  │ │   RDS   │               │  │ │   RDS   │         │   │
│  │ └─────────┘               │  │ └─────────┘         │   │
│  └───────────────────────────┘  └──────────────────────┘   │
│                                                              │
└─────────────────────────────────────────────────────────────┘
</code></pre>
<h4 id="vpc-cli-examples"><a class="header" href="#vpc-cli-examples">VPC CLI Examples</a></h4>
<pre><code class="language-bash"># Create VPC
aws ec2 create-vpc \
  --cidr-block 10.0.0.0/16 \
  --tag-specifications 'ResourceType=vpc,Tags=[{Key=Name,Value=MyVPC}]'

# Create Internet Gateway
aws ec2 create-internet-gateway \
  --tag-specifications 'ResourceType=internet-gateway,Tags=[{Key=Name,Value=MyIGW}]'

# Attach Internet Gateway to VPC
aws ec2 attach-internet-gateway \
  --internet-gateway-id igw-0123456789abcdef0 \
  --vpc-id vpc-0123456789abcdef0

# Create public subnet
aws ec2 create-subnet \
  --vpc-id vpc-0123456789abcdef0 \
  --cidr-block 10.0.1.0/24 \
  --availability-zone us-east-1a \
  --tag-specifications 'ResourceType=subnet,Tags=[{Key=Name,Value=PublicSubnet-AZ-A}]'

# Create private subnet
aws ec2 create-subnet \
  --vpc-id vpc-0123456789abcdef0 \
  --cidr-block 10.0.11.0/24 \
  --availability-zone us-east-1a \
  --tag-specifications 'ResourceType=subnet,Tags=[{Key=Name,Value=PrivateSubnet-AZ-A}]'

# Create route table
aws ec2 create-route-table \
  --vpc-id vpc-0123456789abcdef0 \
  --tag-specifications 'ResourceType=route-table,Tags=[{Key=Name,Value=PublicRouteTable}]'

# Create route to Internet Gateway
aws ec2 create-route \
  --route-table-id rtb-0123456789abcdef0 \
  --destination-cidr-block 0.0.0.0/0 \
  --gateway-id igw-0123456789abcdef0

# Associate route table with subnet
aws ec2 associate-route-table \
  --route-table-id rtb-0123456789abcdef0 \
  --subnet-id subnet-0123456789abcdef0

# Create NAT Gateway (for private subnet internet access)
# First, allocate Elastic IP
aws ec2 allocate-address --domain vpc

# Create NAT Gateway in public subnet
aws ec2 create-nat-gateway \
  --subnet-id subnet-0123456789abcdef0 \
  --allocation-id eipalloc-0123456789abcdef0 \
  --tag-specifications 'ResourceType=natgateway,Tags=[{Key=Name,Value=MyNATGateway}]'

# Create route to NAT Gateway for private subnet
aws ec2 create-route \
  --route-table-id rtb-private-0123456789abcdef0 \
  --destination-cidr-block 0.0.0.0/0 \
  --nat-gateway-id nat-0123456789abcdef0

# Create security group
aws ec2 create-security-group \
  --group-name web-server-sg \
  --description "Security group for web servers" \
  --vpc-id vpc-0123456789abcdef0

# Add inbound rules
aws ec2 authorize-security-group-ingress \
  --group-id sg-0123456789abcdef0 \
  --protocol tcp \
  --port 80 \
  --cidr 0.0.0.0/0

aws ec2 authorize-security-group-ingress \
  --group-id sg-0123456789abcdef0 \
  --protocol tcp \
  --port 443 \
  --cidr 0.0.0.0/0

aws ec2 authorize-security-group-ingress \
  --group-id sg-0123456789abcdef0 \
  --protocol tcp \
  --port 22 \
  --cidr 10.0.0.0/16

# List VPCs
aws ec2 describe-vpcs

# List subnets
aws ec2 describe-subnets --filters "Name=vpc-id,Values=vpc-0123456789abcdef0"

# List security groups
aws ec2 describe-security-groups --filters "Name=vpc-id,Values=vpc-0123456789abcdef0"
</code></pre>
<h3 id="elastic-load-balancing-elb"><a class="header" href="#elastic-load-balancing-elb">Elastic Load Balancing (ELB)</a></h3>
<p>Distribute traffic across multiple targets.</p>
<h4 id="load-balancer-types"><a class="header" href="#load-balancer-types">Load Balancer Types</a></h4>
<pre><code>Type                Use Case                    OSI Layer    Cost
──────────────────────────────────────────────────────────────────
Application (ALB)   HTTP/HTTPS, path routing   Layer 7      $$
Network (NLB)       TCP/UDP, ultra performance Layer 4      $$
Gateway (GWLB)      Third-party appliances     Layer 3      $$$
Classic (CLB)       Legacy (deprecated)        Layer 4/7    $
</code></pre>
<h4 id="alb-architecture"><a class="header" href="#alb-architecture">ALB Architecture</a></h4>
<pre><code>                         Internet
                             │
                    ┌────────▼────────┐
                    │ Application     │
                    │ Load Balancer   │
                    │ (ALB)           │
                    └────────┬────────┘
                             │
          ┌──────────────────┼──────────────────┐
          │                  │                  │
    ┌─────▼─────┐      ┌─────▼─────┐     ┌─────▼─────┐
    │  Target   │      │  Target   │     │  Target   │
    │  Group 1  │      │  Group 2  │     │  Group 3  │
    │           │      │           │     │           │
    │ /api/*    │      │ /images/* │     │  /*       │
    └───────────┘      └───────────┘     └───────────┘
         │                  │                  │
    API Servers      Image Service     Web Servers
</code></pre>
<h4 id="load-balancer-cli-examples"><a class="header" href="#load-balancer-cli-examples">Load Balancer CLI Examples</a></h4>
<pre><code class="language-bash"># Create Application Load Balancer
aws elbv2 create-load-balancer \
  --name my-alb \
  --subnets subnet-0123456789abcdef0 subnet-0123456789abcdef1 \
  --security-groups sg-0123456789abcdef0 \
  --scheme internet-facing \
  --type application \
  --ip-address-type ipv4

# Create target group
aws elbv2 create-target-group \
  --name my-targets \
  --protocol HTTP \
  --port 80 \
  --vpc-id vpc-0123456789abcdef0 \
  --health-check-path /health \
  --health-check-interval-seconds 30 \
  --health-check-timeout-seconds 5 \
  --healthy-threshold-count 2 \
  --unhealthy-threshold-count 2

# Register targets
aws elbv2 register-targets \
  --target-group-arn arn:aws:elasticloadbalancing:region:account-id:targetgroup/my-targets/73e2d6bc24d8a067 \
  --targets Id=i-1234567890abcdef0 Id=i-0987654321abcdef0

# Create listener
aws elbv2 create-listener \
  --load-balancer-arn arn:aws:elasticloadbalancing:region:account-id:loadbalancer/app/my-alb/50dc6c495c0c9188 \
  --protocol HTTP \
  --port 80 \
  --default-actions Type=forward,TargetGroupArn=arn:aws:elasticloadbalancing:region:account-id:targetgroup/my-targets/73e2d6bc24d8a067

# Create HTTPS listener with certificate
aws elbv2 create-listener \
  --load-balancer-arn arn:aws:elasticloadbalancing:region:account-id:loadbalancer/app/my-alb/50dc6c495c0c9188 \
  --protocol HTTPS \
  --port 443 \
  --certificates CertificateArn=arn:aws:acm:region:account-id:certificate/12345678-1234-1234-1234-123456789012 \
  --default-actions Type=forward,TargetGroupArn=arn:aws:elasticloadbalancing:region:account-id:targetgroup/my-targets/73e2d6bc24d8a067

# Create path-based routing rule
aws elbv2 create-rule \
  --listener-arn arn:aws:elasticloadbalancing:region:account-id:listener/app/my-alb/50dc6c495c0c9188/f2f7dc8efc522ab2 \
  --priority 10 \
  --conditions Field=path-pattern,Values='/api/*' \
  --actions Type=forward,TargetGroupArn=arn:aws:elasticloadbalancing:region:account-id:targetgroup/api-targets/73e2d6bc24d8a067

# Describe load balancers
aws elbv2 describe-load-balancers

# Describe target health
aws elbv2 describe-target-health \
  --target-group-arn arn:aws:elasticloadbalancing:region:account-id:targetgroup/my-targets/73e2d6bc24d8a067
</code></pre>
<h3 id="amazon-route-53"><a class="header" href="#amazon-route-53">Amazon Route 53</a></h3>
<p>Scalable DNS and domain registration.</p>
<pre><code class="language-bash"># List hosted zones
aws route53 list-hosted-zones

# Create hosted zone
aws route53 create-hosted-zone \
  --name example.com \
  --caller-reference $(date +%s)

# Create A record
aws route53 change-resource-record-sets \
  --hosted-zone-id Z1234567890ABC \
  --change-batch '{
    "Changes": [{
      "Action": "CREATE",
      "ResourceRecordSet": {
        "Name": "www.example.com",
        "Type": "A",
        "TTL": 300,
        "ResourceRecords": [{"Value": "192.0.2.1"}]
      }
    }]
  }'

# Create CNAME record
aws route53 change-resource-record-sets \
  --hosted-zone-id Z1234567890ABC \
  --change-batch '{
    "Changes": [{
      "Action": "CREATE",
      "ResourceRecordSet": {
        "Name": "blog.example.com",
        "Type": "CNAME",
        "TTL": 300,
        "ResourceRecords": [{"Value": "www.example.com"}]
      }
    }]
  }'

# Create alias record (to ALB)
aws route53 change-resource-record-sets \
  --hosted-zone-id Z1234567890ABC \
  --change-batch '{
    "Changes": [{
      "Action": "CREATE",
      "ResourceRecordSet": {
        "Name": "api.example.com",
        "Type": "A",
        "AliasTarget": {
          "HostedZoneId": "Z35SXDOTRQ7X7K",
          "DNSName": "my-alb-1234567890.us-east-1.elb.amazonaws.com",
          "EvaluateTargetHealth": true
        }
      }
    }]
  }'

# Health check for failover
aws route53 create-health-check \
  --health-check-config \
    IPAddress=192.0.2.1,Port=80,Type=HTTP,ResourcePath=/health,RequestInterval=30,FailureThreshold=3
</code></pre>
<h2 id="serverless-services"><a class="header" href="#serverless-services">Serverless Services</a></h2>
<h3 id="aws-lambda"><a class="header" href="#aws-lambda">AWS Lambda</a></h3>
<p>Run code without managing servers.</p>
<h4 id="lambda-architecture"><a class="header" href="#lambda-architecture">Lambda Architecture</a></h4>
<pre><code>┌────────────────────────────────────────────────┐
│            Event Sources                       │
├────────────────────────────────────────────────┤
│                                                 │
│  API Gateway │ S3 │ DynamoDB │ SQS │ EventBridge │
│                                                 │
└──────────────┬──────────┬──────────┬───────────┘
               │          │          │
          ┌────▼────┐┌────▼────┐┌───▼──────┐
          │ Lambda  ││ Lambda  ││  Lambda  │
          │Function ││Function ││ Function │
          │   1     ││    2    ││     3    │
          └────┬────┘└────┬────┘└────┬─────┘
               │          │          │
          ┌────▼──────────▼──────────▼─────┐
          │       Destinations              │
          │                                  │
          │  DynamoDB │ S3 │ SNS │ SQS     │
          └──────────────────────────────────┘
</code></pre>
<h4 id="lambda-function-example-python"><a class="header" href="#lambda-function-example-python">Lambda Function Example (Python)</a></h4>
<pre><code class="language-python">import json
import boto3

s3 = boto3.client('s3')
dynamodb = boto3.resource('dynamodb')
table = dynamodb.Table('MyTable')

def lambda_handler(event, context):
    """
    Lambda function handler
    
    Args:
        event: Event data passed to the function
        context: Runtime information
    
    Returns:
        Response object
    """
    
    # Log the event
    print(f"Event: {json.dumps(event)}")
    
    # Example: Process S3 event
    if 'Records' in event:
        for record in event['Records']:
            bucket = record['s3']['bucket']['name']
            key = record['s3']['object']['key']
            
            print(f"Processing {key} from {bucket}")
            
            # Process the file
            try:
                response = s3.get_object(Bucket=bucket, Key=key)
                content = response['Body'].read().decode('utf-8')
                
                # Store metadata in DynamoDB
                table.put_item(
                    Item={
                        'file_key': key,
                        'bucket': bucket,
                        'size': response['ContentLength'],
                        'content_type': response['ContentType']
                    }
                )
                
                return {
                    'statusCode': 200,
                    'body': json.dumps('Successfully processed file')
                }
            except Exception as e:
                print(f"Error: {str(e)}")
                return {
                    'statusCode': 500,
                    'body': json.dumps(f'Error processing file: {str(e)}')
                }
    
    # Example: Process API Gateway event
    if 'httpMethod' in event:
        http_method = event['httpMethod']
        path = event['path']
        
        if http_method == 'GET' and path == '/items':
            # Retrieve items from DynamoDB
            response = table.scan()
            
            return {
                'statusCode': 200,
                'headers': {
                    'Content-Type': 'application/json',
                    'Access-Control-Allow-Origin': '*'
                },
                'body': json.dumps(response['Items'])
            }
        
        elif http_method == 'POST' and path == '/items':
            # Create new item
            body = json.loads(event['body'])
            
            table.put_item(Item=body)
            
            return {
                'statusCode': 201,
                'headers': {
                    'Content-Type': 'application/json',
                    'Access-Control-Allow-Origin': '*'
                },
                'body': json.dumps({'message': 'Item created'})
            }
    
    return {
        'statusCode': 400,
        'body': json.dumps('Invalid request')
    }
</code></pre>
<h4 id="lambda-cli-examples"><a class="header" href="#lambda-cli-examples">Lambda CLI Examples</a></h4>
<pre><code class="language-bash"># Create Lambda function
zip function.zip lambda_function.py

aws lambda create-function \
  --function-name my-function \
  --runtime python3.11 \
  --role arn:aws:iam::123456789012:role/lambda-execution-role \
  --handler lambda_function.lambda_handler \
  --zip-file fileb://function.zip \
  --timeout 30 \
  --memory-size 256 \
  --environment Variables={ENV=production,DB_TABLE=MyTable}

# Update function code
aws lambda update-function-code \
  --function-name my-function \
  --zip-file fileb://function.zip

# Update function configuration
aws lambda update-function-configuration \
  --function-name my-function \
  --timeout 60 \
  --memory-size 512

# Invoke function synchronously
aws lambda invoke \
  --function-name my-function \
  --payload '{"key": "value"}' \
  response.json

cat response.json

# Invoke function asynchronously
aws lambda invoke \
  --function-name my-function \
  --invocation-type Event \
  --payload '{"key": "value"}' \
  response.json

# List functions
aws lambda list-functions

# Get function details
aws lambda get-function --function-name my-function

# Add S3 trigger
aws lambda add-permission \
  --function-name my-function \
  --statement-id s3-invoke \
  --action lambda:InvokeFunction \
  --principal s3.amazonaws.com \
  --source-arn arn:aws:s3:::my-bucket

aws s3api put-bucket-notification-configuration \
  --bucket my-bucket \
  --notification-configuration '{
    "LambdaFunctionConfigurations": [{
      "LambdaFunctionArn": "arn:aws:lambda:region:account-id:function:my-function",
      "Events": ["s3:ObjectCreated:*"],
      "Filter": {
        "Key": {
          "FilterRules": [{
            "Name": "prefix",
            "Value": "uploads/"
          }]
        }
      }
    }]
  }'

# View logs
aws logs tail /aws/lambda/my-function --follow

# Create layer
zip layer.zip -r python/

aws lambda publish-layer-version \
  --layer-name my-layer \
  --description "Common dependencies" \
  --zip-file fileb://layer.zip \
  --compatible-runtimes python3.11

# Add layer to function
aws lambda update-function-configuration \
  --function-name my-function \
  --layers arn:aws:lambda:region:account-id:layer:my-layer:1

# Delete function
aws lambda delete-function --function-name my-function
</code></pre>
<h4 id="lambda-pricing"><a class="header" href="#lambda-pricing">Lambda Pricing</a></h4>
<pre><code>Component               Price (us-east-1)
─────────────────────────────────────────────────
Requests                $0.20 per 1M requests
Duration (x86)          $0.0000166667 per GB-second
Duration (ARM/Graviton) $0.0000133334 per GB-second
Free Tier               1M requests + 400,000 GB-seconds/month

Example: 1 million requests, 512 MB, 1 second each
= 1M * $0.20/1M = $0.20 (requests)
+ 1M * 0.5 GB * 1 sec * $0.0000166667 = $8.33 (duration)
= $8.53/month (minus free tier)
</code></pre>
<h3 id="api-gateway"><a class="header" href="#api-gateway">API Gateway</a></h3>
<p>Create, publish, and manage APIs.</p>
<pre><code class="language-bash"># Create REST API
aws apigateway create-rest-api \
  --name "My API" \
  --description "My REST API" \
  --endpoint-configuration types=REGIONAL

# Get root resource
aws apigateway get-resources \
  --rest-api-id abc123

# Create resource
aws apigateway create-resource \
  --rest-api-id abc123 \
  --parent-id xyz789 \
  --path-part items

# Create method
aws apigateway put-method \
  --rest-api-id abc123 \
  --resource-id uvw456 \
  --http-method GET \
  --authorization-type NONE

# Create Lambda integration
aws apigateway put-integration \
  --rest-api-id abc123 \
  --resource-id uvw456 \
  --http-method GET \
  --type AWS_PROXY \
  --integration-http-method POST \
  --uri arn:aws:apigateway:region:lambda:path/2015-03-31/functions/arn:aws:lambda:region:account-id:function:my-function/invocations

# Deploy API
aws apigateway create-deployment \
  --rest-api-id abc123 \
  --stage-name prod

# API URL format:
# https://abc123.execute-api.region.amazonaws.com/prod/items

# Enable API key
aws apigateway create-api-key \
  --name "My API Key" \
  --enabled

# Create usage plan
aws apigateway create-usage-plan \
  --name "Basic Plan" \
  --throttle burstLimit=100,rateLimit=50 \
  --quota limit=10000,period=MONTH

# Associate API key with usage plan
aws apigateway create-usage-plan-key \
  --usage-plan-id def456 \
  --key-id ghi789 \
  --key-type API_KEY
</code></pre>
<h2 id="container-services"><a class="header" href="#container-services">Container Services</a></h2>
<h3 id="amazon-ecs-elastic-container-service"><a class="header" href="#amazon-ecs-elastic-container-service">Amazon ECS (Elastic Container Service)</a></h3>
<p>Container orchestration service.</p>
<h4 id="ecs-architecture"><a class="header" href="#ecs-architecture">ECS Architecture</a></h4>
<pre><code>┌─────────────────────────────────────────────────┐
│              ECS Cluster                         │
├─────────────────────────────────────────────────┤
│                                                  │
│  ┌─────────────────────────────────────────┐   │
│  │         ECS Service                      │   │
│  │  (Desired Count: 3)                      │   │
│  └──────────┬──────────────────────────────┘   │
│             │                                    │
│    ┌────────┼────────┐                          │
│    │        │        │                          │
│ ┌──▼──┐  ┌──▼──┐  ┌──▼──┐                      │
│ │Task │  │Task │  │Task │                      │
│ │  1  │  │  2  │  │  3  │                      │
│ └──┬──┘  └──┬──┘  └──┬──┘                      │
│    │        │        │                          │
│ ┌──▼───────▼────────▼───┐                      │
│ │    Container(s)        │                      │
│ │  ┌────────────────┐   │                      │
│ │  │  nginx:latest  │   │                      │
│ │  └────────────────┘   │                      │
│ └────────────────────────┘                      │
│                                                  │
│  Launch Type: EC2 or Fargate                    │
└─────────────────────────────────────────────────┘
</code></pre>
<h4 id="ecs-task-definition-example"><a class="header" href="#ecs-task-definition-example">ECS Task Definition Example</a></h4>
<pre><code class="language-json">{
  "family": "web-app",
  "networkMode": "awsvpc",
  "requiresCompatibilities": ["FARGATE"],
  "cpu": "256",
  "memory": "512",
  "executionRoleArn": "arn:aws:iam::123456789012:role/ecsTaskExecutionRole",
  "containerDefinitions": [
    {
      "name": "nginx",
      "image": "nginx:latest",
      "portMappings": [
        {
          "containerPort": 80,
          "protocol": "tcp"
        }
      ],
      "essential": true,
      "environment": [
        {
          "name": "ENV",
          "value": "production"
        }
      ],
      "logConfiguration": {
        "logDriver": "awslogs",
        "options": {
          "awslogs-group": "/ecs/web-app",
          "awslogs-region": "us-east-1",
          "awslogs-stream-prefix": "nginx"
        }
      }
    }
  ]
}
</code></pre>
<h4 id="ecs-cli-examples"><a class="header" href="#ecs-cli-examples">ECS CLI Examples</a></h4>
<pre><code class="language-bash"># Create cluster (Fargate)
aws ecs create-cluster --cluster-name my-cluster

# Register task definition
aws ecs register-task-definition --cli-input-json file://task-definition.json

# Create service
aws ecs create-service \
  --cluster my-cluster \
  --service-name web-service \
  --task-definition web-app:1 \
  --desired-count 3 \
  --launch-type FARGATE \
  --network-configuration "awsvpcConfiguration={subnets=[subnet-12345,subnet-67890],securityGroups=[sg-12345],assignPublicIp=ENABLED}" \
  --load-balancers "targetGroupArn=arn:aws:elasticloadbalancing:region:account-id:targetgroup/my-targets/73e2d6bc24d8a067,containerName=nginx,containerPort=80"

# List services
aws ecs list-services --cluster my-cluster

# Describe service
aws ecs describe-services \
  --cluster my-cluster \
  --services web-service

# Update service (e.g., change desired count)
aws ecs update-service \
  --cluster my-cluster \
  --service web-service \
  --desired-count 5

# Run standalone task
aws ecs run-task \
  --cluster my-cluster \
  --task-definition web-app:1 \
  --launch-type FARGATE \
  --network-configuration "awsvpcConfiguration={subnets=[subnet-12345],securityGroups=[sg-12345],assignPublicIp=ENABLED}"

# View logs
aws logs tail /ecs/web-app --follow

# Stop task
aws ecs stop-task \
  --cluster my-cluster \
  --task arn:aws:ecs:region:account-id:task/my-cluster/abc123

# Delete service
aws ecs delete-service \
  --cluster my-cluster \
  --service web-service \
  --force

# Delete cluster
aws ecs delete-cluster --cluster my-cluster
</code></pre>
<h3 id="amazon-eks-elastic-kubernetes-service"><a class="header" href="#amazon-eks-elastic-kubernetes-service">Amazon EKS (Elastic Kubernetes Service)</a></h3>
<p>Managed Kubernetes service.</p>
<pre><code class="language-bash"># Create EKS cluster (using eksctl - easier)
eksctl create cluster \
  --name my-cluster \
  --region us-east-1 \
  --nodegroup-name standard-workers \
  --node-type t3.medium \
  --nodes 3 \
  --nodes-min 1 \
  --nodes-max 4 \
  --managed

# Or using AWS CLI (more complex)
aws eks create-cluster \
  --name my-cluster \
  --role-arn arn:aws:iam::123456789012:role/eks-service-role \
  --resources-vpc-config subnetIds=subnet-12345,subnet-67890,securityGroupIds=sg-12345

# Update kubeconfig
aws eks update-kubeconfig --name my-cluster --region us-east-1

# Verify connection
kubectl get nodes

# Deploy application
kubectl apply -f deployment.yaml

# List clusters
aws eks list-clusters

# Describe cluster
aws eks describe-cluster --name my-cluster

# Delete cluster (eksctl)
eksctl delete cluster --name my-cluster
</code></pre>
<h3 id="aws-fargate"><a class="header" href="#aws-fargate">AWS Fargate</a></h3>
<p>Serverless compute for containers (works with ECS and EKS).</p>
<p><strong>Benefits</strong>:</p>
<ul>
<li>No EC2 instances to manage</li>
<li>Pay only for resources used</li>
<li>Automatic scaling</li>
<li>Built-in security</li>
</ul>
<p><strong>Use Cases</strong>:</p>
<ul>
<li>Microservices</li>
<li>Batch processing</li>
<li>CI/CD tasks</li>
<li>Event-driven applications</li>
</ul>
<h2 id="security-services"><a class="header" href="#security-services">Security Services</a></h2>
<h3 id="aws-iam-identity-and-access-management"><a class="header" href="#aws-iam-identity-and-access-management">AWS IAM (Identity and Access Management)</a></h3>
<p>Control access to AWS resources.</p>
<h4 id="iam-concepts"><a class="header" href="#iam-concepts">IAM Concepts</a></h4>
<pre><code>┌─────────────────────────────────────────┐
│ AWS Account                              │
├─────────────────────────────────────────┤
│                                          │
│  Users          Groups         Roles    │
│  ├─ Alice      ├─ Developers  ├─ EC2   │
│  ├─ Bob        ├─ Admins      ├─ Lambda│
│  └─ Charlie    └─ Viewers     └─ ECS   │
│                                          │
│  Policies (JSON documents)               │
│  ├─ Managed Policies (AWS/Custom)       │
│  └─ Inline Policies                     │
└─────────────────────────────────────────┘
</code></pre>
<h4 id="iam-policy-example"><a class="header" href="#iam-policy-example">IAM Policy Example</a></h4>
<pre><code class="language-json">{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "AllowS3ReadWrite",
      "Effect": "Allow",
      "Action": [
        "s3:GetObject",
        "s3:PutObject",
        "s3:DeleteObject"
      ],
      "Resource": "arn:aws:s3:::my-bucket/*"
    },
    {
      "Sid": "AllowS3ListBucket",
      "Effect": "Allow",
      "Action": "s3:ListBucket",
      "Resource": "arn:aws:s3:::my-bucket"
    },
    {
      "Sid": "DenyInsecureTransport",
      "Effect": "Deny",
      "Action": "s3:*",
      "Resource": [
        "arn:aws:s3:::my-bucket",
        "arn:aws:s3:::my-bucket/*"
      ],
      "Condition": {
        "Bool": {
          "aws:SecureTransport": "false"
        }
      }
    }
  ]
}
</code></pre>
<h4 id="iam-cli-examples"><a class="header" href="#iam-cli-examples">IAM CLI Examples</a></h4>
<pre><code class="language-bash"># Create user
aws iam create-user --user-name alice

# Create access key
aws iam create-access-key --user-name alice

# Create group
aws iam create-group --group-name developers

# Add user to group
aws iam add-user-to-group \
  --user-name alice \
  --group-name developers

# Create policy
aws iam create-policy \
  --policy-name S3ReadWritePolicy \
  --policy-document file://policy.json

# Attach policy to user
aws iam attach-user-policy \
  --user-name alice \
  --policy-arn arn:aws:iam::123456789012:policy/S3ReadWritePolicy

# Attach policy to group
aws iam attach-group-policy \
  --group-name developers \
  --policy-arn arn:aws:iam::aws:policy/PowerUserAccess

# Create role (for EC2)
aws iam create-role \
  --role-name EC2-S3-Role \
  --assume-role-policy-document '{
    "Version": "2012-10-17",
    "Statement": [{
      "Effect": "Allow",
      "Principal": {"Service": "ec2.amazonaws.com"},
      "Action": "sts:AssumeRole"
    }]
  }'

# Attach policy to role
aws iam attach-role-policy \
  --role-name EC2-S3-Role \
  --policy-arn arn:aws:iam::aws:policy/AmazonS3ReadOnlyAccess

# Create instance profile
aws iam create-instance-profile \
  --instance-profile-name EC2-S3-Profile

# Add role to instance profile
aws iam add-role-to-instance-profile \
  --instance-profile-name EC2-S3-Profile \
  --role-name EC2-S3-Role

# Associate instance profile with EC2
aws ec2 associate-iam-instance-profile \
  --instance-id i-1234567890abcdef0 \
  --iam-instance-profile Name=EC2-S3-Profile

# List users
aws iam list-users

# List policies attached to user
aws iam list-attached-user-policies --user-name alice

# Delete user (must remove from groups and detach policies first)
aws iam remove-user-from-group --user-name alice --group-name developers
aws iam detach-user-policy --user-name alice --policy-arn arn:aws:iam::123456789012:policy/S3ReadWritePolicy
aws iam delete-user --user-name alice
</code></pre>
<h3 id="aws-secrets-manager"><a class="header" href="#aws-secrets-manager">AWS Secrets Manager</a></h3>
<p>Store and rotate secrets.</p>
<pre><code class="language-bash"># Create secret
aws secretsmanager create-secret \
  --name prod/db/password \
  --description "Database password for production" \
  --secret-string '{"username":"admin","password":"MySecurePassword123"}'

# Get secret value
aws secretsmanager get-secret-value --secret-id prod/db/password

# Update secret
aws secretsmanager update-secret \
  --secret-id prod/db/password \
  --secret-string '{"username":"admin","password":"NewPassword456"}'

# Enable automatic rotation
aws secretsmanager rotate-secret \
  --secret-id prod/db/password \
  --rotation-lambda-arn arn:aws:lambda:region:account-id:function:my-rotation-function \
  --rotation-rules AutomaticallyAfterDays=30

# Delete secret (with recovery window)
aws secretsmanager delete-secret \
  --secret-id prod/db/password \
  --recovery-window-in-days 30
</code></pre>
<h4 id="use-secret-in-lambda-python"><a class="header" href="#use-secret-in-lambda-python">Use Secret in Lambda (Python)</a></h4>
<pre><code class="language-python">import boto3
import json

def get_secret(secret_name):
    client = boto3.client('secretsmanager')
    
    try:
        response = client.get_secret_value(SecretId=secret_name)
        secret = json.loads(response['SecretString'])
        return secret
    except Exception as e:
        print(f"Error retrieving secret: {e}")
        raise

def lambda_handler(event, context):
    # Get database credentials
    db_secret = get_secret('prod/db/password')
    
    username = db_secret['username']
    password = db_secret['password']
    
    # Use credentials to connect to database
    # ...
    
    return {'statusCode': 200}
</code></pre>
<h3 id="aws-kms-key-management-service"><a class="header" href="#aws-kms-key-management-service">AWS KMS (Key Management Service)</a></h3>
<p>Manage encryption keys.</p>
<pre><code class="language-bash"># Create KMS key
aws kms create-key \
  --description "Application data encryption key"

# Create alias
aws kms create-alias \
  --alias-name alias/app-data-key \
  --target-key-id 1234abcd-12ab-34cd-56ef-1234567890ab

# Encrypt data
aws kms encrypt \
  --key-id alias/app-data-key \
  --plaintext "sensitive data" \
  --output text \
  --query CiphertextBlob

# Decrypt data
aws kms decrypt \
  --ciphertext-blob fileb://encrypted-data \
  --output text \
  --query Plaintext | base64 --decode

# List keys
aws kms list-keys

# Enable key rotation
aws kms enable-key-rotation --key-id 1234abcd-12ab-34cd-56ef-1234567890ab
</code></pre>
<h2 id="monitoring-and-management"><a class="header" href="#monitoring-and-management">Monitoring and Management</a></h2>
<h3 id="amazon-cloudwatch"><a class="header" href="#amazon-cloudwatch">Amazon CloudWatch</a></h3>
<p>Monitoring and observability service.</p>
<h4 id="cloudwatch-metrics"><a class="header" href="#cloudwatch-metrics">CloudWatch Metrics</a></h4>
<pre><code class="language-bash"># Put custom metric
aws cloudwatch put-metric-data \
  --namespace "MyApp" \
  --metric-name "RequestCount" \
  --value 100 \
  --timestamp $(date -u +"%Y-%m-%dT%H:%M:%S")

# Get metric statistics
aws cloudwatch get-metric-statistics \
  --namespace AWS/EC2 \
  --metric-name CPUUtilization \
  --dimensions Name=InstanceId,Value=i-1234567890abcdef0 \
  --start-time $(date -u -d '1 hour ago' +"%Y-%m-%dT%H:%M:%S") \
  --end-time $(date -u +"%Y-%m-%dT%H:%M:%S") \
  --period 300 \
  --statistics Average

# Create alarm
aws cloudwatch put-metric-alarm \
  --alarm-name high-cpu \
  --alarm-description "Alert when CPU exceeds 80%" \
  --metric-name CPUUtilization \
  --namespace AWS/EC2 \
  --statistic Average \
  --period 300 \
  --evaluation-periods 2 \
  --threshold 80 \
  --comparison-operator GreaterThanThreshold \
  --dimensions Name=InstanceId,Value=i-1234567890abcdef0 \
  --alarm-actions arn:aws:sns:region:account-id:my-topic

# List alarms
aws cloudwatch describe-alarms

# Delete alarm
aws cloudwatch delete-alarms --alarm-names high-cpu
</code></pre>
<h4 id="cloudwatch-logs"><a class="header" href="#cloudwatch-logs">CloudWatch Logs</a></h4>
<pre><code class="language-bash"># Create log group
aws logs create-log-group --log-group-name /aws/lambda/my-function

# Create log stream
aws logs create-log-stream \
  --log-group-name /aws/lambda/my-function \
  --log-stream-name 2024/01/01/instance-123

# Put log events
aws logs put-log-events \
  --log-group-name /aws/lambda/my-function \
  --log-stream-name 2024/01/01/instance-123 \
  --log-events timestamp=$(date +%s000),message="Application started"

# Tail logs
aws logs tail /aws/lambda/my-function --follow

# Filter logs
aws logs filter-log-events \
  --log-group-name /aws/lambda/my-function \
  --filter-pattern "ERROR" \
  --start-time $(date -d '1 hour ago' +%s)000

# Create metric filter
aws logs put-metric-filter \
  --log-group-name /aws/lambda/my-function \
  --filter-name ErrorCount \
  --filter-pattern "[ERROR]" \
  --metric-transformations \
    metricName=ErrorCount,metricNamespace=MyApp,metricValue=1

# Export logs to S3
aws logs create-export-task \
  --log-group-name /aws/lambda/my-function \
  --from $(date -d '1 day ago' +%s)000 \
  --to $(date +%s)000 \
  --destination my-logs-bucket \
  --destination-prefix lambda-logs/

# Set retention policy
aws logs put-retention-policy \
  --log-group-name /aws/lambda/my-function \
  --retention-in-days 30

# Delete log group
aws logs delete-log-group --log-group-name /aws/lambda/my-function
</code></pre>
<h3 id="aws-cloudtrail"><a class="header" href="#aws-cloudtrail">AWS CloudTrail</a></h3>
<p>Track user activity and API usage.</p>
<pre><code class="language-bash"># Create trail
aws cloudtrail create-trail \
  --name my-trail \
  --s3-bucket-name my-cloudtrail-bucket

# Start logging
aws cloudtrail start-logging --name my-trail

# Lookup events
aws cloudtrail lookup-events \
  --lookup-attributes AttributeKey=EventName,AttributeValue=RunInstances \
  --max-results 10

# Get trail status
aws cloudtrail get-trail-status --name my-trail

# Stop logging
aws cloudtrail stop-logging --name my-trail

# Delete trail
aws cloudtrail delete-trail --name my-trail
</code></pre>
<h2 id="devops-and-cicd"><a class="header" href="#devops-and-cicd">DevOps and CI/CD</a></h2>
<h3 id="aws-codecommit"><a class="header" href="#aws-codecommit">AWS CodeCommit</a></h3>
<p>Git repository hosting.</p>
<pre><code class="language-bash"># Create repository
aws codecommit create-repository \
  --repository-name my-repo \
  --repository-description "My application code"

# Clone repository
git clone https://git-codecommit.us-east-1.amazonaws.com/v1/repos/my-repo

# Or with SSH
git clone ssh://git-codecommit.us-east-1.amazonaws.com/v1/repos/my-repo

# List repositories
aws codecommit list-repositories

# Get repository details
aws codecommit get-repository --repository-name my-repo

# Delete repository
aws codecommit delete-repository --repository-name my-repo
</code></pre>
<h3 id="aws-codebuild"><a class="header" href="#aws-codebuild">AWS CodeBuild</a></h3>
<p>Build and test code.</p>
<h4 id="buildspecyml-example"><a class="header" href="#buildspecyml-example">buildspec.yml Example</a></h4>
<pre><code class="language-yaml">version: 0.2

phases:
  install:
    runtime-versions:
      python: 3.11
    commands:
      - echo "Installing dependencies..."
      - pip install -r requirements.txt
  
  pre_build:
    commands:
      - echo "Running tests..."
      - pytest tests/
      - echo "Logging in to Amazon ECR..."
      - aws ecr get-login-password --region $AWS_DEFAULT_REGION | docker login --username AWS --password-stdin $AWS_ACCOUNT_ID.dkr.ecr.$AWS_DEFAULT_REGION.amazonaws.com
  
  build:
    commands:
      - echo "Building Docker image..."
      - docker build -t $IMAGE_REPO_NAME:$IMAGE_TAG .
      - docker tag $IMAGE_REPO_NAME:$IMAGE_TAG $AWS_ACCOUNT_ID.dkr.ecr.$AWS_DEFAULT_REGION.amazonaws.com/$IMAGE_REPO_NAME:$IMAGE_TAG
  
  post_build:
    commands:
      - echo "Pushing Docker image..."
      - docker push $AWS_ACCOUNT_ID.dkr.ecr.$AWS_DEFAULT_REGION.amazonaws.com/$IMAGE_REPO_NAME:$IMAGE_TAG
      - echo "Build completed on `date`"

artifacts:
  files:
    - '**/*'
  name: build-output

cache:
  paths:
    - '/root/.cache/pip/**/*'
</code></pre>
<pre><code class="language-bash"># Create build project
aws codebuild create-project \
  --name my-build-project \
  --source type=CODECOMMIT,location=https://git-codecommit.us-east-1.amazonaws.com/v1/repos/my-repo \
  --artifacts type=S3,location=my-build-artifacts-bucket \
  --environment type=LINUX_CONTAINER,image=aws/codebuild/standard:5.0,computeType=BUILD_GENERAL1_SMALL \
  --service-role arn:aws:iam::123456789012:role/codebuild-service-role

# Start build
aws codebuild start-build --project-name my-build-project

# Get build details
aws codebuild batch-get-builds --ids my-build-project:build-id
</code></pre>
<h3 id="aws-codedeploy"><a class="header" href="#aws-codedeploy">AWS CodeDeploy</a></h3>
<p>Automate application deployments.</p>
<pre><code class="language-bash"># Create application
aws deploy create-application \
  --application-name my-app \
  --compute-platform Server

# Create deployment group
aws deploy create-deployment-group \
  --application-name my-app \
  --deployment-group-name production \
  --deployment-config-name CodeDeployDefault.OneAtATime \
  --ec2-tag-filters Key=Environment,Value=Production,Type=KEY_AND_VALUE \
  --service-role-arn arn:aws:iam::123456789012:role/CodeDeployServiceRole

# Create deployment
aws deploy create-deployment \
  --application-name my-app \
  --deployment-group-name production \
  --s3-location bucket=my-deployments-bucket,key=app-v1.0.zip,bundleType=zip

# Get deployment status
aws deploy get-deployment --deployment-id d-ABCDEF123
</code></pre>
<h3 id="aws-codepipeline"><a class="header" href="#aws-codepipeline">AWS CodePipeline</a></h3>
<p>Continuous delivery service.</p>
<h4 id="pipeline-structure"><a class="header" href="#pipeline-structure">Pipeline Structure</a></h4>
<pre><code>┌──────────────┐    ┌──────────────┐    ┌──────────────┐    ┌──────────────┐
│   Source     │───▶│    Build     │───▶│     Test     │───▶│    Deploy    │
│ (CodeCommit) │    │ (CodeBuild)  │    │ (CodeBuild)  │    │ (CodeDeploy) │
└──────────────┘    └──────────────┘    └──────────────┘    └──────────────┘
</code></pre>
<pre><code class="language-bash"># Create pipeline
aws codepipeline create-pipeline --cli-input-json file://pipeline.json

# Get pipeline details
aws codepipeline get-pipeline --name my-pipeline

# Start pipeline execution
aws codepipeline start-pipeline-execution --name my-pipeline

# Get pipeline state
aws codepipeline get-pipeline-state --name my-pipeline
</code></pre>
<h2 id="machine-learning-services"><a class="header" href="#machine-learning-services">Machine Learning Services</a></h2>
<h3 id="amazon-sagemaker"><a class="header" href="#amazon-sagemaker">Amazon SageMaker</a></h3>
<p>Build, train, and deploy ML models.</p>
<pre><code class="language-python">import boto3
import sagemaker
from sagemaker import get_execution_role
from sagemaker.sklearn import SKLearn

# Set up
role = get_execution_role()
session = sagemaker.Session()
bucket = session.default_bucket()

# Train model
sklearn_estimator = SKLearn(
    entry_point='train.py',
    role=role,
    instance_type='ml.m5.xlarge',
    framework_version='0.23-1',
    hyperparameters={
        'n_estimators': 100,
        'max_depth': 5
    }
)

sklearn_estimator.fit({'train': 's3://bucket/train-data'})

# Deploy model
predictor = sklearn_estimator.deploy(
    initial_instance_count=1,
    instance_type='ml.t2.medium'
)

# Make predictions
result = predictor.predict(data)
</code></pre>
<h3 id="amazon-rekognition"><a class="header" href="#amazon-rekognition">Amazon Rekognition</a></h3>
<p>Image and video analysis.</p>
<pre><code class="language-python">import boto3

rekognition = boto3.client('rekognition')

# Detect labels in image
response = rekognition.detect_labels(
    Image={'S3Object': {'Bucket': 'my-bucket', 'Name': 'image.jpg'}},
    MaxLabels=10,
    MinConfidence=75
)

for label in response['Labels']:
    print(f"{label['Name']}: {label['Confidence']:.2f}%")

# Detect faces
response = rekognition.detect_faces(
    Image={'S3Object': {'Bucket': 'my-bucket', 'Name': 'face.jpg'}},
    Attributes=['ALL']
)

# Compare faces
response = rekognition.compare_faces(
    SourceImage={'S3Object': {'Bucket': 'my-bucket', 'Name': 'source.jpg'}},
    TargetImage={'S3Object': {'Bucket': 'my-bucket', 'Name': 'target.jpg'}},
    SimilarityThreshold=80
)
</code></pre>
<h3 id="amazon-comprehend"><a class="header" href="#amazon-comprehend">Amazon Comprehend</a></h3>
<p>Natural language processing.</p>
<pre><code class="language-python">import boto3

comprehend = boto3.client('comprehend')

text = "Amazon Web Services is a great cloud platform."

# Detect sentiment
sentiment = comprehend.detect_sentiment(Text=text, LanguageCode='en')
print(f"Sentiment: {sentiment['Sentiment']}")

# Detect entities
entities = comprehend.detect_entities(Text=text, LanguageCode='en')
for entity in entities['Entities']:
    print(f"{entity['Text']}: {entity['Type']}")

# Detect key phrases
phrases = comprehend.detect_key_phrases(Text=text, LanguageCode='en')
for phrase in phrases['KeyPhrases']:
    print(phrase['Text'])
</code></pre>
<h2 id="architecture-examples"><a class="header" href="#architecture-examples">Architecture Examples</a></h2>
<h3 id="three-tier-web-application"><a class="header" href="#three-tier-web-application">Three-Tier Web Application</a></h3>
<pre><code>                         Internet
                             │
                    ┌────────▼────────┐
                    │   CloudFront    │  CDN
                    │   (Optional)    │
                    └────────┬────────┘
                             │
                    ┌────────▼────────┐
                    │  Route 53       │  DNS
                    └────────┬────────┘
                             │
┌────────────────────────────▼────────────────────────────────┐
│                          VPC                                 │
│                                                              │
│  ┌───────────────────────────────────────────────────────┐  │
│  │  Public Subnet (AZ-A)    Public Subnet (AZ-B)        │  │
│  │  ┌─────────────────┐     ┌─────────────────┐         │  │
│  │  │  Application    │     │  Application    │         │  │
│  │  │  Load Balancer  │     │  Load Balancer  │         │  │
│  │  └────────┬────────┘     └────────┬────────┘         │  │
│  └───────────┼──────────────────────┼───────────────────┘  │
│              │                      │                       │
│  ┌───────────▼──────────────────────▼───────────────────┐  │
│  │  Private Subnet (AZ-A)   Private Subnet (AZ-B)       │  │
│  │  ┌─────────────┐          ┌─────────────┐            │  │
│  │  │ Auto Scaling│          │ Auto Scaling│            │  │
│  │  │   Group     │          │   Group     │            │  │
│  │  │  ┌───┐ ┌───┐          │  ┌───┐ ┌───┐            │  │
│  │  │  │EC2│ │EC2│          │  │EC2│ │EC2│            │  │
│  │  │  └─┬─┘ └─┬─┘          │  └─┬─┘ └─┬─┘            │  │
│  │  └────┼─────┼────────────┘────┼─────┼──────────────┘  │
│  │       │     │                 │     │                  │
│  │  ┌────▼─────▼─────────────────▼─────▼──────────────┐  │
│  │  │  Database Subnet (AZ-A)   Database Subnet (AZ-B)│  │
│  │  │  ┌──────────────┐          ┌──────────────┐     │  │
│  │  │  │ RDS Primary  │◄────────▶│ RDS Standby  │     │  │
│  │  │  └──────────────┘          └──────────────┘     │  │
│  │  │                                                  │  │
│  │  │  ┌──────────────┐                               │  │
│  │  │  │ ElastiCache  │                               │  │
│  │  │  └──────────────┘                               │  │
│  │  └──────────────────────────────────────────────────┘  │
│  │                                                          │
│  │  Additional Services:                                   │
│  │  ├─ S3: Static assets                                   │
│  │  ├─ CloudWatch: Monitoring                              │
│  │  ├─ CloudTrail: Audit logs                              │
│  │  └─ WAF: Web application firewall                       │
└──────────────────────────────────────────────────────────────┘
</code></pre>
<h3 id="serverless-microservices"><a class="header" href="#serverless-microservices">Serverless Microservices</a></h3>
<pre><code>                        ┌─────────────┐
                        │   Users     │
                        └──────┬──────┘
                               │
                      ┌────────▼────────┐
                      │  CloudFront +   │
                      │  S3 (Frontend)  │
                      └────────┬────────┘
                               │
                      ┌────────▼────────┐
                      │  API Gateway    │
                      └────────┬────────┘
                               │
        ┌──────────────────────┼──────────────────────┐
        │                      │                      │
   ┌────▼─────┐          ┌────▼─────┐          ┌────▼─────┐
   │ Lambda   │          │ Lambda   │          │ Lambda   │
   │ User Svc │          │ Order Svc│          │ Pay Svc  │
   └────┬─────┘          └────┬─────┘          └────┬─────┘
        │                     │                     │
   ┌────▼─────┐          ┌────▼─────┐          ┌────▼─────┐
   │DynamoDB  │          │DynamoDB  │          │DynamoDB  │
   │Users     │          │Orders    │          │Payments  │
   └──────────┘          └──────────┘          └──────────┘
        │                     │                     │
        └─────────────────────┼─────────────────────┘
                              │
                       ┌──────▼──────┐
                       │  EventBridge│
                       │     SNS     │
                       └─────────────┘
</code></pre>
<h2 id="cost-optimization-1"><a class="header" href="#cost-optimization-1">Cost Optimization</a></h2>
<h3 id="cost-optimization-strategies-1"><a class="header" href="#cost-optimization-strategies-1">Cost Optimization Strategies</a></h3>
<pre><code>┌──────────────────────────────────────────────────────────┐
│ AWS Cost Optimization Checklist                          │
├──────────────────────────────────────────────────────────┤
│                                                           │
│ Compute                                                   │
│ ☐ Use Reserved Instances for steady workloads            │
│ ☐ Use Spot Instances for fault-tolerant workloads        │
│ ☐ Right-size instances based on metrics                  │
│ ☐ Use Savings Plans for flexible commitments             │
│ ☐ Stop development/test instances off-hours              │
│ ☐ Use Lambda/Fargate for serverless workloads            │
│ ☐ Enable EC2 Auto Scaling                                │
│                                                           │
│ Storage                                                   │
│ ☐ Use S3 Lifecycle policies                              │
│ ☐ Move infrequent data to S3-IA or Glacier               │
│ ☐ Delete unattached EBS volumes                          │
│ ☐ Delete old snapshots                                   │
│ ☐ Use S3 Intelligent-Tiering                             │
│ ☐ Enable EBS volume encryption only when needed          │
│                                                           │
│ Database                                                  │
│ ☐ Use Aurora Serverless for variable workloads           │
│ ☐ Stop RDS instances when not in use                     │
│ ☐ Use DynamoDB On-Demand for unpredictable traffic       │
│ ☐ Use read replicas efficiently                          │
│ ☐ Right-size RDS instances                               │
│                                                           │
│ Network                                                   │
│ ☐ Use CloudFront to reduce data transfer costs           │
│ ☐ Use VPC endpoints to avoid NAT Gateway costs           │
│ ☐ Consolidate data transfer within same region           │
│ ☐ Use Direct Connect for high volume transfers           │
│                                                           │
│ Monitoring                                                │
│ ☐ Set up AWS Budgets with alerts                         │
│ ☐ Use Cost Explorer to analyze spending                  │
│ ☐ Enable Cost Allocation Tags                            │
│ ☐ Use Trusted Advisor cost optimization checks           │
│ ☐ Review AWS Cost Anomaly Detection                      │
└──────────────────────────────────────────────────────────┘
</code></pre>
<h3 id="aws-cost-management-cli"><a class="header" href="#aws-cost-management-cli">AWS Cost Management CLI</a></h3>
<pre><code class="language-bash"># Set up budget
aws budgets create-budget \
  --account-id 123456789012 \
  --budget '{
    "BudgetName": "Monthly-Budget",
    "BudgetLimit": {
      "Amount": "1000",
      "Unit": "USD"
    },
    "TimeUnit": "MONTHLY",
    "BudgetType": "COST"
  }' \
  --notifications-with-subscribers '[{
    "Notification": {
      "NotificationType": "ACTUAL",
      "ComparisonOperator": "GREATER_THAN",
      "Threshold": 80,
      "ThresholdType": "PERCENTAGE"
    },
    "Subscribers": [{
      "SubscriptionType": "EMAIL",
      "Address": "email@example.com"
    }]
  }]'

# Get cost and usage
aws ce get-cost-and-usage \
  --time-period Start=2024-01-01,End=2024-01-31 \
  --granularity DAILY \
  --metrics BlendedCost

# Get cost forecast
aws ce get-cost-forecast \
  --time-period Start=2024-02-01,End=2024-02-29 \
  --metric BLENDED_COST \
  --granularity MONTHLY
</code></pre>
<h2 id="best-practices-42"><a class="header" href="#best-practices-42">Best Practices</a></h2>
<h3 id="security-best-practices-5"><a class="header" href="#security-best-practices-5">Security Best Practices</a></h3>
<pre><code>1. Identity and Access
   ├─ Enable MFA for all users
   ├─ Use IAM roles instead of access keys
   ├─ Implement least privilege principle
   ├─ Rotate credentials regularly
   └─ Use AWS SSO for centralized access

2. Network Security
   ├─ Use VPC with public/private subnets
   ├─ Implement security groups properly
   ├─ Use Network ACLs as additional layer
   ├─ Enable VPC Flow Logs
   └─ Use AWS WAF for web applications

3. Data Protection
   ├─ Enable encryption at rest
   ├─ Use TLS/SSL for data in transit
   ├─ Regular backups and snapshots
   ├─ Enable versioning on S3
   └─ Use KMS for key management

4. Monitoring and Logging
   ├─ Enable CloudTrail for all regions
   ├─ Use CloudWatch for monitoring
   ├─ Set up security alerts
   ├─ Regular security audits
   └─ Use AWS Config for compliance

5. Incident Response
   ├─ Have incident response plan
   ├─ Use AWS Systems Manager
   ├─ Enable automated responses
   └─ Regular disaster recovery drills
</code></pre>
<h3 id="performance-best-practices"><a class="header" href="#performance-best-practices">Performance Best Practices</a></h3>
<pre><code>1. Compute
   ├─ Choose appropriate instance types
   ├─ Use Auto Scaling
   ├─ Implement load balancing
   ├─ Consider serverless for variable workloads
   └─ Use placement groups for HPC

2. Storage
   ├─ Use EBS-optimized instances
   ├─ Choose correct EBS volume type
   ├─ Use S3 Transfer Acceleration
   ├─ Implement caching (CloudFront, ElastiCache)
   └─ Use S3 multipart upload

3. Database
   ├─ Use read replicas for read-heavy workloads
   ├─ Enable query caching
   ├─ Use connection pooling
   ├─ Implement proper indexing
   └─ Consider Aurora for better performance

4. Network
   ├─ Use CloudFront CDN
   ├─ Enable enhanced networking
   ├─ Use VPC endpoints
   ├─ Implement Route 53 routing policies
   └─ Consider Direct Connect
</code></pre>
<h3 id="reliability-best-practices"><a class="header" href="#reliability-best-practices">Reliability Best Practices</a></h3>
<pre><code>1. High Availability
   ├─ Deploy across multiple AZs
   ├─ Use Multi-AZ for databases
   ├─ Implement auto-scaling
   ├─ Use Elastic Load Balancing
   └─ Consider multi-region for critical workloads

2. Backup and Recovery
   ├─ Automated backups for RDS
   ├─ Regular EBS snapshots
   ├─ Enable S3 versioning
   ├─ Cross-region replication
   └─ Test recovery procedures

3. Monitoring
   ├─ Set up CloudWatch alarms
   ├─ Use health checks
   ├─ Monitor key metrics
   ├─ Implement automated responses
   └─ Use AWS X-Ray for tracing

4. Testing
   ├─ Regular load testing
   ├─ Chaos engineering
   ├─ Failover testing
   └─ Disaster recovery drills
</code></pre>
<h2 id="cli-reference"><a class="header" href="#cli-reference">CLI Reference</a></h2>
<h3 id="common-cli-patterns"><a class="header" href="#common-cli-patterns">Common CLI Patterns</a></h3>
<pre><code class="language-bash"># Use --query for filtering output
aws ec2 describe-instances \
  --query 'Reservations[].Instances[].[InstanceId,State.Name]' \
  --output table

# Use --filters for filtering resources
aws ec2 describe-instances \
  --filters "Name=instance-state-name,Values=running" \
           "Name=tag:Environment,Values=production"

# Use --output for different formats
aws ec2 describe-instances --output json
aws ec2 describe-instances --output yaml
aws ec2 describe-instances --output table
aws ec2 describe-instances --output text

# Use JMESPath for complex queries
aws ec2 describe-instances \
  --query 'Reservations[].Instances[?State.Name==`running`].[InstanceId,PrivateIpAddress]'

# Paginate results
aws s3api list-objects-v2 \
  --bucket my-bucket \
  --max-items 100 \
  --page-size 10

# Wait for resource to be ready
aws ec2 wait instance-running --instance-ids i-1234567890abcdef0

# Generate skeleton for complex commands
aws ec2 run-instances --generate-cli-skeleton &gt; template.json
# Edit template.json
aws ec2 run-instances --cli-input-json file://template.json
</code></pre>
<h3 id="useful-aliases"><a class="header" href="#useful-aliases">Useful Aliases</a></h3>
<pre><code class="language-bash"># Add to ~/.bashrc or ~/.zshrc

alias ec2-list='aws ec2 describe-instances --query "Reservations[].Instances[].[InstanceId,InstanceType,State.Name,PublicIpAddress,Tags[?Key=='\''Name'\''].Value|[0]]" --output table'

alias ec2-running='aws ec2 describe-instances --filters "Name=instance-state-name,Values=running" --query "Reservations[].Instances[].[InstanceId,InstanceType,PublicIpAddress]" --output table'

alias s3-buckets='aws s3 ls'

alias lambda-list='aws lambda list-functions --query "Functions[].[FunctionName,Runtime,LastModified]" --output table'

alias rds-list='aws rds describe-db-instances --query "DBInstances[].[DBInstanceIdentifier,DBInstanceStatus,Engine,DBInstanceClass]" --output table'
</code></pre>
<h2 id="certification-paths"><a class="header" href="#certification-paths">Certification Paths</a></h2>
<h3 id="aws-certification-roadmap"><a class="header" href="#aws-certification-roadmap">AWS Certification Roadmap</a></h3>
<pre><code>Foundational
    │
    └─ AWS Certified Cloud Practitioner
        │
        ├─ Associate Level
        │   ├─ Solutions Architect Associate
        │   ├─ Developer Associate
        │   └─ SysOps Administrator Associate
        │
        └─ Professional Level
            ├─ Solutions Architect Professional
            └─ DevOps Engineer Professional
            
        Specialty (Optional)
        ├─ Security Specialty
        ├─ Machine Learning Specialty
        ├─ Advanced Networking Specialty
        ├─ Database Specialty
        └─ Data Analytics Specialty
</code></pre>
<h2 id="resources-28"><a class="header" href="#resources-28">Resources</a></h2>
<h3 id="official-documentation-3"><a class="header" href="#official-documentation-3">Official Documentation</a></h3>
<ul>
<li>AWS Documentation: https://docs.aws.amazon.com</li>
<li>AWS CLI Reference: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/index.html</li>
<li>AWS SDK Documentation: https://aws.amazon.com/tools/</li>
</ul>
<h3 id="learning-resources-2"><a class="header" href="#learning-resources-2">Learning Resources</a></h3>
<ul>
<li>AWS Training and Certification: https://aws.amazon.com/training/</li>
<li>AWS Free Tier: https://aws.amazon.com/free/</li>
<li>AWS Well-Architected Framework: https://aws.amazon.com/architecture/well-architected/</li>
<li>AWS Samples: https://github.com/aws-samples</li>
<li>AWS Workshops: https://workshops.aws/</li>
</ul>
<h3 id="community-5"><a class="header" href="#community-5">Community</a></h3>
<ul>
<li>r/aws: Reddit community</li>
<li>AWS Forums: https://forums.aws.amazon.com/</li>
<li>AWS re:Post: https://repost.aws/</li>
<li>AWS User Groups: https://aws.amazon.com/developer/community/usergroups/</li>
</ul>
<h3 id="tools-6"><a class="header" href="#tools-6">Tools</a></h3>
<ul>
<li>AWS CLI: Command-line interface</li>
<li>AWS SDKs: Python (Boto3), JavaScript, Java, .NET, etc.</li>
<li>AWS CDK: Infrastructure as code using programming languages</li>
<li>Terraform: Multi-cloud infrastructure as code</li>
<li>LocalStack: Local AWS cloud emulator</li>
</ul>
<hr />
<p><strong>Updated</strong>: January 2025</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="microsoft-azure-1"><a class="header" href="#microsoft-azure-1">Microsoft Azure</a></h1>
<h2 id="table-of-contents-32"><a class="header" href="#table-of-contents-32">Table of Contents</a></h2>
<ul>
<li><a href="cloud/azure.html#introduction">Introduction</a></li>
<li><a href="cloud/azure.html#azure-global-infrastructure">Azure Global Infrastructure</a></li>
<li><a href="cloud/azure.html#getting-started">Getting Started</a></li>
<li><a href="cloud/azure.html#core-compute-services">Core Compute Services</a></li>
<li><a href="cloud/azure.html#storage-services">Storage Services</a></li>
<li><a href="cloud/azure.html#database-services">Database Services</a></li>
<li><a href="cloud/azure.html#networking-services">Networking Services</a></li>
<li><a href="cloud/azure.html#serverless-services">Serverless Services</a></li>
<li><a href="cloud/azure.html#container-services">Container Services</a></li>
<li><a href="cloud/azure.html#security-services">Security Services</a></li>
<li><a href="cloud/azure.html#monitoring-and-management">Monitoring and Management</a></li>
<li><a href="cloud/azure.html#devops-and-cicd">DevOps and CI/CD</a></li>
<li><a href="cloud/azure.html#ai-and-machine-learning">AI and Machine Learning</a></li>
<li><a href="cloud/azure.html#architecture-examples">Architecture Examples</a></li>
<li><a href="cloud/azure.html#azure-vs-aws-comparison">Azure vs AWS Comparison</a></li>
<li><a href="cloud/azure.html#cost-optimization">Cost Optimization</a></li>
<li><a href="cloud/azure.html#best-practices">Best Practices</a></li>
<li><a href="cloud/azure.html#cli-reference">CLI Reference</a></li>
</ul>
<h2 id="introduction-14"><a class="header" href="#introduction-14">Introduction</a></h2>
<p>Microsoft Azure is a cloud computing platform providing 200+ services for building, deploying, and managing applications through Microsoft's global network of data centers.</p>
<h3 id="key-advantages-1"><a class="header" href="#key-advantages-1">Key Advantages</a></h3>
<ul>
<li><strong>Enterprise Integration</strong>: Seamless integration with Microsoft products (Office 365, Active Directory, Dynamics)</li>
<li><strong>Hybrid Cloud</strong>: Industry-leading hybrid cloud capabilities with Azure Arc</li>
<li><strong>Global Reach</strong>: 60+ regions (more than any other cloud provider)</li>
<li><strong>Compliance</strong>: Most comprehensive compliance offerings</li>
<li><strong>Windows Workloads</strong>: Best platform for .NET and Windows-based applications</li>
<li><strong>Developer Tools</strong>: Excellent integration with Visual Studio and GitHub</li>
</ul>
<h3 id="azure-account-hierarchy"><a class="header" href="#azure-account-hierarchy">Azure Account Hierarchy</a></h3>
<pre><code>┌─────────────────────────────────────────────────┐
│        Azure Entra ID (Azure AD) Tenant          │
│        (Organization-wide identity)              │
└──────────────────┬──────────────────────────────┘
                   │
         ┌─────────▼─────────┐
         │  Management Groups │
         └─────────┬──────────┘
                   │
         ┌─────────▼─────────┐
         │   Subscriptions    │
         │  ├─ Production     │
         │  ├─ Development    │
         │  └─ Testing        │
         └─────────┬──────────┘
                   │
         ┌─────────▼─────────┐
         │  Resource Groups   │
         │  ├─ RG-Web         │
         │  ├─ RG-Database    │
         │  └─ RG-Network     │
         └─────────┬──────────┘
                   │
         ┌─────────▼─────────┐
         │     Resources      │
         │  ├─ VMs            │
         │  ├─ Storage        │
         │  └─ Databases      │
         └────────────────────┘
</code></pre>
<h2 id="azure-global-infrastructure"><a class="header" href="#azure-global-infrastructure">Azure Global Infrastructure</a></h2>
<h3 id="hierarchy-1"><a class="header" href="#hierarchy-1">Hierarchy</a></h3>
<pre><code>Geography (e.g., United States)
  └─ Region (e.g., East US, West US)
      └─ Availability Zones (3 per region)
          └─ Data Centers
              └─ Edge Locations (Azure Front Door)
</code></pre>
<h3 id="azure-regions"><a class="header" href="#azure-regions">Azure Regions</a></h3>
<p><strong>Azure has 60+ regions worldwide</strong> - more than any other cloud provider</p>
<p><strong>Paired Regions</strong>: Each region is paired with another region for disaster recovery</p>
<ul>
<li>Example: East US ↔ West US</li>
<li>Example: North Europe ↔ West Europe</li>
</ul>
<h3 id="availability-zones"><a class="header" href="#availability-zones">Availability Zones</a></h3>
<ul>
<li>3 or more physically separate zones within a region</li>
<li>Each zone has independent power, cooling, networking</li>
<li>&lt; 2ms latency between zones</li>
<li>Not all regions have Availability Zones</li>
</ul>
<h3 id="region-selection-criteria-1"><a class="header" href="#region-selection-criteria-1">Region Selection Criteria</a></h3>
<pre><code>Factor              Consideration
────────────────────────────────────────────────
Latency             Distance to users
Compliance          Data residency requirements
Services            Service availability varies
Cost                Pricing differs by region
Paired Region       Consider DR requirements
</code></pre>
<h2 id="getting-started-3"><a class="header" href="#getting-started-3">Getting Started</a></h2>
<h3 id="azure-cli-installation"><a class="header" href="#azure-cli-installation">Azure CLI Installation</a></h3>
<pre><code class="language-bash"># Install Azure CLI (Linux)
curl -sL https://aka.ms/InstallAzureCLIDeb | sudo bash

# Install Azure CLI (macOS)
brew update &amp;&amp; brew install azure-cli

# Install Azure CLI (Windows - PowerShell)
Invoke-WebRequest -Uri https://aka.ms/installazurecliwindows -OutFile .\AzureCLI.msi
Start-Process msiexec.exe -Wait -ArgumentList '/I AzureCLI.msi /quiet'

# Verify installation
az --version

# Login to Azure
az login

# Login with specific tenant
az login --tenant TENANT_ID

# Login with service principal
az login --service-principal \
  --username APP_ID \
  --password PASSWORD \
  --tenant TENANT_ID

# Set default subscription
az account set --subscription "My Subscription"

# List subscriptions
az account list --output table

# Show current subscription
az account show
</code></pre>
<h3 id="azure-powershell"><a class="header" href="#azure-powershell">Azure PowerShell</a></h3>
<pre><code class="language-powershell"># Install Azure PowerShell
Install-Module -Name Az -Repository PSGallery -Force

# Connect to Azure
Connect-AzAccount

# Set subscription
Set-AzContext -SubscriptionId "subscription-id"

# List subscriptions
Get-AzSubscription

# List resource groups
Get-AzResourceGroup
</code></pre>
<h3 id="basic-azure-cli-commands"><a class="header" href="#basic-azure-cli-commands">Basic Azure CLI Commands</a></h3>
<pre><code class="language-bash"># Get help
az help
az vm help

# List all resource groups
az group list --output table

# List all resources
az resource list --output table

# List available locations
az account list-locations --output table

# List available VM sizes
az vm list-sizes --location eastus --output table

# Interactive mode
az interactive
</code></pre>
<h2 id="core-compute-services-1"><a class="header" href="#core-compute-services-1">Core Compute Services</a></h2>
<h3 id="azure-virtual-machines"><a class="header" href="#azure-virtual-machines">Azure Virtual Machines</a></h3>
<p>Cloud-based virtual servers.</p>
<h4 id="vm-series-and-sizes"><a class="header" href="#vm-series-and-sizes">VM Series and Sizes</a></h4>
<pre><code>Series      vCPU    Memory    Use Case                      AWS Equivalent
────────────────────────────────────────────────────────────────────────────
B-Series    1-20    0.5-80GB  Burstable, dev/test          t3
D-Series    2-96    8-384GB   General purpose              m5
F-Series    2-72    4-144GB   Compute optimized            c5
E-Series    2-96    16-672GB  Memory optimized             r5
M-Series    128-416 2-12TB    Largest memory               x1e
N-Series    6-24    112-448GB GPU instances                p3/g4
</code></pre>
<h4 id="vm-pricing-models"><a class="header" href="#vm-pricing-models">VM Pricing Models</a></h4>
<pre><code>Model                   Discount    Commitment    Use Case
───────────────────────────────────────────────────────────────
Pay-as-you-go          Baseline    None          Short-term
Reserved Instances     Up to 72%   1-3 years     Steady state
Spot VMs               Up to 90%   None          Fault-tolerant
Azure Hybrid Benefit   Up to 85%   None          Existing licenses
</code></pre>
<h4 id="vm-cli-examples"><a class="header" href="#vm-cli-examples">VM CLI Examples</a></h4>
<pre><code class="language-bash"># Create resource group
az group create \
  --name myResourceGroup \
  --location eastus

# List available VM images
az vm image list --output table
az vm image list --publisher MicrosoftWindowsServer --output table

# Create Linux VM
az vm create \
  --resource-group myResourceGroup \
  --name myVM \
  --image Ubuntu2204 \
  --size Standard_B2s \
  --admin-username azureuser \
  --generate-ssh-keys \
  --public-ip-sku Standard \
  --tags Environment=Production Owner=IT

# Create Windows VM
az vm create \
  --resource-group myResourceGroup \
  --name myWindowsVM \
  --image Win2022Datacenter \
  --size Standard_D2s_v3 \
  --admin-username azureuser \
  --admin-password 'SecurePassword123!'

# List VMs
az vm list --output table

# Get VM details
az vm show \
  --resource-group myResourceGroup \
  --name myVM \
  --show-details

# Start VM
az vm start \
  --resource-group myResourceGroup \
  --name myVM

# Stop VM (deallocate to stop billing)
az vm deallocate \
  --resource-group myResourceGroup \
  --name myVM

# Restart VM
az vm restart \
  --resource-group myResourceGroup \
  --name myVM

# Resize VM
az vm resize \
  --resource-group myResourceGroup \
  --name myVM \
  --size Standard_D4s_v3

# Delete VM
az vm delete \
  --resource-group myResourceGroup \
  --name myVM \
  --yes

# Open port
az vm open-port \
  --resource-group myResourceGroup \
  --name myVM \
  --port 80 \
  --priority 1001

# Run command on VM
az vm run-command invoke \
  --resource-group myResourceGroup \
  --name myVM \
  --command-id RunShellScript \
  --scripts "sudo apt-get update &amp;&amp; sudo apt-get install -y nginx"

# Create VM from snapshot
az vm create \
  --resource-group myResourceGroup \
  --name myRestoredVM \
  --attach-os-disk myOSDisk \
  --os-type Linux

# Get VM instance metadata (from within VM)
curl -H Metadata:true "http://169.254.169.254/metadata/instance?api-version=2021-02-01"
</code></pre>
<h4 id="custom-script-extension"><a class="header" href="#custom-script-extension">Custom Script Extension</a></h4>
<pre><code class="language-bash"># Add custom script extension (Linux)
az vm extension set \
  --resource-group myResourceGroup \
  --vm-name myVM \
  --name customScript \
  --publisher Microsoft.Azure.Extensions \
  --settings '{"fileUris": ["https://raw.githubusercontent.com/user/repo/script.sh"],"commandToExecute": "./script.sh"}'

# Add custom script extension (Windows)
az vm extension set \
  --resource-group myResourceGroup \
  --vm-name myWindowsVM \
  --name CustomScriptExtension \
  --publisher Microsoft.Compute \
  --settings '{"fileUris": ["https://example.com/script.ps1"],"commandToExecute": "powershell -ExecutionPolicy Unrestricted -File script.ps1"}'
</code></pre>
<h3 id="azure-virtual-machine-scale-sets-vmss"><a class="header" href="#azure-virtual-machine-scale-sets-vmss">Azure Virtual Machine Scale Sets (VMSS)</a></h3>
<p>Auto-scaling groups of identical VMs.</p>
<h4 id="vmss-architecture"><a class="header" href="#vmss-architecture">VMSS Architecture</a></h4>
<pre><code>┌─────────────────────────────────────────────────┐
│          Azure Load Balancer                     │
└──────────────────┬──────────────────────────────┘
                   │
        ┌──────────┼──────────┐
        │          │          │
    ┌───▼───┐  ┌───▼───┐  ┌───▼───┐
    │ VM 1  │  │ VM 2  │  │ VM 3  │
    └───────┘  └───────┘  └───────┘
        │          │          │
        └──────────┼──────────┘
                   │
        ┌──────────▼──────────┐
        │ Virtual Machine     │
        │ Scale Set (VMSS)    │
        │                     │
        │ Min: 2              │
        │ Current: 3          │
        │ Max: 10             │
        │                     │
        │ Scale Rules:        │
        │ CPU &gt; 75%: +1 VM    │
        │ CPU &lt; 25%: -1 VM    │
        └─────────────────────┘
</code></pre>
<h4 id="vmss-cli-examples"><a class="header" href="#vmss-cli-examples">VMSS CLI Examples</a></h4>
<pre><code class="language-bash"># Create VMSS
az vmss create \
  --resource-group myResourceGroup \
  --name myScaleSet \
  --image Ubuntu2204 \
  --instance-count 3 \
  --vm-sku Standard_B2s \
  --admin-username azureuser \
  --generate-ssh-keys \
  --load-balancer myLoadBalancer \
  --upgrade-policy-mode Automatic

# List VMSS
az vmss list --output table

# Scale manually
az vmss scale \
  --resource-group myResourceGroup \
  --name myScaleSet \
  --new-capacity 5

# Create autoscale profile
az monitor autoscale create \
  --resource-group myResourceGroup \
  --resource myScaleSet \
  --resource-type Microsoft.Compute/virtualMachineScaleSets \
  --name myAutoscaleProfile \
  --min-count 2 \
  --max-count 10 \
  --count 3

# Create autoscale rule (scale out)
az monitor autoscale rule create \
  --resource-group myResourceGroup \
  --autoscale-name myAutoscaleProfile \
  --condition "Percentage CPU &gt; 75 avg 5m" \
  --scale out 1

# Create autoscale rule (scale in)
az monitor autoscale rule create \
  --resource-group myResourceGroup \
  --autoscale-name myAutoscaleProfile \
  --condition "Percentage CPU &lt; 25 avg 5m" \
  --scale in 1

# List VMSS instances
az vmss list-instances \
  --resource-group myResourceGroup \
  --name myScaleSet \
  --output table

# Update VMSS image
az vmss update \
  --resource-group myResourceGroup \
  --name myScaleSet \
  --set virtualMachineProfile.storageProfile.imageReference.version=latest

# Start rolling upgrade
az vmss update-instances \
  --resource-group myResourceGroup \
  --name myScaleSet \
  --instance-ids '*'

# Delete VMSS
az vmss delete \
  --resource-group myResourceGroup \
  --name myScaleSet
</code></pre>
<h3 id="azure-app-service"><a class="header" href="#azure-app-service">Azure App Service</a></h3>
<p>PaaS for web applications.</p>
<pre><code class="language-bash"># Create App Service Plan
az appservice plan create \
  --name myAppServicePlan \
  --resource-group myResourceGroup \
  --sku B1 \
  --is-linux

# Create Web App
az webapp create \
  --resource-group myResourceGroup \
  --plan myAppServicePlan \
  --name myUniqueWebApp123 \
  --runtime "NODE:18-lts"

# Deploy from GitHub
az webapp deployment source config \
  --name myUniqueWebApp123 \
  --resource-group myResourceGroup \
  --repo-url https://github.com/user/repo \
  --branch main \
  --manual-integration

# Deploy from local Git
az webapp deployment source config-local-git \
  --name myUniqueWebApp123 \
  --resource-group myResourceGroup

# Deploy ZIP file
az webapp deployment source config-zip \
  --resource-group myResourceGroup \
  --name myUniqueWebApp123 \
  --src app.zip

# Set environment variables
az webapp config appsettings set \
  --resource-group myResourceGroup \
  --name myUniqueWebApp123 \
  --settings DB_HOST=mydb.database.windows.net DB_NAME=mydb

# Enable HTTPS only
az webapp update \
  --resource-group myResourceGroup \
  --name myUniqueWebApp123 \
  --https-only true

# Scale up (change plan)
az appservice plan update \
  --name myAppServicePlan \
  --resource-group myResourceGroup \
  --sku P1V2

# Scale out (add instances)
az appservice plan update \
  --name myAppServicePlan \
  --resource-group myResourceGroup \
  --number-of-workers 3

# View logs
az webapp log tail \
  --resource-group myResourceGroup \
  --name myUniqueWebApp123

# Restart web app
az webapp restart \
  --resource-group myResourceGroup \
  --name myUniqueWebApp123

# Delete web app
az webapp delete \
  --resource-group myResourceGroup \
  --name myUniqueWebApp123
</code></pre>
<h2 id="storage-services-2"><a class="header" href="#storage-services-2">Storage Services</a></h2>
<h3 id="azure-blob-storage"><a class="header" href="#azure-blob-storage">Azure Blob Storage</a></h3>
<p>Object storage service (equivalent to AWS S3).</p>
<h4 id="blob-storage-types"><a class="header" href="#blob-storage-types">Blob Storage Types</a></h4>
<pre><code>Type            Use Case                        Performance    Cost
────────────────────────────────────────────────────────────────────
Block Blobs     Text and binary data           Standard/Premium  $$
Append Blobs    Logging data                   Standard         $$
Page Blobs      VHD files, random access       Premium          $$$
</code></pre>
<h4 id="blob-access-tiers"><a class="header" href="#blob-access-tiers">Blob Access Tiers</a></h4>
<pre><code>Tier        Access Frequency    Retrieval Time    Cost
─────────────────────────────────────────────────────────
Hot         Frequent            Immediate         $$$
Cool        Infrequent (30d+)   Immediate         $$
Cold        Rare (90d+)         Immediate         $
Archive     Rarely (180d+)      Hours             ¢
</code></pre>
<h4 id="blob-storage-architecture"><a class="header" href="#blob-storage-architecture">Blob Storage Architecture</a></h4>
<pre><code>┌─────────────────────────────────────────────────┐
│  Storage Account: mystorageaccount              │
│  Location: eastus                                │
│  Replication: LRS/GRS/RA-GRS                    │
├─────────────────────────────────────────────────┤
│                                                  │
│  Container: images (Blob Container)             │
│    ├─ logo.png                                  │
│    ├─ banner.jpg                                │
│    └─ photos/                                   │
│        ├─ photo1.jpg                            │
│        └─ photo2.jpg                            │
│                                                  │
│  Container: documents                           │
│    ├─ report.pdf                                │
│    └─ invoice.xlsx                              │
│                                                  │
│  Container: backups                             │
│    └─ database-backup.sql                      │
│                                                  │
│  File Share: fileshare (Azure Files)           │
│    ├─ shared/                                   │
│    └─ config/                                   │
│                                                  │
│  Table Storage (NoSQL)                          │
│  Queue Storage (Message Queue)                  │
└─────────────────────────────────────────────────┘
</code></pre>
<h4 id="blob-storage-cli-examples"><a class="header" href="#blob-storage-cli-examples">Blob Storage CLI Examples</a></h4>
<pre><code class="language-bash"># Create storage account
az storage account create \
  --name mystorageaccount123 \
  --resource-group myResourceGroup \
  --location eastus \
  --sku Standard_LRS \
  --kind StorageV2

# Get connection string
az storage account show-connection-string \
  --name mystorageaccount123 \
  --resource-group myResourceGroup

# Export connection string
export AZURE_STORAGE_CONNECTION_STRING="&lt;connection-string&gt;"

# Create container
az storage container create \
  --name mycontainer \
  --account-name mystorageaccount123 \
  --public-access off

# Upload blob
az storage blob upload \
  --container-name mycontainer \
  --name myfile.txt \
  --file ./local-file.txt \
  --account-name mystorageaccount123

# Upload directory
az storage blob upload-batch \
  --destination mycontainer \
  --source ./local-directory \
  --account-name mystorageaccount123

# Download blob
az storage blob download \
  --container-name mycontainer \
  --name myfile.txt \
  --file ./downloaded-file.txt \
  --account-name mystorageaccount123

# List blobs
az storage blob list \
  --container-name mycontainer \
  --account-name mystorageaccount123 \
  --output table

# Copy blob
az storage blob copy start \
  --source-container mycontainer \
  --source-blob myfile.txt \
  --destination-container backup \
  --destination-blob myfile-backup.txt \
  --account-name mystorageaccount123

# Generate SAS token
az storage blob generate-sas \
  --container-name mycontainer \
  --name myfile.txt \
  --account-name mystorageaccount123 \
  --permissions r \
  --expiry 2024-12-31T23:59:59Z

# Set blob tier
az storage blob set-tier \
  --container-name mycontainer \
  --name myfile.txt \
  --tier Cool \
  --account-name mystorageaccount123

# Delete blob
az storage blob delete \
  --container-name mycontainer \
  --name myfile.txt \
  --account-name mystorageaccount123

# Enable versioning
az storage account blob-service-properties update \
  --account-name mystorageaccount123 \
  --resource-group myResourceGroup \
  --enable-versioning true

# Set lifecycle management policy
az storage account management-policy create \
  --account-name mystorageaccount123 \
  --resource-group myResourceGroup \
  --policy @policy.json
</code></pre>
<h4 id="lifecycle-management-policy-example"><a class="header" href="#lifecycle-management-policy-example">Lifecycle Management Policy Example</a></h4>
<pre><code class="language-json">{
  "rules": [
    {
      "enabled": true,
      "name": "MoveToArchive",
      "type": "Lifecycle",
      "definition": {
        "actions": {
          "baseBlob": {
            "tierToCool": {
              "daysAfterModificationGreaterThan": 30
            },
            "tierToArchive": {
              "daysAfterModificationGreaterThan": 90
            },
            "delete": {
              "daysAfterModificationGreaterThan": 365
            }
          }
        },
        "filters": {
          "blobTypes": ["blockBlob"],
          "prefixMatch": ["logs/"]
        }
      }
    }
  ]
}
</code></pre>
<h4 id="blob-storage-sdk-example-python"><a class="header" href="#blob-storage-sdk-example-python">Blob Storage SDK Example (Python)</a></h4>
<pre><code class="language-python">from azure.storage.blob import BlobServiceClient, BlobClient, ContainerClient
from azure.storage.blob import BlobSasPermissions, generate_blob_sas
from datetime import datetime, timedelta

# Create blob service client
connection_string = "DefaultEndpointsProtocol=https;AccountName=..."
blob_service_client = BlobServiceClient.from_connection_string(connection_string)

# Create container
def create_container(container_name):
    container_client = blob_service_client.create_container(container_name)
    return container_client

# Upload blob
def upload_blob(container_name, blob_name, data):
    blob_client = blob_service_client.get_blob_client(
        container=container_name,
        blob=blob_name
    )
    blob_client.upload_blob(data, overwrite=True)
    print(f"Uploaded {blob_name}")

# Upload file
def upload_file(container_name, file_path, blob_name=None):
    if blob_name is None:
        blob_name = file_path.split('/')[-1]
    
    blob_client = blob_service_client.get_blob_client(
        container=container_name,
        blob=blob_name
    )
    
    with open(file_path, "rb") as data:
        blob_client.upload_blob(data, overwrite=True)
    print(f"Uploaded {file_path} as {blob_name}")

# Download blob
def download_blob(container_name, blob_name, file_path):
    blob_client = blob_service_client.get_blob_client(
        container=container_name,
        blob=blob_name
    )
    
    with open(file_path, "wb") as file:
        data = blob_client.download_blob()
        file.write(data.readall())
    print(f"Downloaded {blob_name} to {file_path}")

# List blobs
def list_blobs(container_name):
    container_client = blob_service_client.get_container_client(container_name)
    blob_list = container_client.list_blobs()
    
    for blob in blob_list:
        print(f"{blob.name}: {blob.size} bytes")

# Generate SAS URL
def generate_sas_url(container_name, blob_name, account_name, account_key):
    sas_token = generate_blob_sas(
        account_name=account_name,
        container_name=container_name,
        blob_name=blob_name,
        account_key=account_key,
        permission=BlobSasPermissions(read=True),
        expiry=datetime.utcnow() + timedelta(hours=1)
    )
    
    url = f"https://{account_name}.blob.core.windows.net/{container_name}/{blob_name}?{sas_token}"
    return url

# Delete blob
def delete_blob(container_name, blob_name):
    blob_client = blob_service_client.get_blob_client(
        container=container_name,
        blob=blob_name
    )
    blob_client.delete_blob()
    print(f"Deleted {blob_name}")

# Usage
create_container("mycontainer")
upload_file("mycontainer", "./local-file.txt")
download_blob("mycontainer", "local-file.txt", "./downloaded.txt")
list_blobs("mycontainer")
</code></pre>
<h3 id="azure-files"><a class="header" href="#azure-files">Azure Files</a></h3>
<p>Managed SMB/NFS file shares.</p>
<pre><code class="language-bash"># Create file share
az storage share create \
  --name myfileshare \
  --account-name mystorageaccount123 \
  --quota 100

# Upload file to share
az storage file upload \
  --share-name myfileshare \
  --source ./local-file.txt \
  --account-name mystorageaccount123

# List files
az storage file list \
  --share-name myfileshare \
  --account-name mystorageaccount123 \
  --output table

# Mount file share (Linux)
sudo mkdir /mnt/azure
sudo mount -t cifs //mystorageaccount123.file.core.windows.net/myfileshare /mnt/azure \
  -o vers=3.0,username=mystorageaccount123,password=&lt;storage-key&gt;,dir_mode=0777,file_mode=0777

# Mount file share (Windows)
net use Z: \\mystorageaccount123.file.core.windows.net\myfileshare /user:Azure\mystorageaccount123 &lt;storage-key&gt;

# Add to /etc/fstab (Linux)
echo "//mystorageaccount123.file.core.windows.net/myfileshare /mnt/azure cifs vers=3.0,username=mystorageaccount123,password=&lt;storage-key&gt;,dir_mode=0777,file_mode=0777 0 0" | sudo tee -a /etc/fstab
</code></pre>
<h3 id="azure-disk-storage"><a class="header" href="#azure-disk-storage">Azure Disk Storage</a></h3>
<p>Managed disks for VMs (equivalent to AWS EBS).</p>
<h4 id="disk-types"><a class="header" href="#disk-types">Disk Types</a></h4>
<pre><code>Type            IOPS        Throughput      Use Case              Cost
─────────────────────────────────────────────────────────────────────
Ultra Disk      160K+       4,000 MB/s      Mission-critical      $$$$
Premium SSD v2  80K         1,200 MB/s      Production DBs        $$$
Premium SSD     20K         900 MB/s        Production            $$
Standard SSD    6K          750 MB/s        Web servers           $
Standard HDD    2K          500 MB/s        Backup, dev/test      ¢
</code></pre>
<pre><code class="language-bash"># Create managed disk
az disk create \
  --resource-group myResourceGroup \
  --name myDataDisk \
  --size-gb 128 \
  --sku Premium_LRS

# Attach disk to VM
az vm disk attach \
  --resource-group myResourceGroup \
  --vm-name myVM \
  --name myDataDisk

# Detach disk
az vm disk detach \
  --resource-group myResourceGroup \
  --vm-name myVM \
  --name myDataDisk

# Create snapshot
az snapshot create \
  --resource-group myResourceGroup \
  --name mySnapshot \
  --source myDataDisk

# Create disk from snapshot
az disk create \
  --resource-group myResourceGroup \
  --name myRestoredDisk \
  --source mySnapshot

# Increase disk size
az disk update \
  --resource-group myResourceGroup \
  --name myDataDisk \
  --size-gb 256
</code></pre>
<h2 id="database-services-2"><a class="header" href="#database-services-2">Database Services</a></h2>
<h3 id="azure-sql-database"><a class="header" href="#azure-sql-database">Azure SQL Database</a></h3>
<p>Managed SQL Server database.</p>
<h4 id="service-tiers"><a class="header" href="#service-tiers">Service Tiers</a></h4>
<pre><code>Tier          vCores    Memory    Max DB Size    Use Case          Cost
────────────────────────────────────────────────────────────────────────
Serverless    0.5-40    3-120GB   4TB           Variable load     $$
General       2-80      10.4-408GB 4TB           Balanced          $$
Purpose
Business      2-128     20.8-625GB 4TB           Mission-critical  $$$$
Critical
Hyperscale    2-128     20.8-625GB 100TB         Large databases   $$$
</code></pre>
<h4 id="sql-database-cli-examples"><a class="header" href="#sql-database-cli-examples">SQL Database CLI Examples</a></h4>
<pre><code class="language-bash"># Create SQL Server
az sql server create \
  --name myuniquesqlserver123 \
  --resource-group myResourceGroup \
  --location eastus \
  --admin-user sqladmin \
  --admin-password 'SecurePassword123!'

# Configure firewall rule
az sql server firewall-rule create \
  --resource-group myResourceGroup \
  --server myuniquesqlserver123 \
  --name AllowMyIP \
  --start-ip-address 1.2.3.4 \
  --end-ip-address 1.2.3.4

# Allow Azure services
az sql server firewall-rule create \
  --resource-group myResourceGroup \
  --server myuniquesqlserver123 \
  --name AllowAzureServices \
  --start-ip-address 0.0.0.0 \
  --end-ip-address 0.0.0.0

# Create database
az sql db create \
  --resource-group myResourceGroup \
  --server myuniquesqlserver123 \
  --name myDatabase \
  --service-objective S0 \
  --backup-storage-redundancy Local

# Create serverless database
az sql db create \
  --resource-group myResourceGroup \
  --server myuniquesqlserver123 \
  --name myServerlessDB \
  --edition GeneralPurpose \
  --compute-model Serverless \
  --family Gen5 \
  --capacity 2 \
  --auto-pause-delay 60

# List databases
az sql db list \
  --resource-group myResourceGroup \
  --server myuniquesqlserver123 \
  --output table

# Scale database
az sql db update \
  --resource-group myResourceGroup \
  --server myuniquesqlserver123 \
  --name myDatabase \
  --service-objective S2

# Create read replica
az sql db replica create \
  --name myDatabase \
  --resource-group myResourceGroup \
  --server myuniquesqlserver123 \
  --partner-server myuniquesqlserver-replica \
  --partner-resource-group myResourceGroup

# Create backup
az sql db export \
  --resource-group myResourceGroup \
  --server myuniquesqlserver123 \
  --name myDatabase \
  --admin-user sqladmin \
  --admin-password 'SecurePassword123!' \
  --storage-key-type StorageAccessKey \
  --storage-key "&lt;storage-key&gt;" \
  --storage-uri "https://mystorageaccount.blob.core.windows.net/backups/mydb.bacpac"

# Restore database
az sql db restore \
  --resource-group myResourceGroup \
  --server myuniquesqlserver123 \
  --name myRestoredDB \
  --source-database myDatabase \
  --time "2024-01-01T00:00:00Z"

# Delete database
az sql db delete \
  --resource-group myResourceGroup \
  --server myuniquesqlserver123 \
  --name myDatabase \
  --yes

# Connect to database
sqlcmd -S myuniquesqlserver123.database.windows.net -d myDatabase -U sqladmin -P 'SecurePassword123!'
</code></pre>
<h4 id="sql-database-connection-example-python"><a class="header" href="#sql-database-connection-example-python">SQL Database Connection Example (Python)</a></h4>
<pre><code class="language-python">import pyodbc

# Connection string
server = 'myuniquesqlserver123.database.windows.net'
database = 'myDatabase'
username = 'sqladmin'
password = 'SecurePassword123!'
driver = '{ODBC Driver 18 for SQL Server}'

connection_string = f'DRIVER={driver};SERVER={server};DATABASE={database};UID={username};PWD={password}'

# Connect to database
conn = pyodbc.connect(connection_string)
cursor = conn.cursor()

# Create table
cursor.execute('''
    CREATE TABLE users (
        id INT PRIMARY KEY IDENTITY,
        name NVARCHAR(100),
        email NVARCHAR(100),
        created_at DATETIME DEFAULT GETDATE()
    )
''')

# Insert data
cursor.execute("INSERT INTO users (name, email) VALUES (?, ?)", ('Alice', 'alice@example.com'))
conn.commit()

# Query data
cursor.execute("SELECT * FROM users")
rows = cursor.fetchall()
for row in rows:
    print(f"ID: {row.id}, Name: {row.name}, Email: {row.email}")

# Close connection
cursor.close()
conn.close()
</code></pre>
<h3 id="azure-cosmos-db"><a class="header" href="#azure-cosmos-db">Azure Cosmos DB</a></h3>
<p>Globally distributed NoSQL database.</p>
<h4 id="cosmos-db-apis"><a class="header" href="#cosmos-db-apis">Cosmos DB APIs</a></h4>
<pre><code>API              Type           Use Case                AWS Equivalent
──────────────────────────────────────────────────────────────────────
Core (SQL)       Document       General purpose         DynamoDB
MongoDB          Document       MongoDB compatibility   DocumentDB
Cassandra        Wide-column    Cassandra workloads     Keyspaces
Gremlin          Graph          Graph relationships     Neptune
Table            Key-value      Simple key-value        DynamoDB
</code></pre>
<h4 id="cosmos-db-cli-examples"><a class="header" href="#cosmos-db-cli-examples">Cosmos DB CLI Examples</a></h4>
<pre><code class="language-bash"># Create Cosmos DB account
az cosmosdb create \
  --name mycosmosaccount123 \
  --resource-group myResourceGroup \
  --locations regionName=eastus failoverPriority=0 \
  --locations regionName=westus failoverPriority=1 \
  --default-consistency-level Session \
  --enable-automatic-failover true

# Create database (SQL API)
az cosmosdb sql database create \
  --account-name mycosmosaccount123 \
  --resource-group myResourceGroup \
  --name myDatabase

# Create container
az cosmosdb sql container create \
  --account-name mycosmosaccount123 \
  --resource-group myResourceGroup \
  --database-name myDatabase \
  --name myContainer \
  --partition-key-path "/userId" \
  --throughput 400

# Get connection string
az cosmosdb keys list \
  --name mycosmosaccount123 \
  --resource-group myResourceGroup \
  --type connection-strings

# List databases
az cosmosdb sql database list \
  --account-name mycosmosaccount123 \
  --resource-group myResourceGroup

# Update throughput
az cosmosdb sql container throughput update \
  --account-name mycosmosaccount123 \
  --resource-group myResourceGroup \
  --database-name myDatabase \
  --name myContainer \
  --throughput 1000
</code></pre>
<h4 id="cosmos-db-sdk-example-python"><a class="header" href="#cosmos-db-sdk-example-python">Cosmos DB SDK Example (Python)</a></h4>
<pre><code class="language-python">from azure.cosmos import CosmosClient, PartitionKey, exceptions

# Initialize client
endpoint = "https://mycosmosaccount123.documents.azure.com:443/"
key = "&lt;primary-key&gt;"
client = CosmosClient(endpoint, key)

# Get database and container
database = client.get_database_client("myDatabase")
container = database.get_container_client("myContainer")

# Create item
item = {
    'id': 'user-001',
    'userId': 'user-001',
    'name': 'Alice',
    'email': 'alice@example.com',
    'age': 30
}
container.create_item(body=item)

# Read item
item = container.read_item(item='user-001', partition_key='user-001')
print(item)

# Query items
query = "SELECT * FROM c WHERE c.age &gt; @age"
parameters = [{"name": "@age", "value": 25}]

items = list(container.query_items(
    query=query,
    parameters=parameters,
    enable_cross_partition_query=True
))

for item in items:
    print(f"{item['name']}: {item['age']} years old")

# Update item
item['age'] = 31
container.replace_item(item='user-001', body=item)

# Delete item
container.delete_item(item='user-001', partition_key='user-001')
</code></pre>
<h3 id="azure-database-for-postgresqlmysql"><a class="header" href="#azure-database-for-postgresqlmysql">Azure Database for PostgreSQL/MySQL</a></h3>
<p>Managed open-source databases.</p>
<pre><code class="language-bash"># Create PostgreSQL server
az postgres flexible-server create \
  --name mypostgresserver123 \
  --resource-group myResourceGroup \
  --location eastus \
  --admin-user myadmin \
  --admin-password 'SecurePassword123!' \
  --sku-name Standard_B1ms \
  --tier Burstable \
  --storage-size 32

# Create MySQL server
az mysql flexible-server create \
  --name mymysqlserver123 \
  --resource-group myResourceGroup \
  --location eastus \
  --admin-user myadmin \
  --admin-password 'SecurePassword123!' \
  --sku-name Standard_B1ms \
  --tier Burstable \
  --storage-size 32

# Configure firewall
az postgres flexible-server firewall-rule create \
  --resource-group myResourceGroup \
  --name mypostgresserver123 \
  --rule-name AllowMyIP \
  --start-ip-address 1.2.3.4 \
  --end-ip-address 1.2.3.4

# Connect to PostgreSQL
psql "host=mypostgresserver123.postgres.database.azure.com port=5432 dbname=postgres user=myadmin password=SecurePassword123! sslmode=require"

# Connect to MySQL
mysql -h mymysqlserver123.mysql.database.azure.com -u myadmin -p
</code></pre>
<h3 id="azure-cache-for-redis"><a class="header" href="#azure-cache-for-redis">Azure Cache for Redis</a></h3>
<p>Managed Redis cache.</p>
<pre><code class="language-bash"># Create Redis cache
az redis create \
  --resource-group myResourceGroup \
  --name myrediscache123 \
  --location eastus \
  --sku Basic \
  --vm-size c0

# Get access keys
az redis list-keys \
  --resource-group myResourceGroup \
  --name myrediscache123

# Get hostname
az redis show \
  --resource-group myResourceGroup \
  --name myrediscache123 \
  --query hostName

# Connect to Redis
redis-cli -h myrediscache123.redis.cache.windows.net -p 6380 -a &lt;primary-key&gt; --tls
</code></pre>
<h2 id="networking-services-2"><a class="header" href="#networking-services-2">Networking Services</a></h2>
<h3 id="azure-virtual-network-vnet"><a class="header" href="#azure-virtual-network-vnet">Azure Virtual Network (VNet)</a></h3>
<p>Isolated network (equivalent to AWS VPC).</p>
<h4 id="vnet-architecture"><a class="header" href="#vnet-architecture">VNet Architecture</a></h4>
<pre><code>┌─────────────────────────────────────────────────────────────┐
│  VNet: my-vnet (10.0.0.0/16)                                │
│  Region: eastus                                              │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  ┌───────────────────────┐  ┌──────────────────────────┐   │
│  │ Public Subnet         │  │ Public Subnet            │   │
│  │ 10.0.1.0/24          │  │ 10.0.2.0/24              │   │
│  │ (AZ 1)               │  │ (AZ 2)                   │   │
│  │                       │  │                          │   │
│  │ ┌─────────────────┐  │  │ ┌─────────────────┐     │   │
│  │ │ Load Balancer   │  │  │ │ Load Balancer   │     │   │
│  │ └─────────────────┘  │  │ └─────────────────┘     │   │
│  └───────────┬───────────┘  └──────────┬───────────────┘   │
│              │                         │                    │
│              │   Azure Gateway         │                    │
│              └──────────┬──────────────┘                    │
│                         │                                   │
│  ┌───────────────────────┐  ┌──────────────────────────┐   │
│  │ Private Subnet        │  │ Private Subnet           │   │
│  │ 10.0.11.0/24         │  │ 10.0.12.0/24             │   │
│  │ (AZ 1)               │  │ (AZ 2)                   │   │
│  │                       │  │                          │   │
│  │ ┌─────┐ ┌─────┐      │  │ ┌─────┐ ┌─────┐         │   │
│  │ │ VM  │ │ VM  │      │  │ │ VM  │ │ VM  │         │   │
│  │ └─────┘ └─────┘      │  │ └─────┘ └─────┘         │   │
│  └───────────────────────┘  └──────────────────────────┘   │
│                                                              │
│  ┌───────────────────────┐  ┌──────────────────────────┐   │
│  │ Database Subnet       │  │ Database Subnet          │   │
│  │ 10.0.21.0/24         │  │ 10.0.22.0/24             │   │
│  │                       │  │                          │   │
│  │ ┌──────────┐          │  │ ┌──────────┐            │   │
│  │ │  SQL DB  │          │  │ │  SQL DB  │            │   │
│  │ └──────────┘          │  │ └──────────┘            │   │
│  └───────────────────────┘  └──────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
</code></pre>
<h4 id="vnet-cli-examples"><a class="header" href="#vnet-cli-examples">VNet CLI Examples</a></h4>
<pre><code class="language-bash"># Create VNet
az network vnet create \
  --resource-group myResourceGroup \
  --name myVNet \
  --address-prefix 10.0.0.0/16 \
  --location eastus

# Create subnet
az network vnet subnet create \
  --resource-group myResourceGroup \
  --vnet-name myVNet \
  --name PublicSubnet \
  --address-prefixes 10.0.1.0/24

az network vnet subnet create \
  --resource-group myResourceGroup \
  --vnet-name myVNet \
  --name PrivateSubnet \
  --address-prefixes 10.0.11.0/24

# List VNets
az network vnet list --output table

# List subnets
az network vnet subnet list \
  --resource-group myResourceGroup \
  --vnet-name myVNet \
  --output table

# Create Network Security Group (NSG)
az network nsg create \
  --resource-group myResourceGroup \
  --name myNSG

# Add NSG rule
az network nsg rule create \
  --resource-group myResourceGroup \
  --nsg-name myNSG \
  --name AllowHTTP \
  --priority 100 \
  --source-address-prefixes '*' \
  --source-port-ranges '*' \
  --destination-address-prefixes '*' \
  --destination-port-ranges 80 \
  --access Allow \
  --protocol Tcp \
  --direction Inbound

az network nsg rule create \
  --resource-group myResourceGroup \
  --nsg-name myNSG \
  --name AllowSSH \
  --priority 110 \
  --source-address-prefixes 'VirtualNetwork' \
  --source-port-ranges '*' \
  --destination-address-prefixes '*' \
  --destination-port-ranges 22 \
  --access Allow \
  --protocol Tcp \
  --direction Inbound

# Associate NSG with subnet
az network vnet subnet update \
  --resource-group myResourceGroup \
  --vnet-name myVNet \
  --name PublicSubnet \
  --network-security-group myNSG

# Create NAT Gateway
az network public-ip create \
  --resource-group myResourceGroup \
  --name myNATGatewayIP \
  --sku Standard \
  --allocation-method Static

az network nat gateway create \
  --resource-group myResourceGroup \
  --name myNATGateway \
  --public-ip-addresses myNATGatewayIP \
  --idle-timeout 10

# Associate NAT Gateway with subnet
az network vnet subnet update \
  --resource-group myResourceGroup \
  --vnet-name myVNet \
  --name PrivateSubnet \
  --nat-gateway myNATGateway

# VNet peering
az network vnet peering create \
  --resource-group myResourceGroup \
  --name myVNet-to-VNet2 \
  --vnet-name myVNet \
  --remote-vnet myVNet2 \
  --allow-vnet-access
</code></pre>
<h3 id="azure-load-balancer"><a class="header" href="#azure-load-balancer">Azure Load Balancer</a></h3>
<p>Distribute traffic across resources.</p>
<h4 id="load-balancer-types-1"><a class="header" href="#load-balancer-types-1">Load Balancer Types</a></h4>
<pre><code>Type                SKU         OSI Layer    Use Case              Cost
───────────────────────────────────────────────────────────────────────
Load Balancer       Basic       Layer 4      Internal/Public       Free
Load Balancer       Standard    Layer 4      Production            $$
Application         Standard    Layer 7      HTTP/HTTPS routing    $$
Gateway
</code></pre>
<pre><code class="language-bash"># Create public IP
az network public-ip create \
  --resource-group myResourceGroup \
  --name myPublicIP \
  --sku Standard

# Create load balancer
az network lb create \
  --resource-group myResourceGroup \
  --name myLoadBalancer \
  --sku Standard \
  --public-ip-address myPublicIP \
  --frontend-ip-name myFrontEnd \
  --backend-pool-name myBackEndPool

# Create health probe
az network lb probe create \
  --resource-group myResourceGroup \
  --lb-name myLoadBalancer \
  --name myHealthProbe \
  --protocol tcp \
  --port 80 \
  --interval 15 \
  --threshold 2

# Create load balancer rule
az network lb rule create \
  --resource-group myResourceGroup \
  --lb-name myLoadBalancer \
  --name myHTTPRule \
  --protocol tcp \
  --frontend-port 80 \
  --backend-port 80 \
  --frontend-ip-name myFrontEnd \
  --backend-pool-name myBackEndPool \
  --probe-name myHealthProbe

# Add VM to backend pool
az network nic ip-config address-pool add \
  --resource-group myResourceGroup \
  --nic-name myNIC \
  --ip-config-name ipconfig1 \
  --lb-name myLoadBalancer \
  --address-pool myBackEndPool
</code></pre>
<h3 id="azure-application-gateway"><a class="header" href="#azure-application-gateway">Azure Application Gateway</a></h3>
<p>Layer 7 load balancer with WAF.</p>
<pre><code class="language-bash"># Create Application Gateway
az network application-gateway create \
  --name myAppGateway \
  --resource-group myResourceGroup \
  --location eastus \
  --vnet-name myVNet \
  --subnet PublicSubnet \
  --capacity 2 \
  --sku Standard_v2 \
  --public-ip-address myPublicIP \
  --servers 10.0.11.4 10.0.11.5

# Create path-based routing rule
az network application-gateway url-path-map create \
  --gateway-name myAppGateway \
  --resource-group myResourceGroup \
  --name myPathMap \
  --paths /images/* \
  --http-settings appGatewayBackendHttpSettings \
  --address-pool imagesBackendPool

# Enable Web Application Firewall (WAF)
az network application-gateway waf-config set \
  --gateway-name myAppGateway \
  --resource-group myResourceGroup \
  --enabled true \
  --firewall-mode Prevention \
  --rule-set-version 3.0
</code></pre>
<h3 id="azure-dns"><a class="header" href="#azure-dns">Azure DNS</a></h3>
<p>DNS hosting service.</p>
<pre><code class="language-bash"># Create DNS zone
az network dns zone create \
  --resource-group myResourceGroup \
  --name example.com

# Create A record
az network dns record-set a add-record \
  --resource-group myResourceGroup \
  --zone-name example.com \
  --record-set-name www \
  --ipv4-address 1.2.3.4

# Create CNAME record
az network dns record-set cname set-record \
  --resource-group myResourceGroup \
  --zone-name example.com \
  --record-set-name blog \
  --cname www.example.com

# List records
az network dns record-set list \
  --resource-group myResourceGroup \
  --zone-name example.com

# Get nameservers
az network dns zone show \
  --resource-group myResourceGroup \
  --name example.com \
  --query nameServers
</code></pre>
<h2 id="serverless-services-1"><a class="header" href="#serverless-services-1">Serverless Services</a></h2>
<h3 id="azure-functions"><a class="header" href="#azure-functions">Azure Functions</a></h3>
<p>Serverless compute (equivalent to AWS Lambda).</p>
<h4 id="function-runtime-versions"><a class="header" href="#function-runtime-versions">Function Runtime Versions</a></h4>
<pre><code>Runtime       Languages                    Timeout (Consumption)
───────────────────────────────────────────────────────────────
4.x (Current) C#, Java, JavaScript,       10 minutes (default)
              Python, PowerShell, TypeScript
</code></pre>
<h4 id="function-triggers"><a class="header" href="#function-triggers">Function Triggers</a></h4>
<pre><code>Trigger Type        Use Case
────────────────────────────────────────────────────
HTTP                REST APIs, webhooks
Timer               Scheduled tasks
Blob Storage        File processing
Queue Storage       Async processing
Event Grid          Event-driven workflows
Event Hub           Real-time data streams
Service Bus         Enterprise messaging
Cosmos DB           Database change feed
</code></pre>
<h4 id="function-example-python"><a class="header" href="#function-example-python">Function Example (Python)</a></h4>
<pre><code class="language-python">import logging
import azure.functions as func

def main(req: func.HttpRequest) -&gt; func.HttpResponse:
    logging.info('Python HTTP trigger function processed a request.')
    
    name = req.params.get('name')
    if not name:
        try:
            req_body = req.get_json()
            name = req_body.get('name')
        except ValueError:
            pass
    
    if name:
        return func.HttpResponse(
            f"Hello, {name}!",
            status_code=200
        )
    else:
        return func.HttpResponse(
            "Please pass a name parameter",
            status_code=400
        )

# Blob trigger example
def main(myblob: func.InputStream):
    logging.info(f"Processing blob: {myblob.name}")
    logging.info(f"Blob size: {myblob.length} bytes")
    
    # Process the blob
    content = myblob.read()
    # Do something with content

# Timer trigger example
def main(mytimer: func.TimerRequest) -&gt; None:
    logging.info('Timer trigger function executed.')
    
    if mytimer.past_due:
        logging.info('The timer is past due!')
    
    # Perform scheduled task
    perform_maintenance()

# Queue trigger example
def main(msg: func.QueueMessage) -&gt; None:
    logging.info(f'Processing queue message: {msg.get_body().decode("utf-8")}')
    
    # Process message
    process_order(msg.get_json())
</code></pre>
<h4 id="functionjson-configuration"><a class="header" href="#functionjson-configuration">function.json Configuration</a></h4>
<pre><code class="language-json">{
  "bindings": [
    {
      "authLevel": "function",
      "type": "httpTrigger",
      "direction": "in",
      "name": "req",
      "methods": ["get", "post"]
    },
    {
      "type": "http",
      "direction": "out",
      "name": "$return"
    }
  ]
}
</code></pre>
<h4 id="azure-functions-cli-examples"><a class="header" href="#azure-functions-cli-examples">Azure Functions CLI Examples</a></h4>
<pre><code class="language-bash"># Install Azure Functions Core Tools
npm install -g azure-functions-core-tools@4

# Create function app locally
func init myFunctionApp --python
cd myFunctionApp

# Create new function
func new --name HttpTrigger --template "HTTP trigger"

# Run locally
func start

# Create function app in Azure
az functionapp create \
  --resource-group myResourceGroup \
  --consumption-plan-location eastus \
  --runtime python \
  --runtime-version 3.11 \
  --functions-version 4 \
  --name myuniquefunctionapp123 \
  --storage-account mystorageaccount123 \
  --os-type Linux

# Deploy to Azure
func azure functionapp publish myuniquefunctionapp123

# View logs
func azure functionapp logstream myuniquefunctionapp123

# Set application settings
az functionapp config appsettings set \
  --name myuniquefunctionapp123 \
  --resource-group myResourceGroup \
  --settings "DB_CONNECTION_STRING=Server=..."

# Enable managed identity
az functionapp identity assign \
  --name myuniquefunctionapp123 \
  --resource-group myResourceGroup

# List functions
az functionapp function list \
  --name myuniquefunctionapp123 \
  --resource-group myResourceGroup

# Delete function app
az functionapp delete \
  --name myuniquefunctionapp123 \
  --resource-group myResourceGroup
</code></pre>
<h4 id="azure-functions-pricing"><a class="header" href="#azure-functions-pricing">Azure Functions Pricing</a></h4>
<pre><code>Plan             Price                   Timeout     Scaling
──────────────────────────────────────────────────────────────
Consumption      $0.20/million requests  10 min      Automatic
                 + $0.000016/GB-s
Premium          $0.169/vCPU hour       Unlimited    Automatic
                 + $0.0123/GB hour
Dedicated        App Service Plan cost  Unlimited    Manual/Auto

Free Tier: 1M requests + 400,000 GB-s/month
</code></pre>
<h3 id="azure-logic-apps"><a class="header" href="#azure-logic-apps">Azure Logic Apps</a></h3>
<p>Workflow automation (similar to AWS Step Functions).</p>
<pre><code class="language-bash"># Create Logic App
az logic workflow create \
  --resource-group myResourceGroup \
  --location eastus \
  --name myLogicApp \
  --definition @workflow.json

# List Logic Apps
az logic workflow list \
  --resource-group myResourceGroup

# Show Logic App
az logic workflow show \
  --resource-group myResourceGroup \
  --name myLogicApp

# Run Logic App
az logic workflow run trigger \
  --resource-group myResourceGroup \
  --name myLogicApp \
  --trigger-name manual
</code></pre>
<h2 id="container-services-1"><a class="header" href="#container-services-1">Container Services</a></h2>
<h3 id="azure-container-instances-aci"><a class="header" href="#azure-container-instances-aci">Azure Container Instances (ACI)</a></h3>
<p>Serverless containers (similar to AWS Fargate).</p>
<pre><code class="language-bash"># Create container instance
az container create \
  --resource-group myResourceGroup \
  --name mycontainer \
  --image nginx:latest \
  --cpu 1 \
  --memory 1.5 \
  --dns-name-label myuniquecontainer123 \
  --ports 80

# List containers
az container list --output table

# Get container logs
az container logs \
  --resource-group myResourceGroup \
  --name mycontainer

# Execute command in container
az container exec \
  --resource-group myResourceGroup \
  --name mycontainer \
  --exec-command "/bin/bash"

# Delete container
az container delete \
  --resource-group myResourceGroup \
  --name mycontainer \
  --yes

# Create container with environment variables
az container create \
  --resource-group myResourceGroup \
  --name myapp \
  --image myregistry.azurecr.io/myapp:latest \
  --cpu 2 \
  --memory 4 \
  --environment-variables \
    'DB_HOST'='mydb.database.windows.net' \
    'DB_NAME'='mydb' \
  --secure-environment-variables \
    'DB_PASSWORD'='SecurePassword123!' \
  --registry-login-server myregistry.azurecr.io \
  --registry-username myregistry \
  --registry-password &lt;password&gt;
</code></pre>
<h3 id="azure-kubernetes-service-aks"><a class="header" href="#azure-kubernetes-service-aks">Azure Kubernetes Service (AKS)</a></h3>
<p>Managed Kubernetes.</p>
<pre><code class="language-bash"># Create AKS cluster
az aks create \
  --resource-group myResourceGroup \
  --name myAKSCluster \
  --node-count 3 \
  --node-vm-size Standard_D2s_v3 \
  --enable-managed-identity \
  --generate-ssh-keys \
  --network-plugin azure \
  --enable-addons monitoring

# Get credentials
az aks get-credentials \
  --resource-group myResourceGroup \
  --name myAKSCluster

# Verify connection
kubectl get nodes

# Scale cluster
az aks scale \
  --resource-group myResourceGroup \
  --name myAKSCluster \
  --node-count 5

# Upgrade cluster
az aks upgrade \
  --resource-group myResourceGroup \
  --name myAKSCluster \
  --kubernetes-version 1.28.0

# Enable cluster autoscaler
az aks update \
  --resource-group myResourceGroup \
  --name myAKSCluster \
  --enable-cluster-autoscaler \
  --min-count 3 \
  --max-count 10

# List available versions
az aks get-versions --location eastus --output table

# Delete cluster
az aks delete \
  --resource-group myResourceGroup \
  --name myAKSCluster \
  --yes
</code></pre>
<h3 id="azure-container-registry-acr"><a class="header" href="#azure-container-registry-acr">Azure Container Registry (ACR)</a></h3>
<p>Docker registry (similar to AWS ECR).</p>
<pre><code class="language-bash"># Create container registry
az acr create \
  --resource-group myResourceGroup \
  --name myuniqueregistry123 \
  --sku Basic

# Login to registry
az acr login --name myuniqueregistry123

# Tag image
docker tag myapp:latest myuniqueregistry123.azurecr.io/myapp:v1.0

# Push image
docker push myuniqueregistry123.azurecr.io/myapp:v1.0

# List images
az acr repository list --name myuniqueregistry123 --output table

# List tags
az acr repository show-tags \
  --name myuniqueregistry123 \
  --repository myapp \
  --output table

# Delete image
az acr repository delete \
  --name myuniqueregistry123 \
  --image myapp:v1.0 \
  --yes
</code></pre>
<h2 id="security-services-1"><a class="header" href="#security-services-1">Security Services</a></h2>
<h3 id="azure-active-directory-azure-entra-id"><a class="header" href="#azure-active-directory-azure-entra-id">Azure Active Directory (Azure Entra ID)</a></h3>
<p>Identity and access management.</p>
<pre><code class="language-bash"># Create user
az ad user create \
  --display-name "Alice Smith" \
  --user-principal-name alice@contoso.com \
  --password SecurePassword123!

# Create group
az ad group create \
  --display-name Developers \
  --mail-nickname developers

# Add user to group
az ad group member add \
  --group Developers \
  --member-id &lt;user-object-id&gt;

# Create service principal
az ad sp create-for-rbac \
  --name myServicePrincipal \
  --role Contributor \
  --scopes /subscriptions/&lt;subscription-id&gt;

# List users
az ad user list --output table

# List groups
az ad group list --output table
</code></pre>
<h3 id="azure-key-vault"><a class="header" href="#azure-key-vault">Azure Key Vault</a></h3>
<p>Secrets management (similar to AWS Secrets Manager).</p>
<pre><code class="language-bash"># Create Key Vault
az keyvault create \
  --name myuniquekeyvault123 \
  --resource-group myResourceGroup \
  --location eastus

# Set secret
az keyvault secret set \
  --vault-name myuniquekeyvault123 \
  --name dbpassword \
  --value "SecurePassword123!"

# Get secret
az keyvault secret show \
  --vault-name myuniquekeyvault123 \
  --name dbpassword \
  --query value \
  --output tsv

# List secrets
az keyvault secret list \
  --vault-name myuniquekeyvault123 \
  --output table

# Delete secret
az keyvault secret delete \
  --vault-name myuniquekeyvault123 \
  --name dbpassword

# Set access policy
az keyvault set-policy \
  --name myuniquekeyvault123 \
  --upn alice@contoso.com \
  --secret-permissions get list set delete

# Create certificate
az keyvault certificate create \
  --vault-name myuniquekeyvault123 \
  --name mycert \
  --policy "$(az keyvault certificate get-default-policy)"

# Import certificate
az keyvault certificate import \
  --vault-name myuniquekeyvault123 \
  --name imported-cert \
  --file certificate.pfx
</code></pre>
<h4 id="use-key-vault-in-application-python"><a class="header" href="#use-key-vault-in-application-python">Use Key Vault in Application (Python)</a></h4>
<pre><code class="language-python">from azure.identity import DefaultAzureCredential
from azure.keyvault.secrets import SecretClient

# Create client
credential = DefaultAzureCredential()
vault_url = "https://myuniquekeyvault123.vault.azure.net"
client = SecretClient(vault_url=vault_url, credential=credential)

# Get secret
secret = client.get_secret("dbpassword")
print(f"Secret value: {secret.value}")

# Set secret
client.set_secret("newsecret", "newvalue")

# List secrets
secrets = client.list_properties_of_secrets()
for secret in secrets:
    print(f"Secret name: {secret.name}")

# Delete secret
client.begin_delete_secret("newsecret").wait()
</code></pre>
<h3 id="azure-rbac-role-based-access-control"><a class="header" href="#azure-rbac-role-based-access-control">Azure RBAC (Role-Based Access Control)</a></h3>
<pre><code class="language-bash"># List role definitions
az role definition list --output table

# Assign role to user
az role assignment create \
  --assignee alice@contoso.com \
  --role Contributor \
  --scope /subscriptions/&lt;subscription-id&gt;/resourceGroups/myResourceGroup

# Assign role to service principal
az role assignment create \
  --assignee &lt;service-principal-object-id&gt; \
  --role "Storage Blob Data Contributor" \
  --scope /subscriptions/&lt;subscription-id&gt;/resourceGroups/myResourceGroup/providers/Microsoft.Storage/storageAccounts/mystorageaccount123

# List role assignments
az role assignment list \
  --assignee alice@contoso.com \
  --output table

# Remove role assignment
az role assignment delete \
  --assignee alice@contoso.com \
  --role Contributor \
  --scope /subscriptions/&lt;subscription-id&gt;/resourceGroups/myResourceGroup

# Create custom role
az role definition create --role-definition @custom-role.json
</code></pre>
<h4 id="custom-role-definition-example"><a class="header" href="#custom-role-definition-example">Custom Role Definition Example</a></h4>
<pre><code class="language-json">{
  "Name": "Custom VM Operator",
  "Description": "Can start and stop VMs",
  "Actions": [
    "Microsoft.Compute/virtualMachines/start/action",
    "Microsoft.Compute/virtualMachines/restart/action",
    "Microsoft.Compute/virtualMachines/deallocate/action",
    "Microsoft.Compute/virtualMachines/read"
  ],
  "NotActions": [],
  "AssignableScopes": [
    "/subscriptions/&lt;subscription-id&gt;"
  ]
}
</code></pre>
<h2 id="monitoring-and-management-1"><a class="header" href="#monitoring-and-management-1">Monitoring and Management</a></h2>
<h3 id="azure-monitor"><a class="header" href="#azure-monitor">Azure Monitor</a></h3>
<p>Monitoring and observability (similar to CloudWatch).</p>
<pre><code class="language-bash"># Create action group
az monitor action-group create \
  --name myActionGroup \
  --resource-group myResourceGroup \
  --short-name myAG \
  --email-receiver name=admin email=admin@example.com

# Create metric alert
az monitor metrics alert create \
  --name high-cpu \
  --resource-group myResourceGroup \
  --scopes /subscriptions/&lt;subscription-id&gt;/resourceGroups/myResourceGroup/providers/Microsoft.Compute/virtualMachines/myVM \
  --condition "avg Percentage CPU &gt; 80" \
  --window-size 5m \
  --evaluation-frequency 1m \
  --action myActionGroup

# List alerts
az monitor metrics alert list \
  --resource-group myResourceGroup

# Query metrics
az monitor metrics list \
  --resource /subscriptions/&lt;subscription-id&gt;/resourceGroups/myResourceGroup/providers/Microsoft.Compute/virtualMachines/myVM \
  --metric "Percentage CPU" \
  --start-time 2024-01-01T00:00:00Z \
  --end-time 2024-01-01T23:59:59Z \
  --interval PT1H
</code></pre>
<h3 id="azure-log-analytics"><a class="header" href="#azure-log-analytics">Azure Log Analytics</a></h3>
<p>Log collection and analysis.</p>
<pre><code class="language-bash"># Create Log Analytics workspace
az monitor log-analytics workspace create \
  --resource-group myResourceGroup \
  --workspace-name myWorkspace \
  --location eastus

# Query logs (KQL - Kusto Query Language)
az monitor log-analytics query \
  --workspace myWorkspace \
  --analytics-query "AzureActivity | where TimeGenerated &gt; ago(1h) | summarize count() by OperationName"

# Example KQL queries
# All logs from last hour
"AzureActivity | where TimeGenerated &gt; ago(1h)"

# Count errors by resource
"AzureDiagnostics | where Level == 'Error' | summarize count() by Resource"

# VM performance - CPU over 80%
"Perf | where CounterName == '% Processor Time' and CounterValue &gt; 80"

# Failed login attempts
"SigninLogs | where ResultType != 0 | project TimeGenerated, UserPrincipalName, ResultType, ResultDescription"
</code></pre>
<h3 id="azure-application-insights"><a class="header" href="#azure-application-insights">Azure Application Insights</a></h3>
<p>Application performance monitoring.</p>
<pre><code class="language-python">from applicationinsights import TelemetryClient

# Initialize client
tc = TelemetryClient('&lt;instrumentation-key&gt;')

# Track event
tc.track_event('UserLogin', {'user': 'alice@example.com'})

# Track metric
tc.track_metric('request_duration', 125.5)

# Track exception
try:
    result = 1 / 0
except Exception as e:
    tc.track_exception()

# Track request
tc.track_request('GET /api/users', 'https://myapi.com/api/users', True, 200, 125)

# Track dependency
tc.track_dependency('SQL', 'mydb.database.windows.net', 'SELECT * FROM users', 45, True, 'Query')

# Flush telemetry
tc.flush()
</code></pre>
<pre><code class="language-bash"># Enable Application Insights for web app
az webapp config appsettings set \
  --resource-group myResourceGroup \
  --name myUniqueWebApp123 \
  --settings "APPINSIGHTS_INSTRUMENTATIONKEY=&lt;instrumentation-key&gt;"
</code></pre>
<h2 id="devops-and-cicd-1"><a class="header" href="#devops-and-cicd-1">DevOps and CI/CD</a></h2>
<h3 id="azure-devops"><a class="header" href="#azure-devops">Azure DevOps</a></h3>
<p>Complete DevOps platform.</p>
<h4 id="azure-pipelines-yaml-example"><a class="header" href="#azure-pipelines-yaml-example">Azure Pipelines YAML Example</a></h4>
<pre><code class="language-yaml"># azure-pipelines.yml
trigger:
  - main

pool:
  vmImage: 'ubuntu-latest'

variables:
  buildConfiguration: 'Release'

stages:
- stage: Build
  jobs:
  - job: BuildJob
    steps:
    - task: UsePythonVersion@0
      inputs:
        versionSpec: '3.11'
    
    - script: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt
      displayName: 'Install dependencies'
    
    - script: |
        pytest tests/ --junitxml=junit/test-results.xml
      displayName: 'Run tests'
    
    - task: PublishTestResults@2
      inputs:
        testResultsFiles: '**/test-results.xml'
    
    - script: |
        docker build -t myapp:$(Build.BuildId) .
      displayName: 'Build Docker image'
    
    - task: Docker@2
      inputs:
        containerRegistry: 'myACR'
        repository: 'myapp'
        command: 'push'
        tags: |
          $(Build.BuildId)
          latest

- stage: Deploy
  dependsOn: Build
  jobs:
  - deployment: DeployJob
    environment: 'production'
    strategy:
      runOnce:
        deploy:
          steps:
          - task: AzureWebAppContainer@1
            inputs:
              azureSubscription: 'myServiceConnection'
              appName: 'myUniqueWebApp123'
              containers: 'myregistry.azurecr.io/myapp:$(Build.BuildId)'
</code></pre>
<h3 id="azure-cli-for-devops"><a class="header" href="#azure-cli-for-devops">Azure CLI for DevOps</a></h3>
<pre><code class="language-bash"># Create Azure DevOps project
az devops project create --name MyProject --org https://dev.azure.com/myorg

# Create pipeline
az pipelines create \
  --name MyPipeline \
  --repository https://github.com/user/repo \
  --branch main \
  --yml-path azure-pipelines.yml

# Run pipeline
az pipelines run --name MyPipeline

# List pipelines
az pipelines list --output table

# Show pipeline runs
az pipelines runs list --pipeline-name MyPipeline --output table
</code></pre>
<h2 id="ai-and-machine-learning"><a class="header" href="#ai-and-machine-learning">AI and Machine Learning</a></h2>
<h3 id="azure-openai-service"><a class="header" href="#azure-openai-service">Azure OpenAI Service</a></h3>
<p>Access to OpenAI models (GPT-4, GPT-3.5, DALL-E, Whisper).</p>
<pre><code class="language-python">import openai

# Configure
openai.api_type = "azure"
openai.api_base = "https://myopenai.openai.azure.com/"
openai.api_version = "2023-05-15"
openai.api_key = "&lt;api-key&gt;"

# Generate completion
response = openai.ChatCompletion.create(
    engine="gpt-4",  # deployment name
    messages=[
        {"role": "system", "content": "You are a helpful assistant."},
        {"role": "user", "content": "Explain cloud computing in simple terms."}
    ],
    temperature=0.7,
    max_tokens=800
)

print(response.choices[0].message.content)

# Generate image
response = openai.Image.create(
    prompt="A futuristic cloud data center",
    n=1,
    size="1024x1024"
)

image_url = response['data'][0]['url']
</code></pre>
<h3 id="azure-cognitive-services"><a class="header" href="#azure-cognitive-services">Azure Cognitive Services</a></h3>
<p>Pre-built AI services.</p>
<pre><code class="language-python">from azure.ai.textanalytics import TextAnalyticsClient
from azure.core.credentials import AzureKeyCredential

# Text Analytics
endpoint = "https://myservice.cognitiveservices.azure.com/"
key = "&lt;api-key&gt;"

client = TextAnalyticsClient(endpoint=endpoint, credential=AzureKeyCredential(key))

# Sentiment analysis
documents = ["I love Azure!", "This is terrible."]
result = client.analyze_sentiment(documents)

for doc in result:
    print(f"Sentiment: {doc.sentiment}, Confidence: {doc.confidence_scores}")

# Entity recognition
result = client.recognize_entities(["Microsoft was founded by Bill Gates."])
for doc in result:
    for entity in doc.entities:
        print(f"Entity: {entity.text}, Category: {entity.category}")

# Key phrase extraction
result = client.extract_key_phrases(["Azure is a cloud computing platform."])
for doc in result:
    print(f"Key phrases: {doc.key_phrases}")
</code></pre>
<h3 id="azure-machine-learning"><a class="header" href="#azure-machine-learning">Azure Machine Learning</a></h3>
<p>End-to-end ML platform.</p>
<pre><code class="language-python">from azureml.core import Workspace, Experiment, ScriptRunConfig

# Connect to workspace
ws = Workspace.from_config()

# Create experiment
experiment = Experiment(workspace=ws, name='my-experiment')

# Configure training run
config = ScriptRunConfig(
    source_directory='./src',
    script='train.py',
    compute_target='cpu-cluster',
    environment='AzureML-sklearn-1.0'
)

# Submit run
run = experiment.submit(config)
run.wait_for_completion(show_output=True)

# Register model
model = run.register_model(
    model_name='my-model',
    model_path='outputs/model.pkl'
)

# Deploy model
from azureml.core.webservice import AciWebservice
from azureml.core.model import InferenceConfig

inference_config = InferenceConfig(
    entry_script='score.py',
    environment='AzureML-sklearn-1.0'
)

aci_config = AciWebservice.deploy_configuration(
    cpu_cores=1,
    memory_gb=1
)

service = Model.deploy(
    workspace=ws,
    name='my-service',
    models=[model],
    inference_config=inference_config,
    deployment_config=aci_config
)

service.wait_for_deployment(show_output=True)
print(f"Scoring URI: {service.scoring_uri}")
</code></pre>
<h2 id="architecture-examples-1"><a class="header" href="#architecture-examples-1">Architecture Examples</a></h2>
<h3 id="three-tier-web-application-1"><a class="header" href="#three-tier-web-application-1">Three-Tier Web Application</a></h3>
<pre><code>                         Internet
                             │
                    ┌────────▼────────┐
                    │  Azure Front    │  CDN
                    │  Door           │
                    └────────┬────────┘
                             │
                    ┌────────▼────────┐
                    │  Azure DNS      │
                    └────────┬────────┘
                             │
┌────────────────────────────▼────────────────────────────────┐
│                      Virtual Network                         │
│                                                              │
│  ┌──────────────────────────────────────────────────────┐  │
│  │  Public Subnet (AZ-1)    Public Subnet (AZ-2)       │  │
│  │  ┌──────────────────┐    ┌──────────────────┐      │  │
│  │  │ Application      │    │ Application      │      │  │
│  │  │ Gateway + WAF    │    │ Gateway + WAF    │      │  │
│  │  └────────┬─────────┘    └────────┬─────────┘      │  │
│  └───────────┼──────────────────────┼─────────────────┘  │
│              │                      │                      │
│  ┌───────────▼──────────────────────▼─────────────────┐  │
│  │  Private Subnet (AZ-1)   Private Subnet (AZ-2)     │  │
│  │  ┌────────────────┐       ┌────────────────┐       │  │
│  │  │ VMSS           │       │ VMSS           │       │  │
│  │  │  ┌──┐ ┌──┐     │       │  ┌──┐ ┌──┐     │       │  │
│  │  │  │VM│ │VM│     │       │  │VM│ │VM│     │       │  │
│  │  │  └──┘ └──┘     │       │  └──┘ └──┘     │       │  │
│  │  └────────┬───────┘       └────────┬───────┘       │  │
│  └───────────┼──────────────────────┼─────────────────┘  │
│              │                      │                      │
│  ┌───────────▼──────────────────────▼─────────────────┐  │
│  │  Database Subnet (AZ-1)  Database Subnet (AZ-2)    │  │
│  │  ┌──────────────┐        ┌──────────────┐          │  │
│  │  │ Azure SQL    │◄──────▶│ Azure SQL    │          │  │
│  │  │ Primary      │        │ Secondary    │          │  │
│  │  └──────────────┘        └──────────────┘          │  │
│  │                                                      │  │
│  │  ┌──────────────────────────────┐                   │  │
│  │  │ Azure Cache for Redis        │                   │  │
│  │  └──────────────────────────────┘                   │  │
│  └──────────────────────────────────────────────────────┘  │
│                                                              │
│  Additional Services:                                       │
│  ├─ Blob Storage: Static assets                             │
│  ├─ Key Vault: Secrets management                           │
│  ├─ Monitor: Monitoring and alerts                          │
│  └─ Application Insights: APM                               │
└──────────────────────────────────────────────────────────────┘
</code></pre>
<h3 id="serverless-microservices-1"><a class="header" href="#serverless-microservices-1">Serverless Microservices</a></h3>
<pre><code>                        ┌─────────────┐
                        │   Users     │
                        └──────┬──────┘
                               │
                      ┌────────▼────────┐
                      │  Azure Front    │
                      │  Door + Blob    │
                      │  (Frontend)     │
                      └────────┬────────┘
                               │
                      ┌────────▼────────┐
                      │  API Management │
                      └────────┬────────┘
                               │
        ┌──────────────────────┼──────────────────────┐
        │                      │                      │
   ┌────▼──────┐         ┌────▼──────┐         ┌────▼──────┐
   │ Function  │         │ Function  │         │ Function  │
   │ User Svc  │         │ Order Svc │         │ Pay Svc   │
   └────┬──────┘         └────┬──────┘         └────┬──────┘
        │                     │                     │
   ┌────▼──────┐         ┌────▼──────┐         ┌────▼──────┐
   │Cosmos DB  │         │Cosmos DB  │         │Cosmos DB  │
   │Users      │         │Orders     │         │Payments   │
   └───────────┘         └───────────┘         └───────────┘
        │                     │                     │
        └─────────────────────┼─────────────────────┘
                              │
                       ┌──────▼──────┐
                       │  Event Grid │
                       │  Service Bus│
                       └─────────────┘
</code></pre>
<h2 id="azure-vs-aws-comparison"><a class="header" href="#azure-vs-aws-comparison">Azure vs AWS Comparison</a></h2>
<h3 id="service-mapping"><a class="header" href="#service-mapping">Service Mapping</a></h3>
<pre><code>Service Category      Azure                      AWS
─────────────────────────────────────────────────────────────────
Compute
  VMs                 Virtual Machines           EC2
  Auto-scaling        VMSS                       Auto Scaling
  Serverless          Functions                  Lambda
  Containers          AKS / ACI                  EKS / ECS / Fargate
  PaaS                App Service                Elastic Beanstalk

Storage
  Object              Blob Storage               S3
  Block               Managed Disks              EBS
  File                Azure Files                EFS
  Archive             Archive Storage            Glacier

Database
  Relational          SQL Database               RDS
  NoSQL Document      Cosmos DB                  DynamoDB
  Cache               Cache for Redis            ElastiCache
  Data Warehouse      Synapse Analytics          Redshift

Networking
  Virtual Network     VNet                       VPC
  Load Balancer       Load Balancer / App GW     ELB / ALB / NLB
  CDN                 Front Door / CDN           CloudFront
  DNS                 Azure DNS                  Route 53
  VPN                 VPN Gateway                VPN Gateway

Security
  Identity            Azure AD (Entra ID)        IAM / Cognito
  Secrets             Key Vault                  Secrets Manager
  Encryption          Key Vault                  KMS

Monitoring
  Metrics             Azure Monitor              CloudWatch
  Logs                Log Analytics              CloudWatch Logs
  APM                 Application Insights       X-Ray
  Audit               Activity Log               CloudTrail

DevOps
  CI/CD               Azure DevOps / Pipelines   CodePipeline
  Repository          Azure Repos                CodeCommit
  Container Registry  ACR                        ECR

AI/ML
  Pre-trained Models  Cognitive Services         AI Services
  ML Platform         Machine Learning           SageMaker
  GenAI               OpenAI Service             Bedrock
</code></pre>
<h3 id="key-differences"><a class="header" href="#key-differences">Key Differences</a></h3>
<pre><code>Aspect                Azure                      AWS
─────────────────────────────────────────────────────────────────
Market Share          ~23%                       ~32%
Launch Year           2010                       2006
Focus                 Enterprise / Hybrid        Startups / Flexibility
Integration           Microsoft stack            Broad ecosystem
Regions               60+ regions                30+ regions
Pricing               Per-minute billing         Per-second billing
Support               Strong enterprise          Extensive documentation
Compliance            Most certifications        Extensive certifications
Hybrid Cloud          Azure Arc (best-in-class)  Outposts
Windows Workloads     Native integration         Good support
</code></pre>
<h3 id="when-to-choose-azure"><a class="header" href="#when-to-choose-azure">When to Choose Azure</a></h3>
<pre><code>✓ Heavy Microsoft stack usage (Windows, .NET, SQL Server)
✓ Enterprise Active Directory integration needed
✓ Hybrid cloud requirements (on-premises + cloud)
✓ Existing Microsoft licensing (Azure Hybrid Benefit)
✓ Office 365 / Dynamics 365 integration
✓ Strong compliance requirements
✓ European data centers needed
✓ .NET development team
</code></pre>
<h3 id="when-to-choose-aws"><a class="header" href="#when-to-choose-aws">When to Choose AWS</a></h3>
<pre><code>✓ Largest service selection needed
✓ Startup with flexible requirements
✓ Open-source technologies focus
✓ Mature ecosystem and tooling important
✓ Broadest region availability needed
✓ Extensive third-party integrations
✓ Strong serverless requirements
✓ Largest community and resources
</code></pre>
<h2 id="cost-optimization-2"><a class="header" href="#cost-optimization-2">Cost Optimization</a></h2>
<h3 id="azure-cost-management"><a class="header" href="#azure-cost-management">Azure Cost Management</a></h3>
<pre><code class="language-bash"># Create budget
az consumption budget create \
  --budget-name myBudget \
  --amount 1000 \
  --category Cost \
  --time-grain Monthly \
  --start-date 2024-01-01 \
  --end-date 2024-12-31

# View cost analysis
az consumption usage list \
  --start-date 2024-01-01 \
  --end-date 2024-01-31

# Get cost forecast
az consumption forecast list

# Enable auto-shutdown for VMs
az vm auto-shutdown \
  --resource-group myResourceGroup \
  --name myVM \
  --time 1900 \
  --timezone "Pacific Standard Time"
</code></pre>
<h3 id="cost-optimization-strategies-2"><a class="header" href="#cost-optimization-strategies-2">Cost Optimization Strategies</a></h3>
<pre><code>┌──────────────────────────────────────────────────────────┐
│ Azure Cost Optimization Checklist                        │
├──────────────────────────────────────────────────────────┤
│                                                           │
│ Compute                                                   │
│ ☐ Use Reserved Instances (up to 72% discount)            │
│ ☐ Use Spot VMs for fault-tolerant workloads              │
│ ☐ Right-size VMs based on metrics                        │
│ ☐ Use Azure Hybrid Benefit for Windows/SQL               │
│ ☐ Deallocate VMs when not in use                         │
│ ☐ Use Azure Functions for event-driven workloads         │
│ ☐ Enable auto-shutdown for dev/test VMs                  │
│                                                           │
│ Storage                                                   │
│ ☐ Use lifecycle management policies                      │
│ ☐ Move infrequent data to Cool/Archive tiers             │
│ ☐ Delete unused disks and snapshots                      │
│ ☐ Use LRS instead of GRS when possible                   │
│ ☐ Enable blob versioning only when needed                │
│                                                           │
│ Database                                                  │
│ ☐ Use serverless for SQL Database with variable load     │
│ ☐ Right-size database tiers                              │
│ ☐ Use Cosmos DB autoscale                                │
│ ☐ Implement connection pooling                           │
│ ☐ Pause dev/test databases when not in use               │
│                                                           │
│ Network                                                   │
│ ☐ Use Azure Front Door to reduce data transfer           │
│ ☐ Use VNet peering instead of VPN when possible          │
│ ☐ Consolidate data transfer within same region           │
│ ☐ Use private endpoints to avoid data transfer costs     │
│                                                           │
│ Monitoring                                                │
│ ☐ Set up Azure Cost Management + Billing alerts          │
│ ☐ Use Azure Advisor cost recommendations                 │
│ ☐ Review Advisor score regularly                         │
│ ☐ Use tags for cost allocation                           │
│ ☐ Review Underutilized Resources report                  │
└──────────────────────────────────────────────────────────┘
</code></pre>
<h3 id="azure-pricing-calculator"><a class="header" href="#azure-pricing-calculator">Azure Pricing Calculator</a></h3>
<p>Use Azure Pricing Calculator: https://azure.microsoft.com/pricing/calculator/</p>
<h3 id="example-monthly-costs"><a class="header" href="#example-monthly-costs">Example Monthly Costs</a></h3>
<pre><code>Service                   Configuration           Monthly Cost (Approx)
─────────────────────────────────────────────────────────────────────
VM (B2s)                  2 vCPU, 4GB, Linux     $30
Managed Disk (128GB)      Premium SSD            $20
SQL Database (S0)         10 DTUs                $15
Cosmos DB                 400 RU/s               $24
Blob Storage (100GB)      Hot tier               $2
Data Transfer             50GB outbound          $4
App Service (B1)          1 core, 1.75GB         $55
Functions                 1M requests            $0.20
                                                 ─────────
                          Total:                 ~$150/month
</code></pre>
<h2 id="best-practices-43"><a class="header" href="#best-practices-43">Best Practices</a></h2>
<h3 id="security-best-practices-6"><a class="header" href="#security-best-practices-6">Security Best Practices</a></h3>
<pre><code>1. Identity and Access
   ├─ Use Azure AD (Entra ID) for all authentication
   ├─ Enable MFA for all users
   ├─ Use managed identities instead of service principals
   ├─ Implement RBAC with least privilege
   ├─ Use Azure AD Privileged Identity Management (PIM)
   └─ Enable Conditional Access policies

2. Network Security
   ├─ Use Network Security Groups (NSGs)
   ├─ Implement Azure Firewall or third-party NVA
   ├─ Use private endpoints for PaaS services
   ├─ Enable DDoS Protection Standard for production
   ├─ Use Application Gateway with WAF
   └─ Enable VNet service endpoints

3. Data Protection
   ├─ Enable encryption at rest for all services
   ├─ Use Azure Key Vault for secrets
   ├─ Enable TLS 1.2+ for data in transit
   ├─ Implement backup and disaster recovery
   ├─ Enable soft delete for Key Vault and Storage
   └─ Use customer-managed keys when required

4. Monitoring and Compliance
   ├─ Enable Azure Security Center (Defender for Cloud)
   ├─ Use Azure Sentinel for SIEM
   ├─ Enable Azure Monitor and Log Analytics
   ├─ Implement Azure Policy for governance
   ├─ Use Azure Blueprints for compliance
   └─ Regular security assessments

5. Application Security
   ├─ Use Web Application Firewall (WAF)
   ├─ Implement API Management security features
   ├─ Enable Application Insights
   ├─ Use Azure Front Door for global apps
   └─ Regular vulnerability scanning
</code></pre>
<h3 id="reliability-best-practices-1"><a class="header" href="#reliability-best-practices-1">Reliability Best Practices</a></h3>
<pre><code>1. High Availability
   ├─ Deploy across Availability Zones
   ├─ Use zone-redundant services
   ├─ Implement auto-scaling
   ├─ Use Azure Load Balancer / Application Gateway
   └─ Consider multi-region for critical workloads

2. Disaster Recovery
   ├─ Define RPO and RTO requirements
   ├─ Use Azure Site Recovery
   ├─ Implement geo-redundant storage
   ├─ Regular backup and restore testing
   └─ Document DR procedures

3. Monitoring
   ├─ Use Azure Monitor for all resources
   ├─ Set up alerts for critical metrics
   ├─ Implement health checks
   ├─ Use Application Insights for APM
   └─ Create dashboards for visibility

4. Resilience
   ├─ Implement retry logic
   ├─ Use circuit breaker pattern
   ├─ Implement graceful degradation
   ├─ Use queue-based load leveling
   └─ Regular chaos engineering tests
</code></pre>
<h2 id="cli-reference-1"><a class="header" href="#cli-reference-1">CLI Reference</a></h2>
<h3 id="common-cli-patterns-1"><a class="header" href="#common-cli-patterns-1">Common CLI Patterns</a></h3>
<pre><code class="language-bash"># Use --output for different formats
az vm list --output table
az vm list --output json
az vm list --output yaml
az vm list --output tsv

# Use --query for filtering (JMESPath)
az vm list --query "[].{name:name, powerState:powerState}"
az vm list --query "[?powerState=='VM running'].name"

# Use --resource-group shorthand
az vm list -g myResourceGroup

# Use --verbose for debugging
az vm create --verbose ...

# Get help
az vm --help
az vm create --help

# Interactive mode
az interactive

# Configure defaults
az configure --defaults group=myResourceGroup location=eastus

# Show defaults
az configure --list-defaults
</code></pre>
<h3 id="useful-aliases-1"><a class="header" href="#useful-aliases-1">Useful Aliases</a></h3>
<pre><code class="language-bash"># Add to ~/.bashrc or ~/.zshrc

alias azvm='az vm list --output table'
alias azrunning='az vm list --query "[?powerState=='\''VM running'\''].{name:name, resourceGroup:resourceGroup}" --output table'
alias azstorage='az storage account list --output table'
alias azsql='az sql db list --output table'
alias azgroup='az group list --output table'
</code></pre>
<h2 id="certification-paths-1"><a class="header" href="#certification-paths-1">Certification Paths</a></h2>
<h3 id="azure-certification-roadmap"><a class="header" href="#azure-certification-roadmap">Azure Certification Roadmap</a></h3>
<pre><code>Foundational
    │
    └─ AZ-900: Azure Fundamentals
        │
        ├─ Associate Level
        │   ├─ AZ-104: Azure Administrator
        │   ├─ AZ-204: Azure Developer
        │   └─ AZ-400: DevOps Engineer
        │
        └─ Expert Level
            ├─ AZ-305: Azure Solutions Architect
            └─ AZ-400: DevOps Engineer (with AZ-104/204)
            
        Specialty (Optional)
        ├─ AZ-500: Security Technologies
        ├─ AI-102: AI Engineer
        ├─ DP-203: Data Engineer
        └─ AZ-700: Network Engineer
</code></pre>
<h2 id="resources-29"><a class="header" href="#resources-29">Resources</a></h2>
<h3 id="official-documentation-4"><a class="header" href="#official-documentation-4">Official Documentation</a></h3>
<ul>
<li>Azure Documentation: https://docs.microsoft.com/azure</li>
<li>Azure CLI Reference: https://docs.microsoft.com/cli/azure/</li>
<li>Azure SDK Documentation: https://azure.github.io/azure-sdk/</li>
</ul>
<h3 id="learning-resources-3"><a class="header" href="#learning-resources-3">Learning Resources</a></h3>
<ul>
<li>Microsoft Learn: https://learn.microsoft.com/training/</li>
<li>Azure Free Account: https://azure.microsoft.com/free/</li>
<li>Azure Architecture Center: https://docs.microsoft.com/azure/architecture/</li>
<li>Azure Samples: https://github.com/Azure-Samples</li>
<li>Azure Friday: https://azure.microsoft.com/resources/videos/azure-friday/</li>
</ul>
<h3 id="community-6"><a class="header" href="#community-6">Community</a></h3>
<ul>
<li>r/AZURE: Reddit community</li>
<li>Microsoft Q&amp;A: https://docs.microsoft.com/answers/</li>
<li>Azure Community Support: https://azure.microsoft.com/support/community/</li>
<li>Azure User Groups: https://www.meetup.com/pro/azureug</li>
</ul>
<h3 id="tools-7"><a class="header" href="#tools-7">Tools</a></h3>
<ul>
<li>Azure CLI: Command-line interface</li>
<li>Azure PowerShell: PowerShell modules</li>
<li>Azure SDKs: Python, JavaScript, Java, .NET, Go</li>
<li>Bicep: Azure-native IaC</li>
<li>Terraform: Multi-cloud IaC</li>
<li>Azure Storage Explorer: GUI for storage</li>
<li>Azure Data Studio: Database management</li>
</ul>
<h3 id="pricing"><a class="header" href="#pricing">Pricing</a></h3>
<ul>
<li>Azure Pricing Calculator: https://azure.microsoft.com/pricing/calculator/</li>
<li>Azure Cost Management: https://azure.microsoft.com/services/cost-management/</li>
<li>Total Cost of Ownership (TCO) Calculator: https://azure.microsoft.com/pricing/tco/</li>
</ul>
<hr />
<p><strong>Updated</strong>: January 2025</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="tools-8"><a class="header" href="#tools-8">Tools</a></h1>
<p>This section provides an overview of various tools that can enhance your productivity and efficiency in different domains. Each tool is accompanied by a detailed guide on how to use it effectively.</p>
<h2 id="list-of-tools"><a class="header" href="#list-of-tools">List of Tools</a></h2>
<ol>
<li><strong><a href="tools/tmux.html">tmux</a></strong>: A terminal multiplexer that allows you to switch between several programs in one terminal, detach them, and reattach them to a different terminal.</li>
<li><strong><a href="tools/vim.html">vim</a></strong>: A highly configurable text editor built to enable efficient text editing.</li>
<li><strong><a href="tools/cscope.html">cscope</a></strong>: A developer's tool for browsing source code in a terminal environment.</li>
<li><strong><a href="tools/ctags.html">ctags</a></strong>: A programming tool that generates an index (or tag) file of names found in source and header files.</li>
<li><strong><a href="tools/mdbook.html">mdbook</a></strong>: A command line tool to create books with Markdown.</li>
<li><strong><a href="tools/sed.html">sed</a></strong>: A stream editor for filtering and transforming text.</li>
<li><strong><a href="tools/awk.html">awk</a></strong>: A programming language designed for text processing and typically used as a data extraction and reporting tool.</li>
<li><strong><a href="tools/curl.html">curl</a></strong>: A command-line tool for transferring data with URLs.</li>
<li><strong><a href="tools/wget.html">wget</a></strong>: A free utility for non-interactive download of files from the web.</li>
<li><strong><a href="tools/grep.html">grep</a></strong>: A command-line utility for searching plain-text data sets for lines that match a regular expression.</li>
<li><strong><a href="tools/find.html">find</a></strong>: A command-line utility that searches for files in a directory hierarchy.</li>
<li><strong><a href="tools/ffmpeg.html">ffmpeg</a></strong>: A complete, cross-platform solution to record, convert and stream audio and video.</li>
<li><strong><a href="tools/make.html">make</a></strong>: A build automation tool that automatically builds executable programs and libraries from source code.</li>
<li><strong><a href="tools/docker.html">Docker</a></strong>: A set of platform-as-a-service products that use OS-level virtualization to deliver software in packages called containers.</li>
<li><strong><a href="tools/ansible.html">Ansible</a></strong>: An open-source software provisioning, configuration management, and application-deployment tool.</li>
<li><strong><a href="tools/wpa_supplicant.html">wpa_supplicant</a></strong>: WiFi client authentication daemon for connecting to wireless networks.</li>
<li><strong><a href="tools/hostapd.html">hostapd</a></strong>: WiFi access point and authentication server for creating wireless access points.</li>
</ol>
<p>Each tool listed above has its own dedicated page with detailed instructions on how to install, configure, and use it effectively. Click on the tool name to navigate to its respective guide.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="tmux"><a class="header" href="#tmux">tmux</a></h1>
<p>tmux (terminal multiplexer) is a powerful tool that allows you to create, access, and control multiple terminal sessions from a single window. It enables session persistence, split panes, and window management.</p>
<h2 id="overview-51"><a class="header" href="#overview-51">Overview</a></h2>
<p>tmux allows you to:</p>
<ul>
<li>Run multiple terminal sessions in a single window</li>
<li>Split your terminal into multiple panes</li>
<li>Detach and reattach sessions (sessions persist after disconnection)</li>
<li>Share sessions between users</li>
<li>Script and automate terminal workflows</li>
</ul>
<p><strong>Key Concepts:</strong></p>
<ul>
<li><strong>Session</strong>: A collection of windows, managed independently</li>
<li><strong>Window</strong>: A single screen within a session (like a tab)</li>
<li><strong>Pane</strong>: A split section within a window</li>
<li><strong>Prefix Key</strong>: Default <code>Ctrl+b</code>, used before tmux commands</li>
<li><strong>Detach</strong>: Disconnect from session (keeps running in background)</li>
<li><strong>Attach</strong>: Reconnect to an existing session</li>
</ul>
<h2 id="installation-6"><a class="header" href="#installation-6">Installation</a></h2>
<pre><code class="language-bash"># Ubuntu/Debian
sudo apt update
sudo apt install tmux

# macOS
brew install tmux

# CentOS/RHEL
sudo yum install tmux

# Arch Linux
sudo pacman -S tmux

# Verify installation
tmux -V
</code></pre>
<h2 id="basic-usage-3"><a class="header" href="#basic-usage-3">Basic Usage</a></h2>
<h3 id="session-management"><a class="header" href="#session-management">Session Management</a></h3>
<pre><code class="language-bash"># Start new session
tmux

# Start new session with name
tmux new -s mysession
tmux new-session -s mysession

# List sessions
tmux ls
tmux list-sessions

# Attach to session
tmux attach
tmux a

# Attach to specific session
tmux attach -t mysession
tmux a -t mysession

# Detach from session (inside tmux)
# Press: Ctrl+b, then d

# Kill session
tmux kill-session -t mysession

# Kill all sessions
tmux kill-server

# Rename session (inside tmux)
# Press: Ctrl+b, then $
</code></pre>
<h3 id="window-management"><a class="header" href="#window-management">Window Management</a></h3>
<pre><code class="language-bash"># Inside tmux, press Ctrl+b then:

# c - Create new window
# , - Rename current window
# w - List windows
# n - Next window
# p - Previous window
# 0-9 - Switch to window number
# l - Last active window
# &amp; - Kill current window
# f - Find window by name
</code></pre>
<h3 id="pane-management"><a class="header" href="#pane-management">Pane Management</a></h3>
<pre><code class="language-bash"># Inside tmux, press Ctrl+b then:

# % - Split pane vertically
# " - Split pane horizontally
# Arrow keys - Navigate between panes
# o - Switch to next pane
# ; - Toggle between current and previous pane
# x - Kill current pane
# z - Toggle pane zoom (fullscreen)
# Space - Toggle between layouts
# { - Move pane left
# } - Move pane right
# Ctrl+Arrow - Resize pane
# q - Show pane numbers (then press number to switch)
</code></pre>
<h2 id="configuration-1"><a class="header" href="#configuration-1">Configuration</a></h2>
<h3 id="basic-tmuxconf"><a class="header" href="#basic-tmuxconf">Basic .tmux.conf</a></h3>
<pre><code class="language-bash"># Create configuration file
cat &lt;&lt; 'EOF' &gt; ~/.tmux.conf
# Change prefix from Ctrl+b to Ctrl+a
set-option -g prefix C-a
unbind-key C-b
bind-key C-a send-prefix

# Enable mouse support
set -g mouse on

# Start windows and panes at 1, not 0
set -g base-index 1
setw -g pane-base-index 1

# Renumber windows when one is closed
set -g renumber-windows on

# Increase scrollback buffer size
set -g history-limit 10000

# Enable 256 colors
set -g default-terminal "screen-256color"

# Reload config file
bind r source-file ~/.tmux.conf \; display "Config reloaded!"

# Split panes with | and -
bind | split-window -h
bind - split-window -v
unbind '"'
unbind %

# Switch panes using Alt+Arrow without prefix
bind -n M-Left select-pane -L
bind -n M-Right select-pane -R
bind -n M-Up select-pane -U
bind -n M-Down select-pane -D

# Set status bar
set -g status-bg black
set -g status-fg white
set -g status-interval 60
set -g status-left-length 30
set -g status-left '#[fg=green](#S) #(whoami) '
set -g status-right '#[fg=yellow]#(cut -d " " -f 1-3 /proc/loadavg)#[default] #[fg=white]%H:%M#[default]'
EOF

# Reload tmux configuration
tmux source-file ~/.tmux.conf
</code></pre>
<h3 id="advanced-configuration"><a class="header" href="#advanced-configuration">Advanced Configuration</a></h3>
<pre><code class="language-bash">cat &lt;&lt; 'EOF' &gt; ~/.tmux.conf
# ===== Basic Settings =====
set-option -g prefix C-a
unbind-key C-b
bind-key C-a send-prefix

# Enable mouse
set -g mouse on

# Start numbering at 1
set -g base-index 1
setw -g pane-base-index 1

# Renumber windows
set -g renumber-windows on

# History
set -g history-limit 50000

# Terminal settings
set -g default-terminal "screen-256color"
set -ga terminal-overrides ",*256col*:Tc"

# No delay for escape key
set -sg escape-time 0

# Monitor activity
setw -g monitor-activity on
set -g visual-activity off

# ===== Key Bindings =====

# Reload config
bind r source-file ~/.tmux.conf \; display "Reloaded!"

# Split panes
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"
bind c new-window -c "#{pane_current_path}"

# Pane navigation
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Pane resizing
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# Window navigation
bind -r C-h select-window -t :-
bind -r C-l select-window -t :+

# Copy mode with vi keys
setw -g mode-keys vi
bind-key -T copy-mode-vi 'v' send -X begin-selection
bind-key -T copy-mode-vi 'y' send -X copy-selection-and-cancel

# ===== Appearance =====

# Status bar
set -g status-position bottom
set -g status-justify left
set -g status-style 'bg=colour234 fg=colour137'
set -g status-left ''
set -g status-right '#[fg=colour233,bg=colour241,bold] %d/%m #[fg=colour233,bg=colour245,bold] %H:%M:%S '
set -g status-right-length 50
set -g status-left-length 20

# Window status
setw -g window-status-current-style 'fg=colour1 bg=colour19 bold'
setw -g window-status-current-format ' #I#[fg=colour249]:#[fg=colour255]#W#[fg=colour249]#F '
setw -g window-status-style 'fg=colour9 bg=colour18'
setw -g window-status-format ' #I#[fg=colour237]:#[fg=colour250]#W#[fg=colour244]#F '

# Pane borders
set -g pane-border-style 'fg=colour238'
set -g pane-active-border-style 'fg=colour51'

# Message text
set -g message-style 'fg=colour232 bg=colour166 bold'
EOF
</code></pre>
<h2 id="key-bindings-reference"><a class="header" href="#key-bindings-reference">Key Bindings Reference</a></h2>
<h3 id="default-prefix-ctrlb"><a class="header" href="#default-prefix-ctrlb">Default Prefix: <code>Ctrl+b</code></a></h3>
<h4 id="session-commands"><a class="header" href="#session-commands">Session Commands</a></h4>
<pre><code class="language-bash">Ctrl+b d       # Detach from session
Ctrl+b s       # List sessions
Ctrl+b $       # Rename session
Ctrl+b (       # Switch to previous session
Ctrl+b )       # Switch to next session
Ctrl+b L       # Switch to last session
</code></pre>
<h4 id="window-commands"><a class="header" href="#window-commands">Window Commands</a></h4>
<pre><code class="language-bash">Ctrl+b c       # Create new window
Ctrl+b ,       # Rename current window
Ctrl+b &amp;       # Kill current window
Ctrl+b w       # List windows
Ctrl+b n       # Next window
Ctrl+b p       # Previous window
Ctrl+b 0-9     # Switch to window by number
Ctrl+b l       # Switch to last active window
Ctrl+b f       # Find window
Ctrl+b .       # Move window (prompts for index)
</code></pre>
<h4 id="pane-commands"><a class="header" href="#pane-commands">Pane Commands</a></h4>
<pre><code class="language-bash">Ctrl+b %       # Split vertically
Ctrl+b "       # Split horizontally
Ctrl+b o       # Switch to next pane
Ctrl+b ;       # Toggle between current and previous pane
Ctrl+b x       # Kill current pane
Ctrl+b !       # Break pane into window
Ctrl+b z       # Toggle pane zoom
Ctrl+b Space   # Toggle between pane layouts
Ctrl+b q       # Show pane numbers
Ctrl+b {       # Move pane left
Ctrl+b }       # Move pane right
Ctrl+b Ctrl+o  # Rotate panes
Ctrl+b Arrow   # Navigate panes
</code></pre>
<h4 id="copy-mode"><a class="header" href="#copy-mode">Copy Mode</a></h4>
<pre><code class="language-bash">Ctrl+b [       # Enter copy mode
Ctrl+b ]       # Paste buffer
Space          # Start selection (in copy mode)
Enter          # Copy selection (in copy mode)
q              # Exit copy mode

# With vi mode enabled:
v              # Begin selection
y              # Copy selection
</code></pre>
<h4 id="other-commands"><a class="header" href="#other-commands">Other Commands</a></h4>
<pre><code class="language-bash">Ctrl+b ?       # List all key bindings
Ctrl+b :       # Enter command mode
Ctrl+b t       # Show time
Ctrl+b ~       # Show messages
</code></pre>
<h2 id="common-workflows"><a class="header" href="#common-workflows">Common Workflows</a></h2>
<h3 id="development-environment-1"><a class="header" href="#development-environment-1">Development Environment</a></h3>
<pre><code class="language-bash"># Create development session
tmux new -s dev

# Inside tmux:
# Split into 3 panes
Ctrl+b %    # Split vertically
Ctrl+b "    # Split right pane horizontally

# Now you have:
# - Left pane: Editor (vim/emacs)
# - Top right: Run server
# - Bottom right: Git/commands

# Navigate between panes
Ctrl+b Arrow keys
</code></pre>
<h3 id="remote-server-session"><a class="header" href="#remote-server-session">Remote Server Session</a></h3>
<pre><code class="language-bash"># SSH to server
ssh user@server

# Start tmux session
tmux new -s work

# Do work...
# Connection drops or intentional detach
Ctrl+b d

# Reconnect later
ssh user@server
tmux attach -t work
# Your session is exactly as you left it
</code></pre>
<h3 id="pair-programming"><a class="header" href="#pair-programming">Pair Programming</a></h3>
<pre><code class="language-bash"># User 1: Create session
tmux new -s pair

# User 2: Attach to same session (read-only)
tmux attach -t pair -r

# User 2: Attach with full control
tmux attach -t pair
</code></pre>
<h3 id="multiple-projects"><a class="header" href="#multiple-projects">Multiple Projects</a></h3>
<pre><code class="language-bash"># Create sessions for different projects
tmux new -s project1 -d
tmux new -s project2 -d
tmux new -s project3 -d

# List all sessions
tmux ls

# Attach to specific project
tmux attach -t project1

# Switch between sessions (inside tmux)
Ctrl+b s    # Shows session list
Ctrl+b (    # Previous session
Ctrl+b )    # Next session
</code></pre>
<h2 id="advanced-features-2"><a class="header" href="#advanced-features-2">Advanced Features</a></h2>
<h3 id="copy-and-paste"><a class="header" href="#copy-and-paste">Copy and Paste</a></h3>
<pre><code class="language-bash"># Enter copy mode
Ctrl+b [

# Navigate with vi keys (if vi mode enabled)
# Or use arrow keys

# Start selection
Space

# Copy selection
Enter

# Paste
Ctrl+b ]

# View paste buffers
Ctrl+b #

# Choose buffer to paste
Ctrl+b =
</code></pre>
<h3 id="synchronized-panes"><a class="header" href="#synchronized-panes">Synchronized Panes</a></h3>
<pre><code class="language-bash"># Enable synchronized panes (type in all panes at once)
Ctrl+b :
:setw synchronize-panes on

# Disable
:setw synchronize-panes off

# Toggle with binding (add to .tmux.conf)
bind S setw synchronize-panes
</code></pre>
<h3 id="save-and-restore-sessions"><a class="header" href="#save-and-restore-sessions">Save and Restore Sessions</a></h3>
<pre><code class="language-bash"># Save session layout
Ctrl+b :
:save-buffer /tmp/tmux-session.txt

# Create script to restore layout
cat &lt;&lt; 'EOF' &gt; ~/restore-session.sh
#!/bin/bash
tmux new-session -d -s dev
tmux split-window -h
tmux split-window -v
tmux select-pane -t 0
tmux send-keys 'vim' C-m
tmux select-pane -t 1
tmux send-keys 'npm run dev' C-m
tmux select-pane -t 2
tmux attach -t dev
EOF

chmod +x ~/restore-session.sh
</code></pre>
<h3 id="tmux-plugins-tpm"><a class="header" href="#tmux-plugins-tpm">Tmux Plugins (TPM)</a></h3>
<pre><code class="language-bash"># Install Tmux Plugin Manager
git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm

# Add to .tmux.conf
cat &lt;&lt; 'EOF' &gt;&gt; ~/.tmux.conf

# List of plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'

# Initialize TPM (keep at bottom of .tmux.conf)
run '~/.tmux/plugins/tpm/tpm'
EOF

# Reload config
tmux source ~/.tmux.conf

# Install plugins (inside tmux)
Ctrl+b I
</code></pre>
<h3 id="custom-scripts"><a class="header" href="#custom-scripts">Custom Scripts</a></h3>
<pre><code class="language-bash"># Create reusable session layout
cat &lt;&lt; 'EOF' &gt; ~/tmux-dev.sh
#!/bin/bash

SESSION="dev"
SESSIONEXISTS=$(tmux list-sessions | grep $SESSION)

if [ "$SESSIONEXISTS" = "" ]
then
    # Create new session
    tmux new-session -d -s $SESSION

    # Create windows
    tmux rename-window -t 0 'Editor'
    tmux send-keys -t 'Editor' 'cd ~/project &amp;&amp; vim' C-m

    tmux new-window -t $SESSION:1 -n 'Server'
    tmux send-keys -t 'Server' 'cd ~/project &amp;&amp; npm run dev' C-m

    tmux new-window -t $SESSION:2 -n 'Git'
    tmux send-keys -t 'Git' 'cd ~/project &amp;&amp; git status' C-m

    # Split panes
    tmux select-window -t $SESSION:2
    tmux split-window -h
    tmux send-keys -t 1 'cd ~/project' C-m
fi

# Attach to session
tmux attach-session -t $SESSION:0
EOF

chmod +x ~/tmux-dev.sh
</code></pre>
<h2 id="command-mode"><a class="header" href="#command-mode">Command Mode</a></h2>
<pre><code class="language-bash"># Enter command mode
Ctrl+b :

# Common commands
:new-window -n mywindow
:kill-window
:split-window -h
:resize-pane -D 10
:setw synchronize-panes on
:set mouse on
:source-file ~/.tmux.conf
:list-keys
:list-commands
</code></pre>
<h2 id="scripting-tmux"><a class="header" href="#scripting-tmux">Scripting tmux</a></h2>
<h3 id="create-complex-layouts"><a class="header" href="#create-complex-layouts">Create Complex Layouts</a></h3>
<pre><code class="language-bash">#!/bin/bash

# Create session with specific layout
tmux new-session -d -s complex

# Split into 4 panes
tmux split-window -h -t complex
tmux split-window -v -t complex:0.0
tmux split-window -v -t complex:0.2

# Send commands to each pane
tmux send-keys -t complex:0.0 'htop' C-m
tmux send-keys -t complex:0.1 'tail -f /var/log/syslog' C-m
tmux send-keys -t complex:0.2 'vim' C-m
tmux send-keys -t complex:0.3 'echo "Ready for commands"' C-m

# Attach to session
tmux attach -t complex
</code></pre>
<h3 id="automation-script"><a class="header" href="#automation-script">Automation Script</a></h3>
<pre><code class="language-bash">#!/bin/bash

# Monitor multiple servers
SERVERS=("server1" "server2" "server3")
SESSION="monitoring"

tmux new-session -d -s $SESSION

for i in "${!SERVERS[@]}"; do
    if [ $i -eq 0 ]; then
        tmux rename-window -t $SESSION:0 "${SERVERS[$i]}"
    else
        tmux new-window -t $SESSION:$i -n "${SERVERS[$i]}"
    fi

    tmux send-keys -t $SESSION:$i "ssh ${SERVERS[$i]}" C-m
done

tmux select-window -t $SESSION:0
tmux attach -t $SESSION
</code></pre>
<h2 id="best-practices-44"><a class="header" href="#best-practices-44">Best Practices</a></h2>
<h3 id="recommended-tmuxconf-settings"><a class="header" href="#recommended-tmuxconf-settings">Recommended .tmux.conf Settings</a></h3>
<pre><code class="language-bash"># Essential settings
set -g mouse on                      # Enable mouse
set -g history-limit 50000           # Large scrollback
set -sg escape-time 0                # No escape delay
set -g base-index 1                  # Start windows at 1
setw -g pane-base-index 1            # Start panes at 1
set -g renumber-windows on           # Renumber windows

# Visual settings
set -g default-terminal "screen-256color"
set -g status-position bottom
setw -g monitor-activity on

# Key bindings
bind r source-file ~/.tmux.conf \; display "Reloaded!"
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"
setw -g mode-keys vi
</code></pre>
<h3 id="workflow-tips"><a class="header" href="#workflow-tips">Workflow Tips</a></h3>
<ol>
<li><strong>Use named sessions</strong> for different projects</li>
<li><strong>Create restore scripts</strong> for complex layouts</li>
<li><strong>Enable mouse support</strong> for easier navigation</li>
<li><strong>Use vi key bindings</strong> in copy mode</li>
<li><strong>Set up custom key bindings</strong> for frequent actions</li>
<li><strong>Use tmux with SSH</strong> for persistent remote sessions</li>
<li><strong>Share sessions</strong> for collaboration</li>
<li><strong>Create aliases</strong> for common commands</li>
</ol>
<h3 id="useful-aliases-2"><a class="header" href="#useful-aliases-2">Useful Aliases</a></h3>
<pre><code class="language-bash"># Add to ~/.bashrc or ~/.zshrc
alias tm='tmux'
alias tma='tmux attach -t'
alias tms='tmux new-session -s'
alias tml='tmux list-sessions'
alias tmk='tmux kill-session -t'
</code></pre>
<h2 id="troubleshooting-4"><a class="header" href="#troubleshooting-4">Troubleshooting</a></h2>
<h3 id="common-issues-10"><a class="header" href="#common-issues-10">Common Issues</a></h3>
<pre><code class="language-bash"># Prefix key not working
# Check if prefix is correct in .tmux.conf
tmux show-options -g | grep prefix

# Colors not displaying correctly
set -g default-terminal "screen-256color"

# Mouse not working
set -g mouse on

# Sessions not persisting
# Make sure you detach (Ctrl+b d) instead of exiting

# Can't attach to session
# Check if session exists
tmux ls

# Configuration not loading
# Reload config
tmux source-file ~/.tmux.conf

# Reset tmux to defaults
tmux kill-server
rm ~/.tmux.conf
</code></pre>
<h3 id="debug-mode"><a class="header" href="#debug-mode">Debug Mode</a></h3>
<pre><code class="language-bash"># Start tmux in verbose mode
tmux -v

# Show current settings
tmux show-options -g
tmux show-window-options -g

# Check key bindings
tmux list-keys

# Show messages
Ctrl+b ~
</code></pre>
<h2 id="integration-with-tools"><a class="header" href="#integration-with-tools">Integration with Tools</a></h2>
<h3 id="vim-integration"><a class="header" href="#vim-integration">Vim Integration</a></h3>
<pre><code class="language-bash"># Add to .vimrc for seamless navigation
if exists('$TMUX')
    " Use same keybindings for vim and tmux
    let g:tmux_navigator_no_mappings = 1
endif
</code></pre>
<h3 id="shell-integration"><a class="header" href="#shell-integration">Shell Integration</a></h3>
<pre><code class="language-bash"># Auto-attach or create session
if command -v tmux &amp;&gt; /dev/null &amp;&amp; [ -z "$TMUX" ]; then
    tmux attach -t default || tmux new -s default
fi
</code></pre>
<h2 id="quick-reference-7"><a class="header" href="#quick-reference-7">Quick Reference</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody>
<tr><td><code>tmux</code></td><td>Start new session</td></tr>
<tr><td><code>tmux new -s name</code></td><td>Start named session</td></tr>
<tr><td><code>tmux ls</code></td><td>List sessions</td></tr>
<tr><td><code>tmux attach -t name</code></td><td>Attach to session</td></tr>
<tr><td><code>Ctrl+b d</code></td><td>Detach from session</td></tr>
<tr><td><code>Ctrl+b c</code></td><td>Create window</td></tr>
<tr><td><code>Ctrl+b ,</code></td><td>Rename window</td></tr>
<tr><td><code>Ctrl+b %</code></td><td>Split vertically</td></tr>
<tr><td><code>Ctrl+b "</code></td><td>Split horizontally</td></tr>
<tr><td><code>Ctrl+b Arrow</code></td><td>Navigate panes</td></tr>
<tr><td><code>Ctrl+b z</code></td><td>Zoom pane</td></tr>
<tr><td><code>Ctrl+b [</code></td><td>Copy mode</td></tr>
<tr><td><code>Ctrl+b ?</code></td><td>List keybindings</td></tr>
</tbody></table>
</div>
<p>tmux is an essential tool for managing terminal workflows, especially valuable for remote server management, development environments, and maintaining persistent sessions.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="vim"><a class="header" href="#vim">Vim</a></h1>
<p>Vim is a powerful text editor that is widely used in the Unix and Linux communities. It is a modal editor, meaning that it has two modes: normal mode and insert mode. In normal mode, you can navigate the text using the arrow keys or the mouse, and you can use commands to manipulate the text. In insert mode, you can type text as you would in any other text editor.</p>
<h2 id="commonly-used-vim-key-combinations"><a class="header" href="#commonly-used-vim-key-combinations">Commonly Used Vim Key Combinations</a></h2>
<ol>
<li>
<p><strong>Switching Modes:</strong></p>
<ul>
<li><code>i</code>: Enter insert mode</li>
<li><code>Esc</code>: Return to normal mode</li>
</ul>
</li>
<li>
<p><strong>Navigation:</strong></p>
<ul>
<li><code>h</code>: Move left</li>
<li><code>j</code>: Move down</li>
<li><code>k</code>: Move up</li>
<li><code>l</code>: Move right</li>
<li><code>w</code>: Jump to the start of the next word</li>
<li><code>b</code>: Jump to the start of the previous word</li>
<li><code>0</code>: Jump to the beginning of the line</li>
<li><code>$</code>: Jump to the end of the line</li>
<li><code>gg</code>: Go to the top of the file</li>
<li><code>G</code>: Go to the bottom of the file</li>
</ul>
</li>
<li>
<p><strong>Editing:</strong></p>
<ul>
<li><code>x</code>: Delete the character under the cursor</li>
<li><code>dd</code>: Delete the current line</li>
<li><code>yy</code>: Yank (copy) the current line</li>
<li><code>p</code>: Paste the yanked or deleted text after the cursor</li>
<li><code>u</code>: Undo the last change</li>
<li><code>Ctrl + r</code>: Redo the last undone change</li>
<li><code>r</code>: Replace the character under the cursor</li>
</ul>
</li>
<li>
<p><strong>Searching:</strong></p>
<ul>
<li><code>/pattern</code>: Search for a pattern</li>
<li><code>n</code>: Repeat the search in the same direction</li>
<li><code>N</code>: Repeat the search in the opposite direction</li>
</ul>
</li>
<li>
<p><strong>Saving and Exiting:</strong></p>
<ul>
<li><code>:w</code>: Save the file</li>
<li><code>:q</code>: Quit Vim</li>
<li><code>:wq</code>: Save the file and quit Vim</li>
<li><code>:q!</code>: Quit Vim without saving</li>
</ul>
</li>
<li>
<p><strong>Visual Mode:</strong></p>
<ul>
<li><code>v</code>: Enter visual mode to select text</li>
<li><code>V</code>: Enter visual line mode to select whole lines</li>
<li><code>Ctrl + v</code>: Enter visual block mode to select a block of text</li>
</ul>
</li>
</ol>
<p>These key combinations cover a variety of common tasks in Vim, making it a versatile and efficient text editor.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cscope"><a class="header" href="#cscope">cscope</a></h1>
<p>cscope is a developer's tool for browsing source code in a terminal environment. It's particularly useful for navigating large C codebases, allowing you to search for symbols, function calls, and definitions interactively.</p>
<h2 id="overview-52"><a class="header" href="#overview-52">Overview</a></h2>
<p>cscope builds a symbol database from source files and provides a text-based interface for code navigation. While originally designed for C, it also supports C++ and Java.</p>
<p><strong>Key Features:</strong></p>
<ul>
<li>Find function definitions and calls</li>
<li>Search for symbols, assignments, and regular expressions</li>
<li>Navigate to files containing specific text</li>
<li>Interactive text-based interface</li>
<li>Integration with text editors (Vim, Emacs)</li>
<li>Cross-reference capabilities</li>
</ul>
<h2 id="installation-7"><a class="header" href="#installation-7">Installation</a></h2>
<pre><code class="language-bash"># Ubuntu/Debian
sudo apt update
sudo apt install cscope

# macOS
brew install cscope

# CentOS/RHEL
sudo yum install cscope

# Arch Linux
sudo pacman -S cscope

# Verify installation
cscope -V
</code></pre>
<h2 id="basic-usage-4"><a class="header" href="#basic-usage-4">Basic Usage</a></h2>
<h3 id="building-database"><a class="header" href="#building-database">Building Database</a></h3>
<pre><code class="language-bash"># Build database from current directory
cscope -b

# Build database recursively
cscope -bR

# Build database from specific files
cscope -b file1.c file2.c file3.c

# Build from file list
find . -name "*.c" -o -name "*.h" &gt; cscope.files
cscope -b

# Build without launching interface
cscope -b -q    # -q for faster database

# Update existing database
cscope -u -b
</code></pre>
<h3 id="interactive-mode"><a class="header" href="#interactive-mode">Interactive Mode</a></h3>
<pre><code class="language-bash"># Launch cscope
cscope

# Launch with specific database
cscope -d    # Use existing database (don't rebuild)

# Launch recursively
cscope -R

# Launch in line-oriented mode
cscope -l
</code></pre>
<h3 id="interactive-commands"><a class="header" href="#interactive-commands">Interactive Commands</a></h3>
<pre><code># In cscope interface:

Tab         - Toggle between input field and results
Ctrl+D      - Exit cscope
Ctrl+P      - Navigate to previous result
Ctrl+N      - Navigate to next result
Enter       - View selected result
Space       - Display next page of results
1-9         - Edit file at result number

# Search types:
0 - Find this C symbol
1 - Find this global definition
2 - Find functions called by this function
3 - Find functions calling this function
4 - Find this text string
5 - Change this text string (grep pattern)
6 - Find this egrep pattern
7 - Find this file
8 - Find files #including this file
9 - Find assignments to this symbol
</code></pre>
<h2 id="command-line-searches"><a class="header" href="#command-line-searches">Command Line Searches</a></h2>
<pre><code class="language-bash"># Find symbol
cscope -L0 symbol_name

# Find global definition
cscope -L1 function_name

# Find functions called by function
cscope -L2 function_name

# Find functions calling function
cscope -L3 function_name

# Find text string
cscope -L4 "error message"

# Find egrep pattern
cscope -L6 "struct.*{$"

# Find file
cscope -L7 filename.c

# Find files including header
cscope -L8 header.h

# Output to file
cscope -L0 main &gt; results.txt
</code></pre>
<h2 id="vim-integration-1"><a class="header" href="#vim-integration-1">Vim Integration</a></h2>
<h3 id="basic-setup"><a class="header" href="#basic-setup">Basic Setup</a></h3>
<pre><code class="language-vim">" Add to ~/.vimrc
if has("cscope")
    set csprg=/usr/bin/cscope
    set csto=0
    set cst
    set nocsverb
    " Add cscope database if it exists
    if filereadable("cscope.out")
        cs add cscope.out
    endif
    set csverb
endif
</code></pre>
<h3 id="advanced-vim-configuration"><a class="header" href="#advanced-vim-configuration">Advanced Vim Configuration</a></h3>
<pre><code class="language-vim">" ~/.vimrc
if has("cscope")
    set csprg=/usr/bin/cscope
    set csto=0
    set cst
    set csverb

    " Load database
    if filereadable("cscope.out")
        cs add cscope.out
    elseif $CSCOPE_DB != ""
        cs add $CSCOPE_DB
    endif

    " Key mappings
    nmap &lt;C-\&gt;s :cs find s &lt;C-R&gt;=expand("&lt;cword&gt;")&lt;CR&gt;&lt;CR&gt;
    nmap &lt;C-\&gt;g :cs find g &lt;C-R&gt;=expand("&lt;cword&gt;")&lt;CR&gt;&lt;CR&gt;
    nmap &lt;C-\&gt;c :cs find c &lt;C-R&gt;=expand("&lt;cword&gt;")&lt;CR&gt;&lt;CR&gt;
    nmap &lt;C-\&gt;t :cs find t &lt;C-R&gt;=expand("&lt;cword&gt;")&lt;CR&gt;&lt;CR&gt;
    nmap &lt;C-\&gt;e :cs find e &lt;C-R&gt;=expand("&lt;cword&gt;")&lt;CR&gt;&lt;CR&gt;
    nmap &lt;C-\&gt;f :cs find f &lt;C-R&gt;=expand("&lt;cfile&gt;")&lt;CR&gt;&lt;CR&gt;
    nmap &lt;C-\&gt;i :cs find i ^&lt;C-R&gt;=expand("&lt;cfile&gt;")&lt;CR&gt;$&lt;CR&gt;
    nmap &lt;C-\&gt;d :cs find d &lt;C-R&gt;=expand("&lt;cword&gt;")&lt;CR&gt;&lt;CR&gt;

    " Horizontal split
    nmap &lt;C-@&gt;s :scs find s &lt;C-R&gt;=expand("&lt;cword&gt;")&lt;CR&gt;&lt;CR&gt;
    nmap &lt;C-@&gt;g :scs find g &lt;C-R&gt;=expand("&lt;cword&gt;")&lt;CR&gt;&lt;CR&gt;
    nmap &lt;C-@&gt;c :scs find c &lt;C-R&gt;=expand("&lt;cword&gt;")&lt;CR&gt;&lt;CR&gt;
endif

" Auto-rebuild cscope database
function! UpdateCscope()
    silent !cscope -Rb
    cs reset
endfunction
command! Cscope call UpdateCscope()
</code></pre>
<h3 id="vim-commands"><a class="header" href="#vim-commands">Vim Commands</a></h3>
<pre><code class="language-vim">" In Vim:
:cs find s symbol          " Find symbol
:cs find g definition      " Find global definition
:cs find c function        " Find calls to function
:cs find t text           " Find text
:cs find e pattern        " Find egrep pattern
:cs find f file           " Find file
:cs find i file           " Find files #including file
:cs find d symbol         " Find functions called by symbol

" Show cscope connections
:cs show

" Reset cscope connections
:cs reset

" Kill cscope connection
:cs kill 0
</code></pre>
<h2 id="advanced-usage"><a class="header" href="#advanced-usage">Advanced Usage</a></h2>
<h3 id="custom-file-lists"><a class="header" href="#custom-file-lists">Custom File Lists</a></h3>
<pre><code class="language-bash"># C/C++ project
find . \( -name "*.c" -o -name "*.h" -o -name "*.cpp" -o -name "*.hpp" \) &gt; cscope.files
cscope -b -q

# Exclude directories
find . -path "./build" -prune -o -name "*.c" -print &gt; cscope.files

# Include specific directories only
find src include -name "*.[ch]" &gt; cscope.files
cscope -b -q
</code></pre>
<h3 id="kernel-style-setup"><a class="header" href="#kernel-style-setup">Kernel-style Setup</a></h3>
<pre><code class="language-bash"># Linux kernel style
cat &lt;&lt; 'EOF' &gt; build_cscope.sh
#!/bin/bash
LNX=/path/to/linux/source

find  $LNX                                                                \
    -path "$LNX/arch/*" ! -path "$LNX/arch/x86*" -prune -o              \
    -path "$LNX/tmp*" -prune -o                                          \
    -path "$LNX/Documentation*" -prune -o                                \
    -path "$LNX/scripts*" -prune -o                                      \
    -type f \( -name '*.[chxsS]' -o -name 'Makefile' \)                  \
    -print &gt; cscope.files

cscope -b -q -k
EOF

chmod +x build_cscope.sh
./build_cscope.sh
</code></pre>
<h3 id="multiple-projects-1"><a class="header" href="#multiple-projects-1">Multiple Projects</a></h3>
<pre><code class="language-bash"># Project 1
cd /project1
cscope -b -q
export CSCOPE_DB=/project1/cscope.out

# Project 2 (separate database)
cd /project2
cscope -b -q -f cscope_proj2.out

# Use in Vim
:cs add /project1/cscope.out /project1
:cs add /project2/cscope_proj2.out /project2
</code></pre>
<h2 id="scripting-with-cscope"><a class="header" href="#scripting-with-cscope">Scripting with cscope</a></h2>
<h3 id="automated-searches"><a class="header" href="#automated-searches">Automated Searches</a></h3>
<pre><code class="language-bash">#!/bin/bash
# find_function_calls.sh

FUNC=$1

if [ -z "$FUNC" ]; then
    echo "Usage: $0 &lt;function_name&gt;"
    exit 1
fi

echo "Functions calling $FUNC:"
cscope -dL3 $FUNC

echo ""
echo "Functions called by $FUNC:"
cscope -dL2 $FUNC
</code></pre>
<h3 id="generate-call-graph"><a class="header" href="#generate-call-graph">Generate Call Graph</a></h3>
<pre><code class="language-bash">#!/bin/bash
# Generate simple call graph

FUNC=$1

function recurse_calls() {
    local func=$1
    local indent=$2

    echo "${indent}${func}"

    # Find functions called by this function
    cscope -dL2 "$func" | while read line; do
        called=$(echo $line | awk '{print $2}')
        if [ ! -z "$called" ]; then
            recurse_calls "$called" "${indent}  "
        fi
    done
}

recurse_calls "$FUNC" ""
</code></pre>
<h3 id="find-unused-functions"><a class="header" href="#find-unused-functions">Find Unused Functions</a></h3>
<pre><code class="language-bash">#!/bin/bash
# find_unused.sh

# Get all function definitions
cscope -dL1 "" | awk '{print $2}' | sort -u &gt; /tmp/all_funcs.txt

# For each function, check if it's called
while read func; do
    if [ "$func" != "main" ]; then
        calls=$(cscope -dL3 "$func" | wc -l)
        if [ $calls -eq 0 ]; then
            echo "Unused: $func"
        fi
    fi
done &lt; /tmp/all_funcs.txt

rm /tmp/all_funcs.txt
</code></pre>
<h2 id="makefile-integration"><a class="header" href="#makefile-integration">Makefile Integration</a></h2>
<pre><code class="language-makefile"># Add to Makefile

.PHONY: cscope
cscope:
	@find . -name "*.[ch]" &gt; cscope.files
	@cscope -b -q

.PHONY: cscope-clean
cscope-clean:
	@rm -f cscope.* cscope.files

.PHONY: cscope-update
cscope-update: cscope-clean cscope
</code></pre>
<h2 id="configuration-file"><a class="header" href="#configuration-file">Configuration File</a></h2>
<pre><code class="language-bash"># ~/.cscoperc or project .cscoperc
# (cscope automatically loads this)

# Custom options (limited support)
# Most configuration done via command line
</code></pre>
<h2 id="emacs-integration"><a class="header" href="#emacs-integration">Emacs Integration</a></h2>
<pre><code class="language-elisp">;; Add to ~/.emacs or ~/.emacs.d/init.el

(require 'xcscope)
(cscope-setup)

;; Key bindings
(define-key global-map [(control f3)] 'cscope-set-initial-directory)
(define-key global-map [(control f4)] 'cscope-find-this-symbol)
(define-key global-map [(control f5)] 'cscope-find-global-definition)
(define-key global-map [(control f6)] 'cscope-find-functions-calling-this-function)
(define-key global-map [(control f7)] 'cscope-find-called-functions)
(define-key global-map [(control f8)] 'cscope-find-this-text-string)
(define-key global-map [(control f9)] 'cscope-find-this-file)
(define-key global-map [(control f10)] 'cscope-find-files-including-file)

;; Auto-update database
(setq cscope-do-not-update-database nil)
</code></pre>
<h2 id="best-practices-45"><a class="header" href="#best-practices-45">Best Practices</a></h2>
<h3 id="large-projects"><a class="header" href="#large-projects">Large Projects</a></h3>
<pre><code class="language-bash"># Build inverted index for faster searches
cscope -b -q

# Use compression for large databases
cscope -b -c

# Incremental updates
cscope -u -b -q

# Index only relevant files
find . -name "*.[ch]" \
    ! -path "*/test/*" \
    ! -path "*/build/*" \
    &gt; cscope.files
cscope -b -q
</code></pre>
<h3 id="project-setup-script"><a class="header" href="#project-setup-script">Project Setup Script</a></h3>
<pre><code class="language-bash">#!/bin/bash
# setup_cscope.sh

PROJECT_ROOT=$(git rev-parse --show-toplevel 2&gt;/dev/null || pwd)
cd "$PROJECT_ROOT"

echo "Building cscope database for: $PROJECT_ROOT"

# Find relevant source files
find . \( -name "*.c" -o -name "*.h" -o -name "*.cpp" -o -name "*.hpp" -o -name "*.cc" \) \
    ! -path "*/build/*" \
    ! -path "*/\.git/*" \
    ! -path "*/node_modules/*" \
    &gt; cscope.files

# Build database with inverted index
cscope -b -q -k

echo "Database built: cscope.out"
echo ""
echo "Usage:"
echo "  cscope -d          # Launch interactive mode"
echo "  vim &lt;file&gt;         # Use with Vim (if configured)"
echo "  cscope -L0 symbol  # Command-line search"
</code></pre>
<h3 id="automatic-rebuilds"><a class="header" href="#automatic-rebuilds">Automatic Rebuilds</a></h3>
<pre><code class="language-bash"># Add to project root
# .git/hooks/post-commit

#!/bin/bash
echo "Rebuilding cscope database..."
cscope -b -q -k
echo "Done"
</code></pre>
<h2 id="common-patterns-12"><a class="header" href="#common-patterns-12">Common Patterns</a></h2>
<h3 id="search-all-files"><a class="header" href="#search-all-files">Search All Files</a></h3>
<pre><code class="language-bash"># Find all occurrences of a string
cscope -L4 "TODO"

# Find all error messages
cscope -L4 "error:"

# Find struct definitions
cscope -L6 "^struct"

# Find all malloc calls
cscope -L0 malloc
</code></pre>
<h3 id="code-review-1"><a class="header" href="#code-review-1">Code Review</a></h3>
<pre><code class="language-bash"># Find all functions modified in recent commit
git diff --name-only HEAD~1 | grep '\.[ch]$' | while read file; do
    echo "=== $file ==="
    # Get function names from file
    ctags -x --c-kinds=f "$file" | awk '{print $1}'
done
</code></pre>
<h2 id="troubleshooting-5"><a class="header" href="#troubleshooting-5">Troubleshooting</a></h2>
<pre><code class="language-bash"># Database not found
cscope -b -R    # Rebuild recursively

# Incomplete results
rm cscope.out*
cscope -b -q    # Rebuild with index

# Vim integration not working
:cs show        # Check connections
:cs reset       # Reset connections
:cs add cscope.out

# Permission denied
chmod 644 cscope.out*

# Slow searches
cscope -b -q    # Build with inverted index

# Wrong directory
export CSCOPE_DB=/path/to/cscope.out
</code></pre>
<h2 id="quick-reference-8"><a class="header" href="#quick-reference-8">Quick Reference</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody>
<tr><td><code>cscope -b</code></td><td>Build database</td></tr>
<tr><td><code>cscope -R</code></td><td>Recursive search</td></tr>
<tr><td><code>cscope -d</code></td><td>Use existing database</td></tr>
<tr><td><code>cscope -u</code></td><td>Update database</td></tr>
<tr><td><code>cscope -q</code></td><td>Build inverted index</td></tr>
<tr><td><code>cscope -L0</code></td><td>Find symbol</td></tr>
<tr><td><code>cscope -L1</code></td><td>Find definition</td></tr>
<tr><td><code>cscope -L3</code></td><td>Find callers</td></tr>
<tr><td><code>:cs find s</code></td><td>Vim: Find symbol</td></tr>
<tr><td><code>:cs find g</code></td><td>Vim: Find definition</td></tr>
</tbody></table>
</div>
<p>cscope is an essential tool for navigating large C codebases, providing fast symbol lookups and cross-references that make code exploration and maintenance significantly easier.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ctags"><a class="header" href="#ctags">ctags</a></h1>
<p>ctags is a tool that generates an index (or "tag") file of names found in source and header files, enabling efficient code navigation in text editors. It supports numerous programming languages and integrates seamlessly with Vim, Emacs, and other editors.</p>
<h2 id="overview-53"><a class="header" href="#overview-53">Overview</a></h2>
<p>ctags creates a database of language objects (functions, classes, variables, etc.) found in source files, allowing editors to quickly jump to definitions. Modern implementations include Exuberant Ctags and Universal Ctags.</p>
<p><strong>Key Features:</strong></p>
<ul>
<li>Multi-language support (C, C++, Python, Java, JavaScript, etc.)</li>
<li>Editor integration (Vim, Emacs, Sublime, VS Code)</li>
<li>Recursive directory scanning</li>
<li>Custom tag patterns</li>
<li>Symbol cross-referencing</li>
<li>Incremental updates</li>
</ul>
<h2 id="installation-8"><a class="header" href="#installation-8">Installation</a></h2>
<pre><code class="language-bash"># Ubuntu/Debian - Universal Ctags (recommended)
sudo apt update
sudo apt install universal-ctags

# Or Exuberant Ctags (older)
sudo apt install exuberant-ctags

# macOS - Universal Ctags
brew install --HEAD universal-ctags/universal-ctags/universal-ctags

# CentOS/RHEL
sudo yum install ctags

# Arch Linux
sudo pacman -S ctags

# From source (Universal Ctags)
git clone https://github.com/universal-ctags/ctags.git
cd ctags
./autogen.sh
./configure
make
sudo make install

# Verify installation
ctags --version
</code></pre>
<h2 id="basic-usage-5"><a class="header" href="#basic-usage-5">Basic Usage</a></h2>
<h3 id="generating-tags"><a class="header" href="#generating-tags">Generating Tags</a></h3>
<pre><code class="language-bash"># Generate tags for current directory
ctags *

# Recursive tag generation
ctags -R

# Specific files
ctags file1.c file2.c file3.h

# Multiple languages
ctags -R src/ include/

# Generate tags for specific language
ctags -R --languages=C,C++

# Exclude languages
ctags -R --languages=-JavaScript,-HTML

# Follow symbolic links
ctags -R --links=yes
</code></pre>
<h3 id="tag-file-options"><a class="header" href="#tag-file-options">Tag File Options</a></h3>
<pre><code class="language-bash"># Specify output file
ctags -o mytags -R

# Append to existing tags
ctags -a -R new_directory/

# Create tag file with extra information
ctags -R --fields=+iaS --extras=+q

# Sort tags file
ctags -R --sort=yes

# Case-insensitive sorting
ctags -R --sort=foldcase
</code></pre>
<h2 id="vim-integration-2"><a class="header" href="#vim-integration-2">Vim Integration</a></h2>
<h3 id="basic-configuration-1"><a class="header" href="#basic-configuration-1">Basic Configuration</a></h3>
<pre><code class="language-vim">" Add to ~/.vimrc
set tags=./tags,tags;$HOME

" Search for tags file in current directory and up to $HOME
set tags=./tags;/
</code></pre>
<h3 id="vim-commands-1"><a class="header" href="#vim-commands-1">Vim Commands</a></h3>
<pre><code class="language-vim">" Jump to definition
Ctrl+]          " Jump to tag under cursor
g Ctrl+]        " Show list if multiple matches

" Return from jump
Ctrl+T          " Jump back (pop tag stack)
Ctrl+O          " Jump to previous location

" Navigation
:tag function   " Jump to tag
:ts pattern     " List matching tags
:tn             " Next matching tag
:tp             " Previous matching tag

" Tag stack
:tags           " Show tag stack
:pop            " Pop from tag stack

" Split window navigation
Ctrl+W ]        " Split window and jump to tag
Ctrl+W g ]      " Split and list matches
</code></pre>
<h3 id="advanced-vim-configuration-1"><a class="header" href="#advanced-vim-configuration-1">Advanced Vim Configuration</a></h3>
<pre><code class="language-vim">" ~/.vimrc
" Set tags file locations
set tags=./tags,tags;$HOME

" Enable tag stack
set tagstack

" Show tag preview in popup
set completeopt=menuone,preview

" Custom key mappings
nnoremap &lt;C-]&gt; g&lt;C-]&gt;       " Always show list if multiple matches
nnoremap &lt;leader&gt;t :tag&lt;Space&gt;
nnoremap &lt;leader&gt;] :tselect&lt;CR&gt;
nnoremap &lt;leader&gt;[ :pop&lt;CR&gt;

" Split navigation
nnoremap &lt;C-\&gt; :tab split&lt;CR&gt;:exec("tag ".expand("&lt;cword&gt;"))&lt;CR&gt;
nnoremap &lt;A-]&gt; :vsp &lt;CR&gt;:exec("tag ".expand("&lt;cword&gt;"))&lt;CR&gt;

" Auto-regenerate tags
autocmd BufWritePost *.c,*.cpp,*.h,*.py silent! !ctags -R &amp;
</code></pre>
<h3 id="vim-with-tagbar-plugin"><a class="header" href="#vim-with-tagbar-plugin">Vim with Tagbar Plugin</a></h3>
<pre><code class="language-vim">" Install with vim-plug
Plug 'majutsushi/tagbar'

" Configuration
nmap &lt;F8&gt; :TagbarToggle&lt;CR&gt;

let g:tagbar_width = 30
let g:tagbar_autofocus = 1
let g:tagbar_sort = 0

" Custom language configuration
let g:tagbar_type_go = {
    \ 'ctagstype' : 'go',
    \ 'kinds'     : [
        \ 'p:package',
        \ 'i:imports',
        \ 'c:constants',
        \ 'v:variables',
        \ 't:types',
        \ 'n:interfaces',
        \ 'w:fields',
        \ 'e:embedded',
        \ 'm:methods',
        \ 'r:constructor',
        \ 'f:functions'
    \ ],
    \ 'sro' : '.',
    \ 'kind2scope' : {
        \ 't' : 'ctype',
        \ 'n' : 'ntype'
    \ },
    \ 'scope2kind' : {
        \ 'ctype' : 't',
        \ 'ntype' : 'n'
    \ },
\ }
</code></pre>
<h2 id="language-specific-features"><a class="header" href="#language-specific-features">Language-Specific Features</a></h2>
<h3 id="cc"><a class="header" href="#cc">C/C++</a></h3>
<pre><code class="language-bash"># C/C++ with all features
ctags -R \
    --c-kinds=+p \
    --c++-kinds=+p \
    --fields=+iaS \
    --extras=+q

# Include system headers
ctags -R --c-kinds=+px --fields=+iaS --extras=+q \
    /usr/include \
    /usr/local/include \
    .

# Kernel-style projects
ctags -R \
    --exclude=.git \
    --exclude=build \
    --exclude=Documentation \
    --languages=C \
    --langmap=c:.c.h \
    --c-kinds=+px \
    --fields=+iaS \
    --extras=+q
</code></pre>
<h3 id="python-3"><a class="header" href="#python-3">Python</a></h3>
<pre><code class="language-bash"># Python projects
ctags -R \
    --languages=Python \
    --python-kinds=-i \
    --fields=+l

# Include virtualenv
ctags -R \
    --languages=Python \
    --fields=+l \
    . \
    venv/lib/python*/site-packages/
</code></pre>
<h3 id="javascripttypescript"><a class="header" href="#javascripttypescript">JavaScript/TypeScript</a></h3>
<pre><code class="language-bash"># JavaScript
ctags -R \
    --languages=JavaScript \
    --exclude=node_modules \
    --exclude=dist \
    --exclude=build

# TypeScript
ctags -R \
    --languages=TypeScript \
    --exclude=node_modules \
    --exclude=*.min.js
</code></pre>
<h3 id="java-1"><a class="header" href="#java-1">Java</a></h3>
<pre><code class="language-bash"># Java projects
ctags -R \
    --languages=Java \
    --exclude=.git \
    --exclude=target \
    --exclude=*.class

# Include JAR dependencies (if unpacked)
ctags -R src/ lib/
</code></pre>
<h2 id="advanced-usage-1"><a class="header" href="#advanced-usage-1">Advanced Usage</a></h2>
<h3 id="custom-configuration"><a class="header" href="#custom-configuration">Custom Configuration</a></h3>
<pre><code class="language-bash"># ~/.ctags.d/local.ctags (Universal Ctags)
--recurse=yes
--tag-relative=yes
--exclude=.git
--exclude=.svn
--exclude=.hg
--exclude=node_modules
--exclude=bower_components
--exclude=*.min.js
--exclude=*.swp
--exclude=*.bak
--exclude=*.pyc
--exclude=*.class
--exclude=target
--exclude=build
--exclude=dist

# Language-specific
--langdef=markdown
--langmap=markdown:.md.markdown.mdown.mkd.mkdn
--regex-markdown=/^#{1}[ \t]+(.+)/. \1/h,heading1/
--regex-markdown=/^#{2}[ \t]+(.+)/..  \1/h,heading2/
--regex-markdown=/^#{3}[ \t]+(.+)/...   \1/h,heading3/
</code></pre>
<h3 id="project-specific-tags"><a class="header" href="#project-specific-tags">Project-Specific Tags</a></h3>
<pre><code class="language-bash"># .git/hooks/post-commit
#!/bin/bash
ctags -R &amp;

# Make executable
chmod +x .git/hooks/post-commit

# Or use Makefile
.PHONY: tags
tags:
	ctags -R --fields=+iaS --extras=+q

.PHONY: tags-clean
tags-clean:
	rm -f tags
</code></pre>
<h3 id="filtering-and-exclusions"><a class="header" href="#filtering-and-exclusions">Filtering and Exclusions</a></h3>
<pre><code class="language-bash"># Exclude directories
ctags -R --exclude=build --exclude=.git --exclude=node_modules

# Exclude files by pattern
ctags -R --exclude=*.min.js --exclude=*.test.js

# Include only specific directories
ctags -R src/ include/

# Custom exclusions file
echo "build/" &gt; .ctagsignore
echo "*.min.js" &gt;&gt; .ctagsignore
ctags -R --exclude=@.ctagsignore
</code></pre>
<h2 id="scripting-with-ctags"><a class="header" href="#scripting-with-ctags">Scripting with ctags</a></h2>
<h3 id="automated-tag-generation"><a class="header" href="#automated-tag-generation">Automated Tag Generation</a></h3>
<pre><code class="language-bash">#!/bin/bash
# update_tags.sh

PROJECT_ROOT=$(git rev-parse --show-toplevel 2&gt;/dev/null || pwd)
cd "$PROJECT_ROOT"

echo "Generating tags for: $PROJECT_ROOT"

ctags -R \
    --fields=+iaS \
    --extras=+q \
    --exclude=.git \
    --exclude=build \
    --exclude=node_modules \
    --exclude=*.min.js

echo "Tags file generated: $PROJECT_ROOT/tags"
</code></pre>
<h3 id="multi-project-tags"><a class="header" href="#multi-project-tags">Multi-Project Tags</a></h3>
<pre><code class="language-bash">#!/bin/bash
# generate_all_tags.sh

PROJECTS=(
    "$HOME/projects/project1"
    "$HOME/projects/project2"
    "$HOME/projects/lib/common"
)

for project in "${PROJECTS[@]}"; do
    if [ -d "$project" ]; then
        echo "Generating tags for $project"
        (cd "$project" &amp;&amp; ctags -R)
    fi
done

# Merge tags files
cat ~/projects/*/tags | sort -u &gt; ~/projects/all_tags
</code></pre>
<h3 id="find-symbol-across-projects"><a class="header" href="#find-symbol-across-projects">Find Symbol Across Projects</a></h3>
<pre><code class="language-bash">#!/bin/bash
# find_symbol.sh

SYMBOL=$1

if [ -z "$SYMBOL" ]; then
    echo "Usage: $0 &lt;symbol&gt;"
    exit 1
fi

# Search in tags file
echo "Searching for: $SYMBOL"
echo ""

grep "^$SYMBOL" tags | while IFS=$'\t' read tag file pattern rest; do
    echo "File: $file"
    echo "Pattern: $pattern"
    echo "---"
done
</code></pre>
<h2 id="integration-with-other-editors"><a class="header" href="#integration-with-other-editors">Integration with Other Editors</a></h2>
<h3 id="emacs"><a class="header" href="#emacs">Emacs</a></h3>
<pre><code class="language-elisp">;; Add to ~/.emacs or ~/.emacs.d/init.el

;; Enable etags (similar to ctags)
(setq tags-table-list '("./TAGS" "../TAGS" "../../TAGS"))

;; Key bindings
(global-set-key (kbd "M-.") 'find-tag)
(global-set-key (kbd "M-*") 'pop-tag-mark)
(global-set-key (kbd "M-,") 'tags-loop-continue)

;; Generate tags for project
(defun my-generate-tags ()
  (interactive)
  (shell-command "ctags -e -R ."))

(global-set-key (kbd "C-c g") 'my-generate-tags)
</code></pre>
<h3 id="vs-code"><a class="header" href="#vs-code">VS Code</a></h3>
<pre><code class="language-json">// settings.json
{
    "ctagsFile": "tags",
    "ctagsPath": "/usr/bin/ctags"
}

// Install extension
// ext install jaydenlin.ctags-support
</code></pre>
<h3 id="sublime-text"><a class="header" href="#sublime-text">Sublime Text</a></h3>
<pre><code class="language-json">// Settings - User
{
    "tags_path": "tags",
    "ctags_command": "/usr/bin/ctags -R --fields=+iaS --extras=+q"
}

// Install CTags package via Package Control
</code></pre>
<h2 id="common-patterns-13"><a class="header" href="#common-patterns-13">Common Patterns</a></h2>
<h3 id="monorepo-tag-management"><a class="header" href="#monorepo-tag-management">Monorepo Tag Management</a></h3>
<pre><code class="language-bash">#!/bin/bash
# monorepo_tags.sh

# Root tags
ctags -R --fields=+iaS --extras=+q -o tags.root .

# Per-service tags
for service in services/*; do
    if [ -d "$service" ]; then
        (cd "$service" &amp;&amp; ctags -R -o tags .)
    fi
done

# Merge all tags
find . -name "tags" -exec cat {} \; | sort -u &gt; tags
</code></pre>
<h3 id="language-specific-tag-files"><a class="header" href="#language-specific-tag-files">Language-Specific Tag Files</a></h3>
<pre><code class="language-bash">#!/bin/bash
# Generate separate tags for each language

# C/C++ tags
ctags -R -o tags.c --languages=C,C++ .

# Python tags
ctags -R -o tags.py --languages=Python .

# JavaScript tags
ctags -R -o tags.js --languages=JavaScript --exclude=node_modules .

# Merge all
cat tags.* | sort -u &gt; tags
</code></pre>
<h3 id="incremental-updates"><a class="header" href="#incremental-updates">Incremental Updates</a></h3>
<pre><code class="language-bash">#!/bin/bash
# update_changed.sh

# Get changed files since last tag generation
CHANGED=$(find . -type f -newer tags \( -name "*.c" -o -name "*.h" \))

if [ ! -z "$CHANGED" ]; then
    echo "Updating tags for changed files"

    # Generate tags for changed files
    ctags -a $CHANGED

    # Sort tags file
    sort -u tags -o tags
fi
</code></pre>
<h2 id="best-practices-46"><a class="header" href="#best-practices-46">Best Practices</a></h2>
<h3 id="recommended-configuration"><a class="header" href="#recommended-configuration">Recommended Configuration</a></h3>
<pre><code class="language-bash"># ~/.ctags or ~/.ctags.d/default.ctags (Universal Ctags)

# Recurse by default
--recurse=yes

# Tag relative paths
--tag-relative=yes

# Additional fields
--fields=+iaS
--extras=+q

# Common exclusions
--exclude=.git
--exclude=.svn
--exclude=node_modules
--exclude=bower_components
--exclude=*.min.js
--exclude=*.min.css
--exclude=*.map
--exclude=build
--exclude=dist
--exclude=target
--exclude=*.pyc
--exclude=*.class
--exclude=.DS_Store

# Sort tags
--sort=yes

# Language-specific
--languages=all
--c-kinds=+px
--c++-kinds=+px
--python-kinds=-i
</code></pre>
<h3 id="git-integration"><a class="header" href="#git-integration">Git Integration</a></h3>
<pre><code class="language-bash"># .gitignore
tags
tags.lock
tags.temp
TAGS

# .git/hooks/post-checkout
#!/bin/bash
ctags -R &amp;

# .git/hooks/post-merge
#!/bin/bash
ctags -R &amp;
</code></pre>
<h3 id="performance-tips"><a class="header" href="#performance-tips">Performance Tips</a></h3>
<pre><code class="language-bash"># Use parallel processing for large projects
find . -name "*.c" -o -name "*.h" | xargs -P 4 -n 50 ctags -a

# Generate tags in background
ctags -R &amp;

# Use faster sorting
ctags -R --sort=no
LC_ALL=C sort tags -o tags

# Exclude large dependency directories
ctags -R --exclude=vendor --exclude=node_modules
</code></pre>
<h2 id="troubleshooting-6"><a class="header" href="#troubleshooting-6">Troubleshooting</a></h2>
<pre><code class="language-bash"># Tags file not found in Vim
:set tags?          # Check tags path
:set tags=./tags;/  # Set tags path

# Duplicate entries
sort -u tags -o tags

# Wrong language detected
ctags --list-languages        # Show supported languages
ctags --list-maps            # Show file extensions
ctags -R --languages=C,C++   # Force specific languages

# Performance issues
ctags -R --exclude=node_modules --exclude=vendor

# Tags not updating
rm tags
ctags -R

# Vim not jumping to correct location
# Regenerate with line numbers
ctags -R --fields=+n

# Check tag format
head -n 20 tags
</code></pre>
<h2 id="quick-reference-9"><a class="header" href="#quick-reference-9">Quick Reference</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody>
<tr><td><code>ctags -R</code></td><td>Generate tags recursively</td></tr>
<tr><td><code>ctags -a</code></td><td>Append to tags</td></tr>
<tr><td><code>ctags --list-languages</code></td><td>Show supported languages</td></tr>
<tr><td><code>Ctrl+]</code></td><td>Vim: Jump to tag</td></tr>
<tr><td><code>Ctrl+T</code></td><td>Vim: Return from tag</td></tr>
<tr><td><code>:ts</code></td><td>Vim: List tags</td></tr>
<tr><td><code>:tag name</code></td><td>Vim: Jump to tag</td></tr>
<tr><td><code>--exclude=DIR</code></td><td>Exclude directory</td></tr>
<tr><td><code>--languages=LANG</code></td><td>Specific languages</td></tr>
<tr><td><code>--fields=+iaS</code></td><td>Extra tag fields</td></tr>
</tbody></table>
</div>
<p>ctags is an essential tool for code navigation, enabling developers to efficiently explore and understand large codebases by providing instant access to symbol definitions and references.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="mdbook"><a class="header" href="#mdbook">mdBook</a></h1>
<p>mdBook is a command-line tool for creating books from Markdown files, similar to Gitbook but implemented in Rust. It's fast, simple, and ideal for technical documentation, tutorials, and books.</p>
<h2 id="overview-54"><a class="header" href="#overview-54">Overview</a></h2>
<p>mdBook takes Markdown files and generates a static website with built-in search, syntax highlighting, and theme support. It's the tool used to create the official Rust programming language book.</p>
<p><strong>Key Features:</strong></p>
<ul>
<li>Fast static site generation</li>
<li>Automatic table of contents</li>
<li>Built-in search functionality</li>
<li>Syntax highlighting for code</li>
<li>Light and dark themes</li>
<li>Live preview with hot reloading</li>
<li>Markdown extensions</li>
<li>Customizable with preprocessors</li>
</ul>
<h2 id="installation-9"><a class="header" href="#installation-9">Installation</a></h2>
<pre><code class="language-bash"># Using Cargo (Rust package manager)
cargo install mdbook

# Ubuntu/Debian (from binary)
wget https://github.com/rust-lang/mdBook/releases/download/v0.4.36/mdbook-v0.4.36-x86_64-unknown-linux-gnu.tar.gz
tar xzf mdbook-v0.4.36-x86_64-unknown-linux-gnu.tar.gz
sudo mv mdbook /usr/local/bin/

# macOS
brew install mdbook

# From source
git clone https://github.com/rust-lang/mdBook.git
cd mdBook
cargo build --release
sudo cp target/release/mdbook /usr/local/bin/

# Verify installation
mdbook --version
</code></pre>
<h2 id="quick-start-2"><a class="header" href="#quick-start-2">Quick Start</a></h2>
<h3 id="create-a-new-book"><a class="header" href="#create-a-new-book">Create a New Book</a></h3>
<pre><code class="language-bash"># Create new book
mdbook init mybook

# Project structure created:
# mybook/
# ├── book.toml       # Configuration file
# └── src/
#     ├── SUMMARY.md  # Table of contents
#     └── chapter_1.md

# Enter directory
cd mybook

# Build the book
mdbook build

# Serve with live preview
mdbook serve

# Open in browser
open http://localhost:3000
</code></pre>
<h3 id="project-structure-1"><a class="header" href="#project-structure-1">Project Structure</a></h3>
<pre><code>mybook/
├── book.toml              # Configuration
├── src/
│   ├── SUMMARY.md         # Table of contents (required)
│   ├── chapter_1.md       # Chapter files
│   ├── chapter_2.md
│   ├── images/            # Images directory
│   │   └── diagram.png
│   └── sub_chapter/
│       └── section.md
└── book/                  # Generated output (git ignore)
    ├── index.html
    ├── chapter_1.html
    └── ...
</code></pre>
<h2 id="configuration-2"><a class="header" href="#configuration-2">Configuration</a></h2>
<h3 id="basic-booktoml"><a class="header" href="#basic-booktoml">Basic book.toml</a></h3>
<pre><code class="language-toml">[book]
title = "My Amazing Book"
authors = ["John Doe"]
language = "en"
multilingual = false
src = "src"

[build]
build-dir = "book"
create-missing = true

[output.html]
default-theme = "light"
preferred-dark-theme = "navy"
git-repository-url = "https://github.com/user/repo"
git-repository-icon = "fa-github"
</code></pre>
<h3 id="advanced-configuration-1"><a class="header" href="#advanced-configuration-1">Advanced Configuration</a></h3>
<pre><code class="language-toml">[book]
title = "Advanced Guide"
authors = ["Jane Smith", "John Doe"]
description = "A comprehensive guide"
language = "en"
multilingual = false
src = "src"

[build]
build-dir = "book"
create-missing = true

[preprocessor.links]

[output.html]
# Theme
default-theme = "rust"
preferred-dark-theme = "navy"
curly-quotes = true

# Repository
git-repository-url = "https://github.com/user/repo"
git-repository-icon = "fa-github"

# Navigation
additional-css = ["custom.css"]
additional-js = ["custom.js"]

# Code
no-section-label = false

# Search
[output.html.search]
enable = true
limit-results = 30
teaser-word-count = 30
use-boolean-and = true
boost-title = 2
boost-hierarchy = 1
boost-paragraph = 1
expand = true
heading-split-level = 3

# Print
[output.html.print]
enable = true

# Playground (for Rust code)
[output.html.playground]
editable = true
copyable = true
copy-js = true
line-numbers = false
runnable = true
</code></pre>
<h2 id="summarymd-format"><a class="header" href="#summarymd-format">SUMMARY.md Format</a></h2>
<h3 id="basic-structure-1"><a class="header" href="#basic-structure-1">Basic Structure</a></h3>
<pre><code class="language-markdown"># Summary

[Introduction](./introduction.md)

# User Guide

- [Getting Started](./guide/getting-started.md)
- [Installation](./guide/installation.md)
    - [Linux](./guide/installation/linux.md)
    - [macOS](./guide/installation/macos.md)
    - [Windows](./guide/installation/windows.md)
- [Configuration](./guide/configuration.md)

# Reference

- [API Reference](./reference/api.md)
- [CLI Commands](./reference/cli.md)

# Appendix

- [Glossary](./appendix/glossary.md)
- [Contributors](./appendix/contributors.md)
</code></pre>
<h3 id="advanced-features-3"><a class="header" href="#advanced-features-3">Advanced Features</a></h3>
<pre><code class="language-markdown"># Summary

[Preface](./preface.md)

---

# Part I: Basics

- [Chapter 1](./chapter-1.md)
- [Chapter 2](./chapter-2.md)

---

# Part II: Advanced

- [Chapter 3](./chapter-3.md)
    - [Section 3.1](./chapter-3/section-1.md)
    - [Section 3.2](./chapter-3/section-2.md)

---

[Conclusion](./conclusion.md)
[Appendix](./appendix.md)
</code></pre>
<h2 id="commands"><a class="header" href="#commands">Commands</a></h2>
<h3 id="build-commands"><a class="header" href="#build-commands">Build Commands</a></h3>
<pre><code class="language-bash"># Build book
mdbook build

# Build and watch for changes
mdbook watch

# Serve with live reload
mdbook serve

# Serve on different port
mdbook serve -p 8080

# Serve on specific address
mdbook serve -n 0.0.0.0

# Open in browser
mdbook serve --open

# Build to different directory
mdbook build -d /tmp/mybook
</code></pre>
<h3 id="testing-3"><a class="header" href="#testing-3">Testing</a></h3>
<pre><code class="language-bash"># Test code examples
mdbook test

# Test with specific library
mdbook test --library-path ./target/debug

# Test specific chapter
mdbook test path/to/chapter.md
</code></pre>
<h3 id="cleaning"><a class="header" href="#cleaning">Cleaning</a></h3>
<pre><code class="language-bash"># Clean build directory
mdbook clean

# Remove specific build
rm -rf book/
</code></pre>
<h2 id="markdown-extensions"><a class="header" href="#markdown-extensions">Markdown Extensions</a></h2>
<h3 id="code-blocks"><a class="header" href="#code-blocks">Code Blocks</a></h3>
<pre><code class="language-markdown">```rust
fn main() {
    println!("Hello, world!");
}
```

```rust,editable
// This code can be edited in browser
fn main() {
    println!("Try editing me!");
}
```

```rust,ignore
// This code won't be tested
fn incomplete() {
```

```rust,no_run
// Compiles but doesn't run during tests
fn main() {
    std::process::exit(1);
}
```

```rust,should_panic
// Expected to panic
fn main() {
    panic!("Expected panic");
}
```

```python
def greet(name):
    print(f"Hello, {name}!")
```

```bash
#!/bin/bash
echo "Hello from bash"
```
</code></pre>
<h3 id="include-files"><a class="header" href="#include-files">Include Files</a></h3>
<pre><code class="language-markdown">&lt;!-- Include entire file --&gt;
{{#include path/to/file.rs}}

&lt;!-- Include specific lines --&gt;
{{#include path/to/file.rs:10:20}}

&lt;!-- Include from line to end --&gt;
{{#include path/to/file.rs:10:}}

&lt;!-- Include with anchor --&gt;
{{#include path/to/file.rs:my_anchor}}
</code></pre>
<h3 id="rust-playground"><a class="header" href="#rust-playground">Rust Playground</a></h3>
<pre><code class="language-markdown">```rust,editable
{{#playpen example.rs}}
```

```rust
{{#rustdoc_include path/to/lib.rs}}
```
</code></pre>
<h2 id="customization"><a class="header" href="#customization">Customization</a></h2>
<h3 id="custom-css"><a class="header" href="#custom-css">Custom CSS</a></h3>
<pre><code class="language-css">/* custom.css */
:root {
    --sidebar-width: 300px;
    --page-padding: 20px;
    --content-max-width: 900px;
}

.content {
    font-size: 18px;
    line-height: 1.8;
}

.chapter {
    padding: 2em;
}

code {
    font-family: 'Fira Code', monospace;
}

pre {
    border-radius: 8px;
}
</code></pre>
<h3 id="custom-javascript"><a class="header" href="#custom-javascript">Custom JavaScript</a></h3>
<pre><code class="language-javascript">// custom.js
window.addEventListener('load', function() {
    // Add custom functionality
    console.log('Book loaded');

    // Add copy button to code blocks
    document.querySelectorAll('pre &gt; code').forEach(function(code) {
        const button = document.createElement('button');
        button.textContent = 'Copy';
        button.onclick = function() {
            navigator.clipboard.writeText(code.textContent);
            button.textContent = 'Copied!';
            setTimeout(() =&gt; button.textContent = 'Copy', 2000);
        };
        code.parentElement.insertBefore(button, code);
    });
});
</code></pre>
<h3 id="custom-theme"><a class="header" href="#custom-theme">Custom Theme</a></h3>
<pre><code class="language-toml"># book.toml
[output.html]
theme = "my-theme"

# Create theme directory
# mkdir -p my-theme
# Copy and modify default theme files
</code></pre>
<pre><code class="language-bash"># Extract default theme
mdbook init --theme

# Files created in theme/:
# - index.hbs        # Main template
# - head.hbs         # HTML head
# - header.hbs       # Page header
# - chrome.css       # UI styles
# - general.css      # Content styles
# - variables.css    # CSS variables
</code></pre>
<h2 id="preprocessors"><a class="header" href="#preprocessors">Preprocessors</a></h2>
<h3 id="built-in-preprocessors"><a class="header" href="#built-in-preprocessors">Built-in Preprocessors</a></h3>
<pre><code class="language-toml"># Enable links preprocessor
[preprocessor.links]

# Example usage in Markdown:
# [Rust](https://www.rust-lang.org/)
</code></pre>
<h3 id="custom-preprocessor"><a class="header" href="#custom-preprocessor">Custom Preprocessor</a></h3>
<pre><pre class="playground"><code class="language-rust">// my-preprocessor/src/main.rs
use mdbook::preprocess::{Preprocessor, PreprocessorContext};
use mdbook::book::Book;
use std::io;

struct MyPreprocessor;

impl Preprocessor for MyPreprocessor {
    fn name(&amp;self) -&gt; &amp;str {
        "my-preprocessor"
    }

    fn run(&amp;self, ctx: &amp;PreprocessorContext, mut book: Book) -&gt; Result&lt;Book, Error&gt; {
        // Process book content
        Ok(book)
    }
}

fn main() {
    let preprocessor = MyPreprocessor;
    if let Err(e) = mdbook::preprocess::handle_preprocessing(&amp;preprocessor) {
        eprintln!("{}", e);
        std::process::exit(1);
    }
}</code></pre></pre>
<pre><code class="language-toml"># book.toml
[preprocessor.my-preprocessor]
command = "my-preprocessor"
</code></pre>
<h2 id="deployment-1"><a class="header" href="#deployment-1">Deployment</a></h2>
<h3 id="github-pages-1"><a class="header" href="#github-pages-1">GitHub Pages</a></h3>
<pre><code class="language-bash"># Build book
mdbook build

# Initialize git (if needed)
git init
git add .
git commit -m "Initial commit"

# Create gh-pages branch
git checkout --orphan gh-pages
git reset --hard
cp -r book/* .
rm -rf book src
git add .
git commit -m "Deploy book"
git push origin gh-pages

# Or use GitHub Actions
</code></pre>
<h3 id="github-actions-workflow"><a class="header" href="#github-actions-workflow">GitHub Actions Workflow</a></h3>
<pre><code class="language-yaml"># .github/workflows/deploy.yml
name: Deploy mdBook

on:
  push:
    branches: [ main ]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2

      - name: Setup mdBook
        uses: peaceiris/actions-mdbook@v1
        with:
          mdbook-version: 'latest'

      - name: Build
        run: mdbook build

      - name: Deploy
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./book
</code></pre>
<h3 id="netlify"><a class="header" href="#netlify">Netlify</a></h3>
<pre><code class="language-toml"># netlify.toml
[build]
command = "mdbook build"
publish = "book"

[build.environment]
RUST_VERSION = "1.70.0"
</code></pre>
<h3 id="docker"><a class="header" href="#docker">Docker</a></h3>
<pre><code class="language-dockerfile"># Dockerfile
FROM rust:1.70 as builder

RUN cargo install mdbook

WORKDIR /book
COPY . .
RUN mdbook build

FROM nginx:alpine
COPY --from=builder /book/book /usr/share/nginx/html
</code></pre>
<h2 id="common-patterns-14"><a class="header" href="#common-patterns-14">Common Patterns</a></h2>
<h3 id="multi-language-book"><a class="header" href="#multi-language-book">Multi-Language Book</a></h3>
<pre><code class="language-toml"># book.toml
[book]
multilingual = true

[output.html]
redirect = { "/" = "/en/" }

# Directory structure:
# src/
# ├── en/
# │   ├── SUMMARY.md
# │   └── chapter_1.md
# └── es/
#     ├── SUMMARY.md
#     └── chapter_1.md
</code></pre>
<h3 id="code-examples-project"><a class="header" href="#code-examples-project">Code Examples Project</a></h3>
<pre><code class="language-markdown">&lt;!-- Link to example project --&gt;
See the [full example](https://github.com/user/repo/tree/main/examples/basic)

&lt;!-- Include code from example --&gt;
{{#include ../../examples/basic/src/main.rs}}
</code></pre>
<h3 id="versioned-documentation"><a class="header" href="#versioned-documentation">Versioned Documentation</a></h3>
<pre><code class="language-bash">#!/bin/bash
# build_versions.sh

VERSIONS=("v1.0" "v1.1" "v2.0")

for version in "${VERSIONS[@]}"; do
    git checkout $version
    mdbook build -d "book/$version"
done

# Create index.html for version selection
</code></pre>
<h2 id="best-practices-47"><a class="header" href="#best-practices-47">Best Practices</a></h2>
<h3 id="content-organization"><a class="header" href="#content-organization">Content Organization</a></h3>
<pre><code class="language-markdown"># Recommended structure:
src/
├── SUMMARY.md
├── introduction.md
├── guide/
│   ├── README.md         # Chapter intro
│   ├── basics.md
│   └── advanced.md
├── reference/
│   ├── README.md
│   ├── api.md
│   └── cli.md
├── examples/
│   └── tutorial.md
└── appendix/
    ├── glossary.md
    └── resources.md
</code></pre>
<h3 id="markdown-style"><a class="header" href="#markdown-style">Markdown Style</a></h3>
<pre><code class="language-markdown"># Use consistent heading levels

## Chapter Title

### Section

#### Subsection

# Use relative links
[Link to other chapter](../other/chapter.md)

# Use descriptive alt text for images
![Architecture diagram showing components](./images/arch.png)

# Include language in code blocks
```rust
fn main() {}
</code></pre>
<h1 id="use-admonitions-with-appropriate-css"><a class="header" href="#use-admonitions-with-appropriate-css">Use admonitions (with appropriate CSS)</a></h1>
<blockquote>
<p><strong>Note</strong>: Important information</p>
</blockquote>
<blockquote>
<p><strong>Warning</strong>: Be careful here</p>
</blockquote>
<pre><code>
### Performance Tips

```bash
# Minimize preprocessors
# Use relative links
# Optimize images
# Enable search caching

[output.html.search]
limit-results = 20
</code></pre>
<h2 id="troubleshooting-7"><a class="header" href="#troubleshooting-7">Troubleshooting</a></h2>
<pre><code class="language-bash"># Build fails
mdbook build -v          # Verbose output

# Links not working
# Use relative links: ./file.md or ../other/file.md

# Search not working
[output.html.search]
enable = true

# Changes not reflecting
mdbook clean &amp;&amp; mdbook build

# Port already in use
mdbook serve -p 3001

# Code not highlighting
# Ensure language is specified in code blocks
</code></pre>
<h2 id="quick-reference-10"><a class="header" href="#quick-reference-10">Quick Reference</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody>
<tr><td><code>mdbook init</code></td><td>Create new book</td></tr>
<tr><td><code>mdbook build</code></td><td>Build book</td></tr>
<tr><td><code>mdbook serve</code></td><td>Serve with live reload</td></tr>
<tr><td><code>mdbook test</code></td><td>Test code examples</td></tr>
<tr><td><code>mdbook clean</code></td><td>Clean build directory</td></tr>
<tr><td><code>mdbook watch</code></td><td>Watch for changes</td></tr>
</tbody></table>
</div>
<p>mdBook is an excellent tool for creating beautiful, fast, and maintainable documentation, perfect for technical books, tutorials, API documentation, and user guides.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sed"><a class="header" href="#sed">sed</a></h1>
<p>sed is a stream editor that allows you to manipulate text files. It is a powerful tool that can be used to search for and replace text, delete text, and more.</p>
<h2 id="commonly-used-sed-commands"><a class="header" href="#commonly-used-sed-commands">Commonly Used <code>sed</code> Commands</a></h2>
<ol>
<li>
<p><strong>Replace all occurrences of a string in a file:</strong></p>
<pre><code class="language-bash">sed -i 's/old_string/new_string/g' filename
</code></pre>
</li>
<li>
<p><strong>Delete lines containing a specific pattern:</strong></p>
<pre><code class="language-bash">sed -i '/pattern/d' filename
</code></pre>
</li>
<li>
<p><strong>Print only lines that match a pattern:</strong></p>
<pre><code class="language-bash">sed -n '/pattern/p' filename
</code></pre>
</li>
<li>
<p><strong>Insert a line after a match:</strong></p>
<pre><code class="language-bash">sed -i '/pattern/a\new_line' filename
</code></pre>
</li>
<li>
<p><strong>Insert a line before a match:</strong></p>
<pre><code class="language-bash">sed -i '/pattern/i\new_line' filename
</code></pre>
</li>
<li>
<p><strong>Replace text on a specific line number:</strong></p>
<pre><code class="language-bash">sed -i '3s/old_text/new_text/' filename
</code></pre>
</li>
<li>
<p><strong>Delete a specific line number:</strong></p>
<pre><code class="language-bash">sed -i '5d' filename
</code></pre>
</li>
<li>
<p><strong>Replace text between two patterns:</strong></p>
<pre><code class="language-bash">sed -i '/start_pattern/,/end_pattern/s/old_text/new_text/g' filename
</code></pre>
</li>
<li>
<p><strong>Print lines between two patterns:</strong></p>
<pre><code class="language-bash">sed -n '/start_pattern/,/end_pattern/p' filename
</code></pre>
</li>
<li>
<p><strong>Append text to the end of each line:</strong></p>
<pre><code class="language-bash">sed -i 's/$/append_text/' filename
</code></pre>
</li>
</ol>
<p>These commands cover a variety of common use cases for the <code>sed</code> command, making it a versatile tool for text manipulation and processing.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="awk"><a class="header" href="#awk">awk</a></h1>
<p>awk is a powerful tool for processing text files. It is a powerful tool that can be used to process text files, extract data, and more.</p>
<h2 id="commonly-used-awk-commands"><a class="header" href="#commonly-used-awk-commands">Commonly Used <code>awk</code> Commands</a></h2>
<ol>
<li>
<p><strong>Print all lines in a file:</strong></p>
<pre><code class="language-bash">awk '{print}' filename
</code></pre>
</li>
<li>
<p><strong>Print the first column of a file:</strong></p>
<pre><code class="language-bash">awk '{print $1}' filename
</code></pre>
</li>
<li>
<p><strong>Print the first and second columns of a file:</strong></p>
<pre><code class="language-bash">awk '{print $1, $2}' filename
</code></pre>
</li>
<li>
<p><strong>Print lines that match a pattern:</strong></p>
<pre><code class="language-bash">awk '/pattern/ {print}' filename
</code></pre>
</li>
<li>
<p><strong>Print lines where the value in the first column is greater than 10:</strong></p>
<pre><code class="language-bash">awk '$1 &gt; 10' filename
</code></pre>
</li>
<li>
<p><strong>Calculate the sum of values in the first column:</strong></p>
<pre><code class="language-bash">awk '{sum += $1} END {print sum}' filename
</code></pre>
</li>
<li>
<p><strong>Calculate the average of values in the first column:</strong></p>
<pre><code class="language-bash">awk '{sum += $1; count++} END {print sum/count}' filename
</code></pre>
</li>
<li>
<p><strong>Print the number of lines in a file:</strong></p>
<pre><code class="language-bash">awk 'END {print NR}' filename
</code></pre>
</li>
<li>
<p><strong>Print lines with more than 3 fields:</strong></p>
<pre><code class="language-bash">awk 'NF &gt; 3' filename
</code></pre>
</li>
<li>
<p><strong>Replace a string in a file:</strong></p>
<pre><code class="language-bash">awk '{gsub(/old_string/, "new_string"); print}' filename
</code></pre>
</li>
</ol>
<p>These commands cover a variety of common use cases for the <code>awk</code> command, making it a versatile tool for text processing and data extraction.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="curl"><a class="header" href="#curl">curl</a></h1>
<p>curl (Client URL) is a command-line tool and library for transferring data with URLs. It supports a wide range of protocols including HTTP, HTTPS, FTP, FTPS, SCP, SFTP, TFTP, and more.</p>
<h2 id="overview-55"><a class="header" href="#overview-55">Overview</a></h2>
<p>curl is one of the most versatile tools for testing APIs, downloading files, and debugging network requests. It's available on virtually all platforms and is commonly used in scripts and automation.</p>
<p><strong>Key Features:</strong></p>
<ul>
<li>Support for numerous protocols (HTTP, HTTPS, FTP, SMTP, etc.)</li>
<li>Authentication support (Basic, Digest, OAuth, etc.)</li>
<li>SSL/TLS support</li>
<li>Cookie handling</li>
<li>Resume transfers</li>
<li>Proxy support</li>
<li>Rate limiting</li>
<li>Custom headers and methods</li>
</ul>
<h2 id="basic-usage-6"><a class="header" href="#basic-usage-6">Basic Usage</a></h2>
<h3 id="simple-get-request"><a class="header" href="#simple-get-request">Simple GET Request</a></h3>
<pre><code class="language-bash"># Basic GET request
curl https://api.example.com

# GET with output to file
curl https://example.com -o output.html
curl https://example.com --output output.html

# Save with original filename
curl -O https://example.com/file.pdf

# Follow redirects
curl -L https://shortened-url.com
</code></pre>
<h3 id="viewing-response-details"><a class="header" href="#viewing-response-details">Viewing Response Details</a></h3>
<pre><code class="language-bash"># Show response headers only
curl -I https://api.example.com
curl --head https://api.example.com

# Show response headers and body
curl -i https://api.example.com
curl --include https://api.example.com

# Verbose output (shows request/response details)
curl -v https://api.example.com
curl --verbose https://api.example.com

# Show only HTTP status code
curl -o /dev/null -s -w "%{http_code}\n" https://api.example.com
</code></pre>
<h2 id="http-methods"><a class="header" href="#http-methods">HTTP Methods</a></h2>
<h3 id="get-request"><a class="header" href="#get-request">GET Request</a></h3>
<pre><code class="language-bash"># GET with query parameters
curl "https://api.example.com/users?page=1&amp;limit=10"

# GET with URL-encoded parameters
curl -G https://api.example.com/search \
  -d "query=curl tutorial" \
  -d "limit=5"
</code></pre>
<h3 id="post-request"><a class="header" href="#post-request">POST Request</a></h3>
<pre><code class="language-bash"># POST with form data
curl -X POST https://api.example.com/users \
  -d "name=John" \
  -d "email=john@example.com"

# POST with JSON data
curl -X POST https://api.example.com/users \
  -H "Content-Type: application/json" \
  -d '{"name":"John","email":"john@example.com"}'

# POST with JSON from file
curl -X POST https://api.example.com/users \
  -H "Content-Type: application/json" \
  -d @data.json

# POST with form file upload
curl -X POST https://api.example.com/upload \
  -F "file=@document.pdf" \
  -F "description=My document"
</code></pre>
<h3 id="put-request"><a class="header" href="#put-request">PUT Request</a></h3>
<pre><code class="language-bash"># PUT to update resource
curl -X PUT https://api.example.com/users/123 \
  -H "Content-Type: application/json" \
  -d '{"name":"John Updated","email":"john.new@example.com"}'
</code></pre>
<h3 id="patch-request"><a class="header" href="#patch-request">PATCH Request</a></h3>
<pre><code class="language-bash"># PATCH to partially update resource
curl -X PATCH https://api.example.com/users/123 \
  -H "Content-Type: application/json" \
  -d '{"email":"newemail@example.com"}'
</code></pre>
<h3 id="delete-request"><a class="header" href="#delete-request">DELETE Request</a></h3>
<pre><code class="language-bash"># DELETE a resource
curl -X DELETE https://api.example.com/users/123

# DELETE with authentication
curl -X DELETE https://api.example.com/users/123 \
  -H "Authorization: Bearer token123"
</code></pre>
<h2 id="headers"><a class="header" href="#headers">Headers</a></h2>
<h3 id="custom-headers"><a class="header" href="#custom-headers">Custom Headers</a></h3>
<pre><code class="language-bash"># Single custom header
curl -H "X-Custom-Header: value" https://api.example.com

# Multiple headers
curl -H "Content-Type: application/json" \
     -H "Authorization: Bearer token123" \
     -H "X-Request-ID: abc123" \
     https://api.example.com

# User-Agent header
curl -A "MyApp/1.0" https://api.example.com
curl --user-agent "MyApp/1.0" https://api.example.com

# Referer header
curl -e "https://referrer.com" https://api.example.com
curl --referer "https://referrer.com" https://api.example.com
</code></pre>
<h3 id="accept-headers"><a class="header" href="#accept-headers">Accept Headers</a></h3>
<pre><code class="language-bash"># Request JSON response
curl -H "Accept: application/json" https://api.example.com

# Request XML response
curl -H "Accept: application/xml" https://api.example.com

# Request specific API version
curl -H "Accept: application/vnd.api+json; version=2" https://api.example.com
</code></pre>
<h2 id="authentication"><a class="header" href="#authentication">Authentication</a></h2>
<h3 id="basic-authentication"><a class="header" href="#basic-authentication">Basic Authentication</a></h3>
<pre><code class="language-bash"># Basic auth (username:password)
curl -u username:password https://api.example.com

# Basic auth with prompt for password
curl -u username https://api.example.com

# Basic auth in URL (not recommended for production)
curl https://username:password@api.example.com
</code></pre>
<h3 id="bearer-token"><a class="header" href="#bearer-token">Bearer Token</a></h3>
<pre><code class="language-bash"># Bearer token authentication
curl -H "Authorization: Bearer your_token_here" https://api.example.com

# Using environment variable
export TOKEN="your_token_here"
curl -H "Authorization: Bearer $TOKEN" https://api.example.com
</code></pre>
<h3 id="api-key"><a class="header" href="#api-key">API Key</a></h3>
<pre><code class="language-bash"># API key in header
curl -H "X-API-Key: your_api_key" https://api.example.com

# API key in query parameter
curl "https://api.example.com/data?api_key=your_api_key"
</code></pre>
<h3 id="oauth-20-2"><a class="header" href="#oauth-20-2">OAuth 2.0</a></h3>
<pre><code class="language-bash"># OAuth 2.0 with access token
curl -H "Authorization: Bearer access_token" https://api.example.com

# Get OAuth token
curl -X POST https://auth.example.com/token \
  -d "grant_type=client_credentials" \
  -d "client_id=your_client_id" \
  -d "client_secret=your_client_secret"
</code></pre>
<h2 id="cookies"><a class="header" href="#cookies">Cookies</a></h2>
<h3 id="managing-cookies"><a class="header" href="#managing-cookies">Managing Cookies</a></h3>
<pre><code class="language-bash"># Save cookies to file
curl -c cookies.txt https://example.com/login \
  -d "username=user&amp;password=pass"

# Load cookies from file
curl -b cookies.txt https://example.com/profile

# Send cookies directly
curl -b "session=abc123; user=john" https://example.com

# Save and load cookies in same request
curl -b cookies.txt -c cookies.txt https://example.com
</code></pre>
<h2 id="file-operations-3"><a class="header" href="#file-operations-3">File Operations</a></h2>
<h3 id="downloading-files"><a class="header" href="#downloading-files">Downloading Files</a></h3>
<pre><code class="language-bash"># Download single file
curl -O https://example.com/file.zip

# Download with custom name
curl -o myfile.zip https://example.com/file.zip

# Download multiple files
curl -O https://example.com/file1.zip \
     -O https://example.com/file2.zip

# Resume interrupted download
curl -C - -O https://example.com/largefile.zip

# Download with progress bar
curl -# -O https://example.com/file.zip
</code></pre>
<h3 id="uploading-files"><a class="header" href="#uploading-files">Uploading Files</a></h3>
<pre><code class="language-bash"># Upload file with PUT
curl -X PUT https://api.example.com/files/document.pdf \
  --upload-file document.pdf

# Upload with POST multipart
curl -F "file=@document.pdf" https://api.example.com/upload

# Upload multiple files
curl -F "file1=@doc1.pdf" \
     -F "file2=@doc2.pdf" \
     https://api.example.com/upload
</code></pre>
<h3 id="ftp-operations"><a class="header" href="#ftp-operations">FTP Operations</a></h3>
<pre><code class="language-bash"># Download from FTP
curl ftp://ftp.example.com/file.txt -u username:password

# Upload to FTP
curl -T localfile.txt ftp://ftp.example.com/ -u username:password

# List FTP directory
curl ftp://ftp.example.com/ -u username:password
</code></pre>
<h2 id="advanced-options"><a class="header" href="#advanced-options">Advanced Options</a></h2>
<h3 id="timeouts"><a class="header" href="#timeouts">Timeouts</a></h3>
<pre><code class="language-bash"># Connection timeout (seconds)
curl --connect-timeout 10 https://api.example.com

# Maximum time for entire operation
curl --max-time 30 https://api.example.com
curl -m 30 https://api.example.com

# Keepalive time
curl --keepalive-time 60 https://api.example.com
</code></pre>
<h3 id="retry-logic"><a class="header" href="#retry-logic">Retry Logic</a></h3>
<pre><code class="language-bash"># Retry on failure
curl --retry 3 https://api.example.com

# Retry with delay
curl --retry 3 --retry-delay 5 https://api.example.com

# Retry on specific errors
curl --retry 3 --retry-connrefused https://api.example.com
</code></pre>
<h3 id="rate-limiting"><a class="header" href="#rate-limiting">Rate Limiting</a></h3>
<pre><code class="language-bash"># Limit download speed (K = kilobytes, M = megabytes)
curl --limit-rate 100K https://example.com/largefile.zip

# Limit upload speed
curl --limit-rate 50K -T file.zip https://example.com/upload
</code></pre>
<h3 id="proxy"><a class="header" href="#proxy">Proxy</a></h3>
<pre><code class="language-bash"># Use HTTP proxy
curl -x http://proxy.example.com:8080 https://api.example.com

# Use SOCKS5 proxy
curl --socks5 proxy.example.com:1080 https://api.example.com

# Proxy with authentication
curl -x http://user:pass@proxy.example.com:8080 https://api.example.com

# Bypass proxy for specific hosts
curl --noproxy "localhost,127.0.0.1" -x proxy.example.com:8080 https://api.example.com
</code></pre>
<h3 id="ssltls-options"><a class="header" href="#ssltls-options">SSL/TLS Options</a></h3>
<pre><code class="language-bash"># Ignore SSL certificate validation (unsafe - use only for testing)
curl -k https://self-signed.example.com
curl --insecure https://self-signed.example.com

# Specify SSL version
curl --tlsv1.2 https://api.example.com

# Use client certificate
curl --cert client.pem --key key.pem https://api.example.com

# Use CA certificate
curl --cacert ca-bundle.crt https://api.example.com
</code></pre>
<h2 id="response-formatting"><a class="header" href="#response-formatting">Response Formatting</a></h2>
<h3 id="format-output"><a class="header" href="#format-output">Format Output</a></h3>
<pre><code class="language-bash"># Pretty print JSON response (with jq)
curl https://api.example.com/users | jq '.'

# Extract specific field from JSON
curl https://api.example.com/users | jq '.data[].name'

# Silent mode (no progress bar)
curl -s https://api.example.com

# Show only errors
curl -S -s https://api.example.com

# Output format string
curl -w "\nTime: %{time_total}s\nStatus: %{http_code}\n" https://api.example.com
</code></pre>
<h3 id="custom-output-variables"><a class="header" href="#custom-output-variables">Custom Output Variables</a></h3>
<pre><code class="language-bash"># Show timing information
curl -w "
    time_namelookup:  %{time_namelookup}
    time_connect:     %{time_connect}
    time_appconnect:  %{time_appconnect}
    time_pretransfer: %{time_pretransfer}
    time_redirect:    %{time_redirect}
    time_starttransfer: %{time_starttransfer}
    time_total:       %{time_total}
    http_code:        %{http_code}
" -o /dev/null -s https://api.example.com

# Save format to file
curl -w "@curl-format.txt" -o /dev/null -s https://api.example.com
</code></pre>
<h2 id="debugging-4"><a class="header" href="#debugging-4">Debugging</a></h2>
<h3 id="verbose-output"><a class="header" href="#verbose-output">Verbose Output</a></h3>
<pre><code class="language-bash"># Show detailed request/response
curl -v https://api.example.com

# Even more verbose (includes SSL info)
curl -vv https://api.example.com

# Trace ASCII
curl --trace-ascii debug.txt https://api.example.com

# Trace binary
curl --trace debug.bin https://api.example.com
</code></pre>
<h3 id="testing-apis"><a class="header" href="#testing-apis">Testing APIs</a></h3>
<pre><code class="language-bash"># Test API endpoint
curl -I https://api.example.com/health

# Test with timeout
curl -m 5 https://api.example.com

# Check response time
time curl -o /dev/null -s https://api.example.com

# Test with different methods
for method in GET POST PUT DELETE; do
  echo "Testing $method:"
  curl -X $method -I https://api.example.com/test
done
</code></pre>
<h2 id="common-patterns-15"><a class="header" href="#common-patterns-15">Common Patterns</a></h2>
<h3 id="api-testing-script"><a class="header" href="#api-testing-script">API Testing Script</a></h3>
<pre><code class="language-bash">#!/bin/bash
BASE_URL="https://api.example.com"
TOKEN="your_token_here"

# GET request
curl -H "Authorization: Bearer $TOKEN" "$BASE_URL/users"

# POST request
curl -X POST "$BASE_URL/users" \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"name":"John","email":"john@example.com"}'

# Check status
STATUS=$(curl -o /dev/null -s -w "%{http_code}" "$BASE_URL/health")
if [ "$STATUS" -eq 200 ]; then
  echo "API is healthy"
else
  echo "API returned status $STATUS"
fi
</code></pre>
<h3 id="download-with-progress"><a class="header" href="#download-with-progress">Download with Progress</a></h3>
<pre><code class="language-bash"># Download with progress bar
curl -# -L -o file.zip https://example.com/download

# Download with custom progress
curl --progress-bar -o file.zip https://example.com/download
</code></pre>
<h3 id="rest-api-crud-operations"><a class="header" href="#rest-api-crud-operations">REST API CRUD Operations</a></h3>
<pre><code class="language-bash"># Create
curl -X POST https://api.example.com/items \
  -H "Content-Type: application/json" \
  -d '{"name":"Item1","price":99.99}'

# Read
curl https://api.example.com/items/1

# Update
curl -X PUT https://api.example.com/items/1 \
  -H "Content-Type: application/json" \
  -d '{"name":"Item1 Updated","price":89.99}'

# Delete
curl -X DELETE https://api.example.com/items/1
</code></pre>
<h2 id="configuration-file-1"><a class="header" href="#configuration-file-1">Configuration File</a></h2>
<p>Create <code>~/.curlrc</code> for default options:</p>
<pre><code class="language-bash"># Always follow redirects
-L

# Show error messages
--show-error

# Retry on failure
--retry 3

# Set user agent
user-agent = "MyApp/1.0"

# Always use HTTP/2 if available
--http2
</code></pre>
<h2 id="best-practices-48"><a class="header" href="#best-practices-48">Best Practices</a></h2>
<ol>
<li>
<p><strong>Use verbose mode for debugging</strong></p>
<pre><code class="language-bash">curl -v https://api.example.com
</code></pre>
</li>
<li>
<p><strong>Always handle errors in scripts</strong></p>
<pre><code class="language-bash">if ! curl -f https://api.example.com; then
  echo "Request failed"
  exit 1
fi
</code></pre>
</li>
<li>
<p><strong>Use environment variables for sensitive data</strong></p>
<pre><code class="language-bash">export API_TOKEN="secret"
curl -H "Authorization: Bearer $API_TOKEN" https://api.example.com
</code></pre>
</li>
<li>
<p><strong>Set appropriate timeouts</strong></p>
<pre><code class="language-bash">curl --connect-timeout 10 --max-time 60 https://api.example.com
</code></pre>
</li>
<li>
<p><strong>Save and reuse cookies for session management</strong></p>
<pre><code class="language-bash">curl -c cookies.txt -d "user=john&amp;pass=secret" https://example.com/login
curl -b cookies.txt https://example.com/profile
</code></pre>
</li>
</ol>
<h2 id="common-use-cases-3"><a class="header" href="#common-use-cases-3">Common Use Cases</a></h2>
<h3 id="health-check-monitoring"><a class="header" href="#health-check-monitoring">Health Check Monitoring</a></h3>
<pre><code class="language-bash">#!/bin/bash
# Check if service is up
while true; do
  STATUS=$(curl -o /dev/null -s -w "%{http_code}" https://api.example.com/health)
  if [ "$STATUS" -eq 200 ]; then
    echo "$(date): Service is up"
  else
    echo "$(date): Service returned $STATUS"
  fi
  sleep 60
done
</code></pre>
<h3 id="api-load-testing"><a class="header" href="#api-load-testing">API Load Testing</a></h3>
<pre><code class="language-bash"># Simple load test
for i in {1..100}; do
  curl -o /dev/null -s -w "%{time_total}\n" https://api.example.com &amp;
done
wait
</code></pre>
<h3 id="web-scraping"><a class="header" href="#web-scraping">Web Scraping</a></h3>
<pre><code class="language-bash"># Download webpage and extract links
curl -s https://example.com | grep -oP 'href="\K[^"]*'
</code></pre>
<h3 id="testing-webhooks"><a class="header" href="#testing-webhooks">Testing Webhooks</a></h3>
<pre><code class="language-bash"># Send webhook payload
curl -X POST https://webhook.site/unique-url \
  -H "Content-Type: application/json" \
  -d '{"event":"user.created","data":{"id":123,"name":"John"}}'
</code></pre>
<h2 id="useful-aliases-3"><a class="header" href="#useful-aliases-3">Useful Aliases</a></h2>
<pre><code class="language-bash"># Add to ~/.bashrc or ~/.zshrc
alias curljson='curl -H "Content-Type: application/json"'
alias curlpost='curl -X POST -H "Content-Type: application/json"'
alias curltime='curl -w "\nTotal time: %{time_total}s\n"'
alias curlstatus='curl -o /dev/null -s -w "%{http_code}\n"'
</code></pre>
<h2 id="common-options-reference"><a class="header" href="#common-options-reference">Common Options Reference</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Option</th><th>Description</th></tr></thead><tbody>
<tr><td><code>-X, --request</code></td><td>HTTP method (GET, POST, etc.)</td></tr>
<tr><td><code>-H, --header</code></td><td>Custom header</td></tr>
<tr><td><code>-d, --data</code></td><td>POST data</td></tr>
<tr><td><code>-F, --form</code></td><td>Multipart form data</td></tr>
<tr><td><code>-o, --output</code></td><td>Write to file</td></tr>
<tr><td><code>-O, --remote-name</code></td><td>Save with remote name</td></tr>
<tr><td><code>-L, --location</code></td><td>Follow redirects</td></tr>
<tr><td><code>-i, --include</code></td><td>Include headers in output</td></tr>
<tr><td><code>-I, --head</code></td><td>Fetch headers only</td></tr>
<tr><td><code>-v, --verbose</code></td><td>Verbose output</td></tr>
<tr><td><code>-s, --silent</code></td><td>Silent mode</td></tr>
<tr><td><code>-u, --user</code></td><td>Username:password</td></tr>
<tr><td><code>-b, --cookie</code></td><td>Cookie string or file</td></tr>
<tr><td><code>-c, --cookie-jar</code></td><td>Save cookies to file</td></tr>
<tr><td><code>-A, --user-agent</code></td><td>User-Agent string</td></tr>
<tr><td><code>-e, --referer</code></td><td>Referer URL</td></tr>
<tr><td><code>-k, --insecure</code></td><td>Ignore SSL errors</td></tr>
<tr><td><code>-x, --proxy</code></td><td>Use proxy</td></tr>
<tr><td><code>-m, --max-time</code></td><td>Maximum time in seconds</td></tr>
<tr><td><code>--retry</code></td><td>Number of retries</td></tr>
</tbody></table>
</div>
<h2 id="troubleshooting-8"><a class="header" href="#troubleshooting-8">Troubleshooting</a></h2>
<h3 id="common-errors"><a class="header" href="#common-errors">Common Errors</a></h3>
<pre><code class="language-bash"># SSL certificate problem
curl --cacert /path/to/ca-bundle.crt https://example.com

# Connection timeout
curl --connect-timeout 30 https://example.com

# DNS resolution issues
curl --dns-servers 8.8.8.8 https://example.com

# Test specific IP
curl --resolve example.com:443:1.2.3.4 https://example.com
</code></pre>
<h3 id="debug-ssl-issues"><a class="header" href="#debug-ssl-issues">Debug SSL Issues</a></h3>
<pre><code class="language-bash"># Show SSL certificate details
curl -vv https://example.com 2&gt;&amp;1 | grep -A 10 "SSL certificate"

# Test SSL handshake
openssl s_client -connect example.com:443

# Use specific TLS version
curl --tlsv1.2 https://example.com
</code></pre>
<p>curl is an incredibly powerful tool for working with APIs, testing endpoints, and automating HTTP requests. Master these patterns and you'll be able to handle almost any HTTP-related task from the command line.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="wget"><a class="header" href="#wget">wget</a></h1>
<p>wget is a free command-line utility for non-interactive downloading of files from the web. It supports HTTP, HTTPS, and FTP protocols, and can work through proxies, resume downloads, and handle various network conditions.</p>
<h2 id="overview-56"><a class="header" href="#overview-56">Overview</a></h2>
<p>wget is designed for robustness over slow or unstable network connections. If a download fails, it will keep retrying until the whole file has been retrieved. It's ideal for downloading files in scripts and automated tasks.</p>
<p><strong>Key Features:</strong></p>
<ul>
<li>Non-interactive operation (works in background)</li>
<li>Resume interrupted downloads</li>
<li>Recursive downloads (entire websites)</li>
<li>Multiple protocol support (HTTP, HTTPS, FTP)</li>
<li>Proxy support</li>
<li>Timestamping and mirroring</li>
<li>Convert links for offline viewing</li>
<li>Bandwidth limiting</li>
</ul>
<h2 id="installation-10"><a class="header" href="#installation-10">Installation</a></h2>
<pre><code class="language-bash"># Ubuntu/Debian
sudo apt update
sudo apt install wget

# macOS
brew install wget

# CentOS/RHEL
sudo yum install wget

# Arch Linux
sudo pacman -S wget

# Verify installation
wget --version
</code></pre>
<h2 id="basic-usage-7"><a class="header" href="#basic-usage-7">Basic Usage</a></h2>
<h3 id="simple-downloads"><a class="header" href="#simple-downloads">Simple Downloads</a></h3>
<pre><code class="language-bash"># Download a file
wget https://example.com/file.zip

# Download and save with different name
wget -O myfile.zip https://example.com/file.zip
wget --output-document=myfile.zip https://example.com/file.zip

# Download to specific directory
wget -P /path/to/directory https://example.com/file.zip
wget --directory-prefix=/path/to/directory https://example.com/file.zip

# Download in background
wget -b https://example.com/largefile.zip
wget --background https://example.com/largefile.zip

# Continue interrupted download
wget -c https://example.com/largefile.zip
wget --continue https://example.com/largefile.zip
</code></pre>
<h3 id="multiple-files"><a class="header" href="#multiple-files">Multiple Files</a></h3>
<pre><code class="language-bash"># Download multiple files
wget https://example.com/file1.zip https://example.com/file2.zip

# Download from file list
cat urls.txt
# https://example.com/file1.zip
# https://example.com/file2.zip
# https://example.com/file3.zip

wget -i urls.txt
wget --input-file=urls.txt

# Download from URLs with wildcards
wget https://example.com/file{1..10}.zip
</code></pre>
<h3 id="download-options"><a class="header" href="#download-options">Download Options</a></h3>
<pre><code class="language-bash"># Limit download speed (K, M, G)
wget --limit-rate=200k https://example.com/file.zip
wget --limit-rate=1M https://example.com/file.zip

# Set number of retries
wget --tries=10 https://example.com/file.zip
wget -t 10 https://example.com/file.zip

# Infinite retries
wget --tries=0 https://example.com/file.zip

# Timeout settings
wget --timeout=30 https://example.com/file.zip
wget --dns-timeout=10 --connect-timeout=10 --read-timeout=30 https://example.com/file.zip

# Wait between downloads
wget --wait=5 -i urls.txt  # Wait 5 seconds
wget --random-wait -i urls.txt  # Random wait 0.5-1.5x wait time
</code></pre>
<h2 id="recursive-downloads"><a class="header" href="#recursive-downloads">Recursive Downloads</a></h2>
<h3 id="mirror-websites"><a class="header" href="#mirror-websites">Mirror Websites</a></h3>
<pre><code class="language-bash"># Mirror entire website
wget --mirror --convert-links --page-requisites --no-parent https://example.com

# Shorter version
wget -mkEpnp https://example.com

# Flags explained:
# -m, --mirror: mirror (recursive + timestamping + infinite depth)
# -k, --convert-links: convert links for offline viewing
# -E, --adjust-extension: save HTML with .html extension
# -p, --page-requisites: get all images, CSS, etc.
# -np, --no-parent: don't ascend to parent directory

# Limit recursion depth
wget -r -l 2 https://example.com  # 2 levels deep
wget --recursive --level=2 https://example.com

# Download specific file types only
wget -r -A pdf,jpg,png https://example.com
wget --recursive --accept=pdf,jpg,png https://example.com

# Exclude specific file types
wget -r -R gif,svg https://example.com
wget --recursive --reject=gif,svg https://example.com
</code></pre>
<h3 id="download-directories"><a class="header" href="#download-directories">Download Directories</a></h3>
<pre><code class="language-bash"># Download entire directory
wget -r -np -nH --cut-dirs=2 https://example.com/files/documents/

# Flags explained:
# -r: recursive
# -np: no parent (stay in directory)
# -nH: no host directory
# --cut-dirs=2: skip 2 directory levels

# Example:
# URL: https://example.com/files/documents/pdf/file.pdf
# Without flags: example.com/files/documents/pdf/file.pdf
# With flags: pdf/file.pdf
</code></pre>
<h2 id="authentication-1"><a class="header" href="#authentication-1">Authentication</a></h2>
<h3 id="http-authentication"><a class="header" href="#http-authentication">HTTP Authentication</a></h3>
<pre><code class="language-bash"># Basic authentication
wget --user=username --password=password https://example.com/file.zip

# Prompt for password
wget --user=username --ask-password https://example.com/file.zip

# HTTP authentication via .wgetrc
cat &lt;&lt; EOF &gt; ~/.wgetrc
http_user = username
http_password = password
EOF
</code></pre>
<h3 id="ftp-authentication"><a class="header" href="#ftp-authentication">FTP Authentication</a></h3>
<pre><code class="language-bash"># FTP download with credentials
wget ftp://username:password@ftp.example.com/file.zip

# Anonymous FTP
wget ftp://ftp.example.com/file.zip
</code></pre>
<h3 id="cookies-1"><a class="header" href="#cookies-1">Cookies</a></h3>
<pre><code class="language-bash"># Send cookies
wget --header="Cookie: session=abc123" https://example.com/file.zip

# Load cookies from file
wget --load-cookies=cookies.txt https://example.com/file.zip

# Save cookies to file
wget --save-cookies=cookies.txt --keep-session-cookies https://example.com/login

# Use cookies for authenticated download
wget --save-cookies=cookies.txt --keep-session-cookies \
     --post-data='user=john&amp;pass=secret' \
     https://example.com/login
wget --load-cookies=cookies.txt https://example.com/protected/file.zip
</code></pre>
<h2 id="headers-and-user-agent"><a class="header" href="#headers-and-user-agent">Headers and User Agent</a></h2>
<h3 id="custom-headers-1"><a class="header" href="#custom-headers-1">Custom Headers</a></h3>
<pre><code class="language-bash"># Set user agent
wget --user-agent="Mozilla/5.0" https://example.com/file.zip
wget -U "Mozilla/5.0" https://example.com/file.zip

# Custom headers
wget --header="Accept: application/json" https://api.example.com/data
wget --header="Authorization: Bearer token123" https://api.example.com/file.zip

# Multiple headers
wget --header="Accept: application/json" \
     --header="X-API-Key: abc123" \
     https://api.example.com/data

# Referer header
wget --referer=https://example.com https://example.com/file.zip
</code></pre>
<h3 id="post-requests"><a class="header" href="#post-requests">POST Requests</a></h3>
<pre><code class="language-bash"># POST data
wget --post-data='name=John&amp;email=john@example.com' https://example.com/api

# POST from file
wget --post-file=data.json https://example.com/api

# POST with headers
wget --post-data='{"name":"John"}' \
     --header="Content-Type: application/json" \
     https://example.com/api
</code></pre>
<h2 id="ssltls-options-1"><a class="header" href="#ssltls-options-1">SSL/TLS Options</a></h2>
<pre><code class="language-bash"># Ignore SSL certificate check (unsafe)
wget --no-check-certificate https://self-signed.example.com/file.zip

# Specify CA certificate
wget --ca-certificate=/path/to/ca-cert.pem https://example.com/file.zip

# Use client certificate
wget --certificate=/path/to/client-cert.pem \
     --certificate-type=PEM \
     https://example.com/file.zip

# Use private key
wget --private-key=/path/to/key.pem https://example.com/file.zip

# Specify SSL protocol
wget --secure-protocol=TLSv1_2 https://example.com/file.zip
</code></pre>
<h2 id="proxy-support"><a class="header" href="#proxy-support">Proxy Support</a></h2>
<pre><code class="language-bash"># Use HTTP proxy
wget -e use_proxy=yes -e http_proxy=http://proxy.example.com:8080 https://example.com/file.zip

# Use proxy with authentication
wget -e use_proxy=yes \
     -e http_proxy=http://user:pass@proxy.example.com:8080 \
     https://example.com/file.zip

# HTTPS proxy
wget -e https_proxy=http://proxy.example.com:8080 https://example.com/file.zip

# FTP proxy
wget -e ftp_proxy=http://proxy.example.com:8080 ftp://ftp.example.com/file.zip

# No proxy for specific domains
wget -e no_proxy=localhost,127.0.0.1 https://example.com/file.zip

# Configure in .wgetrc
cat &lt;&lt; EOF &gt; ~/.wgetrc
use_proxy = on
http_proxy = http://proxy.example.com:8080
https_proxy = http://proxy.example.com:8080
ftp_proxy = http://proxy.example.com:8080
no_proxy = localhost,127.0.0.1
EOF
</code></pre>
<h2 id="output-control"><a class="header" href="#output-control">Output Control</a></h2>
<h3 id="verbosity"><a class="header" href="#verbosity">Verbosity</a></h3>
<pre><code class="language-bash"># Quiet mode (no output)
wget -q https://example.com/file.zip
wget --quiet https://example.com/file.zip

# Verbose output
wget -v https://example.com/file.zip
wget --verbose https://example.com/file.zip

# Debug output
wget -d https://example.com/file.zip
wget --debug https://example.com/file.zip

# Show progress bar only
wget --progress=bar https://example.com/file.zip
wget --progress=dot https://example.com/file.zip

# No verbose but show errors
wget -nv https://example.com/file.zip
wget --no-verbose https://example.com/file.zip
</code></pre>
<h3 id="logging-1"><a class="header" href="#logging-1">Logging</a></h3>
<pre><code class="language-bash"># Log to file
wget -o download.log https://example.com/file.zip
wget --output-file=download.log https://example.com/file.zip

# Append to log
wget -a download.log https://example.com/file.zip
wget --append-output=download.log https://example.com/file.zip

# Background download with logging
wget -b -o wget.log https://example.com/largefile.zip
</code></pre>
<h2 id="advanced-features-4"><a class="header" href="#advanced-features-4">Advanced Features</a></h2>
<h3 id="timestamping"><a class="header" href="#timestamping">Timestamping</a></h3>
<pre><code class="language-bash"># Only download if newer than local file
wget -N https://example.com/file.zip
wget --timestamping https://example.com/file.zip

# Check if file has been modified
wget --spider --server-response https://example.com/file.zip
</code></pre>
<h3 id="spider-mode"><a class="header" href="#spider-mode">Spider Mode</a></h3>
<pre><code class="language-bash"># Check if file exists without downloading
wget --spider https://example.com/file.zip

# Check if URL is valid
if wget --spider https://example.com/file.zip 2&gt;&amp;1 | grep -q '200 OK'; then
    echo "URL is valid"
else
    echo "URL is invalid"
fi

# Get response headers only
wget --spider --server-response https://example.com/file.zip
</code></pre>
<h3 id="quota-and-limits"><a class="header" href="#quota-and-limits">Quota and Limits</a></h3>
<pre><code class="language-bash"># Limit total download size
wget --quota=100M -i urls.txt

# Reject files larger than size
wget --reject-size=10M https://example.com/

# Accept files within size range
wget --accept-size=1M-10M https://example.com/
</code></pre>
<h3 id="filtering"><a class="header" href="#filtering">Filtering</a></h3>
<pre><code class="language-bash"># Include only specific directories
wget -r -I /docs,/guides https://example.com

# Exclude specific directories
wget -r -X /private,/admin https://example.com

# Include only specific domains
wget -r -D example.com,cdn.example.com https://example.com

# Follow only relative links
wget -r --relative https://example.com
</code></pre>
<h2 id="configuration-file-2"><a class="header" href="#configuration-file-2">Configuration File</a></h2>
<h3 id="wgetrc"><a class="header" href="#wgetrc">.wgetrc</a></h3>
<pre><code class="language-bash"># Create ~/.wgetrc
cat &lt;&lt; 'EOF' &gt; ~/.wgetrc
# Retry settings
tries = 10
retry_connrefused = on

# Timeout settings
timeout = 30
dns_timeout = 10
connect_timeout = 10
read_timeout = 30

# Wait between downloads
wait = 2
random_wait = on

# Download settings
continue = on
timestamping = on

# User agent
user_agent = Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36

# Proxy settings
# use_proxy = on
# http_proxy = http://proxy.example.com:8080
# https_proxy = http://proxy.example.com:8080

# Directories
dir_prefix = ~/Downloads/

# Output
verbose = off
quiet = off
EOF
</code></pre>
<h2 id="common-use-cases-4"><a class="header" href="#common-use-cases-4">Common Use Cases</a></h2>
<h3 id="download-large-files"><a class="header" href="#download-large-files">Download Large Files</a></h3>
<pre><code class="language-bash"># Download with resume support
wget -c -t 0 --timeout=120 https://example.com/largefile.iso

# Download in background with logging
wget -b -c -o download.log https://example.com/largefile.iso

# Monitor background download
tail -f download.log
</code></pre>
<h3 id="backup-website"><a class="header" href="#backup-website">Backup Website</a></h3>
<pre><code class="language-bash">#!/bin/bash
# backup-website.sh

SITE="https://example.com"
BACKUP_DIR="/backup/website"
DATE=$(date +%Y%m%d)

mkdir -p "$BACKUP_DIR/$DATE"
cd "$BACKUP_DIR/$DATE"

wget --mirror \
     --convert-links \
     --adjust-extension \
     --page-requisites \
     --no-parent \
     --no-clobber \
     --wait=1 \
     --random-wait \
     "$SITE"

echo "Backup completed: $BACKUP_DIR/$DATE"
</code></pre>
<h3 id="download-all-pdfs-from-site"><a class="header" href="#download-all-pdfs-from-site">Download All PDFs from Site</a></h3>
<pre><code class="language-bash"># Download all PDFs
wget -r -A pdf https://example.com

# Download PDFs from specific directory
wget -r -np -nd -A pdf https://example.com/documents/

# Download PDFs with original structure
wget -r -np -A pdf https://example.com/documents/
</code></pre>
<h3 id="api-file-downloads"><a class="header" href="#api-file-downloads">API File Downloads</a></h3>
<pre><code class="language-bash"># Download with authentication token
wget --header="Authorization: Bearer $API_TOKEN" \
     https://api.example.com/files/report.pdf

# Download with API key
wget --header="X-API-Key: $API_KEY" \
     https://api.example.com/download/file.zip
</code></pre>
<h3 id="batch-downloads"><a class="header" href="#batch-downloads">Batch Downloads</a></h3>
<pre><code class="language-bash"># Create URL list
for i in {1..100}; do
    echo "https://example.com/images/img${i}.jpg"
done &gt; urls.txt

# Download with rate limiting
wget -i urls.txt --wait=1 --random-wait --limit-rate=500k

# Download with progress tracking
wget -i urls.txt -o download.log &amp;
tail -f download.log | grep -E "saved|failed"
</code></pre>
<h2 id="scripting-examples"><a class="header" href="#scripting-examples">Scripting Examples</a></h2>
<h3 id="download-with-retry-logic"><a class="header" href="#download-with-retry-logic">Download with Retry Logic</a></h3>
<pre><code class="language-bash">#!/bin/bash
URL="https://example.com/file.zip"
OUTPUT="file.zip"
MAX_ATTEMPTS=5

for i in $(seq 1 $MAX_ATTEMPTS); do
    echo "Attempt $i of $MAX_ATTEMPTS"

    if wget -c -O "$OUTPUT" "$URL"; then
        echo "Download successful"
        exit 0
    else
        echo "Download failed, retrying..."
        sleep 5
    fi
done

echo "Download failed after $MAX_ATTEMPTS attempts"
exit 1
</code></pre>
<h3 id="parallel-downloads"><a class="header" href="#parallel-downloads">Parallel Downloads</a></h3>
<pre><code class="language-bash">#!/bin/bash
# Download multiple files in parallel

URLS=(
    "https://example.com/file1.zip"
    "https://example.com/file2.zip"
    "https://example.com/file3.zip"
)

for url in "${URLS[@]}"; do
    wget -c "$url" &amp;
done

# Wait for all downloads to complete
wait

echo "All downloads completed"
</code></pre>
<h3 id="monitor-website-changes"><a class="header" href="#monitor-website-changes">Monitor Website Changes</a></h3>
<pre><code class="language-bash">#!/bin/bash
# Check if website has been updated

URL="https://example.com/news.html"
OUTPUT="/tmp/news.html"

if [ -f "$OUTPUT" ]; then
    wget -N -o /tmp/wget.log "$URL"

    if grep -q "not retrieving" /tmp/wget.log; then
        echo "No changes detected"
    else
        echo "Website has been updated"
        # Send notification or perform action
    fi
else
    wget -O "$OUTPUT" "$URL"
    echo "Initial download completed"
fi
</code></pre>
<h2 id="best-practices-49"><a class="header" href="#best-practices-49">Best Practices</a></h2>
<ol>
<li><strong>Always use resume support</strong> for large files: <code>wget -c</code></li>
<li><strong>Be respectful</strong> with recursive downloads: use <code>--wait</code> and <code>--random-wait</code></li>
<li><strong>Set appropriate timeout</strong> values for unreliable connections</li>
<li><strong>Use timestamping</strong> to avoid re-downloading unchanged files: <code>wget -N</code></li>
<li><strong>Log downloads</strong> for troubleshooting: <code>wget -o logfile</code></li>
<li><strong>Limit bandwidth</strong> if needed: <code>--limit-rate</code></li>
<li><strong>Use .wgetrc</strong> for common settings</li>
<li><strong>Check robots.txt</strong>: <code>wget --execute robots=off</code> to override (use responsibly)</li>
</ol>
<h2 id="troubleshooting-9"><a class="header" href="#troubleshooting-9">Troubleshooting</a></h2>
<h3 id="common-issues-11"><a class="header" href="#common-issues-11">Common Issues</a></h3>
<pre><code class="language-bash"># SSL certificate verification failed
wget --no-check-certificate https://example.com/file.zip
# Better: Install proper CA certificates

# Connection timeout
wget --timeout=60 --tries=5 https://example.com/file.zip

# 403 Forbidden error
wget --user-agent="Mozilla/5.0" https://example.com/file.zip

# Cannot write to file (permission denied)
sudo wget -P /protected/directory https://example.com/file.zip

# Resume failed download
wget -c https://example.com/file.zip

# Check download status in background
tail -f wget-log

# Verify download integrity
wget https://example.com/file.zip
wget https://example.com/file.zip.sha256
sha256sum -c file.zip.sha256
</code></pre>
<h3 id="debug-issues"><a class="header" href="#debug-issues">Debug Issues</a></h3>
<pre><code class="language-bash"># Enable debug output
wget -d https://example.com/file.zip 2&gt;&amp;1 | tee debug.log

# Check DNS resolution
wget --dns-timeout=10 https://example.com/file.zip

# Test connection only
wget --spider --server-response https://example.com/file.zip

# Show headers
wget -S https://example.com/file.zip
</code></pre>
<h2 id="quick-reference-11"><a class="header" href="#quick-reference-11">Quick Reference</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Option</th><th>Description</th></tr></thead><tbody>
<tr><td><code>-O file</code></td><td>Save as file</td></tr>
<tr><td><code>-P dir</code></td><td>Save to directory</td></tr>
<tr><td><code>-c</code></td><td>Continue/resume download</td></tr>
<tr><td><code>-b</code></td><td>Background download</td></tr>
<tr><td><code>-i file</code></td><td>Download URLs from file</td></tr>
<tr><td><code>-r</code></td><td>Recursive download</td></tr>
<tr><td><code>-l N</code></td><td>Recursion depth</td></tr>
<tr><td><code>-A list</code></td><td>Accept file types</td></tr>
<tr><td><code>-R list</code></td><td>Reject file types</td></tr>
<tr><td><code>-np</code></td><td>No parent directory</td></tr>
<tr><td><code>-m</code></td><td>Mirror website</td></tr>
<tr><td><code>-k</code></td><td>Convert links</td></tr>
<tr><td><code>-p</code></td><td>Page requisites</td></tr>
<tr><td><code>-q</code></td><td>Quiet mode</td></tr>
<tr><td><code>-v</code></td><td>Verbose mode</td></tr>
<tr><td><code>-N</code></td><td>Timestamping</td></tr>
<tr><td><code>--limit-rate=N</code></td><td>Limit speed</td></tr>
<tr><td><code>--tries=N</code></td><td>Number of retries</td></tr>
<tr><td><code>--timeout=N</code></td><td>Timeout seconds</td></tr>
</tbody></table>
</div>
<p>wget is a versatile tool for reliable file downloads, website mirroring, and automated download tasks, essential for system administrators and developers.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="grep-1"><a class="header" href="#grep-1">grep</a></h1>
<p>grep is a command-line utility for searching for text in files. It is a powerful tool that can be used to search for text in files, directories, and more.</p>
<h2 id="commonly-used-grep-commands"><a class="header" href="#commonly-used-grep-commands">Commonly Used <code>grep</code> Commands</a></h2>
<ol>
<li>
<p><strong>Search for a specific string in a file:</strong></p>
<pre><code class="language-bash">grep "search_string" filename
</code></pre>
</li>
<li>
<p><strong>Search for a string in multiple files:</strong></p>
<pre><code class="language-bash">grep "search_string" file1 file2 file3
</code></pre>
</li>
<li>
<p><strong>Search recursively in directories:</strong></p>
<pre><code class="language-bash">grep -r "search_string" /path/to/directory
</code></pre>
</li>
<li>
<p><strong>Search for a string ignoring case:</strong></p>
<pre><code class="language-bash">grep -i "search_string" filename
</code></pre>
</li>
<li>
<p><strong>Search for a whole word:</strong></p>
<pre><code class="language-bash">grep -w "word" filename
</code></pre>
</li>
<li>
<p><strong>Search for a string and display line numbers:</strong></p>
<pre><code class="language-bash">grep -n "search_string" filename
</code></pre>
</li>
<li>
<p><strong>Search for a string and display count of matching lines:</strong></p>
<pre><code class="language-bash">grep -c "search_string" filename
</code></pre>
</li>
<li>
<p><strong>Search for a string and display only matching part:</strong></p>
<pre><code class="language-bash">grep -o "search_string" filename
</code></pre>
</li>
<li>
<p><strong>Search for lines that do not match the string:</strong></p>
<pre><code class="language-bash">grep -v "search_string" filename
</code></pre>
</li>
<li>
<p><strong>Search for multiple patterns:</strong></p>
<pre><code class="language-bash">grep -e "pattern1" -e "pattern2" filename
</code></pre>
</li>
<li>
<p><strong>Search for a string in compressed files:</strong></p>
<pre><code class="language-bash">zgrep "search_string" compressed_file.gz
</code></pre>
</li>
<li>
<p><strong>Search for a string and display context lines:</strong></p>
<pre><code class="language-bash">grep -C 3 "search_string" filename
</code></pre>
</li>
</ol>
<p>These commands cover a variety of common use cases for the <code>grep</code> command, making it a versatile tool for text searching and manipulation.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="find"><a class="header" href="#find">find</a></h1>
<p>find is a command-line utility for searching for files in directories. It is a powerful tool that can be used to search for files in directories, subdirectories, and more.</p>
<h2 id="commonly-used-find-commands"><a class="header" href="#commonly-used-find-commands">Commonly Used <code>find</code> Commands</a></h2>
<ol>
<li>
<p><strong>Find files by name:</strong></p>
<pre><code class="language-bash">find /path/to/directory -name "filename"
find . -name "*.py"
</code></pre>
</li>
<li>
<p><strong>Find files by extension:</strong></p>
<pre><code class="language-bash">find /path/to/directory -name "*.ext"
</code></pre>
</li>
<li>
<p><strong>Find files by type (e.g., directories):</strong></p>
<pre><code class="language-bash">find /path/to/directory -type d
</code></pre>
</li>
<li>
<p><strong>Find files by size (e.g., files larger than 100MB):</strong></p>
<pre><code class="language-bash">find /path/to/directory -size +100M
</code></pre>
</li>
<li>
<p><strong>Find files modified in the last 7 days:</strong></p>
<pre><code class="language-bash">find /path/to/directory -mtime -7
</code></pre>
</li>
<li>
<p><strong>Find files accessed in the last 7 days:</strong></p>
<pre><code class="language-bash">find /path/to/directory -atime -7
</code></pre>
</li>
<li>
<p><strong>Find files and execute a command on them (e.g., delete):</strong></p>
<pre><code class="language-bash">find /path/to/directory -name "*.tmp" -exec rm {} \;
</code></pre>
</li>
<li>
<p><strong>Find files by permissions (e.g., files with 777 permissions):</strong></p>
<pre><code class="language-bash">find /path/to/directory -perm 777
</code></pre>
</li>
<li>
<p><strong>Find empty files and directories:</strong></p>
<pre><code class="language-bash">find /path/to/directory -empty
</code></pre>
</li>
<li>
<p><strong>Find files by user:</strong></p>
<pre><code class="language-bash">find /path/to/directory -user username
</code></pre>
</li>
<li>
<p><strong>Find files by group:</strong></p>
<pre><code class="language-bash">find /path/to/directory -group groupname
</code></pre>
</li>
<li>
<p><strong>Find files excluding a specific path:</strong></p>
<pre><code class="language-bash">find /path/to/directory -path /exclude/path -prune -o -name "*.ext" -print
</code></pre>
</li>
</ol>
<p>These commands cover a variety of common use cases for the <code>find</code> command, making it a versatile tool for file searching and manipulation.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ffmpeg"><a class="header" href="#ffmpeg">ffmpeg</a></h1>
<p>ffmpeg is a powerful tool for processing video and audio files. It is a powerful tool that can be used to convert video and audio files, create video and audio files, and more.</p>
<h2 id="convert-video-to-mp4"><a class="header" href="#convert-video-to-mp4">Convert video to mp4</a></h2>
<pre><code class="language-bash">ffmpeg -i input.mp4 -c:v h264 -c:a aac output.mp4
</code></pre>
<h2 id="hls"><a class="header" href="#hls">HLS</a></h2>
<pre><code class="language-bash">ffmpeg -i input.mp4 -hls_time 10 -hls_list_size 0 -f hls output.m3u8
</code></pre>
<h2 id="screenshot"><a class="header" href="#screenshot">Screenshot</a></h2>
<pre><code class="language-bash">ffmpeg -i input.mp4 -vf "select=eq(n\,0)" -q:v 1 -f image2 output.png
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="make"><a class="header" href="#make">make</a></h1>
<p>make is a build automation tool that automatically builds executable programs and libraries from source code by reading files called Makefiles which specify how to derive the target program.</p>
<h2 id="overview-57"><a class="header" href="#overview-57">Overview</a></h2>
<p>make uses Makefiles to determine which parts of a program need to be recompiled and issues commands to rebuild them. It's particularly useful for managing dependencies in large projects.</p>
<p><strong>Key Concepts:</strong></p>
<ul>
<li><strong>Target</strong>: The file to be created or action to be performed</li>
<li><strong>Prerequisites</strong>: Files that must exist before target can be built</li>
<li><strong>Recipe</strong>: Commands to create the target from prerequisites</li>
<li><strong>Rule</strong>: Combination of target, prerequisites, and recipe</li>
<li><strong>Phony Target</strong>: Target that doesn't represent a file</li>
</ul>
<h2 id="basic-makefile"><a class="header" href="#basic-makefile">Basic Makefile</a></h2>
<h3 id="simple-example"><a class="header" href="#simple-example">Simple Example</a></h3>
<pre><code class="language-makefile"># Basic Makefile structure
target: prerequisites
	recipe

# Example: Compile a C program
program: main.c
	gcc -o program main.c

# Clean up build artifacts
clean:
	rm -f program
</code></pre>
<h3 id="running-make"><a class="header" href="#running-make">Running make</a></h3>
<pre><code class="language-bash"># Build default target (first target in Makefile)
make

# Build specific target
make clean

# Build multiple targets
make program test

# Show commands without executing
make -n

# Run with specific Makefile
make -f MyMakefile
</code></pre>
<h2 id="makefile-syntax"><a class="header" href="#makefile-syntax">Makefile Syntax</a></h2>
<h3 id="basic-structure-2"><a class="header" href="#basic-structure-2">Basic Structure</a></h3>
<pre><code class="language-makefile"># Comments start with #

# Variable definition
CC = gcc
CFLAGS = -Wall -O2

# Rule with target, prerequisites, and recipe
program: main.o utils.o
	$(CC) -o program main.o utils.o

# Multiple recipes (each on new line, indented with TAB)
main.o: main.c
	@echo "Compiling main.c"
	$(CC) $(CFLAGS) -c main.c

# Target with no prerequisites
clean:
	rm -f *.o program
</code></pre>
<p><strong>Important:</strong> Recipes must be indented with a TAB character, not spaces.</p>
<h3 id="variables-2"><a class="header" href="#variables-2">Variables</a></h3>
<pre><code class="language-makefile"># Simple variable assignment
CC = gcc
CXX = g++
CFLAGS = -Wall -Wextra -O2

# Recursive expansion (evaluated when used)
SRCS = $(wildcard *.c)
OBJS = $(SRCS:.c=.o)

# Simple expansion (evaluated immediately)
NOW := $(shell date)

# Conditional assignment (only if not set)
CC ?= gcc

# Append to variable
CFLAGS += -g

# Using variables
program: main.c
	$(CC) $(CFLAGS) -o program main.c
</code></pre>
<h3 id="automatic-variables"><a class="header" href="#automatic-variables">Automatic Variables</a></h3>
<pre><code class="language-makefile"># $@ - Target name
# $&lt; - First prerequisite
# $^ - All prerequisites
# $? - Prerequisites newer than target
# $* - Stem of pattern rule match

# Example usage
%.o: %.c
	$(CC) $(CFLAGS) -c $&lt; -o $@
	# $&lt; is the .c file
	# $@ is the .o file

program: main.o utils.o
	$(CC) -o $@ $^
	# $@ is 'program'
	# $^ is 'main.o utils.o'
</code></pre>
<h2 id="pattern-rules"><a class="header" href="#pattern-rules">Pattern Rules</a></h2>
<h3 id="suffix-rules"><a class="header" href="#suffix-rules">Suffix Rules</a></h3>
<pre><code class="language-makefile"># Pattern rule for .c -&gt; .o
%.o: %.c
	$(CC) $(CFLAGS) -c $&lt; -o $@

# Pattern rule for .cpp -&gt; .o
%.o: %.cpp
	$(CXX) $(CXXFLAGS) -c $&lt; -o $@

# Multiple wildcards
bin/%: src/%.c
	$(CC) $(CFLAGS) $&lt; -o $@
</code></pre>
<h3 id="wildcards"><a class="header" href="#wildcards">Wildcards</a></h3>
<pre><code class="language-makefile"># Wildcard function
SRCS = $(wildcard src/*.c)
OBJS = $(wildcard obj/*.o)

# Pattern substitution
OBJS = $(SRCS:.c=.o)
OBJS = $(SRCS:%.c=%.o)
OBJS = $(patsubst %.c,%.o,$(SRCS))

# Example
SOURCES = $(wildcard *.c)
OBJECTS = $(SOURCES:.c=.o)
DEPS = $(SOURCES:.c=.d)
</code></pre>
<h2 id="phony-targets"><a class="header" href="#phony-targets">Phony Targets</a></h2>
<pre><code class="language-makefile"># Declare phony targets
.PHONY: all clean install test

# Common phony targets
all: program library

clean:
	rm -f *.o *.d program

install: program
	cp program /usr/local/bin/

test: program
	./run_tests.sh

# Prevent make from checking if 'clean' file exists
.PHONY: clean
clean:
	rm -f *.o program
</code></pre>
<h2 id="cc-project-examples"><a class="header" href="#cc-project-examples">C/C++ Project Examples</a></h2>
<h3 id="simple-c-project"><a class="header" href="#simple-c-project">Simple C Project</a></h3>
<pre><code class="language-makefile"># Compiler and flags
CC = gcc
CFLAGS = -Wall -Wextra -O2 -g

# Target executable
TARGET = myprogram

# Source files
SRCS = main.c utils.c parser.c
OBJS = $(SRCS:.c=.o)

# Default target
all: $(TARGET)

# Link object files
$(TARGET): $(OBJS)
	$(CC) -o $@ $^

# Compile source files
%.o: %.c
	$(CC) $(CFLAGS) -c $&lt; -o $@

# Clean build artifacts
clean:
	rm -f $(OBJS) $(TARGET)

# Phony targets
.PHONY: all clean
</code></pre>
<h3 id="c-project-with-headers"><a class="header" href="#c-project-with-headers">C Project with Headers</a></h3>
<pre><code class="language-makefile">CC = gcc
CFLAGS = -Wall -Wextra -O2 -Iinclude

SRCDIR = src
OBJDIR = obj
BINDIR = bin

SRCS = $(wildcard $(SRCDIR)/*.c)
OBJS = $(SRCS:$(SRCDIR)/%.c=$(OBJDIR)/%.o)
TARGET = $(BINDIR)/program

all: $(TARGET)

$(TARGET): $(OBJS) | $(BINDIR)
	$(CC) -o $@ $^

$(OBJDIR)/%.o: $(SRCDIR)/%.c | $(OBJDIR)
	$(CC) $(CFLAGS) -c $&lt; -o $@

# Create directories if they don't exist
$(BINDIR) $(OBJDIR):
	mkdir -p $@

clean:
	rm -rf $(OBJDIR) $(BINDIR)

.PHONY: all clean
</code></pre>
<h3 id="c-project-with-libraries"><a class="header" href="#c-project-with-libraries">C++ Project with Libraries</a></h3>
<pre><code class="language-makefile">CXX = g++
CXXFLAGS = -std=c++17 -Wall -Wextra -O2
LDFLAGS = -lpthread -lm

SRCDIR = src
OBJDIR = obj
BINDIR = bin
INCDIR = include

SRCS = $(wildcard $(SRCDIR)/*.cpp)
OBJS = $(SRCS:$(SRCDIR)/%.cpp=$(OBJDIR)/%.o)
DEPS = $(OBJS:.o=.d)
TARGET = $(BINDIR)/program

all: $(TARGET)

$(TARGET): $(OBJS) | $(BINDIR)
	$(CXX) $(CXXFLAGS) -o $@ $^ $(LDFLAGS)

$(OBJDIR)/%.o: $(SRCDIR)/%.cpp | $(OBJDIR)
	$(CXX) $(CXXFLAGS) -I$(INCDIR) -MMD -MP -c $&lt; -o $@

$(BINDIR) $(OBJDIR):
	mkdir -p $@

clean:
	rm -rf $(OBJDIR) $(BINDIR)

# Include dependency files
-include $(DEPS)

.PHONY: all clean
</code></pre>
<h3 id="multi-target-project"><a class="header" href="#multi-target-project">Multi-target Project</a></h3>
<pre><code class="language-makefile">CC = gcc
CFLAGS = -Wall -Wextra -O2

# Multiple programs
PROGRAMS = server client

all: $(PROGRAMS)

server: server.o network.o utils.o
	$(CC) -o $@ $^

client: client.o network.o
	$(CC) -o $@ $^

%.o: %.c
	$(CC) $(CFLAGS) -c $&lt; -o $@

clean:
	rm -f *.o $(PROGRAMS)

.PHONY: all clean
</code></pre>
<h2 id="advanced-features-5"><a class="header" href="#advanced-features-5">Advanced Features</a></h2>
<h3 id="conditional-statements"><a class="header" href="#conditional-statements">Conditional Statements</a></h3>
<pre><code class="language-makefile"># Check variable value
ifdef DEBUG
    CFLAGS += -g -DDEBUG
else
    CFLAGS += -O2
endif

# Conditional based on value
ifeq ($(CC),gcc)
    CFLAGS += -Wall
endif

ifneq ($(OS),Windows_NT)
    LDFLAGS += -lpthread
endif

# OS detection
UNAME := $(shell uname -s)
ifeq ($(UNAME),Linux)
    LDFLAGS += -lrt
endif
ifeq ($(UNAME),Darwin)
    LDFLAGS += -framework CoreFoundation
endif
</code></pre>
<h3 id="functions-6"><a class="header" href="#functions-6">Functions</a></h3>
<pre><code class="language-makefile"># Substitution
SRCS = main.c utils.c parser.c
OBJS = $(SRCS:.c=.o)
OBJS = $(patsubst %.c,%.o,$(SRCS))

# Directory operations
DIRS = $(dir src/main.c include/utils.h)  # "src/ include/"
FILES = $(notdir src/main.c include/utils.h)  # "main.c utils.h"

# String manipulation
FILES = $(wildcard *.c)
NAMES = $(basename $(FILES))  # Remove extension
UPPERS = $(shell echo $(FILES) | tr a-z A-Z)

# Filtering
SRCS = main.c test.c utils.c
PROD_SRCS = $(filter-out test.c,$(SRCS))  # "main.c utils.c"
TEST_SRCS = $(filter test%,$(SRCS))  # "test.c"

# Shell commands
DATE := $(shell date +%Y%m%d)
GIT_HASH := $(shell git rev-parse --short HEAD)
</code></pre>
<h3 id="include-directives"><a class="header" href="#include-directives">Include Directives</a></h3>
<pre><code class="language-makefile"># Include another makefile
include config.mk

# Include with error if missing
include required.mk

# Include without error if missing
-include optional.mk

# Include all dependency files
-include $(DEPS)

# Example: config.mk
# CC = gcc
# CFLAGS = -Wall -O2
</code></pre>
<h3 id="recursive-make"><a class="header" href="#recursive-make">Recursive Make</a></h3>
<pre><code class="language-makefile"># Top-level Makefile
SUBDIRS = lib src tests

all:
	for dir in $(SUBDIRS); do \
		$(MAKE) -C $$dir; \
	done

clean:
	for dir in $(SUBDIRS); do \
		$(MAKE) -C $$dir clean; \
	done

.PHONY: all clean
</code></pre>
<h3 id="dependency-generation"><a class="header" href="#dependency-generation">Dependency Generation</a></h3>
<pre><code class="language-makefile">CC = gcc
CFLAGS = -Wall -O2

SRCS = main.c utils.c
OBJS = $(SRCS:.c=.o)
DEPS = $(SRCS:.c=.d)

program: $(OBJS)
	$(CC) -o $@ $^

# Generate dependencies automatically
%.o: %.c
	$(CC) $(CFLAGS) -MMD -MP -c $&lt; -o $@

# Include generated dependency files
-include $(DEPS)

clean:
	rm -f $(OBJS) $(DEPS) program

.PHONY: clean
</code></pre>
<h2 id="common-patterns-16"><a class="header" href="#common-patterns-16">Common Patterns</a></h2>
<h3 id="debug-and-release-builds"><a class="header" href="#debug-and-release-builds">Debug and Release Builds</a></h3>
<pre><code class="language-makefile">CC = gcc
CFLAGS = -Wall -Wextra

# Build modes
ifdef DEBUG
    CFLAGS += -g -O0 -DDEBUG
    TARGET = program_debug
else
    CFLAGS += -O2 -DNDEBUG
    TARGET = program
endif

SRCS = main.c utils.c
OBJS = $(SRCS:.c=.o)

all: $(TARGET)

$(TARGET): $(OBJS)
	$(CC) -o $@ $^

%.o: %.c
	$(CC) $(CFLAGS) -c $&lt; -o $@

clean:
	rm -f $(OBJS) program program_debug

# Usage: make DEBUG=1
.PHONY: all clean
</code></pre>
<h3 id="installation-targets"><a class="header" href="#installation-targets">Installation Targets</a></h3>
<pre><code class="language-makefile">PREFIX = /usr/local
BINDIR = $(PREFIX)/bin
DATADIR = $(PREFIX)/share/myapp

all: program

program: main.o
	$(CC) -o $@ $^

install: program
	install -d $(BINDIR)
	install -m 755 program $(BINDIR)
	install -d $(DATADIR)
	install -m 644 data/* $(DATADIR)

uninstall:
	rm -f $(BINDIR)/program
	rm -rf $(DATADIR)

.PHONY: all install uninstall
</code></pre>
<h3 id="test-targets"><a class="header" href="#test-targets">Test Targets</a></h3>
<pre><code class="language-makefile">CC = gcc
CFLAGS = -Wall -Wextra -O2

SRCS = main.c utils.c
TEST_SRCS = test_utils.c
OBJS = $(SRCS:.c=.o)
TEST_OBJS = $(TEST_SRCS:.c=.o)

program: $(OBJS)
	$(CC) -o $@ $^

test_runner: $(TEST_OBJS) utils.o
	$(CC) -o $@ $^

test: test_runner
	./test_runner

%.o: %.c
	$(CC) $(CFLAGS) -c $&lt; -o $@

clean:
	rm -f $(OBJS) $(TEST_OBJS) program test_runner

.PHONY: test clean
</code></pre>
<h3 id="static-library"><a class="header" href="#static-library">Static Library</a></h3>
<pre><code class="language-makefile">CC = gcc
AR = ar
CFLAGS = -Wall -Wextra -O2

LIBNAME = mylib
SRCS = lib1.c lib2.c lib3.c
OBJS = $(SRCS:.c=.o)
TARGET = lib$(LIBNAME).a

all: $(TARGET)

$(TARGET): $(OBJS)
	$(AR) rcs $@ $^

%.o: %.c
	$(CC) $(CFLAGS) -c $&lt; -o $@

install: $(TARGET)
	install -d /usr/local/lib
	install -m 644 $(TARGET) /usr/local/lib
	install -d /usr/local/include/$(LIBNAME)
	install -m 644 *.h /usr/local/include/$(LIBNAME)

clean:
	rm -f $(OBJS) $(TARGET)

.PHONY: all install clean
</code></pre>
<h3 id="shared-library"><a class="header" href="#shared-library">Shared Library</a></h3>
<pre><code class="language-makefile">CC = gcc
CFLAGS = -Wall -Wextra -O2 -fPIC
LDFLAGS = -shared

LIBNAME = mylib
VERSION = 1.0.0
MAJOR = 1

SRCS = lib1.c lib2.c lib3.c
OBJS = $(SRCS:.c=.o)
TARGET = lib$(LIBNAME).so.$(VERSION)
SONAME = lib$(LIBNAME).so.$(MAJOR)
LINKNAME = lib$(LIBNAME).so

all: $(TARGET)

$(TARGET): $(OBJS)
	$(CC) $(LDFLAGS) -Wl,-soname,$(SONAME) -o $@ $^

%.o: %.c
	$(CC) $(CFLAGS) -c $&lt; -o $@

install: $(TARGET)
	install -d /usr/local/lib
	install -m 755 $(TARGET) /usr/local/lib
	ln -sf $(TARGET) /usr/local/lib/$(SONAME)
	ln -sf $(SONAME) /usr/local/lib/$(LINKNAME)
	ldconfig

clean:
	rm -f $(OBJS) $(TARGET)

.PHONY: all install clean
</code></pre>
<h2 id="make-options"><a class="header" href="#make-options">Make Options</a></h2>
<h3 id="common-flags"><a class="header" href="#common-flags">Common Flags</a></h3>
<pre><code class="language-bash"># Run in parallel (4 jobs)
make -j4

# Keep going on errors
make -k

# Show commands without executing
make -n
make --dry-run

# Print directory changes
make -w

# Ignore errors
make -i

# Touch files instead of building
make -t

# Print database of rules
make -p

# Treat warnings as errors
make --warn-undefined-variables
</code></pre>
<h3 id="environment-variables"><a class="header" href="#environment-variables">Environment Variables</a></h3>
<pre><code class="language-bash"># Override variables
make CC=clang CFLAGS="-O3"

# Use specific Makefile
make -f Makefile.custom

# Change directory
make -C src/

# Set variables in Makefile
export CC=gcc
make
</code></pre>
<h2 id="best-practices-50"><a class="header" href="#best-practices-50">Best Practices</a></h2>
<h3 id="structure-and-organization"><a class="header" href="#structure-and-organization">Structure and Organization</a></h3>
<pre><code class="language-makefile"># 1. Use variables for configurability
CC = gcc
CFLAGS = -Wall -Wextra -O2
PREFIX = /usr/local

# 2. Declare phony targets
.PHONY: all clean install test

# 3. Use automatic variables
%.o: %.c
	$(CC) $(CFLAGS) -c $&lt; -o $@

# 4. Add help target
help:
	@echo "Available targets:"
	@echo "  all      - Build the program"
	@echo "  clean    - Remove build artifacts"
	@echo "  install  - Install the program"
	@echo "  test     - Run tests"

# 5. Use default goal
.DEFAULT_GOAL := all
</code></pre>
<h3 id="dependency-management"><a class="header" href="#dependency-management">Dependency Management</a></h3>
<pre><code class="language-makefile"># Auto-generate dependencies
CC = gcc
CFLAGS = -Wall -O2
DEPFLAGS = -MMD -MP

SRCS = $(wildcard *.c)
OBJS = $(SRCS:.c=.o)
DEPS = $(SRCS:.c=.d)

%.o: %.c
	$(CC) $(CFLAGS) $(DEPFLAGS) -c $&lt; -o $@

-include $(DEPS)

clean:
	rm -f $(OBJS) $(DEPS)
</code></pre>
<h3 id="error-handling-8"><a class="header" href="#error-handling-8">Error Handling</a></h3>
<pre><code class="language-makefile"># Stop on first error (default behavior)
.POSIX:

# Check for required tools
CHECK_CC := $(shell command -v $(CC) 2&gt; /dev/null)
ifndef CHECK_CC
    $(error $(CC) not found in PATH)
endif

# Validate variables
ifndef TARGET
    $(error TARGET is not defined)
endif

# Conditional compilation
program: main.o
ifeq ($(CC),)
	$(error CC is not set)
endif
	$(CC) -o $@ $^
</code></pre>
<h3 id="silent-and-verbose-modes"><a class="header" href="#silent-and-verbose-modes">Silent and Verbose Modes</a></h3>
<pre><code class="language-makefile"># Silent mode (suppress echo of commands)
.SILENT:

# Selective silence
all:
	@echo "Building..."
	$(CC) -o program main.c

# Verbose mode controlled by variable
ifdef VERBOSE
    Q =
else
    Q = @
endif

%.o: %.c
	@echo "CC $&lt;"
	$(Q)$(CC) $(CFLAGS) -c $&lt; -o $@
</code></pre>
<h2 id="troubleshooting-10"><a class="header" href="#troubleshooting-10">Troubleshooting</a></h2>
<h3 id="common-issues-12"><a class="header" href="#common-issues-12">Common Issues</a></h3>
<pre><code class="language-bash"># "Missing separator" error
# Problem: Using spaces instead of TAB in recipe
# Solution: Ensure recipes are indented with TAB

# "No rule to make target" error
# Problem: Make can't find prerequisite file
make --debug=v  # Verbose debug output

# "Circular dependency" error
# Problem: Target depends on itself
# Solution: Review dependency chain

# Rebuild everything
make clean &amp;&amp; make

# Show what make would do
make -n

# Print variables
make print-VARIABLE
</code></pre>
<h3 id="debug-makefile"><a class="header" href="#debug-makefile">Debug Makefile</a></h3>
<pre><code class="language-makefile"># Print variable values
print-%:
	@echo $* = $($*)

# Usage: make print-CFLAGS

# Debug output
$(info Building with CC=$(CC))
$(warning This is a warning message)
$(error This stops the build)

# Show all variables
debug:
	@echo "SRCS = $(SRCS)"
	@echo "OBJS = $(OBJS)"
	@echo "CFLAGS = $(CFLAGS)"
</code></pre>
<h3 id="performance-optimization-2"><a class="header" href="#performance-optimization-2">Performance Optimization</a></h3>
<pre><code class="language-bash"># Parallel builds
make -j$(nproc)  # Use all CPU cores

# Profile make execution
make -d &gt; debug.log 2&gt;&amp;1

# Check which targets are rebuilt
make -d | grep "Must remake"

# Use ccache for faster compilation
CC = ccache gcc
</code></pre>
<h2 id="complete-example-1"><a class="header" href="#complete-example-1">Complete Example</a></h2>
<pre><code class="language-makefile"># Project configuration
PROJECT = myapp
VERSION = 1.0.0

# Compiler settings
CC = gcc
CXX = g++
CFLAGS = -Wall -Wextra -std=c11 -O2
CXXFLAGS = -Wall -Wextra -std=c++17 -O2
LDFLAGS = -lm -lpthread

# Directories
SRCDIR = src
INCDIR = include
OBJDIR = obj
BINDIR = bin
TESTDIR = tests

# Files
SRCS = $(wildcard $(SRCDIR)/*.c)
OBJS = $(SRCS:$(SRCDIR)/%.c=$(OBJDIR)/%.o)
DEPS = $(OBJS:.o=.d)
TARGET = $(BINDIR)/$(PROJECT)

# Installation paths
PREFIX = /usr/local
BINPREFIX = $(PREFIX)/bin

# Build modes
ifdef DEBUG
    CFLAGS += -g -DDEBUG
    CXXFLAGS += -g -DDEBUG
endif

ifdef VERBOSE
    Q =
else
    Q = @
endif

# Targets
.PHONY: all clean install uninstall test help

all: $(TARGET)

$(TARGET): $(OBJS) | $(BINDIR)
	@echo "Linking $@"
	$(Q)$(CC) -o $@ $^ $(LDFLAGS)

$(OBJDIR)/%.o: $(SRCDIR)/%.c | $(OBJDIR)
	@echo "Compiling $&lt;"
	$(Q)$(CC) $(CFLAGS) -I$(INCDIR) -MMD -MP -c $&lt; -o $@

$(BINDIR) $(OBJDIR):
	$(Q)mkdir -p $@

clean:
	@echo "Cleaning build artifacts"
	$(Q)rm -rf $(OBJDIR) $(BINDIR)

install: $(TARGET)
	@echo "Installing to $(BINPREFIX)"
	$(Q)install -d $(BINPREFIX)
	$(Q)install -m 755 $(TARGET) $(BINPREFIX)

uninstall:
	@echo "Uninstalling from $(BINPREFIX)"
	$(Q)rm -f $(BINPREFIX)/$(PROJECT)

test: $(TARGET)
	@echo "Running tests"
	$(Q)./$(TESTDIR)/run_tests.sh

help:
	@echo "Available targets:"
	@echo "  all       - Build the project (default)"
	@echo "  clean     - Remove build artifacts"
	@echo "  install   - Install the program"
	@echo "  uninstall - Uninstall the program"
	@echo "  test      - Run tests"
	@echo "  help      - Show this help message"
	@echo ""
	@echo "Build modes:"
	@echo "  make DEBUG=1    - Build with debug symbols"
	@echo "  make VERBOSE=1  - Show full commands"

-include $(DEPS)
</code></pre>
<h2 id="useful-tips"><a class="header" href="#useful-tips">Useful Tips</a></h2>
<ol>
<li><strong>Always use <code>.PHONY</code></strong> for non-file targets</li>
<li><strong>Use automatic variables</strong> (<code>$@</code>, <code>$&lt;</code>, <code>$^</code>) for maintainability</li>
<li><strong>Generate dependencies</strong> automatically with <code>-MMD -MP</code></li>
<li><strong>Support parallel builds</strong> with <code>make -j</code></li>
<li><strong>Use variables</strong> for all configuration options</li>
<li><strong>Include help target</strong> for user guidance</li>
<li><strong>Handle errors gracefully</strong> with proper checks</li>
<li><strong>Keep Makefiles readable</strong> with comments and organization</li>
</ol>
<p>make simplifies building complex projects by managing dependencies and minimizing rebuild time, making it an essential tool for C/C++ development and beyond.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="docker-1"><a class="header" href="#docker-1">Docker</a></h1>
<p>Docker is a platform for developing, shipping, and running applications in containers. Containers package software with all dependencies, ensuring consistent behavior across different environments.</p>
<h2 id="overview-58"><a class="header" href="#overview-58">Overview</a></h2>
<p>Docker enables developers to package applications with their dependencies into standardized units called containers, which can run anywhere Docker is installed.</p>
<p><strong>Key Concepts:</strong></p>
<ul>
<li><strong>Container</strong>: Lightweight, standalone executable package</li>
<li><strong>Image</strong>: Read-only template for creating containers</li>
<li><strong>Dockerfile</strong>: Script defining how to build an image</li>
<li><strong>Registry</strong>: Repository for storing and distributing images</li>
<li><strong>Docker Hub</strong>: Public registry for Docker images</li>
</ul>
<h2 id="installation-11"><a class="header" href="#installation-11">Installation</a></h2>
<pre><code class="language-bash"># Ubuntu/Debian
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh
sudo usermod -aG docker $USER

# Verify installation
docker --version
docker run hello-world
</code></pre>
<h2 id="basic-commands-2"><a class="header" href="#basic-commands-2">Basic Commands</a></h2>
<h3 id="container-operations"><a class="header" href="#container-operations">Container Operations</a></h3>
<pre><code class="language-bash"># Run a container
docker run nginx
docker run -d nginx  # Detached mode
docker run -it ubuntu bash  # Interactive terminal

# Run with options
docker run -d \
  --name my-nginx \
  -p 8080:80 \
  -v /host/path:/container/path \
  -e ENV_VAR=value \
  nginx

# List containers
docker ps  # Running containers
docker ps -a  # All containers

# Stop/Start containers
docker stop container_name
docker start container_name
docker restart container_name

# Remove containers
docker rm container_name
docker rm -f container_name  # Force remove
docker container prune  # Remove all stopped containers
</code></pre>
<h3 id="image-operations"><a class="header" href="#image-operations">Image Operations</a></h3>
<pre><code class="language-bash"># List images
docker images
docker image ls

# Pull image from registry
docker pull nginx
docker pull nginx:1.21

# Build image from Dockerfile
docker build -t myapp:1.0 .
docker build -t myapp:latest -f Dockerfile.prod .

# Remove images
docker rmi image_name
docker image prune  # Remove unused images
docker image prune -a  # Remove all unused images

# Tag image
docker tag myapp:1.0 username/myapp:1.0

# Push to registry
docker push username/myapp:1.0
</code></pre>
<h3 id="logs-and-debugging"><a class="header" href="#logs-and-debugging">Logs and Debugging</a></h3>
<pre><code class="language-bash"># View logs
docker logs container_name
docker logs -f container_name  # Follow logs
docker logs --tail 100 container_name

# Execute command in container
docker exec container_name ls /app
docker exec -it container_name bash

# Inspect container
docker inspect container_name
docker stats container_name  # Resource usage

# Copy files
docker cp file.txt container_name:/path/
docker cp container_name:/path/file.txt ./
</code></pre>
<h2 id="dockerfile"><a class="header" href="#dockerfile">Dockerfile</a></h2>
<h3 id="basic-dockerfile"><a class="header" href="#basic-dockerfile">Basic Dockerfile</a></h3>
<pre><code class="language-dockerfile"># Base image
FROM node:18-alpine

# Set working directory
WORKDIR /app

# Copy package files
COPY package*.json ./

# Install dependencies
RUN npm install

# Copy application code
COPY . .

# Expose port
EXPOSE 3000

# Set environment variables
ENV NODE_ENV=production

# Run command
CMD ["node", "server.js"]
</code></pre>
<h3 id="multi-stage-build"><a class="header" href="#multi-stage-build">Multi-stage Build</a></h3>
<pre><code class="language-dockerfile"># Build stage
FROM node:18-alpine AS builder
WORKDIR /app
COPY package*.json ./
RUN npm install
COPY . .
RUN npm run build

# Production stage
FROM node:18-alpine
WORKDIR /app
COPY --from=builder /app/dist ./dist
COPY package*.json ./
RUN npm install --production
EXPOSE 3000
CMD ["node", "dist/server.js"]
</code></pre>
<h3 id="dockerfile-instructions"><a class="header" href="#dockerfile-instructions">Dockerfile Instructions</a></h3>
<pre><code class="language-dockerfile"># FROM: Base image
FROM ubuntu:22.04

# LABEL: Metadata
LABEL maintainer="dev@example.com"
LABEL version="1.0"

# ENV: Environment variables
ENV APP_HOME=/app
ENV PORT=8080

# ARG: Build-time variables
ARG VERSION=latest
RUN echo "Building version ${VERSION}"

# WORKDIR: Set working directory
WORKDIR /app

# COPY: Copy files from host
COPY src/ /app/src/

# ADD: Copy and extract archives
ADD archive.tar.gz /app/

# RUN: Execute commands during build
RUN apt-get update &amp;&amp; \
    apt-get install -y python3 &amp;&amp; \
    rm -rf /var/lib/apt/lists/*

# USER: Set user
USER appuser

# EXPOSE: Document ports
EXPOSE 8080 8443

# VOLUME: Create mount point
VOLUME ["/data"]

# ENTRYPOINT: Configure container executable
ENTRYPOINT ["python3"]

# CMD: Default arguments for ENTRYPOINT
CMD ["app.py"]

# HEALTHCHECK: Container health check
HEALTHCHECK --interval=30s --timeout=3s \
  CMD curl -f http://localhost/ || exit 1
</code></pre>
<h2 id="docker-compose"><a class="header" href="#docker-compose">Docker Compose</a></h2>
<h3 id="basic-docker-composeyml"><a class="header" href="#basic-docker-composeyml">Basic docker-compose.yml</a></h3>
<pre><code class="language-yaml">version: '3.8'

services:
  web:
    build: .
    ports:
      - "8080:80"
    volumes:
      - ./src:/app/src
    environment:
      - NODE_ENV=development
    depends_on:
      - db

  db:
    image: postgres:15
    volumes:
      - db-data:/var/lib/postgresql/data
    environment:
      POSTGRES_PASSWORD: secret
      POSTGRES_DB: myapp

volumes:
  db-data:
</code></pre>
<h3 id="docker-compose-commands"><a class="header" href="#docker-compose-commands">Docker Compose Commands</a></h3>
<pre><code class="language-bash"># Start services
docker-compose up
docker-compose up -d  # Detached

# Stop services
docker-compose down
docker-compose down -v  # Remove volumes

# Build services
docker-compose build
docker-compose build --no-cache

# View logs
docker-compose logs
docker-compose logs -f service_name

# Execute commands
docker-compose exec web bash
docker-compose exec db psql -U postgres

# Scale services
docker-compose up -d --scale web=3

# List services
docker-compose ps
</code></pre>
<h3 id="advanced-compose-configuration"><a class="header" href="#advanced-compose-configuration">Advanced Compose Configuration</a></h3>
<pre><code class="language-yaml">version: '3.8'

services:
  app:
    build:
      context: .
      dockerfile: Dockerfile.dev
      args:
        VERSION: "1.0"
    image: myapp:latest
    container_name: myapp
    restart: unless-stopped
    ports:
      - "3000:3000"
    volumes:
      - ./src:/app/src:ro  # Read-only
      - node_modules:/app/node_modules
    environment:
      NODE_ENV: development
      DATABASE_URL: postgres://db:5432/myapp
    env_file:
      - .env
    depends_on:
      db:
        condition: service_healthy
    networks:
      - backend
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:3000/health"]
      interval: 30s
      timeout: 10s
      retries: 3

  db:
    image: postgres:15-alpine
    volumes:
      - postgres_data:/var/lib/postgresql/data
      - ./init.sql:/docker-entrypoint-initdb.d/init.sql
    environment:
      POSTGRES_PASSWORD: ${DB_PASSWORD}
    networks:
      - backend

networks:
  backend:
    driver: bridge

volumes:
  postgres_data:
  node_modules:
</code></pre>
<h2 id="networking-3"><a class="header" href="#networking-3">Networking</a></h2>
<h3 id="network-commands-1"><a class="header" href="#network-commands-1">Network Commands</a></h3>
<pre><code class="language-bash"># List networks
docker network ls

# Create network
docker network create mynetwork
docker network create --driver bridge mynetwork

# Connect container to network
docker network connect mynetwork container_name

# Disconnect from network
docker network disconnect mynetwork container_name

# Inspect network
docker network inspect mynetwork

# Remove network
docker network rm mynetwork
</code></pre>
<h3 id="network-types-1"><a class="header" href="#network-types-1">Network Types</a></h3>
<pre><code class="language-bash"># Bridge (default)
docker run --network bridge nginx

# Host (use host's network)
docker run --network host nginx

# None (no networking)
docker run --network none nginx

# Custom bridge network
docker network create app-network
docker run --network app-network --name web nginx
docker run --network app-network --name db postgres
</code></pre>
<h2 id="volumes"><a class="header" href="#volumes">Volumes</a></h2>
<h3 id="volume-management"><a class="header" href="#volume-management">Volume Management</a></h3>
<pre><code class="language-bash"># Create volume
docker volume create myvolume

# List volumes
docker volume ls

# Inspect volume
docker volume inspect myvolume

# Remove volume
docker volume rm myvolume
docker volume prune  # Remove unused volumes

# Use volume in container
docker run -v myvolume:/data nginx
docker run --mount source=myvolume,target=/data nginx
</code></pre>
<h3 id="volume-types"><a class="header" href="#volume-types">Volume Types</a></h3>
<pre><code class="language-bash"># Named volume
docker run -v myvolume:/app/data nginx

# Bind mount (host directory)
docker run -v /host/path:/container/path nginx
docker run -v $(pwd):/app nginx

# Anonymous volume
docker run -v /container/path nginx

# Read-only volume
docker run -v myvolume:/data:ro nginx
</code></pre>
<h2 id="best-practices-51"><a class="header" href="#best-practices-51">Best Practices</a></h2>
<h3 id="dockerfile-optimization"><a class="header" href="#dockerfile-optimization">Dockerfile Optimization</a></h3>
<pre><code class="language-dockerfile"># 1. Use specific image tags
FROM node:18.16-alpine  # Good
FROM node:latest        # Avoid

# 2. Minimize layers
RUN apt-get update &amp;&amp; apt-get install -y \
    package1 \
    package2 \
    &amp;&amp; rm -rf /var/lib/apt/lists/*

# 3. Order instructions by frequency of change
FROM node:18-alpine
WORKDIR /app
COPY package*.json ./     # Changes less frequently
RUN npm install
COPY . .                  # Changes more frequently

# 4. Use .dockerignore
# Create .dockerignore file:
# node_modules
# .git
# .env
# *.log

# 5. Don't run as root
RUN addgroup -g 1001 appgroup &amp;&amp; \
    adduser -D -u 1001 -G appgroup appuser
USER appuser

# 6. Use multi-stage builds
FROM node:18 AS builder
WORKDIR /app
COPY . .
RUN npm run build

FROM node:18-alpine
COPY --from=builder /app/dist /app/dist
</code></pre>
<h3 id="security-best-practices-7"><a class="header" href="#security-best-practices-7">Security Best Practices</a></h3>
<pre><code class="language-bash"># 1. Scan images for vulnerabilities
docker scan myimage:latest

# 2. Use official images
docker pull nginx:alpine

# 3. Keep images updated
docker pull nginx:latest

# 4. Limit container resources
docker run --memory="512m" --cpus="1.0" nginx

# 5. Run as non-root user
docker run --user 1000:1000 nginx

# 6. Use secrets for sensitive data
docker secret create db_password password.txt
docker service create --secret db_password myapp
</code></pre>
<h2 id="common-patterns-17"><a class="header" href="#common-patterns-17">Common Patterns</a></h2>
<h3 id="development-environment-2"><a class="header" href="#development-environment-2">Development Environment</a></h3>
<pre><code class="language-yaml"># docker-compose.dev.yml
version: '3.8'

services:
  app:
    build:
      context: .
      target: development
    volumes:
      - .:/app
      - /app/node_modules
    ports:
      - "3000:3000"
    environment:
      NODE_ENV: development
    command: npm run dev
</code></pre>
<h3 id="production-setup"><a class="header" href="#production-setup">Production Setup</a></h3>
<pre><code class="language-yaml"># docker-compose.prod.yml
version: '3.8'

services:
  app:
    image: myapp:${VERSION:-latest}
    restart: always
    ports:
      - "80:3000"
    environment:
      NODE_ENV: production
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:3000/health"]
      interval: 30s
    deploy:
      replicas: 3
      resources:
        limits:
          cpus: '1'
          memory: 512M
</code></pre>
<h3 id="backup-script-1"><a class="header" href="#backup-script-1">Backup Script</a></h3>
<pre><code class="language-bash">#!/bin/bash
# Backup Docker volume

VOLUME_NAME="mydata"
BACKUP_FILE="backup-$(date +%Y%m%d-%H%M%S).tar.gz"

docker run --rm \
  -v ${VOLUME_NAME}:/data \
  -v $(pwd):/backup \
  alpine \
  tar czf /backup/${BACKUP_FILE} -C /data .

echo "Backup created: ${BACKUP_FILE}"
</code></pre>
<h2 id="troubleshooting-11"><a class="header" href="#troubleshooting-11">Troubleshooting</a></h2>
<h3 id="common-issues-13"><a class="header" href="#common-issues-13">Common Issues</a></h3>
<pre><code class="language-bash"># Container exits immediately
docker logs container_name
docker run -it container_name sh

# Port already in use
docker ps -a | grep 8080
lsof -i :8080

# Out of disk space
docker system df
docker system prune  # Remove unused data
docker system prune -a  # Remove all unused data

# Permission denied
sudo usermod -aG docker $USER
newgrp docker

# Network issues
docker network ls
docker network inspect bridge

# Image pull errors
docker pull --platform linux/amd64 image_name
</code></pre>
<h3 id="debugging-commands-1"><a class="header" href="#debugging-commands-1">Debugging Commands</a></h3>
<pre><code class="language-bash"># Inspect container
docker inspect --format='{{.State.Status}}' container_name
docker inspect --format='{{.NetworkSettings.IPAddress}}' container_name

# Container events
docker events --filter container=container_name

# System information
docker info
docker version

# Resource usage
docker stats
docker top container_name
</code></pre>
<h2 id="useful-aliases-4"><a class="header" href="#useful-aliases-4">Useful Aliases</a></h2>
<pre><code class="language-bash"># Add to ~/.bashrc or ~/.zshrc
alias dps='docker ps'
alias dpsa='docker ps -a'
alias di='docker images'
alias drm='docker rm'
alias drmi='docker rmi'
alias dstop='docker stop $(docker ps -q)'
alias dclean='docker system prune -af'
alias dlog='docker logs -f'
alias dexec='docker exec -it'
</code></pre>
<h2 id="quick-reference-12"><a class="header" href="#quick-reference-12">Quick Reference</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody>
<tr><td><code>docker run</code></td><td>Create and start container</td></tr>
<tr><td><code>docker ps</code></td><td>List running containers</td></tr>
<tr><td><code>docker stop</code></td><td>Stop container</td></tr>
<tr><td><code>docker rm</code></td><td>Remove container</td></tr>
<tr><td><code>docker images</code></td><td>List images</td></tr>
<tr><td><code>docker pull</code></td><td>Download image</td></tr>
<tr><td><code>docker build</code></td><td>Build image from Dockerfile</td></tr>
<tr><td><code>docker push</code></td><td>Upload image to registry</td></tr>
<tr><td><code>docker logs</code></td><td>View container logs</td></tr>
<tr><td><code>docker exec</code></td><td>Run command in container</td></tr>
<tr><td><code>docker-compose up</code></td><td>Start services</td></tr>
<tr><td><code>docker-compose down</code></td><td>Stop services</td></tr>
</tbody></table>
</div>
<p>Docker simplifies application deployment and ensures consistency across development, testing, and production environments.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ansible"><a class="header" href="#ansible">Ansible</a></h1>
<p>Ansible is an open-source IT automation engine that automates provisioning, configuration management, application deployment, orchestration, and many other IT processes. It uses SSH for communication and requires no agents on managed nodes.</p>
<h2 id="overview-59"><a class="header" href="#overview-59">Overview</a></h2>
<p>Ansible uses a simple, human-readable language (YAML) to describe automation jobs. It's agentless, using OpenSSH for transport, making it secure and easy to set up.</p>
<p><strong>Key Concepts:</strong></p>
<ul>
<li><strong>Inventory</strong>: List of managed nodes (hosts)</li>
<li><strong>Playbook</strong>: YAML files defining tasks to execute</li>
<li><strong>Module</strong>: Reusable code units for specific tasks</li>
<li><strong>Role</strong>: Organized collection of playbooks and files</li>
<li><strong>Task</strong>: Single action to be performed</li>
<li><strong>Handler</strong>: Tasks triggered by notifications</li>
<li><strong>Facts</strong>: System information gathered from hosts</li>
</ul>
<h2 id="installation-12"><a class="header" href="#installation-12">Installation</a></h2>
<pre><code class="language-bash"># Ubuntu/Debian
sudo apt update
sudo apt install ansible

# macOS
brew install ansible

# CentOS/RHEL
sudo yum install epel-release
sudo yum install ansible

# Using pip
pip install ansible

# Verify installation
ansible --version
</code></pre>
<h2 id="basic-configuration-2"><a class="header" href="#basic-configuration-2">Basic Configuration</a></h2>
<h3 id="ansible-config"><a class="header" href="#ansible-config">Ansible Config</a></h3>
<pre><code class="language-bash"># Create ansible.cfg
cat &lt;&lt; 'EOF' &gt; ansible.cfg
[defaults]
inventory = ./inventory
host_key_checking = False
remote_user = ansible
private_key_file = ~/.ssh/id_rsa
retry_files_enabled = False
gathering = smart
fact_caching = jsonfile
fact_caching_connection = /tmp/ansible_facts
fact_caching_timeout = 3600

[privilege_escalation]
become = True
become_method = sudo
become_user = root
become_ask_pass = False
EOF
</code></pre>
<h3 id="inventory-file"><a class="header" href="#inventory-file">Inventory File</a></h3>
<pre><code class="language-ini"># inventory or hosts file

# Single host
web1.example.com

# Group of hosts
[webservers]
web1.example.com
web2.example.com
192.168.1.10

# Multiple groups
[databases]
db1.example.com
db2.example.com

[app:children]
webservers
databases

# Host with variables
[webservers]
web1.example.com ansible_user=admin ansible_port=2222

# Group variables
[webservers:vars]
ansible_user=deploy
ansible_python_interpreter=/usr/bin/python3
http_port=80
</code></pre>
<h3 id="dynamic-inventory-yaml"><a class="header" href="#dynamic-inventory-yaml">Dynamic Inventory (YAML)</a></h3>
<pre><code class="language-yaml"># inventory.yml
all:
  hosts:
    web1.example.com:
    web2.example.com:
  children:
    webservers:
      hosts:
        web1.example.com:
          ansible_user: deploy
        web2.example.com:
          ansible_user: deploy
      vars:
        http_port: 80
    databases:
      hosts:
        db1.example.com:
        db2.example.com:
      vars:
        db_port: 5432
</code></pre>
<h2 id="ad-hoc-commands"><a class="header" href="#ad-hoc-commands">Ad-hoc Commands</a></h2>
<pre><code class="language-bash"># Ping all hosts
ansible all -m ping

# Ping specific group
ansible webservers -m ping

# Run shell command
ansible all -m shell -a "uptime"
ansible webservers -a "df -h"  # shell module is default

# Copy file
ansible all -m copy -a "src=/local/file dest=/remote/file"

# Install package
ansible webservers -m apt -a "name=nginx state=present" --become

# Start service
ansible webservers -m service -a "name=nginx state=started" --become

# Gather facts
ansible all -m setup

# Specific fact
ansible all -m setup -a "filter=ansible_distribution*"

# Execute with sudo
ansible all -a "systemctl restart nginx" --become

# Execute as specific user
ansible all -a "whoami" --become-user=www-data
</code></pre>
<h2 id="playbooks"><a class="header" href="#playbooks">Playbooks</a></h2>
<h3 id="basic-playbook"><a class="header" href="#basic-playbook">Basic Playbook</a></h3>
<pre><code class="language-yaml"># playbook.yml
---
- name: Configure web servers
  hosts: webservers
  become: yes

  tasks:
    - name: Install nginx
      apt:
        name: nginx
        state: present
        update_cache: yes

    - name: Start nginx service
      service:
        name: nginx
        state: started
        enabled: yes

    - name: Copy index.html
      copy:
        src: files/index.html
        dest: /var/www/html/index.html
        owner: www-data
        group: www-data
        mode: '0644'
</code></pre>
<h3 id="running-playbooks"><a class="header" href="#running-playbooks">Running Playbooks</a></h3>
<pre><code class="language-bash"># Run playbook
ansible-playbook playbook.yml

# Dry run (check mode)
ansible-playbook playbook.yml --check

# Show differences
ansible-playbook playbook.yml --check --diff

# Limit to specific hosts
ansible-playbook playbook.yml --limit web1.example.com
ansible-playbook playbook.yml --limit webservers

# Tags
ansible-playbook playbook.yml --tags "install"
ansible-playbook playbook.yml --skip-tags "config"

# Start at specific task
ansible-playbook playbook.yml --start-at-task="Install nginx"

# Verbose output
ansible-playbook playbook.yml -v    # verbose
ansible-playbook playbook.yml -vv   # more verbose
ansible-playbook playbook.yml -vvv  # very verbose
</code></pre>
<h3 id="variables-in-playbooks"><a class="header" href="#variables-in-playbooks">Variables in Playbooks</a></h3>
<pre><code class="language-yaml">---
- name: Configure application
  hosts: webservers
  vars:
    app_name: myapp
    app_version: "1.0"
    app_port: 8080

  tasks:
    - name: Create app directory
      file:
        path: "/opt/{{ app_name }}"
        state: directory
        owner: "{{ ansible_user }}"

    - name: Display variables
      debug:
        msg: "Deploying {{ app_name }} version {{ app_version }} on port {{ app_port }}"
</code></pre>
<h3 id="variables-from-files"><a class="header" href="#variables-from-files">Variables from Files</a></h3>
<pre><code class="language-yaml"># vars.yml
---
app_name: myapp
app_version: "1.0"
app_port: 8080
database:
  host: db.example.com
  name: myapp_db
  user: myapp_user

# playbook.yml
---
- name: Configure application
  hosts: webservers
  vars_files:
    - vars.yml

  tasks:
    - name: Display app info
      debug:
        msg: "App: {{ app_name }}, DB: {{ database.host }}"
</code></pre>
<h2 id="common-modules"><a class="header" href="#common-modules">Common Modules</a></h2>
<h3 id="system-modules"><a class="header" href="#system-modules">System Modules</a></h3>
<pre><code class="language-yaml"># User management
- name: Create user
  user:
    name: deploy
    state: present
    groups: sudo
    shell: /bin/bash
    create_home: yes

# Group management
- name: Create group
  group:
    name: developers
    state: present

# File operations
- name: Create file
  file:
    path: /tmp/test.txt
    state: touch
    mode: '0644'
    owner: deploy

- name: Create directory
  file:
    path: /opt/myapp
    state: directory
    mode: '0755'
    recurse: yes

# Copy files
- name: Copy file
  copy:
    src: files/config.conf
    dest: /etc/myapp/config.conf
    backup: yes

# Template files
- name: Deploy template
  template:
    src: templates/nginx.conf.j2
    dest: /etc/nginx/nginx.conf
    validate: 'nginx -t -c %s'
  notify: restart nginx
</code></pre>
<h3 id="package-management-1"><a class="header" href="#package-management-1">Package Management</a></h3>
<pre><code class="language-yaml"># APT (Debian/Ubuntu)
- name: Install packages
  apt:
    name:
      - nginx
      - postgresql
      - python3-pip
    state: present
    update_cache: yes

# YUM/DNF (RedHat/CentOS)
- name: Install packages
  yum:
    name:
      - httpd
      - mariadb-server
    state: present

# Package from URL
- name: Install deb package
  apt:
    deb: https://example.com/package.deb

# Remove package
- name: Remove package
  apt:
    name: apache2
    state: absent
    purge: yes
</code></pre>
<h3 id="service-management-3"><a class="header" href="#service-management-3">Service Management</a></h3>
<pre><code class="language-yaml">- name: Manage service
  service:
    name: nginx
    state: started
    enabled: yes

- name: Restart service
  service:
    name: apache2
    state: restarted

- name: Reload service
  service:
    name: nginx
    state: reloaded
</code></pre>
<h3 id="command-execution"><a class="header" href="#command-execution">Command Execution</a></h3>
<pre><code class="language-yaml"># Shell module
- name: Run shell command
  shell: echo $HOME
  register: home_dir

- name: Display output
  debug:
    var: home_dir.stdout

# Command module (no shell features)
- name: Run command
  command: /usr/bin/uptime
  register: uptime_result

# Script execution
- name: Run script
  script: scripts/setup.sh

# Execute with conditions
- name: Check file exists
  stat:
    path: /etc/config.conf
  register: config_file

- name: Run if file exists
  command: /usr/bin/process_config
  when: config_file.stat.exists
</code></pre>
<h2 id="handlers"><a class="header" href="#handlers">Handlers</a></h2>
<pre><code class="language-yaml">---
- name: Configure nginx
  hosts: webservers
  become: yes

  tasks:
    - name: Copy nginx config
      template:
        src: nginx.conf.j2
        dest: /etc/nginx/nginx.conf
      notify:
        - restart nginx
        - reload nginx

    - name: Copy site config
      template:
        src: site.conf.j2
        dest: /etc/nginx/sites-available/default
      notify: reload nginx

  handlers:
    - name: restart nginx
      service:
        name: nginx
        state: restarted

    - name: reload nginx
      service:
        name: nginx
        state: reloaded
</code></pre>
<h2 id="roles"><a class="header" href="#roles">Roles</a></h2>
<h3 id="creating-a-role"><a class="header" href="#creating-a-role">Creating a Role</a></h3>
<pre><code class="language-bash"># Create role structure
ansible-galaxy init myrole

# Directory structure
myrole/
├── defaults/          # Default variables
│   └── main.yml
├── files/             # Static files
├── handlers/          # Handlers
│   └── main.yml
├── meta/              # Role metadata
│   └── main.yml
├── tasks/             # Main tasks
│   └── main.yml
├── templates/         # Jinja2 templates
├── tests/             # Test playbooks
│   └── test.yml
└── vars/              # Role variables
    └── main.yml
</code></pre>
<h3 id="role-example"><a class="header" href="#role-example">Role Example</a></h3>
<pre><code class="language-yaml"># roles/nginx/tasks/main.yml
---
- name: Install nginx
  apt:
    name: nginx
    state: present
    update_cache: yes

- name: Copy nginx config
  template:
    src: nginx.conf.j2
    dest: /etc/nginx/nginx.conf
  notify: restart nginx

- name: Start nginx
  service:
    name: nginx
    state: started
    enabled: yes

# roles/nginx/handlers/main.yml
---
- name: restart nginx
  service:
    name: nginx
    state: restarted

# roles/nginx/defaults/main.yml
---
nginx_port: 80
nginx_user: www-data

# Using the role
---
- name: Setup web server
  hosts: webservers
  become: yes
  roles:
    - nginx
    - { role: mysql, mysql_port: 3306 }
</code></pre>
<h2 id="conditionals-and-loops"><a class="header" href="#conditionals-and-loops">Conditionals and Loops</a></h2>
<h3 id="conditionals"><a class="header" href="#conditionals">Conditionals</a></h3>
<pre><code class="language-yaml">---
- name: Conditional tasks
  hosts: all
  tasks:
    - name: Install on Ubuntu
      apt:
        name: nginx
        state: present
      when: ansible_distribution == "Ubuntu"

    - name: Install on CentOS
      yum:
        name: httpd
        state: present
      when: ansible_distribution == "CentOS"

    - name: Multiple conditions (AND)
      apt:
        name: nginx
        state: present
      when:
        - ansible_distribution == "Ubuntu"
        - ansible_distribution_version == "20.04"

    - name: Multiple conditions (OR)
      apt:
        name: nginx
        state: present
      when: ansible_distribution == "Ubuntu" or ansible_distribution == "Debian"
</code></pre>
<h3 id="loops-7"><a class="header" href="#loops-7">Loops</a></h3>
<pre><code class="language-yaml">---
- name: Loop examples
  hosts: all
  tasks:
    # Simple loop
    - name: Install multiple packages
      apt:
        name: "{{ item }}"
        state: present
      loop:
        - nginx
        - postgresql
        - redis-server

    # Loop with dictionary
    - name: Create users
      user:
        name: "{{ item.name }}"
        groups: "{{ item.groups }}"
        state: present
      loop:
        - { name: 'alice', groups: 'developers' }
        - { name: 'bob', groups: 'admins' }

    # Loop with complex data
    - name: Create directories
      file:
        path: "{{ item.path }}"
        state: directory
        owner: "{{ item.owner }}"
        mode: "{{ item.mode }}"
      loop:
        - { path: '/opt/app1', owner: 'deploy', mode: '0755' }
        - { path: '/opt/app2', owner: 'www-data', mode: '0750' }
</code></pre>
<h2 id="templates"><a class="header" href="#templates">Templates</a></h2>
<pre><code class="language-jinja2">{# templates/nginx.conf.j2 #}
user {{ nginx_user }};
worker_processes {{ ansible_processor_vcpus }};

events {
    worker_connections 1024;
}

http {
    server {
        listen {{ nginx_port }};
        server_name {{ ansible_hostname }};

        location / {
            root /var/www/html;
            index index.html;
        }
    }
}

{# Conditional content #}
{% if enable_ssl %}
    ssl on;
    ssl_certificate {{ ssl_cert_path }};
{% endif %}

{# Loop in template #}
{% for server in backend_servers %}
    upstream backend_{{ loop.index }} {
        server {{ server.host }}:{{ server.port }};
    }
{% endfor %}
</code></pre>
<h2 id="vault-encryption"><a class="header" href="#vault-encryption">Vault (Encryption)</a></h2>
<pre><code class="language-bash"># Create encrypted file
ansible-vault create secrets.yml

# Edit encrypted file
ansible-vault edit secrets.yml

# Encrypt existing file
ansible-vault encrypt vars.yml

# Decrypt file
ansible-vault decrypt vars.yml

# View encrypted file
ansible-vault view secrets.yml

# Change password
ansible-vault rekey secrets.yml

# Use vault in playbook
ansible-playbook playbook.yml --ask-vault-pass

# Use password file
ansible-playbook playbook.yml --vault-password-file ~/.vault_pass

# Multiple vaults
ansible-playbook playbook.yml --vault-id prod@prompt --vault-id dev@~/.vault_pass_dev
</code></pre>
<h3 id="vault-example"><a class="header" href="#vault-example">Vault Example</a></h3>
<pre><code class="language-yaml"># secrets.yml (encrypted)
db_password: "super_secret_password"
api_key: "abc123xyz789"

# playbook.yml
---
- name: Deploy with secrets
  hosts: webservers
  vars_files:
    - secrets.yml
  tasks:
    - name: Configure database
      template:
        src: db_config.j2
        dest: /etc/app/db_config.conf
</code></pre>
<h2 id="best-practices-52"><a class="header" href="#best-practices-52">Best Practices</a></h2>
<h3 id="playbook-organization"><a class="header" href="#playbook-organization">Playbook Organization</a></h3>
<pre><code class="language-bash"># Recommended directory structure
site.yml                # Master playbook
webservers.yml          # Webserver playbook
dbservers.yml           # Database playbook

inventory/
├── production/
│   ├── hosts
│   └── group_vars/
│       ├── all.yml
│       ├── webservers.yml
│       └── dbservers.yml
└── staging/
    ├── hosts
    └── group_vars/

roles/
├── common/
├── nginx/
├── postgresql/
└── app/

group_vars/
├── all.yml
├── webservers.yml
└── dbservers.yml

host_vars/
└── web1.example.com.yml
</code></pre>
<h3 id="best-practices-53"><a class="header" href="#best-practices-53">Best Practices</a></h3>
<pre><code class="language-yaml"># 1. Use names for all tasks
- name: Install nginx
  apt:
    name: nginx
    state: present

# 2. Use become appropriately
- name: System task
  become: yes
  apt:
    name: nginx
    state: present

# 3. Validate configurations
- name: Deploy nginx config
  template:
    src: nginx.conf.j2
    dest: /etc/nginx/nginx.conf
    validate: 'nginx -t -c %s'

# 4. Use check mode compatible tasks
- name: Check if service exists
  stat:
    path: /etc/systemd/system/myapp.service
  register: service_file
  check_mode: no

# 5. Add tags
- name: Install packages
  apt:
    name: nginx
    state: present
  tags: ['install', 'packages']

# 6. Use blocks for error handling
- block:
    - name: Risky operation
      command: /usr/bin/risky_command
  rescue:
    - name: Handle error
      debug:
        msg: "Command failed, handling gracefully"
  always:
    - name: Cleanup
      file:
        path: /tmp/temp_file
        state: absent
</code></pre>
<h2 id="common-patterns-18"><a class="header" href="#common-patterns-18">Common Patterns</a></h2>
<h3 id="complete-web-server-setup"><a class="header" href="#complete-web-server-setup">Complete Web Server Setup</a></h3>
<pre><code class="language-yaml">---
- name: Configure web servers
  hosts: webservers
  become: yes
  vars:
    app_name: myapp
    app_user: www-data

  tasks:
    - name: Update apt cache
      apt:
        update_cache: yes
        cache_valid_time: 3600

    - name: Install packages
      apt:
        name:
          - nginx
          - python3-pip
          - git
        state: present

    - name: Create app directory
      file:
        path: "/var/www/{{ app_name }}"
        state: directory
        owner: "{{ app_user }}"
        mode: '0755'

    - name: Deploy nginx config
      template:
        src: nginx.conf.j2
        dest: /etc/nginx/sites-available/{{ app_name }}
      notify: reload nginx

    - name: Enable site
      file:
        src: /etc/nginx/sites-available/{{ app_name }}
        dest: /etc/nginx/sites-enabled/{{ app_name }}
        state: link
      notify: reload nginx

    - name: Start nginx
      service:
        name: nginx
        state: started
        enabled: yes

  handlers:
    - name: reload nginx
      service:
        name: nginx
        state: reloaded
</code></pre>
<h3 id="multi-stage-deployment"><a class="header" href="#multi-stage-deployment">Multi-stage Deployment</a></h3>
<pre><code class="language-yaml">---
- name: Deploy application
  hosts: webservers
  serial: 1  # Rolling update
  max_fail_percentage: 25

  pre_tasks:
    - name: Remove from load balancer
      haproxy:
        state: disabled
        host: "{{ ansible_hostname }}"

  tasks:
    - name: Deploy application
      git:
        repo: https://github.com/user/app.git
        dest: /opt/app
        version: "{{ app_version }}"

    - name: Install dependencies
      pip:
        requirements: /opt/app/requirements.txt

    - name: Restart app service
      service:
        name: myapp
        state: restarted

    - name: Wait for app to start
      wait_for:
        port: 8080
        delay: 5
        timeout: 30

  post_tasks:
    - name: Add to load balancer
      haproxy:
        state: enabled
        host: "{{ ansible_hostname }}"
</code></pre>
<h2 id="troubleshooting-12"><a class="header" href="#troubleshooting-12">Troubleshooting</a></h2>
<pre><code class="language-bash"># Check syntax
ansible-playbook playbook.yml --syntax-check

# List tasks
ansible-playbook playbook.yml --list-tasks

# List hosts
ansible-playbook playbook.yml --list-hosts

# Dry run
ansible-playbook playbook.yml --check

# Debug mode
ansible-playbook playbook.yml -vvv

# Start at specific task
ansible-playbook playbook.yml --start-at-task="Install nginx"

# Step through playbook
ansible-playbook playbook.yml --step

# Gather facts only
ansible all -m setup --tree /tmp/facts
</code></pre>
<h2 id="quick-reference-13"><a class="header" href="#quick-reference-13">Quick Reference</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody>
<tr><td><code>ansible all -m ping</code></td><td>Ping all hosts</td></tr>
<tr><td><code>ansible-playbook playbook.yml</code></td><td>Run playbook</td></tr>
<tr><td><code>ansible-playbook --check</code></td><td>Dry run</td></tr>
<tr><td><code>ansible-playbook --tags TAG</code></td><td>Run specific tags</td></tr>
<tr><td><code>ansible-playbook --limit HOST</code></td><td>Limit to hosts</td></tr>
<tr><td><code>ansible-vault create FILE</code></td><td>Create encrypted file</td></tr>
<tr><td><code>ansible-galaxy init ROLE</code></td><td>Create role</td></tr>
<tr><td><code>ansible-inventory --list</code></td><td>Show inventory</td></tr>
</tbody></table>
</div>
<p>Ansible simplifies IT automation with its agentless architecture and simple YAML syntax, making infrastructure management efficient and reproducible.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="wpa_supplicant"><a class="header" href="#wpa_supplicant">wpa_supplicant</a></h1>
<p>A comprehensive guide to wpa_supplicant, the IEEE 802.11 authentication daemon for WiFi client connectivity on Linux.</p>
<h2 id="table-of-contents-33"><a class="header" href="#table-of-contents-33">Table of Contents</a></h2>
<ul>
<li><a href="tools/wpa_supplicant.html#overview">Overview</a></li>
<li><a href="tools/wpa_supplicant.html#installation">Installation</a></li>
<li><a href="tools/wpa_supplicant.html#configuration-files">Configuration Files</a></li>
<li><a href="tools/wpa_supplicant.html#basic-usage">Basic Usage</a></li>
<li><a href="tools/wpa_supplicant.html#network-configuration">Network Configuration</a></li>
<li><a href="tools/wpa_supplicant.html#command-line-interface">Command-Line Interface</a></li>
<li><a href="tools/wpa_supplicant.html#wpa_cli-interactive-mode">wpa_cli Interactive Mode</a></li>
<li><a href="tools/wpa_supplicant.html#advanced-configuration">Advanced Configuration</a></li>
<li><a href="tools/wpa_supplicant.html#security-modes">Security Modes</a></li>
<li><a href="tools/wpa_supplicant.html#enterprise-wifi-8021x">Enterprise WiFi (802.1X)</a></li>
<li><a href="tools/wpa_supplicant.html#p2p-wifi-direct">P2P WiFi Direct</a></li>
<li><a href="tools/wpa_supplicant.html#troubleshooting">Troubleshooting</a></li>
<li><a href="tools/wpa_supplicant.html#integration-with-systemd">Integration with systemd</a></li>
<li><a href="tools/wpa_supplicant.html#best-practices">Best Practices</a></li>
</ul>
<hr />
<h2 id="overview-60"><a class="header" href="#overview-60">Overview</a></h2>
<p><strong>wpa_supplicant</strong> is a WPA/WPA2/WPA3 supplicant for Linux and other UNIX-like operating systems. It handles WiFi authentication and association for client stations.</p>
<h3 id="key-features-7"><a class="header" href="#key-features-7">Key Features</a></h3>
<ul>
<li>WPA/WPA2/WPA3-Personal (PSK)</li>
<li>WPA/WPA2/WPA3-Enterprise (802.1X/EAP)</li>
<li>WEP (deprecated, for legacy networks)</li>
<li>Hotspot 2.0 (Passpoint)</li>
<li>WiFi Protected Setup (WPS)</li>
<li>WiFi Direct (P2P)</li>
<li>Automatic network selection</li>
<li>Dynamic reconfiguration via control interface</li>
</ul>
<h3 id="architecture-5"><a class="header" href="#architecture-5">Architecture</a></h3>
<pre><code>┌─────────────────────────────────────┐
│        User Space                   │
│                                     │
│  ┌──────────┐      ┌──────────┐   │
│  │  wpa_cli │      │ NetworkMgr│   │
│  └────┬─────┘      └────┬──────┘   │
│       │                 │           │
│       └────┬────────────┘           │
│            │ Control socket         │
│       ┌────▼──────────────┐         │
│       │  wpa_supplicant   │         │
│       └────┬──────────────┘         │
│            │ nl80211/WEXT           │
└────────────┼─────────────────────────┘
             │
┌────────────▼─────────────────────────┐
│        Kernel Space                  │
│  ┌──────────────────────────┐        │
│  │  cfg80211 / mac80211     │        │
│  └──────────┬───────────────┘        │
│             │                        │
│  ┌──────────▼───────────────┐        │
│  │    WiFi Driver           │        │
│  └──────────┬───────────────┘        │
└─────────────┼──────────────────────────┘
              │
       ┌──────▼──────┐
       │ WiFi Hardware│
       └─────────────┘
</code></pre>
<hr />
<h2 id="installation-13"><a class="header" href="#installation-13">Installation</a></h2>
<h3 id="debianubuntu"><a class="header" href="#debianubuntu">Debian/Ubuntu</a></h3>
<pre><code class="language-bash">sudo apt-get update
sudo apt-get install wpasupplicant

# Verify installation
wpa_supplicant -v
</code></pre>
<h3 id="fedorarhelcentos"><a class="header" href="#fedorarhelcentos">Fedora/RHEL/CentOS</a></h3>
<pre><code class="language-bash">sudo dnf install wpa_supplicant

# Or for older systems
sudo yum install wpa_supplicant
</code></pre>
<h3 id="arch-linux"><a class="header" href="#arch-linux">Arch Linux</a></h3>
<pre><code class="language-bash">sudo pacman -S wpa_supplicant
</code></pre>
<h3 id="build-from-source"><a class="header" href="#build-from-source">Build from Source</a></h3>
<pre><code class="language-bash"># Download
git clone git://w1.fi/srv/git/hostap.git
cd hostap/wpa_supplicant

# Configure
cp defconfig .config
# Edit .config to enable features

# Build
make

# Install
sudo make install
</code></pre>
<hr />
<h2 id="configuration-files-2"><a class="header" href="#configuration-files-2">Configuration Files</a></h2>
<h3 id="main-configuration-file"><a class="header" href="#main-configuration-file">Main Configuration File</a></h3>
<p><strong>Location:</strong> <code>/etc/wpa_supplicant/wpa_supplicant.conf</code></p>
<p><strong>Basic structure:</strong></p>
<pre><code class="language-conf"># Global settings
ctrl_interface=/var/run/wpa_supplicant
ctrl_interface_group=netdev
update_config=1
country=US

# Network configurations
network={
    ssid="MyNetwork"
    psk="password123"
}
</code></pre>
<h3 id="file-permissions"><a class="header" href="#file-permissions">File Permissions</a></h3>
<pre><code class="language-bash"># Secure the configuration file
sudo chmod 600 /etc/wpa_supplicant/wpa_supplicant.conf
sudo chown root:root /etc/wpa_supplicant/wpa_supplicant.conf
</code></pre>
<h3 id="global-parameters"><a class="header" href="#global-parameters">Global Parameters</a></h3>
<pre><code class="language-conf"># Control interface for wpa_cli
ctrl_interface=/var/run/wpa_supplicant

# Group that can access control interface
ctrl_interface_group=netdev

# Allow wpa_supplicant to update configuration
update_config=1

# Country code (affects regulatory domain)
country=US

# AP scanning mode
# 0 = driver takes care of scanning
# 1 = wpa_supplicant controls scanning (default)
# 2 = like 1, but use security policy
ap_scan=1

# Fast reauth for 802.1X
fast_reauth=1

# Enable P2P support
p2p_disabled=0
</code></pre>
<hr />
<h2 id="basic-usage-8"><a class="header" href="#basic-usage-8">Basic Usage</a></h2>
<h3 id="starting-wpa_supplicant"><a class="header" href="#starting-wpa_supplicant">Starting wpa_supplicant</a></h3>
<pre><code class="language-bash"># Basic usage
sudo wpa_supplicant -B -i wlan0 -c /etc/wpa_supplicant/wpa_supplicant.conf

# Options:
# -B: Run in background (daemon mode)
# -i: Network interface
# -c: Configuration file
# -D: Driver (nl80211, wext, etc.) - usually auto-detected
# -d: Enable debug output
# -dd: More verbose debug
</code></pre>
<h3 id="starting-with-debug-output"><a class="header" href="#starting-with-debug-output">Starting with Debug Output</a></h3>
<pre><code class="language-bash"># Foreground with debug
sudo wpa_supplicant -i wlan0 -c /etc/wpa_supplicant/wpa_supplicant.conf -d

# Even more verbose
sudo wpa_supplicant -i wlan0 -c /etc/wpa_supplicant/wpa_supplicant.conf -dd
</code></pre>
<h3 id="stopping-wpa_supplicant"><a class="header" href="#stopping-wpa_supplicant">Stopping wpa_supplicant</a></h3>
<pre><code class="language-bash"># Find process
ps aux | grep wpa_supplicant

# Kill process
sudo killall wpa_supplicant

# Or using systemd
sudo systemctl stop wpa_supplicant@wlan0
</code></pre>
<h3 id="manual-connection-workflow"><a class="header" href="#manual-connection-workflow">Manual Connection Workflow</a></h3>
<pre><code class="language-bash"># 1. Bring interface up
sudo ip link set wlan0 up

# 2. Start wpa_supplicant
sudo wpa_supplicant -B -i wlan0 -c /etc/wpa_supplicant/wpa_supplicant.conf

# 3. Wait for connection (check with wpa_cli)
wpa_cli -i wlan0 status

# 4. Get IP address
sudo dhclient wlan0
# Or
sudo dhcpcd wlan0
</code></pre>
<hr />
<h2 id="network-configuration-1"><a class="header" href="#network-configuration-1">Network Configuration</a></h2>
<h3 id="wpawpa2-personal-psk"><a class="header" href="#wpawpa2-personal-psk">WPA/WPA2-Personal (PSK)</a></h3>
<p><strong>ASCII passphrase:</strong></p>
<pre><code class="language-conf">network={
    ssid="MyWiFi"
    psk="MyPassword123"
    key_mgmt=WPA-PSK
    priority=1
}
</code></pre>
<p><strong>Pre-computed PSK (more secure):</strong></p>
<pre><code class="language-bash"># Generate PSK hash
wpa_passphrase "MyWiFi" "MyPassword123"

# Output:
network={
    ssid="MyWiFi"
    #psk="MyPassword123"
    psk=0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef
}
</code></pre>
<p><strong>In configuration file:</strong></p>
<pre><code class="language-conf">network={
    ssid="MyWiFi"
    psk=0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef
    key_mgmt=WPA-PSK
}
</code></pre>
<h3 id="wpa3-personal-sae"><a class="header" href="#wpa3-personal-sae">WPA3-Personal (SAE)</a></h3>
<pre><code class="language-conf">network={
    ssid="MyWiFi-WPA3"
    psk="MyPassword123"
    key_mgmt=SAE
    ieee80211w=2  # Required for WPA3 (PMF)
}
</code></pre>
<h3 id="open-network-no-security"><a class="header" href="#open-network-no-security">Open Network (No Security)</a></h3>
<pre><code class="language-conf">network={
    ssid="OpenWiFi"
    key_mgmt=NONE
}
</code></pre>
<h3 id="hidden-network"><a class="header" href="#hidden-network">Hidden Network</a></h3>
<pre><code class="language-conf">network={
    ssid="HiddenSSID"
    scan_ssid=1  # Enable active scanning
    psk="password"
    key_mgmt=WPA-PSK
}
</code></pre>
<h3 id="wep-deprecated"><a class="header" href="#wep-deprecated">WEP (Deprecated)</a></h3>
<pre><code class="language-conf">network={
    ssid="OldNetwork"
    key_mgmt=NONE
    wep_key0="1234567890"
    wep_tx_keyidx=0
}
</code></pre>
<h3 id="multiple-networks-with-priority"><a class="header" href="#multiple-networks-with-priority">Multiple Networks with Priority</a></h3>
<pre><code class="language-conf"># Home network - highest priority
network={
    ssid="HomeWiFi"
    psk="homepassword"
    priority=10
}

# Work network
network={
    ssid="WorkWiFi"
    psk="workpassword"
    priority=5
}

# Coffee shop - lowest priority
network={
    ssid="CoffeeShop"
    key_mgmt=NONE
    priority=1
}
</code></pre>
<h3 id="bssid-specific-configuration"><a class="header" href="#bssid-specific-configuration">BSSID-Specific Configuration</a></h3>
<pre><code class="language-conf"># Connect only to specific AP
network={
    ssid="MyWiFi"
    bssid=00:11:22:33:44:55
    psk="password"
}
</code></pre>
<hr />
<h2 id="command-line-interface"><a class="header" href="#command-line-interface">Command-Line Interface</a></h2>
<h3 id="wpa_cli---control-interface"><a class="header" href="#wpa_cli---control-interface">wpa_cli - Control Interface</a></h3>
<p><strong>Basic commands:</strong></p>
<pre><code class="language-bash"># Show status
wpa_cli -i wlan0 status

# Scan for networks
wpa_cli -i wlan0 scan
wpa_cli -i wlan0 scan_results

# List configured networks
wpa_cli -i wlan0 list_networks

# Add network
wpa_cli -i wlan0 add_network
# Returns: 0 (network ID)

# Set network parameters
wpa_cli -i wlan0 set_network 0 ssid '"MyWiFi"'
wpa_cli -i wlan0 set_network 0 psk '"password"'

# Enable network
wpa_cli -i wlan0 enable_network 0

# Select network
wpa_cli -i wlan0 select_network 0

# Save configuration
wpa_cli -i wlan0 save_config

# Remove network
wpa_cli -i wlan0 remove_network 0

# Disconnect
wpa_cli -i wlan0 disconnect

# Reconnect
wpa_cli -i wlan0 reconnect

# Reassociate
wpa_cli -i wlan0 reassociate
</code></pre>
<h3 id="quick-connection"><a class="header" href="#quick-connection">Quick Connection</a></h3>
<pre><code class="language-bash"># One-liner to connect
wpa_cli -i wlan0 &lt;&lt;EOF
add_network
set_network 0 ssid "MyWiFi"
set_network 0 psk "password"
enable_network 0
save_config
quit
EOF
</code></pre>
<hr />
<h2 id="wpa_cli-interactive-mode"><a class="header" href="#wpa_cli-interactive-mode">wpa_cli Interactive Mode</a></h2>
<h3 id="starting-interactive-mode"><a class="header" href="#starting-interactive-mode">Starting Interactive Mode</a></h3>
<pre><code class="language-bash">wpa_cli -i wlan0
</code></pre>
<p><strong>Interactive session:</strong></p>
<pre><code>wpa_cli v2.9
Copyright (c) 2004-2019, Jouni Malinen &lt;j@w1.fi&gt; and contributors

Interactive mode

&gt; status
bssid=00:11:22:33:44:55
freq=2437
ssid=MyWiFi
id=0
mode=station
pairwise_cipher=CCMP
group_cipher=CCMP
key_mgmt=WPA2-PSK
wpa_state=COMPLETED
ip_address=192.168.1.100
address=aa:bb:cc:dd:ee:ff

&gt; scan
OK
&gt; scan_results
bssid / frequency / signal level / flags / ssid
00:11:22:33:44:55       2437    -45     [WPA2-PSK-CCMP][ESS]    MyWiFi
aa:bb:cc:dd:ee:ff       2462    -67     [WPA2-PSK-CCMP][ESS]    NeighborWiFi

&gt; quit
</code></pre>
<h3 id="common-interactive-commands"><a class="header" href="#common-interactive-commands">Common Interactive Commands</a></h3>
<pre><code>status                  - Show connection status
scan                    - Trigger network scan
scan_results            - Show scan results
list_networks           - List configured networks
select_network &lt;id&gt;     - Select network
enable_network &lt;id&gt;     - Enable network
disable_network &lt;id&gt;    - Disable network
remove_network &lt;id&gt;     - Remove network
add_network             - Add new network
set_network &lt;id&gt; &lt;var&gt; &lt;value&gt; - Set network parameter
save_config             - Save configuration
disconnect              - Disconnect from AP
reconnect               - Reconnect to AP
reassociate             - Force reassociation
terminate               - Terminate wpa_supplicant
quit                    - Exit wpa_cli
</code></pre>
<hr />
<h2 id="advanced-configuration-2"><a class="header" href="#advanced-configuration-2">Advanced Configuration</a></h2>
<h3 id="band-selection-24-ghz-vs-5-ghz"><a class="header" href="#band-selection-24-ghz-vs-5-ghz">Band Selection (2.4 GHz vs 5 GHz)</a></h3>
<pre><code class="language-conf">network={
    ssid="DualBandWiFi"
    psk="password"
    # Prefer 5 GHz
    freq_list=5180 5200 5220 5240 5260 5280 5300 5320
}
</code></pre>
<h3 id="power-saving"><a class="header" href="#power-saving">Power Saving</a></h3>
<pre><code class="language-conf"># Global setting
# 0 = CAM (Constantly Awake Mode)
# 1 = PS mode (default)
# 2 = PS mode with max power saving
power_save=1
</code></pre>
<h3 id="roaming-1"><a class="header" href="#roaming-1">Roaming</a></h3>
<pre><code class="language-conf">network={
    ssid="EnterpriseWiFi"
    psk="password"
    # Fast roaming (802.11r)
    key_mgmt=FT-PSK
    # Proactive key caching
    proactive_key_caching=1
    # BSS transition management
    bss_transition=1
}
</code></pre>
<h3 id="mac-address-randomization"><a class="header" href="#mac-address-randomization">MAC Address Randomization</a></h3>
<pre><code class="language-conf"># Per-network MAC randomization
network={
    ssid="PublicWiFi"
    key_mgmt=NONE
    mac_addr=1  # Random MAC per network
}

# Global setting
mac_addr=1
# 0 = Use permanent MAC
# 1 = Random MAC per network
# 2 = Random MAC per SSID
</code></pre>
<h3 id="ipv6"><a class="header" href="#ipv6">IPv6</a></h3>
<pre><code class="language-conf"># Disable IPv6 in wpa_supplicant
network={
    ssid="MyWiFi"
    psk="password"
    disable_ipv6=1
}
</code></pre>
<hr />
<h2 id="security-modes"><a class="header" href="#security-modes">Security Modes</a></h2>
<h3 id="wpa2-enterprise-eap-peapmschapv2"><a class="header" href="#wpa2-enterprise-eap-peapmschapv2">WPA2-Enterprise (EAP-PEAP/MSCHAPv2)</a></h3>
<pre><code class="language-conf">network={
    ssid="CorpWiFi"
    key_mgmt=WPA-EAP
    eap=PEAP
    identity="username@domain.com"
    password="userpassword"
    phase2="auth=MSCHAPV2"
    # Certificate verification
    ca_cert="/etc/ssl/certs/ca-bundle.crt"
    # Or skip verification (insecure!)
    # ca_cert="/etc/ssl/certs/ca-certificates.crt"
}
</code></pre>
<h3 id="wpa2-enterprise-eap-tls-with-certificates"><a class="header" href="#wpa2-enterprise-eap-tls-with-certificates">WPA2-Enterprise (EAP-TLS with Certificates)</a></h3>
<pre><code class="language-conf">network={
    ssid="SecureCorpWiFi"
    key_mgmt=WPA-EAP
    eap=TLS
    identity="user@company.com"
    # Client certificate
    client_cert="/etc/wpa_supplicant/client.crt"
    # Private key
    private_key="/etc/wpa_supplicant/client.key"
    # Private key password
    private_key_passwd="keypassword"
    # CA certificate
    ca_cert="/etc/wpa_supplicant/ca.crt"
}
</code></pre>
<h3 id="wpa2-enterprise-eap-ttlspap"><a class="header" href="#wpa2-enterprise-eap-ttlspap">WPA2-Enterprise (EAP-TTLS/PAP)</a></h3>
<pre><code class="language-conf">network={
    ssid="UniversityWiFi"
    key_mgmt=WPA-EAP
    eap=TTLS
    identity="student@university.edu"
    password="studentpass"
    phase2="auth=PAP"
    ca_cert="/etc/ssl/certs/ca-bundle.crt"
}
</code></pre>
<h3 id="eduroam-configuration"><a class="header" href="#eduroam-configuration">Eduroam Configuration</a></h3>
<pre><code class="language-conf">network={
    ssid="eduroam"
    key_mgmt=WPA-EAP
    eap=PEAP
    identity="username@institution.edu"
    password="password"
    phase2="auth=MSCHAPV2"
    ca_cert="/etc/ssl/certs/ca-certificates.crt"
}
</code></pre>
<hr />
<h2 id="enterprise-wifi-8021x"><a class="header" href="#enterprise-wifi-8021x">Enterprise WiFi (802.1X)</a></h2>
<h3 id="certificate-management-1"><a class="header" href="#certificate-management-1">Certificate Management</a></h3>
<pre><code class="language-bash"># Download CA certificate
wget https://your-ca.com/ca.crt -O /etc/wpa_supplicant/ca.crt

# Set permissions
sudo chmod 600 /etc/wpa_supplicant/ca.crt

# Convert certificate format if needed
openssl x509 -inform DER -in ca.der -out ca.pem
</code></pre>
<h3 id="anonymous-identity-privacy"><a class="header" href="#anonymous-identity-privacy">Anonymous Identity (Privacy)</a></h3>
<pre><code class="language-conf">network={
    ssid="CorpWiFi"
    key_mgmt=WPA-EAP
    eap=PEAP
    # Anonymous outer identity
    anonymous_identity="anonymous@company.com"
    # Real identity (inner)
    identity="realuser@company.com"
    password="password"
    phase2="auth=MSCHAPV2"
    ca_cert="/etc/wpa_supplicant/ca.crt"
}
</code></pre>
<h3 id="domain-suffix-matching"><a class="header" href="#domain-suffix-matching">Domain Suffix Matching</a></h3>
<pre><code class="language-conf">network={
    ssid="SecureWiFi"
    key_mgmt=WPA-EAP
    eap=PEAP
    identity="user@company.com"
    password="password"
    phase2="auth=MSCHAPV2"
    # Verify server domain
    domain_suffix_match="radius.company.com"
    ca_cert="/etc/wpa_supplicant/ca.crt"
}
</code></pre>
<hr />
<h2 id="p2p-wifi-direct"><a class="header" href="#p2p-wifi-direct">P2P WiFi Direct</a></h2>
<h3 id="enable-wifi-direct"><a class="header" href="#enable-wifi-direct">Enable WiFi Direct</a></h3>
<pre><code class="language-conf"># Global setting
ctrl_interface=/var/run/wpa_supplicant
p2p_disabled=0
device_name=MyDevice
device_type=1-0050F204-1
</code></pre>
<h3 id="p2p-commands"><a class="header" href="#p2p-commands">P2P Commands</a></h3>
<pre><code class="language-bash"># Start P2P mode
wpa_cli -i wlan0 p2p_find

# Stop search
wpa_cli -i wlan0 p2p_stop_find

# Connect to peer
wpa_cli -i wlan0 p2p_connect &lt;peer_mac&gt; pbc

# Group formation
wpa_cli -i wlan0 p2p_group_add

# Show peers
wpa_cli -i wlan0 p2p_peers
</code></pre>
<hr />
<h2 id="troubleshooting-13"><a class="header" href="#troubleshooting-13">Troubleshooting</a></h2>
<h3 id="check-status"><a class="header" href="#check-status">Check Status</a></h3>
<pre><code class="language-bash"># Interface status
ip link show wlan0

# wpa_supplicant status
wpa_cli -i wlan0 status

# Connection state
wpa_cli -i wlan0 status | grep wpa_state
# COMPLETED = connected
# SCANNING = scanning for networks
# ASSOCIATING = connecting
# DISCONNECTED = not connected
</code></pre>
<h3 id="debug-logging"><a class="header" href="#debug-logging">Debug Logging</a></h3>
<pre><code class="language-bash"># Run in foreground with debug
sudo killall wpa_supplicant
sudo wpa_supplicant -i wlan0 -c /etc/wpa_supplicant/wpa_supplicant.conf -dd

# Check system logs
sudo journalctl -u wpa_supplicant@wlan0 -f

# dmesg for driver issues
dmesg | grep -i wifi
dmesg | grep -i wlan
</code></pre>
<h3 id="common-issues-14"><a class="header" href="#common-issues-14">Common Issues</a></h3>
<p><strong>Authentication failure:</strong></p>
<pre><code class="language-bash"># Check password
wpa_passphrase "SSID" "password"

# Verify security mode
wpa_cli -i wlan0 scan_results
# Look for [WPA2-PSK-CCMP], [WPA3-SAE], etc.

# Check logs
sudo journalctl -u wpa_supplicant@wlan0 | grep -i "auth\|fail"
</code></pre>
<p><strong>Cannot scan networks:</strong></p>
<pre><code class="language-bash"># Check if interface is up
sudo ip link set wlan0 up

# Check rfkill
rfkill list
sudo rfkill unblock wifi

# Manual scan
sudo iw dev wlan0 scan | grep SSID
</code></pre>
<p><strong>Frequent disconnections:</strong></p>
<pre><code class="language-bash"># Check signal strength
watch -n 1 'iw dev wlan0 link'

# Disable power management
sudo iwconfig wlan0 power off

# Check logs for errors
sudo journalctl -u wpa_supplicant@wlan0 --since "10 minutes ago"
</code></pre>
<p><strong>Driver issues:</strong></p>
<pre><code class="language-bash"># Check driver
lspci -k | grep -A 3 -i network
# Or for USB
lsusb
dmesg | grep -i firmware

# Reload driver
sudo modprobe -r &lt;driver_name&gt;
sudo modprobe &lt;driver_name&gt;
</code></pre>
<hr />
<h2 id="integration-with-systemd"><a class="header" href="#integration-with-systemd">Integration with systemd</a></h2>
<h3 id="systemd-service"><a class="header" href="#systemd-service">systemd Service</a></h3>
<p><strong>Per-interface service:</strong></p>
<pre><code class="language-bash"># Start service
sudo systemctl start wpa_supplicant@wlan0

# Enable on boot
sudo systemctl enable wpa_supplicant@wlan0

# Status
sudo systemctl status wpa_supplicant@wlan0

# Restart
sudo systemctl restart wpa_supplicant@wlan0
</code></pre>
<p><strong>Service file:</strong> <code>/lib/systemd/system/wpa_supplicant@.service</code></p>
<pre><code class="language-ini">[Unit]
Description=WPA supplicant daemon (interface-specific version)
Requires=sys-subsystem-net-devices-%i.device
After=sys-subsystem-net-devices-%i.device
Before=network.target
Wants=network.target

[Service]
Type=simple
ExecStart=/sbin/wpa_supplicant -c/etc/wpa_supplicant/wpa_supplicant-%I.conf -i%I

[Install]
WantedBy=multi-user.target
</code></pre>
<h3 id="networkd-integration"><a class="header" href="#networkd-integration">networkd Integration</a></h3>
<p><strong><code>/etc/systemd/network/25-wireless.network</code>:</strong></p>
<pre><code class="language-ini">[Match]
Name=wlan0

[Network]
DHCP=yes
</code></pre>
<p><strong>Start services:</strong></p>
<pre><code class="language-bash">sudo systemctl enable systemd-networkd
sudo systemctl enable wpa_supplicant@wlan0
sudo systemctl start systemd-networkd
sudo systemctl start wpa_supplicant@wlan0
</code></pre>
<hr />
<h2 id="best-practices-54"><a class="header" href="#best-practices-54">Best Practices</a></h2>
<h3 id="security-3"><a class="header" href="#security-3">Security</a></h3>
<ol>
<li><strong>Use encrypted PSK:</strong></li>
</ol>
<pre><code class="language-bash"># Generate PSK hash instead of plaintext
wpa_passphrase "SSID" "password" | sudo tee -a /etc/wpa_supplicant/wpa_supplicant.conf
</code></pre>
<ol start="2">
<li><strong>Secure configuration file:</strong></li>
</ol>
<pre><code class="language-bash">sudo chmod 600 /etc/wpa_supplicant/wpa_supplicant.conf
</code></pre>
<ol start="3">
<li><strong>Use WPA3 when available:</strong></li>
</ol>
<pre><code class="language-conf">network={
    ssid="MyWiFi"
    psk="password"
    key_mgmt=SAE WPA-PSK  # Try WPA3, fall back to WPA2
    ieee80211w=1  # Optional PMF
}
</code></pre>
<ol start="4">
<li><strong>Verify certificates for Enterprise:</strong></li>
</ol>
<pre><code class="language-conf">network={
    ssid="CorpWiFi"
    key_mgmt=WPA-EAP
    ca_cert="/path/to/ca.crt"
    domain_suffix_match="radius.company.com"
}
</code></pre>
<h3 id="performance-3"><a class="header" href="#performance-3">Performance</a></h3>
<ol>
<li><strong>Disable unnecessary features:</strong></li>
</ol>
<pre><code class="language-conf"># Disable P2P if not needed
p2p_disabled=1

# Disable WPS
wps_disabled=1
</code></pre>
<ol start="2">
<li><strong>Optimize power saving:</strong></li>
</ol>
<pre><code class="language-conf"># For performance (disable power save)
power_save=0

# For battery (enable power save)
power_save=2
</code></pre>
<ol start="3">
<li><strong>Fast roaming:</strong></li>
</ol>
<pre><code class="language-conf">network={
    ssid="EnterpriseWiFi"
    key_mgmt=FT-PSK
    proactive_key_caching=1
}
</code></pre>
<h3 id="reliability"><a class="header" href="#reliability">Reliability</a></h3>
<ol>
<li><strong>Network priority:</strong></li>
</ol>
<pre><code class="language-conf"># Higher priority = preferred
network={
    ssid="PrimaryWiFi"
    priority=10
}
network={
    ssid="BackupWiFi"
    priority=5
}
</code></pre>
<ol start="2">
<li><strong>Automatic reconnection:</strong></li>
</ol>
<pre><code class="language-bash"># systemd handles this automatically
sudo systemctl enable wpa_supplicant@wlan0
</code></pre>
<ol start="3">
<li><strong>Monitoring:</strong></li>
</ol>
<pre><code class="language-bash"># Watch connection status
watch -n 2 'wpa_cli -i wlan0 status | grep -E "wpa_state|ssid|ip_address"'
</code></pre>
<hr />
<h2 id="summary-2"><a class="header" href="#summary-2">Summary</a></h2>
<p><strong>wpa_supplicant</strong> is the standard WiFi client for Linux:</p>
<p><strong>Basic workflow:</strong></p>
<ol>
<li>Configure networks in <code>/etc/wpa_supplicant/wpa_supplicant.conf</code></li>
<li>Start: <code>sudo wpa_supplicant -B -i wlan0 -c /etc/wpa_supplicant/wpa_supplicant.conf</code></li>
<li>Manage: <code>wpa_cli -i wlan0 &lt;command&gt;</code></li>
<li>Get IP: <code>sudo dhclient wlan0</code></li>
</ol>
<p><strong>Key commands:</strong></p>
<ul>
<li><code>wpa_passphrase</code>: Generate PSK hash</li>
<li><code>wpa_supplicant</code>: Main daemon</li>
<li><code>wpa_cli</code>: Control interface</li>
<li><code>systemctl</code>: Manage service</li>
</ul>
<p><strong>Common tasks:</strong></p>
<ul>
<li>Connect to WPA2: Set <code>ssid</code> and <code>psk</code></li>
<li>Enterprise WiFi: Configure EAP method</li>
<li>Scan networks: <code>wpa_cli scan &amp;&amp; wpa_cli scan_results</code></li>
<li>Debug: Run with <code>-dd</code> flag</li>
</ul>
<p><strong>Resources:</strong></p>
<ul>
<li><a href="https://w1.fi/wpa_supplicant/">wpa_supplicant Documentation</a></li>
<li><a href="https://wiki.archlinux.org/title/Wpa_supplicant">ArchWiki: wpa_supplicant</a></li>
<li><a href="https://help.ubuntu.com/community/WifiDocs">Ubuntu WiFi Guide</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="hostapd"><a class="header" href="#hostapd">hostapd</a></h1>
<p>A comprehensive guide to hostapd, the IEEE 802.11 access point and authentication server for creating WiFi access points on Linux.</p>
<h2 id="table-of-contents-34"><a class="header" href="#table-of-contents-34">Table of Contents</a></h2>
<ul>
<li><a href="tools/hostapd.html#overview">Overview</a></li>
<li><a href="tools/hostapd.html#installation">Installation</a></li>
<li><a href="tools/hostapd.html#basic-configuration">Basic Configuration</a></li>
<li><a href="tools/hostapd.html#running-hostapd">Running hostapd</a></li>
<li><a href="tools/hostapd.html#security-configurations">Security Configurations</a></li>
<li><a href="tools/hostapd.html#advanced-features">Advanced Features</a></li>
<li><a href="tools/hostapd.html#bridge-mode">Bridge Mode</a></li>
<li><a href="tools/hostapd.html#vlan-support">VLAN Support</a></li>
<li><a href="tools/hostapd.html#radius-authentication">RADIUS Authentication</a></li>
<li><a href="tools/hostapd.html#80211nacax-configuration">802.11n/ac/ax Configuration</a></li>
<li><a href="tools/hostapd.html#monitoring-and-management">Monitoring and Management</a></li>
<li><a href="tools/hostapd.html#troubleshooting">Troubleshooting</a></li>
<li><a href="tools/hostapd.html#integration-with-systemd">Integration with systemd</a></li>
<li><a href="tools/hostapd.html#best-practices">Best Practices</a></li>
</ul>
<hr />
<h2 id="overview-61"><a class="header" href="#overview-61">Overview</a></h2>
<p><strong>hostapd</strong> (host access point daemon) is a user-space daemon for access point and authentication servers. It implements IEEE 802.11 access point management, IEEE 802.1X/WPA/WPA2/WPA3/EAP authenticators, and RADIUS authentication server.</p>
<h3 id="key-features-8"><a class="header" href="#key-features-8">Key Features</a></h3>
<ul>
<li>WiFi Access Point (AP) mode</li>
<li>WPA/WPA2/WPA3-Personal and Enterprise</li>
<li>Multiple SSIDs (up to 8 per radio)</li>
<li>VLAN tagging</li>
<li>802.11n/ac/ax (WiFi 4/5/6)</li>
<li>RADIUS authentication</li>
<li>WPS (WiFi Protected Setup)</li>
<li>Hotspot 2.0</li>
<li>Dynamic VLAN assignment</li>
</ul>
<h3 id="use-cases-2"><a class="header" href="#use-cases-2">Use Cases</a></h3>
<ul>
<li>Create WiFi hotspot on Linux</li>
<li>Home router/AP</li>
<li>Enterprise wireless access point</li>
<li>Captive portal</li>
<li>Guest WiFi network</li>
<li>Testing and development</li>
</ul>
<hr />
<h2 id="installation-14"><a class="header" href="#installation-14">Installation</a></h2>
<h3 id="debianubuntu-1"><a class="header" href="#debianubuntu-1">Debian/Ubuntu</a></h3>
<pre><code class="language-bash">sudo apt-get update
sudo apt-get install hostapd

# Verify installation
hostapd -v
</code></pre>
<h3 id="fedorarhelcentos-1"><a class="header" href="#fedorarhelcentos-1">Fedora/RHEL/CentOS</a></h3>
<pre><code class="language-bash">sudo dnf install hostapd

# Or for older systems
sudo yum install hostapd
</code></pre>
<h3 id="arch-linux-1"><a class="header" href="#arch-linux-1">Arch Linux</a></h3>
<pre><code class="language-bash">sudo pacman -S hostapd
</code></pre>
<h3 id="build-from-source-1"><a class="header" href="#build-from-source-1">Build from Source</a></h3>
<pre><code class="language-bash"># Download
git clone git://w1.fi/srv/git/hostap.git
cd hostap/hostapd

# Configure
cp defconfig .config
# Edit .config to enable features

# Build
make

# Install
sudo make install
</code></pre>
<hr />
<h2 id="basic-configuration-3"><a class="header" href="#basic-configuration-3">Basic Configuration</a></h2>
<h3 id="minimal-configuration"><a class="header" href="#minimal-configuration">Minimal Configuration</a></h3>
<p><strong>File:</strong> <code>/etc/hostapd/hostapd.conf</code></p>
<pre><code class="language-conf"># Interface to use
interface=wlan0

# Driver (nl80211 is modern standard)
driver=nl80211

# WiFi network name
ssid=MyAccessPoint

# WiFi mode (a = 5GHz, g = 2.4GHz)
hw_mode=g

# WiFi channel
channel=6

# WPA2 settings
wpa=2
wpa_passphrase=MySecurePassword123
wpa_key_mgmt=WPA-PSK
wpa_pairwise=CCMP
</code></pre>
<h3 id="open-network-no-security-1"><a class="header" href="#open-network-no-security-1">Open Network (No Security)</a></h3>
<pre><code class="language-conf">interface=wlan0
driver=nl80211
ssid=OpenWiFi
hw_mode=g
channel=6
# No WPA settings = open network
</code></pre>
<h3 id="basic-wpa2-access-point"><a class="header" href="#basic-wpa2-access-point">Basic WPA2 Access Point</a></h3>
<pre><code class="language-conf"># Interface configuration
interface=wlan0
driver=nl80211

# SSID configuration
ssid=MyWiFi
utf8_ssid=1

# Hardware mode
hw_mode=g
channel=6

# IEEE 802.11n
ieee80211n=1
wmm_enabled=1

# Security: WPA2-Personal
auth_algs=1
wpa=2
wpa_key_mgmt=WPA-PSK
rsn_pairwise=CCMP
wpa_passphrase=SecurePassword123

# Logging
logger_syslog=-1
logger_syslog_level=2
logger_stdout=-1
logger_stdout_level=2

# Country code
country_code=US

# Max clients
max_num_sta=20
</code></pre>
<hr />
<h2 id="running-hostapd"><a class="header" href="#running-hostapd">Running hostapd</a></h2>
<h3 id="manual-start"><a class="header" href="#manual-start">Manual Start</a></h3>
<pre><code class="language-bash"># Check configuration syntax
sudo hostapd -t /etc/hostapd/hostapd.conf

# Run in foreground (for testing)
sudo hostapd /etc/hostapd/hostapd.conf

# Run in background
sudo hostapd -B /etc/hostapd/hostapd.conf

# With debug output
sudo hostapd -d /etc/hostapd/hostapd.conf
sudo hostapd -dd /etc/hostapd/hostapd.conf  # More verbose
</code></pre>
<h3 id="complete-setup-script"><a class="header" href="#complete-setup-script">Complete Setup Script</a></h3>
<pre><code class="language-bash">#!/bin/bash
# setup-ap.sh

INTERFACE=wlan0
SSID="MyAccessPoint"
PASSWORD="MyPassword123"
CHANNEL=6

# Stop existing processes
sudo killall hostapd 2&gt;/dev/null
sudo killall dnsmasq 2&gt;/dev/null

# Configure interface
sudo ip link set $INTERFACE down
sudo ip addr flush dev $INTERFACE
sudo ip link set $INTERFACE up
sudo ip addr add 192.168.50.1/24 dev $INTERFACE

# Create hostapd config
cat &gt; /tmp/hostapd.conf &lt;&lt; EOF
interface=$INTERFACE
driver=nl80211
ssid=$SSID
hw_mode=g
channel=$CHANNEL
wmm_enabled=1
auth_algs=1
wpa=2
wpa_key_mgmt=WPA-PSK
wpa_pairwise=CCMP
wpa_passphrase=$PASSWORD
EOF

# Start hostapd
sudo hostapd -B /tmp/hostapd.conf

# Configure DHCP (dnsmasq)
sudo dnsmasq -C /dev/null \
    --interface=$INTERFACE \
    --dhcp-range=192.168.50.10,192.168.50.100,12h \
    --no-daemon &amp;

# Enable NAT
sudo sysctl net.ipv4.ip_forward=1
sudo iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE
sudo iptables -A FORWARD -i $INTERFACE -o eth0 -j ACCEPT
sudo iptables -A FORWARD -i eth0 -o $INTERFACE -m state --state RELATED,ESTABLISHED -j ACCEPT

echo "Access Point started: SSID=$SSID"
</code></pre>
<hr />
<h2 id="security-configurations"><a class="header" href="#security-configurations">Security Configurations</a></h2>
<h3 id="wpa2-personal-psk"><a class="header" href="#wpa2-personal-psk">WPA2-Personal (PSK)</a></h3>
<pre><code class="language-conf">interface=wlan0
ssid=SecureWiFi

# WPA2 with AES-CCMP
wpa=2
wpa_key_mgmt=WPA-PSK
rsn_pairwise=CCMP
wpa_passphrase=VerySecurePassword123

# Optional: require PMF (Protected Management Frames)
ieee80211w=1
</code></pre>
<h3 id="wpa3-personal-sae-1"><a class="header" href="#wpa3-personal-sae-1">WPA3-Personal (SAE)</a></h3>
<pre><code class="language-conf">interface=wlan0
ssid=WPA3WiFi

# WPA3-Personal (SAE)
wpa=2
wpa_key_mgmt=SAE
rsn_pairwise=CCMP
sae_password=SecureWPA3Password

# PMF is required for WPA3
ieee80211w=2

# SAE-specific settings
sae_pwe=2
sae_groups=19 20 21
</code></pre>
<h3 id="wpa2wpa3-transition-mode"><a class="header" href="#wpa2wpa3-transition-mode">WPA2/WPA3 Transition Mode</a></h3>
<pre><code class="language-conf">interface=wlan0
ssid=TransitionWiFi

# Both WPA2 and WPA3
wpa=2
wpa_key_mgmt=WPA-PSK SAE
rsn_pairwise=CCMP

# For WPA2
wpa_passphrase=Password123

# For WPA3
sae_password=Password123

# PMF optional (required for WPA3 clients)
ieee80211w=1
</code></pre>
<h3 id="wpa2-enterprise-8021x"><a class="header" href="#wpa2-enterprise-8021x">WPA2-Enterprise (802.1X)</a></h3>
<pre><code class="language-conf">interface=wlan0
ssid=EnterpriseWiFi

# WPA2-Enterprise
wpa=2
wpa_key_mgmt=WPA-EAP
rsn_pairwise=CCMP

# IEEE 802.1X
ieee8021x=1

# RADIUS server configuration
auth_server_addr=192.168.1.10
auth_server_port=1812
auth_server_shared_secret=radiussecret

# Optional: Accounting server
acct_server_addr=192.168.1.10
acct_server_port=1813
acct_server_shared_secret=radiussecret

# EAP configuration
eap_server=0
eapol_key_index_workaround=0
</code></pre>
<h3 id="hidden-ssid"><a class="header" href="#hidden-ssid">Hidden SSID</a></h3>
<pre><code class="language-conf">interface=wlan0
ssid=HiddenNetwork
# Hide SSID in beacons
ignore_broadcast_ssid=1

wpa=2
wpa_passphrase=password
</code></pre>
<h3 id="mac-address-filtering-1"><a class="header" href="#mac-address-filtering-1">MAC Address Filtering</a></h3>
<pre><code class="language-conf">interface=wlan0
ssid=FilteredWiFi

# MAC address ACL
macaddr_acl=1
# 0 = accept unless in deny list
# 1 = deny unless in accept list
# 2 = use external RADIUS

# Accept list
accept_mac_file=/etc/hostapd/accept.mac

# Deny list (if macaddr_acl=0)
deny_mac_file=/etc/hostapd/deny.mac

wpa=2
wpa_passphrase=password
</code></pre>
<p><strong><code>/etc/hostapd/accept.mac</code>:</strong></p>
<pre><code>00:11:22:33:44:55
aa:bb:cc:dd:ee:ff
</code></pre>
<hr />
<h2 id="advanced-features-6"><a class="header" href="#advanced-features-6">Advanced Features</a></h2>
<h3 id="multiple-ssids-multi-bss"><a class="header" href="#multiple-ssids-multi-bss">Multiple SSIDs (Multi-BSS)</a></h3>
<p><strong>Main configuration</strong> <code>/etc/hostapd/hostapd.conf</code>:</p>
<pre><code class="language-conf"># Primary interface
interface=wlan0
driver=nl80211
ctrl_interface=/var/run/hostapd

# Channel configuration (shared by all BSS)
hw_mode=g
channel=6
ieee80211n=1

# Primary SSID
ssid=MainWiFi
wpa=2
wpa_passphrase=MainPassword

# Multiple BSSs
bss=wlan0_0
ssid=GuestWiFi
wpa=2
wpa_passphrase=GuestPassword
# Isolate guest clients
ap_isolate=1

bss=wlan0_1
ssid=IoTWiFi
wpa=2
wpa_passphrase=IoTPassword
</code></pre>
<h3 id="client-isolation"><a class="header" href="#client-isolation">Client Isolation</a></h3>
<pre><code class="language-conf">interface=wlan0
ssid=IsolatedWiFi

# Prevent clients from communicating with each other
ap_isolate=1

wpa=2
wpa_passphrase=password
</code></pre>
<h3 id="5-ghz-configuration"><a class="header" href="#5-ghz-configuration">5 GHz Configuration</a></h3>
<pre><code class="language-conf">interface=wlan0
driver=nl80211

# 5 GHz band
hw_mode=a
channel=36

# Channel width
# HT40+ = 40 MHz (channels 36,40)
# VHT80 = 80 MHz
# VHT160 = 160 MHz
vht_oper_chwidth=1
vht_oper_centr_freq_seg0_idx=42

ssid=5GHz_WiFi
wpa=2
wpa_passphrase=password
</code></pre>
<h3 id="wps-wifi-protected-setup"><a class="header" href="#wps-wifi-protected-setup">WPS (WiFi Protected Setup)</a></h3>
<pre><code class="language-conf">interface=wlan0
ssid=WPS_WiFi

wpa=2
wpa_passphrase=password

# Enable WPS
wps_state=2
eap_server=1
# Device information
device_name=Linux_AP
manufacturer=OpenSource
model_name=hostapd
model_number=1.0
config_methods=push_button keypad

# UUID (generate with uuidgen)
uuid=12345678-9abc-def0-1234-56789abcdef0
</code></pre>
<p><strong>Trigger WPS:</strong></p>
<pre><code class="language-bash"># Push button
hostapd_cli wps_pbc

# PIN method
hostapd_cli wps_pin any 12345670
</code></pre>
<hr />
<h2 id="bridge-mode"><a class="header" href="#bridge-mode">Bridge Mode</a></h2>
<h3 id="bridge-configuration"><a class="header" href="#bridge-configuration">Bridge Configuration</a></h3>
<pre><code class="language-bash"># Create bridge
sudo ip link add name br0 type bridge
sudo ip link set br0 up

# Add Ethernet to bridge
sudo ip link set eth0 master br0

# Configure bridge IP
sudo ip addr add 192.168.1.1/24 dev br0
</code></pre>
<p><strong>hostapd.conf:</strong></p>
<pre><code class="language-conf">interface=wlan0
bridge=br0
driver=nl80211

ssid=BridgedWiFi
hw_mode=g
channel=6

wpa=2
wpa_passphrase=password
</code></pre>
<h3 id="complete-bridge-setup"><a class="header" href="#complete-bridge-setup">Complete Bridge Setup</a></h3>
<pre><code class="language-bash">#!/bin/bash
# bridge-ap.sh

WLAN=wlan0
ETH=eth0
BRIDGE=br0

# Create bridge
sudo ip link add name $BRIDGE type bridge
sudo ip link set $BRIDGE up

# Add Ethernet
sudo ip link set $ETH down
sudo ip addr flush dev $ETH
sudo ip link set $ETH master $BRIDGE
sudo ip link set $ETH up

# Configure bridge
sudo ip addr add 192.168.1.1/24 dev $BRIDGE

# hostapd config with bridge
cat &gt; /tmp/hostapd-bridge.conf &lt;&lt; EOF
interface=$WLAN
bridge=$BRIDGE
driver=nl80211
ssid=BridgedAP
hw_mode=g
channel=6
wpa=2
wpa_passphrase=password
EOF

# Start hostapd
sudo hostapd -B /tmp/hostapd-bridge.conf

# Start DHCP server on bridge
sudo dnsmasq --interface=$BRIDGE \
    --dhcp-range=192.168.1.100,192.168.1.200,12h
</code></pre>
<hr />
<h2 id="vlan-support"><a class="header" href="#vlan-support">VLAN Support</a></h2>
<h3 id="static-vlan-assignment"><a class="header" href="#static-vlan-assignment">Static VLAN Assignment</a></h3>
<p><strong>hostapd.conf:</strong></p>
<pre><code class="language-conf">interface=wlan0
ssid=MultiVLAN_WiFi

wpa=2
wpa_passphrase=password

# Enable dynamic VLAN
dynamic_vlan=1
vlan_file=/etc/hostapd/vlan.conf
</code></pre>
<p><strong><code>/etc/hostapd/vlan.conf</code>:</strong></p>
<pre><code># VLAN_ID  VLAN_IFNAME
1          wlan0.1
10         wlan0.10
20         wlan0.20
</code></pre>
<h3 id="vlan-with-radius"><a class="header" href="#vlan-with-radius">VLAN with RADIUS</a></h3>
<pre><code class="language-conf">interface=wlan0
ssid=Enterprise_VLAN

wpa=2
wpa_key_mgmt=WPA-EAP
ieee8021x=1

# RADIUS server
auth_server_addr=192.168.1.10
auth_server_port=1812
auth_server_shared_secret=secret

# Dynamic VLAN from RADIUS
dynamic_vlan=1
vlan_naming=1
</code></pre>
<hr />
<h2 id="radius-authentication"><a class="header" href="#radius-authentication">RADIUS Authentication</a></h2>
<h3 id="internal-eap-server"><a class="header" href="#internal-eap-server">Internal EAP Server</a></h3>
<pre><code class="language-conf">interface=wlan0
ssid=InternalEAP_WiFi

# Use hostapd's internal EAP server
ieee8021x=1
eap_server=1
eap_user_file=/etc/hostapd/hostapd.eap_user
ca_cert=/etc/hostapd/ca.pem
server_cert=/etc/hostapd/server.pem
private_key=/etc/hostapd/server-key.pem
private_key_passwd=keypassword

wpa=2
wpa_key_mgmt=WPA-EAP
rsn_pairwise=CCMP
</code></pre>
<p><strong><code>/etc/hostapd/hostapd.eap_user</code>:</strong></p>
<pre><code># Phase 1 authentication
* PEAP
"user1" MSCHAPV2 "password1" [2]
"user2" MSCHAPV2 "password2" [2]

# TLS
"client1" TLS
</code></pre>
<h3 id="external-radius-server"><a class="header" href="#external-radius-server">External RADIUS Server</a></h3>
<pre><code class="language-conf">interface=wlan0
ssid=RADIUS_WiFi

wpa=2
wpa_key_mgmt=WPA-EAP
ieee8021x=1

# Primary RADIUS server
auth_server_addr=192.168.1.10
auth_server_port=1812
auth_server_shared_secret=sharedsecret

# Backup RADIUS server
auth_server_addr=192.168.1.11
auth_server_port=1812
auth_server_shared_secret=sharedsecret

# Accounting
acct_server_addr=192.168.1.10
acct_server_port=1813
acct_server_shared_secret=sharedsecret

# Disable internal EAP
eap_server=0
</code></pre>
<hr />
<h2 id="80211nacax-configuration"><a class="header" href="#80211nacax-configuration">802.11n/ac/ax Configuration</a></h2>
<h3 id="80211n-wifi-4---24-ghz"><a class="header" href="#80211n-wifi-4---24-ghz">802.11n (WiFi 4) - 2.4 GHz</a></h3>
<pre><code class="language-conf">interface=wlan0
ssid=N_WiFi_2_4GHz

hw_mode=g
channel=6

# Enable 802.11n
ieee80211n=1
wmm_enabled=1

# HT capabilities
ht_capab=[HT40+][SHORT-GI-20][SHORT-GI-40][DSSS_CCK-40]

wpa=2
wpa_passphrase=password
</code></pre>
<h3 id="80211n-wifi-4---5-ghz"><a class="header" href="#80211n-wifi-4---5-ghz">802.11n (WiFi 4) - 5 GHz</a></h3>
<pre><code class="language-conf">interface=wlan0
ssid=N_WiFi_5GHz

hw_mode=a
channel=36

ieee80211n=1
wmm_enabled=1

# 40 MHz channel
ht_capab=[HT40+][SHORT-GI-20][SHORT-GI-40]

wpa=2
wpa_passphrase=password
</code></pre>
<h3 id="80211ac-wifi-5"><a class="header" href="#80211ac-wifi-5">802.11ac (WiFi 5)</a></h3>
<pre><code class="language-conf">interface=wlan0
ssid=AC_WiFi

hw_mode=a
channel=36

# 802.11n required
ieee80211n=1
ht_capab=[HT40+][SHORT-GI-20][SHORT-GI-40]

# 802.11ac
ieee80211ac=1
vht_capab=[MAX-MPDU-11454][SHORT-GI-80][TX-STBC-2BY1][RX-STBC-1]

# 80 MHz channel
vht_oper_chwidth=1
vht_oper_centr_freq_seg0_idx=42

wmm_enabled=1

wpa=2
wpa_passphrase=password
</code></pre>
<h3 id="80211ax-wifi-6"><a class="header" href="#80211ax-wifi-6">802.11ax (WiFi 6)</a></h3>
<pre><code class="language-conf">interface=wlan0
ssid=AX_WiFi

hw_mode=a
channel=36

# 802.11n
ieee80211n=1
ht_capab=[HT40+][SHORT-GI-20][SHORT-GI-40]

# 802.11ac
ieee80211ac=1
vht_oper_chwidth=1
vht_oper_centr_freq_seg0_idx=42

# 802.11ax
ieee80211ax=1
he_su_beamformer=1
he_su_beamformee=1
he_mu_beamformer=1

wmm_enabled=1

wpa=3  # WPA3
wpa_key_mgmt=SAE
sae_password=password
ieee80211w=2
</code></pre>
<hr />
<h2 id="monitoring-and-management-2"><a class="header" href="#monitoring-and-management-2">Monitoring and Management</a></h2>
<h3 id="hostapd_cli"><a class="header" href="#hostapd_cli">hostapd_cli</a></h3>
<pre><code class="language-bash"># Connect to running hostapd
hostapd_cli

# Or specify interface
hostapd_cli -i wlan0

# Get status
hostapd_cli status

# List connected stations
hostapd_cli all_sta

# Disconnect a station
hostapd_cli disassociate &lt;MAC&gt;

# Reload configuration
hostapd_cli reload

# Enable/disable
hostapd_cli disable
hostapd_cli enable
</code></pre>
<h3 id="monitor-connected-clients"><a class="header" href="#monitor-connected-clients">Monitor Connected Clients</a></h3>
<pre><code class="language-bash"># List all stations
hostapd_cli all_sta

# Detailed station info
hostapd_cli sta &lt;MAC_ADDRESS&gt;

# Example output:
# dot11RSNAStatsSTAAddress=aa:bb:cc:dd:ee:ff
# dot11RSNAStatsVersion=1
# dot11RSNAStatsSelectedPairwiseCipher=00-0f-ac-4
# dot11RSNAStatsTKIPLocalMICFailures=0
# flags=[AUTH][ASSOC][AUTHORIZED]
</code></pre>
<h3 id="signal-strength"><a class="header" href="#signal-strength">Signal Strength</a></h3>
<pre><code class="language-bash"># Show signal strength for connected clients
for mac in $(hostapd_cli all_sta | grep ^[0-9a-f] | cut -d' ' -f1); do
    echo "Station: $mac"
    hostapd_cli sta $mac | grep signal
done
</code></pre>
<hr />
<h2 id="troubleshooting-14"><a class="header" href="#troubleshooting-14">Troubleshooting</a></h2>
<h3 id="check-configuration"><a class="header" href="#check-configuration">Check Configuration</a></h3>
<pre><code class="language-bash"># Test configuration syntax
sudo hostapd -t /etc/hostapd/hostapd.conf

# Expected output: Configuration file: /etc/hostapd/hostapd.conf
</code></pre>
<h3 id="debug-mode-1"><a class="header" href="#debug-mode-1">Debug Mode</a></h3>
<pre><code class="language-bash"># Run in foreground with debug
sudo systemctl stop hostapd
sudo hostapd -d /etc/hostapd/hostapd.conf

# More verbose
sudo hostapd -dd /etc/hostapd/hostapd.conf
</code></pre>
<h3 id="common-issues-15"><a class="header" href="#common-issues-15">Common Issues</a></h3>
<p><strong>Cannot start AP - device busy:</strong></p>
<pre><code class="language-bash"># Check if NetworkManager is controlling interface
nmcli device status

# Unmanage interface
sudo nmcli device set wlan0 managed no

# Or disable NetworkManager for interface
# /etc/NetworkManager/NetworkManager.conf
[keyfile]
unmanaged-devices=mac:aa:bb:cc:dd:ee:ff

sudo systemctl restart NetworkManager
</code></pre>
<p><strong>Channel not available:</strong></p>
<pre><code class="language-bash"># Check supported channels
iw list | grep -A 20 "Frequencies:"

# Check regulatory domain
iw reg get

# Set country code
sudo iw reg set US

# Or in hostapd.conf
country_code=US
ieee80211d=1
</code></pre>
<p><strong>Interface doesn't support AP mode:</strong></p>
<pre><code class="language-bash"># Check supported modes
iw list | grep -A 10 "Supported interface modes:"

# Should show:
#   * AP
#   * AP/VLAN

# If not present, hardware doesn't support AP mode
</code></pre>
<p><strong>Authentication failures:</strong></p>
<pre><code class="language-bash"># Check logs
sudo journalctl -u hostapd -f

# Common causes:
# 1. Wrong password
# 2. Incompatible security settings
# 3. Client doesn't support WPA3
# 4. PMF issues

# Try WPA2 for compatibility
wpa=2
wpa_key_mgmt=WPA-PSK
</code></pre>
<p><strong>No DHCP addresses:</strong></p>
<pre><code class="language-bash"># Check if DHCP server is running
ps aux | grep dnsmasq

# Check interface has IP
ip addr show wlan0

# Test DHCP manually
sudo dnsmasq --no-daemon --interface=wlan0 \
    --dhcp-range=192.168.50.10,192.168.50.100,12h \
    --log-queries
</code></pre>
<hr />
<h2 id="integration-with-systemd-1"><a class="header" href="#integration-with-systemd-1">Integration with systemd</a></h2>
<h3 id="systemd-service-1"><a class="header" href="#systemd-service-1">systemd Service</a></h3>
<pre><code class="language-bash"># Enable and start
sudo systemctl unmask hostapd
sudo systemctl enable hostapd
sudo systemctl start hostapd

# Status
sudo systemctl status hostapd

# Logs
sudo journalctl -u hostapd -f
</code></pre>
<h3 id="custom-service-file"><a class="header" href="#custom-service-file">Custom Service File</a></h3>
<p><strong><code>/etc/systemd/system/hostapd.service</code>:</strong></p>
<pre><code class="language-ini">[Unit]
Description=Access point and authentication server
After=network.target

[Service]
Type=forking
PIDFile=/var/run/hostapd.pid
ExecStart=/usr/sbin/hostapd -B -P /var/run/hostapd.pid /etc/hostapd/hostapd.conf
ExecReload=/bin/kill -HUP $MAINPID
Restart=on-failure
RestartSec=5

[Install]
WantedBy=multi-user.target
</code></pre>
<h3 id="configuration-file-location"><a class="header" href="#configuration-file-location">Configuration File Location</a></h3>
<p><strong><code>/etc/default/hostapd</code>:</strong></p>
<pre><code class="language-bash">DAEMON_CONF="/etc/hostapd/hostapd.conf"
</code></pre>
<hr />
<h2 id="best-practices-55"><a class="header" href="#best-practices-55">Best Practices</a></h2>
<h3 id="security-4"><a class="header" href="#security-4">Security</a></h3>
<ol>
<li><strong>Use WPA3 when possible:</strong></li>
</ol>
<pre><code class="language-conf">wpa=2
wpa_key_mgmt=SAE
ieee80211w=2
</code></pre>
<ol start="2">
<li><strong>Strong passwords:</strong></li>
</ol>
<pre><code class="language-bash"># Minimum 12 characters
wpa_passphrase=MyVerySecurePassword123!
</code></pre>
<ol start="3">
<li><strong>Disable WPS in production:</strong></li>
</ol>
<pre><code class="language-conf">wps_state=0
</code></pre>
<ol start="4">
<li><strong>Enable PMF:</strong></li>
</ol>
<pre><code class="language-conf">ieee80211w=1  # Optional
# or
ieee80211w=2  # Required (WPA3)
</code></pre>
<ol start="5">
<li><strong>Guest network isolation:</strong></li>
</ol>
<pre><code class="language-conf">bss=wlan0_0
ssid=Guest
ap_isolate=1
</code></pre>
<h3 id="performance-4"><a class="header" href="#performance-4">Performance</a></h3>
<ol>
<li><strong>Use 5 GHz for better performance:</strong></li>
</ol>
<pre><code class="language-conf">hw_mode=a
channel=36
</code></pre>
<ol start="2">
<li><strong>Enable 802.11n/ac:</strong></li>
</ol>
<pre><code class="language-conf">ieee80211n=1
ieee80211ac=1
wmm_enabled=1
</code></pre>
<ol start="3">
<li><strong>Choose non-overlapping channels:</strong></li>
</ol>
<pre><code>2.4 GHz: 1, 6, 11
5 GHz: Many options (36, 40, 44, 48...)
</code></pre>
<ol start="4">
<li><strong>Limit max clients:</strong></li>
</ol>
<pre><code class="language-conf">max_num_sta=50
</code></pre>
<h3 id="reliability-1"><a class="header" href="#reliability-1">Reliability</a></h3>
<ol>
<li><strong>Set country code:</strong></li>
</ol>
<pre><code class="language-conf">country_code=US
ieee80211d=1
ieee80211h=1
</code></pre>
<ol start="2">
<li><strong>Enable logging:</strong></li>
</ol>
<pre><code class="language-conf">logger_syslog=-1
logger_syslog_level=2
</code></pre>
<ol start="3">
<li><strong>Automatic restart:</strong></li>
</ol>
<pre><code class="language-bash">sudo systemctl enable hostapd
</code></pre>
<hr />
<h2 id="summary-3"><a class="header" href="#summary-3">Summary</a></h2>
<p><strong>hostapd</strong> creates WiFi access points on Linux:</p>
<p><strong>Basic workflow:</strong></p>
<ol>
<li>Configure <code>/etc/hostapd/hostapd.conf</code></li>
<li>Start: <code>sudo hostapd /etc/hostapd/hostapd.conf</code></li>
<li>Configure DHCP server (dnsmasq)</li>
<li>Enable IP forwarding and NAT (for internet sharing)</li>
</ol>
<p><strong>Minimal config:</strong></p>
<pre><code class="language-conf">interface=wlan0
ssid=MyWiFi
channel=6
wpa=2
wpa_passphrase=password
</code></pre>
<p><strong>Essential commands:</strong></p>
<ul>
<li><code>hostapd -t</code>: Test configuration</li>
<li><code>hostapd_cli</code>: Control running AP</li>
<li><code>systemctl start hostapd</code>: Start service</li>
</ul>
<p><strong>Common tasks:</strong></p>
<ul>
<li>WPA2 AP: Configure <code>wpa=2</code> and <code>wpa_passphrase</code></li>
<li>WPA3 AP: Use <code>key_mgmt=SAE</code> and <code>ieee80211w=2</code></li>
<li>Guest network: Use multi-BSS with <code>ap_isolate=1</code></li>
<li>Bridge mode: Set <code>bridge=br0</code></li>
</ul>
<p><strong>Resources:</strong></p>
<ul>
<li><a href="https://w1.fi/hostapd/">hostapd Documentation</a></li>
<li><a href="https://wireless.wiki.kernel.org/">Linux Wireless</a></li>
<li><a href="https://wiki.archlinux.org/title/Software_access_point">ArchWiki: Software access point</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="embedded-systems"><a class="header" href="#embedded-systems">Embedded Systems</a></h1>
<p>Comprehensive guide to embedded systems development, microcontrollers, and hardware interfacing.</p>
<h2 id="table-of-contents-35"><a class="header" href="#table-of-contents-35">Table of Contents</a></h2>
<ol>
<li><a href="embedded/index.html#introduction">Introduction</a></li>
<li><a href="embedded/index.html#development-platforms">Development Platforms</a></li>
<li><a href="embedded/index.html#core-concepts">Core Concepts</a></li>
<li><a href="embedded/index.html#communication-protocols">Communication Protocols</a></li>
<li><a href="embedded/index.html#peripheral-interfaces">Peripheral Interfaces</a></li>
<li><a href="embedded/index.html#getting-started">Getting Started</a></li>
</ol>
<h2 id="introduction-15"><a class="header" href="#introduction-15">Introduction</a></h2>
<p>Embedded systems are specialized computing systems designed to perform dedicated functions within larger mechanical or electrical systems. They combine hardware and software to control devices and interact with the physical world.</p>
<h3 id="key-characteristics-1"><a class="header" href="#key-characteristics-1">Key Characteristics</a></h3>
<ul>
<li><strong>Real-time Operation</strong>: Deterministic response to events</li>
<li><strong>Resource Constraints</strong>: Limited memory, processing power, and energy</li>
<li><strong>Reliability</strong>: Must operate continuously for extended periods</li>
<li><strong>Hardware Integration</strong>: Direct interaction with sensors and actuators</li>
<li><strong>Application-Specific</strong>: Optimized for particular tasks</li>
</ul>
<h3 id="architecture-overview"><a class="header" href="#architecture-overview">Architecture Overview</a></h3>
<pre><code>┌─────────────────────────────────────────┐
│         Embedded System                  │
├─────────────────────────────────────────┤
│  Application Layer                       │
│  ├─ User Code                           │
│  └─ Libraries &amp; Frameworks              │
├─────────────────────────────────────────┤
│  HAL/Drivers                            │
│  ├─ Peripheral Drivers                  │
│  └─ Hardware Abstraction Layer          │
├─────────────────────────────────────────┤
│  Microcontroller/Processor              │
│  ├─ CPU Core (ARM, AVR, RISC-V)        │
│  ├─ Memory (Flash, RAM, EEPROM)        │
│  ├─ Peripherals (GPIO, UART, SPI...)   │
│  └─ Clock &amp; Power Management            │
├─────────────────────────────────────────┤
│  Hardware                               │
│  ├─ Sensors                             │
│  ├─ Actuators                           │
│  └─ External Interfaces                 │
└─────────────────────────────────────────┘
</code></pre>
<h2 id="development-platforms"><a class="header" href="#development-platforms">Development Platforms</a></h2>
<h3 id="microcontroller-platforms"><a class="header" href="#microcontroller-platforms">Microcontroller Platforms</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Platform</th><th>Processor</th><th>Clock</th><th>Memory</th><th>Use Cases</th></tr></thead><tbody>
<tr><td><strong><a href="embedded/arduino.html">Arduino</a></strong></td><td>AVR/ARM</td><td>16-84 MHz</td><td>2KB-256KB RAM</td><td>Prototyping, education, hobbyist projects</td></tr>
<tr><td><strong><a href="embedded/esp32.html">ESP32</a></strong></td><td>Xtensa/RISC-V</td><td>160-240 MHz</td><td>520KB RAM</td><td>IoT, WiFi/BLE projects</td></tr>
<tr><td><strong><a href="embedded/stm32.html">STM32</a></strong></td><td>ARM Cortex-M</td><td>48-550 MHz</td><td>32KB-2MB RAM</td><td>Professional, industrial applications</td></tr>
<tr><td><strong><a href="embedded/avr.html">AVR</a></strong></td><td>AVR</td><td>1-20 MHz</td><td>512B-16KB RAM</td><td>Low-power, bare-metal programming</td></tr>
<tr><td><strong><a href="embedded/raspberry_pi.html">Raspberry Pi</a></strong></td><td>ARM Cortex-A</td><td>700MHz-2.4GHz</td><td>512MB-8GB RAM</td><td>Linux-based, complex applications</td></tr>
</tbody></table>
</div>
<h3 id="comparison-matrix-1"><a class="header" href="#comparison-matrix-1">Comparison Matrix</a></h3>
<pre><code>Complexity/Capability
    ^
    |
RPi |  ┌──────────┐
    |  │          │
STM32| │          │    ┌──────┐
    |  │          │    │      │
ESP32|  │          │    │      │  ┌─────┐
    |  │          │    │      │  │     │
ARD  |  │          │    │      │  │     │  ┌────┐
    |  │          │    │      │  │     │  │    │
AVR  |  │          │    │      │  │     │  │    │
    |  └──────────┴────┴──────┴──┴─────┴──┴────┘
    +──────────────────────────────────────────&gt; Cost
       Low                                  High
</code></pre>
<h2 id="core-concepts-4"><a class="header" href="#core-concepts-4">Core Concepts</a></h2>
<h3 id="memory-architecture"><a class="header" href="#memory-architecture">Memory Architecture</a></h3>
<h4 id="flash-memory-program-storage"><a class="header" href="#flash-memory-program-storage">Flash Memory (Program Storage)</a></h4>
<ul>
<li>Stores program code and constant data</li>
<li>Non-volatile (persists without power)</li>
<li>Typically 8KB to several MB</li>
<li>Limited write cycles (10K-100K)</li>
</ul>
<h4 id="sram-runtime-memory"><a class="header" href="#sram-runtime-memory">SRAM (Runtime Memory)</a></h4>
<ul>
<li>Stores variables and stack during execution</li>
<li>Volatile (lost when power removed)</li>
<li>Fast access, limited size</li>
<li>Critical resource in embedded systems</li>
</ul>
<h4 id="eeprom-persistent-data"><a class="header" href="#eeprom-persistent-data">EEPROM (Persistent Data)</a></h4>
<ul>
<li>Stores configuration and calibration data</li>
<li>Non-volatile, byte-addressable</li>
<li>Limited write cycles but higher than Flash</li>
<li>Slower than SRAM</li>
</ul>
<pre><code>Memory Map Example (ATmega328P):
┌────────────────┐ 0x0000
│  Flash (32KB)  │
│  Program Code  │
├────────────────┤ 0x7FFF
│  SRAM (2KB)    │
│  Variables     │
│  Stack         │
├────────────────┤ 0x08FF
│  EEPROM (1KB)  │
│  Persistent    │
└────────────────┘ 0x03FF
</code></pre>
<h3 id="power-management-5"><a class="header" href="#power-management-5">Power Management</a></h3>
<h4 id="operating-modes"><a class="header" href="#operating-modes">Operating Modes</a></h4>
<ol>
<li><strong>Active Mode</strong>: Full operation, highest power consumption</li>
<li><strong>Idle Mode</strong>: CPU stopped, peripherals running</li>
<li><strong>Sleep Mode</strong>: Most peripherals disabled</li>
<li><strong>Deep Sleep</strong>: Minimal power, wake on interrupt only</li>
</ol>
<h4 id="power-saving-techniques"><a class="header" href="#power-saving-techniques">Power Saving Techniques</a></h4>
<pre><code class="language-c">// Example: AVR Sleep Mode
#include &lt;avr/sleep.h&gt;
#include &lt;avr/power.h&gt;

void enterSleepMode() {
    set_sleep_mode(SLEEP_MODE_PWR_DOWN);
    sleep_enable();
    
    // Disable unnecessary peripherals
    power_adc_disable();
    power_spi_disable();
    power_timer0_disable();
    
    sleep_mode();  // Enter sleep
    
    // Wake up here after interrupt
    sleep_disable();
    
    // Re-enable peripherals
    power_all_enable();
}
</code></pre>
<h3 id="interrupt-driven-programming"><a class="header" href="#interrupt-driven-programming">Interrupt-Driven Programming</a></h3>
<p>Interrupts allow the processor to respond to events immediately without polling.</p>
<pre><code class="language-c">// Example: External Interrupt
volatile bool buttonPressed = false;

// Interrupt Service Routine (ISR)
void EXTI0_IRQHandler(void) {
    if (EXTI-&gt;PR &amp; EXTI_PR_PR0) {
        buttonPressed = true;
        EXTI-&gt;PR |= EXTI_PR_PR0;  // Clear interrupt flag
    }
}

int main(void) {
    // Setup interrupt
    RCC-&gt;APB2ENR |= RCC_APB2ENR_IOPAEN;
    GPIOA-&gt;CRL &amp;= ~GPIO_CRL_CNF0;
    GPIOA-&gt;CRL |= GPIO_CRL_CNF0_1;  // Input with pull-up
    
    AFIO-&gt;EXTICR[0] = AFIO_EXTICR1_EXTI0_PA;
    EXTI-&gt;IMR |= EXTI_IMR_MR0;
    EXTI-&gt;FTSR |= EXTI_FTSR_TR0;  // Falling edge
    
    NVIC_EnableIRQ(EXTI0_IRQn);
    
    while (1) {
        if (buttonPressed) {
            // Handle button press
            buttonPressed = false;
        }
        // Main loop continues
    }
}
</code></pre>
<h2 id="communication-protocols"><a class="header" href="#communication-protocols">Communication Protocols</a></h2>
<h3 id="serial-protocols-overview"><a class="header" href="#serial-protocols-overview">Serial Protocols Overview</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Protocol</th><th>Type</th><th>Speed</th><th>Wires</th><th>Use Case</th></tr></thead><tbody>
<tr><td><strong><a href="embedded/uart.html">UART</a></strong></td><td>Asynchronous</td><td>Up to 1 Mbps</td><td>2 (TX/RX)</td><td>Debug, GPS, Bluetooth modules</td></tr>
<tr><td><strong><a href="embedded/spi.html">SPI</a></strong></td><td>Synchronous</td><td>Up to 50 Mbps</td><td>4+ (MOSI/MISO/SCK/CS)</td><td>SD cards, displays, high-speed sensors</td></tr>
<tr><td><strong><a href="embedded/i2c.html">I2C</a></strong></td><td>Synchronous</td><td>100-400 kHz</td><td>2 (SDA/SCL)</td><td>Sensors, RTCs, EEPROMs</td></tr>
<tr><td><strong><a href="embedded/can.html">CAN</a></strong></td><td>Differential</td><td>Up to 1 Mbps</td><td>2 (CAN_H/CAN_L)</td><td>Automotive, industrial</td></tr>
<tr><td><strong><a href="embedded/usb.html">USB</a></strong></td><td>Differential</td><td>1.5-480 Mbps</td><td>2 (D+/D-)</td><td>PC interface, peripherals</td></tr>
</tbody></table>
</div>
<h3 id="protocol-comparison"><a class="header" href="#protocol-comparison">Protocol Comparison</a></h3>
<pre><code>Speed (Mbps)
    ^
    |
100 |                    ┌─── USB 2.0
    |                    │
 50 |            ┌─── SPI│
    |            │       │
 10 |            │       │
    |            │       │
  1 |  ┌─ UART  │       │
    |  │    │   │       │
0.1 |  │ I2C│   │       │
    |  │    │   │       │
    └──┴────┴───┴───────┴────────&gt; Complexity
       Low              High
</code></pre>
<h2 id="peripheral-interfaces"><a class="header" href="#peripheral-interfaces">Peripheral Interfaces</a></h2>
<h3 id="digital-io-gpio"><a class="header" href="#digital-io-gpio">Digital I/O (<a href="embedded/gpio.html">GPIO</a>)</a></h3>
<ul>
<li>General Purpose Input/Output pins</li>
<li>Digital HIGH/LOW states</li>
<li>Input modes: floating, pull-up, pull-down</li>
<li>Output modes: push-pull, open-drain</li>
</ul>
<h3 id="analog-interfaces"><a class="header" href="#analog-interfaces">Analog Interfaces</a></h3>
<ul>
<li><strong><a href="embedded/adc.html">ADC</a></strong>: Convert analog voltages to digital values</li>
<li><strong><a href="embedded/dac.html">DAC</a></strong>: Convert digital values to analog voltages</li>
<li><strong><a href="embedded/pwm.html">PWM</a></strong>: Pulse Width Modulation for analog-like output</li>
</ul>
<h3 id="timing-and-control"><a class="header" href="#timing-and-control">Timing and Control</a></h3>
<ul>
<li><strong><a href="embedded/timers.html">Timers</a></strong>: Hardware timers for precise timing</li>
<li><strong><a href="embedded/interrupts.html">Interrupts</a></strong>: Event-driven programming</li>
<li><strong><a href="embedded/watchdog.html">Watchdog</a></strong>: System reliability and reset</li>
</ul>
<h3 id="specialized-interfaces"><a class="header" href="#specialized-interfaces">Specialized Interfaces</a></h3>
<ul>
<li><strong><a href="embedded/rtc.html">RTC</a></strong>: Real-Time Clock for timekeeping</li>
<li><strong><a href="embedded/sdio.html">SDIO</a></strong>: SD card interface</li>
<li><strong><a href="embedded/ethernet.html">Ethernet</a></strong>: Network connectivity</li>
</ul>
<h2 id="getting-started-4"><a class="header" href="#getting-started-4">Getting Started</a></h2>
<h3 id="development-environment-setup"><a class="header" href="#development-environment-setup">Development Environment Setup</a></h3>
<h4 id="1-choose-your-platform"><a class="header" href="#1-choose-your-platform">1. Choose Your Platform</a></h4>
<p>Start with Arduino for beginners, or jump to STM32/ESP32 for more advanced projects.</p>
<h4 id="2-install-tools"><a class="header" href="#2-install-tools">2. Install Tools</a></h4>
<p><strong>For Arduino:</strong></p>
<pre><code class="language-bash"># Download Arduino IDE from arduino.cc
# Or use Arduino CLI
curl -fsSL https://raw.githubusercontent.com/arduino/arduino-cli/master/install.sh | sh
</code></pre>
<p><strong>For STM32:</strong></p>
<pre><code class="language-bash"># Install STM32CubeIDE
# Download from st.com
# Or use PlatformIO
pip install platformio
</code></pre>
<p><strong>For ESP32:</strong></p>
<pre><code class="language-bash"># Add ESP32 to Arduino IDE
# Or use ESP-IDF
git clone --recursive https://github.com/espressif/esp-idf.git
cd esp-idf
./install.sh
</code></pre>
<h4 id="3-hardware-setup"><a class="header" href="#3-hardware-setup">3. Hardware Setup</a></h4>
<p><strong>Minimum Requirements:</strong></p>
<ul>
<li>Development board (Arduino Uno, ESP32, STM32 Nucleo, etc.)</li>
<li>USB cable</li>
<li>Computer with IDE installed</li>
<li>Optional: Breadboard, jumper wires, components</li>
</ul>
<p><strong>Development Kit:</strong></p>
<pre><code>Essential Components:
├─ Microcontroller board
├─ USB cable
├─ Breadboard
├─ Jumper wires (male-male, male-female)
├─ LEDs and resistors (220Ω)
├─ Push buttons
├─ Potentiometer (10kΩ)
└─ Multimeter

Sensors (Optional):
├─ Temperature (DHT11/22, DS18B20)
├─ Distance (HC-SR04 ultrasonic)
├─ Light (LDR, BH1750)
└─ Motion (PIR, MPU6050)
</code></pre>
<h3 id="first-program-blink-led"><a class="header" href="#first-program-blink-led">First Program: Blink LED</a></h3>
<h4 id="arduino-version"><a class="header" href="#arduino-version">Arduino Version</a></h4>
<pre><code class="language-cpp">// Blink LED on pin 13
void setup() {
    pinMode(13, OUTPUT);
}

void loop() {
    digitalWrite(13, HIGH);
    delay(1000);
    digitalWrite(13, LOW);
    delay(1000);
}
</code></pre>
<h4 id="stm32-hal-version"><a class="header" href="#stm32-hal-version">STM32 HAL Version</a></h4>
<pre><code class="language-c">#include "stm32f4xx_hal.h"

int main(void) {
    HAL_Init();
    SystemClock_Config();
    
    __HAL_RCC_GPIOA_CLK_ENABLE();
    
    GPIO_InitTypeDef GPIO_InitStruct = {0};
    GPIO_InitStruct.Pin = GPIO_PIN_5;
    GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;
    GPIO_InitStruct.Pull = GPIO_NOPULL;
    GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
    HAL_GPIO_Init(GPIOA, &amp;GPIO_InitStruct);
    
    while (1) {
        HAL_GPIO_TogglePin(GPIOA, GPIO_PIN_5);
        HAL_Delay(1000);
    }
}
</code></pre>
<h4 id="bare-metal-avr-version"><a class="header" href="#bare-metal-avr-version">Bare Metal AVR Version</a></h4>
<pre><code class="language-c">#include &lt;avr/io.h&gt;
#include &lt;util/delay.h&gt;

int main(void) {
    DDRB |= (1 &lt;&lt; DDB5);  // Set PB5 as output
    
    while (1) {
        PORTB |= (1 &lt;&lt; PORTB5);   // LED on
        _delay_ms(1000);
        PORTB &amp;= ~(1 &lt;&lt; PORTB5);  // LED off
        _delay_ms(1000);
    }
    
    return 0;
}
</code></pre>
<h3 id="learning-path-2"><a class="header" href="#learning-path-2">Learning Path</a></h3>
<pre><code>┌─────────────────────────────────────────────┐
│ Level 1: Fundamentals                       │
├─────────────────────────────────────────────┤
│ • Digital I/O (LED, button)                 │
│ • Analog input (ADC, potentiometer)         │
│ • PWM (LED brightness, motor speed)         │
│ • Serial communication (UART debug)         │
└─────────────────────────────────────────────┘
              │
              ▼
┌─────────────────────────────────────────────┐
│ Level 2: Intermediate                       │
├─────────────────────────────────────────────┤
│ • Timers and interrupts                     │
│ • I2C sensors (temperature, accelerometer)  │
│ • SPI devices (SD card, display)            │
│ • State machines                            │
└─────────────────────────────────────────────┘
              │
              ▼
┌─────────────────────────────────────────────┐
│ Level 3: Advanced                           │
├─────────────────────────────────────────────┤
│ • DMA transfers                             │
│ • RTOS (FreeRTOS)                          │
│ • Low-power optimization                    │
│ • Bootloaders and OTA updates              │
└─────────────────────────────────────────────┘
</code></pre>
<h3 id="common-project-ideas"><a class="header" href="#common-project-ideas">Common Project Ideas</a></h3>
<ol>
<li>
<p><strong>Beginner Projects</strong></p>
<ul>
<li>LED blink and patterns</li>
<li>Button-controlled LED</li>
<li>Temperature monitor</li>
<li>Light-sensitive nightlight</li>
</ul>
</li>
<li>
<p><strong>Intermediate Projects</strong></p>
<ul>
<li>Digital thermometer with display</li>
<li>Motor speed controller</li>
<li>Distance measurement system</li>
<li>Data logger with SD card</li>
</ul>
</li>
<li>
<p><strong>Advanced Projects</strong></p>
<ul>
<li>Weather station with WiFi</li>
<li>Robot controller</li>
<li>Home automation system</li>
<li>Wireless sensor network</li>
</ul>
</li>
</ol>
<h2 id="best-practices-56"><a class="header" href="#best-practices-56">Best Practices</a></h2>
<h3 id="code-organization-1"><a class="header" href="#code-organization-1">Code Organization</a></h3>
<pre><code class="language-c">// Good structure
├─ src/
│  ├─ main.c
│  ├─ drivers/
│  │  ├─ sensor.c
│  │  └─ display.c
│  └─ app/
│     ├─ control.c
│     └─ config.c
├─ inc/
│  ├─ sensor.h
│  ├─ display.h
│  └─ config.h
└─ Makefile
</code></pre>
<h3 id="design-principles"><a class="header" href="#design-principles">Design Principles</a></h3>
<ol>
<li><strong>Keep ISRs Short</strong>: Minimal processing in interrupt handlers</li>
<li><strong>Use Volatile</strong>: For variables modified by ISRs</li>
<li><strong>Debounce Inputs</strong>: Software or hardware debouncing for buttons</li>
<li><strong>Watchdog Timer</strong>: Implement system recovery</li>
<li><strong>Power Efficiency</strong>: Use sleep modes when idle</li>
<li><strong>Error Handling</strong>: Check return values and handle failures</li>
<li><strong>Documentation</strong>: Comment complex logic and register operations</li>
</ol>
<h3 id="debugging-techniques-1"><a class="header" href="#debugging-techniques-1">Debugging Techniques</a></h3>
<pre><code class="language-c">// UART debug output
void debug_print(const char* msg) {
    uart_send_string(msg);
}

// LED status indicators
#define LED_ERROR   GPIO_PIN_0
#define LED_OK      GPIO_PIN_1
#define LED_BUSY    GPIO_PIN_2

// Assert macro
#define ASSERT(expr) \
    if (!(expr)) { \
        debug_print("Assert failed: " #expr); \
        while(1);  // Halt \
    }
</code></pre>
<h2 id="resources-30"><a class="header" href="#resources-30">Resources</a></h2>
<h3 id="documentation-5"><a class="header" href="#documentation-5">Documentation</a></h3>
<ul>
<li>Platform-specific datasheets and reference manuals</li>
<li>Peripheral application notes</li>
<li>HAL/LL library documentation</li>
</ul>
<h3 id="tools-9"><a class="header" href="#tools-9">Tools</a></h3>
<ul>
<li><strong>Oscilloscope</strong>: Analyze signals and timing</li>
<li><strong>Logic Analyzer</strong>: Debug digital protocols</li>
<li><strong>Multimeter</strong>: Measure voltages and continuity</li>
<li><strong>Debugger</strong>: JTAG/SWD for step-through debugging</li>
</ul>
<h3 id="communities-3"><a class="header" href="#communities-3">Communities</a></h3>
<ul>
<li>Arduino Forum</li>
<li>STM32 Community</li>
<li>ESP32 Forum</li>
<li>Reddit: r/embedded, r/arduino</li>
<li>Stack Overflow: Embedded tag</li>
</ul>
<h2 id="see-also"><a class="header" href="#see-also">See Also</a></h2>
<ul>
<li><a href="embedded/gpio.html">GPIO Programming</a></li>
<li><a href="embedded/uart.html">UART Communication</a></li>
<li><a href="embedded/interrupts.html">Interrupt Handling</a></li>
<li><a href="embedded/power_management.html">Power Management</a></li>
<li><a href="embedded/debugging.html">Debugging Techniques</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="avr-microcontrollers"><a class="header" href="#avr-microcontrollers">AVR Microcontrollers</a></h1>
<p>Comprehensive guide to AVR microcontroller programming with register-level control and bare-metal development.</p>
<h2 id="table-of-contents-36"><a class="header" href="#table-of-contents-36">Table of Contents</a></h2>
<ol>
<li><a href="embedded/avr.html#introduction">Introduction</a></li>
<li><a href="embedded/avr.html#avr-architecture">AVR Architecture</a></li>
<li><a href="embedded/avr.html#development-setup">Development Setup</a></li>
<li><a href="embedded/avr.html#register-programming">Register Programming</a></li>
<li><a href="embedded/avr.html#gpio-control">GPIO Control</a></li>
<li><a href="embedded/avr.html#timers-and-counters">Timers and Counters</a></li>
<li><a href="embedded/avr.html#interrupts">Interrupts</a></li>
<li><a href="embedded/avr.html#communication-protocols">Communication Protocols</a></li>
<li><a href="embedded/avr.html#advanced-topics">Advanced Topics</a></li>
</ol>
<h2 id="introduction-16"><a class="header" href="#introduction-16">Introduction</a></h2>
<p>AVR is a family of 8-bit RISC microcontrollers developed by Atmel (now Microchip). They are widely used in Arduino boards and embedded systems due to their simplicity, efficiency, and low cost.</p>
<h3 id="key-features-9"><a class="header" href="#key-features-9">Key Features</a></h3>
<ul>
<li><strong>8-bit RISC Architecture</strong>: Harvard architecture with separate program and data memory</li>
<li><strong>Clock Speed</strong>: 1-20 MHz</li>
<li><strong>Flash Memory</strong>: 2-256 KB</li>
<li><strong>SRAM</strong>: 128 bytes - 16 KB</li>
<li><strong>EEPROM</strong>: 64 bytes - 4 KB</li>
<li><strong>Peripherals</strong>: GPIO, Timers, ADC, UART, SPI, I2C</li>
<li><strong>Power Efficient</strong>: Multiple sleep modes</li>
<li><strong>Price</strong>: $1-5</li>
</ul>
<h3 id="popular-avr-microcontrollers"><a class="header" href="#popular-avr-microcontrollers">Popular AVR Microcontrollers</a></h3>
<div class="table-wrapper"><table><thead><tr><th>MCU</th><th>Flash</th><th>RAM</th><th>EEPROM</th><th>GPIO</th><th>ADC</th><th>Timers</th><th>Package</th><th>Use Case</th></tr></thead><tbody>
<tr><td><strong>ATtiny13</strong></td><td>1 KB</td><td>64 B</td><td>64 B</td><td>6</td><td>4</td><td>1</td><td>8-pin</td><td>Ultra-small projects</td></tr>
<tr><td><strong>ATtiny85</strong></td><td>8 KB</td><td>512 B</td><td>512 B</td><td>6</td><td>4</td><td>2</td><td>8-pin</td><td>Small projects</td></tr>
<tr><td><strong>ATmega8</strong></td><td>8 KB</td><td>1 KB</td><td>512 B</td><td>23</td><td>6</td><td>3</td><td>28-pin</td><td>Entry level</td></tr>
<tr><td><strong>ATmega328P</strong></td><td>32 KB</td><td>2 KB</td><td>1 KB</td><td>23</td><td>6</td><td>3</td><td>28-pin</td><td>Arduino Uno</td></tr>
<tr><td><strong>ATmega2560</strong></td><td>256 KB</td><td>8 KB</td><td>4 KB</td><td>86</td><td>16</td><td>6</td><td>100-pin</td><td>Arduino Mega</td></tr>
</tbody></table>
</div>
<h2 id="avr-architecture"><a class="header" href="#avr-architecture">AVR Architecture</a></h2>
<h3 id="memory-organization"><a class="header" href="#memory-organization">Memory Organization</a></h3>
<pre><code>┌──────────────────────────────────────┐
│        AVR Memory Map                │
├──────────────────────────────────────┤
│  Program Memory (Flash)              │
│  ┌────────────────────────────────┐  │
│  │ 0x0000: Interrupt Vectors      │  │
│  │ 0x0034: Program Code           │  │
│  │ ...                            │  │
│  │ End:    Bootloader (optional)  │  │
│  └────────────────────────────────┘  │
├──────────────────────────────────────┤
│  Data Memory (SRAM)                  │
│  ┌────────────────────────────────┐  │
│  │ 0x0000-0x001F: Registers (R0-R31)│
│  │ 0x0020-0x005F: I/O Registers   │  │
│  │ 0x0060-0x00FF: Extended I/O    │  │
│  │ 0x0100-...   : SRAM            │  │
│  │ ...          : Stack (grows ↓) │  │
│  └────────────────────────────────┘  │
├──────────────────────────────────────┤
│  EEPROM (Non-volatile)               │
│  ┌────────────────────────────────┐  │
│  │ 0x0000: User data storage      │  │
│  │ ...                            │  │
│  └────────────────────────────────┘  │
└──────────────────────────────────────┘
</code></pre>
<h3 id="registers"><a class="header" href="#registers">Registers</a></h3>
<h4 id="general-purpose-registers"><a class="header" href="#general-purpose-registers">General Purpose Registers</a></h4>
<pre><code>R0-R31:  32 general-purpose 8-bit registers
R26-R27: X pointer (XL, XH)
R28-R29: Y pointer (YL, YH)
R30-R31: Z pointer (ZL, ZH)
</code></pre>
<h4 id="status-register-sreg"><a class="header" href="#status-register-sreg">Status Register (SREG)</a></h4>
<pre><code>Bit 7: I - Global Interrupt Enable
Bit 6: T - Transfer bit
Bit 5: H - Half Carry Flag
Bit 4: S - Sign Flag
Bit 3: V - Overflow Flag
Bit 2: N - Negative Flag
Bit 1: Z - Zero Flag
Bit 0: C - Carry Flag
</code></pre>
<h3 id="atmega328p-pinout"><a class="header" href="#atmega328p-pinout">ATmega328P Pinout</a></h3>
<pre><code>         ATmega328P (DIP-28)
              ┌───∪───┐
    RESET  1 ─┤       ├─ 28  PC5/ADC5/SCL
    RXD/D0 2 ─┤       ├─ 27  PC4/ADC4/SDA
    TXD/D1 3 ─┤       ├─ 26  PC3/ADC3
    INT0/D2 4 ─┤       ├─ 25  PC2/ADC2
    INT1/D3 5 ─┤       ├─ 24  PC1/ADC1
    D4     6 ─┤       ├─ 23  PC0/ADC0
    VCC    7 ─┤       ├─ 22  GND
    GND    8 ─┤       ├─ 21  AREF
    XTAL1  9 ─┤       ├─ 20  AVCC
    XTAL2 10 ─┤       ├─ 19  PB5/SCK
    D5    11 ─┤       ├─ 18  PB4/MISO
    D6    12 ─┤       ├─ 17  PB3/MOSI
    D7    13 ─┤       ├─ 16  PB2/SS
    D8    14 ─┤       ├─ 15  PB1/OC1A
              └───────┘

GPIO Ports:
  Port B (PB0-PB5): Digital I/O, SPI
  Port C (PC0-PC5): Analog input (ADC), I2C
  Port D (PD0-PD7): Digital I/O, UART, Interrupts
</code></pre>
<h2 id="development-setup"><a class="header" href="#development-setup">Development Setup</a></h2>
<h3 id="avr-gcc-toolchain"><a class="header" href="#avr-gcc-toolchain">AVR-GCC Toolchain</a></h3>
<pre><code class="language-bash"># Install AVR tools (Ubuntu/Debian)
sudo apt install gcc-avr avr-libc avrdude

# Install on Arch Linux
sudo pacman -S avr-gcc avr-libc avrdude

# Install on macOS
brew install avr-gcc avr-libc avrdude

# Verify installation
avr-gcc --version
avrdude -v
</code></pre>
<h3 id="project-structure-2"><a class="header" href="#project-structure-2">Project Structure</a></h3>
<pre><code>project/
├── main.c
├── Makefile
└── README.md
</code></pre>
<h3 id="makefile-template"><a class="header" href="#makefile-template">Makefile Template</a></h3>
<pre><code class="language-makefile"># AVR Makefile
MCU = atmega328p
F_CPU = 16000000UL
BAUD = 9600

CC = avr-gcc
OBJCOPY = avr-objcopy
OBJDUMP = avr-objdump
SIZE = avr-size

TARGET = main
SRC = main.c

CFLAGS = -mmcu=$(MCU) -DF_CPU=$(F_CPU) -DBAUD=$(BAUD)
CFLAGS += -Os -Wall -Wextra -std=c99

# Programmer settings
PROGRAMMER = arduino
PORT = /dev/ttyUSB0

all: $(TARGET).hex

$(TARGET).elf: $(SRC)
	$(CC) $(CFLAGS) -o $@ $^
	$(SIZE) $@

$(TARGET).hex: $(TARGET).elf
	$(OBJCOPY) -O ihex -R .eeprom $&lt; $@

flash: $(TARGET).hex
	avrdude -c $(PROGRAMMER) -p $(MCU) -P $(PORT) -U flash:w:$&lt;

clean:
	rm -f $(TARGET).elf $(TARGET).hex

.PHONY: all flash clean
</code></pre>
<h3 id="compiling-and-flashing"><a class="header" href="#compiling-and-flashing">Compiling and Flashing</a></h3>
<pre><code class="language-bash"># Compile
make

# Flash to device
make flash

# Clean build files
make clean

# Manual commands
avr-gcc -mmcu=atmega328p -DF_CPU=16000000UL -Os -o main.elf main.c
avr-objcopy -O ihex -R .eeprom main.elf main.hex
avrdude -c arduino -p atmega328p -P /dev/ttyUSB0 -U flash:w:main.hex
</code></pre>
<h2 id="register-programming"><a class="header" href="#register-programming">Register Programming</a></h2>
<h3 id="understanding-registers"><a class="header" href="#understanding-registers">Understanding Registers</a></h3>
<p>AVR programming requires direct manipulation of hardware registers. Each peripheral has associated registers for control and data.</p>
<h4 id="register-operations"><a class="header" href="#register-operations">Register Operations</a></h4>
<pre><code class="language-c">#include &lt;avr/io.h&gt;

/* Set bit (set to 1) */
PORTB |= (1 &lt;&lt; PB5);

/* Clear bit (set to 0) */
PORTB &amp;= ~(1 &lt;&lt; PB5);

/* Toggle bit */
PORTB ^= (1 &lt;&lt; PB5);

/* Check bit */
if (PIND &amp; (1 &lt;&lt; PD2)) {
    // Bit is set
}

/* Set multiple bits */
PORTB |= (1 &lt;&lt; PB0) | (1 &lt;&lt; PB1) | (1 &lt;&lt; PB2);

/* Clear multiple bits */
PORTB &amp;= ~((1 &lt;&lt; PB0) | (1 &lt;&lt; PB1));

/* Write entire register */
PORTB = 0b10101010;
</code></pre>
<h2 id="gpio-control"><a class="header" href="#gpio-control">GPIO Control</a></h2>
<h3 id="port-registers"><a class="header" href="#port-registers">Port Registers</a></h3>
<p>Each GPIO port has three registers:</p>
<ul>
<li><strong>DDRx</strong>: Data Direction Register (1 = Output, 0 = Input)</li>
<li><strong>PORTx</strong>: Port Output Register (Output value or pull-up enable)</li>
<li><strong>PINx</strong>: Port Input Register (Read input state)</li>
</ul>
<h3 id="basic-gpio-example"><a class="header" href="#basic-gpio-example">Basic GPIO Example</a></h3>
<pre><code class="language-c">#include &lt;avr/io.h&gt;
#include &lt;util/delay.h&gt;

int main(void) {
    /* Set PB5 (Arduino pin 13) as output */
    DDRB |= (1 &lt;&lt; DDB5);
    
    /* Main loop */
    while (1) {
        /* Turn LED on */
        PORTB |= (1 &lt;&lt; PORTB5);
        _delay_ms(1000);
        
        /* Turn LED off */
        PORTB &amp;= ~(1 &lt;&lt; PORTB5);
        _delay_ms(1000);
    }
    
    return 0;
}
</code></pre>
<h3 id="button-input-with-pull-up"><a class="header" href="#button-input-with-pull-up">Button Input with Pull-up</a></h3>
<pre><code class="language-c">#include &lt;avr/io.h&gt;
#include &lt;util/delay.h&gt;

int main(void) {
    /* PB5 as output (LED) */
    DDRB |= (1 &lt;&lt; DDB5);
    
    /* PD2 as input (button) */
    DDRD &amp;= ~(1 &lt;&lt; DDD2);
    
    /* Enable pull-up resistor on PD2 */
    PORTD |= (1 &lt;&lt; PORTD2);
    
    while (1) {
        /* Check if button pressed (active low) */
        if (\!(PIND &amp; (1 &lt;&lt; PIND2))) {
            PORTB |= (1 &lt;&lt; PORTB5);   // LED on
        } else {
            PORTB &amp;= ~(1 &lt;&lt; PORTB5);  // LED off
        }
        
        _delay_ms(10);  // Debounce delay
    }
    
    return 0;
}
</code></pre>
<h3 id="multiple-led-control"><a class="header" href="#multiple-led-control">Multiple LED Control</a></h3>
<pre><code class="language-c">#include &lt;avr/io.h&gt;
#include &lt;util/delay.h&gt;

int main(void) {
    /* Set PB0-PB5 as outputs */
    DDRB = 0b00111111;
    
    while (1) {
        /* Running LED pattern */
        for (uint8_t i = 0; i &lt; 6; i++) {
            PORTB = (1 &lt;&lt; i);
            _delay_ms(200);
        }
        
        /* Reverse */
        for (uint8_t i = 6; i &gt; 0; i--) {
            PORTB = (1 &lt;&lt; (i-1));
            _delay_ms(200);
        }
    }
    
    return 0;
}
</code></pre>
<h2 id="timers-and-counters"><a class="header" href="#timers-and-counters">Timers and Counters</a></h2>
<p>AVR timers are versatile peripherals for timing, counting, PWM generation, and more.</p>
<h3 id="timer0-8-bit"><a class="header" href="#timer0-8-bit">Timer0 (8-bit)</a></h3>
<pre><code class="language-c">#include &lt;avr/io.h&gt;
#include &lt;avr/interrupt.h&gt;

volatile uint32_t milliseconds = 0;

/* Timer0 overflow interrupt */
ISR(TIMER0_OVF_vect) {
    milliseconds++;
}

void timer0_init(void) {
    /* Set prescaler to 64 */
    TCCR0B |= (1 &lt;&lt; CS01) | (1 &lt;&lt; CS00);
    
    /* Enable overflow interrupt */
    TIMSK0 |= (1 &lt;&lt; TOIE0);
    
    /* Enable global interrupts */
    sei();
}

int main(void) {
    DDRB |= (1 &lt;&lt; DDB5);
    timer0_init();
    
    while (1) {
        if (milliseconds &gt;= 1000) {
            milliseconds = 0;
            PORTB ^= (1 &lt;&lt; PORTB5);
        }
    }
    
    return 0;
}
</code></pre>
<h3 id="pwm-with-timer1-16-bit"><a class="header" href="#pwm-with-timer1-16-bit">PWM with Timer1 (16-bit)</a></h3>
<pre><code class="language-c">#include &lt;avr/io.h&gt;
#include &lt;util/delay.h&gt;

void pwm_init(void) {
    /* Set PB1 (OC1A) as output */
    DDRB |= (1 &lt;&lt; DDB1);
    
    /* Fast PWM, 10-bit, non-inverted */
    TCCR1A |= (1 &lt;&lt; WGM11) | (1 &lt;&lt; WGM10);
    TCCR1A |= (1 &lt;&lt; COM1A1);
    TCCR1B |= (1 &lt;&lt; WGM12) | (1 &lt;&lt; CS10);  // No prescaling
    
    /* Set initial duty cycle */
    OCR1A = 512;  // 50% duty cycle (0-1023)
}

int main(void) {
    pwm_init();
    
    while (1) {
        /* Fade in */
        for (uint16_t i = 0; i &lt;= 1023; i += 10) {
            OCR1A = i;
            _delay_ms(20);
        }
        
        /* Fade out */
        for (uint16_t i = 1023; i &gt; 0; i -= 10) {
            OCR1A = i;
            _delay_ms(20);
        }
    }
    
    return 0;
}
</code></pre>
<h3 id="timer2-ctc-mode-precise-timing"><a class="header" href="#timer2-ctc-mode-precise-timing">Timer2 CTC Mode (Precise Timing)</a></h3>
<pre><code class="language-c">#include &lt;avr/io.h&gt;
#include &lt;avr/interrupt.h&gt;

volatile uint8_t flag = 0;

/* Timer2 compare match interrupt - fires every 1ms */
ISR(TIMER2_COMPA_vect) {
    static uint16_t count = 0;
    count++;
    
    if (count &gt;= 1000) {  // 1 second
        count = 0;
        flag = 1;
    }
}

void timer2_init(void) {
    /* CTC mode */
    TCCR2A |= (1 &lt;&lt; WGM21);
    
    /* Prescaler 64: 16MHz / 64 = 250kHz */
    TCCR2B |= (1 &lt;&lt; CS22);
    
    /* Compare value for 1ms: 250kHz / 250 = 1kHz */
    OCR2A = 249;
    
    /* Enable compare match interrupt */
    TIMSK2 |= (1 &lt;&lt; OCIE2A);
    
    sei();
}

int main(void) {
    DDRB |= (1 &lt;&lt; DDB5);
    timer2_init();
    
    while (1) {
        if (flag) {
            flag = 0;
            PORTB ^= (1 &lt;&lt; PORTB5);
        }
    }
    
    return 0;
}
</code></pre>
<h2 id="interrupts-1"><a class="header" href="#interrupts-1">Interrupts</a></h2>
<h3 id="external-interrupts"><a class="header" href="#external-interrupts">External Interrupts</a></h3>
<pre><code class="language-c">#include &lt;avr/io.h&gt;
#include &lt;avr/interrupt.h&gt;

volatile uint8_t led_state = 0;

/* INT0 interrupt handler */
ISR(INT0_vect) {
    led_state = \!led_state;
    
    if (led_state) {
        PORTB |= (1 &lt;&lt; PORTB5);
    } else {
        PORTB &amp;= ~(1 &lt;&lt; PORTB5);
    }
}

void int0_init(void) {
    /* PD2 as input with pull-up */
    DDRD &amp;= ~(1 &lt;&lt; DDD2);
    PORTD |= (1 &lt;&lt; PORTD2);
    
    /* Trigger on falling edge */
    EICRA |= (1 &lt;&lt; ISC01);
    
    /* Enable INT0 */
    EIMSK |= (1 &lt;&lt; INT0);
    
    sei();
}

int main(void) {
    DDRB |= (1 &lt;&lt; DDB5);
    int0_init();
    
    while (1) {
        /* Main loop can do other things */
    }
    
    return 0;
}
</code></pre>
<h3 id="pin-change-interrupts"><a class="header" href="#pin-change-interrupts">Pin Change Interrupts</a></h3>
<pre><code class="language-c">#include &lt;avr/io.h&gt;
#include &lt;avr/interrupt.h&gt;

/* PCINT0 interrupt (PB0-PB7) */
ISR(PCINT0_vect) {
    /* Check which pin changed */
    if (\!(PINB &amp; (1 &lt;&lt; PINB0))) {
        // PB0 is low
        PORTB |= (1 &lt;&lt; PORTB5);
    } else {
        PORTB &amp;= ~(1 &lt;&lt; PORTB5);
    }
}

void pcint_init(void) {
    /* Enable pull-up on PB0 */
    PORTB |= (1 &lt;&lt; PORTB0);
    
    /* Enable PCINT0 (PB0) */
    PCMSK0 |= (1 &lt;&lt; PCINT0);
    
    /* Enable pin change interrupt 0 */
    PCICR |= (1 &lt;&lt; PCIE0);
    
    sei();
}

int main(void) {
    DDRB |= (1 &lt;&lt; DDB5);
    DDRB &amp;= ~(1 &lt;&lt; DDB0);
    
    pcint_init();
    
    while (1) {
        /* Main loop */
    }
    
    return 0;
}
</code></pre>
<h2 id="communication-protocols-1"><a class="header" href="#communication-protocols-1">Communication Protocols</a></h2>
<h3 id="uart-serial-communication"><a class="header" href="#uart-serial-communication">UART (Serial Communication)</a></h3>
<pre><code class="language-c">#include &lt;avr/io.h&gt;
#include &lt;util/delay.h&gt;

#define BAUD 9600
#define MYUBRR F_CPU/16/BAUD-1

void uart_init(void) {
    /* Set baud rate */
    UBRR0H = (MYUBRR &gt;&gt; 8);
    UBRR0L = MYUBRR;
    
    /* Enable transmitter and receiver */
    UCSR0B = (1 &lt;&lt; TXEN0) | (1 &lt;&lt; RXEN0);
    
    /* Set frame format: 8 data bits, 1 stop bit */
    UCSR0C = (1 &lt;&lt; UCSZ01) | (1 &lt;&lt; UCSZ00);
}

void uart_transmit(uint8_t data) {
    /* Wait for empty transmit buffer */
    while (\!(UCSR0A &amp; (1 &lt;&lt; UDRE0)));
    
    /* Put data into buffer */
    UDR0 = data;
}

uint8_t uart_receive(void) {
    /* Wait for data */
    while (\!(UCSR0A &amp; (1 &lt;&lt; RXC0)));
    
    /* Get and return data */
    return UDR0;
}

void uart_print(const char* str) {
    while (*str) {
        uart_transmit(*str++);
    }
}

int main(void) {
    uart_init();
    
    uart_print("Hello, AVR\!\r\n");
    
    while (1) {
        uint8_t received = uart_receive();
        uart_transmit(received);  // Echo back
    }
    
    return 0;
}
</code></pre>
<h3 id="spi-master"><a class="header" href="#spi-master">SPI Master</a></h3>
<pre><code class="language-c">#include &lt;avr/io.h&gt;

void spi_init(void) {
    /* Set MOSI, SCK, and SS as outputs */
    DDRB |= (1 &lt;&lt; DDB3) | (1 &lt;&lt; DDB5) | (1 &lt;&lt; DDB2);
    
    /* Set MISO as input */
    DDRB &amp;= ~(1 &lt;&lt; DDB4);
    
    /* Enable SPI, Master mode, clock = F_CPU/16 */
    SPCR = (1 &lt;&lt; SPE) | (1 &lt;&lt; MSTR) | (1 &lt;&lt; SPR0);
}

uint8_t spi_transfer(uint8_t data) {
    /* Start transmission */
    SPDR = data;
    
    /* Wait for transmission complete */
    while (\!(SPSR &amp; (1 &lt;&lt; SPIF)));
    
    /* Return received data */
    return SPDR;
}

int main(void) {
    spi_init();
    
    while (1) {
        /* Select device (SS low) */
        PORTB &amp;= ~(1 &lt;&lt; PORTB2);
        
        /* Send data */
        spi_transfer(0xAB);
        uint8_t received = spi_transfer(0x00);
        
        /* Deselect device (SS high) */
        PORTB |= (1 &lt;&lt; PORTB2);
    }
    
    return 0;
}
</code></pre>
<h3 id="i2c-twi-master"><a class="header" href="#i2c-twi-master">I2C (TWI) Master</a></h3>
<pre><code class="language-c">#include &lt;avr/io.h&gt;
#include &lt;util/twi.h&gt;

#define F_SCL 100000UL  // 100 kHz
#define TWI_BITRATE ((F_CPU / F_SCL) - 16) / 2

void i2c_init(void) {
    /* Set bit rate */
    TWBR = (uint8_t)TWI_BITRATE;
    
    /* Enable TWI */
    TWCR = (1 &lt;&lt; TWEN);
}

void i2c_start(void) {
    /* Send start condition */
    TWCR = (1 &lt;&lt; TWINT) | (1 &lt;&lt; TWSTA) | (1 &lt;&lt; TWEN);
    
    /* Wait for completion */
    while (\!(TWCR &amp; (1 &lt;&lt; TWINT)));
}

void i2c_stop(void) {
    /* Send stop condition */
    TWCR = (1 &lt;&lt; TWINT) | (1 &lt;&lt; TWSTO) | (1 &lt;&lt; TWEN);
}

void i2c_write(uint8_t data) {
    /* Load data */
    TWDR = data;
    
    /* Start transmission */
    TWCR = (1 &lt;&lt; TWINT) | (1 &lt;&lt; TWEN);
    
    /* Wait for completion */
    while (\!(TWCR &amp; (1 &lt;&lt; TWINT)));
}

uint8_t i2c_read_ack(void) {
    /* Enable ACK */
    TWCR = (1 &lt;&lt; TWINT) | (1 &lt;&lt; TWEN) | (1 &lt;&lt; TWEA);
    
    /* Wait for completion */
    while (\!(TWCR &amp; (1 &lt;&lt; TWINT)));
    
    return TWDR;
}

uint8_t i2c_read_nack(void) {
    /* Enable NACK */
    TWCR = (1 &lt;&lt; TWINT) | (1 &lt;&lt; TWEN);
    
    /* Wait for completion */
    while (\!(TWCR &amp; (1 &lt;&lt; TWINT)));
    
    return TWDR;
}

int main(void) {
    i2c_init();
    
    uint8_t device_addr = 0x68 &lt;&lt; 1;  // 7-bit address
    uint8_t reg_addr = 0x00;
    
    while (1) {
        /* Write to device */
        i2c_start();
        i2c_write(device_addr | 0);  // Write mode
        i2c_write(reg_addr);
        i2c_write(0x42);  // Data
        i2c_stop();
        
        /* Read from device */
        i2c_start();
        i2c_write(device_addr | 0);  // Write mode
        i2c_write(reg_addr);
        i2c_start();  // Repeated start
        i2c_write(device_addr | 1);  // Read mode
        uint8_t data = i2c_read_nack();
        i2c_stop();
    }
    
    return 0;
}
</code></pre>
<h2 id="advanced-topics"><a class="header" href="#advanced-topics">Advanced Topics</a></h2>
<h3 id="adc-analog-to-digital-converter"><a class="header" href="#adc-analog-to-digital-converter">ADC (Analog-to-Digital Converter)</a></h3>
<pre><code class="language-c">#include &lt;avr/io.h&gt;

void adc_init(void) {
    /* AVCC with external capacitor at AREF */
    ADMUX = (1 &lt;&lt; REFS0);
    
    /* Enable ADC, prescaler 128 (125 kHz @ 16 MHz) */
    ADCSRA = (1 &lt;&lt; ADEN) | (1 &lt;&lt; ADPS2) | (1 &lt;&lt; ADPS1) | (1 &lt;&lt; ADPS0);
}

uint16_t adc_read(uint8_t channel) {
    /* Select channel (0-7) */
    ADMUX = (ADMUX &amp; 0xF0) | (channel &amp; 0x0F);
    
    /* Start conversion */
    ADCSRA |= (1 &lt;&lt; ADSC);
    
    /* Wait for completion */
    while (ADCSRA &amp; (1 &lt;&lt; ADSC));
    
    return ADC;
}

int main(void) {
    uart_init();
    adc_init();
    
    while (1) {
        uint16_t value = adc_read(0);  // Read ADC0
        
        /* Convert to voltage (5V reference, 10-bit) */
        float voltage = (value * 5.0) / 1024.0;
        
        _delay_ms(100);
    }
    
    return 0;
}
</code></pre>
<h3 id="eeprom-access"><a class="header" href="#eeprom-access">EEPROM Access</a></h3>
<pre><code class="language-c">#include &lt;avr/io.h&gt;
#include &lt;avr/eeprom.h&gt;

uint8_t EEMEM stored_value;  // EEPROM variable

void eeprom_write_byte_custom(uint16_t address, uint8_t data) {
    /* Wait for completion of previous write */
    while (EECR &amp; (1 &lt;&lt; EEPE));
    
    /* Set address and data registers */
    EEAR = address;
    EEDR = data;
    
    /* Write logical one to EEMPE */
    EECR |= (1 &lt;&lt; EEMPE);
    
    /* Start eeprom write by setting EEPE */
    EECR |= (1 &lt;&lt; EEPE);
}

uint8_t eeprom_read_byte_custom(uint16_t address) {
    /* Wait for completion of previous write */
    while (EECR &amp; (1 &lt;&lt; EEPE));
    
    /* Set address register */
    EEAR = address;
    
    /* Start eeprom read by writing EERE */
    EECR |= (1 &lt;&lt; EERE);
    
    /* Return data from data register */
    return EEDR;
}

int main(void) {
    /* Using avr-libc functions (recommended) */
    eeprom_write_byte(&amp;stored_value, 42);
    uint8_t value = eeprom_read_byte(&amp;stored_value);
    
    /* Using custom functions */
    eeprom_write_byte_custom(0, 100);
    uint8_t val = eeprom_read_byte_custom(0);
    
    while (1);
    
    return 0;
}
</code></pre>
<h3 id="sleep-modes"><a class="header" href="#sleep-modes">Sleep Modes</a></h3>
<pre><code class="language-c">#include &lt;avr/io.h&gt;
#include &lt;avr/sleep.h&gt;
#include &lt;avr/interrupt.h&gt;

ISR(INT0_vect) {
    /* Wake up from sleep */
}

int main(void) {
    /* Configure wake-up source */
    EIMSK |= (1 &lt;&lt; INT0);
    sei();
    
    /* Set sleep mode */
    set_sleep_mode(SLEEP_MODE_PWR_DOWN);
    
    while (1) {
        /* Enter sleep mode */
        sleep_mode();
        
        /* Wake up here and continue */
        PORTB ^= (1 &lt;&lt; PORTB5);
    }
    
    return 0;
}
</code></pre>
<h3 id="watchdog-timer"><a class="header" href="#watchdog-timer">Watchdog Timer</a></h3>
<pre><code class="language-c">#include &lt;avr/io.h&gt;
#include &lt;avr/wdt.h&gt;

int main(void) {
    /* Disable watchdog on reset */
    MCUSR &amp;= ~(1 &lt;&lt; WDRF);
    wdt_disable();
    
    /* Enable watchdog: 2 second timeout */
    wdt_enable(WDTO_2S);
    
    while (1) {
        /* Main program */
        
        /* Reset watchdog timer */
        wdt_reset();
    }
    
    return 0;
}
</code></pre>
<h2 id="best-practices-57"><a class="header" href="#best-practices-57">Best Practices</a></h2>
<ol>
<li><strong>Use Register Macros</strong>: <code>PORTB |= (1 &lt;&lt; PB5)</code> instead of <code>PORTB |= 0x20</code></li>
<li><strong>Volatile for ISR Variables</strong>: <code>volatile uint8_t flag;</code></li>
<li><strong>Minimize ISR Time</strong>: Keep interrupt handlers short</li>
<li><strong>Proper Delays</strong>: Use timers instead of <code>_delay_ms()</code> for long delays</li>
<li><strong>Power Management</strong>: Disable unused peripherals, use sleep modes</li>
<li><strong>Debouncing</strong>: Add delays or use interrupts with debounce logic</li>
<li><strong>Code Organization</strong>: Separate initialization from main loop</li>
</ol>
<h2 id="troubleshooting-15"><a class="header" href="#troubleshooting-15">Troubleshooting</a></h2>
<h3 id="common-issues-16"><a class="header" href="#common-issues-16">Common Issues</a></h3>
<p><strong>Program Not Running:</strong></p>
<ul>
<li>Check fuse bits (clock source, brown-out detection)</li>
<li>Verify F_CPU matches actual clock speed</li>
<li>Ensure power supply is stable</li>
</ul>
<p><strong>Incorrect Baud Rate:</strong></p>
<ul>
<li>Verify F_CPU is correct</li>
<li>Check UBRR calculation</li>
<li>Use standard baud rates</li>
</ul>
<p><strong>Fuse Bits:</strong></p>
<pre><code class="language-bash"># Read fuses
avrdude -c arduino -p atmega328p -U lfuse:r:-:h -U hfuse:r:-:h -U efuse:r:-:h

# Set fuses (CAREFUL\!)
# Default for Arduino Uno: lfuse=0xFF, hfuse=0xDE, efuse=0xFD
avrdude -c arduino -p atmega328p -U lfuse:w:0xFF:m -U hfuse:w:0xDE:m -U efuse:w:0xFD:m
</code></pre>
<h2 id="resources-31"><a class="header" href="#resources-31">Resources</a></h2>
<ul>
<li><strong>AVR Libc Documentation</strong>: https://www.nongnu.org/avr-libc/</li>
<li><strong>Datasheets</strong>: https://www.microchip.com/</li>
<li><strong>AVR Tutorials</strong>: https://www.avrfreaks.net/</li>
<li><strong>Community</strong>: AVRFreaks forum</li>
</ul>
<h2 id="see-also-1"><a class="header" href="#see-also-1">See Also</a></h2>
<ul>
<li><a href="embedded/arduino.html">Arduino Programming</a> - Higher-level AVR programming</li>
<li><a href="embedded/gpio.html">GPIO Concepts</a></li>
<li><a href="embedded/uart.html">UART Communication</a></li>
<li><a href="embedded/spi.html">SPI Protocol</a></li>
<li><a href="embedded/i2c.html">I2C Protocol</a></li>
<li><a href="embedded/timers.html">Timers and PWM</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="stm32-microcontrollers"><a class="header" href="#stm32-microcontrollers">STM32 Microcontrollers</a></h1>
<p>Comprehensive guide to STM32 development using HAL, CubeMX, and bare-metal programming.</p>
<h2 id="table-of-contents-37"><a class="header" href="#table-of-contents-37">Table of Contents</a></h2>
<ol>
<li><a href="embedded/stm32.html#introduction">Introduction</a></li>
<li><a href="embedded/stm32.html#stm32-families">STM32 Families</a></li>
<li><a href="embedded/stm32.html#development-setup">Development Setup</a></li>
<li><a href="embedded/stm32.html#stm32cubemx">STM32CubeMX</a></li>
<li><a href="embedded/stm32.html#hal-programming">HAL Programming</a></li>
<li><a href="embedded/stm32.html#bare-metal-programming">Bare Metal Programming</a></li>
<li><a href="embedded/stm32.html#common-peripherals">Common Peripherals</a></li>
<li><a href="embedded/stm32.html#advanced-topics">Advanced Topics</a></li>
</ol>
<h2 id="introduction-17"><a class="header" href="#introduction-17">Introduction</a></h2>
<p>STM32 is a family of 32-bit microcontrollers from STMicroelectronics based on ARM Cortex-M cores. They offer excellent performance, rich peripherals, and are widely used in professional and industrial applications.</p>
<h3 id="key-features-10"><a class="header" href="#key-features-10">Key Features</a></h3>
<ul>
<li><strong>ARM Cortex-M Cores</strong>: M0, M0+, M3, M4, M7, M33</li>
<li><strong>Clock Speed</strong>: 48 MHz to 550 MHz</li>
<li><strong>Memory</strong>: 16 KB to 2 MB Flash, 4 KB to 1 MB RAM</li>
<li><strong>Peripherals</strong>: GPIO, UART, SPI, I2C, ADC, DAC, Timers, USB, CAN, Ethernet</li>
<li><strong>Development Tools</strong>: Free official IDE and HAL libraries</li>
<li><strong>Price</strong>: $1 to $20 depending on series</li>
</ul>
<h3 id="advantages-1"><a class="header" href="#advantages-1">Advantages</a></h3>
<ul>
<li>Professional-grade reliability</li>
<li>Extensive peripheral set</li>
<li>Low power consumption</li>
<li>Strong ecosystem and support</li>
<li>Pin-compatible families</li>
<li>Real-time performance</li>
</ul>
<h2 id="stm32-families"><a class="header" href="#stm32-families">STM32 Families</a></h2>
<h3 id="overview-62"><a class="header" href="#overview-62">Overview</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Family</th><th>Core</th><th>Speed</th><th>Flash</th><th>Use Case</th><th>Examples</th></tr></thead><tbody>
<tr><td><strong>F0</strong></td><td>M0</td><td>48 MHz</td><td>16-256 KB</td><td>Entry-level, cost-sensitive</td><td>STM32F030</td></tr>
<tr><td><strong>F1</strong></td><td>M3</td><td>72 MHz</td><td>16-512 KB</td><td>General purpose, classic</td><td>STM32F103 (Blue Pill)</td></tr>
<tr><td><strong>F4</strong></td><td>M4</td><td>180 MHz</td><td>256 KB-2 MB</td><td>High performance, DSP, FPU</td><td>STM32F407, F429</td></tr>
<tr><td><strong>F7</strong></td><td>M7</td><td>216 MHz</td><td>512 KB-2 MB</td><td>Very high performance</td><td>STM32F746</td></tr>
<tr><td><strong>H7</strong></td><td>M7</td><td>480 MHz</td><td>1-2 MB</td><td>Extreme performance</td><td>STM32H743</td></tr>
<tr><td><strong>L0/L4</strong></td><td>M0+/M4</td><td>32-80 MHz</td><td>16-512 KB</td><td>Ultra-low power</td><td>STM32L476</td></tr>
<tr><td><strong>G0/G4</strong></td><td>M0+/M4</td><td>64-170 MHz</td><td>32-512 KB</td><td>Mainstream, motor control</td><td>STM32G474</td></tr>
</tbody></table>
</div>
<h3 id="popular-development-boards"><a class="header" href="#popular-development-boards">Popular Development Boards</a></h3>
<h4 id="stm32-nucleo-boards"><a class="header" href="#stm32-nucleo-boards">STM32 Nucleo Boards</a></h4>
<pre><code>┌────────────────────────────────┐
│  STM32 Nucleo-64               │
│                                 │
│  ┌─────────────────┐           │
│  │   STM32 MCU     │           │
│  │   (QFP64)       │           │
│  └─────────────────┘           │
│                                 │
│  [CN7] ═══════════════ [CN10]  │  Arduino Headers
│  [CN8] ═══════════════ [CN9]   │
│                                 │
│  [CN1] ST-LINK V2-1            │
│  [USB]                         │
└────────────────────────────────┘

Features:
- Integrated ST-LINK debugger/programmer
- Arduino Uno R3 compatible headers
- Morpho extension headers (full pin access)
- Virtual COM port
- Price: ~$15
</code></pre>
<h4 id="blue-pill-stm32f103c8t6"><a class="header" href="#blue-pill-stm32f103c8t6">Blue Pill (STM32F103C8T6)</a></h4>
<pre><code>┌──────────────────────────┐
│     STM32F103C8T6        │
│     "Blue Pill"          │
│                          │
│  [USB] ═══════════ [SWD] │
│                          │
│  ╔════════════════════╗  │
│  ║  Header Pins       ║  │
│  ║  (40 pins total)   ║  │
│  ╚════════════════════╝  │
│                          │
│  [3.3V] [5V] [GND]       │
└──────────────────────────┘

Specs:
- 72 MHz ARM Cortex-M3
- 64 KB Flash, 20 KB RAM
- 37 GPIO pins
- 2x SPI, 2x I2C, 3x USART
- 12-bit ADC, 2x DAC
- Price: ~$2
</code></pre>
<h2 id="development-setup-1"><a class="header" href="#development-setup-1">Development Setup</a></h2>
<h3 id="stm32cubeide-recommended"><a class="header" href="#stm32cubeide-recommended">STM32CubeIDE (Recommended)</a></h3>
<pre><code class="language-bash"># Download from ST website:
# https://www.st.com/en/development-tools/stm32cubeide.html

# Linux installation:
sudo chmod +x st-stm32cubeide_*.sh
sudo ./st-stm32cubeide_*.sh

# Install udev rules for ST-LINK
sudo cp ~/STMicroelectronics/STM32Cube/STM32CubeIDE/Drivers/rules/*.* /etc/udev/rules.d/
sudo udevadm control --reload-rules
</code></pre>
<h3 id="alternative-command-line-setup"><a class="header" href="#alternative-command-line-setup">Alternative: Command Line Setup</a></h3>
<pre><code class="language-bash"># Install ARM toolchain
sudo apt install gcc-arm-none-eabi gdb-multiarch

# Install OpenOCD (programming/debugging)
sudo apt install openocd

# Install st-link utilities
sudo apt install stlink-tools

# Verify installation
arm-none-eabi-gcc --version
openocd --version
st-info --version
</code></pre>
<h3 id="platformio-setup"><a class="header" href="#platformio-setup">PlatformIO Setup</a></h3>
<pre><code class="language-bash">pip install platformio

# Create project
pio init --board nucleo_f401re

# platformio.ini
[env:nucleo_f401re]
platform = ststm32
board = nucleo_f401re
framework = arduino
# or framework = stm32cube
</code></pre>
<h2 id="stm32cubemx"><a class="header" href="#stm32cubemx">STM32CubeMX</a></h2>
<p>STM32CubeMX is a graphical configuration tool that generates initialization code for STM32 microcontrollers.</p>
<h3 id="creating-a-project"><a class="header" href="#creating-a-project">Creating a Project</a></h3>
<ol>
<li>
<p><strong>Start New Project</strong></p>
<ul>
<li>File &gt; New Project</li>
<li>Select your MCU or board</li>
<li>Click "Start Project"</li>
</ul>
</li>
<li>
<p><strong>Configure Clock</strong></p>
<ul>
<li>Clock Configuration tab</li>
<li>Set HSE/HSI source</li>
<li>Configure PLL multipliers</li>
<li>Set system clock (HCLK)</li>
</ul>
</li>
<li>
<p><strong>Configure Peripherals</strong></p>
<ul>
<li>Pinout &amp; Configuration tab</li>
<li>Click on pins to assign functions</li>
<li>Configure peripheral parameters</li>
</ul>
</li>
<li>
<p><strong>Generate Code</strong></p>
<ul>
<li>Project Manager tab</li>
<li>Set project name and location</li>
<li>Select toolchain (STM32CubeIDE, Makefile, etc.)</li>
<li>Click "Generate Code"</li>
</ul>
</li>
</ol>
<h3 id="example-blink-led-configuration"><a class="header" href="#example-blink-led-configuration">Example: Blink LED Configuration</a></h3>
<pre><code>1. Pinout Configuration:
   - Find LED pin (e.g., PC13 on Blue Pill)
   - Set as GPIO_Output
   - Label it "LED"

2. GPIO Configuration:
   - Mode: Output Push Pull
   - Pull-up/Pull-down: No pull-up and no pull-down
   - Maximum output speed: Low
   - User Label: LED

3. Clock Configuration:
   - HSE: 8 MHz (external crystal)
   - PLL: ×9 (72 MHz system clock)

4. Generate Code
</code></pre>
<h3 id="project-structure-3"><a class="header" href="#project-structure-3">Project Structure</a></h3>
<pre><code>project/
├── Core/
│   ├── Inc/
│   │   ├── main.h
│   │   ├── stm32f1xx_it.h
│   │   └── stm32f1xx_hal_conf.h
│   └── Src/
│       ├── main.c
│       ├── stm32f1xx_it.c
│       └── system_stm32f1xx.c
├── Drivers/
│   ├── STM32F1xx_HAL_Driver/
│   └── CMSIS/
└── Makefile
</code></pre>
<h2 id="hal-programming"><a class="header" href="#hal-programming">HAL Programming</a></h2>
<h3 id="basic-hal-blink"><a class="header" href="#basic-hal-blink">Basic HAL Blink</a></h3>
<pre><code class="language-c">/* main.c - Generated by CubeMX */
#include "main.h"

GPIO_InitTypeDef GPIO_InitStruct = {0};

void SystemClock_Config(void);
static void MX_GPIO_Init(void);

int main(void) {
    /* Initialize HAL Library */
    HAL_Init();
    
    /* Configure system clock */
    SystemClock_Config();
    
    /* Initialize GPIO */
    MX_GPIO_Init();
    
    /* Infinite loop */
    while (1) {
        HAL_GPIO_TogglePin(GPIOC, GPIO_PIN_13);
        HAL_Delay(1000);
    }
}

static void MX_GPIO_Init(void) {
    /* Enable GPIO Clock */
    __HAL_RCC_GPIOC_CLK_ENABLE();
    
    /* Configure GPIO pin */
    GPIO_InitStruct.Pin = GPIO_PIN_13;
    GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_PP;
    GPIO_InitStruct.Pull = GPIO_NOPULL;
    GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_LOW;
    HAL_GPIO_Init(GPIOC, &amp;GPIO_InitStruct);
}

void SystemClock_Config(void) {
    /* Generated by CubeMX - configures clocks */
}
</code></pre>
<h3 id="gpio-functions"><a class="header" href="#gpio-functions">GPIO Functions</a></h3>
<pre><code class="language-c">/* Write pin */
HAL_GPIO_WritePin(GPIOC, GPIO_PIN_13, GPIO_PIN_SET);    // High
HAL_GPIO_WritePin(GPIOC, GPIO_PIN_13, GPIO_PIN_RESET);  // Low

/* Toggle pin */
HAL_GPIO_TogglePin(GPIOC, GPIO_PIN_13);

/* Read pin */
GPIO_PinState state = HAL_GPIO_ReadPin(GPIOA, GPIO_PIN_0);

/* External interrupt */
HAL_GPIO_EXTI_IRQHandler(GPIO_PIN_0);  // Call in ISR
void HAL_GPIO_EXTI_Callback(uint16_t GPIO_Pin);  // Override this
</code></pre>
<h3 id="button-with-interrupt"><a class="header" href="#button-with-interrupt">Button with Interrupt</a></h3>
<pre><code class="language-c">/* Configure button with external interrupt in CubeMX:
   PA0 -&gt; GPIO_EXTI0
   Mode: External Interrupt Mode with Rising edge trigger detection
   Pull-up: Pull-up
   
   In NVIC tab: Enable EXTI line0 interrupt
*/

/* main.c */
volatile uint8_t button_pressed = 0;

int main(void) {
    HAL_Init();
    SystemClock_Config();
    MX_GPIO_Init();
    
    while (1) {
        if (button_pressed) {
            button_pressed = 0;
            HAL_GPIO_TogglePin(GPIOC, GPIO_PIN_13);
        }
    }
}

/* Interrupt callback - implement this */
void HAL_GPIO_EXTI_Callback(uint16_t GPIO_Pin) {
    if (GPIO_Pin == GPIO_PIN_0) {
        button_pressed = 1;
    }
}

/* stm32f1xx_it.c - Generated by CubeMX */
void EXTI0_IRQHandler(void) {
    HAL_GPIO_EXTI_IRQHandler(GPIO_PIN_0);
}
</code></pre>
<h3 id="uart-communication"><a class="header" href="#uart-communication">UART Communication</a></h3>
<pre><code class="language-c">/* Configure UART in CubeMX:
   USART1: PA9 (TX), PA10 (RX)
   Baud Rate: 115200
   Word Length: 8 Bits
   Stop Bits: 1
   Parity: None
*/

UART_HandleTypeDef huart1;

int main(void) {
    HAL_Init();
    SystemClock_Config();
    MX_USART1_UART_Init();
    
    uint8_t msg[] = "Hello, STM32!\r\n";
    HAL_UART_Transmit(&amp;huart1, msg, sizeof(msg)-1, HAL_MAX_DELAY);
    
    uint8_t rx_buffer[10];
    while (1) {
        /* Blocking receive */
        HAL_UART_Receive(&amp;huart1, rx_buffer, 1, HAL_MAX_DELAY);
        
        /* Echo back */
        HAL_UART_Transmit(&amp;huart1, rx_buffer, 1, HAL_MAX_DELAY);
    }
}

/* printf redirect */
int _write(int file, char *ptr, int len) {
    HAL_UART_Transmit(&amp;huart1, (uint8_t*)ptr, len, HAL_MAX_DELAY);
    return len;
}
</code></pre>
<h3 id="adc-reading"><a class="header" href="#adc-reading">ADC Reading</a></h3>
<pre><code class="language-c">/* Configure ADC in CubeMX:
   ADC1, Channel 0 (PA0)
   Resolution: 12 bits
   Continuous Conversion: Disabled
*/

ADC_HandleTypeDef hadc1;

int main(void) {
    HAL_Init();
    SystemClock_Config();
    MX_ADC1_Init();
    
    while (1) {
        HAL_ADC_Start(&amp;hadc1);
        HAL_ADC_PollForConversion(&amp;hadc1, HAL_MAX_DELAY);
        uint32_t adc_value = HAL_ADC_GetValue(&amp;hadc1);
        
        /* Convert to voltage (3.3V reference, 12-bit) */
        float voltage = (adc_value * 3.3f) / 4096.0f;
        
        printf("ADC: %lu, Voltage: %.2f V\r\n", adc_value, voltage);
        
        HAL_Delay(1000);
    }
}
</code></pre>
<h3 id="pwm-output"><a class="header" href="#pwm-output">PWM Output</a></h3>
<pre><code class="language-c">/* Configure Timer in CubeMX:
   TIM2, Channel 1 (PA0)
   Mode: PWM Generation CH1
   Prescaler: 72-1 (1 MHz timer clock)
   Counter Period: 1000-1 (1 kHz PWM)
*/

TIM_HandleTypeDef htim2;

int main(void) {
    HAL_Init();
    SystemClock_Config();
    MX_TIM2_Init();
    
    /* Start PWM */
    HAL_TIM_PWM_Start(&amp;htim2, TIM_CHANNEL_1);
    
    while (1) {
        /* Fade in */
        for (uint16_t duty = 0; duty &lt;= 1000; duty += 10) {
            __HAL_TIM_SET_COMPARE(&amp;htim2, TIM_CHANNEL_1, duty);
            HAL_Delay(10);
        }
        
        /* Fade out */
        for (uint16_t duty = 1000; duty &gt; 0; duty -= 10) {
            __HAL_TIM_SET_COMPARE(&amp;htim2, TIM_CHANNEL_1, duty);
            HAL_Delay(10);
        }
    }
}
</code></pre>
<h3 id="i2c-communication"><a class="header" href="#i2c-communication">I2C Communication</a></h3>
<pre><code class="language-c">/* Configure I2C in CubeMX:
   I2C1: PB6 (SCL), PB7 (SDA)
   Speed: 100 kHz (Standard Mode)
*/

I2C_HandleTypeDef hi2c1;

#define DEVICE_ADDR 0x68 &lt;&lt; 1  // 7-bit address shifted

int main(void) {
    HAL_Init();
    SystemClock_Config();
    MX_I2C1_Init();
    
    uint8_t tx_data = 0x00;
    uint8_t rx_data[2];
    
    while (1) {
        /* Write register address */
        HAL_I2C_Master_Transmit(&amp;hi2c1, DEVICE_ADDR, &amp;tx_data, 1, HAL_MAX_DELAY);
        
        /* Read data */
        HAL_I2C_Master_Receive(&amp;hi2c1, DEVICE_ADDR, rx_data, 2, HAL_MAX_DELAY);
        
        HAL_Delay(1000);
    }
}
</code></pre>
<h3 id="spi-communication"><a class="header" href="#spi-communication">SPI Communication</a></h3>
<pre><code class="language-c">/* Configure SPI in CubeMX:
   SPI1: PA5 (SCK), PA6 (MISO), PA7 (MOSI)
   Mode: Master
   Baud Rate Prescaler: 32
   Data Size: 8 Bits
*/

SPI_HandleTypeDef hspi1;

#define CS_PIN GPIO_PIN_4
#define CS_PORT GPIOA

int main(void) {
    HAL_Init();
    SystemClock_Config();
    MX_SPI1_Init();
    MX_GPIO_Init();  // CS pin
    
    uint8_t tx_data[] = {0x01, 0x02, 0x03};
    uint8_t rx_data[3];
    
    while (1) {
        /* Select device */
        HAL_GPIO_WritePin(CS_PORT, CS_PIN, GPIO_PIN_RESET);
        
        /* Transfer data */
        HAL_SPI_TransmitReceive(&amp;hspi1, tx_data, rx_data, 3, HAL_MAX_DELAY);
        
        /* Deselect device */
        HAL_GPIO_WritePin(CS_PORT, CS_PIN, GPIO_PIN_SET);
        
        HAL_Delay(1000);
    }
}
</code></pre>
<h2 id="bare-metal-programming"><a class="header" href="#bare-metal-programming">Bare Metal Programming</a></h2>
<h3 id="direct-register-access"><a class="header" href="#direct-register-access">Direct Register Access</a></h3>
<pre><code class="language-c">/* Blink LED without HAL - STM32F103 */
#include "stm32f1xx.h"

int main(void) {
    /* Enable GPIOC clock */
    RCC-&gt;APB2ENR |= RCC_APB2ENR_IOPCEN;
    
    /* Configure PC13 as output push-pull, max speed 2 MHz */
    GPIOC-&gt;CRH &amp;= ~(GPIO_CRH_MODE13 | GPIO_CRH_CNF13);
    GPIOC-&gt;CRH |= GPIO_CRH_MODE13_1;  // Output mode, 2 MHz
    
    while (1) {
        /* Toggle LED */
        GPIOC-&gt;ODR ^= GPIO_ODR_ODR13;
        
        /* Delay */
        for (volatile uint32_t i = 0; i &lt; 1000000; i++);
    }
}
</code></pre>
<h3 id="gpio-register-operations"><a class="header" href="#gpio-register-operations">GPIO Register Operations</a></h3>
<pre><code class="language-c">/* Set pin high */
GPIOC-&gt;BSRR = GPIO_BSRR_BS13;    // Bit Set

/* Set pin low */
GPIOC-&gt;BSRR = GPIO_BSRR_BR13;    // Bit Reset

/* Toggle pin */
GPIOC-&gt;ODR ^= GPIO_ODR_ODR13;

/* Read pin */
uint32_t state = GPIOA-&gt;IDR &amp; GPIO_IDR_IDR0;
</code></pre>
<h3 id="uart-bare-metal"><a class="header" href="#uart-bare-metal">UART Bare Metal</a></h3>
<pre><code class="language-c">/* Initialize UART1 - 115200 baud, 72 MHz clock */
void UART1_Init(void) {
    /* Enable clocks */
    RCC-&gt;APB2ENR |= RCC_APB2ENR_USART1EN | RCC_APB2ENR_IOPAEN;
    
    /* Configure PA9 (TX) as alternate function push-pull */
    GPIOA-&gt;CRH &amp;= ~(GPIO_CRH_MODE9 | GPIO_CRH_CNF9);
    GPIOA-&gt;CRH |= GPIO_CRH_MODE9_1 | GPIO_CRH_CNF9_1;
    
    /* Configure PA10 (RX) as input floating */
    GPIOA-&gt;CRH &amp;= ~(GPIO_CRH_MODE10 | GPIO_CRH_CNF10);
    GPIOA-&gt;CRH |= GPIO_CRH_CNF10_0;
    
    /* Configure UART */
    USART1-&gt;BRR = 0x271;  // 115200 baud at 72 MHz
    USART1-&gt;CR1 = USART_CR1_TE | USART_CR1_RE | USART_CR1_UE;
}

void UART1_SendChar(char c) {
    while (!(USART1-&gt;SR &amp; USART_SR_TXE));
    USART1-&gt;DR = c;
}

char UART1_ReceiveChar(void) {
    while (!(USART1-&gt;SR &amp; USART_SR_RXNE));
    return USART1-&gt;DR;
}
</code></pre>
<h3 id="timer-interrupt"><a class="header" href="#timer-interrupt">Timer Interrupt</a></h3>
<pre><code class="language-c">/* Configure TIM2 for 1 second interrupt */
void TIM2_Init(void) {
    /* Enable TIM2 clock */
    RCC-&gt;APB1ENR |= RCC_APB1ENR_TIM2EN;
    
    /* Configure timer:
       72 MHz / 7200 = 10 kHz
       10 kHz / 10000 = 1 Hz (1 second)
    */
    TIM2-&gt;PSC = 7200 - 1;      // Prescaler
    TIM2-&gt;ARR = 10000 - 1;     // Auto-reload
    TIM2-&gt;DIER |= TIM_DIER_UIE;  // Update interrupt enable
    TIM2-&gt;CR1 |= TIM_CR1_CEN;    // Enable timer
    
    /* Enable interrupt in NVIC */
    NVIC_EnableIRQ(TIM2_IRQn);
}

/* Interrupt handler */
void TIM2_IRQHandler(void) {
    if (TIM2-&gt;SR &amp; TIM_SR_UIF) {
        TIM2-&gt;SR &amp;= ~TIM_SR_UIF;  // Clear interrupt flag
        
        /* Toggle LED */
        GPIOC-&gt;ODR ^= GPIO_ODR_ODR13;
    }
}
</code></pre>
<h2 id="common-peripherals"><a class="header" href="#common-peripherals">Common Peripherals</a></h2>
<h3 id="dma-transfer"><a class="header" href="#dma-transfer">DMA Transfer</a></h3>
<pre><code class="language-c">/* Configure DMA for UART TX in CubeMX:
   DMA1, Channel 4
   Direction: Memory to Peripheral
   Mode: Normal
*/

uint8_t tx_buffer[] = "Hello from DMA!\r\n";

int main(void) {
    HAL_Init();
    SystemClock_Config();
    MX_USART1_UART_Init();
    MX_DMA_Init();
    
    while (1) {
        HAL_UART_Transmit_DMA(&amp;huart1, tx_buffer, sizeof(tx_buffer)-1);
        HAL_Delay(1000);
    }
}

/* DMA transfer complete callback */
void HAL_UART_TxCpltCallback(UART_HandleTypeDef *huart) {
    /* Transfer complete - can start next */
}
</code></pre>
<h3 id="rtc-real-time-clock"><a class="header" href="#rtc-real-time-clock">RTC (Real-Time Clock)</a></h3>
<pre><code class="language-c">/* Configure RTC in CubeMX:
   RTC Activated
   Clock Source: LSE (32.768 kHz)
*/

RTC_TimeTypeDef sTime;
RTC_DateTypeDef sDate;

int main(void) {
    HAL_Init();
    SystemClock_Config();
    MX_RTC_Init();
    
    /* Set time */
    sTime.Hours = 12;
    sTime.Minutes = 0;
    sTime.Seconds = 0;
    HAL_RTC_SetTime(&amp;hrtc, &amp;sTime, RTC_FORMAT_BIN);
    
    /* Set date */
    sDate.Year = 24;
    sDate.Month = 1;
    sDate.Date = 15;
    HAL_RTC_SetDate(&amp;hrtc, &amp;sDate, RTC_FORMAT_BIN);
    
    while (1) {
        HAL_RTC_GetTime(&amp;hrtc, &amp;sTime, RTC_FORMAT_BIN);
        HAL_RTC_GetDate(&amp;hrtc, &amp;sDate, RTC_FORMAT_BIN);
        
        printf("%02d:%02d:%02d\r\n", 
               sTime.Hours, sTime.Minutes, sTime.Seconds);
        
        HAL_Delay(1000);
    }
}
</code></pre>
<h3 id="watchdog-timer-1"><a class="header" href="#watchdog-timer-1">Watchdog Timer</a></h3>
<pre><code class="language-c">/* Configure IWDG in CubeMX:
   Independent Watchdog
   Prescaler: 32
   Counter Reload Value: 4095 (max ~4 seconds)
*/

IWDG_HandleTypeDef hiwdg;

int main(void) {
    HAL_Init();
    SystemClock_Config();
    MX_IWDG_Init();
    
    while (1) {
        /* Main program tasks */
        
        /* Refresh watchdog */
        HAL_IWDG_Refresh(&amp;hiwdg);
        
        HAL_Delay(100);
    }
}
</code></pre>
<h2 id="advanced-topics-1"><a class="header" href="#advanced-topics-1">Advanced Topics</a></h2>
<h3 id="freertos-integration"><a class="header" href="#freertos-integration">FreeRTOS Integration</a></h3>
<pre><code class="language-c">/* Enable FreeRTOS in CubeMX */
#include "FreeRTOS.h"
#include "task.h"

void Task1(void *argument);
void Task2(void *argument);

int main(void) {
    HAL_Init();
    SystemClock_Config();
    MX_GPIO_Init();
    
    /* Create tasks */
    xTaskCreate(Task1, "Task1", 128, NULL, 1, NULL);
    xTaskCreate(Task2, "Task2", 128, NULL, 1, NULL);
    
    /* Start scheduler */
    vTaskStartScheduler();
    
    /* Never reached */
    while (1);
}

void Task1(void *argument) {
    while (1) {
        HAL_GPIO_TogglePin(GPIOC, GPIO_PIN_13);
        vTaskDelay(pdMS_TO_TICKS(500));
    }
}

void Task2(void *argument) {
    while (1) {
        /* Other task */
        vTaskDelay(pdMS_TO_TICKS(1000));
    }
}
</code></pre>
<h3 id="low-power-modes"><a class="header" href="#low-power-modes">Low Power Modes</a></h3>
<pre><code class="language-c">/* Enter Stop mode */
HAL_PWR_EnterSTOPMode(PWR_LOWPOWERREGULATOR_ON, PWR_STOPENTRY_WFI);

/* Enter Standby mode */
HAL_PWR_EnterSTANDBYMode();

/* Enter Sleep mode */
HAL_PWR_EnterSLEEPMode(PWR_MAINREGULATOR_ON, PWR_SLEEPENTRY_WFI);
</code></pre>
<h3 id="bootloader"><a class="header" href="#bootloader">Bootloader</a></h3>
<pre><code class="language-c">/* Jump to bootloader (system memory) */
void JumpToBootloader(void) {
    void (*SysMemBootJump)(void);
    
    /* Set bootloader address (STM32F1: 0x1FFFF000) */
    volatile uint32_t addr = 0x1FFFF000;
    
    /* Disable interrupts */
    __disable_irq();
    
    /* Remap system memory to 0x00000000 */
    __HAL_RCC_SYSCFG_CLK_ENABLE();
    __HAL_SYSCFG_REMAPMEMORY_SYSTEMFLASH();
    
    /* Set jump address */
    SysMemBootJump = (void (*)(void)) (*((uint32_t *)(addr + 4)));
    
    /* Set main stack pointer */
    __set_MSP(*(uint32_t *)addr);
    
    /* Jump */
    SysMemBootJump();
    
    while (1);
}
</code></pre>
<h2 id="best-practices-58"><a class="header" href="#best-practices-58">Best Practices</a></h2>
<ol>
<li><strong>Use CubeMX</strong>: Generate initialization code automatically</li>
<li><strong>HAL vs LL</strong>: HAL for ease, LL for performance</li>
<li><strong>Interrupts</strong>: Keep ISRs short, use callbacks</li>
<li><strong>DMA</strong>: Use for high-speed data transfers</li>
<li><strong>Power</strong>: Disable unused peripherals</li>
<li><strong>Debugging</strong>: Use SWD with ST-LINK</li>
<li><strong>Version Control</strong>: Track CubeMX .ioc files</li>
</ol>
<h2 id="troubleshooting-16"><a class="header" href="#troubleshooting-16">Troubleshooting</a></h2>
<h3 id="common-issues-17"><a class="header" href="#common-issues-17">Common Issues</a></h3>
<p><strong>Debugger Not Connecting:</strong></p>
<pre><code class="language-bash"># Check ST-LINK connection
st-info --probe

# Reset ST-LINK
st-flash reset

# Update ST-LINK firmware
# Use STM32 ST-LINK Utility
</code></pre>
<p><strong>Clock Configuration:</strong></p>
<ul>
<li>Verify HSE frequency matches hardware</li>
<li>Check PLL multipliers for target frequency</li>
<li>Enable required peripheral clocks</li>
</ul>
<p><strong>GPIO Not Working:</strong></p>
<ul>
<li>Enable GPIO clock first</li>
<li>Check pin alternate functions</li>
<li>Verify pin configuration (mode, speed, pull)</li>
</ul>
<p><strong>Printf Not Working:</strong></p>
<pre><code class="language-c">// Enable semi-hosting or retarget _write()
int _write(int file, char *ptr, int len) {
    HAL_UART_Transmit(&amp;huart1, (uint8_t*)ptr, len, HAL_MAX_DELAY);
    return len;
}
</code></pre>
<h2 id="resources-32"><a class="header" href="#resources-32">Resources</a></h2>
<ul>
<li><strong>STM32 Website</strong>: https://www.st.com/stm32</li>
<li><strong>CubeMX</strong>: https://www.st.com/en/development-tools/stm32cubemx.html</li>
<li><strong>HAL Documentation</strong>: STM32 HAL user manual per family</li>
<li><strong>Reference Manuals</strong>: Detailed peripheral descriptions</li>
<li><strong>Community</strong>: https://community.st.com/</li>
</ul>
<h2 id="see-also-2"><a class="header" href="#see-also-2">See Also</a></h2>
<ul>
<li><a href="embedded/arm.html">ARM Cortex-M Architecture</a></li>
<li><a href="embedded/gpio.html">GPIO Programming</a></li>
<li><a href="embedded/uart.html">UART Communication</a></li>
<li><a href="embedded/spi.html">SPI Protocol</a></li>
<li><a href="embedded/i2c.html">I2C Protocol</a></li>
<li><a href="embedded/../rtos/freertos.html">FreeRTOS</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="esp32"><a class="header" href="#esp32">ESP32</a></h1>
<p>Comprehensive guide to ESP32 microcontroller development with WiFi and Bluetooth capabilities.</p>
<h2 id="table-of-contents-38"><a class="header" href="#table-of-contents-38">Table of Contents</a></h2>
<ol>
<li><a href="embedded/esp32.html#introduction">Introduction</a></li>
<li><a href="embedded/esp32.html#hardware-overview">Hardware Overview</a></li>
<li><a href="embedded/esp32.html#development-setup">Development Setup</a></li>
<li><a href="embedded/esp32.html#basic-programming">Basic Programming</a></li>
<li><a href="embedded/esp32.html#wifi-connectivity">WiFi Connectivity</a></li>
<li><a href="embedded/esp32.html#bluetooth">Bluetooth</a></li>
<li><a href="embedded/esp32.html#advanced-features">Advanced Features</a></li>
<li><a href="embedded/esp32.html#projects">Projects</a></li>
</ol>
<h2 id="introduction-18"><a class="header" href="#introduction-18">Introduction</a></h2>
<p>The ESP32 is a powerful, low-cost microcontroller with integrated WiFi and Bluetooth. Developed by Espressif Systems, it's ideal for IoT projects and wireless applications.</p>
<h3 id="key-features-11"><a class="header" href="#key-features-11">Key Features</a></h3>
<ul>
<li><strong>Dual-core Xtensa LX6</strong> (or single-core RISC-V in ESP32-C3)</li>
<li><strong>Clock Speed</strong>: 160-240 MHz</li>
<li><strong>Memory</strong>: 520 KB SRAM, 4 MB Flash (typical)</li>
<li><strong>WiFi</strong>: 802.11 b/g/n (2.4 GHz)</li>
<li><strong>Bluetooth</strong>: BLE 4.2 and Classic Bluetooth</li>
<li><strong>GPIO</strong>: Up to 34 programmable pins</li>
<li><strong>Peripherals</strong>: ADC, DAC, SPI, I2C, UART, PWM, I2S</li>
<li><strong>Low Power</strong>: Multiple sleep modes</li>
<li><strong>Price</strong>: $2-$10 depending on variant</li>
</ul>
<h3 id="esp32-variants"><a class="header" href="#esp32-variants">ESP32 Variants</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Variant</th><th>Cores</th><th>WiFi</th><th>BLE</th><th>Classic BT</th><th>USB</th><th>Special Features</th></tr></thead><tbody>
<tr><td><strong>ESP32</strong></td><td>2</td><td>Yes</td><td>Yes</td><td>Yes</td><td>No</td><td>Original, most common</td></tr>
<tr><td><strong>ESP32-S2</strong></td><td>1</td><td>Yes</td><td>No</td><td>No</td><td>Native</td><td>USB OTG, lower power</td></tr>
<tr><td><strong>ESP32-S3</strong></td><td>2</td><td>Yes</td><td>Yes</td><td>No</td><td>Native</td><td>Vector instructions</td></tr>
<tr><td><strong>ESP32-C3</strong></td><td>1 (RISC-V)</td><td>Yes</td><td>Yes</td><td>No</td><td>Native</td><td>RISC-V architecture</td></tr>
<tr><td><strong>ESP32-C6</strong></td><td>1 (RISC-V)</td><td>Yes</td><td>Yes</td><td>No</td><td>Native</td><td>WiFi 6, Zigbee</td></tr>
</tbody></table>
</div>
<h2 id="hardware-overview"><a class="header" href="#hardware-overview">Hardware Overview</a></h2>
<h3 id="esp32-devkit-pinout"><a class="header" href="#esp32-devkit-pinout">ESP32 DevKit Pinout</a></h3>
<pre><code>                    ESP32 DevKit
                ┌─────────────────┐
                │      USB        │
                ├─────────────────┤
    3V3    [ ]──┤3V3           D23├──[ ] MOSI
    EN     [ ]──┤EN            D22├──[ ] SCL (I2C)
    VP/36  [ ]──┤VP/A0         TX0├──[ ] TX
    VN/39  [ ]──┤VN/A3         RX0├──[ ] RX
    D34    [ ]──┤34/A6         D21├──[ ] SDA (I2C)
    D35    [ ]──┤35/A7         GND├──[ ] GND
    D32    [ ]──┤32/A4         D19├──[ ] MISO
    D33    [ ]──┤33/A5         D18├──[ ] SCK
    D25    [ ]──┤25/A18        D5 ├──[ ] SS
    D26    [ ]──┤26/A19        D17├──[ ] TX2
    D27    [ ]──┤27/A17        D16├──[ ] RX2
    D14    [ ]──┤14/A16        D4 ├──[ ]
    D12    [ ]──┤12/A15        D0 ├──[ ] (Boot)
    GND    [ ]──┤GND           D2 ├──[ ] (LED)
    D13    [ ]──┤13/A14        D15├──[ ]
    D9     [ ]──┤9/SD2          D8├──[ ] SD1
    D10    [ ]──┤10/SD3         D7├──[ ] SD0
    D11    [ ]──┤11/CMD         D6├──[ ] SCK
    VIN    [ ]──┤VIN            5V├──[ ] 5V
                └─────────────────┘

Note: Pins 6-11 connected to flash (avoid using)
      Pins with boot/strapping modes: 0, 2, 5, 12, 15
</code></pre>
<h3 id="important-notes"><a class="header" href="#important-notes">Important Notes</a></h3>
<ul>
<li><strong>Input Only Pins</strong>: GPIO 34-39 (no pull-up/pull-down)</li>
<li><strong>Strapping Pins</strong>: 0, 2, 5, 12, 15 (affect boot mode)</li>
<li><strong>Boot Mode</strong>: GPIO 0 LOW = download mode</li>
<li><strong>Built-in LED</strong>: Usually GPIO 2</li>
<li><strong>ADC2</strong>: Cannot use while WiFi active (GPIO 0, 2, 4, 12-15, 25-27)</li>
</ul>
<h2 id="development-setup-2"><a class="header" href="#development-setup-2">Development Setup</a></h2>
<h3 id="arduino-ide-setup"><a class="header" href="#arduino-ide-setup">Arduino IDE Setup</a></h3>
<pre><code class="language-bash"># 1. Install Arduino IDE from arduino.cc

# 2. Add ESP32 Board Manager URL:
# File &gt; Preferences &gt; Additional Board Manager URLs
# Add: https://raw.githubusercontent.com/espressif/arduino-esp32/gh-pages/package_esp32_index.json

# 3. Install ESP32 boards:
# Tools &gt; Board &gt; Boards Manager &gt; Search "ESP32" &gt; Install

# 4. Select your board:
# Tools &gt; Board &gt; ESP32 Arduino &gt; ESP32 Dev Module
</code></pre>
<h3 id="esp-idf-setup-official-framework"><a class="header" href="#esp-idf-setup-official-framework">ESP-IDF Setup (Official Framework)</a></h3>
<pre><code class="language-bash"># Clone ESP-IDF
git clone --recursive https://github.com/espressif/esp-idf.git
cd esp-idf

# Install (Linux/Mac)
./install.sh

# Set up environment (run in each terminal session)
. ./export.sh

# Or add to ~/.bashrc:
alias get_idf='. $HOME/esp/esp-idf/export.sh'

# Create new project
idf.py create-project myproject
cd myproject

# Configure
idf.py menuconfig

# Build
idf.py build

# Flash
idf.py -p /dev/ttyUSB0 flash

# Monitor serial output
idf.py -p /dev/ttyUSB0 monitor
</code></pre>
<h3 id="platformio-setup-1"><a class="header" href="#platformio-setup-1">PlatformIO Setup</a></h3>
<pre><code class="language-bash"># Install PlatformIO
pip install platformio

# Create ESP32 project
pio init --board esp32dev

# Build and upload
pio run --target upload

# Serial monitor
pio device monitor
</code></pre>
<h2 id="basic-programming"><a class="header" href="#basic-programming">Basic Programming</a></h2>
<h3 id="blink-led-arduino-framework"><a class="header" href="#blink-led-arduino-framework">Blink LED (Arduino Framework)</a></h3>
<pre><code class="language-cpp">#define LED_PIN 2

void setup() {
    pinMode(LED_PIN, OUTPUT);
}

void loop() {
    digitalWrite(LED_PIN, HIGH);
    delay(1000);
    digitalWrite(LED_PIN, LOW);
    delay(1000);
}
</code></pre>
<h3 id="dual-core-programming"><a class="header" href="#dual-core-programming">Dual Core Programming</a></h3>
<pre><code class="language-cpp">TaskHandle_t Task1;
TaskHandle_t Task2;

void setup() {
    Serial.begin(115200);
    
    // Create task for core 0
    xTaskCreatePinnedToCore(
        Task1code,   // Function
        "Task1",     // Name
        10000,       // Stack size
        NULL,        // Parameters
        1,           // Priority
        &amp;Task1,      // Task handle
        0            // Core ID
    );
    
    // Create task for core 1
    xTaskCreatePinnedToCore(
        Task2code,
        "Task2",
        10000,
        NULL,
        1,
        &amp;Task2,
        1
    );
}

void Task1code(void * parameter) {
    while(1) {
        Serial.print("Task 1 running on core ");
        Serial.println(xPortGetCoreID());
        delay(1000);
    }
}

void Task2code(void * parameter) {
    while(1) {
        Serial.print("Task 2 running on core ");
        Serial.println(xPortGetCoreID());
        delay(500);
    }
}

void loop() {
    // Empty - tasks handle everything
}
</code></pre>
<h3 id="touch-sensor"><a class="header" href="#touch-sensor">Touch Sensor</a></h3>
<pre><code class="language-cpp">const int TOUCH_PIN = 4;  // T0
const int THRESHOLD = 40;

void setup() {
    Serial.begin(115200);
}

void loop() {
    int touchValue = touchRead(TOUCH_PIN);
    Serial.println(touchValue);
    
    if (touchValue &lt; THRESHOLD) {
        Serial.println("Touch detected!");
    }
    
    delay(500);
}
</code></pre>
<h3 id="hall-effect-sensor-built-in"><a class="header" href="#hall-effect-sensor-built-in">Hall Effect Sensor (Built-in)</a></h3>
<pre><code class="language-cpp">void setup() {
    Serial.begin(115200);
}

void loop() {
    // Read built-in Hall effect sensor
    int hallValue = hallRead();
    Serial.print("Hall Sensor: ");
    Serial.println(hallValue);
    
    delay(500);
}
</code></pre>
<h2 id="wifi-connectivity"><a class="header" href="#wifi-connectivity">WiFi Connectivity</a></h2>
<h3 id="wifi-station-mode-connect-to-router"><a class="header" href="#wifi-station-mode-connect-to-router">WiFi Station Mode (Connect to Router)</a></h3>
<pre><code class="language-cpp">#include &lt;WiFi.h&gt;

const char* ssid = "YourSSID";
const char* password = "YourPassword";

void setup() {
    Serial.begin(115200);
    
    // Connect to WiFi
    WiFi.begin(ssid, password);
    Serial.print("Connecting to WiFi");
    
    while (WiFi.status() != WL_CONNECTED) {
        delay(500);
        Serial.print(".");
    }
    
    Serial.println("\nConnected!");
    Serial.print("IP Address: ");
    Serial.println(WiFi.localIP());
    Serial.print("MAC Address: ");
    Serial.println(WiFi.macAddress());
    Serial.print("Signal Strength (RSSI): ");
    Serial.print(WiFi.RSSI());
    Serial.println(" dBm");
}

void loop() {
    // Check connection
    if (WiFi.status() != WL_CONNECTED) {
        Serial.println("WiFi disconnected!");
        WiFi.reconnect();
    }
    
    delay(10000);
}
</code></pre>
<h3 id="wifi-access-point-mode"><a class="header" href="#wifi-access-point-mode">WiFi Access Point Mode</a></h3>
<pre><code class="language-cpp">#include &lt;WiFi.h&gt;

const char* ssid = "ESP32-AP";
const char* password = "12345678";  // Minimum 8 characters

void setup() {
    Serial.begin(115200);
    
    // Start Access Point
    WiFi.softAP(ssid, password);
    
    IPAddress IP = WiFi.softAPIP();
    Serial.print("AP IP address: ");
    Serial.println(IP);
}

void loop() {
    // Print number of connected stations
    Serial.print("Stations connected: ");
    Serial.println(WiFi.softAPgetStationNum());
    
    delay(5000);
}
</code></pre>
<h3 id="web-server"><a class="header" href="#web-server">Web Server</a></h3>
<pre><code class="language-cpp">#include &lt;WiFi.h&gt;
#include &lt;WebServer.h&gt;

const char* ssid = "YourSSID";
const char* password = "YourPassword";

WebServer server(80);

const int LED_PIN = 2;
bool ledState = false;

void handleRoot() {
    String html = "&lt;html&gt;&lt;body&gt;";
    html += "&lt;h1&gt;ESP32 Web Server&lt;/h1&gt;";
    html += "&lt;p&gt;LED is: " + String(ledState ? "ON" : "OFF") + "&lt;/p&gt;";
    html += "&lt;p&gt;&lt;a href=\"/led/on\"&gt;&lt;button&gt;Turn ON&lt;/button&gt;&lt;/a&gt;&lt;/p&gt;";
    html += "&lt;p&gt;&lt;a href=\"/led/off\"&gt;&lt;button&gt;Turn OFF&lt;/button&gt;&lt;/a&gt;&lt;/p&gt;";
    html += "&lt;/body&gt;&lt;/html&gt;";
    
    server.send(200, "text/html", html);
}

void handleLEDOn() {
    ledState = true;
    digitalWrite(LED_PIN, HIGH);
    server.sendHeader("Location", "/");
    server.send(303);
}

void handleLEDOff() {
    ledState = false;
    digitalWrite(LED_PIN, LOW);
    server.sendHeader("Location", "/");
    server.send(303);
}

void setup() {
    Serial.begin(115200);
    pinMode(LED_PIN, OUTPUT);
    
    // Connect to WiFi
    WiFi.begin(ssid, password);
    while (WiFi.status() != WL_CONNECTED) {
        delay(500);
        Serial.print(".");
    }
    
    Serial.println("\nConnected!");
    Serial.print("IP: ");
    Serial.println(WiFi.localIP());
    
    // Setup server routes
    server.on("/", handleRoot);
    server.on("/led/on", handleLEDOn);
    server.on("/led/off", handleLEDOff);
    
    server.begin();
    Serial.println("Web server started");
}

void loop() {
    server.handleClient();
}
</code></pre>
<h3 id="http-client-get-request"><a class="header" href="#http-client-get-request">HTTP Client (GET Request)</a></h3>
<pre><code class="language-cpp">#include &lt;WiFi.h&gt;
#include &lt;HTTPClient.h&gt;

const char* ssid = "YourSSID";
const char* password = "YourPassword";

void setup() {
    Serial.begin(115200);
    
    WiFi.begin(ssid, password);
    while (WiFi.status() != WL_CONNECTED) {
        delay(500);
        Serial.print(".");
    }
    Serial.println("\nConnected!");
}

void loop() {
    if (WiFi.status() == WL_CONNECTED) {
        HTTPClient http;
        
        http.begin("http://api.github.com/users/octocat");
        int httpCode = http.GET();
        
        if (httpCode &gt; 0) {
            Serial.printf("HTTP Code: %d\n", httpCode);
            
            if (httpCode == HTTP_CODE_OK) {
                String payload = http.getString();
                Serial.println(payload);
            }
        } else {
            Serial.printf("Error: %s\n", http.errorToString(httpCode).c_str());
        }
        
        http.end();
    }
    
    delay(10000);
}
</code></pre>
<h3 id="wifi-scan"><a class="header" href="#wifi-scan">WiFi Scan</a></h3>
<pre><code class="language-cpp">#include &lt;WiFi.h&gt;

void setup() {
    Serial.begin(115200);
    WiFi.mode(WIFI_STA);
    WiFi.disconnect();
    delay(100);
}

void loop() {
    Serial.println("Scanning WiFi networks...");
    int n = WiFi.scanNetworks();
    
    if (n == 0) {
        Serial.println("No networks found");
    } else {
        Serial.printf("%d networks found:\n", n);
        
        for (int i = 0; i &lt; n; i++) {
            Serial.printf("%d: %s (%d dBm) %s\n",
                i + 1,
                WiFi.SSID(i).c_str(),
                WiFi.RSSI(i),
                WiFi.encryptionType(i) == WIFI_AUTH_OPEN ? "Open" : "Encrypted"
            );
        }
    }
    
    delay(5000);
}
</code></pre>
<h3 id="mqtt-client"><a class="header" href="#mqtt-client">MQTT Client</a></h3>
<pre><code class="language-cpp">#include &lt;WiFi.h&gt;
#include &lt;PubSubClient.h&gt;

const char* ssid = "YourSSID";
const char* password = "YourPassword";
const char* mqtt_server = "broker.hivemq.com";

WiFiClient espClient;
PubSubClient client(espClient);

void callback(char* topic, byte* payload, unsigned int length) {
    Serial.print("Message arrived [");
    Serial.print(topic);
    Serial.print("]: ");
    
    for (int i = 0; i &lt; length; i++) {
        Serial.print((char)payload[i]);
    }
    Serial.println();
}

void reconnect() {
    while (!client.connected()) {
        Serial.print("Attempting MQTT connection...");
        
        if (client.connect("ESP32Client")) {
            Serial.println("connected");
            client.subscribe("esp32/test");
        } else {
            Serial.print("failed, rc=");
            Serial.print(client.state());
            Serial.println(" retrying in 5 seconds");
            delay(5000);
        }
    }
}

void setup() {
    Serial.begin(115200);
    
    WiFi.begin(ssid, password);
    while (WiFi.status() != WL_CONNECTED) {
        delay(500);
        Serial.print(".");
    }
    Serial.println("\nWiFi connected");
    
    client.setServer(mqtt_server, 1883);
    client.setCallback(callback);
}

void loop() {
    if (!client.connected()) {
        reconnect();
    }
    client.loop();
    
    // Publish message every 10 seconds
    static unsigned long lastMsg = 0;
    unsigned long now = millis();
    
    if (now - lastMsg &gt; 10000) {
        lastMsg = now;
        
        char msg[50];
        snprintf(msg, 50, "Hello from ESP32 #%lu", millis());
        client.publish("esp32/test", msg);
    }
}
</code></pre>
<h2 id="bluetooth"><a class="header" href="#bluetooth">Bluetooth</a></h2>
<h3 id="bluetooth-classic---serial"><a class="header" href="#bluetooth-classic---serial">Bluetooth Classic - Serial</a></h3>
<pre><code class="language-cpp">#include &lt;BluetoothSerial.h&gt;

BluetoothSerial SerialBT;

void setup() {
    Serial.begin(115200);
    SerialBT.begin("ESP32-BT");  // Bluetooth device name
    Serial.println("Bluetooth Started! Pair with 'ESP32-BT'");
}

void loop() {
    // Forward from Serial to Bluetooth
    if (Serial.available()) {
        SerialBT.write(Serial.read());
    }
    
    // Forward from Bluetooth to Serial
    if (SerialBT.available()) {
        Serial.write(SerialBT.read());
    }
}
</code></pre>
<h3 id="ble-server"><a class="header" href="#ble-server">BLE Server</a></h3>
<pre><code class="language-cpp">#include &lt;BLEDevice.h&gt;
#include &lt;BLEServer.h&gt;
#include &lt;BLEUtils.h&gt;
#include &lt;BLE2902.h&gt;

BLEServer* pServer = NULL;
BLECharacteristic* pCharacteristic = NULL;
bool deviceConnected = false;
uint32_t value = 0;

#define SERVICE_UUID        "4fafc201-1fb5-459e-8fcc-c5c9c331914b"
#define CHARACTERISTIC_UUID "beb5483e-36e1-4688-b7f5-ea07361b26a8"

class MyServerCallbacks: public BLEServerCallbacks {
    void onConnect(BLEServer* pServer) {
        deviceConnected = true;
        Serial.println("Device connected");
    }
    
    void onDisconnect(BLEServer* pServer) {
        deviceConnected = false;
        Serial.println("Device disconnected");
    }
};

void setup() {
    Serial.begin(115200);
    
    // Create BLE Device
    BLEDevice::init("ESP32-BLE");
    
    // Create BLE Server
    pServer = BLEDevice::createServer();
    pServer-&gt;setCallbacks(new MyServerCallbacks());
    
    // Create BLE Service
    BLEService *pService = pServer-&gt;createService(SERVICE_UUID);
    
    // Create BLE Characteristic
    pCharacteristic = pService-&gt;createCharacteristic(
        CHARACTERISTIC_UUID,
        BLECharacteristic::PROPERTY_READ |
        BLECharacteristic::PROPERTY_WRITE |
        BLECharacteristic::PROPERTY_NOTIFY
    );
    
    pCharacteristic-&gt;addDescriptor(new BLE2902());
    
    // Start service
    pService-&gt;start();
    
    // Start advertising
    BLEAdvertising *pAdvertising = BLEDevice::getAdvertising();
    pAdvertising-&gt;addServiceUUID(SERVICE_UUID);
    pAdvertising-&gt;start();
    
    Serial.println("BLE Server started. Waiting for connections...");
}

void loop() {
    if (deviceConnected) {
        // Update and notify characteristic
        pCharacteristic-&gt;setValue((uint8_t*)&amp;value, 4);
        pCharacteristic-&gt;notify();
        value++;
        delay(1000);
    }
}
</code></pre>
<h3 id="ble-client-scanner"><a class="header" href="#ble-client-scanner">BLE Client (Scanner)</a></h3>
<pre><code class="language-cpp">#include &lt;BLEDevice.h&gt;
#include &lt;BLEUtils.h&gt;
#include &lt;BLEScan.h&gt;
#include &lt;BLEAdvertisedDevice.h&gt;

BLEScan* pBLEScan;

class MyAdvertisedDeviceCallbacks: public BLEAdvertisedDeviceCallbacks {
    void onResult(BLEAdvertisedDevice advertisedDevice) {
        Serial.printf("Found device: %s\n", advertisedDevice.toString().c_str());
    }
};

void setup() {
    Serial.begin(115200);
    Serial.println("Starting BLE scan...");
    
    BLEDevice::init("");
    pBLEScan = BLEDevice::getScan();
    pBLEScan-&gt;setAdvertisedDeviceCallbacks(new MyAdvertisedDeviceCallbacks());
    pBLEScan-&gt;setActiveScan(true);
}

void loop() {
    BLEScanResults foundDevices = pBLEScan-&gt;start(5, false);
    Serial.printf("Devices found: %d\n", foundDevices.getCount());
    pBLEScan-&gt;clearResults();
    delay(2000);
}
</code></pre>
<h2 id="advanced-features-7"><a class="header" href="#advanced-features-7">Advanced Features</a></h2>
<h3 id="deep-sleep-mode"><a class="header" href="#deep-sleep-mode">Deep Sleep Mode</a></h3>
<pre><code class="language-cpp">#define uS_TO_S_FACTOR 1000000  // Conversion factor for microseconds to seconds
#define TIME_TO_SLEEP  30       // Sleep for 30 seconds

RTC_DATA_ATTR int bootCount = 0;  // Preserved in RTC memory

void setup() {
    Serial.begin(115200);
    delay(1000);
    
    bootCount++;
    Serial.println("Boot number: " + String(bootCount));
    
    // Configure wake-up sources
    esp_sleep_enable_timer_wakeup(TIME_TO_SLEEP * uS_TO_S_FACTOR);
    
    // GPIO wake-up
    esp_sleep_enable_ext0_wakeup(GPIO_NUM_33, 1);  // Wake on HIGH
    
    Serial.println("Going to sleep for " + String(TIME_TO_SLEEP) + " seconds");
    Serial.flush();
    
    esp_deep_sleep_start();
}

void loop() {
    // Never reached
}
</code></pre>
<h3 id="touch-wake-up"><a class="header" href="#touch-wake-up">Touch Wake-up</a></h3>
<pre><code class="language-cpp">#define THRESHOLD 40

void setup() {
    Serial.begin(115200);
    delay(1000);
    
    // Configure touch wake-up
    touchAttachInterrupt(T0, callback, THRESHOLD);
    
    esp_sleep_enable_touchpad_wakeup();
    
    Serial.println("Going to sleep. Touch GPIO 4 to wake up.");
    delay(1000);
    
    esp_deep_sleep_start();
}

void callback() {
    // Empty
}

void loop() {
    // Never reached
}
</code></pre>
<h3 id="adc-with-calibration"><a class="header" href="#adc-with-calibration">ADC with Calibration</a></h3>
<pre><code class="language-cpp">#include &lt;esp_adc_cal.h&gt;

#define ADC_PIN 34
#define DEFAULT_VREF 1100

esp_adc_cal_characteristics_t *adc_chars;

void setup() {
    Serial.begin(115200);
    
    // Configure ADC
    adc1_config_width(ADC_WIDTH_BIT_12);
    adc1_config_channel_atten(ADC1_CHANNEL_6, ADC_ATTEN_DB_11);
    
    // Characterize ADC
    adc_chars = (esp_adc_cal_characteristics_t*)calloc(1, sizeof(esp_adc_cal_characteristics_t));
    esp_adc_cal_characterize(ADC_UNIT_1, ADC_ATTEN_DB_11, ADC_WIDTH_BIT_12, DEFAULT_VREF, adc_chars);
}

void loop() {
    uint32_t adc_reading = 0;
    
    // Multisampling
    for (int i = 0; i &lt; 64; i++) {
        adc_reading += adc1_get_raw(ADC1_CHANNEL_6);
    }
    adc_reading /= 64;
    
    // Convert to voltage
    uint32_t voltage = esp_adc_cal_raw_to_voltage(adc_reading, adc_chars);
    
    Serial.printf("Raw: %d, Voltage: %d mV\n", adc_reading, voltage);
    
    delay(1000);
}
</code></pre>
<h3 id="over-the-air-ota-updates"><a class="header" href="#over-the-air-ota-updates">Over-The-Air (OTA) Updates</a></h3>
<pre><code class="language-cpp">#include &lt;WiFi.h&gt;
#include &lt;ESPmDNS.h&gt;
#include &lt;WiFiUdp.h&gt;
#include &lt;ArduinoOTA.h&gt;

const char* ssid = "YourSSID";
const char* password = "YourPassword";

void setup() {
    Serial.begin(115200);
    
    WiFi.begin(ssid, password);
    while (WiFi.status() != WL_CONNECTED) {
        delay(500);
        Serial.print(".");
    }
    
    Serial.println("\nWiFi connected");
    Serial.println(WiFi.localIP());
    
    // Setup OTA
    ArduinoOTA.setHostname("esp32");
    ArduinoOTA.setPassword("admin");
    
    ArduinoOTA.onStart([]() {
        String type = (ArduinoOTA.getCommand() == U_FLASH) ? "sketch" : "filesystem";
        Serial.println("Start updating " + type);
    });
    
    ArduinoOTA.onEnd([]() {
        Serial.println("\nEnd");
    });
    
    ArduinoOTA.onProgress([](unsigned int progress, unsigned int total) {
        Serial.printf("Progress: %u%%\r", (progress / (total / 100)));
    });
    
    ArduinoOTA.onError([](ota_error_t error) {
        Serial.printf("Error[%u]: ", error);
        if (error == OTA_AUTH_ERROR) Serial.println("Auth Failed");
        else if (error == OTA_BEGIN_ERROR) Serial.println("Begin Failed");
        else if (error == OTA_CONNECT_ERROR) Serial.println("Connect Failed");
        else if (error == OTA_RECEIVE_ERROR) Serial.println("Receive Failed");
        else if (error == OTA_END_ERROR) Serial.println("End Failed");
    });
    
    ArduinoOTA.begin();
    Serial.println("OTA Ready");
}

void loop() {
    ArduinoOTA.handle();
}
</code></pre>
<h2 id="projects"><a class="header" href="#projects">Projects</a></h2>
<h3 id="project-1-wifi-weather-station"><a class="header" href="#project-1-wifi-weather-station">Project 1: WiFi Weather Station</a></h3>
<pre><code class="language-cpp">#include &lt;WiFi.h&gt;
#include &lt;HTTPClient.h&gt;
#include &lt;DHT.h&gt;

#define DHTPIN 4
#define DHTTYPE DHT11

DHT dht(DHTPIN, DHTTYPE);

const char* ssid = "YourSSID";
const char* password = "YourPassword";
const char* server = "http://api.thingspeak.com/update";
const char* apiKey = "YOUR_API_KEY";

void setup() {
    Serial.begin(115200);
    dht.begin();
    
    WiFi.begin(ssid, password);
    while (WiFi.status() != WL_CONNECTED) {
        delay(500);
        Serial.print(".");
    }
    Serial.println("\nConnected!");
}

void loop() {
    float temp = dht.readTemperature();
    float humidity = dht.readHumidity();
    
    if (isnan(temp) || isnan(humidity)) {
        Serial.println("Failed to read sensor!");
        delay(2000);
        return;
    }
    
    Serial.printf("Temp: %.1f°C, Humidity: %.1f%%\n", temp, humidity);
    
    // Send to ThingSpeak
    if (WiFi.status() == WL_CONNECTED) {
        HTTPClient http;
        
        String url = String(server) + "?api_key=" + apiKey +
                     "&amp;field1=" + String(temp) +
                     "&amp;field2=" + String(humidity);
        
        http.begin(url);
        int httpCode = http.GET();
        
        if (httpCode &gt; 0) {
            Serial.println("Data sent successfully");
        } else {
            Serial.println("Error sending data");
        }
        
        http.end();
    }
    
    delay(20000);  // ThingSpeak requires 15 second minimum
}
</code></pre>
<h3 id="project-2-bluetooth-led-controller"><a class="header" href="#project-2-bluetooth-led-controller">Project 2: Bluetooth LED Controller</a></h3>
<pre><code class="language-cpp">#include &lt;BluetoothSerial.h&gt;

BluetoothSerial SerialBT;

const int RED_PIN = 25;
const int GREEN_PIN = 26;
const int BLUE_PIN = 27;

void setup() {
    Serial.begin(115200);
    SerialBT.begin("ESP32-RGB");
    
    pinMode(RED_PIN, OUTPUT);
    pinMode(GREEN_PIN, OUTPUT);
    pinMode(BLUE_PIN, OUTPUT);
    
    Serial.println("Bluetooth RGB Controller Ready");
}

void loop() {
    if (SerialBT.available()) {
        String command = SerialBT.readStringUntil('\n');
        command.trim();
        
        if (command.startsWith("RGB")) {
            // Format: RGB,255,128,64
            int comma1 = command.indexOf(',');
            int comma2 = command.indexOf(',', comma1 + 1);
            int comma3 = command.indexOf(',', comma2 + 1);
            
            int r = command.substring(comma1 + 1, comma2).toInt();
            int g = command.substring(comma2 + 1, comma3).toInt();
            int b = command.substring(comma3 + 1).toInt();
            
            analogWrite(RED_PIN, r);
            analogWrite(GREEN_PIN, g);
            analogWrite(BLUE_PIN, b);
            
            SerialBT.printf("Set RGB to %d,%d,%d\n", r, g, b);
        } else if (command == "OFF") {
            analogWrite(RED_PIN, 0);
            analogWrite(GREEN_PIN, 0);
            analogWrite(BLUE_PIN, 0);
            SerialBT.println("LEDs OFF");
        }
    }
}
</code></pre>
<h3 id="project-3-wifi-smart-thermostat"><a class="header" href="#project-3-wifi-smart-thermostat">Project 3: WiFi Smart Thermostat</a></h3>
<pre><code class="language-cpp">#include &lt;WiFi.h&gt;
#include &lt;WebServer.h&gt;
#include &lt;DHT.h&gt;

#define DHTPIN 4
#define DHTTYPE DHT11
#define RELAY_PIN 26

DHT dht(DHTPIN, DHTTYPE);
WebServer server(80);

const char* ssid = "YourSSID";
const char* password = "YourPassword";

float targetTemp = 25.0;
bool heatingOn = false;

void handleRoot() {
    float temp = dht.readTemperature();
    float humidity = dht.readHumidity();
    
    String html = "&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;";
    html += "&lt;meta name='viewport' content='width=device-width, initial-scale=1'&gt;";
    html += "&lt;style&gt;body{font-family:Arial;text-align:center;margin:20px;}";
    html += ".button{padding:15px;margin:10px;font-size:20px;}&lt;/style&gt;&lt;/head&gt;";
    html += "&lt;body&gt;&lt;h1&gt;Smart Thermostat&lt;/h1&gt;";
    html += "&lt;p&gt;Current: " + String(temp, 1) + "°C&lt;/p&gt;";
    html += "&lt;p&gt;Humidity: " + String(humidity, 1) + "%&lt;/p&gt;";
    html += "&lt;p&gt;Target: " + String(targetTemp, 1) + "°C&lt;/p&gt;";
    html += "&lt;p&gt;Heating: " + String(heatingOn ? "ON" : "OFF") + "&lt;/p&gt;";
    html += "&lt;a href='/increase'&gt;&lt;button class='button'&gt;+1°C&lt;/button&gt;&lt;/a&gt;";
    html += "&lt;a href='/decrease'&gt;&lt;button class='button'&gt;-1°C&lt;/button&gt;&lt;/a&gt;";
    html += "&lt;/body&gt;&lt;/html&gt;";
    
    server.send(200, "text/html", html);
}

void handleIncrease() {
    targetTemp += 1.0;
    server.sendHeader("Location", "/");
    server.send(303);
}

void handleDecrease() {
    targetTemp -= 1.0;
    server.sendHeader("Location", "/");
    server.send(303);
}

void setup() {
    Serial.begin(115200);
    dht.begin();
    pinMode(RELAY_PIN, OUTPUT);
    
    WiFi.begin(ssid, password);
    while (WiFi.status() != WL_CONNECTED) {
        delay(500);
    }
    
    Serial.println("\nConnected!");
    Serial.println(WiFi.localIP());
    
    server.on("/", handleRoot);
    server.on("/increase", handleIncrease);
    server.on("/decrease", handleDecrease);
    server.begin();
}

void loop() {
    server.handleClient();
    
    static unsigned long lastCheck = 0;
    if (millis() - lastCheck &gt; 5000) {
        lastCheck = millis();
        
        float temp = dht.readTemperature();
        
        if (!isnan(temp)) {
            if (temp &lt; targetTemp - 0.5) {
                heatingOn = true;
                digitalWrite(RELAY_PIN, HIGH);
            } else if (temp &gt; targetTemp + 0.5) {
                heatingOn = false;
                digitalWrite(RELAY_PIN, LOW);
            }
        }
    }
}
</code></pre>
<h2 id="best-practices-59"><a class="header" href="#best-practices-59">Best Practices</a></h2>
<ol>
<li><strong>Power Management</strong>: Use deep sleep for battery-powered projects</li>
<li><strong>WiFi</strong>: Disconnect when not needed to save power</li>
<li><strong>Watchdog</strong>: Enable watchdog timer for reliability</li>
<li><strong>OTA Updates</strong>: Implement for remote firmware updates</li>
<li><strong>Error Handling</strong>: Always check WiFi connection status</li>
<li><strong>Security</strong>: Use HTTPS and encrypted connections</li>
<li><strong>Memory</strong>: Monitor heap usage with <code>ESP.getFreeHeap()</code></li>
</ol>
<h2 id="troubleshooting-17"><a class="header" href="#troubleshooting-17">Troubleshooting</a></h2>
<h3 id="common-issues-18"><a class="header" href="#common-issues-18">Common Issues</a></h3>
<p><strong>Boot Loop:</strong></p>
<ul>
<li>Check strapping pins (0, 2, 5, 12, 15)</li>
<li>Ensure stable power supply (500mA minimum)</li>
<li>Add 10µF capacitor on EN pin</li>
</ul>
<p><strong>WiFi Not Connecting:</strong></p>
<ul>
<li>Check SSID and password</li>
<li>Verify 2.4GHz network (ESP32 doesn't support 5GHz)</li>
<li>Move closer to router</li>
</ul>
<p><strong>Upload Failed:</strong></p>
<ul>
<li>Hold BOOT button during upload</li>
<li>Check correct COM port selected</li>
<li>Try lower baud rate (115200)</li>
</ul>
<p><strong>Brown-out Detector:</strong></p>
<ul>
<li>Use external 5V power supply</li>
<li>Add bulk capacitor (100-1000µF)</li>
</ul>
<h2 id="resources-33"><a class="header" href="#resources-33">Resources</a></h2>
<ul>
<li><strong>Espressif Documentation</strong>: https://docs.espressif.com/</li>
<li><strong>ESP32 Arduino Core</strong>: https://github.com/espressif/arduino-esp32</li>
<li><strong>ESP-IDF Programming Guide</strong>: https://docs.espressif.com/projects/esp-idf/</li>
<li><strong>Forum</strong>: https://www.esp32.com/</li>
</ul>
<h2 id="see-also-3"><a class="header" href="#see-also-3">See Also</a></h2>
<ul>
<li><a href="embedded/arduino.html">Arduino Programming</a></li>
<li><a href="embedded/../networking/wifi.html">WiFi Projects</a></li>
<li><a href="embedded/../protocols/mqtt.html">MQTT Protocol</a></li>
<li><a href="embedded/bluetooth.html">BLE Communication</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="raspberry-pi"><a class="header" href="#raspberry-pi">Raspberry Pi</a></h1>
<p>Complete guide to Raspberry Pi setup, GPIO programming, and projects.</p>
<h2 id="table-of-contents-39"><a class="header" href="#table-of-contents-39">Table of Contents</a></h2>
<ol>
<li><a href="embedded/raspberry_pi.html#introduction">Introduction</a></li>
<li><a href="embedded/raspberry_pi.html#hardware-overview">Hardware Overview</a></li>
<li><a href="embedded/raspberry_pi.html#setup-and-installation">Setup and Installation</a></li>
<li><a href="embedded/raspberry_pi.html#gpio-programming">GPIO Programming</a></li>
<li><a href="embedded/raspberry_pi.html#python-programming">Python Programming</a></li>
<li><a href="embedded/raspberry_pi.html#cc-programming">C/C++ Programming</a></li>
<li><a href="embedded/raspberry_pi.html#interfaces">Interfaces</a></li>
<li><a href="embedded/raspberry_pi.html#projects">Projects</a></li>
</ol>
<h2 id="introduction-19"><a class="header" href="#introduction-19">Introduction</a></h2>
<p>The Raspberry Pi is a series of small single-board computers developed by the Raspberry Pi Foundation. Unlike microcontrollers, it runs a full Linux operating system and can function as a complete desktop computer.</p>
<h3 id="key-features-12"><a class="header" href="#key-features-12">Key Features</a></h3>
<ul>
<li><strong>Full Linux Operating System</strong> (Raspberry Pi OS based on Debian)</li>
<li><strong>High Processing Power</strong>: Multi-core ARM processors</li>
<li><strong>Rich Connectivity</strong>: USB, Ethernet, WiFi, Bluetooth, HDMI</li>
<li><strong>GPIO Interface</strong>: 40-pin header for hardware projects</li>
<li><strong>Programming</strong>: Python, C/C++, JavaScript, and more</li>
<li><strong>Price</strong>: $15-$75 depending on model</li>
</ul>
<h3 id="model-comparison-2"><a class="header" href="#model-comparison-2">Model Comparison</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Model</th><th>Processor</th><th>RAM</th><th>USB</th><th>Ethernet</th><th>WiFi/BT</th><th>GPIO</th><th>Price</th></tr></thead><tbody>
<tr><td><strong>Pi Zero W</strong></td><td>Single 1GHz</td><td>512MB</td><td>1 micro</td><td>No</td><td>Yes</td><td>40</td><td>$15</td></tr>
<tr><td><strong>Pi 3 B+</strong></td><td>Quad 1.4GHz</td><td>1GB</td><td>4</td><td>Gigabit</td><td>Yes</td><td>40</td><td>$35</td></tr>
<tr><td><strong>Pi 4 B</strong></td><td>Quad 1.5GHz</td><td>2-8GB</td><td>4</td><td>Gigabit</td><td>Yes</td><td>40</td><td>$35-75</td></tr>
<tr><td><strong>Pi 5</strong></td><td>Quad 2.4GHz</td><td>4-8GB</td><td>4</td><td>Gigabit</td><td>Yes</td><td>40</td><td>$60-80</td></tr>
<tr><td><strong>Pico</strong></td><td>Dual RP2040</td><td>264KB</td><td>1 micro</td><td>No</td><td>No</td><td>26</td><td>$4</td></tr>
</tbody></table>
</div>
<h2 id="hardware-overview-1"><a class="header" href="#hardware-overview-1">Hardware Overview</a></h2>
<h3 id="raspberry-pi-4-board-layout"><a class="header" href="#raspberry-pi-4-board-layout">Raspberry Pi 4 Board Layout</a></h3>
<pre><code>┌────────────────────────────────────────────────────────┐
│  USB-C Power                        ┌──────────────┐  │
│     ┌─┐                             │   Ethernet   │  │
│     └─┘                             │   Port       │  │
│                                     └──────────────┘  │
│  ┌────────┐  ┌────────┐                              │
│  │  USB   │  │  USB   │  ┌──────────────┐           │
│  │  2.0   │  │  3.0   │  │   Dual HDMI  │           │
│  └────────┘  └────────┘  └──────────────┘           │
│                                                        │
│  ┌────────────────────┐         ┌──────┐            │
│  │   BCM2711 SoC      │         │Audio │            │
│  │   Quad Cortex-A72  │         │Jack  │            │
│  └────────────────────┘         └──────┘            │
│                                                        │
│  ┌──────────────┐  ┌────────────────────────────┐   │
│  │   Micro SD   │  │     40-pin GPIO Header     │   │
│  │   Card Slot  │  │                            │   │
│  └──────────────┘  └────────────────────────────┘   │
│                                                        │
│  [CSI Camera]           [DSI Display]                 │
└────────────────────────────────────────────────────────┘
</code></pre>
<h3 id="gpio-pinout-40-pin-header"><a class="header" href="#gpio-pinout-40-pin-header">GPIO Pinout (40-pin Header)</a></h3>
<pre><code>           3V3  (1)  (2)  5V
     GPIO 2/SDA  (3)  (4)  5V
     GPIO 3/SCL  (5)  (6)  GND
         GPIO 4  (7)  (8)  GPIO 14/TXD
            GND  (9) (10)  GPIO 15/RXD
        GPIO 17 (11) (12)  GPIO 18/PWM
        GPIO 27 (13) (14)  GND
        GPIO 22 (15) (16)  GPIO 23
           3V3 (17) (18)  GPIO 24
  GPIO 10/MOSI (19) (20)  GND
   GPIO 9/MISO (21) (22)  GPIO 25
  GPIO 11/SCLK (23) (24)  GPIO 8/CE0
            GND (25) (26)  GPIO 7/CE1
        GPIO 0  (27) (28)  GPIO 1
        GPIO 5  (29) (30)  GND
        GPIO 6  (31) (32)  GPIO 12/PWM
   GPIO 13/PWM (33) (34)  GND
   GPIO 19/PWM (35) (36)  GPIO 16
        GPIO 26 (37) (38)  GPIO 20
            GND (39) (40)  GPIO 21

Power Pins: 3.3V (17mA max per pin), 5V (from USB)
PWM: GPIO 12, 13, 18, 19
SPI0: MOSI(10), MISO(9), SCLK(11), CE0(8), CE1(7)
I2C1: SDA(2), SCL(3)
UART: TXD(14), RXD(15)
</code></pre>
<h2 id="setup-and-installation"><a class="header" href="#setup-and-installation">Setup and Installation</a></h2>
<h3 id="initial-setup"><a class="header" href="#initial-setup">Initial Setup</a></h3>
<h4 id="1-download-raspberry-pi-os"><a class="header" href="#1-download-raspberry-pi-os">1. Download Raspberry Pi OS</a></h4>
<pre><code class="language-bash"># Download Raspberry Pi Imager
# For Ubuntu/Debian:
sudo apt install rpi-imager

# For other systems, download from:
# https://www.raspberrypi.com/software/
</code></pre>
<h4 id="2-flash-sd-card"><a class="header" href="#2-flash-sd-card">2. Flash SD Card</a></h4>
<pre><code class="language-bash"># Using Raspberry Pi Imager (GUI):
# 1. Choose OS: Raspberry Pi OS (32-bit/64-bit)
# 2. Choose SD card
# 3. Click "Write"

# Or using command line (Linux):
sudo dd if=2023-05-03-raspios-bullseye-armhf.img of=/dev/sdX bs=4M status=progress
sync
</code></pre>
<h4 id="3-enable-ssh-headless-setup"><a class="header" href="#3-enable-ssh-headless-setup">3. Enable SSH (Headless Setup)</a></h4>
<pre><code class="language-bash"># Create empty 'ssh' file in boot partition
touch /media/username/boot/ssh

# Configure WiFi (optional)
cat &gt; /media/username/boot/wpa_supplicant.conf &lt;&lt; EOF
country=US
ctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev
update_config=1

network={
    ssid="YourNetworkName"
    psk="YourPassword"
    key_mgmt=WPA-PSK
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="arduino-programming"><a class="header" href="#arduino-programming">Arduino Programming</a></h1>
<p>Complete guide to Arduino development, from basics to advanced projects.</p>
<h2 id="table-of-contents-40"><a class="header" href="#table-of-contents-40">Table of Contents</a></h2>
<ol>
<li><a href="embedded/arduino.html#introduction">Introduction</a></li>
<li><a href="embedded/arduino.html#getting-started">Getting Started</a></li>
<li><a href="embedded/arduino.html#arduino-language">Arduino Language</a></li>
<li><a href="embedded/arduino.html#digital-io">Digital I/O</a></li>
<li><a href="embedded/arduino.html#analog-io">Analog I/O</a></li>
<li><a href="embedded/arduino.html#serial-communication">Serial Communication</a></li>
<li><a href="embedded/arduino.html#libraries">Libraries</a></li>
<li><a href="embedded/arduino.html#common-projects">Common Projects</a></li>
<li><a href="embedded/arduino.html#advanced-topics">Advanced Topics</a></li>
</ol>
<h2 id="introduction-20"><a class="header" href="#introduction-20">Introduction</a></h2>
<p>Arduino is an open-source electronics platform based on easy-to-use hardware and software. It's designed for artists, designers, hobbyists, and anyone interested in creating interactive objects or environments.</p>
<h3 id="arduino-boards-comparison"><a class="header" href="#arduino-boards-comparison">Arduino Boards Comparison</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Board</th><th>MCU</th><th>Clock</th><th>Flash</th><th>RAM</th><th>Digital I/O</th><th>Analog In</th><th>Price</th></tr></thead><tbody>
<tr><td><strong>Uno</strong></td><td>ATmega328P</td><td>16 MHz</td><td>32 KB</td><td>2 KB</td><td>14 (6 PWM)</td><td>6</td><td>$</td></tr>
<tr><td><strong>Mega 2560</strong></td><td>ATmega2560</td><td>16 MHz</td><td>256 KB</td><td>8 KB</td><td>54 (15 PWM)</td><td>16</td><td>$$</td></tr>
<tr><td><strong>Nano</strong></td><td>ATmega328P</td><td>16 MHz</td><td>32 KB</td><td>2 KB</td><td>14 (6 PWM)</td><td>8</td><td>$</td></tr>
<tr><td><strong>Leonardo</strong></td><td>ATmega32u4</td><td>16 MHz</td><td>32 KB</td><td>2.5 KB</td><td>20 (7 PWM)</td><td>12</td><td>$</td></tr>
<tr><td><strong>Due</strong></td><td>AT91SAM3X8E</td><td>84 MHz</td><td>512 KB</td><td>96 KB</td><td>54 (12 PWM)</td><td>12</td><td>$$$</td></tr>
<tr><td><strong>Nano 33 IoT</strong></td><td>SAMD21</td><td>48 MHz</td><td>256 KB</td><td>32 KB</td><td>14 (11 PWM)</td><td>8</td><td>$$</td></tr>
</tbody></table>
</div>
<h3 id="arduino-uno-pinout"><a class="header" href="#arduino-uno-pinout">Arduino Uno Pinout</a></h3>
<pre><code>                   Arduino Uno
                ┌─────────────┐
                │   USB       │
                ├─────────────┤
    RESET  [ ]──┤ RESET    A0 ├──[ ] Analog Input
    3.3V   [ ]──┤ 3V3      A1 ├──[ ] Analog Input
    5V     [ ]──┤ 5V       A2 ├──[ ] Analog Input
    GND    [ ]──┤ GND      A3 ├──[ ] Analog Input
    GND    [ ]──┤ GND      A4 ├──[ ] Analog Input (I2C SDA)
    VIN    [ ]──┤ VIN      A5 ├──[ ] Analog Input (I2C SCL)
                │             │
    D0/RX  [ ]──┤ 0        13 ├──[ ] D13/SCK (LED_BUILTIN)
    D1/TX  [ ]──┤ 1        12 ├──[ ] D12/MISO
    D2     [ ]──┤ 2        11 ├──[ ] D11~/MOSI
    D3~    [ ]──┤ 3        10 ├──[ ] D10~
    D4     [ ]──┤ 4         9 ├──[ ] D9~
    D5~    [ ]──┤ 5         8 ├──[ ] D8
    D6~    [ ]──┤ 6         7 ├──[ ] D7
                └─────────────┘
    
    ~ = PWM capable
</code></pre>
<h2 id="getting-started-5"><a class="header" href="#getting-started-5">Getting Started</a></h2>
<h3 id="installation-15"><a class="header" href="#installation-15">Installation</a></h3>
<h4 id="arduino-ide"><a class="header" href="#arduino-ide">Arduino IDE</a></h4>
<pre><code class="language-bash"># Download from arduino.cc
# Or use package manager (Linux)
sudo apt install arduino

# Or use Arduino CLI
curl -fsSL https://raw.githubusercontent.com/arduino/arduino-cli/master/install.sh | sh
arduino-cli core update-index
arduino-cli core install arduino:avr
</code></pre>
<h4 id="platformio-recommended-for-advanced-users"><a class="header" href="#platformio-recommended-for-advanced-users">PlatformIO (Recommended for Advanced Users)</a></h4>
<pre><code class="language-bash">pip install platformio
platformio init --board uno
</code></pre>
<h3 id="basic-program-structure"><a class="header" href="#basic-program-structure">Basic Program Structure</a></h3>
<p>Every Arduino sketch has two required functions:</p>
<pre><code class="language-cpp">void setup() {
    // Runs once when the board starts
    // Initialize pins, serial, libraries
}

void loop() {
    // Runs continuously after setup()
    // Main program logic goes here
}
</code></pre>
<h3 id="first-program-blink-led-1"><a class="header" href="#first-program-blink-led-1">First Program: Blink LED</a></h3>
<pre><code class="language-cpp">// Blink the built-in LED
void setup() {
    pinMode(LED_BUILTIN, OUTPUT);  // Set pin 13 as output
}

void loop() {
    digitalWrite(LED_BUILTIN, HIGH);  // Turn LED on
    delay(1000);                       // Wait 1 second
    digitalWrite(LED_BUILTIN, LOW);   // Turn LED off
    delay(1000);                       // Wait 1 second
}
</code></pre>
<p><strong>Wiring:</strong></p>
<pre><code>Arduino          Component
   13 ───────────┐
                 │
               ┌─┴─┐
               │LED│  Built-in LED
               └─┬─┘
                 │
   GND ──────────┘
</code></pre>
<h2 id="arduino-language"><a class="header" href="#arduino-language">Arduino Language</a></h2>
<h3 id="data-types-5"><a class="header" href="#data-types-5">Data Types</a></h3>
<pre><code class="language-cpp">// Boolean
bool flag = true;

// Integers
byte value = 255;           // 0-255 (8-bit unsigned)
int temperature = -40;      // -32768 to 32767 (16-bit signed)
unsigned int count = 65535; // 0-65535 (16-bit unsigned)
long distance = 1000000L;   // 32-bit signed
unsigned long time = millis();  // 32-bit unsigned

// Floating Point
float voltage = 3.3;        // 32-bit, ~7 digits precision
double precise = 3.14159;   // Same as float on Arduino

// Characters and Strings
char letter = 'A';
char message[] = "Hello";   // C-style string
String text = "World";      // Arduino String class

// Arrays
int readings[10];           // Array of 10 integers
int values[] = {1, 2, 3};  // Initialized array
</code></pre>
<h3 id="control-structures"><a class="header" href="#control-structures">Control Structures</a></h3>
<pre><code class="language-cpp">// If-else
if (temperature &gt; 30) {
    digitalWrite(FAN_PIN, HIGH);
} else if (temperature &gt; 20) {
    analogWrite(FAN_PIN, 128);
} else {
    digitalWrite(FAN_PIN, LOW);
}

// Switch-case
switch (state) {
    case 0:
        // Do something
        break;
    case 1:
        // Do something else
        break;
    default:
        // Default action
        break;
}

// For loop
for (int i = 0; i &lt; 10; i++) {
    Serial.println(i);
}

// While loop
while (digitalRead(BUTTON_PIN) == HIGH) {
    // Wait for button release
}

// Do-while loop
do {
    value = analogRead(A0);
} while (value &lt; 512);
</code></pre>
<h3 id="functions-7"><a class="header" href="#functions-7">Functions</a></h3>
<pre><code class="language-cpp">// Function declaration
int addNumbers(int a, int b);

void setup() {
    Serial.begin(9600);
    int result = addNumbers(5, 3);
    Serial.println(result);  // Prints 8
}

// Function definition
int addNumbers(int a, int b) {
    return a + b;
}

// Function with default parameters
void blinkLED(int pin, int times = 1, int delayTime = 500) {
    for (int i = 0; i &lt; times; i++) {
        digitalWrite(pin, HIGH);
        delay(delayTime);
        digitalWrite(pin, LOW);
        delay(delayTime);
    }
}

void loop() {
    blinkLED(13);           // Blink once
    blinkLED(13, 3);        // Blink 3 times
    blinkLED(13, 5, 200);   // Blink 5 times with 200ms delay
}
</code></pre>
<h2 id="digital-io"><a class="header" href="#digital-io">Digital I/O</a></h2>
<h3 id="basic-digital-functions"><a class="header" href="#basic-digital-functions">Basic Digital Functions</a></h3>
<pre><code class="language-cpp">pinMode(pin, mode);        // Configure pin: INPUT, OUTPUT, INPUT_PULLUP
digitalWrite(pin, value);  // Write HIGH or LOW
int value = digitalRead(pin);  // Read HIGH or LOW
</code></pre>
<h3 id="led-control-1"><a class="header" href="#led-control-1">LED Control</a></h3>
<pre><code class="language-cpp">// Simple LED control
const int LED_PIN = 9;

void setup() {
    pinMode(LED_PIN, OUTPUT);
}

void loop() {
    digitalWrite(LED_PIN, HIGH);
    delay(500);
    digitalWrite(LED_PIN, LOW);
    delay(500);
}
</code></pre>
<p><strong>Wiring:</strong></p>
<pre><code>Arduino          Component
    9 ───────────┬─────────┐
                 │         │
               ┌─┴─┐     ┌─┴─┐
               │220│     │LED│
               │Ω  │     │ &gt; │
               └─┬─┘     └─┬─┘
                 │         │
   GND ──────────┴─────────┘
</code></pre>
<h3 id="button-input"><a class="header" href="#button-input">Button Input</a></h3>
<pre><code class="language-cpp">const int BUTTON_PIN = 2;
const int LED_PIN = 13;

void setup() {
    pinMode(BUTTON_PIN, INPUT_PULLUP);  // Internal pull-up resistor
    pinMode(LED_PIN, OUTPUT);
}

void loop() {
    int buttonState = digitalRead(BUTTON_PIN);
    
    if (buttonState == LOW) {  // Button pressed (active LOW)
        digitalWrite(LED_PIN, HIGH);
    } else {
        digitalWrite(LED_PIN, LOW);
    }
}
</code></pre>
<p><strong>Wiring:</strong></p>
<pre><code>Arduino          Button
    2 ────────┬────┬──┬──── 5V (optional if using INPUT_PULLUP)
              │    │  │
            ┌─┴─┐ ┌┴──┴┐
            │10k│ │BTN │
            │Ω  │ └────┘
            └─┬─┘    │
              │      │
   GND ───────┴──────┘
</code></pre>
<h3 id="debouncing"><a class="header" href="#debouncing">Debouncing</a></h3>
<pre><code class="language-cpp">const int BUTTON_PIN = 2;
const int LED_PIN = 13;
const int DEBOUNCE_DELAY = 50;  // milliseconds

int lastButtonState = HIGH;
int buttonState = HIGH;
unsigned long lastDebounceTime = 0;
bool ledState = false;

void setup() {
    pinMode(BUTTON_PIN, INPUT_PULLUP);
    pinMode(LED_PIN, OUTPUT);
}

void loop() {
    int reading = digitalRead(BUTTON_PIN);
    
    // If the switch changed, due to noise or pressing
    if (reading != lastButtonState) {
        lastDebounceTime = millis();
    }
    
    if ((millis() - lastDebounceTime) &gt; DEBOUNCE_DELAY) {
        // If the button state has changed
        if (reading != buttonState) {
            buttonState = reading;
            
            // Only toggle if the new button state is LOW (pressed)
            if (buttonState == LOW) {
                ledState = !ledState;
                digitalWrite(LED_PIN, ledState);
            }
        }
    }
    
    lastButtonState = reading;
}
</code></pre>
<h2 id="analog-io"><a class="header" href="#analog-io">Analog I/O</a></h2>
<h3 id="analog-input-adc"><a class="header" href="#analog-input-adc">Analog Input (ADC)</a></h3>
<pre><code class="language-cpp">analogRead(pin);  // Read analog value (0-1023)
</code></pre>
<h4 id="reading-a-potentiometer"><a class="header" href="#reading-a-potentiometer">Reading a Potentiometer</a></h4>
<pre><code class="language-cpp">const int POT_PIN = A0;
const int LED_PIN = 9;

void setup() {
    Serial.begin(9600);
    pinMode(LED_PIN, OUTPUT);
}

void loop() {
    int potValue = analogRead(POT_PIN);  // 0-1023
    
    // Convert to voltage (0-5V)
    float voltage = potValue * (5.0 / 1023.0);
    
    // Convert to LED brightness (0-255)
    int brightness = map(potValue, 0, 1023, 0, 255);
    
    Serial.print("Value: ");
    Serial.print(potValue);
    Serial.print(" Voltage: ");
    Serial.print(voltage);
    Serial.println("V");
    
    analogWrite(LED_PIN, brightness);
    delay(100);
}
</code></pre>
<p><strong>Wiring:</strong></p>
<pre><code>Potentiometer       Arduino
     ┌────┐
  5V─┤1  3├─GND
     │    │
     │ 2  ├─A0 (wiper)
     └────┘
</code></pre>
<h3 id="analog-output-pwm"><a class="header" href="#analog-output-pwm">Analog Output (PWM)</a></h3>
<pre><code class="language-cpp">analogWrite(pin, value);  // PWM output (0-255)
</code></pre>
<h4 id="fading-led"><a class="header" href="#fading-led">Fading LED</a></h4>
<pre><code class="language-cpp">const int LED_PIN = 9;  // Must be PWM pin (~)

void setup() {
    pinMode(LED_PIN, OUTPUT);
}

void loop() {
    // Fade in
    for (int brightness = 0; brightness &lt;= 255; brightness++) {
        analogWrite(LED_PIN, brightness);
        delay(10);
    }
    
    // Fade out
    for (int brightness = 255; brightness &gt;= 0; brightness--) {
        analogWrite(LED_PIN, brightness);
        delay(10);
    }
}
</code></pre>
<h3 id="temperature-sensor-lm35"><a class="header" href="#temperature-sensor-lm35">Temperature Sensor (LM35)</a></h3>
<pre><code class="language-cpp">const int TEMP_PIN = A0;

void setup() {
    Serial.begin(9600);
}

void loop() {
    int reading = analogRead(TEMP_PIN);
    
    // Convert to voltage (0-5V)
    float voltage = reading * (5.0 / 1023.0);
    
    // Convert to temperature (LM35: 10mV per degree C)
    float temperatureC = voltage * 100.0;
    float temperatureF = (temperatureC * 9.0 / 5.0) + 32.0;
    
    Serial.print("Temperature: ");
    Serial.print(temperatureC);
    Serial.print("°C / ");
    Serial.print(temperatureF);
    Serial.println("°F");
    
    delay(1000);
}
</code></pre>
<p><strong>Wiring:</strong></p>
<pre><code>LM35 Sensor         Arduino
    ┌────┐
 1 ─┤ VS ├─ 5V
    │    │
 2 ─┤Vout├─ A0
    │    │
 3 ─┤GND ├─ GND
    └────┘
</code></pre>
<h2 id="serial-communication"><a class="header" href="#serial-communication">Serial Communication</a></h2>
<h3 id="basic-serial-functions"><a class="header" href="#basic-serial-functions">Basic Serial Functions</a></h3>
<pre><code class="language-cpp">Serial.begin(baudrate);        // Initialize serial (9600, 115200, etc.)
Serial.print(data);            // Print without newline
Serial.println(data);          // Print with newline
Serial.write(byte);            // Send raw byte
int available = Serial.available();  // Bytes available to read
char c = Serial.read();        // Read one byte
String line = Serial.readStringUntil('\n');  // Read until newline
</code></pre>
<h3 id="serial-monitor-output"><a class="header" href="#serial-monitor-output">Serial Monitor Output</a></h3>
<pre><code class="language-cpp">void setup() {
    Serial.begin(9600);
    Serial.println("Arduino Ready!");
}

void loop() {
    int sensorValue = analogRead(A0);
    
    // Different formatting options
    Serial.print("Sensor: ");
    Serial.println(sensorValue);
    
    Serial.print("Hex: 0x");
    Serial.println(sensorValue, HEX);
    
    Serial.print("Binary: 0b");
    Serial.println(sensorValue, BIN);
    
    Serial.print("Float: ");
    float voltage = sensorValue * (5.0 / 1023.0);
    Serial.println(voltage, 2);  // 2 decimal places
    
    delay(1000);
}
</code></pre>
<h3 id="serial-input"><a class="header" href="#serial-input">Serial Input</a></h3>
<pre><code class="language-cpp">String inputString = "";
bool stringComplete = false;

void setup() {
    Serial.begin(9600);
    inputString.reserve(200);  // Reserve space for efficiency
}

void loop() {
    // Check if data is available
    while (Serial.available()) {
        char inChar = (char)Serial.read();
        inputString += inChar;
        
        if (inChar == '\n') {
            stringComplete = true;
        }
    }
    
    // Process complete command
    if (stringComplete) {
        Serial.print("Received: ");
        Serial.println(inputString);
        
        // Process command
        if (inputString.startsWith("LED ON")) {
            digitalWrite(LED_BUILTIN, HIGH);
            Serial.println("LED turned ON");
        } else if (inputString.startsWith("LED OFF")) {
            digitalWrite(LED_BUILTIN, LOW);
            Serial.println("LED turned OFF");
        }
        
        // Clear the string
        inputString = "";
        stringComplete = false;
    }
}
</code></pre>
<h2 id="libraries"><a class="header" href="#libraries">Libraries</a></h2>
<h3 id="built-in-libraries"><a class="header" href="#built-in-libraries">Built-in Libraries</a></h3>
<h4 id="wire-i2c"><a class="header" href="#wire-i2c">Wire (I2C)</a></h4>
<pre><code class="language-cpp">#include &lt;Wire.h&gt;

void setup() {
    Wire.begin();  // Join I2C bus as master
}

void loop() {
    // Read from I2C device at address 0x68
    Wire.beginTransmission(0x68);
    Wire.write(0x00);  // Register address
    Wire.endTransmission();
    
    Wire.requestFrom(0x68, 1);  // Request 1 byte
    if (Wire.available()) {
        byte data = Wire.read();
    }
}
</code></pre>
<h4 id="spi"><a class="header" href="#spi">SPI</a></h4>
<pre><code class="language-cpp">#include &lt;SPI.h&gt;

const int CS_PIN = 10;

void setup() {
    SPI.begin();
    pinMode(CS_PIN, OUTPUT);
    digitalWrite(CS_PIN, HIGH);
}

void loop() {
    digitalWrite(CS_PIN, LOW);   // Select device
    SPI.transfer(0xAB);          // Send byte
    byte received = SPI.transfer(0x00);  // Receive byte
    digitalWrite(CS_PIN, HIGH);  // Deselect device
}
</code></pre>
<h4 id="eeprom"><a class="header" href="#eeprom">EEPROM</a></h4>
<pre><code class="language-cpp">#include &lt;EEPROM.h&gt;

void setup() {
    // Write byte to EEPROM
    EEPROM.write(0, 42);
    
    // Read byte from EEPROM
    byte value = EEPROM.read(0);
    
    // Update (only writes if different)
    EEPROM.update(0, 42);
    
    // Write/read other types
    int address = 0;
    float f = 3.14;
    EEPROM.put(address, f);
    EEPROM.get(address, f);
}
</code></pre>
<h3 id="popular-external-libraries"><a class="header" href="#popular-external-libraries">Popular External Libraries</a></h3>
<h4 id="servo-control"><a class="header" href="#servo-control">Servo Control</a></h4>
<pre><code class="language-cpp">#include &lt;Servo.h&gt;

Servo myServo;
const int SERVO_PIN = 9;

void setup() {
    myServo.attach(SERVO_PIN);
}

void loop() {
    // Sweep from 0 to 180 degrees
    for (int pos = 0; pos &lt;= 180; pos++) {
        myServo.write(pos);
        delay(15);
    }
    
    // Sweep back
    for (int pos = 180; pos &gt;= 0; pos--) {
        myServo.write(pos);
        delay(15);
    }
}
</code></pre>
<p><strong>Wiring:</strong></p>
<pre><code>Servo Motor         Arduino
    ┌────┐
 R ─┤Red ├─ 5V (or external)
 B ─┤Brn ├─ GND
 O ─┤Org ├─ Pin 9 (PWM)
    └────┘
</code></pre>
<h4 id="liquidcrystal-lcd-display"><a class="header" href="#liquidcrystal-lcd-display">LiquidCrystal (LCD Display)</a></h4>
<pre><code class="language-cpp">#include &lt;LiquidCrystal.h&gt;

// RS, E, D4, D5, D6, D7
LiquidCrystal lcd(12, 11, 5, 4, 3, 2);

void setup() {
    lcd.begin(16, 2);  // 16x2 LCD
    lcd.print("Hello, World!");
}

void loop() {
    lcd.setCursor(0, 1);  // Column 0, Row 1
    lcd.print(millis() / 1000);
    lcd.print("s");
    delay(100);
}
</code></pre>
<p><strong>Wiring:</strong></p>
<pre><code>LCD 16x2            Arduino
VSS  ──────────────  GND
VDD  ──────────────  5V
V0   ──────────────  Potentiometer (contrast)
RS   ──────────────  12
RW   ──────────────  GND
E    ──────────────  11
D4   ──────────────  5
D5   ──────────────  4
D6   ──────────────  3
D7   ──────────────  2
A    ──────────────  5V (backlight)
K    ──────────────  GND
</code></pre>
<h4 id="dht-temperaturehumidity-sensor"><a class="header" href="#dht-temperaturehumidity-sensor">DHT Temperature/Humidity Sensor</a></h4>
<pre><code class="language-cpp">#include &lt;DHT.h&gt;

#define DHTPIN 2
#define DHTTYPE DHT11  // or DHT22

DHT dht(DHTPIN, DHTTYPE);

void setup() {
    Serial.begin(9600);
    dht.begin();
}

void loop() {
    float humidity = dht.readHumidity();
    float temperature = dht.readTemperature();  // Celsius
    float temperatureF = dht.readTemperature(true);  // Fahrenheit
    
    if (isnan(humidity) || isnan(temperature)) {
        Serial.println("Failed to read from DHT sensor!");
        return;
    }
    
    Serial.print("Humidity: ");
    Serial.print(humidity);
    Serial.print("% Temperature: ");
    Serial.print(temperature);
    Serial.println("°C");
    
    delay(2000);  // DHT11 minimum sampling period
}
</code></pre>
<h2 id="common-projects"><a class="header" href="#common-projects">Common Projects</a></h2>
<h3 id="project-1-traffic-light"><a class="header" href="#project-1-traffic-light">Project 1: Traffic Light</a></h3>
<pre><code class="language-cpp">const int RED_LED = 10;
const int YELLOW_LED = 9;
const int GREEN_LED = 8;

void setup() {
    pinMode(RED_LED, OUTPUT);
    pinMode(YELLOW_LED, OUTPUT);
    pinMode(GREEN_LED, OUTPUT);
}

void loop() {
    // Green light
    digitalWrite(GREEN_LED, HIGH);
    delay(5000);  // 5 seconds
    digitalWrite(GREEN_LED, LOW);
    
    // Yellow light
    digitalWrite(YELLOW_LED, HIGH);
    delay(2000);  // 2 seconds
    digitalWrite(YELLOW_LED, LOW);
    
    // Red light
    digitalWrite(RED_LED, HIGH);
    delay(5000);  // 5 seconds
    digitalWrite(RED_LED, LOW);
}
</code></pre>
<p><strong>Wiring:</strong></p>
<pre><code>Arduino              LEDs
  10 ───┬───[220Ω]───[RED LED]───GND
        │
   9 ───┼───[220Ω]───[YEL LED]───GND
        │
   8 ───┴───[220Ω]───[GRN LED]───GND
</code></pre>
<h3 id="project-2-ultrasonic-distance-sensor"><a class="header" href="#project-2-ultrasonic-distance-sensor">Project 2: Ultrasonic Distance Sensor</a></h3>
<pre><code class="language-cpp">const int TRIG_PIN = 9;
const int ECHO_PIN = 10;

void setup() {
    Serial.begin(9600);
    pinMode(TRIG_PIN, OUTPUT);
    pinMode(ECHO_PIN, INPUT);
}

void loop() {
    // Send ultrasonic pulse
    digitalWrite(TRIG_PIN, LOW);
    delayMicroseconds(2);
    digitalWrite(TRIG_PIN, HIGH);
    delayMicroseconds(10);
    digitalWrite(TRIG_PIN, LOW);
    
    // Measure echo duration
    long duration = pulseIn(ECHO_PIN, HIGH);
    
    // Calculate distance in cm
    // Speed of sound: 343 m/s = 0.0343 cm/µs
    // Distance = (duration / 2) * 0.0343
    float distance = duration * 0.0343 / 2;
    
    Serial.print("Distance: ");
    Serial.print(distance);
    Serial.println(" cm");
    
    delay(100);
}
</code></pre>
<p><strong>Wiring:</strong></p>
<pre><code>HC-SR04             Arduino
 VCC ───────────────  5V
 Trig ──────────────  9
 Echo ──────────────  10
 GND ───────────────  GND
</code></pre>
<h3 id="project-3-light-activated-switch"><a class="header" href="#project-3-light-activated-switch">Project 3: Light-Activated Switch</a></h3>
<pre><code class="language-cpp">const int LDR_PIN = A0;
const int LED_PIN = 13;
const int THRESHOLD = 500;  // Adjust based on lighting

void setup() {
    Serial.begin(9600);
    pinMode(LED_PIN, OUTPUT);
}

void loop() {
    int lightLevel = analogRead(LDR_PIN);
    
    Serial.print("Light Level: ");
    Serial.println(lightLevel);
    
    if (lightLevel &lt; THRESHOLD) {
        digitalWrite(LED_PIN, HIGH);  // Turn on LED when dark
    } else {
        digitalWrite(LED_PIN, LOW);   // Turn off LED when bright
    }
    
    delay(100);
}
</code></pre>
<p><strong>Wiring:</strong></p>
<pre><code>         5V
          │
        ┌─┴─┐
        │LDR│ (Light Dependent Resistor)
        └─┬─┘
          ├────── A0
        ┌─┴─┐
        │10k│ (Pull-down resistor)
        │Ω  │
        └─┬─┘
          │
         GND
</code></pre>
<h3 id="project-4-temperature-controlled-fan"><a class="header" href="#project-4-temperature-controlled-fan">Project 4: Temperature-Controlled Fan</a></h3>
<pre><code class="language-cpp">#include &lt;DHT.h&gt;

#define DHTPIN 2
#define DHTTYPE DHT11
#define FAN_PIN 9  // PWM pin for fan control

DHT dht(DHTPIN, DHTTYPE);

const float TEMP_MIN = 25.0;  // Start fan at 25°C
const float TEMP_MAX = 35.0;  // Full speed at 35°C

void setup() {
    Serial.begin(9600);
    pinMode(FAN_PIN, OUTPUT);
    dht.begin();
}

void loop() {
    float temperature = dht.readTemperature();
    
    if (isnan(temperature)) {
        Serial.println("Failed to read temperature!");
        return;
    }
    
    // Calculate fan speed (0-255)
    int fanSpeed = 0;
    if (temperature &lt; TEMP_MIN) {
        fanSpeed = 0;
    } else if (temperature &gt; TEMP_MAX) {
        fanSpeed = 255;
    } else {
        fanSpeed = map(temperature * 10, TEMP_MIN * 10, TEMP_MAX * 10, 0, 255);
    }
    
    analogWrite(FAN_PIN, fanSpeed);
    
    Serial.print("Temperature: ");
    Serial.print(temperature);
    Serial.print("°C Fan Speed: ");
    Serial.print((fanSpeed * 100) / 255);
    Serial.println("%");
    
    delay(2000);
}
</code></pre>
<h3 id="project-5-simple-data-logger"><a class="header" href="#project-5-simple-data-logger">Project 5: Simple Data Logger</a></h3>
<pre><code class="language-cpp">#include &lt;SD.h&gt;
#include &lt;SPI.h&gt;

const int CS_PIN = 10;
const int SENSOR_PIN = A0;

File dataFile;

void setup() {
    Serial.begin(9600);
    
    // Initialize SD card
    if (!SD.begin(CS_PIN)) {
        Serial.println("SD card initialization failed!");
        return;
    }
    Serial.println("SD card initialized.");
}

void loop() {
    int sensorValue = analogRead(SENSOR_PIN);
    float voltage = sensorValue * (5.0 / 1023.0);
    
    // Open file for writing
    dataFile = SD.open("datalog.txt", FILE_WRITE);
    
    if (dataFile) {
        // Write timestamp and value
        dataFile.print(millis());
        dataFile.print(",");
        dataFile.println(voltage);
        dataFile.close();
        
        Serial.print("Logged: ");
        Serial.println(voltage);
    } else {
        Serial.println("Error opening file!");
    }
    
    delay(1000);  // Log every second
}
</code></pre>
<h2 id="advanced-topics-2"><a class="header" href="#advanced-topics-2">Advanced Topics</a></h2>
<h3 id="interrupts-2"><a class="header" href="#interrupts-2">Interrupts</a></h3>
<pre><code class="language-cpp">const int BUTTON_PIN = 2;  // Must be interrupt-capable pin
const int LED_PIN = 13;

volatile bool ledState = false;

void setup() {
    pinMode(BUTTON_PIN, INPUT_PULLUP);
    pinMode(LED_PIN, OUTPUT);
    
    // Attach interrupt: pin, ISR function, trigger mode
    attachInterrupt(digitalPinToInterrupt(BUTTON_PIN), buttonISR, FALLING);
}

void loop() {
    // Main loop can do other things
    // LED toggle happens immediately when button pressed
}

// Interrupt Service Routine (keep it short!)
void buttonISR() {
    ledState = !ledState;
    digitalWrite(LED_PIN, ledState);
}
</code></pre>
<h3 id="timers-1"><a class="header" href="#timers-1">Timers</a></h3>
<pre><code class="language-cpp">unsigned long previousMillis = 0;
const long interval = 1000;  // 1 second

void setup() {
    pinMode(LED_BUILTIN, OUTPUT);
}

void loop() {
    unsigned long currentMillis = millis();
    
    // Non-blocking timing
    if (currentMillis - previousMillis &gt;= interval) {
        previousMillis = currentMillis;
        
        // Toggle LED
        digitalWrite(LED_BUILTIN, !digitalRead(LED_BUILTIN));
    }
    
    // Can do other things here
}
</code></pre>
<h3 id="memory-optimization-2"><a class="header" href="#memory-optimization-2">Memory Optimization</a></h3>
<pre><code class="language-cpp">// Store strings in flash memory (PROGMEM)
const char message[] PROGMEM = "This string is stored in flash";

void setup() {
    Serial.begin(9600);
    
    // Read from flash memory
    char buffer[50];
    strcpy_P(buffer, message);
    Serial.println(buffer);
}

// Use F() macro for Serial.print
void loop() {
    Serial.println(F("This uses flash memory, not RAM"));
    delay(1000);
}
</code></pre>
<h3 id="low-power-mode"><a class="header" href="#low-power-mode">Low Power Mode</a></h3>
<pre><code class="language-cpp">#include &lt;avr/sleep.h&gt;
#include &lt;avr/power.h&gt;

void setup() {
    pinMode(LED_BUILTIN, OUTPUT);
    pinMode(2, INPUT_PULLUP);
    
    // Enable interrupt for wake-up
    attachInterrupt(digitalPinToInterrupt(2), wakeUp, LOW);
}

void loop() {
    digitalWrite(LED_BUILTIN, HIGH);
    delay(1000);
    digitalWrite(LED_BUILTIN, LOW);
    
    // Enter sleep mode
    enterSleep();
}

void enterSleep() {
    set_sleep_mode(SLEEP_MODE_PWR_DOWN);
    sleep_enable();
    
    // Disable peripherals
    power_adc_disable();
    power_spi_disable();
    power_timer0_disable();
    power_timer1_disable();
    power_timer2_disable();
    power_twi_disable();
    
    sleep_mode();  // Sleep here
    
    // Wake up here
    sleep_disable();
    power_all_enable();
}

void wakeUp() {
    // ISR to wake up
}
</code></pre>
<h2 id="best-practices-60"><a class="header" href="#best-practices-60">Best Practices</a></h2>
<h3 id="1-avoid-delay-for-responsive-code"><a class="header" href="#1-avoid-delay-for-responsive-code">1. Avoid delay() for Responsive Code</a></h3>
<pre><code class="language-cpp">// Bad: Blocking
void loop() {
    digitalWrite(LED1, HIGH);
    delay(1000);
    digitalWrite(LED2, HIGH);
    delay(500);
}

// Good: Non-blocking
unsigned long led1Time = 0;
unsigned long led2Time = 0;

void loop() {
    unsigned long now = millis();
    
    if (now - led1Time &gt;= 1000) {
        digitalWrite(LED1, !digitalRead(LED1));
        led1Time = now;
    }
    
    if (now - led2Time &gt;= 500) {
        digitalWrite(LED2, !digitalRead(LED2));
        led2Time = now;
    }
}
</code></pre>
<h3 id="2-use-const-for-pin-definitions"><a class="header" href="#2-use-const-for-pin-definitions">2. Use const for Pin Definitions</a></h3>
<pre><code class="language-cpp">// Good: Easy to change and read
const int LED_PIN = 13;
const int BUTTON_PIN = 2;
const int SENSOR_PIN = A0;
</code></pre>
<h3 id="3-check-return-values"><a class="header" href="#3-check-return-values">3. Check Return Values</a></h3>
<pre><code class="language-cpp">if (!SD.begin(CS_PIN)) {
    Serial.println("SD card failed!");
    while (1);  // Halt
}
</code></pre>
<h3 id="4-use-meaningful-variable-names"><a class="header" href="#4-use-meaningful-variable-names">4. Use Meaningful Variable Names</a></h3>
<pre><code class="language-cpp">// Bad
int x = analogRead(A0);

// Good
int lightLevel = analogRead(LIGHT_SENSOR_PIN);
</code></pre>
<h3 id="5-comment-complex-logic"><a class="header" href="#5-comment-complex-logic">5. Comment Complex Logic</a></h3>
<pre><code class="language-cpp">// Calculate distance from ultrasonic sensor
// Formula: distance (cm) = duration (µs) × 0.0343 / 2
// Division by 2 accounts for round-trip time
float distance = duration * 0.0343 / 2;
</code></pre>
<h2 id="troubleshooting-18"><a class="header" href="#troubleshooting-18">Troubleshooting</a></h2>
<h3 id="common-issues-19"><a class="header" href="#common-issues-19">Common Issues</a></h3>
<ol>
<li>
<p><strong>Upload Failed</strong></p>
<ul>
<li>Check correct board and port selected</li>
<li>Try pressing reset button before upload</li>
<li>Close Serial Monitor during upload</li>
</ul>
</li>
<li>
<p><strong>Serial Monitor Shows Garbage</strong></p>
<ul>
<li>Check baud rate matches code</li>
<li>Verify USB cable supports data (not just power)</li>
</ul>
</li>
<li>
<p><strong>Sketch Too Large</strong></p>
<ul>
<li>Remove unused libraries</li>
<li>Use PROGMEM for strings</li>
<li>Optimize code</li>
</ul>
</li>
<li>
<p><strong>Unexpected Behavior</strong></p>
<ul>
<li>Add Serial.println() for debugging</li>
<li>Check wiring and connections</li>
<li>Verify power supply adequate</li>
</ul>
</li>
</ol>
<h2 id="resources-34"><a class="header" href="#resources-34">Resources</a></h2>
<ul>
<li><strong>Official Documentation</strong>: https://www.arduino.cc/reference/</li>
<li><strong>Forum</strong>: https://forum.arduino.cc/</li>
<li><strong>Project Hub</strong>: https://create.arduino.cc/projecthub</li>
<li><strong>Libraries</strong>: https://www.arduinolibraries.info/</li>
</ul>
<h2 id="see-also-4"><a class="header" href="#see-also-4">See Also</a></h2>
<ul>
<li><a href="embedded/esp32.html">ESP32</a> - More powerful Arduino-compatible platform</li>
<li><a href="embedded/avr.html">AVR Programming</a> - Low-level AVR microcontroller programming</li>
<li><a href="embedded/gpio.html">GPIO</a> - Digital I/O concepts</li>
<li><a href="embedded/uart.html">UART</a> - Serial communication details</li>
<li><a href="embedded/spi.html">SPI</a> - SPI protocol</li>
<li><a href="embedded/i2c.html">I2C</a> - I2C protocol</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="spi-serial-peripheral-interface"><a class="header" href="#spi-serial-peripheral-interface">SPI (Serial Peripheral Interface)</a></h1>
<h2 id="overview-63"><a class="header" href="#overview-63">Overview</a></h2>
<p>SPI (Serial Peripheral Interface) is a synchronous serial communication protocol used for short-distance communication between microcontrollers and peripheral devices like sensors, displays, SD cards, and flash memory. Developed by Motorola in the 1980s, SPI is known for its high-speed, full-duplex communication capabilities.</p>
<h2 id="key-features-13"><a class="header" href="#key-features-13">Key Features</a></h2>
<ul>
<li><strong>Full-Duplex Communication</strong>: SPI can send and receive data simultaneously on separate lines</li>
<li><strong>High Speed</strong>: Typically operates at speeds from 1 MHz to over 50 MHz</li>
<li><strong>Master-Slave Architecture</strong>: Always has one master device controlling one or more slave devices</li>
<li><strong>Four-Wire Interface</strong>: Uses separate lines for clock, data in, data out, and chip select</li>
<li><strong>No Addressing</strong>: Slave selection is done via dedicated chip select lines</li>
</ul>
<h2 id="signal-lines"><a class="header" href="#signal-lines">Signal Lines</a></h2>
<p>SPI uses four main signal lines:</p>
<div class="table-wrapper"><table><thead><tr><th>Signal</th><th>Alternative Names</th><th>Description</th></tr></thead><tbody>
<tr><td><strong>SCLK</strong></td><td>SCK, CLK</td><td>Serial Clock - Generated by master to synchronize data transfer</td></tr>
<tr><td><strong>MOSI</strong></td><td>SDO, DO, SIMO</td><td>Master Out Slave In - Data from master to slave</td></tr>
<tr><td><strong>MISO</strong></td><td>SDI, DI, SOMI</td><td>Master In Slave Out - Data from slave to master</td></tr>
<tr><td><strong>SS</strong></td><td>CS, NSS</td><td>Slave Select/Chip Select - Selects which slave is active</td></tr>
</tbody></table>
</div>
<h3 id="why-four-wires"><a class="header" href="#why-four-wires">Why Four Wires?</a></h3>
<p>Unlike I2C's two-wire design, SPI uses separate data lines for sending and receiving, enabling full-duplex communication. Each slave device needs its own chip select line, which can increase pin count when multiple slaves are used.</p>
<h2 id="how-it-works-1"><a class="header" href="#how-it-works-1">How It Works</a></h2>
<h3 id="basic-communication-flow"><a class="header" href="#basic-communication-flow">Basic Communication Flow</a></h3>
<ol>
<li><strong>Master selects slave</strong>: Pulls the slave's CS line LOW (active)</li>
<li><strong>Master generates clock</strong>: Starts toggling the SCLK line</li>
<li><strong>Data exchange</strong>: On each clock cycle:
<ul>
<li>Master shifts data out on MOSI</li>
<li>Slave shifts data out on MISO</li>
<li>Both shift data in simultaneously</li>
</ul>
</li>
<li><strong>Master deselects slave</strong>: Pulls CS line HIGH (inactive)</li>
</ol>
<h3 id="clock-polarity-and-phase-cpolcpha"><a class="header" href="#clock-polarity-and-phase-cpolcpha">Clock Polarity and Phase (CPOL/CPHA)</a></h3>
<p>SPI has four modes determined by two settings:</p>
<ul>
<li>
<p><strong>CPOL (Clock Polarity)</strong>: Determines the idle state of the clock</p>
<ul>
<li>CPOL = 0: Clock idles LOW</li>
<li>CPOL = 1: Clock idles HIGH</li>
</ul>
</li>
<li>
<p><strong>CPHA (Clock Phase)</strong>: Determines when data is sampled</p>
<ul>
<li>CPHA = 0: Data sampled on leading edge, shifted on trailing edge</li>
<li>CPHA = 1: Data sampled on trailing edge, shifted on leading edge</li>
</ul>
</li>
</ul>
<div class="table-wrapper"><table><thead><tr><th>Mode</th><th>CPOL</th><th>CPHA</th><th>Clock Idle</th><th>Data Sampled</th></tr></thead><tbody>
<tr><td>0</td><td>0</td><td>0</td><td>LOW</td><td>Leading (rising) edge</td></tr>
<tr><td>1</td><td>0</td><td>1</td><td>LOW</td><td>Trailing (falling) edge</td></tr>
<tr><td>2</td><td>1</td><td>0</td><td>HIGH</td><td>Leading (falling) edge</td></tr>
<tr><td>3</td><td>1</td><td>1</td><td>HIGH</td><td>Trailing (rising) edge</td></tr>
</tbody></table>
</div>
<p><strong>Important</strong>: Master and slave must use the same mode for successful communication!</p>
<h2 id="code-examples-2"><a class="header" href="#code-examples-2">Code Examples</a></h2>
<h3 id="arduino-spi-communication"><a class="header" href="#arduino-spi-communication">Arduino SPI Communication</a></h3>
<pre><code class="language-cpp">#include &lt;SPI.h&gt;

const int chipSelectPin = 10;

void setup() {
  // Initialize SPI pins
  pinMode(chipSelectPin, OUTPUT);
  digitalWrite(chipSelectPin, HIGH);  // Deselect slave initially

  // Initialize SPI library
  SPI.begin();

  // Configure SPI settings
  // Max speed: 4 MHz, MSB first, Mode 0
  SPI.beginTransaction(SPISettings(4000000, MSBFIRST, SPI_MODE0));
}

void loop() {
  // Select slave device
  digitalWrite(chipSelectPin, LOW);

  // Send a byte and receive response simultaneously
  byte command = 0x3A;  // Example command
  byte response = SPI.transfer(command);

  // Send multiple bytes
  byte dataToSend[] = {0x01, 0x02, 0x03};
  for (int i = 0; i &lt; 3; i++) {
    byte receivedByte = SPI.transfer(dataToSend[i]);
  }

  // Deselect slave
  digitalWrite(chipSelectPin, HIGH);

  delay(1000);
}
</code></pre>
<h3 id="stm32-hal-spi-example"><a class="header" href="#stm32-hal-spi-example">STM32 HAL SPI Example</a></h3>
<pre><code class="language-c">#include "stm32f4xx_hal.h"

SPI_HandleTypeDef hspi1;

void SPI_Init(void) {
    hspi1.Instance = SPI1;
    hspi1.Init.Mode = SPI_MODE_MASTER;
    hspi1.Init.Direction = SPI_DIRECTION_2LINES;
    hspi1.Init.DataSize = SPI_DATASIZE_8BIT;
    hspi1.Init.CLKPolarity = SPI_POLARITY_LOW;    // CPOL = 0
    hspi1.Init.CLKPhase = SPI_PHASE_1EDGE;        // CPHA = 0
    hspi1.Init.NSS = SPI_NSS_SOFT;
    hspi1.Init.BaudRatePrescaler = SPI_BAUDRATEPRESCALER_16;
    hspi1.Init.FirstBit = SPI_FIRSTBIT_MSB;
    HAL_SPI_Init(&amp;hspi1);
}

void SPI_Write_Read(uint8_t *txData, uint8_t *rxData, uint16_t size) {
    HAL_GPIO_WritePin(GPIOA, GPIO_PIN_4, GPIO_PIN_RESET);  // CS LOW
    HAL_SPI_TransmitReceive(&amp;hspi1, txData, rxData, size, 100);
    HAL_GPIO_WritePin(GPIOA, GPIO_PIN_4, GPIO_PIN_SET);    // CS HIGH
}
</code></pre>
<h3 id="esp32-spi-example"><a class="header" href="#esp32-spi-example">ESP32 SPI Example</a></h3>
<pre><code class="language-cpp">#include &lt;SPI.h&gt;

SPIClass spi(HSPI);  // Use HSPI bus
const int CS_PIN = 15;

void setup() {
  spi.begin(14, 12, 13, CS_PIN);  // SCLK, MISO, MOSI, SS
  pinMode(CS_PIN, OUTPUT);
  digitalWrite(CS_PIN, HIGH);
}

uint8_t readRegister(uint8_t reg) {
  digitalWrite(CS_PIN, LOW);
  spi.transfer(reg | 0x80);  // Read bit set
  uint8_t value = spi.transfer(0x00);  // Dummy byte to read
  digitalWrite(CS_PIN, HIGH);
  return value;
}

void writeRegister(uint8_t reg, uint8_t value) {
  digitalWrite(CS_PIN, LOW);
  spi.transfer(reg &amp; 0x7F);  // Write bit clear
  spi.transfer(value);
  digitalWrite(CS_PIN, HIGH);
}
</code></pre>
<h2 id="common-use-cases-5"><a class="header" href="#common-use-cases-5">Common Use Cases</a></h2>
<h3 id="1-sd-card-communication"><a class="header" href="#1-sd-card-communication">1. SD Card Communication</a></h3>
<ul>
<li>High-speed file I/O</li>
<li>Supports both SPI and SDIO modes</li>
<li>Ideal for data logging applications</li>
</ul>
<h3 id="2-display-interfaces"><a class="header" href="#2-display-interfaces">2. Display Interfaces</a></h3>
<ul>
<li>TFT LCD displays (ILI9341, ST7735)</li>
<li>OLED displays</li>
<li>E-ink displays</li>
<li>Fast refresh rates for graphics</li>
</ul>
<h3 id="3-sensor-communication"><a class="header" href="#3-sensor-communication">3. Sensor Communication</a></h3>
<ul>
<li>Digital accelerometers (ADXL345)</li>
<li>Gyroscopes (MPU6050 in SPI mode)</li>
<li>Pressure sensors (BMP280)</li>
</ul>
<h3 id="4-memory-devices"><a class="header" href="#4-memory-devices">4. Memory Devices</a></h3>
<ul>
<li>Flash memory (W25Q128)</li>
<li>EEPROM chips</li>
<li>FRAM (Ferroelectric RAM)</li>
</ul>
<h3 id="5-wireless-modules"><a class="header" href="#5-wireless-modules">5. Wireless Modules</a></h3>
<ul>
<li>NRF24L01+ (2.4GHz transceiver)</li>
<li>LoRa modules (SX1278)</li>
<li>WiFi modules</li>
</ul>
<h2 id="spi-vs-i2c-comparison"><a class="header" href="#spi-vs-i2c-comparison">SPI vs I2C Comparison</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Feature</th><th>SPI</th><th>I2C</th></tr></thead><tbody>
<tr><td><strong>Wires</strong></td><td>4 (+ 1 per additional slave)</td><td>2</td></tr>
<tr><td><strong>Speed</strong></td><td>Up to 50+ MHz</td><td>Up to 3.4 MHz</td></tr>
<tr><td><strong>Duplex</strong></td><td>Full-duplex</td><td>Half-duplex</td></tr>
<tr><td><strong>Addressing</strong></td><td>Hardware (CS pins)</td><td>Software (7/10-bit addresses)</td></tr>
<tr><td><strong>Distance</strong></td><td>Short (&lt; 1 meter)</td><td>Short (&lt; 1 meter)</td></tr>
<tr><td><strong>Complexity</strong></td><td>Simple protocol</td><td>More complex protocol</td></tr>
<tr><td><strong>Multi-master</strong></td><td>No (typically)</td><td>Yes</td></tr>
<tr><td><strong>Pins required</strong></td><td>Increases with slaves</td><td>Constant</td></tr>
</tbody></table>
</div>
<h2 id="best-practices-61"><a class="header" href="#best-practices-61">Best Practices</a></h2>
<h3 id="1-wire-length-and-speed"><a class="header" href="#1-wire-length-and-speed">1. Wire Length and Speed</a></h3>
<ul>
<li>Keep wires short (&lt; 30cm) for high speeds</li>
<li>Reduce speed for longer connections</li>
<li>Use twisted pairs for MOSI/MISO on longer runs</li>
</ul>
<h3 id="2-pull-up-resistors"><a class="header" href="#2-pull-up-resistors">2. Pull-up Resistors</a></h3>
<ul>
<li>MISO should have a pull-up resistor (~10k ohm)</li>
<li>Prevents floating when no slave is selected</li>
<li>Some slave devices have built-in pull-ups</li>
</ul>
<h3 id="3-chip-select-management"><a class="header" href="#3-chip-select-management">3. Chip Select Management</a></h3>
<pre><code class="language-cpp">// Always wrap transfers in CS control
digitalWrite(CS, LOW);
// ... SPI operations ...
digitalWrite(CS, HIGH);

// For critical timing, disable interrupts
noInterrupts();
digitalWrite(CS, LOW);
SPI.transfer(data);
digitalWrite(CS, HIGH);
interrupts();
</code></pre>
<h3 id="4-power-considerations"><a class="header" href="#4-power-considerations">4. Power Considerations</a></h3>
<ul>
<li>Ensure all devices share a common ground</li>
<li>Check voltage levels (3.3V vs 5V)</li>
<li>Use level shifters if needed</li>
</ul>
<h3 id="5-multiple-slave-devices"><a class="header" href="#5-multiple-slave-devices">5. Multiple Slave Devices</a></h3>
<pre><code class="language-cpp">// Daisy chain method (saves CS pins)
// Data flows through all slaves
digitalWrite(CS_SHARED, LOW);
SPI.transfer(dataForSlave1);
SPI.transfer(dataForSlave2);
SPI.transfer(dataForSlave3);
digitalWrite(CS_SHARED, HIGH);

// Individual CS method (parallel addressing)
digitalWrite(CS_SLAVE1, LOW);
SPI.transfer(dataForSlave1);
digitalWrite(CS_SLAVE1, HIGH);
</code></pre>
<h2 id="common-issues-and-debugging"><a class="header" href="#common-issues-and-debugging">Common Issues and Debugging</a></h2>
<h3 id="problem-no-data-received"><a class="header" href="#problem-no-data-received">Problem: No Data Received</a></h3>
<ul>
<li>Check CPOL/CPHA mode matches between master and slave</li>
<li>Verify wiring (MOSI to MOSI, MISO to MISO)</li>
<li>Ensure CS is properly toggled</li>
<li>Check clock frequency is within slave's range</li>
</ul>
<h3 id="problem-corrupted-data"><a class="header" href="#problem-corrupted-data">Problem: Corrupted Data</a></h3>
<ul>
<li>Reduce SPI clock speed</li>
<li>Check for loose connections</li>
<li>Add small capacitors (10nF) near slave devices</li>
<li>Ensure proper ground connections</li>
</ul>
<h3 id="problem-multiple-slaves-interfering"><a class="header" href="#problem-multiple-slaves-interfering">Problem: Multiple Slaves Interfering</a></h3>
<ul>
<li>Verify only one CS is active at a time</li>
<li>Check for proper tri-state behavior on MISO</li>
<li>Add pull-up on MISO line</li>
</ul>
<h2 id="eli10-explain-like-im-10"><a class="header" href="#eli10-explain-like-im-10">ELI10 (Explain Like I'm 10)</a></h2>
<p>Imagine you're playing a game with your friend where you both pass notes at the same time:</p>
<ul>
<li><strong>The master</strong> is like the teacher who decides when to pass notes (controls the clock)</li>
<li><strong>MOSI</strong> is the note you pass to your friend</li>
<li><strong>MISO</strong> is the note your friend passes back to you</li>
<li><strong>Chip Select</strong> is like tapping your friend's shoulder to say "Hey, I'm talking to you!"</li>
<li><strong>Clock</strong> is like a metronome that keeps everyone in sync - you both write and read at the same time</li>
</ul>
<p>The cool part? You can both write notes to each other at the exact same time! That's why SPI is called "full-duplex" - it's like talking and listening simultaneously.</p>
<h2 id="further-resources-16"><a class="header" href="#further-resources-16">Further Resources</a></h2>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Serial_Peripheral_Interface">SPI Wikipedia</a> - Detailed technical overview</li>
<li><a href="https://www.analog.com/en/analog-dialogue/articles/introduction-to-spi-interface.html">Analog Devices SPI Tutorial</a></li>
<li><a href="https://learn.sparkfun.com/tutorials/serial-peripheral-interface-spi">SparkFun SPI Tutorial</a></li>
<li><a href="https://www.arduino.cc/en/reference/SPI">Arduino SPI Library Reference</a></li>
<li>Application notes from your microcontroller manufacturer</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="i2c"><a class="header" href="#i2c">I2C</a></h1>
<h2 id="overview-64"><a class="header" href="#overview-64">Overview</a></h2>
<p>I2C (Inter-Integrated Circuit) is a synchronous, multi-master, multi-slave, packet-switched, single-ended, serial communication bus. It was developed by Philips Semiconductor (now NXP Semiconductors) in the 1980s to facilitate communication between integrated circuits on a single board.</p>
<h2 id="key-features-14"><a class="header" href="#key-features-14">Key Features</a></h2>
<ul>
<li><strong>Multi-Master Configuration</strong>: I2C allows multiple master devices to control the bus, enabling more complex communication scenarios.</li>
<li><strong>Two-Wire Interface</strong>: I2C uses only two wires for communication: the Serial Data Line (SDA) and the Serial Clock Line (SCL). This simplicity reduces the number of connections required.</li>
<li><strong>Addressing</strong>: Each device on the I2C bus has a unique address, allowing the master to communicate with specific slaves.</li>
<li><strong>Speed</strong>: I2C supports different data rates, typically 100 kbit/s (Standard Mode), 400 kbit/s (Fast Mode), and up to 3.4 Mbit/s (High-Speed Mode).</li>
</ul>
<h2 id="applications-13"><a class="header" href="#applications-13">Applications</a></h2>
<p>I2C is widely used in various applications, including:</p>
<ul>
<li><strong>Sensor Communication</strong>: Many sensors, such as temperature, humidity, and accelerometers, use I2C to communicate with microcontrollers.</li>
<li><strong>Display Interfaces</strong>: LCD and OLED displays often utilize I2C for data transfer, simplifying the wiring and control.</li>
<li><strong>Memory Devices</strong>: EEPROMs and other memory devices frequently implement I2C for data storage and retrieval.</li>
</ul>
<h2 id="signals"><a class="header" href="#signals">Signals</a></h2>
<p>In the context of I2C, signals refer to the electrical signals used for communication between the master and slave devices on the bus. The key signals in the I2C interface include:</p>
<ul>
<li>
<p><strong>SDA (Serial Data Line)</strong>: This line carries the data being transmitted between devices. It is bidirectional, allowing both the master and slave devices to send and receive data.</p>
</li>
<li>
<p><strong>SCL (Serial Clock Line)</strong>: This line provides the clock signal that synchronizes the data transfer between the master and slave devices. The master device generates the clock signal, ensuring that both devices are in sync during communication.</p>
</li>
<li>
<p><strong>Start Condition</strong>: This is a specific signal generated by the master to indicate the beginning of a data transmission. It is represented by a high-to-low transition on the SDA line while the SCL line is high.</p>
</li>
<li>
<p><strong>Stop Condition</strong>: This signal indicates the end of a data transmission. It is represented by a low-to-high transition on the SDA line while the SCL line is high.</p>
</li>
<li>
<p><strong>Acknowledgment (ACK)</strong>: After each byte of data is transmitted, the receiving device sends an acknowledgment signal back to the sender. This is done by pulling the SDA line low during the ninth clock pulse.</p>
</li>
<li>
<p><strong>No Acknowledgment (NACK)</strong>: If the receiving device does not acknowledge the received data, it will leave the SDA line high during the ninth clock pulse, indicating that the sender should stop transmitting.</p>
</li>
</ul>
<p>These signals are essential for establishing communication, ensuring data integrity, and managing the flow of information between devices on the I2C bus.</p>
<h2 id="conclusion-20"><a class="header" href="#conclusion-20">Conclusion</a></h2>
<p>I2C is a versatile and efficient communication protocol that is essential in embedded systems and electronic devices. Its simplicity and flexibility make it a popular choice for connecting various components in a wide range of applications.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="uart-universal-asynchronous-receiver-transmitter"><a class="header" href="#uart-universal-asynchronous-receiver-transmitter">UART (Universal Asynchronous Receiver-Transmitter)</a></h1>
<h2 id="overview-65"><a class="header" href="#overview-65">Overview</a></h2>
<p>UART is one of the most commonly used serial communication protocols in embedded systems. Unlike SPI and I2C, UART is asynchronous - meaning it doesn't require a shared clock signal between devices. This makes it simple, robust, and perfect for point-to-point communication between two devices.</p>
<h2 id="key-features-15"><a class="header" href="#key-features-15">Key Features</a></h2>
<ul>
<li><strong>Asynchronous</strong>: No shared clock required - devices use pre-agreed baud rates</li>
<li><strong>Point-to-Point</strong>: Communication between exactly two devices</li>
<li><strong>Two-Wire Interface</strong>: Only TX (transmit) and RX (receive) lines needed</li>
<li><strong>Full-Duplex</strong>: Can send and receive data simultaneously</li>
<li><strong>Simple</strong>: Easy to implement and debug</li>
<li><strong>Universal</strong>: Supported by virtually all microcontrollers</li>
</ul>
<h2 id="signal-lines-1"><a class="header" href="#signal-lines-1">Signal Lines</a></h2>
<p>UART uses only two main signal lines (plus ground):</p>
<div class="table-wrapper"><table><thead><tr><th>Signal</th><th>Description</th></tr></thead><tbody>
<tr><td><strong>TX</strong></td><td>Transmit Data - Output from device</td></tr>
<tr><td><strong>RX</strong></td><td>Receive Data - Input to device</td></tr>
<tr><td><strong>GND</strong></td><td>Common ground reference</td></tr>
</tbody></table>
</div>
<p><strong>Important Wiring</strong>: TX of device A connects to RX of device B, and vice versa!</p>
<pre><code>Device A              Device B
  TX      --------&gt;     RX
  RX      &lt;--------     TX
  GND     ---------    GND
</code></pre>
<h2 id="how-it-works-2"><a class="header" href="#how-it-works-2">How It Works</a></h2>
<h3 id="data-frame-structure"><a class="header" href="#data-frame-structure">Data Frame Structure</a></h3>
<p>A typical UART data frame consists of:</p>
<pre><code>  Start   Data Bits   Parity  Stop
   Bit    (5-9)       (Opt)  Bit(s)
        , , , , , , ,
        0 1 2 3 4 5 6 7
</code></pre>
<ol>
<li><strong>Idle State</strong>: Line is HIGH when no data is being sent</li>
<li><strong>Start Bit</strong>: Single LOW bit signals beginning of frame</li>
<li><strong>Data Bits</strong>: 5-9 bits of actual data (usually 8 bits)</li>
<li><strong>Parity Bit</strong> (Optional): Error checking bit</li>
<li><strong>Stop Bit(s)</strong>: 1, 1.5, or 2 HIGH bits signal end of frame</li>
</ol>
<h3 id="baud-rate"><a class="header" href="#baud-rate">Baud Rate</a></h3>
<p>Baud rate is the speed of communication, measured in bits per second (bps).</p>
<p><strong>Common Baud Rates</strong>:</p>
<ul>
<li>9600 bps - Default for many applications</li>
<li>19200 bps</li>
<li>38400 bps</li>
<li>57600 bps</li>
<li>115200 bps - Common for debugging/logging</li>
<li>230400 bps</li>
<li>921600 bps - High-speed applications</li>
</ul>
<p><strong>Formula</strong>:</p>
<pre><code>Bit Duration = 1 / Baud Rate
</code></pre>
<p>At 9600 baud: each bit takes ~104 microseconds</p>
<h3 id="parity-bit"><a class="header" href="#parity-bit">Parity Bit</a></h3>
<p>Parity is a simple error detection method:</p>
<ul>
<li><strong>Even Parity</strong>: Parity bit set so total number of 1s is even</li>
<li><strong>Odd Parity</strong>: Parity bit set so total number of 1s is odd</li>
<li><strong>None</strong>: No parity bit (most common)</li>
</ul>
<h3 id="configuration-format"><a class="header" href="#configuration-format">Configuration Format</a></h3>
<p>UART settings are often written as: <strong>Baud-Data-Parity-Stop</strong></p>
<p>Examples:</p>
<ul>
<li><code>9600-8-N-1</code>: 9600 baud, 8 data bits, No parity, 1 stop bit (most common)</li>
<li><code>115200-8-E-1</code>: 115200 baud, 8 data bits, Even parity, 1 stop bit</li>
</ul>
<h2 id="code-examples-3"><a class="header" href="#code-examples-3">Code Examples</a></h2>
<h3 id="arduino-uart"><a class="header" href="#arduino-uart">Arduino UART</a></h3>
<pre><code class="language-cpp">void setup() {
  // Initialize Serial (UART0) at 9600 baud
  Serial.begin(9600);

  // For other UART ports on boards like Arduino Mega:
  // Serial1.begin(115200);
  // Serial2.begin(9600);

  // Wait for serial port to connect
  while (!Serial) {
    ; // Wait for serial port to connect (needed for native USB)
  }

  Serial.println("UART initialized!");
}

void loop() {
  // Sending data
  Serial.print("Temperature: ");
  Serial.println(25.5);

  // Sending formatted data
  char buffer[50];
  sprintf(buffer, "Value: %d, Time: %lu", 42, millis());
  Serial.println(buffer);

  // Reading data
  if (Serial.available() &gt; 0) {
    // Read a single byte
    char incoming = Serial.read();

    // Read until newline
    String command = Serial.readStringUntil('\n');

    // Read with timeout (default 1000ms)
    Serial.setTimeout(500);
    int value = Serial.parseInt();

    Serial.print("Received: ");
    Serial.println(command);
  }

  delay(1000);
}
</code></pre>
<h3 id="esp32-multiple-uarts"><a class="header" href="#esp32-multiple-uarts">ESP32 Multiple UARTs</a></h3>
<pre><code class="language-cpp">// ESP32 has 3 hardware UARTs
HardwareSerial SerialGPS(1);   // UART1
HardwareSerial SerialModem(2); // UART2

void setup() {
  // Serial0 (USB) - default pins
  Serial.begin(115200);

  // UART1 - custom pins (TX=17, RX=16)
  SerialGPS.begin(9600, SERIAL_8N1, 16, 17);

  // UART2 - custom pins (TX=25, RX=26)
  SerialModem.begin(115200, SERIAL_8N1, 26, 25);
}

void loop() {
  // Read from GPS on UART1
  if (SerialGPS.available()) {
    String gpsData = SerialGPS.readStringUntil('\n');
    Serial.println("GPS: " + gpsData);
  }

  // Read from modem on UART2
  if (SerialModem.available()) {
    String modemResponse = SerialModem.readStringUntil('\n');
    Serial.println("Modem: " + modemResponse);
  }
}
</code></pre>
<h3 id="stm32-hal-uart"><a class="header" href="#stm32-hal-uart">STM32 HAL UART</a></h3>
<pre><code class="language-c">#include "stm32f4xx_hal.h"

UART_HandleTypeDef huart2;

void UART_Init(void) {
    huart2.Instance = USART2;
    huart2.Init.BaudRate = 115200;
    huart2.Init.WordLength = UART_WORDLENGTH_8B;
    huart2.Init.StopBits = UART_STOPBITS_1;
    huart2.Init.Parity = UART_PARITY_NONE;
    huart2.Init.Mode = UART_MODE_TX_RX;
    huart2.Init.HwFlowCtl = UART_HWCONTROL_NONE;
    huart2.Init.OverSampling = UART_OVERSAMPLING_16;
    HAL_UART_Init(&amp;huart2);
}

// Blocking transmission
void UART_SendString(char *str) {
    HAL_UART_Transmit(&amp;huart2, (uint8_t*)str, strlen(str), 100);
}

// Blocking reception
void UART_ReceiveData(uint8_t *buffer, uint16_t size) {
    HAL_UART_Receive(&amp;huart2, buffer, size, 1000);
}

// Interrupt-based reception
void UART_ReceiveIT(uint8_t *buffer, uint16_t size) {
    HAL_UART_Receive_IT(&amp;huart2, buffer, size);
}

// Callback when reception complete
void HAL_UART_RxCpltCallback(UART_HandleTypeDef *huart) {
    if (huart-&gt;Instance == USART2) {
        // Process received data
        // Re-enable reception
        HAL_UART_Receive_IT(&amp;huart2, rxBuffer, RX_BUFFER_SIZE);
    }
}

// DMA-based high-speed transfer
void UART_Transmit_DMA(uint8_t *data, uint16_t size) {
    HAL_UART_Transmit_DMA(&amp;huart2, data, size);
}
</code></pre>
<h3 id="bare-metal-avr-arduino-uno"><a class="header" href="#bare-metal-avr-arduino-uno">Bare-Metal AVR (Arduino Uno)</a></h3>
<pre><code class="language-c">#include &lt;avr/io.h&gt;

#define BAUD 9600
#define UBRR_VALUE ((F_CPU / 16 / BAUD) - 1)

void UART_Init(void) {
    // Set baud rate
    UBRR0H = (UBRR_VALUE &gt;&gt; 8);
    UBRR0L = UBRR_VALUE;

    // Enable transmitter and receiver
    UCSR0B = (1 &lt;&lt; TXEN0) | (1 &lt;&lt; RXEN0);

    // Set frame format: 8 data bits, 1 stop bit, no parity
    UCSR0C = (1 &lt;&lt; UCSZ01) | (1 &lt;&lt; UCSZ00);
}

void UART_Transmit(uint8_t data) {
    // Wait for empty transmit buffer
    while (!(UCSR0A &amp; (1 &lt;&lt; UDRE0)));
    // Put data into buffer, sends the data
    UDR0 = data;
}

uint8_t UART_Receive(void) {
    // Wait for data to be received
    while (!(UCSR0A &amp; (1 &lt;&lt; RXC0)));
    // Get and return received data from buffer
    return UDR0;
}

void UART_Print(const char *str) {
    while (*str) {
        UART_Transmit(*str++);
    }
}
</code></pre>
<h2 id="common-use-cases-6"><a class="header" href="#common-use-cases-6">Common Use Cases</a></h2>
<h3 id="1-debugging-and-logging"><a class="header" href="#1-debugging-and-logging">1. Debugging and Logging</a></h3>
<pre><code class="language-cpp">// Real-time debugging output
Serial.print("Sensor value: ");
Serial.println(sensorValue);
Serial.print("Free RAM: ");
Serial.println(freeRam());
</code></pre>
<h3 id="2-gps-module-communication"><a class="header" href="#2-gps-module-communication">2. GPS Module Communication</a></h3>
<pre><code class="language-cpp">// Reading NMEA sentences from GPS
if (SerialGPS.available()) {
    String nmea = SerialGPS.readStringUntil('\n');
    if (nmea.startsWith("$GPGGA")) {
        parseGPS(nmea);
    }
}
</code></pre>
<h3 id="3-wireless-module-bluetooth-wifi"><a class="header" href="#3-wireless-module-bluetooth-wifi">3. Wireless Module (Bluetooth, WiFi)</a></h3>
<pre><code class="language-cpp">// AT command interface
SerialBT.println("AT+NAME=MyDevice");
delay(100);
String response = SerialBT.readString();
</code></pre>
<h3 id="4-sensor-communication"><a class="header" href="#4-sensor-communication">4. Sensor Communication</a></h3>
<pre><code class="language-cpp">// CO2 sensor command
Serial1.write(cmd, 9);
delay(100);
if (Serial1.available() &gt;= 9) {
    Serial1.readBytes(response, 9);
}
</code></pre>
<h3 id="5-pc-communication"><a class="header" href="#5-pc-communication">5. PC Communication</a></h3>
<pre><code class="language-cpp">// Command protocol with PC
void loop() {
    if (Serial.available()) {
        char cmd = Serial.read();
        switch(cmd) {
            case 'L': digitalWrite(LED, HIGH); break;
            case 'l': digitalWrite(LED, LOW); break;
            case 'T': Serial.println(readTemp()); break;
        }
    }
}
</code></pre>
<h2 id="uart-vs-other-protocols"><a class="header" href="#uart-vs-other-protocols">UART vs Other Protocols</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Feature</th><th>UART</th><th>I2C</th><th>SPI</th></tr></thead><tbody>
<tr><td><strong>Wires</strong></td><td>2 (+ GND)</td><td>2</td><td>4+</td></tr>
<tr><td><strong>Clock</strong></td><td>Asynchronous</td><td>Synchronous</td><td>Synchronous</td></tr>
<tr><td><strong>Devices</strong></td><td>2 (point-to-point)</td><td>Many (multi-master)</td><td>1 master, many slaves</td></tr>
<tr><td><strong>Speed</strong></td><td>Up to ~5 Mbps</td><td>Up to 3.4 Mbps</td><td>Up to 50+ MHz</td></tr>
<tr><td><strong>Distance</strong></td><td>Long (meters)</td><td>Short (&lt; 1m)</td><td>Short (&lt; 1m)</td></tr>
<tr><td><strong>Complexity</strong></td><td>Simple</td><td>Medium</td><td>Simple</td></tr>
<tr><td><strong>Error Detection</strong></td><td>Parity bit</td><td>ACK/NACK</td><td>None</td></tr>
</tbody></table>
</div>
<h2 id="best-practices-62"><a class="header" href="#best-practices-62">Best Practices</a></h2>
<h3 id="1-proper-baud-rate-calculation"><a class="header" href="#1-proper-baud-rate-calculation">1. Proper Baud Rate Calculation</a></h3>
<pre><code class="language-cpp">// Ensure both devices use exact same baud rate
// Check oscillator tolerance - should be &lt; 2%

// For custom baud rates, verify with formula:
// UBRR = (F_CPU / (16 * BAUD)) - 1
</code></pre>
<h3 id="2-buffer-management"><a class="header" href="#2-buffer-management">2. Buffer Management</a></h3>
<pre><code class="language-cpp">// Check available space before reading
if (Serial.available() &gt; 0) {
    int bytesToRead = Serial.available();
    for (int i = 0; i &lt; bytesToRead; i++) {
        rxBuffer[i] = Serial.read();
    }
}

// Or use built-in methods
Serial.readBytes(rxBuffer, expectedSize);
</code></pre>
<h3 id="3-timeout-handling"><a class="header" href="#3-timeout-handling">3. Timeout Handling</a></h3>
<pre><code class="language-cpp">// Set appropriate timeout
Serial.setTimeout(500);  // 500ms

// Check for timeout
int value = Serial.parseInt();
if (value == 0 &amp;&amp; Serial.peek() != '0') {
    // Timeout occurred
    Serial.println("Error: Timeout");
}
</code></pre>
<h3 id="4-flow-control-hardware"><a class="header" href="#4-flow-control-hardware">4. Flow Control (Hardware)</a></h3>
<pre><code>RTS (Request To Send) and CTS (Clear To Send)
Used for high-speed communications or when receiver
might not keep up with sender
</code></pre>
<h3 id="5-protocol-design"><a class="header" href="#5-protocol-design">5. Protocol Design</a></h3>
<pre><code class="language-cpp">// Add framing for reliable communication
// Example: &lt;START&gt;DATA&lt;END&gt;

void sendPacket(uint8_t *data, uint8_t len) {
    Serial.write(0x02);  // STX (Start of Text)
    for (int i = 0; i &lt; len; i++) {
        Serial.write(data[i]);
    }
    uint8_t checksum = calculateChecksum(data, len);
    Serial.write(checksum);
    Serial.write(0x03);  // ETX (End of Text)
}
</code></pre>
<h2 id="common-issues-and-debugging-1"><a class="header" href="#common-issues-and-debugging-1">Common Issues and Debugging</a></h2>
<h3 id="problem-garbage-characters"><a class="header" href="#problem-garbage-characters">Problem: Garbage Characters</a></h3>
<p><strong>Causes</strong>:</p>
<ul>
<li>Baud rate mismatch between devices</li>
<li>Wrong oscillator frequency</li>
<li>Noisy power supply</li>
</ul>
<p><strong>Solutions</strong>:</p>
<pre><code class="language-cpp">// Try common baud rates systematically
Serial.begin(9600);   // Try this
Serial.begin(115200); // Then this

// Check your board's crystal frequency matches F_CPU
</code></pre>
<h3 id="problem-missing-characters"><a class="header" href="#problem-missing-characters">Problem: Missing Characters</a></h3>
<p><strong>Causes</strong>:</p>
<ul>
<li>Buffer overflow (data arriving faster than processing)</li>
<li>Insufficient interrupt priority</li>
</ul>
<p><strong>Solutions</strong>:</p>
<pre><code class="language-cpp">// Increase serial buffer size (in HardwareSerial.cpp)
#define SERIAL_RX_BUFFER_SIZE 256

// Use hardware flow control
// Process data promptly in loop()
</code></pre>
<h3 id="problem-first-character-lost"><a class="header" href="#problem-first-character-lost">Problem: First Character Lost</a></h3>
<p><strong>Causes</strong>:</p>
<ul>
<li>Receiver not initialized before transmitter sends</li>
<li>Start bit detection issue</li>
</ul>
<p><strong>Solutions</strong>:</p>
<pre><code class="language-cpp">// Add startup delay
void setup() {
    Serial.begin(9600);
    delay(100);  // Wait for UART to stabilize
}

// Send dummy byte first
Serial.write(0x00);
delay(10);
</code></pre>
<h2 id="voltage-levels"><a class="header" href="#voltage-levels">Voltage Levels</a></h2>
<h3 id="ttl-uart-33v-or-5v"><a class="header" href="#ttl-uart-33v-or-5v">TTL UART (3.3V or 5V)</a></h3>
<ul>
<li><strong>Logic HIGH</strong>: 2.4V - 5V</li>
<li><strong>Logic LOW</strong>: 0V - 0.8V</li>
<li>Most microcontrollers use this</li>
</ul>
<h3 id="rs-232-uart-legacy"><a class="header" href="#rs-232-uart-legacy">RS-232 UART (Legacy)</a></h3>
<ul>
<li><strong>Logic HIGH (Space)</strong>: -3V to -15V</li>
<li><strong>Logic LOW (Mark)</strong>: +3V to +15V</li>
<li>Requires level shifter (MAX232, MAX3232)</li>
<li>Longer cable runs possible</li>
</ul>
<pre><code class="language-cpp">// Using MAX232 level shifter
// MCU TX -&gt; MAX232 T1IN -&gt; MAX232 T1OUT -&gt; PC RX
// MCU RX &lt;- MAX232 R1OUT &lt;- MAX232 R1IN &lt;- PC TX
</code></pre>
<h2 id="eli10-explain-like-im-10-1"><a class="header" href="#eli10-explain-like-im-10-1">ELI10 (Explain Like I'm 10)</a></h2>
<p>Imagine you and your friend are in different rooms and want to talk using two cans connected by a string:</p>
<ul>
<li><strong>TX (Transmit)</strong> is your mouth speaking into the can</li>
<li><strong>RX (Receive)</strong> is your ear listening from the can</li>
<li><strong>Baud Rate</strong> is how fast you talk - if one person talks super fast and the other listens slowly, you won't understand each other!</li>
<li><strong>Start Bit</strong> is like saying "Hey, listen!" before each word</li>
<li><strong>Stop Bit</strong> is like a pause after each word</li>
</ul>
<p>The cool thing? Both of you can talk and listen at the same time because you have two strings (wires)!</p>
<p>The tricky part? You MUST both agree to talk at the same speed (baud rate) before starting, because there's no way to say "slow down!" once you've begun.</p>
<h2 id="further-resources-17"><a class="header" href="#further-resources-17">Further Resources</a></h2>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Universal_asynchronous_receiver-transmitter">UART Wikipedia</a></li>
<li><a href="https://learn.sparkfun.com/tutorials/serial-communication">SparkFun Serial Communication Tutorial</a></li>
<li><a href="https://www.arduino.cc/reference/en/language/functions/communication/serial/">Arduino Serial Reference</a></li>
<li><a href="https://www.st.com/resource/en/application_note/an4666-stm32-uart-concepts-stmicroelectronics.pdf">AN4666: STM32 UART Concepts</a></li>
<li><a href="http://wormfood.net/avrbaudcalc.php">Baud Rate Calculator</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="usb-protocol"><a class="header" href="#usb-protocol">USB Protocol</a></h1>
<p>Comprehensive guide to USB protocol, device classes, and embedded implementation.</p>
<h2 id="table-of-contents-41"><a class="header" href="#table-of-contents-41">Table of Contents</a></h2>
<ol>
<li><a href="embedded/usb.html#introduction">Introduction</a></li>
<li><a href="embedded/usb.html#usb-basics">USB Basics</a></li>
<li><a href="embedded/usb.html#usb-protocol">USB Protocol</a></li>
<li><a href="embedded/usb.html#device-classes">Device Classes</a></li>
<li><a href="embedded/usb.html#descriptors">Descriptors</a></li>
<li><a href="embedded/usb.html#arduino-usb">Arduino USB</a></li>
<li><a href="embedded/usb.html#stm32-usb">STM32 USB</a></li>
<li><a href="embedded/usb.html#usb-cdc-virtual-serial">USB CDC (Virtual Serial)</a></li>
</ol>
<h2 id="introduction-21"><a class="header" href="#introduction-21">Introduction</a></h2>
<p>USB (Universal Serial Bus) is a standard for connecting devices to a host computer. It provides both power and data communication in a single cable.</p>
<h3 id="usb-versions"><a class="header" href="#usb-versions">USB Versions</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Name</th><th>Speed</th><th>Release</th><th>Connector</th></tr></thead><tbody>
<tr><td><strong>USB 1.0</strong></td><td>Low Speed</td><td>1.5 Mbps</td><td>1996</td><td>Type A/B</td></tr>
<tr><td><strong>USB 1.1</strong></td><td>Full Speed</td><td>12 Mbps</td><td>1998</td><td>Type A/B</td></tr>
<tr><td><strong>USB 2.0</strong></td><td>High Speed</td><td>480 Mbps</td><td>2000</td><td>Type A/B, Mini, Micro</td></tr>
<tr><td><strong>USB 3.0</strong></td><td>SuperSpeed</td><td>5 Gbps</td><td>2008</td><td>Type A/B, Micro B SS</td></tr>
<tr><td><strong>USB 3.1</strong></td><td>SuperSpeed+</td><td>10 Gbps</td><td>2013</td><td>Type C</td></tr>
<tr><td><strong>USB 3.2</strong></td><td>-</td><td>20 Gbps</td><td>2017</td><td>Type C</td></tr>
<tr><td><strong>USB 4.0</strong></td><td>-</td><td>40 Gbps</td><td>2019</td><td>Type C</td></tr>
</tbody></table>
</div>
<h3 id="usb-connectors"><a class="header" href="#usb-connectors">USB Connectors</a></h3>
<pre><code>USB Type A (Host):
┌─────────────┐
│ ┌─┐ ┌─┐ ┌─┐ │
│ │1│ │2│ │3│ │4│
│ └─┘ └─┘ └─┘ │
└─────────────┘
1: VBUS (+5V)
2: D- (Data -)
3: D+ (Data +)
4: GND

USB Type B (Device):
    ┌───┐
  ┌─┘   └─┐
  │ 1   2 │
  │ 3   4 │
  └───────┘

USB Micro B (Common on embedded):
  ┌─────────┐
  │1 2 3 4 5│
  └─────────┘
1: VBUS (+5V)
2: D-
3: D+
4: ID (OTG)
5: GND

USB Type C (Modern):
  ┌───────────┐
  │A1 A2...A12│
  │B1 B2...B12│
  └───────────┘
Reversible, 24 pins
</code></pre>
<h3 id="usb-topology"><a class="header" href="#usb-topology">USB Topology</a></h3>
<pre><code>Host (PC/Hub)
    │
    ├─── Device 1 (Address 1)
    │
    ├─── Hub (Address 2)
    │     │
    │     ├─── Device 2 (Address 3)
    │     └─── Device 3 (Address 4)
    │
    └─── Device 4 (Address 5)

Maximum:
- 127 devices per host
- 5 meter cable length per segment
- 7 tiers (including hub)
</code></pre>
<h2 id="usb-basics"><a class="header" href="#usb-basics">USB Basics</a></h2>
<h3 id="signal-levels"><a class="header" href="#signal-levels">Signal Levels</a></h3>
<ul>
<li><strong>Low Speed (1.5 Mbps)</strong>: D+ pulled down, D- pulled up</li>
<li><strong>Full Speed (12 Mbps)</strong>: D+ pulled up, D- pulled down</li>
<li><strong>High Speed (480 Mbps)</strong>: Differential signaling</li>
</ul>
<h3 id="power"><a class="header" href="#power">Power</a></h3>
<pre><code>USB 2.0: 5V, 500 mA max
USB 3.0: 5V, 900 mA max
USB-C PD: 5V, 9V, 15V, 20V up to 100W
</code></pre>
<h3 id="data-encoding"><a class="header" href="#data-encoding">Data Encoding</a></h3>
<p>USB uses <strong>NRZI</strong> (Non-Return-to-Zero Inverted) encoding with bit stuffing:</p>
<ul>
<li><code>0</code> bit: Transition</li>
<li><code>1</code> bit: No transition</li>
<li>Bit stuffing: After six consecutive <code>1</code>s, insert a <code>0</code></li>
</ul>
<h3 id="packet-types"><a class="header" href="#packet-types">Packet Types</a></h3>
<pre><code>Token Packets:
- SETUP: Initialize control transfer
- IN: Request data from device
- OUT: Send data to device
- SOF: Start of Frame (every 1 ms)

Data Packets:
- DATA0: Even data packet
- DATA1: Odd data packet
- DATA2: High-speed data
- MDATA: Multi-data

Handshake Packets:
- ACK: Acknowledge success
- NAK: Not ready
- STALL: Endpoint halted

Special Packets:
- PRE: Preamble for low-speed
- ERR: Error detected
- SPLIT: High-speed split transaction
</code></pre>
<h2 id="usb-protocol-1"><a class="header" href="#usb-protocol-1">USB Protocol</a></h2>
<h3 id="enumeration-process"><a class="header" href="#enumeration-process">Enumeration Process</a></h3>
<pre><code>1. Device Plugged In
   │
   ├─ USB Reset (SE0 for 10ms)
   │
2. Host Assigns Address 0 (default)
   │
   ├─ Get Device Descriptor
   │  Response: VID, PID, max packet size
   │
3. Host Assigns Unique Address (1-127)
   │
   ├─ Set Address
   │
4. Host Requests Configuration
   │
   ├─ Get Configuration Descriptor
   │  Response: Interfaces, endpoints, class info
   │
   ├─ Get String Descriptors (optional)
   │  Response: Manufacturer, product, serial
   │
5. Host Configures Device
   │
   ├─ Set Configuration
   │
6. Device Ready for Use
</code></pre>
<h3 id="transfer-types"><a class="header" href="#transfer-types">Transfer Types</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Transfer Type</th><th>Speed</th><th>Error Correction</th><th>Use Case</th></tr></thead><tbody>
<tr><td><strong>Control</strong></td><td>Any</td><td>Yes</td><td>Device enumeration, configuration</td></tr>
<tr><td><strong>Bulk</strong></td><td>Full/High</td><td>Yes</td><td>Large data transfers (storage, printers)</td></tr>
<tr><td><strong>Interrupt</strong></td><td>Any</td><td>Yes</td><td>Small, periodic data (HID, mice)</td></tr>
<tr><td><strong>Isochronous</strong></td><td>Full/High</td><td>No</td><td>Real-time audio/video</td></tr>
</tbody></table>
</div>
<h3 id="control-transfer-structure"><a class="header" href="#control-transfer-structure">Control Transfer Structure</a></h3>
<pre><code>Setup Stage:
  Host → Device: SETUP token + DATA0 packet

Data Stage (optional):
  IN:  Device → Host: DATA packets
  OUT: Host → Device: DATA packets

Status Stage:
  IN:  Device → Host: Zero-length DATA1 + ACK
  OUT: Host → Device: Zero-length DATA1 + ACK
</code></pre>
<h3 id="standard-requests"><a class="header" href="#standard-requests">Standard Requests</a></h3>
<pre><code class="language-c">// bmRequestType: Direction | Type | Recipient
#define USB_DIR_OUT     0x00
#define USB_DIR_IN      0x80

#define USB_TYPE_STANDARD   0x00
#define USB_TYPE_CLASS      0x20
#define USB_TYPE_VENDOR     0x40

#define USB_RECIP_DEVICE    0x00
#define USB_RECIP_INTERFACE 0x01
#define USB_RECIP_ENDPOINT  0x02

// bRequest codes
#define USB_REQ_GET_STATUS        0
#define USB_REQ_CLEAR_FEATURE     1
#define USB_REQ_SET_FEATURE       3
#define USB_REQ_SET_ADDRESS       5
#define USB_REQ_GET_DESCRIPTOR    6
#define USB_REQ_SET_DESCRIPTOR    7
#define USB_REQ_GET_CONFIGURATION 8
#define USB_REQ_SET_CONFIGURATION 9
#define USB_REQ_GET_INTERFACE     10
#define USB_REQ_SET_INTERFACE     11
</code></pre>
<h2 id="device-classes"><a class="header" href="#device-classes">Device Classes</a></h2>
<h3 id="usb-class-codes"><a class="header" href="#usb-class-codes">USB Class Codes</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Class</th><th>Code</th><th>Description</th><th>Examples</th></tr></thead><tbody>
<tr><td><strong>CDC</strong></td><td>0x02</td><td>Communications Device</td><td>Virtual COM port, modems</td></tr>
<tr><td><strong>HID</strong></td><td>0x03</td><td>Human Interface Device</td><td>Keyboards, mice, game controllers</td></tr>
<tr><td><strong>Mass Storage</strong></td><td>0x08</td><td>Storage Device</td><td>USB flash drives, external HDDs</td></tr>
<tr><td><strong>Hub</strong></td><td>0x09</td><td>USB Hub</td><td>-</td></tr>
<tr><td><strong>Audio</strong></td><td>0x01</td><td>Audio Device</td><td>Speakers, microphones</td></tr>
<tr><td><strong>Video</strong></td><td>0x0E</td><td>Video Device</td><td>Webcams</td></tr>
<tr><td><strong>Printer</strong></td><td>0x07</td><td>Printer</td><td>-</td></tr>
<tr><td><strong>Vendor Specific</strong></td><td>0xFF</td><td>Custom</td><td>-</td></tr>
</tbody></table>
</div>
<h3 id="hid-human-interface-device"><a class="header" href="#hid-human-interface-device">HID (Human Interface Device)</a></h3>
<pre><code class="language-c">// HID Descriptor
struct HID_Descriptor {
    uint8_t  bLength;           // Size of descriptor
    uint8_t  bDescriptorType;   // HID descriptor type (0x21)
    uint16_t bcdHID;            // HID specification release
    uint8_t  bCountryCode;      // Country code
    uint8_t  bNumDescriptors;   // Number of class descriptors
    uint8_t  bDescriptorType2;  // Report descriptor type (0x22)
    uint16_t wDescriptorLength; // Length of report descriptor
};

// HID Report Descriptor (Mouse example)
const uint8_t mouse_report_descriptor[] = {
    0x05, 0x01,        // Usage Page (Generic Desktop)
    0x09, 0x02,        // Usage (Mouse)
    0xA1, 0x01,        // Collection (Application)
    0x09, 0x01,        //   Usage (Pointer)
    0xA1, 0x00,        //   Collection (Physical)
    0x05, 0x09,        //     Usage Page (Buttons)
    0x19, 0x01,        //     Usage Minimum (Button 1)
    0x29, 0x03,        //     Usage Maximum (Button 3)
    0x15, 0x00,        //     Logical Minimum (0)
    0x25, 0x01,        //     Logical Maximum (1)
    0x95, 0x03,        //     Report Count (3)
    0x75, 0x01,        //     Report Size (1)
    0x81, 0x02,        //     Input (Data, Variable, Absolute)
    0x95, 0x01,        //     Report Count (1)
    0x75, 0x05,        //     Report Size (5)
    0x81, 0x01,        //     Input (Constant) - Padding
    0x05, 0x01,        //     Usage Page (Generic Desktop)
    0x09, 0x30,        //     Usage (X)
    0x09, 0x31,        //     Usage (Y)
    0x15, 0x81,        //     Logical Minimum (-127)
    0x25, 0x7F,        //     Logical Maximum (127)
    0x75, 0x08,        //     Report Size (8)
    0x95, 0x02,        //     Report Count (2)
    0x81, 0x06,        //     Input (Data, Variable, Relative)
    0xC0,              //   End Collection
    0xC0               // End Collection
};
</code></pre>
<h3 id="cdc-communication-device-class"><a class="header" href="#cdc-communication-device-class">CDC (Communication Device Class)</a></h3>
<p>Used for virtual serial ports (USB to UART).</p>
<pre><code class="language-c">// CDC ACM (Abstract Control Model) Interface

// CDC Header Functional Descriptor
struct CDC_Header_Descriptor {
    uint8_t  bLength;
    uint8_t  bDescriptorType;
    uint8_t  bDescriptorSubtype;  // Header (0x00)
    uint16_t bcdCDC;
};

// CDC Call Management Descriptor
struct CDC_CallManagement_Descriptor {
    uint8_t bLength;
    uint8_t bDescriptorType;
    uint8_t bDescriptorSubtype;  // Call Management (0x01)
    uint8_t bmCapabilities;
    uint8_t bDataInterface;
};

// CDC Line Coding (115200 8N1 example)
struct CDC_LineCoding {
    uint32_t dwDTERate;      // Baud rate: 115200
    uint8_t  bCharFormat;    // Stop bits: 1
    uint8_t  bParityType;    // Parity: None (0)
    uint8_t  bDataBits;      // Data bits: 8
};
</code></pre>
<h2 id="descriptors"><a class="header" href="#descriptors">Descriptors</a></h2>
<h3 id="device-descriptor"><a class="header" href="#device-descriptor">Device Descriptor</a></h3>
<pre><code class="language-c">struct USB_Device_Descriptor {
    uint8_t  bLength;            // Size: 18 bytes
    uint8_t  bDescriptorType;    // DEVICE (0x01)
    uint16_t bcdUSB;             // USB version (0x0200 for USB 2.0)
    uint8_t  bDeviceClass;       // Class code
    uint8_t  bDeviceSubClass;    // Subclass code
    uint8_t  bDeviceProtocol;    // Protocol code
    uint8_t  bMaxPacketSize0;    // Max packet size for EP0
    uint16_t idVendor;           // Vendor ID (VID)
    uint16_t idProduct;          // Product ID (PID)
    uint16_t bcdDevice;          // Device release number
    uint8_t  iManufacturer;      // Manufacturer string index
    uint8_t  iProduct;           // Product string index
    uint8_t  iSerialNumber;      // Serial number string index
    uint8_t  bNumConfigurations; // Number of configurations
};

// Example
const uint8_t device_descriptor[] = {
    18,         // bLength
    0x01,       // bDescriptorType (DEVICE)
    0x00, 0x02, // bcdUSB (USB 2.0)
    0x00,       // bDeviceClass (defined in interface)
    0x00,       // bDeviceSubClass
    0x00,       // bDeviceProtocol
    64,         // bMaxPacketSize0
    0x83, 0x04, // idVendor (0x0483 - STMicroelectronics)
    0x40, 0x57, // idProduct (0x5740)
    0x00, 0x02, // bcdDevice (2.0)
    1,          // iManufacturer
    2,          // iProduct
    3,          // iSerialNumber
    1           // bNumConfigurations
};
</code></pre>
<h3 id="configuration-descriptor"><a class="header" href="#configuration-descriptor">Configuration Descriptor</a></h3>
<pre><code class="language-c">struct USB_Configuration_Descriptor {
    uint8_t  bLength;             // Size: 9 bytes
    uint8_t  bDescriptorType;     // CONFIGURATION (0x02)
    uint16_t wTotalLength;        // Total length of data
    uint8_t  bNumInterfaces;      // Number of interfaces
    uint8_t  bConfigurationValue; // Configuration index
    uint8_t  iConfiguration;      // Configuration string index
    uint8_t  bmAttributes;        // Attributes (self/bus powered)
    uint8_t  bMaxPower;           // Max power in 2mA units
};
</code></pre>
<h3 id="interface-descriptor"><a class="header" href="#interface-descriptor">Interface Descriptor</a></h3>
<pre><code class="language-c">struct USB_Interface_Descriptor {
    uint8_t bLength;            // Size: 9 bytes
    uint8_t bDescriptorType;    // INTERFACE (0x04)
    uint8_t bInterfaceNumber;   // Interface index
    uint8_t bAlternateSetting;  // Alternate setting
    uint8_t bNumEndpoints;      // Number of endpoints
    uint8_t bInterfaceClass;    // Class code
    uint8_t bInterfaceSubClass; // Subclass code
    uint8_t bInterfaceProtocol; // Protocol code
    uint8_t iInterface;         // Interface string index
};
</code></pre>
<h3 id="endpoint-descriptor"><a class="header" href="#endpoint-descriptor">Endpoint Descriptor</a></h3>
<pre><code class="language-c">struct USB_Endpoint_Descriptor {
    uint8_t  bLength;          // Size: 7 bytes
    uint8_t  bDescriptorType;  // ENDPOINT (0x05)
    uint8_t  bEndpointAddress; // Address (bit 7: direction)
    uint8_t  bmAttributes;     // Transfer type
    uint16_t wMaxPacketSize;   // Max packet size
    uint8_t  bInterval;        // Polling interval (ms)
};

// Endpoint address format:
// Bit 7: Direction (0 = OUT, 1 = IN)
// Bits 3-0: Endpoint number (0-15)
#define USB_EP_IN(n)  (0x80 | (n))
#define USB_EP_OUT(n) (n)

// Transfer types
#define USB_EP_TYPE_CONTROL     0x00
#define USB_EP_TYPE_ISOCHRONOUS 0x01
#define USB_EP_TYPE_BULK        0x02
#define USB_EP_TYPE_INTERRUPT   0x03
</code></pre>
<h3 id="string-descriptor"><a class="header" href="#string-descriptor">String Descriptor</a></h3>
<pre><code class="language-c">struct USB_String_Descriptor {
    uint8_t bLength;
    uint8_t bDescriptorType;  // STRING (0x03)
    uint16_t wString[];       // Unicode string
};

// String 0 (Language ID)
const uint8_t string0[] = {
    4,      // bLength
    0x03,   // bDescriptorType
    0x09, 0x04  // wLANGID[0]: 0x0409 (English - US)
};

// String 1 (Manufacturer)
const uint8_t string1[] = {
    28,     // bLength
    0x03,   // bDescriptorType
    'M',0, 'a',0, 'n',0, 'u',0, 'f',0, 'a',0, 'c',0, 
    't',0, 'u',0, 'r',0, 'e',0, 'r',0, 0,0
};
</code></pre>
<h2 id="arduino-usb"><a class="header" href="#arduino-usb">Arduino USB</a></h2>
<h3 id="arduino-leonardomicro-atmega32u4"><a class="header" href="#arduino-leonardomicro-atmega32u4">Arduino Leonardo/Micro (ATmega32u4)</a></h3>
<p>The ATmega32u4 has native USB support.</p>
<h4 id="usb-mouse"><a class="header" href="#usb-mouse">USB Mouse</a></h4>
<pre><code class="language-cpp">#include &lt;Mouse.h&gt;

void setup() {
    Mouse.begin();
}

void loop() {
    // Move mouse in a square
    Mouse.move(10, 0);   // Right
    delay(500);
    Mouse.move(0, 10);   // Down
    delay(500);
    Mouse.move(-10, 0);  // Left
    delay(500);
    Mouse.move(0, -10);  // Up
    delay(500);
}
</code></pre>
<h4 id="usb-keyboard"><a class="header" href="#usb-keyboard">USB Keyboard</a></h4>
<pre><code class="language-cpp">#include &lt;Keyboard.h&gt;

const int BUTTON_PIN = 2;

void setup() {
    pinMode(BUTTON_PIN, INPUT_PULLUP);
    Keyboard.begin();
}

void loop() {
    if (digitalRead(BUTTON_PIN) == LOW) {
        Keyboard.print("Hello, World!");
        delay(500);
    }
}
</code></pre>
<h4 id="usb-hid-custom"><a class="header" href="#usb-hid-custom">USB HID Custom</a></h4>
<pre><code class="language-cpp">#include &lt;HID.h&gt;

// Custom HID report descriptor
static const uint8_t _hidReportDescriptor[] PROGMEM = {
    0x06, 0x00, 0xFF,  // Usage Page (Vendor Defined)
    0x09, 0x01,        // Usage (Vendor Usage 1)
    0xA1, 0x01,        // Collection (Application)
    0x15, 0x00,        //   Logical Minimum (0)
    0x26, 0xFF, 0x00,  //   Logical Maximum (255)
    0x75, 0x08,        //   Report Size (8 bits)
    0x95, 0x40,        //   Report Count (64)
    0x09, 0x01,        //   Usage (Vendor Usage 1)
    0x81, 0x02,        //   Input (Data, Variable, Absolute)
    0x09, 0x01,        //   Usage (Vendor Usage 1)
    0x91, 0x02,        //   Output (Data, Variable, Absolute)
    0xC0               // End Collection
};

void setup() {
    static HIDSubDescriptor node(_hidReportDescriptor, sizeof(_hidReportDescriptor));
    HID().AppendDescriptor(&amp;node);
}

void loop() {
    uint8_t data[64] = {1, 2, 3, 4};
    HID().SendReport(1, data, 64);
    delay(100);
}
</code></pre>
<h2 id="stm32-usb"><a class="header" href="#stm32-usb">STM32 USB</a></h2>
<h3 id="usb-cdc-virtual-com-port-cubemx"><a class="header" href="#usb-cdc-virtual-com-port-cubemx">USB CDC Virtual COM Port (CubeMX)</a></h3>
<pre><code class="language-c">/* Generated by CubeMX with USB Device middleware */
#include "usbd_cdc_if.h"

int main(void) {
    HAL_Init();
    SystemClock_Config();
    MX_USB_DEVICE_Init();
    
    uint8_t buffer[64];
    sprintf((char*)buffer, "Hello from STM32!\r\n");
    
    while (1) {
        CDC_Transmit_FS(buffer, strlen((char*)buffer));
        HAL_Delay(1000);
    }
}

/* In usbd_cdc_if.c */
static int8_t CDC_Receive_FS(uint8_t* Buf, uint32_t *Len) {
    // Echo back received data
    CDC_Transmit_FS(Buf, *Len);
    return USBD_OK;
}
</code></pre>
<h3 id="usb-hid-keyboard"><a class="header" href="#usb-hid-keyboard">USB HID Keyboard</a></h3>
<pre><code class="language-c">/* Configure USB Device as HID in CubeMX */
#include "usbd_hid.h"

extern USBD_HandleTypeDef hUsbDeviceFS;

// HID keyboard report
typedef struct {
    uint8_t modifiers;  // Ctrl, Shift, Alt, GUI
    uint8_t reserved;
    uint8_t keys[6];    // Up to 6 simultaneous keys
} KeyboardReport;

void send_key(uint8_t key) {
    KeyboardReport report = {0};
    
    // Press key
    report.keys[0] = key;
    USBD_HID_SendReport(&amp;hUsbDeviceFS, (uint8_t*)&amp;report, sizeof(report));
    HAL_Delay(10);
    
    // Release key
    memset(&amp;report, 0, sizeof(report));
    USBD_HID_SendReport(&amp;hUsbDeviceFS, (uint8_t*)&amp;report, sizeof(report));
    HAL_Delay(10);
}

int main(void) {
    HAL_Init();
    SystemClock_Config();
    MX_USB_DEVICE_Init();
    
    HAL_Delay(1000);  // Wait for enumeration
    
    while (1) {
        // Send 'A' key
        send_key(0x04);  // HID usage code for 'A'
        HAL_Delay(1000);
    }
}
</code></pre>
<h3 id="usb-mass-storage"><a class="header" href="#usb-mass-storage">USB Mass Storage</a></h3>
<pre><code class="language-c">/* Configure USB Device as MSC in CubeMX */
#include "usbd_storage_if.h"

// Implement SCSI commands
int8_t STORAGE_Read_FS(uint8_t lun, uint8_t *buf, uint32_t blk_addr, uint16_t blk_len) {
    // Read from SD card or internal flash
    for (uint16_t i = 0; i &lt; blk_len; i++) {
        // Read block at (blk_addr + i) to (buf + i * BLOCK_SIZE)
    }
    return USBD_OK;
}

int8_t STORAGE_Write_FS(uint8_t lun, uint8_t *buf, uint32_t blk_addr, uint16_t blk_len) {
    // Write to SD card or internal flash
    for (uint16_t i = 0; i &lt; blk_len; i++) {
        // Write block at (blk_addr + i) from (buf + i * BLOCK_SIZE)
    }
    return USBD_OK;
}
</code></pre>
<h2 id="usb-cdc-virtual-serial"><a class="header" href="#usb-cdc-virtual-serial">USB CDC (Virtual Serial)</a></h2>
<h3 id="pc-side-python"><a class="header" href="#pc-side-python">PC Side (Python)</a></h3>
<pre><code class="language-python">import serial
import time

# Open serial port
ser = serial.Serial('COM3', 115200, timeout=1)  # Windows
# ser = serial.Serial('/dev/ttyACM0', 115200, timeout=1)  # Linux

# Write data
ser.write(b'Hello, Device!\n')

# Read data
while True:
    if ser.in_waiting &gt; 0:
        data = ser.readline()
        print(f"Received: {data.decode()}")
    
    time.sleep(0.1)

ser.close()
</code></pre>
<h3 id="pc-side-c"><a class="header" href="#pc-side-c">PC Side (C++)</a></h3>
<pre><code class="language-cpp">// Linux example
#include &lt;fcntl.h&gt;
#include &lt;unistd.h&gt;
#include &lt;termios.h&gt;

int main() {
    int fd = open("/dev/ttyACM0", O_RDWR);
    
    // Configure serial port
    struct termios tty;
    tcgetattr(fd, &amp;tty);
    cfsetospeed(&amp;tty, B115200);
    cfsetispeed(&amp;tty, B115200);
    tty.c_cflag |= (CLOCAL | CREAD);
    tty.c_cflag &amp;= ~PARENB;
    tty.c_cflag &amp;= ~CSTOPB;
    tty.c_cflag &amp;= ~CSIZE;
    tty.c_cflag |= CS8;
    tcsetattr(fd, TCSANOW, &amp;tty);
    
    // Write
    char msg[] = "Hello, Device!\n";
    write(fd, msg, sizeof(msg));
    
    // Read
    char buffer[256];
    int n = read(fd, buffer, sizeof(buffer));
    buffer[n] = '\0';
    printf("Received: %s\n", buffer);
    
    close(fd);
    return 0;
}
</code></pre>
<h2 id="best-practices-63"><a class="header" href="#best-practices-63">Best Practices</a></h2>
<ol>
<li><strong>VID/PID</strong>: Use unique Vendor ID and Product ID (or get your own)</li>
<li><strong>Descriptors</strong>: Ensure correct descriptor chain</li>
<li><strong>Enumeration</strong>: Handle USB reset and enumeration properly</li>
<li><strong>Power</strong>: Declare correct power consumption</li>
<li><strong>String Descriptors</strong>: Provide manufacturer, product, serial number</li>
<li><strong>Error Handling</strong>: Handle NAK, STALL conditions</li>
<li><strong>Buffer Management</strong>: Use DMA for better performance</li>
<li><strong>Compliance</strong>: Test with USB-IF tools for certification</li>
</ol>
<h2 id="debugging-tools"><a class="header" href="#debugging-tools">Debugging Tools</a></h2>
<h3 id="linux"><a class="header" href="#linux">Linux</a></h3>
<pre><code class="language-bash"># List USB devices
lsusb

# Detailed info
lsusb -v

# Monitor USB traffic
sudo cat /sys/kernel/debug/usb/usbmon/0u

# Install usbutils
sudo apt install usbutils
</code></pre>
<h3 id="windows-1"><a class="header" href="#windows-1">Windows</a></h3>
<ul>
<li><strong>USBView</strong>: Microsoft USB device viewer</li>
<li><strong>USBDeview</strong>: NirSoft utility</li>
<li><strong>Wireshark</strong>: With USB capture support</li>
</ul>
<h3 id="hardware"><a class="header" href="#hardware">Hardware</a></h3>
<ul>
<li><strong>USB Protocol Analyzer</strong>: Beagle USB, Total Phase</li>
<li><strong>Logic Analyzer</strong>: Can decode USB signals</li>
</ul>
<h2 id="troubleshooting-19"><a class="header" href="#troubleshooting-19">Troubleshooting</a></h2>
<h3 id="common-issues-20"><a class="header" href="#common-issues-20">Common Issues</a></h3>
<p><strong>Device Not Recognized:</strong></p>
<ul>
<li>Check USB cable (data lines)</li>
<li>Verify correct descriptors</li>
<li>Check VID/PID not conflicting</li>
<li>Ensure proper enumeration handling</li>
</ul>
<p><strong>Intermittent Disconnects:</strong></p>
<ul>
<li>Power supply insufficient</li>
<li>Check USB cable quality</li>
<li>Verify proper suspend/resume handling</li>
</ul>
<p><strong>Data Corruption:</strong></p>
<ul>
<li>Check buffer sizes</li>
<li>Verify DMA configuration</li>
<li>Ensure proper synchronization</li>
</ul>
<p><strong>Slow Transfer Speed:</strong></p>
<ul>
<li>Use bulk transfers for large data</li>
<li>Enable DMA</li>
<li>Optimize buffer sizes</li>
<li>Check USB 2.0 High Speed mode</li>
</ul>
<h2 id="resources-35"><a class="header" href="#resources-35">Resources</a></h2>
<ul>
<li><strong>USB Specification</strong>: USB.org</li>
<li><strong>USB Made Simple</strong>: https://www.usbmadesimple.co.uk/</li>
<li><strong>STM32 USB Training</strong>: ST's USB training materials</li>
<li><strong>Jan Axelson's USB</strong>: Classic USB development book</li>
<li><strong>Linux USB</strong>: https://www.kernel.org/doc/html/latest/driver-api/usb/</li>
</ul>
<h2 id="see-also-5"><a class="header" href="#see-also-5">See Also</a></h2>
<ul>
<li><a href="embedded/stm32.html">STM32 USB</a></li>
<li><a href="embedded/arduino.html">Arduino USB HID</a></li>
<li><a href="embedded/../protocols/">Communication Protocols</a></li>
<li><a href="embedded/README.html">Embedded Systems Overview</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="can-controller-area-network"><a class="header" href="#can-controller-area-network">CAN (Controller Area Network)</a></h1>
<p>Controller Area Network (CAN) is a robust vehicle bus standard designed to allow microcontrollers and devices to communicate with each other without a host computer. It is widely used in automotive and industrial applications due to its reliability and efficiency.</p>
<h2 id="key-concepts-21"><a class="header" href="#key-concepts-21">Key Concepts</a></h2>
<ul>
<li>
<p><strong>Frames</strong>: CAN communication is based on frames, which are structured packets of data. Each frame contains an identifier, control bits, data, and error-checking information.</p>
</li>
<li>
<p><strong>Identifiers</strong>: Each frame has a unique identifier that determines the priority of the message. Lower identifier values have higher priority on the bus.</p>
</li>
<li>
<p><strong>Bitwise Arbitration</strong>: CAN uses a non-destructive bitwise arbitration method to control access to the bus. This ensures that the highest priority message is transmitted without collision.</p>
</li>
</ul>
<h2 id="common-standards"><a class="header" href="#common-standards">Common Standards</a></h2>
<ol>
<li><strong>CAN 2.0A</strong>: This standard defines 11-bit identifiers for frames.</li>
<li><strong>CAN 2.0B</strong>: This standard extends the identifier length to 29 bits, allowing for more unique message identifiers.</li>
<li><strong>CAN FD (Flexible Data-rate)</strong>: This standard allows for higher data rates and larger data payloads compared to traditional CAN.</li>
</ol>
<h2 id="applications-14"><a class="header" href="#applications-14">Applications</a></h2>
<p>CAN is used in various applications, including:</p>
<ul>
<li><strong>Automotive</strong>: Enabling communication between different electronic control units (ECUs) in vehicles, such as engine control, transmission, and braking systems.</li>
<li><strong>Industrial Automation</strong>: Facilitating communication between sensors, actuators, and controllers in manufacturing and process control systems.</li>
<li><strong>Medical Equipment</strong>: Ensuring reliable data exchange between different components of medical devices.</li>
</ul>
<h2 id="conclusion-21"><a class="header" href="#conclusion-21">Conclusion</a></h2>
<p>CAN is a critical communication protocol in automotive and industrial systems, providing reliable and efficient data exchange. Understanding CAN's principles and standards is essential for engineers working in these fields.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sdio"><a class="header" href="#sdio">SDIO</a></h1>
<h2 id="overview-66"><a class="header" href="#overview-66">Overview</a></h2>
<p>SDIO (Secure Digital Input Output) is an extension of the SD (Secure Digital) card standard that allows for the integration of input/output devices into the SD card interface. This enables various peripherals, such as Wi-Fi, Bluetooth, GPS, and other sensors, to be connected to a host device through a standard SD card slot.</p>
<h2 id="key-features-16"><a class="header" href="#key-features-16">Key Features</a></h2>
<ul>
<li><strong>Versatility</strong>: SDIO supports a wide range of devices, making it suitable for various applications in mobile devices, embedded systems, and consumer electronics.</li>
<li><strong>Hot Swappable</strong>: SDIO devices can be inserted and removed while the host device is powered on, allowing for greater flexibility in device management.</li>
<li><strong>Standardized Interface</strong>: The SDIO interface is standardized, which simplifies the development process for manufacturers and developers.</li>
</ul>
<h2 id="applications-15"><a class="header" href="#applications-15">Applications</a></h2>
<p>SDIO is commonly used in:</p>
<ul>
<li><strong>Wireless Communication</strong>: Many Wi-Fi and Bluetooth modules utilize SDIO to connect to host devices, enabling wireless connectivity.</li>
<li><strong>GPS Modules</strong>: GPS receivers can be integrated via SDIO, providing location services to mobile devices.</li>
<li><strong>Sensor Integration</strong>: Various sensors, such as accelerometers and gyroscopes, can be connected through SDIO for enhanced functionality in applications like gaming and navigation.</li>
</ul>
<h2 id="signals-1"><a class="header" href="#signals-1">Signals</a></h2>
<p>In the context of SDIO, signals refer to the electrical signals used for communication between the host device and the SDIO peripheral. These signals are essential for data transfer, command execution, and device management. The key signals in the SDIO interface include:</p>
<ul>
<li>
<p><strong>CMD (Command Line)</strong>: This signal is used to send commands from the host to the SDIO device. It is essential for initiating communication and controlling the operation of the device.</p>
</li>
<li>
<p><strong>CLK (Clock Line)</strong>: The clock signal synchronizes the data transfer between the host and the SDIO device. It ensures that both the host and the device are in sync during communication.</p>
</li>
<li>
<p><strong>DATA (Data Lines)</strong>: These lines are used for data transfer between the host and the SDIO device. SDIO supports multiple data lines (typically 1, 4, or 8) to increase the data transfer rate.</p>
</li>
<li>
<p><strong>CD (Card Detect)</strong>: This signal indicates whether an SDIO device is present in the slot. It allows the host to detect when a device is inserted or removed.</p>
</li>
<li>
<p><strong>WP (Write Protect)</strong>: This signal is used to indicate whether the SDIO device is write-protected. It prevents accidental data modification when the device is in a write-protect state.</p>
</li>
</ul>
<h2 id="conclusion-22"><a class="header" href="#conclusion-22">Conclusion</a></h2>
<p>SDIO is a powerful extension of the SD card standard that enhances the capabilities of mobile and embedded devices by allowing the integration of various peripherals. Its versatility and standardized interface make it a popular choice for developers looking to expand the functionality of their devices.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ethernet"><a class="header" href="#ethernet">Ethernet</a></h1>
<p>Ethernet is a widely used networking technology that enables devices to communicate over a local area network (LAN). It is a fundamental technology for connecting computers, printers, and other devices in homes and businesses.</p>
<h2 id="key-concepts-22"><a class="header" href="#key-concepts-22">Key Concepts</a></h2>
<ul>
<li>
<p><strong>Frames</strong>: Ethernet transmits data in packets called frames. Each frame contains source and destination MAC addresses, as well as the data being transmitted.</p>
</li>
<li>
<p><strong>MAC Address</strong>: A Media Access Control (MAC) address is a unique identifier assigned to network interfaces for communication on the physical network segment.</p>
</li>
<li>
<p><strong>Switching</strong>: Ethernet switches are devices that connect multiple devices on a LAN and use MAC addresses to forward frames to the correct destination.</p>
</li>
</ul>
<h2 id="common-standards-1"><a class="header" href="#common-standards-1">Common Standards</a></h2>
<ol>
<li>
<p><strong>IEEE 802.3</strong>: This is the standard that defines the physical and data link layers for Ethernet networks. It includes specifications for various speeds, such as 10 Mbps, 100 Mbps, 1 Gbps, and 10 Gbps.</p>
</li>
<li>
<p><strong>Full Duplex</strong>: Modern Ethernet supports full duplex communication, allowing devices to send and receive data simultaneously, which improves network efficiency.</p>
</li>
<li>
<p><strong>VLANs</strong>: Virtual Local Area Networks (VLANs) allow network administrators to segment a single physical network into multiple logical networks for improved security and performance.</p>
</li>
</ol>
<h2 id="applications-16"><a class="header" href="#applications-16">Applications</a></h2>
<p>Ethernet is used in various applications, including:</p>
<ul>
<li>
<p><strong>Local Area Networking</strong>: Connecting computers and devices within a limited geographical area, such as an office or home.</p>
</li>
<li>
<p><strong>Data Centers</strong>: Providing high-speed connections between servers and storage devices.</p>
</li>
<li>
<p><strong>Industrial Automation</strong>: Enabling communication between machines and control systems in manufacturing environments.</p>
</li>
</ul>
<h2 id="different-signals-in-ethernet"><a class="header" href="#different-signals-in-ethernet">Different Signals in Ethernet</a></h2>
<p>Ethernet communication relies on various signals to transmit data over the network. These signals include:</p>
<ol>
<li>
<p><strong>Carrier Sense</strong>: Ethernet devices use carrier sense to detect if the network medium is idle or busy before transmitting data. This helps prevent collisions on the network.</p>
</li>
<li>
<p><strong>Collision Detection</strong>: In half-duplex Ethernet, devices use collision detection to identify when two devices transmit data simultaneously, causing a collision. When a collision is detected, devices stop transmitting and wait for a random backoff period before attempting to retransmit.</p>
</li>
<li>
<p><strong>Preamble</strong>: Each Ethernet frame begins with a preamble, a sequence of alternating 1s and 0s, which allows devices to synchronize their clocks and prepare for the incoming data.</p>
</li>
<li>
<p><strong>Start Frame Delimiter (SFD)</strong>: Following the preamble, the SFD is a specific pattern that indicates the start of the actual Ethernet frame.</p>
</li>
<li>
<p><strong>Clock Signals</strong>: Ethernet devices use clock signals to maintain synchronization between the transmitter and receiver, ensuring accurate data transmission.</p>
</li>
<li>
<p><strong>Link Pulse</strong>: In 10BASE-T Ethernet, link pulses are used to establish and maintain a connection between devices. These pulses are sent periodically to indicate that the link is active.</p>
</li>
</ol>
<p>Understanding these signals is crucial for diagnosing and troubleshooting Ethernet network issues, as well as for designing and implementing reliable Ethernet communication systems.</p>
<h2 id="conclusion-23"><a class="header" href="#conclusion-23">Conclusion</a></h2>
<p>Ethernet remains a cornerstone of modern networking, providing reliable and high-speed communication for a wide range of applications. Understanding Ethernet's principles and standards is essential for network engineers and IT professionals.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="pwm-pulse-width-modulation"><a class="header" href="#pwm-pulse-width-modulation">PWM (Pulse Width Modulation)</a></h1>
<h2 id="overview-67"><a class="header" href="#overview-67">Overview</a></h2>
<p>Pulse Width Modulation (PWM) is a technique for controlling power delivery to electrical devices by rapidly switching between ON and OFF states. By varying the ratio of ON time to OFF time (duty cycle), you can control the average power delivered without actually changing the voltage level. This makes PWM highly efficient and versatile for applications ranging from LED dimming to motor control.</p>
<h2 id="key-concepts-23"><a class="header" href="#key-concepts-23">Key Concepts</a></h2>
<h3 id="duty-cycle"><a class="header" href="#duty-cycle">Duty Cycle</a></h3>
<p>The <strong>duty cycle</strong> is the percentage of time the signal is HIGH during one complete cycle.</p>
<pre><code>Duty Cycle (%) = (Ton / (Ton + Toff)) × 100

Where:
- Ton = Time the signal is HIGH
- Toff = Time the signal is LOW
- Period = Ton + Toff
</code></pre>
<p><strong>Examples</strong>:</p>
<ul>
<li><strong>0% duty cycle</strong>: Always LOW (0V average)</li>
<li><strong>25% duty cycle</strong>: HIGH for 1/4 of the period</li>
<li><strong>50% duty cycle</strong>: HIGH for half the period</li>
<li><strong>75% duty cycle</strong>: HIGH for 3/4 of the period</li>
<li><strong>100% duty cycle</strong>: Always HIGH (full voltage)</li>
</ul>
<h3 id="frequency"><a class="header" href="#frequency">Frequency</a></h3>
<p>The <strong>frequency</strong> determines how many ON/OFF cycles occur per second, measured in Hertz (Hz).</p>
<pre><code>Frequency = 1 / Period
Period = 1 / Frequency
</code></pre>
<p><strong>Typical Frequencies</strong>:</p>
<ul>
<li><strong>LED Dimming</strong>: 500 Hz - 20 kHz (above flicker perception ~60 Hz)</li>
<li><strong>Motor Control</strong>: 1 kHz - 40 kHz</li>
<li><strong>Audio</strong>: 40 kHz+ (above human hearing)</li>
<li><strong>Servo Motors</strong>: 50 Hz (20ms period)</li>
</ul>
<h3 id="average-voltage"><a class="header" href="#average-voltage">Average Voltage</a></h3>
<p>The average voltage delivered by PWM:</p>
<pre><code>Average Voltage = Supply Voltage × (Duty Cycle / 100)

Example (5V supply):
- 0% duty → 0V average
- 25% duty → 1.25V average
- 50% duty → 2.5V average
- 100% duty → 5V average
</code></pre>
<h3 id="visual-representation-3"><a class="header" href="#visual-representation-3">Visual Representation</a></h3>
<pre><code>100% Duty Cycle (Always ON):
█████████████████████████████

75% Duty Cycle:
██████████████████░░░░░░░

50% Duty Cycle:
█████████████░░░░░░░░░░░░

25% Duty Cycle:
██████░░░░░░░░░░░░░░░░░░░

0% Duty Cycle (Always OFF):
░░░░░░░░░░░░░░░░░░░░░░░░░
</code></pre>
<h2 id="how-it-works-3"><a class="header" href="#how-it-works-3">How It Works</a></h2>
<h3 id="hardware-pwm-vs-software-pwm"><a class="header" href="#hardware-pwm-vs-software-pwm">Hardware PWM vs Software PWM</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Feature</th><th>Hardware PWM</th><th>Software PWM</th></tr></thead><tbody>
<tr><td><strong>Precision</strong></td><td>Very precise, timer-based</td><td>Can jitter with interrupts</td></tr>
<tr><td><strong>CPU Load</strong></td><td>Zero (handled by hardware)</td><td>High (CPU must toggle pin)</td></tr>
<tr><td><strong>Pins</strong></td><td>Limited (specific pins only)</td><td>Any digital pin</td></tr>
<tr><td><strong>Frequency</strong></td><td>High (up to MHz)</td><td>Low (few kHz max)</td></tr>
<tr><td><strong>Recommended</strong></td><td>Motors, audio, servos</td><td>Simple LED control</td></tr>
</tbody></table>
</div>
<h3 id="pwm-resolution"><a class="header" href="#pwm-resolution">PWM Resolution</a></h3>
<p>Resolution is the number of distinct duty cycle levels available:</p>
<div class="table-wrapper"><table><thead><tr><th>Resolution</th><th>Levels</th><th>Step Size (at 5V)</th></tr></thead><tbody>
<tr><td>8-bit</td><td>256</td><td>19.5 mV</td></tr>
<tr><td>10-bit</td><td>1024</td><td>4.88 mV</td></tr>
<tr><td>12-bit</td><td>4096</td><td>1.22 mV</td></tr>
<tr><td>16-bit</td><td>65536</td><td>76 μV</td></tr>
</tbody></table>
</div>
<p><strong>Note</strong>: Higher resolution requires lower maximum frequency:</p>
<pre><code>Max Frequency = Clock Frequency / (2^Resolution)
</code></pre>
<h2 id="code-examples-4"><a class="header" href="#code-examples-4">Code Examples</a></h2>
<h3 id="arduino-pwm-hardware"><a class="header" href="#arduino-pwm-hardware">Arduino PWM (Hardware)</a></h3>
<pre><code class="language-cpp">// Arduino Uno PWM pins: 3, 5, 6, 9, 10, 11
// Default frequency: ~490 Hz (pins 3,9,10,11) and ~980 Hz (pins 5,6)

const int ledPin = 9;
const int motorPin = 10;

void setup() {
  pinMode(ledPin, OUTPUT);
  pinMode(motorPin, OUTPUT);
}

void loop() {
  // analogWrite uses 8-bit resolution (0-255)

  // LED at 25% brightness
  analogWrite(ledPin, 64);  // 64/255 = 25%
  delay(1000);

  // LED at 50% brightness
  analogWrite(ledPin, 128);  // 128/255 = 50%
  delay(1000);

  // LED at 75% brightness
  analogWrite(ledPin, 192);  // 192/255 = 75%
  delay(1000);

  // LED at 100% brightness
  analogWrite(ledPin, 255);  // 255/255 = 100%
  delay(1000);
}

// Smooth fade effect
void fadeLED() {
  // Fade in
  for (int brightness = 0; brightness &lt;= 255; brightness++) {
    analogWrite(ledPin, brightness);
    delay(5);
  }

  // Fade out
  for (int brightness = 255; brightness &gt;= 0; brightness--) {
    analogWrite(ledPin, brightness);
    delay(5);
  }
}

// Change PWM frequency (Arduino Uno)
void setPWMFrequency(int pin, int divisor) {
  byte mode;

  if (pin == 5 || pin == 6 || pin == 9 || pin == 10) {
    switch(divisor) {
      case 1: mode = 0x01; break;    // 31.25 kHz
      case 8: mode = 0x02; break;    // 3.9 kHz
      case 64: mode = 0x03; break;   // 490 Hz (default for 9,10)
      case 256: mode = 0x04; break;  // 122 Hz
      case 1024: mode = 0x05; break; // 30 Hz
      default: return;
    }

    if (pin == 5 || pin == 6) {
      TCCR0B = (TCCR0B &amp; 0b11111000) | mode;
    } else {
      TCCR1B = (TCCR1B &amp; 0b11111000) | mode;
    }
  }
}

void setup() {
  pinMode(9, OUTPUT);
  setPWMFrequency(9, 1);  // Set pin 9 to 31.25 kHz
}
</code></pre>
<h3 id="esp32-pwm-ledc"><a class="header" href="#esp32-pwm-ledc">ESP32 PWM (LEDC)</a></h3>
<pre><code class="language-cpp">// ESP32 uses LEDC (LED Control) for PWM
// 16 independent channels, configurable frequency and resolution

const int ledPin = 25;
const int pwmChannel = 0;      // Channel 0-15
const int pwmFrequency = 5000; // 5 kHz
const int pwmResolution = 8;   // 8-bit (0-255)

void setup() {
  // Configure PWM channel
  ledcSetup(pwmChannel, pwmFrequency, pwmResolution);

  // Attach pin to PWM channel
  ledcAttachPin(ledPin, pwmChannel);
}

void loop() {
  // Set duty cycle (0-255 for 8-bit)
  ledcWrite(pwmChannel, 128);  // 50% duty cycle
  delay(1000);

  ledcWrite(pwmChannel, 64);   // 25% duty cycle
  delay(1000);
}

// High resolution PWM (16-bit)
void setupHighResPWM() {
  const int pwmChannel = 0;
  const int pwmFreq = 1000;    // Lower freq for higher resolution
  const int pwmRes = 16;       // 16-bit (0-65535)

  ledcSetup(pwmChannel, pwmFreq, pwmRes);
  ledcAttachPin(ledPin, pwmChannel);

  // Set to 50% with 16-bit precision
  ledcWrite(pwmChannel, 32768);
}

// Multiple PWM channels for RGB LED
const int redPin = 25;
const int greenPin = 26;
const int bluePin = 27;

void setupRGB() {
  ledcSetup(0, 5000, 8);  // Red channel
  ledcSetup(1, 5000, 8);  // Green channel
  ledcSetup(2, 5000, 8);  // Blue channel

  ledcAttachPin(redPin, 0);
  ledcAttachPin(greenPin, 1);
  ledcAttachPin(bluePin, 2);
}

void setRGBColor(uint8_t r, uint8_t g, uint8_t b) {
  ledcWrite(0, r);
  ledcWrite(1, g);
  ledcWrite(2, b);
}

void loop() {
  setRGBColor(255, 0, 0);    // Red
  delay(1000);
  setRGBColor(0, 255, 0);    // Green
  delay(1000);
  setRGBColor(0, 0, 255);    // Blue
  delay(1000);
  setRGBColor(255, 255, 0);  // Yellow
  delay(1000);
}
</code></pre>
<h3 id="stm32-hal-pwm"><a class="header" href="#stm32-hal-pwm">STM32 HAL PWM</a></h3>
<pre><code class="language-c">#include "stm32f4xx_hal.h"

TIM_HandleTypeDef htim3;

void PWM_Init(void) {
    TIM_OC_InitTypeDef sConfigOC = {0};

    // Timer 3 configuration for PWM
    htim3.Instance = TIM3;
    htim3.Init.Prescaler = 84 - 1;       // 84 MHz / 84 = 1 MHz
    htim3.Init.CounterMode = TIM_COUNTERMODE_UP;
    htim3.Init.Period = 1000 - 1;        // 1 MHz / 1000 = 1 kHz PWM
    htim3.Init.ClockDivision = TIM_CLOCKDIVISION_DIV1;
    HAL_TIM_PWM_Init(&amp;htim3);

    // Configure PWM channel 1
    sConfigOC.OCMode = TIM_OCMODE_PWM1;
    sConfigOC.Pulse = 500;               // 50% duty cycle
    sConfigOC.OCPolarity = TIM_OCPOLARITY_HIGH;
    sConfigOC.OCFastMode = TIM_OCFAST_DISABLE;
    HAL_TIM_PWM_ConfigChannel(&amp;htim3, &amp;sConfigOC, TIM_CHANNEL_1);

    // Start PWM
    HAL_TIM_PWM_Start(&amp;htim3, TIM_CHANNEL_1);
}

void PWM_SetDutyCycle(uint16_t dutyCycle) {
    // dutyCycle: 0-1000 (0-100%)
    __HAL_TIM_SET_COMPARE(&amp;htim3, TIM_CHANNEL_1, dutyCycle);
}

void PWM_SetPercent(uint8_t percent) {
    // percent: 0-100
    uint16_t pulse = (percent * 1000) / 100;
    PWM_SetDutyCycle(pulse);
}
</code></pre>
<h3 id="servo-control-with-pwm"><a class="header" href="#servo-control-with-pwm">Servo Control with PWM</a></h3>
<pre><code class="language-cpp">// Standard servo: 50 Hz (20ms period)
// Pulse width: 1ms (0°) to 2ms (180°)

const int servoPin = 9;

void setup() {
  pinMode(servoPin, OUTPUT);
}

void setServoAngle(int angle) {
  // Map angle (0-180) to pulse width (1000-2000 μs)
  int pulseWidth = map(angle, 0, 180, 1000, 2000);

  // Generate 50 Hz PWM signal
  digitalWrite(servoPin, HIGH);
  delayMicroseconds(pulseWidth);
  digitalWrite(servoPin, LOW);
  delayMicroseconds(20000 - pulseWidth);  // Complete 20ms period
}

void loop() {
  setServoAngle(0);      // 0 degrees
  delay(1000);
  setServoAngle(90);     // 90 degrees
  delay(1000);
  setServoAngle(180);    // 180 degrees
  delay(1000);
}

// Using Servo library (easier)
#include &lt;Servo.h&gt;

Servo myServo;

void setup() {
  myServo.attach(9);     // Attach servo to pin 9
}

void loop() {
  myServo.write(0);      // 0 degrees
  delay(1000);
  myServo.write(90);     // 90 degrees
  delay(1000);
  myServo.write(180);    // 180 degrees
  delay(1000);
}
</code></pre>
<h3 id="motor-control-h-bridge"><a class="header" href="#motor-control-h-bridge">Motor Control (H-Bridge)</a></h3>
<pre><code class="language-cpp">// Control DC motor speed and direction with L298N H-Bridge

const int motorPWM = 9;    // Speed control (PWM)
const int motorIN1 = 7;    // Direction control
const int motorIN2 = 8;    // Direction control

void setup() {
  pinMode(motorPWM, OUTPUT);
  pinMode(motorIN1, OUTPUT);
  pinMode(motorIN2, OUTPUT);
}

void setMotorSpeed(int speed) {
  // speed: -255 (full reverse) to +255 (full forward)

  if (speed &gt; 0) {
    // Forward
    digitalWrite(motorIN1, HIGH);
    digitalWrite(motorIN2, LOW);
    analogWrite(motorPWM, speed);
  } else if (speed &lt; 0) {
    // Reverse
    digitalWrite(motorIN1, LOW);
    digitalWrite(motorIN2, HIGH);
    analogWrite(motorPWM, -speed);
  } else {
    // Stop
    digitalWrite(motorIN1, LOW);
    digitalWrite(motorIN2, LOW);
    analogWrite(motorPWM, 0);
  }
}

void loop() {
  setMotorSpeed(128);    // 50% forward
  delay(2000);
  setMotorSpeed(255);    // 100% forward
  delay(2000);
  setMotorSpeed(0);      // Stop
  delay(1000);
  setMotorSpeed(-128);   // 50% reverse
  delay(2000);
}
</code></pre>
<h2 id="common-applications"><a class="header" href="#common-applications">Common Applications</a></h2>
<h3 id="1-led-dimming"><a class="header" href="#1-led-dimming">1. LED Dimming</a></h3>
<pre><code class="language-cpp">// Smooth breathing effect
void breathingLED(int pin) {
  const int maxBrightness = 255;
  const int minBrightness = 0;
  const int step = 5;
  const int delayTime = 30;

  // Breathe in
  for (int brightness = minBrightness; brightness &lt;= maxBrightness; brightness += step) {
    analogWrite(pin, brightness);
    delay(delayTime);
  }

  // Breathe out
  for (int brightness = maxBrightness; brightness &gt;= minBrightness; brightness -= step) {
    analogWrite(pin, brightness);
    delay(delayTime);
  }
}
</code></pre>
<h3 id="2-rgb-color-mixing"><a class="header" href="#2-rgb-color-mixing">2. RGB Color Mixing</a></h3>
<pre><code class="language-cpp">void setColorHSV(float h, float s, float v) {
  // Convert HSV to RGB
  float c = v * s;
  float x = c * (1 - abs(fmod(h / 60.0, 2) - 1));
  float m = v - c;

  float r, g, b;
  if (h &lt; 60) { r = c; g = x; b = 0; }
  else if (h &lt; 120) { r = x; g = c; b = 0; }
  else if (h &lt; 180) { r = 0; g = c; b = x; }
  else if (h &lt; 240) { r = 0; g = x; b = c; }
  else if (h &lt; 300) { r = x; g = 0; b = c; }
  else { r = c; g = 0; b = x; }

  analogWrite(redPin, (r + m) * 255);
  analogWrite(greenPin, (g + m) * 255);
  analogWrite(bluePin, (b + m) * 255);
}

// Rainbow effect
void rainbow() {
  for (int hue = 0; hue &lt; 360; hue++) {
    setColorHSV(hue, 1.0, 1.0);
    delay(10);
  }
}
</code></pre>
<h3 id="3-speakerbuzzer-tone-generation"><a class="header" href="#3-speakerbuzzer-tone-generation">3. Speaker/Buzzer Tone Generation</a></h3>
<pre><code class="language-cpp">void playTone(int pin, int frequency, int duration) {
  int period = 1000000 / frequency;  // Period in microseconds
  int halfPeriod = period / 2;

  long cycles = ((long)frequency * duration) / 1000;

  for (long i = 0; i &lt; cycles; i++) {
    digitalWrite(pin, HIGH);
    delayMicroseconds(halfPeriod);
    digitalWrite(pin, LOW);
    delayMicroseconds(halfPeriod);
  }
}

void playMelody() {
  playTone(buzzerPin, 262, 500);  // C4
  playTone(buzzerPin, 294, 500);  // D4
  playTone(buzzerPin, 330, 500);  // E4
  playTone(buzzerPin, 349, 500);  // F4
}

// Using tone() function (easier)
void playNote(int frequency) {
  tone(buzzerPin, frequency);
  delay(500);
  noTone(buzzerPin);
}
</code></pre>
<h3 id="4-fan-speed-control"><a class="header" href="#4-fan-speed-control">4. Fan Speed Control</a></h3>
<pre><code class="language-cpp">int targetTemp = 25;    // Target temperature
int currentTemp = 30;   // Read from sensor

void controlFan() {
  int tempDiff = currentTemp - targetTemp;

  int fanSpeed;
  if (tempDiff &lt;= 0) {
    fanSpeed = 0;  // Too cold, fan off
  } else if (tempDiff &gt;= 10) {
    fanSpeed = 255;  // Very hot, max speed
  } else {
    // Proportional control
    fanSpeed = map(tempDiff, 0, 10, 50, 255);
  }

  analogWrite(fanPin, fanSpeed);
}
</code></pre>
<h3 id="5-power-supply-buck-converter"><a class="header" href="#5-power-supply-buck-converter">5. Power Supply (Buck Converter)</a></h3>
<p>PWM is used in switching power supplies to efficiently convert voltage:</p>
<ul>
<li>High frequency (20-100 kHz) minimizes inductor size</li>
<li>Duty cycle controls output voltage</li>
<li>Feedback loop maintains regulation</li>
</ul>
<h2 id="best-practices-64"><a class="header" href="#best-practices-64">Best Practices</a></h2>
<h3 id="1-choose-appropriate-frequency"><a class="header" href="#1-choose-appropriate-frequency">1. Choose Appropriate Frequency</a></h3>
<pre><code class="language-cpp">// LED dimming: Use higher frequency to avoid flicker
// Human eye perceives flicker below ~60 Hz
setPWMFrequency(ledPin, 1);  // 31 kHz - no visible flicker

// Motor control: Balance between smoothness and efficiency
// Too high: Increased switching losses
// Too low: Audible noise, torque ripple
// Optimal: 10-25 kHz

// Audio: Must be above hearing range
// Humans hear up to ~20 kHz
// Use 40+ kHz for audio PWM
</code></pre>
<h3 id="2-filter-pwm-for-analog-output"><a class="header" href="#2-filter-pwm-for-analog-output">2. Filter PWM for Analog Output</a></h3>
<pre><code>PWM Pin ─── R ───┬─── Analog Output
                 │
                 C
                 │
                GND

Cutoff Frequency = 1 / (2π × R × C)

Example: R=1kΩ, C=10μF
fc = 1 / (2π × 1000 × 0.00001) ≈ 16 Hz
</code></pre>
<h3 id="3-protect-inductive-loads"><a class="header" href="#3-protect-inductive-loads">3. Protect Inductive Loads</a></h3>
<pre><code class="language-cpp">// Motors and solenoids are inductive
// Add flyback diode across load!

//        Motor
//    ┌────┴────┐
// PWM│         │GND
//    │   ▼─    │
//    └─────────┘
//    Flyback Diode
</code></pre>
<h3 id="4-avoid-pwm-on-critical-pins"><a class="header" href="#4-avoid-pwm-on-critical-pins">4. Avoid PWM on Critical Pins</a></h3>
<pre><code class="language-cpp">// Some Arduino pins share timers
// Changing frequency on one affects others!

// Pins 5 &amp; 6 share Timer 0 (also used by millis/delay!)
// Pins 9 &amp; 10 share Timer 1
// Pins 3 &amp; 11 share Timer 2

// Changing Timer 0 frequency breaks millis() and delay()!
</code></pre>
<h2 id="common-issues-and-debugging-2"><a class="header" href="#common-issues-and-debugging-2">Common Issues and Debugging</a></h2>
<h3 id="problem-led-flickering"><a class="header" href="#problem-led-flickering">Problem: LED Flickering</a></h3>
<p><strong>Causes</strong>: PWM frequency too low
<strong>Solution</strong>: Increase frequency above 60 Hz (ideally 500 Hz+)</p>
<h3 id="problem-motor-whiningbuzzing"><a class="header" href="#problem-motor-whiningbuzzing">Problem: Motor Whining/Buzzing</a></h3>
<p><strong>Causes</strong>: PWM frequency in audible range
<strong>Solution</strong>: Increase frequency to 20+ kHz</p>
<h3 id="problem-servo-jittering"><a class="header" href="#problem-servo-jittering">Problem: Servo Jittering</a></h3>
<p><strong>Causes</strong>: Incorrect pulse width or timing
<strong>Solution</strong>: Use dedicated Servo library, ensure 50 Hz signal</p>
<h3 id="problem-pwm-not-working-after-changing-frequency"><a class="header" href="#problem-pwm-not-working-after-changing-frequency">Problem: PWM Not Working After Changing Frequency</a></h3>
<p><strong>Causes</strong>: Modified Timer 0 which breaks delay() and millis()
<strong>Solution</strong>: Use different timer, or use external library</p>
<h2 id="eli10-explain-like-im-10-2"><a class="header" href="#eli10-explain-like-im-10-2">ELI10 (Explain Like I'm 10)</a></h2>
<p>Imagine you have a light switch that you can flick on and off really, really fast - so fast that your eyes can't see it blinking!</p>
<p><strong>PWM is like that super-fast blinking:</strong></p>
<ul>
<li>If the light is ON for half the time and OFF for half the time, it looks 50% bright</li>
<li>If it's ON for most of the time and OFF for a tiny bit, it looks almost fully bright</li>
<li>If it's ON for only a tiny bit and OFF most of the time, it looks dim</li>
</ul>
<p><strong>This works because</strong>:</p>
<ul>
<li>Your eyes can't see things blinking faster than about 60 times per second</li>
<li>So when we blink the light 500 or 1000 times per second, your brain sees a steady dimmed light!</li>
</ul>
<p><strong>The cool part?</strong></p>
<ul>
<li>We're not actually reducing the voltage (which wastes energy as heat)</li>
<li>We're just turning it on and off really fast (very efficient!)</li>
<li>It's like running at full speed for short bursts vs. walking slowly all the time</li>
</ul>
<p><strong>Duty cycle</strong> is the percentage of time it's ON:</p>
<ul>
<li>100% = always on (full brightness)</li>
<li>50% = on half the time (half brightness)</li>
<li>0% = always off (no light)</li>
</ul>
<p>We use this same trick for controlling motor speeds, speakers, and lots of other things!</p>
<h2 id="further-resources-18"><a class="header" href="#further-resources-18">Further Resources</a></h2>
<ul>
<li><a href="https://docs.arduino.cc/learn/microcontrollers/analog-output">Arduino PWM Guide</a></li>
<li><a href="https://www.arduino.cc/en/Tutorial/SecretsOfArduinoPWM">Secrets of Arduino PWM</a></li>
<li><a href="https://docs.espressif.com/projects/esp-idf/en/latest/esp32/api-reference/peripherals/ledc.html">ESP32 LEDC Documentation</a></li>
<li><a href="https://en.wikipedia.org/wiki/Pulse-width_modulation">PWM Wikipedia</a></li>
<li><a href="https://www.ti.com/lit/an/slva505/slva505.pdf">Motor Control with PWM</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="adc-analog-to-digital-converter-1"><a class="header" href="#adc-analog-to-digital-converter-1">ADC (Analog-to-Digital Converter)</a></h1>
<h2 id="overview-68"><a class="header" href="#overview-68">Overview</a></h2>
<p>An Analog-to-Digital Converter (ADC) is a hardware component that converts continuous analog signals (like voltage, temperature, light intensity) into discrete digital values that a microcontroller can process. ADCs are essential for interfacing with the real world, enabling microcontrollers to read sensors and analog inputs.</p>
<h2 id="key-concepts-24"><a class="header" href="#key-concepts-24">Key Concepts</a></h2>
<h3 id="what-is-an-analog-signal"><a class="header" href="#what-is-an-analog-signal">What is an Analog Signal?</a></h3>
<p>An analog signal is a continuous signal that can have any value within a range. Examples:</p>
<ul>
<li>Temperature: 0C to 100C</li>
<li>Light intensity: 0 to maximum brightness</li>
<li>Audio: continuous sound waves</li>
<li>Voltage: 0V to 5V</li>
</ul>
<h3 id="what-is-a-digital-value"><a class="header" href="#what-is-a-digital-value">What is a Digital Value?</a></h3>
<p>A digital value is a discrete number that represents the analog signal:</p>
<ul>
<li>8-bit ADC: 0 to 255 (256 possible values)</li>
<li>10-bit ADC: 0 to 1023 (1024 possible values)</li>
<li>12-bit ADC: 0 to 4095 (4096 possible values)</li>
</ul>
<h3 id="resolution-2"><a class="header" href="#resolution-2">Resolution</a></h3>
<p>Resolution determines how finely an ADC can distinguish between different analog values.</p>
<p><strong>Formula</strong>:</p>
<pre><code>Resolution = Reference Voltage / (2^n - 1)

Where n = number of bits
</code></pre>
<p><strong>Examples</strong>:</p>
<div class="table-wrapper"><table><thead><tr><th>Bits</th><th>Levels</th><th>Resolution (5V ref)</th><th>Resolution (3.3V ref)</th></tr></thead><tbody>
<tr><td>8-bit</td><td>256</td><td>19.6 mV</td><td>12.9 mV</td></tr>
<tr><td>10-bit</td><td>1024</td><td>4.88 mV</td><td>3.22 mV</td></tr>
<tr><td>12-bit</td><td>4096</td><td>1.22 mV</td><td>0.81 mV</td></tr>
<tr><td>16-bit</td><td>65536</td><td>76.3 uV</td><td>50.4 uV</td></tr>
</tbody></table>
</div>
<p><strong>What this means</strong>: A 10-bit ADC with 5V reference can distinguish voltage differences as small as ~4.88mV.</p>
<h3 id="reference-voltage-vref"><a class="header" href="#reference-voltage-vref">Reference Voltage (VREF)</a></h3>
<p>The reference voltage defines the maximum input voltage the ADC can measure.</p>
<ul>
<li><strong>Arduino Uno</strong>: 5V (can use external ref)</li>
<li><strong>ESP32</strong>: 3.3V (default), 1.1V (attenuated)</li>
<li><strong>STM32</strong>: 3.3V (typically)</li>
</ul>
<p><strong>Important</strong>: Never exceed VREF on analog input pins!</p>
<h3 id="sampling-rate"><a class="header" href="#sampling-rate">Sampling Rate</a></h3>
<p>How many times per second the ADC can take a measurement, measured in:</p>
<ul>
<li><strong>SPS</strong>: Samples Per Second</li>
<li><strong>kSPS</strong>: Thousand samples per second</li>
<li><strong>MSPS</strong>: Million samples per second</li>
</ul>
<p><strong>Examples</strong>:</p>
<ul>
<li>Arduino Uno: ~10 kSPS</li>
<li>ESP32: ~100 kSPS</li>
<li>STM32F4: Up to 2.4 MSPS</li>
<li>External ADC (ADS1115): 860 SPS max</li>
</ul>
<h2 id="how-it-works-4"><a class="header" href="#how-it-works-4">How It Works</a></h2>
<h3 id="conversion-process"><a class="header" href="#conversion-process">Conversion Process</a></h3>
<ol>
<li><strong>Sample</strong>: Capture the analog voltage at a specific moment</li>
<li><strong>Hold</strong>: Maintain that voltage level during conversion</li>
<li><strong>Quantize</strong>: Divide the voltage range into discrete levels</li>
<li><strong>Encode</strong>: Convert to a binary number</li>
</ol>
<pre><code>Analog Input (2.5V) -&gt; ADC -&gt; Digital Output (512 for 10-bit at 5V ref)

Calculation: 2.5V / 5V * 1023 = 511.5 ~ 512
</code></pre>
<h3 id="conversion-formula"><a class="header" href="#conversion-formula">Conversion Formula</a></h3>
<pre><code>Digital Value = (Analog Voltage / Reference Voltage) * (2^n - 1)

Analog Voltage = (Digital Value / (2^n - 1)) * Reference Voltage
</code></pre>
<h2 id="code-examples-5"><a class="header" href="#code-examples-5">Code Examples</a></h2>
<h3 id="arduino-avr-adc"><a class="header" href="#arduino-avr-adc">Arduino (AVR) ADC</a></h3>
<pre><code class="language-cpp">// Simple analog read
const int sensorPin = A0;

void setup() {
  Serial.begin(9600);

  // Optional: Set analog reference
  // analogReference(DEFAULT);  // 5V on Uno
  // analogReference(INTERNAL); // 1.1V internal reference
  // analogReference(EXTERNAL); // External AREF pin
}

void loop() {
  // Read analog value (0-1023)
  int rawValue = analogRead(sensorPin);

  // Convert to voltage
  float voltage = rawValue * (5.0 / 1023.0);

  Serial.print("Raw: ");
  Serial.print(rawValue);
  Serial.print(" | Voltage: ");
  Serial.print(voltage);
  Serial.println(" V");

  delay(500);
}

// Reading multiple analog pins
void readMultipleSensors() {
  int sensors[] = {A0, A1, A2, A3};

  for (int i = 0; i &lt; 4; i++) {
    int value = analogRead(sensors[i]);
    float voltage = value * (5.0 / 1023.0);
    Serial.print("Sensor ");
    Serial.print(i);
    Serial.print(": ");
    Serial.println(voltage);
  }
}
</code></pre>
<h3 id="esp32-adc"><a class="header" href="#esp32-adc">ESP32 ADC</a></h3>
<pre><code class="language-cpp">// ESP32 has two ADC units with multiple channels
const int analogPin = 34;  // ADC1_CH6 (GPIO 34)

void setup() {
  Serial.begin(115200);

  // Set ADC resolution (9-12 bits)
  analogReadResolution(12);  // Default is 12 bits (0-4095)

  // Set ADC attenuation (changes measurement range)
  // ADC_0db: 0-1.1V
  // ADC_2_5db: 0-1.5V
  // ADC_6db: 0-2.2V (default)
  // ADC_11db: 0-3.3V
  analogSetAttenuation(ADC_11db);

  // Or set per pin
  analogSetPinAttenuation(analogPin, ADC_11db);
}

void loop() {
  int rawValue = analogRead(analogPin);

  // Convert to voltage (with 11db attenuation, 0-3.3V range)
  // Note: ESP32 ADC is non-linear, consider calibration
  float voltage = rawValue * (3.3 / 4095.0);

  Serial.print("Raw: ");
  Serial.print(rawValue);
  Serial.print(" | Voltage: ");
  Serial.println(voltage);

  delay(100);
}

// Better: Use calibrated read
#include "esp_adc_cal.h"

esp_adc_cal_characteristics_t adc_chars;

void setupCalibrated() {
  esp_adc_cal_characterize(ADC_UNIT_1, ADC_ATTEN_DB_11,
                           ADC_WIDTH_BIT_12, 1100, &amp;adc_chars);
}

void loopCalibrated() {
  uint32_t voltage = analogRead(analogPin);
  voltage = esp_adc_cal_raw_to_voltage(voltage, &amp;adc_chars);

  Serial.print("Calibrated voltage: ");
  Serial.print(voltage);
  Serial.println(" mV");
}
</code></pre>
<h3 id="stm32-hal-adc"><a class="header" href="#stm32-hal-adc">STM32 HAL ADC</a></h3>
<pre><code class="language-c">#include "stm32f4xx_hal.h"

ADC_HandleTypeDef hadc1;

void ADC_Init(void) {
    ADC_ChannelConfTypeDef sConfig = {0};

    // Configure ADC
    hadc1.Instance = ADC1;
    hadc1.Init.ClockPrescaler = ADC_CLOCK_SYNC_PCLK_DIV4;
    hadc1.Init.Resolution = ADC_RESOLUTION_12B;
    hadc1.Init.ScanConvMode = DISABLE;
    hadc1.Init.ContinuousConvMode = DISABLE;
    hadc1.Init.DiscontinuousConvMode = DISABLE;
    hadc1.Init.ExternalTrigConv = ADC_SOFTWARE_START;
    hadc1.Init.DataAlign = ADC_DATAALIGN_RIGHT;
    hadc1.Init.NbrOfConversion = 1;
    HAL_ADC_Init(&amp;hadc1);

    // Configure channel
    sConfig.Channel = ADC_CHANNEL_0;
    sConfig.Rank = 1;
    sConfig.SamplingTime = ADC_SAMPLETIME_84CYCLES;
    HAL_ADC_ConfigChannel(&amp;hadc1, &amp;sConfig);
}

uint16_t ADC_Read(uint32_t channel) {
    ADC_ChannelConfTypeDef sConfig = {0};

    sConfig.Channel = channel;
    sConfig.Rank = 1;
    HAL_ADC_ConfigChannel(&amp;hadc1, &amp;sConfig);

    // Start conversion
    HAL_ADC_Start(&amp;hadc1);

    // Wait for conversion to complete
    HAL_ADC_PollForConversion(&amp;hadc1, 100);

    // Read value
    uint16_t value = HAL_ADC_GetValue(&amp;hadc1);

    return value;
}

float ADC_ReadVoltage(uint32_t channel) {
    uint16_t raw = ADC_Read(channel);
    // Convert to voltage (assuming 3.3V reference)
    float voltage = (raw * 3.3f) / 4095.0f;
    return voltage;
}

// DMA-based continuous conversion
uint16_t adc_buffer[16];

void ADC_Start_DMA(void) {
    HAL_ADC_Start_DMA(&amp;hadc1, (uint32_t*)adc_buffer, 16);
}
</code></pre>
<h3 id="external-adc-ads1115-via-i2c"><a class="header" href="#external-adc-ads1115-via-i2c">External ADC (ADS1115) via I2C</a></h3>
<pre><code class="language-cpp">#include &lt;Wire.h&gt;
#include &lt;Adafruit_ADS1X15.h&gt;

Adafruit_ADS1115 ads;  // 16-bit ADC

void setup() {
  Serial.begin(115200);

  // Initialize ADS1115
  if (!ads.begin()) {
    Serial.println("Failed to initialize ADS1115!");
    while (1);
  }

  // Set gain
  // ads.setGain(GAIN_TWOTHIRDS);  // +/-6.144V range
  // ads.setGain(GAIN_ONE);        // +/-4.096V range
  ads.setGain(GAIN_TWO);           // +/-2.048V range (default)
  // ads.setGain(GAIN_FOUR);       // +/-1.024V range
  // ads.setGain(GAIN_EIGHT);      // +/-0.512V range
  // ads.setGain(GAIN_SIXTEEN);    // +/-0.256V range
}

void loop() {
  // Read single-ended from channel 0
  int16_t adc0 = ads.readADC_SingleEnded(0);
  float voltage0 = ads.computeVolts(adc0);

  // Read differential (channel 0 - channel 1)
  int16_t diff01 = ads.readADC_Differential_0_1();

  Serial.print("ADC0: ");
  Serial.print(adc0);
  Serial.print(" | Voltage: ");
  Serial.println(voltage0);

  delay(100);
}
</code></pre>
<h2 id="common-applications-1"><a class="header" href="#common-applications-1">Common Applications</a></h2>
<h3 id="1-temperature-sensors-thermistor"><a class="header" href="#1-temperature-sensors-thermistor">1. Temperature Sensors (Thermistor)</a></h3>
<pre><code class="language-cpp">const int thermistorPin = A0;
const float BETA = 3950;  // Beta coefficient
const float R0 = 10000;   // Resistance at 25C
const float T0 = 298.15;  // 25C in Kelvin

float readTemperature() {
  int raw = analogRead(thermistorPin);

  // Convert to resistance
  float R = 10000.0 * (1023.0 / raw - 1.0);

  // Steinhart-Hart equation
  float T = 1.0 / (1.0/T0 + (1.0/BETA) * log(R/R0));

  return T - 273.15;  // Convert to Celsius
}
</code></pre>
<h3 id="2-light-sensor-ldrphotoresistor"><a class="header" href="#2-light-sensor-ldrphotoresistor">2. Light Sensor (LDR/Photoresistor)</a></h3>
<pre><code class="language-cpp">const int ldrPin = A1;

int readLightLevel() {
  int rawValue = analogRead(ldrPin);

  // Convert to percentage
  int lightPercent = map(rawValue, 0, 1023, 0, 100);

  return lightPercent;
}
</code></pre>
<h3 id="3-potentiometer-volume-control"><a class="header" href="#3-potentiometer-volume-control">3. Potentiometer (Volume Control)</a></h3>
<pre><code class="language-cpp">const int potPin = A2;
const int ledPin = 9;  // PWM pin

void setup() {
  pinMode(ledPin, OUTPUT);
}

void loop() {
  int potValue = analogRead(potPin);

  // Map to PWM range (0-255)
  int brightness = map(potValue, 0, 1023, 0, 255);

  analogWrite(ledPin, brightness);
}
</code></pre>
<h3 id="4-battery-voltage-monitoring"><a class="header" href="#4-battery-voltage-monitoring">4. Battery Voltage Monitoring</a></h3>
<pre><code class="language-cpp">const int batteryPin = A3;
const float voltageDividerRatio = 2.0;  // R1=R2=10k

float readBatteryVoltage() {
  int raw = analogRead(batteryPin);

  // Convert to actual voltage
  float adcVoltage = raw * (5.0 / 1023.0);

  // Account for voltage divider
  float batteryVoltage = adcVoltage * voltageDividerRatio;

  return batteryVoltage;
}

void checkBattery() {
  float voltage = readBatteryVoltage();

  if (voltage &lt; 3.3) {
    Serial.println("WARNING: Low battery!");
  }
}
</code></pre>
<h3 id="5-current-sensing-acs712"><a class="header" href="#5-current-sensing-acs712">5. Current Sensing (ACS712)</a></h3>
<pre><code class="language-cpp">const int currentSensorPin = A4;
const float sensitivity = 0.185;  // 185mV/A for ACS712-05B

float readCurrent() {
  int raw = analogRead(currentSensorPin);
  float voltage = raw * (5.0 / 1023.0);

  // Zero point is 2.5V (Vcc/2)
  float offsetVoltage = voltage - 2.5;

  // Calculate current
  float current = offsetVoltage / sensitivity;

  return current;
}
</code></pre>
<h2 id="best-practices-65"><a class="header" href="#best-practices-65">Best Practices</a></h2>
<h3 id="1-averaging-for-stability"><a class="header" href="#1-averaging-for-stability">1. Averaging for Stability</a></h3>
<pre><code class="language-cpp">float readAverageAnalog(int pin, int samples = 10) {
  long sum = 0;

  for (int i = 0; i &lt; samples; i++) {
    sum += analogRead(pin);
    delay(10);  // Small delay between reads
  }

  return (float)sum / samples;
}
</code></pre>
<h3 id="2-handling-noise"><a class="header" href="#2-handling-noise">2. Handling Noise</a></h3>
<pre><code class="language-cpp">// Software low-pass filter (running average)
const int numReadings = 10;
int readings[numReadings];
int readIndex = 0;
int total = 0;

int smoothedRead(int pin) {
  total -= readings[readIndex];
  readings[readIndex] = analogRead(pin);
  total += readings[readIndex];
  readIndex = (readIndex + 1) % numReadings;

  return total / numReadings;
}
</code></pre>
<h3 id="3-proper-voltage-divider"><a class="header" href="#3-proper-voltage-divider">3. Proper Voltage Divider</a></h3>
<pre><code class="language-cpp">// To measure higher voltages, use voltage divider
// Vin     R1  ,    R2     GND
//
//          ADC Pin

// Example: Measure 12V with 5V ADC
// R1 = 10k ohm, R2 = 7.5k ohm
// Vout = Vin * (R2 / (R1 + R2))
// Vout = 12V * (7.5 / 17.5) = 5.14V (slightly over, use 6.8k ohm for R2)
</code></pre>
<h3 id="4-calibration"><a class="header" href="#4-calibration">4. Calibration</a></h3>
<pre><code class="language-cpp">struct CalibrationData {
  float slope;
  float offset;
};

CalibrationData calibrate(int pin, float knownVoltage) {
  int rawValue = analogRead(pin);

  CalibrationData cal;
  cal.slope = knownVoltage / rawValue;
  cal.offset = 0;  // Adjust if needed

  return cal;
}

float calibratedRead(int pin, CalibrationData cal) {
  int raw = analogRead(pin);
  return (raw * cal.slope) + cal.offset;
}
</code></pre>
<h2 id="common-issues-and-debugging-3"><a class="header" href="#common-issues-and-debugging-3">Common Issues and Debugging</a></h2>
<h3 id="problem-noisy-readings"><a class="header" href="#problem-noisy-readings">Problem: Noisy Readings</a></h3>
<p><strong>Solutions</strong>:</p>
<ul>
<li>Add 0.1uF capacitor between analog pin and ground</li>
<li>Use averaging/filtering in software</li>
<li>Keep analog wires short and away from digital signals</li>
<li>Use twisted pair cables for long runs</li>
<li>Add ferrite beads on long cables</li>
</ul>
<h3 id="problem-incorrect-voltage-readings"><a class="header" href="#problem-incorrect-voltage-readings">Problem: Incorrect Voltage Readings</a></h3>
<p><strong>Check</strong>:</p>
<ul>
<li>Verify reference voltage is correct</li>
<li>Check voltage divider calculations</li>
<li>Ensure input doesn't exceed VREF</li>
<li>Verify ground connection</li>
</ul>
<h3 id="problem-slow-response"><a class="header" href="#problem-slow-response">Problem: Slow Response</a></h3>
<p><strong>Solutions</strong>:</p>
<ul>
<li>Reduce averaging samples</li>
<li>Check ADC clock/prescaler settings</li>
<li>Use faster ADC if needed (external)</li>
<li>Enable DMA for continuous sampling</li>
</ul>
<h2 id="eli10-explain-like-im-10-3"><a class="header" href="#eli10-explain-like-im-10-3">ELI10 (Explain Like I'm 10)</a></h2>
<p>Imagine you have a thermometer that shows any temperature between 0C and 100C, but you can only report whole numbers:</p>
<ul>
<li>If the real temperature is 23.7C, you might say "24C"</li>
<li>If it's 23.2C, you might say "23C"</li>
</ul>
<p>An ADC does the same thing! It takes a smooth, continuous voltage (like the temperature) and converts it to a number your microcontroller can understand.</p>
<p><strong>Resolution</strong> is like how many different numbers you can say:</p>
<ul>
<li>8-bit ADC: Can say 256 different numbers (0-255)</li>
<li>10-bit ADC: Can say 1024 different numbers (0-1023)</li>
<li>12-bit ADC: Can say 4096 different numbers (0-4095)</li>
</ul>
<p>More bits = more precise measurements = seeing smaller differences!</p>
<h2 id="further-resources-19"><a class="header" href="#further-resources-19">Further Resources</a></h2>
<ul>
<li><a href="https://learn.sparkfun.com/tutorials/analog-to-digital-conversion">ADC Tutorial - SparkFun</a></li>
<li><a href="https://www.arduino.cc/reference/en/language/functions/analog-io/analogread/">Arduino analogRead() Reference</a></li>
<li><a href="https://docs.espressif.com/projects/esp-idf/en/latest/esp32/api-reference/peripherals/adc.html">ESP32 ADC Documentation</a></li>
<li><a href="https://www.microchip.com/en-us/application-notes/an2538">ADC Noise Reduction Techniques - AVR</a></li>
<li><a href="https://www.ti.com/lit/an/slaa013/slaa013.pdf">Understanding ADC Parameters</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="dac-digital-to-analog-converter"><a class="header" href="#dac-digital-to-analog-converter">DAC (Digital-to-Analog Converter)</a></h1>
<h2 id="overview-69"><a class="header" href="#overview-69">Overview</a></h2>
<p>A Digital-to-Analog Converter (DAC) does the opposite of an ADC - it converts discrete digital values from a microcontroller into continuous analog voltage signals. DACs are essential for generating analog outputs like audio signals, control voltages, and waveforms.</p>
<h2 id="key-concepts-25"><a class="header" href="#key-concepts-25">Key Concepts</a></h2>
<h3 id="what-does-a-dac-do"><a class="header" href="#what-does-a-dac-do">What Does a DAC Do?</a></h3>
<p>A DAC takes a digital number and outputs a corresponding analog voltage:</p>
<pre><code>Digital Input (512) -&gt; DAC -&gt; Analog Output (2.5V)

For 10-bit DAC with 5V reference:
Voltage = (512 / 1023) * 5V = 2.5V
</code></pre>
<h3 id="resolution-3"><a class="header" href="#resolution-3">Resolution</a></h3>
<p>Just like ADCs, DAC resolution determines output precision:</p>
<div class="table-wrapper"><table><thead><tr><th>Bits</th><th>Levels</th><th>Voltage Step (5V)</th><th>Voltage Step (3.3V)</th></tr></thead><tbody>
<tr><td>8-bit</td><td>256</td><td>19.6 mV</td><td>12.9 mV</td></tr>
<tr><td>10-bit</td><td>1024</td><td>4.88 mV</td><td>3.22 mV</td></tr>
<tr><td>12-bit</td><td>4096</td><td>1.22 mV</td><td>0.81 mV</td></tr>
<tr><td>16-bit</td><td>65536</td><td>76.3 uV</td><td>50.4 uV</td></tr>
</tbody></table>
</div>
<h3 id="dac-vs-pwm"><a class="header" href="#dac-vs-pwm">DAC vs PWM</a></h3>
<p>Many microcontrollers don't have true DAC outputs, but can simulate analog using PWM:</p>
<div class="table-wrapper"><table><thead><tr><th>Feature</th><th>True DAC</th><th>PWM</th></tr></thead><tbody>
<tr><td><strong>Output</strong></td><td>True analog voltage</td><td>Digital pulses</td></tr>
<tr><td><strong>Smoothness</strong></td><td>Smooth DC voltage</td><td>Requires filtering</td></tr>
<tr><td><strong>Speed</strong></td><td>Fast settling</td><td>Limited by PWM frequency</td></tr>
<tr><td><strong>Filtering</strong></td><td>Not needed</td><td>Low-pass filter needed</td></tr>
<tr><td><strong>Complexity</strong></td><td>Hardware DAC required</td><td>Any digital pin</td></tr>
<tr><td><strong>Use Cases</strong></td><td>Audio, precise control</td><td>LED dimming, motor speed</td></tr>
</tbody></table>
</div>
<h2 id="how-it-works-5"><a class="header" href="#how-it-works-5">How It Works</a></h2>
<h3 id="conversion-formula-1"><a class="header" href="#conversion-formula-1">Conversion Formula</a></h3>
<pre><code>Output Voltage = (Digital Value / (2^n - 1)) * Reference Voltage

Where:
- n = number of bits
- Digital Value = input code (0 to 2^n - 1)
- Reference Voltage = max output voltage
</code></pre>
<h3 id="common-dac-architectures"><a class="header" href="#common-dac-architectures">Common DAC Architectures</a></h3>
<ol>
<li><strong>R-2R Ladder</strong>: Uses resistor network (simple, cheap)</li>
<li><strong>Binary Weighted</strong>: Uses weighted current sources</li>
<li><strong>Delta-Sigma</strong>: High resolution, used in audio</li>
<li><strong>String</strong>: Resistor divider network</li>
</ol>
<h2 id="code-examples-6"><a class="header" href="#code-examples-6">Code Examples</a></h2>
<h3 id="arduino-due-built-in-12-bit-dac"><a class="header" href="#arduino-due-built-in-12-bit-dac">Arduino Due (Built-in 12-bit DAC)</a></h3>
<pre><code class="language-cpp">// Arduino Due has two DAC pins: DAC0 and DAC1

void setup() {
  analogWriteResolution(12);  // Set DAC resolution to 12 bits (0-4095)
}

void loop() {
  // Output 1.65V on DAC0 (half of 3.3V reference)
  analogWrite(DAC0, 2048);  // 2048 / 4095 * 3.3V = 1.65V

  delay(1000);

  // Ramp voltage from 0V to 3.3V
  for (int value = 0; value &lt; 4096; value++) {
    analogWrite(DAC0, value);
    delayMicroseconds(100);
  }
}

// Generate sine wave
void generateSineWave() {
  const int samples = 100;
  float frequency = 1000;  // 1 kHz

  for (int i = 0; i &lt; samples; i++) {
    float angle = (2.0 * PI * i) / samples;
    int value = (sin(angle) + 1.0) * 2047.5;  // Scale to 0-4095
    analogWrite(DAC0, value);

    delayMicroseconds(1000000 / (frequency * samples));
  }
}
</code></pre>
<h3 id="esp32-built-in-8-bit-dac"><a class="header" href="#esp32-built-in-8-bit-dac">ESP32 (Built-in 8-bit DAC)</a></h3>
<pre><code class="language-cpp">// ESP32 has two DAC channels: GPIO25 (DAC1) and GPIO26 (DAC2)

void setup() {
  // No special initialization needed for DAC
}

void loop() {
  // Output voltage (0-255 for 8-bit)
  // 0 = 0V, 255 = 3.3V
  dacWrite(25, 128);  // Output ~1.65V on GPIO25

  delay(1000);
}

// Generate sawtooth wave
void generateSawtoothWave() {
  for (int value = 0; value &lt; 256; value++) {
    dacWrite(25, value);
    delayMicroseconds(10);
  }
}

// Generate triangle wave
void generateTriangleWave() {
  // Rising edge
  for (int value = 0; value &lt; 256; value++) {
    dacWrite(25, value);
    delayMicroseconds(10);
  }

  // Falling edge
  for (int value = 255; value &gt;= 0; value--) {
    dacWrite(25, value);
    delayMicroseconds(10);
  }
}

// Generate square wave
void generateSquareWave() {
  dacWrite(25, 255);  // HIGH
  delay(1);
  dacWrite(25, 0);    // LOW
  delay(1);
}

// Audio tone generation
void playTone(int frequency, int duration) {
  const int samples = 32;
  byte sineWave[samples];

  // Pre-calculate sine wave
  for (int i = 0; i &lt; samples; i++) {
    sineWave[i] = (sin(2.0 * PI * i / samples) + 1.0) * 127.5;
  }

  unsigned long startTime = millis();
  int sampleDelay = 1000000 / (frequency * samples);

  while (millis() - startTime &lt; duration) {
    for (int i = 0; i &lt; samples; i++) {
      dacWrite(25, sineWave[i]);
      delayMicroseconds(sampleDelay);
    }
  }
}
</code></pre>
<h3 id="stm32-hal-dac"><a class="header" href="#stm32-hal-dac">STM32 HAL DAC</a></h3>
<pre><code class="language-c">#include "stm32f4xx_hal.h"

DAC_HandleTypeDef hdac;

void DAC_Init(void) {
    DAC_ChannelConfTypeDef sConfig = {0};

    // Initialize DAC
    hdac.Instance = DAC;
    HAL_DAC_Init(&amp;hdac);

    // Configure DAC channel 1
    sConfig.DAC_Trigger = DAC_TRIGGER_NONE;
    sConfig.DAC_OutputBuffer = DAC_OUTPUTBUFFER_ENABLE;
    HAL_DAC_ConfigChannel(&amp;hdac, &amp;sConfig, DAC_CHANNEL_1);

    // Start DAC
    HAL_DAC_Start(&amp;hdac, DAC_CHANNEL_1);
}

void DAC_SetVoltage(float voltage) {
    // Convert voltage to 12-bit value
    // Assuming 3.3V reference
    uint32_t value = (uint32_t)((voltage / 3.3f) * 4095.0f);

    if (value &gt; 4095) value = 4095;

    HAL_DAC_SetValue(&amp;hdac, DAC_CHANNEL_1, DAC_ALIGN_12B_R, value);
}

void DAC_SetValue(uint16_t value) {
    HAL_DAC_SetValue(&amp;hdac, DAC_CHANNEL_1, DAC_ALIGN_12B_R, value);
}

// DMA-based waveform generation
uint16_t sineWave[100];

void DAC_GenerateSineWave_DMA(void) {
    // Pre-calculate sine wave
    for (int i = 0; i &lt; 100; i++) {
        sineWave[i] = (uint16_t)((sin(2.0 * PI * i / 100.0) + 1.0) * 2047.5);
    }

    // Start DAC with DMA
    HAL_DAC_Start_DMA(&amp;hdac, DAC_CHANNEL_1, (uint32_t*)sineWave, 100,
                      DAC_ALIGN_12B_R);

    // Configure timer to trigger DAC at specific rate
    // This enables continuous waveform output
}
</code></pre>
<h3 id="external-dac-mcp4725-via-i2c"><a class="header" href="#external-dac-mcp4725-via-i2c">External DAC (MCP4725) via I2C</a></h3>
<pre><code class="language-cpp">#include &lt;Wire.h&gt;
#include &lt;Adafruit_MCP4725.h&gt;

Adafruit_MCP4725 dac;  // 12-bit DAC

void setup() {
  Serial.begin(115200);

  // Initialize MCP4725 (default address 0x62)
  if (!dac.begin(0x62)) {
    Serial.println("Failed to initialize MCP4725!");
    while (1);
  }

  Serial.println("MCP4725 initialized!");
}

void loop() {
  // Set voltage (0-4095 for 12-bit)
  // Vout = (value / 4095) * Vdd
  dac.setVoltage(2048, false);  // Output ~1.65V (Vdd/2)

  delay(1000);
}

// Ramp voltage smoothly
void rampVoltage(uint16_t start, uint16_t end, uint16_t steps) {
  int16_t increment = (end - start) / steps;

  for (uint16_t i = 0; i &lt; steps; i++) {
    uint16_t value = start + (i * increment);
    dac.setVoltage(value, false);
    delay(10);
  }
}

// Generate precise voltage
void setVoltage(float voltage) {
  // Assuming 5V Vdd
  uint16_t value = (uint16_t)((voltage / 5.0) * 4095.0);
  dac.setVoltage(value, false);
}

// Store value in EEPROM (survives power cycle)
void saveVoltage(uint16_t value) {
  dac.setVoltage(value, true);  // true = write to EEPROM
}
</code></pre>
<h3 id="pwm-as-pseudo-dac-arduino-uno"><a class="header" href="#pwm-as-pseudo-dac-arduino-uno">PWM as Pseudo-DAC (Arduino Uno)</a></h3>
<pre><code class="language-cpp">// Arduino Uno doesn't have true DAC, use PWM with filtering

const int pwmPin = 9;  // Any PWM pin

void setup() {
  pinMode(pwmPin, OUTPUT);

  // Increase PWM frequency for smoother output
  // Default: 490 Hz for pins 5,6 and 980 Hz for others
  // Setting for pin 9 and 10:
  TCCR1B = TCCR1B &amp; 0b11111000 | 0x01;  // 31.25 kHz
}

void loop() {
  // Output 2.5V (50% duty cycle with 5V Vdd)
  analogWrite(pwmPin, 128);  // 0-255 range

  delay(1000);
}

// Hardware low-pass filter (required for PWM DAC):
// PWM Pin ----1kohm----, Output
//                      |
//                    10uF
//                      |
//                     GND
//
// Cutoff frequency = 1 / (2*pi * R * C) = ~16 Hz

// Convert voltage to PWM value
void setPWMVoltage(float voltage) {
  int pwmValue = (int)((voltage / 5.0) * 255.0);
  analogWrite(pwmPin, constrain(pwmValue, 0, 255));
}
</code></pre>
<h2 id="common-applications-2"><a class="header" href="#common-applications-2">Common Applications</a></h2>
<h3 id="1-audio-output"><a class="header" href="#1-audio-output">1. Audio Output</a></h3>
<pre><code class="language-cpp">// Simple audio playback
const byte audioSample[] = {128, 150, 172, 192, 209, ...};
const int sampleRate = 8000;  // 8 kHz

void playAudio() {
  for (int i = 0; i &lt; sizeof(audioSample); i++) {
    dacWrite(25, audioSample[i]);
    delayMicroseconds(1000000 / sampleRate);
  }
}
</code></pre>
<h3 id="2-voltage-reference-generation"><a class="header" href="#2-voltage-reference-generation">2. Voltage Reference Generation</a></h3>
<pre><code class="language-cpp">// Generate precise reference voltage
void setReferenceVoltage(float voltage) {
  // Using 12-bit DAC with 3.3V reference
  uint16_t value = (uint16_t)((voltage / 3.3) * 4095);
  analogWrite(DAC0, value);
}

// Example: Generate 1.024V reference
void setup() {
  analogWriteResolution(12);
  setReferenceVoltage(1.024);  // Output constant 1.024V
}
</code></pre>
<h3 id="3-motor-speed-control"><a class="header" href="#3-motor-speed-control">3. Motor Speed Control</a></h3>
<pre><code class="language-cpp">// Control motor speed with voltage
void setMotorSpeed(int speedPercent) {
  // 0% = 0V, 100% = 3.3V
  int dacValue = map(speedPercent, 0, 100, 0, 255);
  dacWrite(25, dacValue);
}
</code></pre>
<h3 id="4-led-brightness-true-analog"><a class="header" href="#4-led-brightness-true-analog">4. LED Brightness (True Analog)</a></h3>
<pre><code class="language-cpp">// Unlike PWM, DAC gives true DC voltage
void setLEDBrightness(int percent) {
  int dacValue = map(percent, 0, 100, 0, 255);
  dacWrite(25, dacValue);
  // No flickering or PWM noise!
}
</code></pre>
<h3 id="5-signal-generation-for-testing"><a class="header" href="#5-signal-generation-for-testing">5. Signal Generation for Testing</a></h3>
<pre><code class="language-cpp">// Generate test signals
void generateDCOffset(float voltage) {
  uint16_t value = (uint16_t)((voltage / 3.3) * 4095);
  analogWrite(DAC0, value);
}

// Programmable voltage divider
void setProgrammableVoltage(float targetVoltage) {
  if (targetVoltage &lt;= 3.3) {
    generateDCOffset(targetVoltage);
  }
}
</code></pre>
<h2 id="waveform-generation"><a class="header" href="#waveform-generation">Waveform Generation</a></h2>
<h3 id="pre-calculated-waveform-tables"><a class="header" href="#pre-calculated-waveform-tables">Pre-calculated Waveform Tables</a></h3>
<pre><code class="language-cpp">// Sine wave lookup table (256 samples)
const uint8_t sineTable[256] PROGMEM = {
  127, 130, 133, 136, 139, 143, 146, 149,
  152, 155, 158, 161, 164, 167, 170, 173,
  // ... full 256 values
};

void generateSineFromTable(int frequency) {
  int delayTime = 1000000 / (frequency * 256);

  for (int i = 0; i &lt; 256; i++) {
    uint8_t value = pgm_read_byte(&amp;sineTable[i]);
    dacWrite(25, value);
    delayMicroseconds(delayTime);
  }
}
</code></pre>
<h2 id="best-practices-66"><a class="header" href="#best-practices-66">Best Practices</a></h2>
<h3 id="1-output-filtering"><a class="header" href="#1-output-filtering">1. Output Filtering</a></h3>
<pre><code>For cleaner output, add RC low-pass filter:

DAC Out ----100ohm----, Output
                       |
                     100nF
                       |
                      GND
</code></pre>
<h3 id="2-buffering"><a class="header" href="#2-buffering">2. Buffering</a></h3>
<pre><code>For driving loads, add op-amp buffer:

DAC Out ----, Op-Amp ---- Output
            |        |
            +--------+
              Feedback
</code></pre>
<h3 id="3-settling-time"><a class="header" href="#3-settling-time">3. Settling Time</a></h3>
<pre><code class="language-cpp">// Allow settling time after DAC update
void setDACWithSettling(uint16_t value) {
  analogWrite(DAC0, value);
  delayMicroseconds(10);  // Wait for output to settle
}
</code></pre>
<h3 id="4-reference-voltage-stability"><a class="header" href="#4-reference-voltage-stability">4. Reference Voltage Stability</a></h3>
<pre><code class="language-cpp">// Use external voltage reference for precision
// Internal reference can drift with temperature
</code></pre>
<h2 id="common-issues-and-debugging-4"><a class="header" href="#common-issues-and-debugging-4">Common Issues and Debugging</a></h2>
<h3 id="problem-output-voltage-incorrect"><a class="header" href="#problem-output-voltage-incorrect">Problem: Output Voltage Incorrect</a></h3>
<p><strong>Check</strong>:</p>
<ul>
<li>Verify reference voltage</li>
<li>Check calculation: (value / max) * Vref</li>
<li>Ensure value doesn't exceed maximum</li>
<li>Measure with high-impedance multimeter</li>
</ul>
<h3 id="problem-noisy-output"><a class="header" href="#problem-noisy-output">Problem: Noisy Output</a></h3>
<p><strong>Solutions</strong>:</p>
<ul>
<li>Add output filter capacitor (100nF)</li>
<li>Use separate analog ground</li>
<li>Add decoupling caps near DAC (0.1uF)</li>
<li>Keep output wires short</li>
</ul>
<h3 id="problem-cant-drive-load"><a class="header" href="#problem-cant-drive-load">Problem: Can't Drive Load</a></h3>
<p><strong>Solutions</strong>:</p>
<ul>
<li>DAC outputs have limited current capability (~20mA typical)</li>
<li>Add op-amp buffer for higher current</li>
<li>Use darlington transistor for heavy loads</li>
</ul>
<h3 id="problem-distorted-waveforms"><a class="header" href="#problem-distorted-waveforms">Problem: Distorted Waveforms</a></h3>
<p><strong>Check</strong>:</p>
<ul>
<li>Update rate too slow for frequency</li>
<li>Insufficient sample resolution</li>
<li>Loading effect (add buffer)</li>
</ul>
<h2 id="dac-specifications-to-consider"><a class="header" href="#dac-specifications-to-consider">DAC Specifications to Consider</a></h2>
<h3 id="1-resolution"><a class="header" href="#1-resolution">1. Resolution</a></h3>
<ul>
<li>More bits = finer voltage control</li>
<li>8-bit usually sufficient for simple control</li>
<li>12-16 bit for audio and precision apps</li>
</ul>
<h3 id="2-settling-time"><a class="header" href="#2-settling-time">2. Settling Time</a></h3>
<ul>
<li>Time to reach final value</li>
<li>Important for high-speed applications</li>
<li>Typical: 1-10 us</li>
</ul>
<h3 id="3-output-range"><a class="header" href="#3-output-range">3. Output Range</a></h3>
<ul>
<li>Single-ended: 0V to Vref</li>
<li>Bipolar: -Vref to +Vref (requires special circuit)</li>
</ul>
<h3 id="4-update-rate"><a class="header" href="#4-update-rate">4. Update Rate</a></h3>
<ul>
<li>How fast can DAC change values</li>
<li>Audio: &gt;40 kSPS</li>
<li>Simple control: &lt;1 kSPS</li>
</ul>
<h2 id="eli10-explain-like-im-10-4"><a class="header" href="#eli10-explain-like-im-10-4">ELI10 (Explain Like I'm 10)</a></h2>
<p>Remember ADC is like a thermometer that converts smooth temperatures to numbers? DAC is the opposite!</p>
<p>Imagine you have a light dimmer switch:</p>
<ul>
<li>Instead of smoothly turning the knob, you can only pick from specific positions</li>
<li>8-bit DAC: You have 256 positions (0-255)</li>
<li>12-bit DAC: You have 4096 positions (way more precise!)</li>
</ul>
<p>The DAC takes your number choice and creates a voltage:</p>
<ul>
<li>Digital number <strong>0</strong> -&gt; 0 volts</li>
<li>Digital number <strong>128</strong> (half) -&gt; 1.65 volts</li>
<li>Digital number <strong>255</strong> (max) -&gt; 3.3 volts</li>
</ul>
<p>It's like having a volume knob that you control with numbers instead of turning it by hand!</p>
<p><strong>PWM vs DAC</strong>: PWM is like flashing a light super fast to make it look dimmer. DAC is like actually turning down the voltage - it's smoother and better for some jobs!</p>
<h2 id="further-resources-20"><a class="header" href="#further-resources-20">Further Resources</a></h2>
<ul>
<li><a href="https://learn.sparkfun.com/tutorials/digital-to-analog-conversion">DAC Tutorial - SparkFun</a></li>
<li><a href="https://www.arduino.cc/reference/en/language/functions/analog-io/analogwrite/">Arduino Due DAC Reference</a></li>
<li><a href="https://docs.espressif.com/projects/esp-idf/en/latest/esp32/api-reference/peripherals/dac.html">ESP32 DAC Documentation</a></li>
<li><a href="https://www.microchip.com/en-us/product/MCP4725">MCP4725 Datasheet</a></li>
<li><a href="https://www.instructables.com/Arduino-Audio-Output/">Audio with Arduino DAC</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="real-time-clock-rtc-modules"><a class="header" href="#real-time-clock-rtc-modules">Real-Time Clock (RTC) Modules</a></h1>
<p>Comprehensive guide to RTC modules including DS1307, DS3231, and implementation examples.</p>
<h2 id="table-of-contents-42"><a class="header" href="#table-of-contents-42">Table of Contents</a></h2>
<ol>
<li><a href="embedded/rtc.html#introduction">Introduction</a></li>
<li><a href="embedded/rtc.html#rtc-basics">RTC Basics</a></li>
<li><a href="embedded/rtc.html#ds1307">DS1307</a></li>
<li><a href="embedded/rtc.html#ds3231">DS3231</a></li>
<li><a href="embedded/rtc.html#pcf8523">PCF8523</a></li>
<li><a href="embedded/rtc.html#arduino-examples">Arduino Examples</a></li>
<li><a href="embedded/rtc.html#stm32-examples">STM32 Examples</a></li>
<li><a href="embedded/rtc.html#avr-bare-metal">AVR Bare Metal</a></li>
</ol>
<h2 id="introduction-22"><a class="header" href="#introduction-22">Introduction</a></h2>
<p>Real-Time Clock (RTC) modules are specialized integrated circuits that keep accurate time even when the main system is powered off. They are essential for data logging, scheduling, timestamps, and time-based applications.</p>
<h3 id="why-use-an-rtc-module"><a class="header" href="#why-use-an-rtc-module">Why Use an RTC Module?</a></h3>
<ul>
<li><strong>Accurate Timekeeping</strong>: Crystal oscillator provides precise time</li>
<li><strong>Low Power</strong>: Runs on backup battery for years</li>
<li><strong>Independent Operation</strong>: Maintains time when main power is off</li>
<li><strong>Calendar Functions</strong>: Handles dates, months, leap years automatically</li>
<li><strong>Alarms</strong>: Can trigger events at specific times</li>
</ul>
<h3 id="popular-rtc-modules"><a class="header" href="#popular-rtc-modules">Popular RTC Modules</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Module</th><th>Crystal</th><th>Accuracy</th><th>Battery</th><th>Temperature</th><th>I2C Addr</th><th>Price</th></tr></thead><tbody>
<tr><td><strong>DS1307</strong></td><td>32.768 kHz</td><td>±2 min/month</td><td>CR2032</td><td>No</td><td>0x68</td><td>$1</td></tr>
<tr><td><strong>DS3231</strong></td><td>32.768 kHz (TCXO)</td><td>±2 min/year</td><td>CR2032</td><td>Yes</td><td>0x68</td><td>$2-5</td></tr>
<tr><td><strong>PCF8523</strong></td><td>32.768 kHz</td><td>±3 min/year</td><td>CR2032</td><td>No</td><td>0x68</td><td>$2</td></tr>
<tr><td><strong>MCP7940N</strong></td><td>32.768 kHz</td><td>±2 min/month</td><td>CR2032</td><td>No</td><td>0x6F</td><td>$1</td></tr>
</tbody></table>
</div>
<h2 id="rtc-basics"><a class="header" href="#rtc-basics">RTC Basics</a></h2>
<h3 id="time-representation"><a class="header" href="#time-representation">Time Representation</a></h3>
<p>RTCs store time in BCD (Binary Coded Decimal) format:</p>
<pre><code>Decimal 59 = 0101 1001 BCD
             5     9

Decimal to BCD: 59 = (5 &lt;&lt; 4) | 9 = 0x59
BCD to Decimal: 0x59 = ((0x59 &gt;&gt; 4) * 10) + (0x59 &amp; 0x0F) = 59
</code></pre>
<h3 id="bcd-conversion-functions"><a class="header" href="#bcd-conversion-functions">BCD Conversion Functions</a></h3>
<pre><code class="language-c">// Decimal to BCD
uint8_t dec_to_bcd(uint8_t val) {
    return ((val / 10) &lt;&lt; 4) | (val % 10);
}

// BCD to Decimal
uint8_t bcd_to_dec(uint8_t val) {
    return ((val &gt;&gt; 4) * 10) + (val &amp; 0x0F);
}
</code></pre>
<h3 id="i2c-communication-1"><a class="header" href="#i2c-communication-1">I2C Communication</a></h3>
<p>All popular RTC modules use I2C interface:</p>
<pre><code>Connections:
  RTC VCC  -&gt; 3.3V or 5V
  RTC GND  -&gt; GND
  RTC SDA  -&gt; SDA (with pull-up resistor)
  RTC SCL  -&gt; SCL (with pull-up resistor)
  
Pull-up resistors: 4.7kΩ typical
</code></pre>
<p><strong>Wiring Diagram:</strong></p>
<pre><code>RTC Module          Microcontroller
    ┌────┐
VCC ┤    ├─ VCC (3.3V/5V)
GND ┤    ├─ GND
SDA ┤    ├─ SDA (with 4.7kΩ pull-up)
SCL ┤    ├─ SCL (with 4.7kΩ pull-up)
    └────┘
</code></pre>
<h2 id="ds1307"><a class="header" href="#ds1307">DS1307</a></h2>
<h3 id="features"><a class="header" href="#features">Features</a></h3>
<ul>
<li><strong>Accuracy</strong>: ±2 minutes per month</li>
<li><strong>Operating Voltage</strong>: 4.5-5.5V (5V recommended)</li>
<li><strong>Battery Backup</strong>: CR2032 (typical)</li>
<li><strong>Interface</strong>: I2C (100 kHz)</li>
<li><strong>Address</strong>: 0x68 (fixed)</li>
<li><strong>RAM</strong>: 56 bytes of non-volatile SRAM</li>
<li><strong>Output</strong>: 1 Hz square wave</li>
</ul>
<h3 id="register-map"><a class="header" href="#register-map">Register Map</a></h3>
<pre><code>Register  Function
0x00      Seconds (00-59)
0x01      Minutes (00-59)
0x02      Hours (00-23 or 01-12)
0x03      Day of week (1-7)
0x04      Date (01-31)
0x05      Month (01-12)
0x06      Year (00-99)
0x07      Control (SQW output)
0x08-0x3F RAM (56 bytes)

Bit Layout:
Seconds:  0  | 10-sec | sec
          CH | 4 2 1  | 8 4 2 1

CH = Clock Halt bit (0 = running, 1 = stopped)
</code></pre>
<h3 id="arduino-ds1307-library"><a class="header" href="#arduino-ds1307-library">Arduino DS1307 Library</a></h3>
<pre><code class="language-cpp">#include &lt;Wire.h&gt;
#include &lt;RTClib.h&gt;

RTC_DS1307 rtc;

void setup() {
    Serial.begin(9600);
    Wire.begin();
    
    if (!rtc.begin()) {
        Serial.println("Couldn't find RTC");
        while (1);
    }
    
    if (!rtc.isrunning()) {
        Serial.println("RTC is NOT running, setting time...");
        // Set to compile time
        rtc.adjust(DateTime(F(__DATE__), F(__TIME__)));
        // Or set manually:
        // rtc.adjust(DateTime(2024, 1, 15, 12, 30, 0));
    }
}

void loop() {
    DateTime now = rtc.now();
    
    Serial.print(now.year(), DEC);
    Serial.print('/');
    Serial.print(now.month(), DEC);
    Serial.print('/');
    Serial.print(now.day(), DEC);
    Serial.print(" ");
    Serial.print(now.hour(), DEC);
    Serial.print(':');
    Serial.print(now.minute(), DEC);
    Serial.print(':');
    Serial.println(now.second(), DEC);
    
    delay(1000);
}
</code></pre>
<h3 id="ds1307-bare-metal-arduino"><a class="header" href="#ds1307-bare-metal-arduino">DS1307 Bare Metal (Arduino)</a></h3>
<pre><code class="language-cpp">#include &lt;Wire.h&gt;

#define DS1307_ADDR 0x68

uint8_t dec_to_bcd(uint8_t val) {
    return ((val / 10) &lt;&lt; 4) | (val % 10);
}

uint8_t bcd_to_dec(uint8_t val) {
    return ((val &gt;&gt; 4) * 10) + (val &amp; 0x0F);
}

void ds1307_set_time(uint8_t hour, uint8_t min, uint8_t sec) {
    Wire.beginTransmission(DS1307_ADDR);
    Wire.write(0x00);  // Start at seconds register
    Wire.write(dec_to_bcd(sec) &amp; 0x7F);  // Clear CH bit
    Wire.write(dec_to_bcd(min));
    Wire.write(dec_to_bcd(hour));
    Wire.endTransmission();
}

void ds1307_set_date(uint8_t day, uint8_t date, uint8_t month, uint8_t year) {
    Wire.beginTransmission(DS1307_ADDR);
    Wire.write(0x03);  // Start at day register
    Wire.write(dec_to_bcd(day));
    Wire.write(dec_to_bcd(date));
    Wire.write(dec_to_bcd(month));
    Wire.write(dec_to_bcd(year));
    Wire.endTransmission();
}

void ds1307_read_time(uint8_t *hour, uint8_t *min, uint8_t *sec) {
    Wire.beginTransmission(DS1307_ADDR);
    Wire.write(0x00);  // Start at seconds register
    Wire.endTransmission();
    
    Wire.requestFrom(DS1307_ADDR, 3);
    *sec = bcd_to_dec(Wire.read() &amp; 0x7F);
    *min = bcd_to_dec(Wire.read());
    *hour = bcd_to_dec(Wire.read());
}

void setup() {
    Serial.begin(9600);
    Wire.begin();
    
    // Set time: 12:30:00
    ds1307_set_time(12, 30, 0);
    
    // Set date: Monday, 15/01/24
    ds1307_set_date(1, 15, 1, 24);
}

void loop() {
    uint8_t hour, min, sec;
    
    ds1307_read_time(&amp;hour, &amp;min, &amp;sec);
    
    Serial.print(hour);
    Serial.print(":");
    Serial.print(min);
    Serial.print(":");
    Serial.println(sec);
    
    delay(1000);
}
</code></pre>
<h2 id="ds3231"><a class="header" href="#ds3231">DS3231</a></h2>
<h3 id="features-1"><a class="header" href="#features-1">Features</a></h3>
<ul>
<li><strong>Accuracy</strong>: ±2 minutes per year (much better than DS1307)</li>
<li><strong>Temperature Compensated</strong>: TCXO provides better accuracy</li>
<li><strong>Operating Voltage</strong>: 2.3-5.5V</li>
<li><strong>Battery Backup</strong>: CR2032</li>
<li><strong>Interface</strong>: I2C (100-400 kHz)</li>
<li><strong>Address</strong>: 0x68 (fixed)</li>
<li><strong>Temperature Sensor</strong>: Built-in (±3°C accuracy)</li>
<li><strong>Alarms</strong>: Two programmable alarms</li>
<li><strong>Square Wave Output</strong>: 1Hz, 1.024kHz, 4.096kHz, 8.192kHz</li>
</ul>
<h3 id="register-map-1"><a class="header" href="#register-map-1">Register Map</a></h3>
<pre><code>Register  Function
0x00      Seconds (00-59)
0x01      Minutes (00-59)
0x02      Hours (00-23 or 01-12)
0x03      Day of week (1-7)
0x04      Date (01-31)
0x05      Month/Century (01-12)
0x06      Year (00-99)
0x07-0x0A Alarm 1
0x0B-0x0D Alarm 2
0x0E      Control
0x0F      Control/Status
0x10      Aging offset
0x11-0x12 Temperature
</code></pre>
<h3 id="arduino-ds3231-library"><a class="header" href="#arduino-ds3231-library">Arduino DS3231 Library</a></h3>
<pre><code class="language-cpp">#include &lt;Wire.h&gt;
#include &lt;RTClib.h&gt;

RTC_DS3231 rtc;

void setup() {
    Serial.begin(9600);
    Wire.begin();
    
    if (!rtc.begin()) {
        Serial.println("Couldn't find RTC");
        while (1);
    }
    
    if (rtc.lostPower()) {
        Serial.println("RTC lost power, setting time...");
        rtc.adjust(DateTime(F(__DATE__), F(__TIME__)));
    }
}

void loop() {
    DateTime now = rtc.now();
    
    // Print time
    Serial.print(now.year(), DEC);
    Serial.print('/');
    Serial.print(now.month(), DEC);
    Serial.print('/');
    Serial.print(now.day(), DEC);
    Serial.print(" ");
    Serial.print(now.hour(), DEC);
    Serial.print(':');
    Serial.print(now.minute(), DEC);
    Serial.print(':');
    Serial.print(now.second(), DEC);
    
    // Print temperature
    float temp = rtc.getTemperature();
    Serial.print(" Temp: ");
    Serial.print(temp);
    Serial.println("°C");
    
    delay(1000);
}
</code></pre>
<h3 id="ds3231-alarm-example"><a class="header" href="#ds3231-alarm-example">DS3231 Alarm Example</a></h3>
<pre><code class="language-cpp">#include &lt;Wire.h&gt;
#include &lt;RTClib.h&gt;

RTC_DS3231 rtc;

void setup() {
    Serial.begin(9600);
    Wire.begin();
    rtc.begin();
    
    // Set alarm 1 for every day at 12:30:00
    rtc.setAlarm1(DateTime(0, 0, 0, 12, 30, 0), DS3231_A1_Hour);
    
    // Enable alarm interrupt
    rtc.disableAlarm(1);
    rtc.disableAlarm(2);
    rtc.clearAlarm(1);
    rtc.clearAlarm(2);
    rtc.writeSqwPinMode(DS3231_OFF);  // Disable square wave
}

void loop() {
    if (rtc.alarmFired(1)) {
        Serial.println("Alarm 1 triggered!");
        rtc.clearAlarm(1);
    }
    
    delay(1000);
}
</code></pre>
<h3 id="ds3231-temperature-reading"><a class="header" href="#ds3231-temperature-reading">DS3231 Temperature Reading</a></h3>
<pre><code class="language-cpp">#include &lt;Wire.h&gt;

#define DS3231_ADDR 0x68
#define TEMP_MSB    0x11
#define TEMP_LSB    0x12

float ds3231_get_temperature() {
    Wire.beginTransmission(DS3231_ADDR);
    Wire.write(TEMP_MSB);
    Wire.endTransmission();
    
    Wire.requestFrom(DS3231_ADDR, 2);
    uint8_t msb = Wire.read();
    uint8_t lsb = Wire.read();
    
    // Combine MSB and LSB
    int16_t temp = (msb &lt;&lt; 2) | (lsb &gt;&gt; 6);
    
    // Handle negative temperatures
    if (temp &amp; 0x200) {
        temp |= 0xFC00;
    }
    
    return temp * 0.25;
}

void setup() {
    Serial.begin(9600);
    Wire.begin();
}

void loop() {
    float temperature = ds3231_get_temperature();
    
    Serial.print("Temperature: ");
    Serial.print(temperature);
    Serial.println("°C");
    
    delay(1000);
}
</code></pre>
<h2 id="pcf8523"><a class="header" href="#pcf8523">PCF8523</a></h2>
<h3 id="features-2"><a class="header" href="#features-2">Features</a></h3>
<ul>
<li><strong>Accuracy</strong>: ±3 minutes per year</li>
<li><strong>Operating Voltage</strong>: 1.8-5.5V</li>
<li><strong>Battery Backup</strong>: CR2032</li>
<li><strong>Interface</strong>: I2C (100-400 kHz)</li>
<li><strong>Address</strong>: 0x68 (fixed)</li>
<li><strong>Alarm</strong>: Single programmable alarm</li>
<li><strong>Timer</strong>: Countdown timer</li>
<li><strong>Low Power</strong>: Multiple power-saving modes</li>
</ul>
<h3 id="arduino-pcf8523"><a class="header" href="#arduino-pcf8523">Arduino PCF8523</a></h3>
<pre><code class="language-cpp">#include &lt;Wire.h&gt;
#include &lt;RTClib.h&gt;

RTC_PCF8523 rtc;

void setup() {
    Serial.begin(9600);
    Wire.begin();
    
    if (!rtc.begin()) {
        Serial.println("Couldn't find RTC");
        while (1);
    }
    
    if (!rtc.initialized() || rtc.lostPower()) {
        Serial.println("RTC is NOT initialized, setting time...");
        rtc.adjust(DateTime(F(__DATE__), F(__TIME__)));
    }
    
    // Start RTC
    rtc.start();
}

void loop() {
    DateTime now = rtc.now();
    
    Serial.print(now.year(), DEC);
    Serial.print('/');
    Serial.print(now.month(), DEC);
    Serial.print('/');
    Serial.print(now.day(), DEC);
    Serial.print(" ");
    Serial.print(now.hour(), DEC);
    Serial.print(':');
    Serial.print(now.minute(), DEC);
    Serial.print(':');
    Serial.println(now.second(), DEC);
    
    delay(1000);
}
</code></pre>
<h2 id="arduino-examples"><a class="header" href="#arduino-examples">Arduino Examples</a></h2>
<h3 id="data-logger-with-rtc"><a class="header" href="#data-logger-with-rtc">Data Logger with RTC</a></h3>
<pre><code class="language-cpp">#include &lt;Wire.h&gt;
#include &lt;RTClib.h&gt;
#include &lt;SD.h&gt;

RTC_DS3231 rtc;
const int CS_PIN = 10;

void setup() {
    Serial.begin(9600);
    Wire.begin();
    
    if (!rtc.begin()) {
        Serial.println("RTC error");
        while (1);
    }
    
    if (!SD.begin(CS_PIN)) {
        Serial.println("SD card error");
        while (1);
    }
}

void loop() {
    DateTime now = rtc.now();
    float temp = rtc.getTemperature();
    
    // Create filename
    char filename[13];
    sprintf(filename, "%04d%02d%02d.txt", 
            now.year(), now.month(), now.day());
    
    // Open file
    File dataFile = SD.open(filename, FILE_WRITE);
    
    if (dataFile) {
        // Write timestamp and data
        dataFile.print(now.hour());
        dataFile.print(":");
        dataFile.print(now.minute());
        dataFile.print(":");
        dataFile.print(now.second());
        dataFile.print(",");
        dataFile.println(temp);
        
        dataFile.close();
        
        Serial.println("Data logged");
    } else {
        Serial.println("Error opening file");
    }
    
    delay(60000);  // Log every minute
}
</code></pre>
<h3 id="digital-clock-display"><a class="header" href="#digital-clock-display">Digital Clock Display</a></h3>
<pre><code class="language-cpp">#include &lt;Wire.h&gt;
#include &lt;RTClib.h&gt;
#include &lt;LiquidCrystal.h&gt;

RTC_DS3231 rtc;
LiquidCrystal lcd(12, 11, 5, 4, 3, 2);

void setup() {
    Wire.begin();
    rtc.begin();
    lcd.begin(16, 2);
    
    if (rtc.lostPower()) {
        rtc.adjust(DateTime(F(__DATE__), F(__TIME__)));
    }
}

void loop() {
    DateTime now = rtc.now();
    
    // Display date on line 1
    lcd.setCursor(0, 0);
    lcd.print(now.day(), DEC);
    lcd.print('/');
    lcd.print(now.month(), DEC);
    lcd.print('/');
    lcd.print(now.year(), DEC);
    lcd.print("   ");
    
    // Display time on line 2
    lcd.setCursor(0, 1);
    if (now.hour() &lt; 10) lcd.print('0');
    lcd.print(now.hour(), DEC);
    lcd.print(':');
    if (now.minute() &lt; 10) lcd.print('0');
    lcd.print(now.minute(), DEC);
    lcd.print(':');
    if (now.second() &lt; 10) lcd.print('0');
    lcd.print(now.second(), DEC);
    
    delay(1000);
}
</code></pre>
<h3 id="alarm-clock"><a class="header" href="#alarm-clock">Alarm Clock</a></h3>
<pre><code class="language-cpp">#include &lt;Wire.h&gt;
#include &lt;RTClib.h&gt;

RTC_DS3231 rtc;

const int BUZZER_PIN = 9;
const int BUTTON_PIN = 2;

uint8_t alarm_hour = 7;
uint8_t alarm_minute = 30;
bool alarm_active = false;

void setup() {
    Serial.begin(9600);
    Wire.begin();
    rtc.begin();
    
    pinMode(BUZZER_PIN, OUTPUT);
    pinMode(BUTTON_PIN, INPUT_PULLUP);
    
    // Set alarm
    rtc.setAlarm1(DateTime(0, 0, 0, alarm_hour, alarm_minute, 0), 
                  DS3231_A1_Hour);
}

void loop() {
    DateTime now = rtc.now();
    
    // Check alarm
    if (rtc.alarmFired(1)) {
        alarm_active = true;
        rtc.clearAlarm(1);
    }
    
    // Sound buzzer if alarm active
    if (alarm_active) {
        tone(BUZZER_PIN, 1000, 500);
        delay(1000);
        
        // Check for button press to stop
        if (digitalRead(BUTTON_PIN) == LOW) {
            alarm_active = false;
            noTone(BUZZER_PIN);
        }
    }
    
    // Display time
    Serial.print(now.hour());
    Serial.print(":");
    Serial.print(now.minute());
    Serial.print(":");
    Serial.println(now.second());
    
    delay(1000);
}
</code></pre>
<h2 id="stm32-examples"><a class="header" href="#stm32-examples">STM32 Examples</a></h2>
<h3 id="ds3231-with-stm32-hal"><a class="header" href="#ds3231-with-stm32-hal">DS3231 with STM32 HAL</a></h3>
<pre><code class="language-c">#include "main.h"
#include &lt;stdio.h&gt;

I2C_HandleTypeDef hi2c1;

#define DS3231_ADDR (0x68 &lt;&lt; 1)

uint8_t dec_to_bcd(uint8_t val) {
    return ((val / 10) &lt;&lt; 4) | (val % 10);
}

uint8_t bcd_to_dec(uint8_t val) {
    return ((val &gt;&gt; 4) * 10) + (val &amp; 0x0F);
}

void ds3231_set_time(uint8_t hour, uint8_t min, uint8_t sec) {
    uint8_t data[4];
    data[0] = 0x00;  // Start register
    data[1] = dec_to_bcd(sec);
    data[2] = dec_to_bcd(min);
    data[3] = dec_to_bcd(hour);
    
    HAL_I2C_Master_Transmit(&amp;hi2c1, DS3231_ADDR, data, 4, HAL_MAX_DELAY);
}

void ds3231_read_time(uint8_t *hour, uint8_t *min, uint8_t *sec) {
    uint8_t reg = 0x00;
    uint8_t data[3];
    
    HAL_I2C_Master_Transmit(&amp;hi2c1, DS3231_ADDR, &amp;reg, 1, HAL_MAX_DELAY);
    HAL_I2C_Master_Receive(&amp;hi2c1, DS3231_ADDR, data, 3, HAL_MAX_DELAY);
    
    *sec = bcd_to_dec(data[0]);
    *min = bcd_to_dec(data[1]);
    *hour = bcd_to_dec(data[2]);
}

float ds3231_get_temperature(void) {
    uint8_t reg = 0x11;
    uint8_t data[2];
    
    HAL_I2C_Master_Transmit(&amp;hi2c1, DS3231_ADDR, &amp;reg, 1, HAL_MAX_DELAY);
    HAL_I2C_Master_Receive(&amp;hi2c1, DS3231_ADDR, data, 2, HAL_MAX_DELAY);
    
    int16_t temp = (data[0] &lt;&lt; 2) | (data[1] &gt;&gt; 6);
    
    if (temp &amp; 0x200) {
        temp |= 0xFC00;
    }
    
    return temp * 0.25;
}

int main(void) {
    HAL_Init();
    SystemClock_Config();
    MX_I2C1_Init();
    MX_USART1_UART_Init();
    
    // Set initial time
    ds3231_set_time(12, 30, 0);
    
    while (1) {
        uint8_t hour, min, sec;
        ds3231_read_time(&amp;hour, &amp;min, &amp;sec);
        
        float temp = ds3231_get_temperature();
        
        printf("%02d:%02d:%02d Temp: %.2f°C\r\n", hour, min, sec, temp);
        
        HAL_Delay(1000);
    }
}
</code></pre>
<h2 id="avr-bare-metal"><a class="header" href="#avr-bare-metal">AVR Bare Metal</a></h2>
<h3 id="ds1307-with-avr-atmega328p"><a class="header" href="#ds1307-with-avr-atmega328p">DS1307 with AVR (ATmega328P)</a></h3>
<pre><code class="language-c">#include &lt;avr/io.h&gt;
#include &lt;util/delay.h&gt;
#include &lt;stdio.h&gt;

#define DS1307_ADDR 0x68
#define F_SCL 100000UL
#define TWI_BITRATE ((F_CPU / F_SCL) - 16) / 2

uint8_t dec_to_bcd(uint8_t val) {
    return ((val / 10) &lt;&lt; 4) | (val % 10);
}

uint8_t bcd_to_dec(uint8_t val) {
    return ((val &gt;&gt; 4) * 10) + (val &amp; 0x0F);
}

void i2c_init(void) {
    TWBR = (uint8_t)TWI_BITRATE;
    TWCR = (1 &lt;&lt; TWEN);
}

void i2c_start(void) {
    TWCR = (1 &lt;&lt; TWINT) | (1 &lt;&lt; TWSTA) | (1 &lt;&lt; TWEN);
    while (!(TWCR &amp; (1 &lt;&lt; TWINT)));
}

void i2c_stop(void) {
    TWCR = (1 &lt;&lt; TWINT) | (1 &lt;&lt; TWSTO) | (1 &lt;&lt; TWEN);
}

void i2c_write(uint8_t data) {
    TWDR = data;
    TWCR = (1 &lt;&lt; TWINT) | (1 &lt;&lt; TWEN);
    while (!(TWCR &amp; (1 &lt;&lt; TWINT)));
}

uint8_t i2c_read_ack(void) {
    TWCR = (1 &lt;&lt; TWINT) | (1 &lt;&lt; TWEN) | (1 &lt;&lt; TWEA);
    while (!(TWCR &amp; (1 &lt;&lt; TWINT)));
    return TWDR;
}

uint8_t i2c_read_nack(void) {
    TWCR = (1 &lt;&lt; TWINT) | (1 &lt;&lt; TWEN);
    while (!(TWCR &amp; (1 &lt;&lt; TWINT)));
    return TWDR;
}

void ds1307_set_time(uint8_t hour, uint8_t min, uint8_t sec) {
    i2c_start();
    i2c_write((DS1307_ADDR &lt;&lt; 1) | 0);
    i2c_write(0x00);  // Start register
    i2c_write(dec_to_bcd(sec));
    i2c_write(dec_to_bcd(min));
    i2c_write(dec_to_bcd(hour));
    i2c_stop();
}

void ds1307_read_time(uint8_t *hour, uint8_t *min, uint8_t *sec) {
    i2c_start();
    i2c_write((DS1307_ADDR &lt;&lt; 1) | 0);
    i2c_write(0x00);  // Start register
    i2c_start();  // Repeated start
    i2c_write((DS1307_ADDR &lt;&lt; 1) | 1);
    
    *sec = bcd_to_dec(i2c_read_ack());
    *min = bcd_to_dec(i2c_read_ack());
    *hour = bcd_to_dec(i2c_read_nack());
    
    i2c_stop();
}

int main(void) {
    i2c_init();
    uart_init();  // Assume UART is initialized
    
    // Set time to 12:30:00
    ds1307_set_time(12, 30, 0);
    
    while (1) {
        uint8_t hour, min, sec;
        ds1307_read_time(&amp;hour, &amp;min, &amp;sec);
        
        printf("%02d:%02d:%02d\n", hour, min, sec);
        
        _delay_ms(1000);
    }
    
    return 0;
}
</code></pre>
<h2 id="best-practices-67"><a class="header" href="#best-practices-67">Best Practices</a></h2>
<ol>
<li><strong>Battery Backup</strong>: Always install backup battery for continuous operation</li>
<li><strong>Pull-up Resistors</strong>: Ensure 4.7kΩ pull-ups on SDA and SCL</li>
<li><strong>Power Supply</strong>: DS1307 requires 5V, DS3231 works with 3.3V-5V</li>
<li><strong>Initial Setup</strong>: Set time after first power-on or battery change</li>
<li><strong>Lost Power Check</strong>: Check and handle RTC power loss</li>
<li><strong>BCD Format</strong>: Remember to convert between decimal and BCD</li>
<li><strong>I2C Speed</strong>: Use 100 kHz for reliability, 400 kHz if needed</li>
</ol>
<h2 id="troubleshooting-20"><a class="header" href="#troubleshooting-20">Troubleshooting</a></h2>
<h3 id="common-issues-21"><a class="header" href="#common-issues-21">Common Issues</a></h3>
<p><strong>RTC Not Responding:</strong></p>
<ul>
<li>Check I2C address (usually 0x68)</li>
<li>Verify SDA/SCL connections</li>
<li>Ensure pull-up resistors present</li>
<li>Check power supply voltage</li>
</ul>
<p><strong>Time Not Keeping:</strong></p>
<ul>
<li>Install backup battery (CR2032)</li>
<li>Check battery voltage (should be ~3V)</li>
<li>For DS1307: Clear CH (Clock Halt) bit</li>
<li>Verify crystal oscillator is working</li>
</ul>
<p><strong>Inaccurate Time:</strong></p>
<ul>
<li>DS1307: Normal (±2 min/month), consider DS3231</li>
<li>DS3231: Check temperature effects</li>
<li>Calibrate using aging offset register (DS3231)</li>
</ul>
<p><strong>I2C Communication Errors:</strong></p>
<pre><code class="language-cpp">// Check I2C scanner result
Wire.beginTransmission(0x68);
if (Wire.endTransmission() == 0) {
    Serial.println("RTC found at 0x68");
} else {
    Serial.println("RTC not found");
}
</code></pre>
<h2 id="resources-36"><a class="header" href="#resources-36">Resources</a></h2>
<ul>
<li><strong>DS1307 Datasheet</strong>: Maxim Integrated</li>
<li><strong>DS3231 Datasheet</strong>: Maxim Integrated</li>
<li><strong>RTClib Library</strong>: https://github.com/adafruit/RTClib</li>
<li><strong>I2C Protocol</strong>: See <a href="embedded/i2c.html">I2C documentation</a></li>
</ul>
<h2 id="see-also-6"><a class="header" href="#see-also-6">See Also</a></h2>
<ul>
<li><a href="embedded/i2c.html">I2C Communication</a></li>
<li><a href="embedded/arduino.html">Arduino Programming</a></li>
<li><a href="embedded/stm32.html">STM32 HAL</a></li>
<li><a href="embedded/avr.html">AVR Programming</a></li>
<li><a href="embedded/data_logging.html">Data Logging</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="gpio"><a class="header" href="#gpio">GPIO</a></h1>
<h2 id="general-purpose-inputoutput-gpio"><a class="header" href="#general-purpose-inputoutput-gpio">General Purpose Input/Output (GPIO)</a></h2>
<p>GPIO stands for General Purpose Input/Output. It is a generic pin on an integrated circuit or computer board whose behavior (including whether it is an input or output pin) can be controlled by the user at runtime. GPIO pins are a staple in embedded systems and microcontroller projects due to their versatility and ease of use.</p>
<h3 id="key-features-of-gpio"><a class="header" href="#key-features-of-gpio">Key Features of GPIO</a></h3>
<ol>
<li>
<p><strong>Configurable Direction</strong>: Each GPIO pin can be configured as either an input or an output. This allows the pin to either read signals from external devices (input) or send signals to external devices (output).</p>
</li>
<li>
<p><strong>Digital Signals</strong>: GPIO pins typically handle digital signals, meaning they can be in one of two states: high (1) or low (0). The voltage levels corresponding to these states depend on the specific hardware but are commonly 3.3V or 5V for high and 0V for low.</p>
</li>
<li>
<p><strong>Interrupts</strong>: Many GPIO pins support interrupts, which allow the pin to trigger an event in the software when a specific condition is met, such as a change in state. This is useful for responding to external events without constantly polling the pin.</p>
</li>
<li>
<p><strong>Pull-up/Pull-down Resistors</strong>: GPIO pins often have configurable pull-up or pull-down resistors. These resistors ensure that the pin is in a known state (high or low) when it is not actively being driven by an external source.</p>
</li>
<li>
<p><strong>Debouncing</strong>: When reading input from mechanical switches, GPIO pins can experience noise or "bouncing." Debouncing techniques, either in hardware or software, are used to ensure that the signal is stable and accurate.</p>
</li>
</ol>
<h3 id="common-uses-of-gpio"><a class="header" href="#common-uses-of-gpio">Common Uses of GPIO</a></h3>
<ul>
<li><strong>LED Control</strong>: Turning LEDs on and off or controlling their brightness using Pulse Width Modulation (PWM).</li>
<li><strong>Button Inputs</strong>: Reading the state of buttons or switches to trigger actions in the software.</li>
<li><strong>Sensor Interfacing</strong>: Reading data from various sensors like temperature, humidity, or motion sensors.</li>
<li><strong>Communication</strong>: Implementing simple communication protocols like I2C, SPI, or UART using GPIO pins.</li>
</ul>
<h3 id="example-code"><a class="header" href="#example-code">Example Code</a></h3>
<p>Here is an example of how to configure and use a GPIO pin in a typical microcontroller environment (e.g., using the Arduino platform):</p>
<pre><code class="language-cpp">// Define the pin number
const int ledPin = 13; // Pin number for the LED

void setup() {
  // Initialize the digital pin as an output.
  pinMode(ledPin, OUTPUT);
}

void loop() {
  // Turn the LED on (HIGH is the voltage level)
  digitalWrite(ledPin, HIGH);
  // Wait for a second
  delay(1000);
  // Turn the LED off by making the voltage LOW
  digitalWrite(ledPin, LOW);
  // Wait for a second
  delay(1000);
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="interrupts-3"><a class="header" href="#interrupts-3">Interrupts</a></h1>
<h2 id="overview-70"><a class="header" href="#overview-70">Overview</a></h2>
<p>Interrupts are signals that temporarily halt the normal execution of a program or process, allowing the system to respond to important events. They are a crucial mechanism in computer architecture, enabling efficient multitasking and real-time processing.</p>
<h2 id="types-of-interrupts"><a class="header" href="#types-of-interrupts">Types of Interrupts</a></h2>
<ol>
<li>
<p><strong>Hardware Interrupts</strong>: Generated by hardware devices (e.g., keyboard, mouse, network cards) to signal that they require attention from the CPU. These interrupts can occur at any time and are typically prioritized to ensure that critical tasks are handled promptly.</p>
</li>
<li>
<p><strong>Software Interrupts</strong>: Triggered by software instructions, such as system calls or exceptions. These interrupts allow programs to request services from the operating system or handle errors gracefully.</p>
</li>
<li>
<p><strong>Timer Interrupts</strong>: Generated by a timer within the system to allow the operating system to perform regular tasks, such as scheduling processes and managing system resources.</p>
</li>
</ol>
<h2 id="interrupt-handling"><a class="header" href="#interrupt-handling">Interrupt Handling</a></h2>
<p>When an interrupt occurs, the CPU stops executing the current program and saves its state. The system then executes an interrupt handler, a special routine designed to address the specific interrupt. After the handler completes its task, the CPU restores the saved state and resumes the interrupted program.</p>
<h2 id="applications-of-interrupts"><a class="header" href="#applications-of-interrupts">Applications of Interrupts</a></h2>
<ul>
<li>
<p><strong>Real-Time Systems</strong>: Interrupts are essential in real-time systems where timely responses to events are critical, such as in embedded systems, automotive applications, and industrial automation.</p>
</li>
<li>
<p><strong>Multitasking</strong>: Operating systems use interrupts to manage multiple processes efficiently, allowing them to share CPU time and resources without significant delays.</p>
</li>
<li>
<p><strong>Event-Driven Programming</strong>: In event-driven architectures, interrupts facilitate the handling of user inputs and other events, enabling responsive applications.</p>
</li>
</ul>
<h2 id="conclusion-24"><a class="header" href="#conclusion-24">Conclusion</a></h2>
<p>Understanding interrupts is vital for developers working with low-level programming, operating systems, and embedded systems. They play a key role in ensuring that systems can respond quickly and efficiently to a variety of events.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="timers-and-counters-1"><a class="header" href="#timers-and-counters-1">Timers and Counters</a></h1>
<h2 id="overview-71"><a class="header" href="#overview-71">Overview</a></h2>
<p>Timers and counters are essential hardware peripherals in microcontrollers that keep track of time, count events, generate precise delays, create PWM signals, and trigger interrupts at specific intervals. Unlike software delays (which block the CPU), hardware timers run independently, allowing your program to multitask efficiently.</p>
<h2 id="key-concepts-26"><a class="header" href="#key-concepts-26">Key Concepts</a></h2>
<h3 id="timer-vs-counter"><a class="header" href="#timer-vs-counter">Timer vs Counter</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Feature</th><th>Timer</th><th>Counter</th></tr></thead><tbody>
<tr><td><strong>Clock Source</strong></td><td>Internal (system clock)</td><td>External (GPIO pin)</td></tr>
<tr><td><strong>Purpose</strong></td><td>Measure time intervals</td><td>Count external events</td></tr>
<tr><td><strong>Speed</strong></td><td>Fixed by clock</td><td>Variable (event-driven)</td></tr>
<tr><td><strong>Example Use</strong></td><td>Generate 1ms interrupts</td><td>Count encoder pulses</td></tr>
</tbody></table>
</div>
<h3 id="timer-components"><a class="header" href="#timer-components">Timer Components</a></h3>
<ol>
<li><strong>Counter Register</strong>: Stores current count value</li>
<li><strong>Prescaler</strong>: Divides input clock to slow down counting</li>
<li><strong>Compare Register</strong>: Value to trigger events when matched</li>
<li><strong>Auto-reload Register</strong>: Value to reset counter to (for periodic timers)</li>
</ol>
<h3 id="timer-modes"><a class="header" href="#timer-modes">Timer Modes</a></h3>
<ol>
<li><strong>Basic Timer</strong>: Simple counting up or down</li>
<li><strong>PWM Mode</strong>: Generate pulse-width modulated signals</li>
<li><strong>Input Capture</strong>: Measure external signal timing</li>
<li><strong>Output Compare</strong>: Trigger events at specific times</li>
<li><strong>Encoder Mode</strong>: Read quadrature encoders</li>
</ol>
<h2 id="how-it-works-6"><a class="header" href="#how-it-works-6">How It Works</a></h2>
<h3 id="clock-and-prescaler"><a class="header" href="#clock-and-prescaler">Clock and Prescaler</a></h3>
<pre><code>System Clock (16 MHz)
    -&gt;
Prescaler (/256)
    -&gt;
Timer Clock (62.5 kHz)
    -&gt;
Counter increments at 62.5 kHz
</code></pre>
<p><strong>Formula</strong>:</p>
<pre><code>Timer Frequency = CPU Frequency / Prescaler

Timer Period = 1 / Timer Frequency

Overflow Time = (2^bits / Timer Frequency)
</code></pre>
<p><strong>Example</strong> (Arduino Uno - 16 MHz):</p>
<pre><code>Prescaler = 256
Timer Frequency = 16,000,000 / 256 = 62,500 Hz
Timer Period = 1 / 62,500 = 16 us per tick

For 8-bit timer (0-255):
Overflow Time = 256 * 16 us = 4.096 ms

For 16-bit timer (0-65535):
Overflow Time = 65,536 * 16 us = 1.048 seconds
</code></pre>
<h2 id="code-examples-7"><a class="header" href="#code-examples-7">Code Examples</a></h2>
<h3 id="arduino-timer-interrupt"><a class="header" href="#arduino-timer-interrupt">Arduino Timer Interrupt</a></h3>
<pre><code class="language-cpp">// Using Timer1 (16-bit) for 1ms interrupt

volatile unsigned long millisCounter = 0;

void setup() {
  Serial.begin(9600);

  // Stop interrupts during setup
  cli();

  // Reset Timer1
  TCCR1A = 0;
  TCCR1B = 0;
  TCNT1 = 0;

  // Set compare match register for 1ms
  // OCR1A = (16MHz / (prescaler * desired frequency)) - 1
  // OCR1A = (16,000,000 / (64 * 1000)) - 1 = 249
  OCR1A = 249;

  // Turn on CTC mode (Clear Timer on Compare Match)
  TCCR1B |= (1 &lt;&lt; WGM12);

  // Set CS11 and CS10 bits for 64 prescaler
  TCCR1B |= (1 &lt;&lt; CS11) | (1 &lt;&lt; CS10);

  // Enable timer compare interrupt
  TIMSK1 |= (1 &lt;&lt; OCIE1A);

  // Enable global interrupts
  sei();
}

// Timer1 interrupt service routine (ISR)
ISR(TIMER1_COMPA_vect) {
  millisCounter++;

  // Your code here - keep it SHORT!
  // DO NOT use Serial.print() in ISR
}

void loop() {
  // Use millisCounter instead of millis()
  static unsigned long lastPrint = 0;

  if (millisCounter - lastPrint &gt;= 1000) {
    lastPrint = millisCounter;
    Serial.println(millisCounter);
  }
}
</code></pre>
<h3 id="esp32-hardware-timer"><a class="header" href="#esp32-hardware-timer">ESP32 Hardware Timer</a></h3>
<pre><code class="language-cpp">// ESP32 has 4 hardware timers (0-3)

hw_timer_t *timer = NULL;
volatile uint32_t timerCounter = 0;

void IRAM_ATTR onTimer() {
  timerCounter++;
  // Keep ISR short and fast!
}

void setup() {
  Serial.begin(115200);

  // Initialize timer (timer number, prescaler, count up)
  // ESP32 clock is 80 MHz
  // Prescaler of 80 gives 1 MHz (1 tick = 1 us)
  timer = timerBegin(0, 80, true);

  // Attach interrupt function
  timerAttachInterrupt(timer, &amp;onTimer, true);

  // Set alarm to trigger every 1ms (1000 us)
  timerAlarmWrite(timer, 1000, true);  // true = auto-reload

  // Enable timer alarm
  timerAlarmEnable(timer);

  Serial.println("Timer initialized!");
}

void loop() {
  static uint32_t lastCount = 0;

  if (timerCounter - lastCount &gt;= 1000) {
    lastCount = timerCounter;
    Serial.print("Timer count: ");
    Serial.println(timerCounter);
  }
}

// Ticker library (easier alternative)
#include &lt;Ticker.h&gt;

Ticker ticker;
volatile int count = 0;

void timerCallback() {
  count++;
}

void setup() {
  // Call timerCallback every 0.001 seconds (1ms)
  ticker.attach(0.001, timerCallback);
}
</code></pre>
<h3 id="stm32-hal-timer"><a class="header" href="#stm32-hal-timer">STM32 HAL Timer</a></h3>
<pre><code class="language-c">#include "stm32f4xx_hal.h"

TIM_HandleTypeDef htim2;
volatile uint32_t timerTicks = 0;

void Timer_Init(void) {
    TIM_ClockConfigTypeDef sClockSourceConfig = {0};
    TIM_MasterConfigTypeDef sMasterConfig = {0};

    // TIM2 configuration
    // APB1 clock = 84 MHz (for STM32F4)
    // Prescaler = 8400 - 1 -&gt; 10 kHz timer clock
    // Period = 10 - 1 -&gt; 1 kHz interrupt (1ms)

    htim2.Instance = TIM2;
    htim2.Init.Prescaler = 8400 - 1;      // 84 MHz / 8400 = 10 kHz
    htim2.Init.CounterMode = TIM_COUNTERMODE_UP;
    htim2.Init.Period = 10 - 1;           // 10 kHz / 10 = 1 kHz (1ms)
    htim2.Init.ClockDivision = TIM_CLOCKDIVISION_DIV1;
    htim2.Init.AutoReloadPreload = TIM_AUTORELOAD_PRELOAD_DISABLE;
    HAL_TIM_Base_Init(&amp;htim2);

    sClockSourceConfig.ClockSource = TIM_CLOCKSOURCE_INTERNAL;
    HAL_TIM_ConfigClockSource(&amp;htim2, &amp;sClockSourceConfig);

    // Enable timer interrupt
    HAL_TIM_Base_Start_IT(&amp;htim2);
}

// Timer interrupt callback
void HAL_TIM_PeriodElapsedCallback(TIM_HandleTypeDef *htim) {
    if (htim-&gt;Instance == TIM2) {
        timerTicks++;
        // Your periodic code here
    }
}

// In main.c, enable interrupt in NVIC
void MX_TIM2_Init(void) {
    Timer_Init();
    HAL_NVIC_SetPriority(TIM2_IRQn, 0, 0);
    HAL_NVIC_EnableIRQ(TIM2_IRQn);
}
</code></pre>
<h3 id="pwm-generation-with-timers"><a class="header" href="#pwm-generation-with-timers">PWM Generation with Timers</a></h3>
<pre><code class="language-cpp">// Arduino PWM using Timer1

void setup() {
  // Set pins as output
  pinMode(9, OUTPUT);   // OC1A
  pinMode(10, OUTPUT);  // OC1B

  // Stop timer during configuration
  TCCR1A = 0;
  TCCR1B = 0;

  // Fast PWM mode, ICR1 as TOP
  // WGM13:0 = 14 (Fast PWM, TOP = ICR1)
  TCCR1A = (1 &lt;&lt; WGM11);
  TCCR1B = (1 &lt;&lt; WGM13) | (1 &lt;&lt; WGM12);

  // Non-inverting mode for both channels
  TCCR1A |= (1 &lt;&lt; COM1A1) | (1 &lt;&lt; COM1B1);

  // Prescaler = 8
  TCCR1B |= (1 &lt;&lt; CS11);

  // Set TOP value for desired frequency
  // PWM Frequency = F_CPU / (Prescaler * (1 + TOP))
  // For 50 Hz: TOP = 16,000,000 / (8 * 50) - 1 = 39999
  ICR1 = 39999;  // 50 Hz

  // Set duty cycle
  OCR1A = 3000;  // ~7.5% duty cycle on pin 9
  OCR1B = 6000;  // ~15% duty cycle on pin 10
}

// Servo control example
void setServoAngle(uint8_t angle) {
  // Servo expects 1ms-2ms pulse every 20ms (50 Hz)
  // 1ms = 0 degrees = 2000 counts
  // 1.5ms = 90 degrees = 3000 counts
  // 2ms = 180 degrees = 4000 counts

  uint16_t pulse = map(angle, 0, 180, 2000, 4000);
  OCR1A = pulse;
}

void loop() {
  setServoAngle(0);
  delay(1000);
  setServoAngle(90);
  delay(1000);
  setServoAngle(180);
  delay(1000);
}
</code></pre>
<h3 id="input-capture-mode"><a class="header" href="#input-capture-mode">Input Capture Mode</a></h3>
<pre><code class="language-cpp">// Measure frequency of external signal on pin 8 (ICP1)

volatile unsigned long captureTime1 = 0;
volatile unsigned long captureTime2 = 0;
volatile boolean newCapture = false;

void setup() {
  Serial.begin(9600);

  // Configure Timer1 for input capture
  TCCR1A = 0;
  TCCR1B = 0;

  // Prescaler = 64 (250 kHz timer, 4us resolution)
  TCCR1B |= (1 &lt;&lt; CS11) | (1 &lt;&lt; CS10);

  // Input Capture on rising edge
  TCCR1B |= (1 &lt;&lt; ICES1);

  // Enable input capture interrupt
  TIMSK1 |= (1 &lt;&lt; ICIE1);

  // Enable global interrupts
  sei();
}

// Input capture interrupt
ISR(TIMER1_CAPT_vect) {
  static boolean firstCapture = true;

  if (firstCapture) {
    captureTime1 = ICR1;
    firstCapture = false;
  } else {
    captureTime2 = ICR1;
    newCapture = true;
    firstCapture = true;
  }
}

void loop() {
  if (newCapture) {
    newCapture = false;

    // Calculate period
    unsigned long period = captureTime2 - captureTime1;

    // Calculate frequency
    // Timer runs at 250 kHz (4us per tick)
    float frequency = 250000.0 / period;

    Serial.print("Frequency: ");
    Serial.print(frequency);
    Serial.println(" Hz");
  }
}
</code></pre>
<h2 id="common-applications-3"><a class="header" href="#common-applications-3">Common Applications</a></h2>
<h3 id="1-precise-timing-without-delay"><a class="header" href="#1-precise-timing-without-delay">1. Precise Timing Without Delay</a></h3>
<pre><code class="language-cpp">unsigned long previousMillis = 0;
const long interval = 1000;

void loop() {
  unsigned long currentMillis = millis();

  if (currentMillis - previousMillis &gt;= interval) {
    previousMillis = currentMillis;

    // Execute every 1 second without blocking
    toggleLED();
  }

  // Other code runs continuously
  checkSensors();
  processData();
}
</code></pre>
<h3 id="2-multiple-periodic-tasks"><a class="header" href="#2-multiple-periodic-tasks">2. Multiple Periodic Tasks</a></h3>
<pre><code class="language-cpp">volatile uint32_t timerTicks = 0;

ISR(TIMER1_COMPA_vect) {
  timerTicks++;
}

void loop() {
  static uint32_t lastTask1 = 0;
  static uint32_t lastTask2 = 0;
  static uint32_t lastTask3 = 0;

  // Task 1: Every 10ms
  if (timerTicks - lastTask1 &gt;= 10) {
    lastTask1 = timerTicks;
    readSensors();
  }

  // Task 2: Every 100ms
  if (timerTicks - lastTask2 &gt;= 100) {
    lastTask2 = timerTicks;
    updateDisplay();
  }

  // Task 3: Every 1000ms
  if (timerTicks - lastTask3 &gt;= 1000) {
    lastTask3 = timerTicks;
    sendData();
  }
}
</code></pre>
<h3 id="3-watchdog-timer"><a class="header" href="#3-watchdog-timer">3. Watchdog Timer</a></h3>
<pre><code class="language-cpp">#include &lt;avr/wdt.h&gt;

void setup() {
  // Enable watchdog timer (8 second timeout)
  wdt_enable(WDTO_8S);
}

void loop() {
  // Do work
  processData();

  // Reset watchdog (prevent system reset)
  wdt_reset();

  // If code hangs, watchdog resets system after 8 seconds
}
</code></pre>
<h3 id="4-real-time-clock-rtc"><a class="header" href="#4-real-time-clock-rtc">4. Real-Time Clock (RTC)</a></h3>
<pre><code class="language-cpp">// Using timer to maintain time

volatile uint32_t seconds = 0;
volatile uint16_t milliseconds = 0;

ISR(TIMER1_COMPA_vect) {
  milliseconds++;

  if (milliseconds &gt;= 1000) {
    milliseconds = 0;
    seconds++;
  }
}

void getTime(uint8_t *hours, uint8_t *minutes, uint8_t *secs) {
  noInterrupts();
  uint32_t totalSeconds = seconds;
  interrupts();

  *hours = (totalSeconds / 3600) % 24;
  *minutes = (totalSeconds / 60) % 60;
  *secs = totalSeconds % 60;
}
</code></pre>
<h3 id="5-debouncing-buttons"><a class="header" href="#5-debouncing-buttons">5. Debouncing Buttons</a></h3>
<pre><code class="language-cpp">volatile uint32_t timerMs = 0;

ISR(TIMER1_COMPA_vect) {
  timerMs++;
}

const int buttonPin = 2;
const int debounceTime = 50;  // 50ms

bool readButtonDebounced() {
  static uint32_t lastDebounceTime = 0;
  static bool lastButtonState = HIGH;
  static bool buttonState = HIGH;

  bool reading = digitalRead(buttonPin);

  if (reading != lastButtonState) {
    lastDebounceTime = timerMs;
  }

  if ((timerMs - lastDebounceTime) &gt; debounceTime) {
    if (reading != buttonState) {
      buttonState = reading;
      return (buttonState == LOW);  // Return true on button press
    }
  }

  lastButtonState = reading;
  return false;
}
</code></pre>
<h2 id="timer-prescaler-values"><a class="header" href="#timer-prescaler-values">Timer Prescaler Values</a></h2>
<h3 id="avr-arduino-unonanomega"><a class="header" href="#avr-arduino-unonanomega">AVR (Arduino Uno/Nano/Mega)</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Prescaler</th><th>CS12</th><th>CS11</th><th>CS10</th><th>Timer Frequency (16 MHz)</th></tr></thead><tbody>
<tr><td>None</td><td>0</td><td>0</td><td>0</td><td>Stopped</td></tr>
<tr><td>1</td><td>0</td><td>0</td><td>1</td><td>16 MHz</td></tr>
<tr><td>8</td><td>0</td><td>1</td><td>0</td><td>2 MHz</td></tr>
<tr><td>64</td><td>0</td><td>1</td><td>1</td><td>250 kHz</td></tr>
<tr><td>256</td><td>1</td><td>0</td><td>0</td><td>62.5 kHz</td></tr>
<tr><td>1024</td><td>1</td><td>0</td><td>1</td><td>15.625 kHz</td></tr>
</tbody></table>
</div>
<h2 id="best-practices-68"><a class="header" href="#best-practices-68">Best Practices</a></h2>
<h3 id="1-keep-isrs-short-and-fast"><a class="header" href="#1-keep-isrs-short-and-fast">1. Keep ISRs Short and Fast</a></h3>
<pre><code class="language-cpp">// BAD - Don't do this in ISR!
ISR(TIMER1_COMPA_vect) {
  Serial.println("Timer fired");  // Serial is slow!
  delay(100);                      // Blocks other interrupts!
  float result = complexCalculation();  // Takes too long!
}

// GOOD - Set flags, process in main loop
volatile bool timerFlag = false;

ISR(TIMER1_COMPA_vect) {
  timerFlag = true;  // Just set a flag
}

void loop() {
  if (timerFlag) {
    timerFlag = false;
    Serial.println("Timer fired");  // Do slow stuff here
    processData();
  }
}
</code></pre>
<h3 id="2-protect-shared-variables"><a class="header" href="#2-protect-shared-variables">2. Protect Shared Variables</a></h3>
<pre><code class="language-cpp">volatile uint32_t sharedCounter = 0;

ISR(TIMER1_COMPA_vect) {
  sharedCounter++;
}

void loop() {
  // BAD - Not atomic! Can be corrupted if interrupt occurs mid-read
  uint32_t localCopy = sharedCounter;

  // GOOD - Disable interrupts during multi-byte read
  noInterrupts();
  uint32_t localCopy = sharedCounter;
  interrupts();

  Serial.println(localCopy);
}
</code></pre>
<h3 id="3-calculate-timer-values-correctly"><a class="header" href="#3-calculate-timer-values-correctly">3. Calculate Timer Values Correctly</a></h3>
<pre><code class="language-cpp">// Formula for CTC mode:
// Compare Value = (F_CPU / (Prescaler * Desired_Frequency)) - 1

#define F_CPU 16000000UL
#define PRESCALER 64
#define DESIRED_HZ 1000  // 1 kHz

uint16_t compareValue = (F_CPU / (PRESCALER * DESIRED_HZ)) - 1;
// compareValue = (16000000 / (64 * 1000)) - 1 = 249

OCR1A = compareValue;
</code></pre>
<h2 id="common-issues-and-debugging-5"><a class="header" href="#common-issues-and-debugging-5">Common Issues and Debugging</a></h2>
<h3 id="problem-timer-interrupt-not-firing"><a class="header" href="#problem-timer-interrupt-not-firing">Problem: Timer Interrupt Not Firing</a></h3>
<p><strong>Check</strong>:</p>
<ul>
<li>Global interrupts enabled (<code>sei()</code>)</li>
<li>Specific timer interrupt enabled</li>
<li>Prescaler and compare values calculated correctly</li>
<li>Clock source selected</li>
<li>ISR function name matches vector name</li>
</ul>
<h3 id="problem-inaccurate-timing"><a class="header" href="#problem-inaccurate-timing">Problem: Inaccurate Timing</a></h3>
<p><strong>Causes</strong>:</p>
<ul>
<li>Wrong prescaler calculation</li>
<li>Integer overflow in calculations</li>
<li>CPU frequency mismatch</li>
<li>Crystal tolerance</li>
</ul>
<h3 id="problem-system-becomes-unresponsive"><a class="header" href="#problem-system-becomes-unresponsive">Problem: System Becomes Unresponsive</a></h3>
<p><strong>Causes</strong>:</p>
<ul>
<li>ISR takes too long (blocks other code)</li>
<li>Interrupt firing too frequently</li>
<li>Infinite loop in ISR</li>
<li>Nested interrupts causing stack overflow</li>
</ul>
<h2 id="eli10-explain-like-im-10-5"><a class="header" href="#eli10-explain-like-im-10-5">ELI10 (Explain Like I'm 10)</a></h2>
<p>Imagine you have a special alarm clock that can do cool tricks:</p>
<ol>
<li>
<p><strong>Basic Timer</strong>: Counts from 0 to 100, then starts over. Like counting seconds!</p>
</li>
<li>
<p><strong>Prescaler</strong>: Instead of counting every second, you count every 10 seconds. It's like skipping numbers to count slower.</p>
</li>
<li>
<p><strong>Compare Match</strong>: When the count reaches a special number (like 50), the alarm rings! Then it keeps counting.</p>
</li>
<li>
<p><strong>PWM</strong>: The alarm flashes a light on and off really fast. By changing how long it stays on vs off, you can make the light look dimmer or brighter!</p>
</li>
<li>
<p><strong>Input Capture</strong>: You press a button, and the timer remembers what number it was at. Press again, and you can figure out how long between presses!</p>
</li>
</ol>
<p>The coolest part? The timer runs by itself in the background - you don't have to watch it! It's like having a helper that tells you when it's time to do something, while you focus on other tasks.</p>
<h2 id="further-resources-21"><a class="header" href="#further-resources-21">Further Resources</a></h2>
<ul>
<li><a href="https://www.arduino.cc/reference/en/language/functions/interrupts/interrupts/">Arduino Timer Interrupts</a></li>
<li><a href="http://www.protostack.com/blog/2011/01/comprehensive-guide-to-timers-on-avr/">AVR Timers Tutorial</a></li>
<li><a href="https://docs.espressif.com/projects/esp-idf/en/latest/esp32/api-reference/peripherals/timer.html">ESP32 Timer Documentation</a></li>
<li><a href="https://www.st.com/resource/en/application_note/cd00211314-stm32f101xx-and-stm32f103xx-rcc-configuration-examples-stmicroelectronics.pdf">STM32 Timer Cookbook</a></li>
<li><a href="https://docs.arduino.cc/learn/microcontrollers/analog-output">Secrets of Arduino PWM</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="watchdog-timers"><a class="header" href="#watchdog-timers">Watchdog Timers</a></h1>
<p>A Watchdog Timer (WDT) is a hardware or software timer that is used to detect and recover from computer malfunctions. During normal operation, the system regularly resets the watchdog timer to prevent it from elapsing, or "timing out." If the system fails to reset the watchdog timer, it is assumed to be malfunctioning, and corrective actions are taken, such as resetting the system.</p>
<h2 id="key-concepts-27"><a class="header" href="#key-concepts-27">Key Concepts</a></h2>
<ul>
<li><strong>Timeout Period</strong>: The duration for which the watchdog timer runs before it times out. If the timer is not reset within this period, it triggers a system reset or other corrective actions.</li>
<li><strong>Reset Mechanism</strong>: The action taken when the watchdog timer times out. This is typically a system reset, but it can also include other actions like logging an error or entering a safe state.</li>
<li><strong>Feeding the Watchdog</strong>: The process of regularly resetting the watchdog timer to prevent it from timing out. This is also known as "kicking" or "patting" the watchdog.</li>
</ul>
<h2 id="example-usage-2"><a class="header" href="#example-usage-2">Example Usage</a></h2>
<ol>
<li><strong>Embedded Systems</strong>: Watchdog timers are commonly used in embedded systems to ensure that the system can recover from unexpected failures. For example, if a microcontroller stops responding, the watchdog timer can reset it to restore normal operation.</li>
<li><strong>Safety-Critical Applications</strong>: In applications where safety is paramount, such as automotive or medical devices, watchdog timers help ensure that the system can recover from faults and continue to operate safely.</li>
</ol>
<h2 id="conclusion-25"><a class="header" href="#conclusion-25">Conclusion</a></h2>
<p>Watchdog timers are essential components in many systems, providing a mechanism to detect and recover from malfunctions. Understanding how to configure and use watchdog timers is crucial for developing reliable and resilient systems.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="power-management-6"><a class="header" href="#power-management-6">Power Management</a></h1>
<p>Power management refers to the process of managing the power consumption of a device or system to optimize energy efficiency and prolong battery life. It is crucial in various applications, especially in portable devices like smartphones, laptops, and IoT devices.</p>
<h2 id="key-concepts-28"><a class="header" href="#key-concepts-28">Key Concepts</a></h2>
<ul>
<li>
<p><strong>Sleep Modes</strong>: Many devices have different sleep modes that reduce power consumption when the device is not in active use. These modes can range from low-power states to complete shutdowns.</p>
</li>
<li>
<p><strong>Dynamic Voltage and Frequency Scaling (DVFS)</strong>: This technique adjusts the voltage and frequency of a processor based on the workload, allowing for reduced power consumption during low-demand periods.</p>
</li>
<li>
<p><strong>Power Gating</strong>: This method involves shutting off power to certain components of a device when they are not in use, further conserving energy.</p>
</li>
</ul>
<h2 id="applications-17"><a class="header" href="#applications-17">Applications</a></h2>
<p>Power management techniques are widely used in:</p>
<ul>
<li><strong>Mobile Devices</strong>: Extending battery life through efficient power usage.</li>
<li><strong>Data Centers</strong>: Reducing energy costs and improving cooling efficiency.</li>
<li><strong>Embedded Systems</strong>: Ensuring long operational life in battery-powered applications.</li>
</ul>
<h2 id="conclusion-26"><a class="header" href="#conclusion-26">Conclusion</a></h2>
<p>Effective power management is essential for enhancing the performance and longevity of electronic devices. By implementing various techniques, developers can create more energy-efficient systems that meet the demands of modern applications.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="debugging-5"><a class="header" href="#debugging-5">Debugging</a></h1>
<h2 id="logic-analyzer"><a class="header" href="#logic-analyzer">Logic Analyzer</a></h2>
<p>Saleae Logic 8</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="networking-4"><a class="header" href="#networking-4">Networking</a></h1>
<p>Comprehensive networking reference covering protocols, models, and networking fundamentals.</p>
<h2 id="networking-models"><a class="header" href="#networking-models">Networking Models</a></h2>
<h3 id="osi-model"><a class="header" href="#osi-model"><a href="networking/osi_model.html">OSI Model</a></a></h3>
<p>The 7-layer conceptual framework for network communication:</p>
<ul>
<li>Layer 7: Application</li>
<li>Layer 6: Presentation</li>
<li>Layer 5: Session</li>
<li>Layer 4: Transport</li>
<li>Layer 3: Network</li>
<li>Layer 2: Data Link</li>
<li>Layer 1: Physical</li>
</ul>
<h3 id="tcpip-model"><a class="header" href="#tcpip-model"><a href="networking/tcp_ip_model.html">TCP/IP Model</a></a></h3>
<p>The practical 4-layer model used in modern networks:</p>
<ul>
<li>Application Layer</li>
<li>Transport Layer</li>
<li>Internet Layer</li>
<li>Network Access Layer</li>
</ul>
<h2 id="core-protocols"><a class="header" href="#core-protocols">Core Protocols</a></h2>
<h3 id="ipv4-internet-protocol-version-4"><a class="header" href="#ipv4-internet-protocol-version-4"><a href="networking/ipv4.html">IPv4 (Internet Protocol version 4)</a></a></h3>
<ul>
<li>32-bit addressing and packet format</li>
<li>Address classes and private IP ranges</li>
<li>Subnetting and CIDR notation</li>
<li>Routing and fragmentation</li>
<li>NAT (Network Address Translation)</li>
<li>ICMP diagnostics and tools</li>
</ul>
<h3 id="ipv6-internet-protocol-version-6"><a class="header" href="#ipv6-internet-protocol-version-6"><a href="networking/ipv6.html">IPv6 (Internet Protocol version 6)</a></a></h3>
<ul>
<li>128-bit addressing and packet format</li>
<li>Address types (unicast, multicast, anycast)</li>
<li>SLAAC and auto-configuration</li>
<li>Neighbor Discovery Protocol (NDP)</li>
<li>Extension headers</li>
<li>ICMPv6 and transition mechanisms</li>
</ul>
<h3 id="tcp-transmission-control-protocol"><a class="header" href="#tcp-transmission-control-protocol"><a href="networking/tcp.html">TCP (Transmission Control Protocol)</a></a></h3>
<ul>
<li>Reliable, connection-oriented communication</li>
<li>3-way handshake</li>
<li>Flow control and congestion control</li>
<li>Sequence numbers and acknowledgments</li>
<li>Connection termination</li>
</ul>
<h3 id="udp-user-datagram-protocol"><a class="header" href="#udp-user-datagram-protocol"><a href="networking/udp.html">UDP (User Datagram Protocol)</a></a></h3>
<ul>
<li>Fast, connectionless communication</li>
<li>Low overhead (8-byte header)</li>
<li>No reliability guarantees</li>
<li>Use cases: DNS, streaming, gaming, VoIP</li>
<li>Socket programming examples</li>
</ul>
<h3 id="httphttps"><a class="header" href="#httphttps"><a href="networking/http.html">HTTP/HTTPS</a></a></h3>
<ul>
<li>Web communication protocol</li>
<li>Request methods (GET, POST, PUT, DELETE)</li>
<li>Status codes</li>
<li>Headers and caching</li>
<li>Authentication and CORS</li>
<li>REST API design</li>
</ul>
<h2 id="name-resolution"><a class="header" href="#name-resolution">Name Resolution</a></h2>
<h3 id="dns-domain-name-system"><a class="header" href="#dns-domain-name-system"><a href="networking/dns.html">DNS (Domain Name System)</a></a></h3>
<ul>
<li>Translates domain names to IP addresses</li>
<li>DNS hierarchy and record types</li>
<li>Query and response messages</li>
<li>DNS caching and TTL</li>
<li>DNSSEC security</li>
<li>DNS over HTTPS (DoH) and DNS over TLS (DoT)</li>
<li>Public DNS servers</li>
</ul>
<h3 id="mdns-multicast-dns"><a class="header" href="#mdns-multicast-dns"><a href="networking/mdns.html">mDNS (Multicast DNS)</a></a></h3>
<ul>
<li>Zero-configuration networking</li>
<li>Local network name resolution (.local domain)</li>
<li>Service discovery (DNS-SD)</li>
<li>Avahi and Bonjour implementations</li>
<li>Use cases: printers, file sharing, IoT devices</li>
</ul>
<h2 id="nat-traversal"><a class="header" href="#nat-traversal">NAT Traversal</a></h2>
<h3 id="stun-session-traversal-utilities-for-nat"><a class="header" href="#stun-session-traversal-utilities-for-nat"><a href="networking/stun.html">STUN (Session Traversal Utilities for NAT)</a></a></h3>
<ul>
<li>Discovers public IP address and port</li>
<li>Detects NAT type</li>
<li>Enables peer-to-peer connections</li>
<li>Used in WebRTC and VoIP</li>
<li>Message format and examples</li>
<li>Public STUN servers</li>
</ul>
<h3 id="turn-traversal-using-relays-around-nat"><a class="header" href="#turn-traversal-using-relays-around-nat"><a href="networking/turn.html">TURN (Traversal Using Relays around NAT)</a></a></h3>
<ul>
<li>Relays traffic when direct connection fails</li>
<li>Fallback for restrictive NATs and firewalls</li>
<li>Bandwidth-intensive</li>
<li>Used with ICE in WebRTC</li>
<li>Server setup with coturn</li>
<li>Cost considerations</li>
</ul>
<h3 id="ice-interactive-connectivity-establishment"><a class="header" href="#ice-interactive-connectivity-establishment"><a href="networking/ice.html">ICE (Interactive Connectivity Establishment)</a></a></h3>
<ul>
<li>Framework for establishing peer-to-peer connections</li>
<li>Combines STUN and TURN for NAT traversal</li>
<li>Candidate gathering and connectivity checks</li>
<li>Priority-based path selection</li>
<li>Handles symmetric NAT and firewalls</li>
<li>Used by WebRTC and VoIP</li>
</ul>
<h3 id="pcp-port-control-protocol"><a class="header" href="#pcp-port-control-protocol"><a href="networking/pcp.html">PCP (Port Control Protocol)</a></a></h3>
<ul>
<li>Automatic port mapping and firewall control</li>
<li>Successor to NAT-PMP with IPv6 support</li>
<li>MAP and PEER opcodes for different use cases</li>
<li>Works with multiple NATs in path</li>
<li>Third-party mappings and explicit lifetimes</li>
<li>Used by modern applications and IoT</li>
</ul>
<h3 id="nat-pmp-nat-port-mapping-protocol"><a class="header" href="#nat-pmp-nat-port-mapping-protocol"><a href="networking/nat_pmp.html">NAT-PMP (NAT Port Mapping Protocol)</a></a></h3>
<ul>
<li>Simple automatic port forwarding protocol</li>
<li>Lightweight UDP-based (12-16 byte packets)</li>
<li>IPv4 support with time-limited mappings</li>
<li>Developed by Apple, widely deployed</li>
<li>Gateway discovery and external IP detection</li>
<li>Used by BitTorrent, VoIP, and gaming</li>
</ul>
<h2 id="real-time-communication"><a class="header" href="#real-time-communication">Real-Time Communication</a></h2>
<h3 id="websocket"><a class="header" href="#websocket"><a href="networking/websocket.html">WebSocket</a></a></h3>
<ul>
<li>Full-duplex bidirectional communication</li>
<li>Low-latency persistent connections</li>
<li>WebSocket handshake and frame format</li>
<li>Client and server implementations</li>
<li>Use cases: chat, live updates, gaming</li>
<li>Authentication and security</li>
<li>Heartbeat and reconnection strategies</li>
</ul>
<h3 id="webrtc-web-real-time-communication"><a class="header" href="#webrtc-web-real-time-communication"><a href="networking/webrtc.html">WebRTC (Web Real-Time Communication)</a></a></h3>
<ul>
<li>Browser-based peer-to-peer communication</li>
<li>Video, audio, and data channels</li>
<li>getUserMedia API and RTCPeerConnection</li>
<li>Signaling and SDP offer/answer</li>
<li>Media codecs and quality adaptation</li>
<li>Security with mandatory encryption</li>
<li>Simulcast and bandwidth management</li>
</ul>
<h2 id="network-discovery"><a class="header" href="#network-discovery">Network Discovery</a></h2>
<h3 id="upnp-universal-plug-and-play"><a class="header" href="#upnp-universal-plug-and-play"><a href="networking/upnp.html">UPnP (Universal Plug and Play)</a></a></h3>
<ul>
<li>Automatic device discovery</li>
<li>Zero-configuration setup</li>
<li>SSDP (Simple Service Discovery Protocol)</li>
<li>Port forwarding (IGD)</li>
<li>Security considerations</li>
<li>Common device types</li>
</ul>
<h2 id="security-5"><a class="header" href="#security-5">Security</a></h2>
<h3 id="firewalls"><a class="header" href="#firewalls"><a href="networking/firewalls.html">Firewalls</a></a></h3>
<ul>
<li>Packet filtering</li>
<li>Stateful inspection</li>
<li>Application layer firewalls</li>
<li>Next-generation firewalls (NGFW)</li>
<li>iptables, ufw, firewalld configurations</li>
<li>NAT and port forwarding</li>
<li>Firewall architectures (DMZ, screened subnet)</li>
<li>Security best practices</li>
</ul>
<h2 id="quick-reference-14"><a class="header" href="#quick-reference-14">Quick Reference</a></h2>
<h3 id="protocol-port-numbers"><a class="header" href="#protocol-port-numbers">Protocol Port Numbers</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Protocol</th><th>Port</th><th>Transport</th><th>Purpose</th></tr></thead><tbody>
<tr><td><strong>HTTP</strong></td><td>80</td><td>TCP</td><td>Web pages</td></tr>
<tr><td><strong>HTTPS</strong></td><td>443</td><td>TCP</td><td>Secure web</td></tr>
<tr><td><strong>SSH</strong></td><td>22</td><td>TCP</td><td>Secure shell</td></tr>
<tr><td><strong>FTP</strong></td><td>20/21</td><td>TCP</td><td>File transfer</td></tr>
<tr><td><strong>DNS</strong></td><td>53</td><td>UDP/TCP</td><td>Name resolution</td></tr>
<tr><td><strong>DHCP</strong></td><td>67/68</td><td>UDP</td><td>IP configuration</td></tr>
<tr><td><strong>SMTP</strong></td><td>25</td><td>TCP</td><td>Email sending</td></tr>
<tr><td><strong>POP3</strong></td><td>110</td><td>TCP</td><td>Email retrieval</td></tr>
<tr><td><strong>IMAP</strong></td><td>143</td><td>TCP</td><td>Email access</td></tr>
<tr><td><strong>STUN</strong></td><td>3478</td><td>UDP</td><td>NAT discovery</td></tr>
<tr><td><strong>SSDP</strong></td><td>1900</td><td>UDP</td><td>UPnP discovery</td></tr>
<tr><td><strong>mDNS</strong></td><td>5353</td><td>UDP</td><td>Local DNS</td></tr>
</tbody></table>
</div>
<h3 id="common-network-tools"><a class="header" href="#common-network-tools">Common Network Tools</a></h3>
<pre><code class="language-bash"># Connectivity Testing
ping &lt;host&gt;                    # Test reachability
traceroute &lt;host&gt;              # Trace route to host

# DNS Lookup
dig &lt;domain&gt;                   # DNS query
nslookup &lt;domain&gt;              # DNS lookup
host &lt;domain&gt;                  # Simple DNS lookup

# Network Configuration
ifconfig                       # Network interface config (legacy)
ip addr show                   # Show IP addresses
ip route show                  # Show routing table

# Port Scanning
netstat -tuln                  # Show listening ports
ss -tuln                       # Socket statistics
nc -zv &lt;host&gt; &lt;port&gt;           # Check if port is open

# Packet Capture
tcpdump -i any                 # Capture all traffic
tcpdump port 80                # Capture HTTP traffic
wireshark                      # GUI packet analyzer

# Service Discovery
avahi-browse -a                # Browse mDNS services
upnpc -l                       # List UPnP devices
</code></pre>
<h3 id="private-ip-address-ranges"><a class="header" href="#private-ip-address-ranges">Private IP Address Ranges</a></h3>
<pre><code>10.0.0.0        - 10.255.255.255     (10/8 prefix)
172.16.0.0      - 172.31.255.255     (172.16/12 prefix)
192.168.0.0     - 192.168.255.255    (192.168/16 prefix)
</code></pre>
<h3 id="common-subnet-masks"><a class="header" href="#common-subnet-masks">Common Subnet Masks</a></h3>
<div class="table-wrapper"><table><thead><tr><th>CIDR</th><th>Netmask</th><th>Hosts</th><th>Typical Use</th></tr></thead><tbody>
<tr><td>/8</td><td>255.0.0.0</td><td>16,777,214</td><td>Very large networks</td></tr>
<tr><td>/16</td><td>255.255.0.0</td><td>65,534</td><td>Large networks</td></tr>
<tr><td>/24</td><td>255.255.255.0</td><td>254</td><td>Small networks</td></tr>
<tr><td>/30</td><td>255.255.255.252</td><td>2</td><td>Point-to-point links</td></tr>
</tbody></table>
</div>
<h2 id="protocol-relationships"><a class="header" href="#protocol-relationships">Protocol Relationships</a></h2>
<pre><code>Application Layer:
  HTTP, FTP, SMTP, DNS, DHCP, SSH
       |
       v
Transport Layer:
  TCP (reliable) or UDP (fast)
       |
       v
Network Layer:
  IP (routing and addressing)
       |
       v
Data Link Layer:
  Ethernet, WiFi (MAC addresses)
       |
       v
Physical Layer:
  Cables, signals, physical media
</code></pre>
<h2 id="troubleshooting-flow"><a class="header" href="#troubleshooting-flow">Troubleshooting Flow</a></h2>
<pre><code>1. Physical Layer
   - Cable connected?
   - Link lights on?
   -&gt; Use: Visual inspection, ethtool

2. Data Link Layer
   - MAC address correct?
   - Switch working?
   -&gt; Use: arp -a, show mac address-table

3. Network Layer
   - IP address assigned?
   - Can ping gateway?
   - Routing correct?
   -&gt; Use: ip addr, ping, traceroute

4. Transport Layer
   - Port open?
   - Firewall blocking?
   - Service running?
   -&gt; Use: netstat, telnet, nc

5. Application Layer
   - Service configured correctly?
   - Authentication working?
   - Application logs?
   -&gt; Use: curl, application-specific tools
</code></pre>
<h2 id="security-best-practices-8"><a class="header" href="#security-best-practices-8">Security Best Practices</a></h2>
<h3 id="network-segmentation"><a class="header" href="#network-segmentation">Network Segmentation</a></h3>
<ul>
<li>Separate networks by function (guest, IoT, corporate)</li>
<li>Use VLANs for logical separation</li>
<li>Firewall rules between segments</li>
</ul>
<h3 id="access-control"><a class="header" href="#access-control">Access Control</a></h3>
<ul>
<li>Implement firewall rules (default deny)</li>
<li>Use strong authentication</li>
<li>Enable logging and monitoring</li>
<li>Regular security audits</li>
</ul>
<h3 id="encryption-2"><a class="header" href="#encryption-2">Encryption</a></h3>
<ul>
<li>Use HTTPS instead of HTTP</li>
<li>Enable DNS over HTTPS/TLS</li>
<li>Use VPN for remote access</li>
<li>Encrypt sensitive traffic</li>
</ul>
<h3 id="updates-and-patches"><a class="header" href="#updates-and-patches">Updates and Patches</a></h3>
<ul>
<li>Keep firmware updated</li>
<li>Patch vulnerabilities promptly</li>
<li>Disable unused services</li>
<li>Remove default credentials</li>
</ul>
<h2 id="common-scenarios-1"><a class="header" href="#common-scenarios-1">Common Scenarios</a></h2>
<h3 id="home-network-setup"><a class="header" href="#home-network-setup">Home Network Setup</a></h3>
<ol>
<li>Router assigns private IPs (192.168.1.x)</li>
<li>DHCP provides automatic configuration</li>
<li>NAT translates private to public IP</li>
<li>DNS resolves domain names (8.8.8.8)</li>
<li>Devices use mDNS for local discovery</li>
</ol>
<h3 id="webrtc-video-call"><a class="header" href="#webrtc-video-call">WebRTC Video Call</a></h3>
<ol>
<li>STUN discovers public IP addresses</li>
<li>ICE gathers connection candidates</li>
<li>Signaling server exchanges candidates</li>
<li>Direct P2P connection attempted</li>
<li>TURN relay used if P2P fails</li>
</ol>
<h3 id="smart-home-devices"><a class="header" href="#smart-home-devices">Smart Home Devices</a></h3>
<ol>
<li>Devices announce via mDNS (device.local)</li>
<li>UPnP enables automatic port forwarding</li>
<li>Devices discover each other (SSDP)</li>
<li>Control via local network</li>
<li>Cloud connection for remote access</li>
</ol>
<h2 id="further-learning"><a class="header" href="#further-learning">Further Learning</a></h2>
<h3 id="online-resources-1"><a class="header" href="#online-resources-1">Online Resources</a></h3>
<ul>
<li><a href="https://www.wireshark.org/docs/">Wireshark Tutorial</a></li>
<li><a href="http://www.tcpipguide.com/">TCP/IP Guide</a></li>
<li><a href="https://www.comptia.org/certifications/network">Network+ Certification</a></li>
<li><a href="https://www.rfc-editor.org/">RFC Editor</a></li>
</ul>
<h3 id="books-4"><a class="header" href="#books-4">Books</a></h3>
<ul>
<li><em>TCP/IP Illustrated</em> by W. Richard Stevens</li>
<li><em>Computer Networks</em> by Andrew Tanenbaum</li>
<li><em>Network Warrior</em> by Gary Donahue</li>
</ul>
<h3 id="practice"><a class="header" href="#practice">Practice</a></h3>
<ul>
<li>Set up home lab with VirtualBox/VMware</li>
<li>Use Packet Tracer for simulations</li>
<li>Capture and analyze traffic with Wireshark</li>
<li>Configure firewall rules</li>
<li>Set up services (DNS, DHCP, web server)</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="osi-model-open-systems-interconnection"><a class="header" href="#osi-model-open-systems-interconnection">OSI Model (Open Systems Interconnection)</a></h1>
<h2 id="overview-72"><a class="header" href="#overview-72">Overview</a></h2>
<p>The OSI Model is a conceptual framework that standardizes network communication into 7 layers. Each layer has specific responsibilities and communicates with the layers directly above and below it.</p>
<h2 id="the-7-layers"><a class="header" href="#the-7-layers">The 7 Layers</a></h2>
<pre><code>Layer 7: Application    → User applications (HTTP, FTP, SMTP)
Layer 6: Presentation   → Data format, encryption (SSL/TLS)
Layer 5: Session        → Session management
Layer 4: Transport      → End-to-end delivery (TCP, UDP)
Layer 3: Network        → Routing, IP addressing
Layer 2: Data Link      → MAC addressing, switches
Layer 1: Physical       → Physical media, cables, signals
</code></pre>
<h2 id="memory-aids"><a class="header" href="#memory-aids">Memory Aids</a></h2>
<p><strong>Top to Bottom:</strong> All People Seem To Need Data Processing</p>
<p><strong>Bottom to Top:</strong> Please Do Not Throw Sausage Pizza Away</p>
<h2 id="layer-1-physical-layer"><a class="header" href="#layer-1-physical-layer">Layer 1: Physical Layer</a></h2>
<h3 id="purpose-1"><a class="header" href="#purpose-1">Purpose</a></h3>
<p>Transmits raw bits (0s and 1s) over physical media.</p>
<h3 id="responsibilities"><a class="header" href="#responsibilities">Responsibilities</a></h3>
<ul>
<li>Physical connection between devices</li>
<li>Bit transmission and reception</li>
<li>Voltage levels, timing, data rates</li>
<li>Cable specifications</li>
<li>Signal encoding</li>
</ul>
<h3 id="components"><a class="header" href="#components">Components</a></h3>
<ul>
<li><strong>Cables</strong>: Ethernet (Cat5e, Cat6), Fiber optic, Coaxial</li>
<li><strong>Hubs</strong>: Repeat signals to all ports</li>
<li><strong>Repeaters</strong>: Amplify signals</li>
<li><strong>Network Interface Cards (NICs)</strong></li>
</ul>
<h3 id="encoding-examples"><a class="header" href="#encoding-examples">Encoding Examples</a></h3>
<pre><code>Manchester Encoding (Ethernet):
0: High-to-low transition
1: Low-to-high transition

   1     0     1     1     0
  _|‾|_ _‾|_  _|‾|_ _|‾|_ _‾|_
</code></pre>
<h3 id="physical-media-types"><a class="header" href="#physical-media-types">Physical Media Types</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Medium</th><th>Speed</th><th>Distance</th><th>Use Case</th></tr></thead><tbody>
<tr><td><strong>Cat5e</strong></td><td>1 Gbps</td><td>100m</td><td>Ethernet LAN</td></tr>
<tr><td><strong>Cat6</strong></td><td>10 Gbps</td><td>55m</td><td>High-speed LAN</td></tr>
<tr><td><strong>Fiber (MM)</strong></td><td>10 Gbps</td><td>550m</td><td>Building backbone</td></tr>
<tr><td><strong>Fiber (SM)</strong></td><td>100 Gbps</td><td>40km+</td><td>Long distance</td></tr>
<tr><td><strong>WiFi</strong></td><td>1-10 Gbps</td><td>100m</td><td>Wireless LAN</td></tr>
</tbody></table>
</div>
<h3 id="example-bit-transmission"><a class="header" href="#example-bit-transmission">Example: Bit Transmission</a></h3>
<pre><code>Computer A wants to send "Hello" (binary: 01001000...)

Physical Layer:
1. Convert bits to electrical signals
2. Transmit over cable at defined voltage levels
   High voltage (2.5V) = 1
   Low voltage (0V) = 0
3. Receiver samples signals and reconstructs bits
</code></pre>
<h2 id="layer-2-data-link-layer"><a class="header" href="#layer-2-data-link-layer">Layer 2: Data Link Layer</a></h2>
<h3 id="purpose-2"><a class="header" href="#purpose-2">Purpose</a></h3>
<p>Provides node-to-node data transfer with error detection.</p>
<h3 id="responsibilities-1"><a class="header" href="#responsibilities-1">Responsibilities</a></h3>
<ul>
<li>MAC (Media Access Control) addressing</li>
<li>Frame formatting</li>
<li>Error detection (CRC)</li>
<li>Flow control</li>
<li>Media access control</li>
</ul>
<h3 id="sub-layers"><a class="header" href="#sub-layers">Sub-layers</a></h3>
<ul>
<li><strong>LLC</strong> (Logical Link Control): Interface to Network Layer</li>
<li><strong>MAC</strong> (Media Access Control): Access to physical medium</li>
</ul>
<h3 id="components-1"><a class="header" href="#components-1">Components</a></h3>
<ul>
<li><strong>Switches</strong>: Forward frames based on MAC addresses</li>
<li><strong>Bridges</strong>: Connect network segments</li>
<li><strong>Network Interface Cards</strong>: Hardware MAC addresses</li>
</ul>
<h3 id="ethernet-frame-format"><a class="header" href="#ethernet-frame-format">Ethernet Frame Format</a></h3>
<pre><code>Preamble | SFD | Dest MAC | Src MAC | Type | Data | FCS
  7B     | 1B  |   6B     |   6B    | 2B   | 46-1500B | 4B

Preamble: 10101010... (synchronization)
SFD: Start Frame Delimiter (10101011)
Dest MAC: Destination hardware address
Src MAC: Source hardware address
Type: Protocol type (0x0800 = IPv4, 0x86DD = IPv6)
Data: Payload (46-1500 bytes)
FCS: Frame Check Sequence (CRC-32)
</code></pre>
<h3 id="mac-address-format"><a class="header" href="#mac-address-format">MAC Address Format</a></h3>
<pre><code>AA:BB:CC:DD:EE:FF (48 bits / 6 bytes)

AA:BB:CC - OUI (Organizationally Unique Identifier)
           Vendor identification
DD:EE:FF - Device identifier

Example: 00:1A:2B:3C:4D:5E
</code></pre>
<h3 id="example-frame-forwarding"><a class="header" href="#example-frame-forwarding">Example: Frame Forwarding</a></h3>
<pre><code>Switch MAC Address Table:
Port 1: AA:AA:AA:AA:AA:AA
Port 2: BB:BB:BB:BB:BB:BB
Port 3: CC:CC:CC:CC:CC:CC

Frame arrives on Port 1:
  Dest MAC: BB:BB:BB:BB:BB:BB

Switch looks up BB:BB:BB:BB:BB:BB → Port 2
Forwards frame only to Port 2
</code></pre>
<h3 id="arp-address-resolution-protocol"><a class="header" href="#arp-address-resolution-protocol">ARP (Address Resolution Protocol)</a></h3>
<p>Maps IP addresses to MAC addresses:</p>
<pre><code>Host A wants to send to 192.168.1.5

1. Check ARP cache
2. If not found, broadcast ARP request:
   "Who has 192.168.1.5? Tell 192.168.1.10"

3. Host with 192.168.1.5 replies:
   "192.168.1.5 is at AA:BB:CC:DD:EE:FF"

4. Cache the mapping
5. Send frame to AA:BB:CC:DD:EE:FF
</code></pre>
<h2 id="layer-3-network-layer"><a class="header" href="#layer-3-network-layer">Layer 3: Network Layer</a></h2>
<h3 id="purpose-3"><a class="header" href="#purpose-3">Purpose</a></h3>
<p>Routes packets across networks from source to destination.</p>
<h3 id="responsibilities-2"><a class="header" href="#responsibilities-2">Responsibilities</a></h3>
<ul>
<li>Logical addressing (IP addresses)</li>
<li>Routing</li>
<li>Packet forwarding</li>
<li>Fragmentation and reassembly</li>
<li>Error handling (ICMP)</li>
</ul>
<h3 id="components-2"><a class="header" href="#components-2">Components</a></h3>
<ul>
<li><strong>Routers</strong>: Forward packets between networks</li>
<li><strong>Layer 3 Switches</strong>: Routing at hardware speed</li>
</ul>
<h3 id="protocols"><a class="header" href="#protocols">Protocols</a></h3>
<ul>
<li><strong>IP</strong> (IPv4, IPv6): Internet Protocol</li>
<li><strong>ICMP</strong>: Error reporting and diagnostics</li>
<li><strong>OSPF, BGP, RIP</strong>: Routing protocols</li>
</ul>
<h3 id="example-routing-decision"><a class="header" href="#example-routing-decision">Example: Routing Decision</a></h3>
<pre><code>Router receives packet for 10.1.2.5

Routing Table:
  10.1.0.0/16    via 192.168.1.1
  10.1.2.0/24    via 192.168.1.2
  0.0.0.0/0      via 192.168.1.254 (default)

Longest prefix match: 10.1.2.0/24
Forward to 192.168.1.2
</code></pre>
<h3 id="packet-journey-example"><a class="header" href="#packet-journey-example">Packet Journey Example</a></h3>
<pre><code>PC1 (192.168.1.10) → Server (10.0.0.5)

Layer 3 decisions at each hop:
1. PC1: Not local subnet → Send to gateway (192.168.1.1)
2. Router1: Check route → Forward to Router2 (10.0.0.1)
3. Router2: Destination is local → Send to 10.0.0.5
</code></pre>
<h2 id="layer-4-transport-layer"><a class="header" href="#layer-4-transport-layer">Layer 4: Transport Layer</a></h2>
<h3 id="purpose-4"><a class="header" href="#purpose-4">Purpose</a></h3>
<p>Provides end-to-end communication and reliability.</p>
<h3 id="responsibilities-3"><a class="header" href="#responsibilities-3">Responsibilities</a></h3>
<ul>
<li>Segmentation and reassembly</li>
<li>Port addressing</li>
<li>Connection management</li>
<li>Flow control</li>
<li>Error recovery</li>
<li>Multiplexing</li>
</ul>
<h3 id="protocols-1"><a class="header" href="#protocols-1">Protocols</a></h3>
<ul>
<li><strong>TCP</strong>: Reliable, connection-oriented</li>
<li><strong>UDP</strong>: Unreliable, connectionless</li>
</ul>
<h3 id="port-numbers"><a class="header" href="#port-numbers">Port Numbers</a></h3>
<pre><code>Source Port: Identifies sending application
Dest Port: Identifies receiving application

Well-known ports (0-1023):
  80  - HTTP
  443 - HTTPS
  22  - SSH
  53  - DNS

Registered ports (1024-49151):
  3306 - MySQL
  5432 - PostgreSQL

Dynamic ports (49152-65535):
  Ephemeral ports for client connections
</code></pre>
<h3 id="example-tcp-connection"><a class="header" href="#example-tcp-connection">Example: TCP Connection</a></h3>
<pre><code>Client (192.168.1.10:5000) → Server (10.0.0.5:80)

Layer 4 provides:
1. Connection establishment (3-way handshake)
2. Reliable delivery (ACKs, retransmission)
3. Ordering (sequence numbers)
4. Flow control (window size)
5. Connection termination (4-way close)
</code></pre>
<h3 id="multiplexing-example"><a class="header" href="#multiplexing-example">Multiplexing Example</a></h3>
<pre><code>Web browser opens multiple connections:

Tab 1: 192.168.1.10:5000 → google.com:443
Tab 2: 192.168.1.10:5001 → github.com:443
Tab 3: 192.168.1.10:5002 → stackoverflow.com:443

Transport layer demultiplexes based on port
</code></pre>
<h2 id="layer-5-session-layer"><a class="header" href="#layer-5-session-layer">Layer 5: Session Layer</a></h2>
<h3 id="purpose-5"><a class="header" href="#purpose-5">Purpose</a></h3>
<p>Manages sessions (connections) between applications.</p>
<h3 id="responsibilities-4"><a class="header" href="#responsibilities-4">Responsibilities</a></h3>
<ul>
<li>Session establishment, maintenance, termination</li>
<li>Dialog control (half-duplex, full-duplex)</li>
<li>Synchronization</li>
<li>Token management</li>
</ul>
<h3 id="functions-8"><a class="header" href="#functions-8">Functions</a></h3>
<ul>
<li><strong>Authentication</strong>: Verify user credentials</li>
<li><strong>Authorization</strong>: Check permissions</li>
<li><strong>Session restoration</strong>: Resume interrupted sessions</li>
</ul>
<h3 id="examples-1"><a class="header" href="#examples-1">Examples</a></h3>
<p><strong>RPC (Remote Procedure Call):</strong></p>
<pre><code>Client                          Server
  |                                |
  | Session established            |
  |&lt;------------------------------&gt;|
  | Call remote procedure          |
  |-------------------------------&gt;|
  | Maintain session state         |
  |&lt;------------------------------&gt;|
  | Session terminated             |
</code></pre>
<p><strong>NetBIOS:</strong></p>
<ul>
<li>Session management for file/printer sharing</li>
<li>Name registration and resolution</li>
</ul>
<h3 id="synchronization-points"><a class="header" href="#synchronization-points">Synchronization Points</a></h3>
<pre><code>File Transfer with checkpoints:

  0KB -------- 100KB -------- 200KB -------- 300KB
  ^            ^              ^              ^
  Sync 1       Sync 2         Sync 3         Complete

If failure at 250KB:
  Resume from Sync 2 (200KB)
</code></pre>
<h2 id="layer-6-presentation-layer"><a class="header" href="#layer-6-presentation-layer">Layer 6: Presentation Layer</a></h2>
<h3 id="purpose-6"><a class="header" href="#purpose-6">Purpose</a></h3>
<p>Translates data between application and network formats.</p>
<h3 id="responsibilities-5"><a class="header" href="#responsibilities-5">Responsibilities</a></h3>
<ul>
<li>Data format translation</li>
<li>Encryption/decryption</li>
<li>Compression/decompression</li>
<li>Character encoding</li>
</ul>
<h3 id="functions-9"><a class="header" href="#functions-9">Functions</a></h3>
<p><strong>1. Data Translation:</strong></p>
<pre><code>ASCII ↔ EBCDIC
Big-endian ↔ Little-endian
JSON ↔ XML ↔ Binary
</code></pre>
<p><strong>2. Encryption:</strong></p>
<pre><code>Plaintext: "Hello World"
    ↓
SSL/TLS Encryption
    ↓
Ciphertext: "3k#9$mL..."
</code></pre>
<p><strong>3. Compression:</strong></p>
<pre><code>Original: 1000 bytes
    ↓
GZIP Compression
    ↓
Compressed: 300 bytes
</code></pre>
<h3 id="examples-2"><a class="header" href="#examples-2">Examples</a></h3>
<p><strong>SSL/TLS:</strong></p>
<pre><code>Application sends: "GET / HTTP/1.1"
    ↓
Presentation Layer: Encrypts with TLS
    ↓
Transport Layer: Sends encrypted data
</code></pre>
<p><strong>Image Formats:</strong></p>
<ul>
<li>JPEG, PNG, GIF (compressed formats)</li>
<li>Format conversion for display</li>
</ul>
<p><strong>Character Encoding:</strong></p>
<pre><code>String "Hello" in different encodings:
ASCII:  48 65 6C 6C 6F
UTF-8:  48 65 6C 6C 6F
UTF-16: 00 48 00 65 00 6C 00 6C 00 6F
</code></pre>
<h2 id="layer-7-application-layer"><a class="header" href="#layer-7-application-layer">Layer 7: Application Layer</a></h2>
<h3 id="purpose-7"><a class="header" href="#purpose-7">Purpose</a></h3>
<p>Provides network services directly to user applications.</p>
<h3 id="responsibilities-6"><a class="header" href="#responsibilities-6">Responsibilities</a></h3>
<ul>
<li>Application-level protocols</li>
<li>User authentication</li>
<li>Data representation</li>
<li>Resource sharing</li>
</ul>
<h3 id="common-protocols"><a class="header" href="#common-protocols">Common Protocols</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Protocol</th><th>Port</th><th>Purpose</th></tr></thead><tbody>
<tr><td><strong>HTTP/HTTPS</strong></td><td>80/443</td><td>Web browsing</td></tr>
<tr><td><strong>FTP</strong></td><td>20/21</td><td>File transfer</td></tr>
<tr><td><strong>SMTP</strong></td><td>25</td><td>Email sending</td></tr>
<tr><td><strong>POP3</strong></td><td>110</td><td>Email retrieval</td></tr>
<tr><td><strong>IMAP</strong></td><td>143</td><td>Email access</td></tr>
<tr><td><strong>DNS</strong></td><td>53</td><td>Name resolution</td></tr>
<tr><td><strong>DHCP</strong></td><td>67/68</td><td>IP configuration</td></tr>
<tr><td><strong>SSH</strong></td><td>22</td><td>Secure shell</td></tr>
<tr><td><strong>Telnet</strong></td><td>23</td><td>Remote terminal</td></tr>
<tr><td><strong>SNMP</strong></td><td>161</td><td>Network management</td></tr>
</tbody></table>
</div>
<h3 id="example-http-request"><a class="header" href="#example-http-request">Example: HTTP Request</a></h3>
<pre><code>User clicks link in browser

Application Layer (HTTP):
  GET /index.html HTTP/1.1
  Host: example.com

Presentation Layer:
  Encrypt with TLS (HTTPS)

Session Layer:
  Maintain HTTPS session

Transport Layer:
  TCP connection to port 443

Network Layer:
  Route to example.com's IP

Data Link Layer:
  Frame with MAC address

Physical Layer:
  Transmit bits on wire
</code></pre>
<h2 id="data-encapsulation"><a class="header" href="#data-encapsulation">Data Encapsulation</a></h2>
<h3 id="encapsulation-process-sending"><a class="header" href="#encapsulation-process-sending">Encapsulation Process (Sending)</a></h3>
<pre><code>Layer 7: User Data
            ↓
Layer 4: [TCP Header][Data] → Segment
            ↓
Layer 3: [IP Header][TCP Header][Data] → Packet
            ↓
Layer 2: [Eth Header][IP Header][TCP][Data][Eth Trailer] → Frame
            ↓
Layer 1: 010101110101... → Bits
</code></pre>
<h3 id="decapsulation-process-receiving"><a class="header" href="#decapsulation-process-receiving">Decapsulation Process (Receiving)</a></h3>
<pre><code>Layer 1: Receive bits
            ↓
Layer 2: Remove Ethernet header/trailer → Frame
            ↓
Layer 3: Remove IP header → Packet
            ↓
Layer 4: Remove TCP header → Segment
            ↓
Layer 7: Deliver data to application
</code></pre>
<h3 id="pdu-protocol-data-unit-names"><a class="header" href="#pdu-protocol-data-unit-names">PDU (Protocol Data Unit) Names</a></h3>
<pre><code>Layer 7-5: Data
Layer 4:   Segment (TCP) / Datagram (UDP)
Layer 3:   Packet
Layer 2:   Frame
Layer 1:   Bits
</code></pre>
<h2 id="complete-communication-example"><a class="header" href="#complete-communication-example">Complete Communication Example</a></h2>
<h3 id="sending-email-via-smtp"><a class="header" href="#sending-email-via-smtp">Sending Email via SMTP</a></h3>
<pre><code>Layer 7 (Application):
  - SMTP client: "MAIL FROM: alice@example.com"
  - Creates email message

Layer 6 (Presentation):
  - Encode as ASCII
  - Compress if needed
  - Encrypt with TLS

Layer 5 (Session):
  - Establish SMTP session
  - Authenticate with mail server

Layer 4 (Transport):
  - TCP connection to port 25
  - Segment data
  - Add source/dest ports

Layer 3 (Network):
  - Add IP header
  - Source: 192.168.1.10
  - Dest: 10.0.0.5 (mail server)
  - Route to destination

Layer 2 (Data Link):
  - Add MAC addresses
  - Create Ethernet frame
  - Error checking (CRC)

Layer 1 (Physical):
  - Convert to electrical signals
  - Transmit on cable
</code></pre>
<h2 id="troubleshooting-by-layer"><a class="header" href="#troubleshooting-by-layer">Troubleshooting by Layer</a></h2>
<h3 id="layer-1-physical-issues"><a class="header" href="#layer-1-physical-issues">Layer 1 (Physical) Issues</a></h3>
<pre><code>Symptoms: No connectivity, link down
Check:
  - Cable plugged in?
  - Cable damaged?
  - Port lights on?
  - Power on device?

Tools: Visual inspection, cable tester
</code></pre>
<h3 id="layer-2-data-link-issues"><a class="header" href="#layer-2-data-link-issues">Layer 2 (Data Link) Issues</a></h3>
<pre><code>Symptoms: Can't reach other devices on LAN
Check:
  - MAC address conflicts?
  - Switch port errors?
  - VLAN configuration?
  - ARP table correct?

Tools: arp -a, show mac address-table
</code></pre>
<h3 id="layer-3-network-issues"><a class="header" href="#layer-3-network-issues">Layer 3 (Network) Issues</a></h3>
<pre><code>Symptoms: Can't reach remote networks
Check:
  - IP address correct?
  - Subnet mask correct?
  - Gateway configured?
  - Routing table?

Tools: ping, traceroute, ip route
</code></pre>
<h3 id="layer-4-transport-issues"><a class="header" href="#layer-4-transport-issues">Layer 4 (Transport) Issues</a></h3>
<pre><code>Symptoms: Can't connect to specific service
Check:
  - Port open?
  - Firewall blocking?
  - Service running?
  - TCP handshake succeeds?

Tools: telnet, nc (netcat), netstat
</code></pre>
<h3 id="layer-7-application-issues"><a class="header" href="#layer-7-application-issues">Layer 7 (Application) Issues</a></h3>
<pre><code>Symptoms: Service accessible but not working
Check:
  - Application configuration?
  - Authentication failing?
  - Correct protocol version?
  - Application logs?

Tools: curl, application-specific tools
</code></pre>
<h2 id="osi-vs-real-protocols"><a class="header" href="#osi-vs-real-protocols">OSI vs Real Protocols</a></h2>
<h3 id="where-real-protocols-fit"><a class="header" href="#where-real-protocols-fit">Where Real Protocols Fit</a></h3>
<pre><code>OSI Layer          Protocol Examples
---------------------------------------
7 - Application    HTTP, FTP, SMTP, DNS
6 - Presentation   SSL/TLS, JPEG, MPEG
5 - Session        NetBIOS, RPC
4 - Transport      TCP, UDP
3 - Network        IP, ICMP, OSPF, BGP
2 - Data Link      Ethernet, WiFi, PPP
1 - Physical       10BASE-T, 100BASE-TX
</code></pre>
<h3 id="tcpip-model-mapping"><a class="header" href="#tcpip-model-mapping">TCP/IP Model Mapping</a></h3>
<pre><code>OSI Model              TCP/IP Model
-----------------------------------------
7 - Application  
6 - Presentation   → Application
5 - Session      
4 - Transport       → Transport
3 - Network         → Internet
2 - Data Link    
1 - Physical       → Network Access
</code></pre>
<h2 id="benefits-of-layered-approach"><a class="header" href="#benefits-of-layered-approach">Benefits of Layered Approach</a></h2>
<h3 id="1-modularity"><a class="header" href="#1-modularity">1. Modularity</a></h3>
<pre><code>Change one layer without affecting others
Example: Switch from WiFi to Ethernet
         (Only Layer 1/2 change, others unaffected)
</code></pre>
<h3 id="2-standardization"><a class="header" href="#2-standardization">2. Standardization</a></h3>
<pre><code>Multiple vendors can interoperate
Example: Any HTTP client can talk to any HTTP server
</code></pre>
<h3 id="3-troubleshooting"><a class="header" href="#3-troubleshooting">3. Troubleshooting</a></h3>
<pre><code>Systematic approach from bottom up:
1. Physical: Cable OK?
2. Data Link: Connected to switch?
3. Network: Can ping gateway?
4. Transport: Port open?
5. Application: Service running?
</code></pre>
<h3 id="4-development"><a class="header" href="#4-development">4. Development</a></h3>
<pre><code>Developers focus on their layer
Example: Web developer uses HTTP (Layer 7)
         Doesn't need to know about TCP internals
</code></pre>
<h2 id="eli10-16"><a class="header" href="#eli10-16">ELI10</a></h2>
<p>The OSI Model is like sending a letter through the mail:</p>
<p><strong>Layer 7 (Application):</strong> You write a letter</p>
<ul>
<li>What you want to say</li>
</ul>
<p><strong>Layer 6 (Presentation):</strong> You format it nicely</p>
<ul>
<li>Maybe encrypt it (secret code)</li>
<li>Compress it (make it smaller)</li>
</ul>
<p><strong>Layer 5 (Session):</strong> You start a conversation</p>
<ul>
<li>"Dear John" and "Sincerely, Alice"</li>
</ul>
<p><strong>Layer 4 (Transport):</strong> You put it in envelopes</p>
<ul>
<li>Split into pages if too long</li>
<li>Number the pages so they can be reassembled</li>
</ul>
<p><strong>Layer 3 (Network):</strong> You write the address</p>
<ul>
<li>Where it's going</li>
<li>Where it's from</li>
</ul>
<p><strong>Layer 2 (Data Link):</strong> Post office processes it</p>
<ul>
<li>Local post office routing</li>
<li>Check if envelope is damaged</li>
</ul>
<p><strong>Layer 1 (Physical):</strong> The mail truck</p>
<ul>
<li>Physical delivery</li>
<li>Roads, trucks, planes</li>
</ul>
<p>Each layer does its job without worrying about the others!</p>
<h2 id="further-resources-22"><a class="header" href="#further-resources-22">Further Resources</a></h2>
<ul>
<li><a href="https://tools.ietf.org/html/rfc1122">RFC 1122 - Internet Standards</a></li>
<li><a href="https://www.cloudflare.com/learning/ddos/glossary/open-systems-interconnection-model-osi/">OSI Model in Detail</a></li>
<li><a href="https://www.comptia.org/certifications/network">Network+ Certification</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="tcpip-model-1"><a class="header" href="#tcpip-model-1">TCP/IP Model</a></h1>
<h2 id="overview-73"><a class="header" href="#overview-73">Overview</a></h2>
<p>The TCP/IP Model (also called Internet Protocol Suite) is a practical, 4-layer networking model that describes how data is transmitted over the internet. Unlike the OSI Model, which is theoretical, TCP/IP is the actual model used in modern networks.</p>
<h2 id="tcpip-vs-osi-model"><a class="header" href="#tcpip-vs-osi-model">TCP/IP vs OSI Model</a></h2>
<pre><code>OSI Model (7 Layers)           TCP/IP Model (4 Layers)
---------------------------------------------------
7. Application           
6. Presentation              →  4. Application
5. Session               
4. Transport                  →  3. Transport
3. Network                    →  2. Internet
2. Data Link             
1. Physical                  →  1. Network Access
</code></pre>
<h2 id="the-4-layers"><a class="header" href="#the-4-layers">The 4 Layers</a></h2>
<h3 id="layer-1-network-access-link-layer"><a class="header" href="#layer-1-network-access-link-layer">Layer 1: Network Access (Link Layer)</a></h3>
<p><strong>Purpose:</strong> Physical transmission of data on a network</p>
<p><strong>Combines:</strong></p>
<ul>
<li>OSI Physical Layer (Layer 1)</li>
<li>OSI Data Link Layer (Layer 2)</li>
</ul>
<p><strong>Responsibilities:</strong></p>
<ul>
<li>Physical addressing (MAC)</li>
<li>Media access control</li>
<li>Frame formatting</li>
<li>Error detection</li>
<li>Physical transmission</li>
</ul>
<p><strong>Protocols/Technologies:</strong></p>
<ul>
<li>Ethernet (IEEE 802.3)</li>
<li>WiFi (IEEE 802.11)</li>
<li>PPP (Point-to-Point Protocol)</li>
<li>ARP (Address Resolution Protocol)</li>
<li>RARP (Reverse ARP)</li>
</ul>
<p><strong>Example:</strong></p>
<pre><code>Data from Internet Layer

      ↓

Add Ethernet Header:
  [Dest MAC: AA:BB:CC:DD:EE:FF]
  [Src MAC: 11:22:33:44:55:66]
  [Type: 0x0800 (IPv4)]
  [Data]
  [CRC Checksum]

      ↓

Convert to bits and transmit
</code></pre>
<h3 id="layer-2-internet-layer"><a class="header" href="#layer-2-internet-layer">Layer 2: Internet Layer</a></h3>
<p><strong>Purpose:</strong> Routes packets across networks</p>
<p><strong>Equivalent to:</strong> OSI Network Layer (Layer 3)</p>
<p><strong>Responsibilities:</strong></p>
<ul>
<li>Logical addressing (IP)</li>
<li>Routing between networks</li>
<li>Packet forwarding</li>
<li>Fragmentation and reassembly</li>
<li>Error reporting</li>
</ul>
<p><strong>Key Protocols:</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Protocol</th><th>Purpose</th><th>RFC</th></tr></thead><tbody>
<tr><td><strong>IP</strong></td><td>Internet Protocol (IPv4, IPv6)</td><td>RFC 791, 8200</td></tr>
<tr><td><strong>ICMP</strong></td><td>Error reporting, diagnostics</td><td>RFC 792</td></tr>
<tr><td><strong>IGMP</strong></td><td>Multicast group management</td><td>RFC 1112</td></tr>
<tr><td><strong>IPsec</strong></td><td>Security (encryption, authentication)</td><td>RFC 4301</td></tr>
</tbody></table>
</div>
<p><strong>Example: Packet Routing</strong></p>
<pre><code>Source: 192.168.1.10 → Destination: 10.0.0.5

IP Layer adds header:
  [Version: 4]
  [TTL: 64]
  [Protocol: 6 (TCP)]
  [Source IP: 192.168.1.10]
  [Dest IP: 10.0.0.5]
  [Data]

Router at each hop:
1. Decrements TTL
2. Checks routing table
3. Forwards to next hop
4. Recalculates checksum
</code></pre>
<h3 id="layer-3-transport-layer"><a class="header" href="#layer-3-transport-layer">Layer 3: Transport Layer</a></h3>
<p><strong>Purpose:</strong> End-to-end communication between applications</p>
<p><strong>Equivalent to:</strong> OSI Transport Layer (Layer 4)</p>
<p><strong>Responsibilities:</strong></p>
<ul>
<li>Port-based multiplexing</li>
<li>Connection management</li>
<li>Reliability (for TCP)</li>
<li>Flow control</li>
<li>Error recovery</li>
</ul>
<p><strong>Key Protocols:</strong></p>
<h4 id="tcp-transmission-control-protocol-1"><a class="header" href="#tcp-transmission-control-protocol-1">TCP (Transmission Control Protocol)</a></h4>
<p><strong>Characteristics:</strong></p>
<ul>
<li>Connection-oriented</li>
<li>Reliable delivery</li>
<li>Ordered delivery</li>
<li>Flow control</li>
<li>Congestion control</li>
</ul>
<p><strong>TCP Segment:</strong></p>
<pre><code>+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          Source Port          |       Destination Port        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                        Sequence Number                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                    Acknowledgment Number                      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Offset|  Res  |     Flags     |            Window             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|           Checksum            |         Urgent Pointer        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                            Data                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</code></pre>
<p><strong>TCP Connection (3-Way Handshake):</strong></p>
<pre><code>Client                          Server
  |                                |
  | SYN (seq=100)                  |
  |-------------------------------&gt;|
  |                                |
  | SYN-ACK (seq=200, ack=101)     |
  |&lt;-------------------------------|
  |                                |
  | ACK (seq=101, ack=201)         |
  |-------------------------------&gt;|
  |                                |
  | Connection Established         |
</code></pre>
<h4 id="udp-user-datagram-protocol-1"><a class="header" href="#udp-user-datagram-protocol-1">UDP (User Datagram Protocol)</a></h4>
<p><strong>Characteristics:</strong></p>
<ul>
<li>Connectionless</li>
<li>Unreliable</li>
<li>No ordering guarantee</li>
<li>Low overhead</li>
<li>Fast</li>
</ul>
<p><strong>UDP Datagram:</strong></p>
<pre><code>+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          Source Port          |       Destination Port        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|            Length             |           Checksum            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                            Data                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</code></pre>
<p><strong>UDP Communication:</strong></p>
<pre><code>Client                          Server
  |                                |
  | UDP Datagram                   |
  |-------------------------------&gt;|
  |                                |
  | No acknowledgment              |

Fire and forget!
</code></pre>
<h3 id="layer-4-application-layer"><a class="header" href="#layer-4-application-layer">Layer 4: Application Layer</a></h3>
<p><strong>Purpose:</strong> Provides network services to applications</p>
<p><strong>Combines:</strong></p>
<ul>
<li>OSI Application Layer (Layer 7)</li>
<li>OSI Presentation Layer (Layer 6)</li>
<li>OSI Session Layer (Layer 5)</li>
</ul>
<p><strong>Responsibilities:</strong></p>
<ul>
<li>Application-specific protocols</li>
<li>Data formatting</li>
<li>Session management</li>
<li>User authentication</li>
</ul>
<p><strong>Common Protocols:</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Protocol</th><th>Port</th><th>Transport</th><th>Purpose</th></tr></thead><tbody>
<tr><td><strong>HTTP</strong></td><td>80</td><td>TCP</td><td>Web pages</td></tr>
<tr><td><strong>HTTPS</strong></td><td>443</td><td>TCP</td><td>Secure web</td></tr>
<tr><td><strong>FTP</strong></td><td>20/21</td><td>TCP</td><td>File transfer</td></tr>
<tr><td><strong>SFTP</strong></td><td>22</td><td>TCP</td><td>Secure file transfer</td></tr>
<tr><td><strong>SSH</strong></td><td>22</td><td>TCP</td><td>Secure shell</td></tr>
<tr><td><strong>Telnet</strong></td><td>23</td><td>TCP</td><td>Remote terminal</td></tr>
<tr><td><strong>SMTP</strong></td><td>25</td><td>TCP</td><td>Send email</td></tr>
<tr><td><strong>DNS</strong></td><td>53</td><td>UDP/TCP</td><td>Name resolution</td></tr>
<tr><td><strong>DHCP</strong></td><td>67/68</td><td>UDP</td><td>IP configuration</td></tr>
<tr><td><strong>TFTP</strong></td><td>69</td><td>UDP</td><td>Simple file transfer</td></tr>
<tr><td><strong>HTTP/3</strong></td><td>443</td><td>UDP (QUIC)</td><td>Modern web</td></tr>
<tr><td><strong>NTP</strong></td><td>123</td><td>UDP</td><td>Time sync</td></tr>
<tr><td><strong>SNMP</strong></td><td>161/162</td><td>UDP</td><td>Network management</td></tr>
<tr><td><strong>POP3</strong></td><td>110</td><td>TCP</td><td>Email retrieval</td></tr>
<tr><td><strong>IMAP</strong></td><td>143</td><td>TCP</td><td>Email access</td></tr>
<tr><td><strong>RDP</strong></td><td>3389</td><td>TCP</td><td>Remote desktop</td></tr>
</tbody></table>
</div>
<p><strong>Example: HTTP Request</strong></p>
<pre><code>Application Layer creates:

GET /index.html HTTP/1.1
Host: www.example.com
User-Agent: Mozilla/5.0
Accept: text/html

      ↓

Transport Layer (TCP):
  - Add TCP header
  - Source port: 54321
  - Dest port: 80
  - Establish connection

      ↓

Internet Layer (IP):
  - Add IP header
  - Resolve www.example.com to IP
  - Source: 192.168.1.10
  - Dest: 93.184.216.34

      ↓

Network Access Layer:
  - ARP for next hop MAC
  - Add Ethernet frame
  - Transmit bits
</code></pre>
<h2 id="data-encapsulation-in-tcpip"><a class="header" href="#data-encapsulation-in-tcpip">Data Encapsulation in TCP/IP</a></h2>
<h3 id="sending-data"><a class="header" href="#sending-data">Sending Data</a></h3>
<pre><code>Step 1: Application creates data
  "GET /index.html HTTP/1.1\r\n..."

Step 2: Transport Layer adds header
  [TCP Header][HTTP Request] → TCP Segment

Step 3: Internet Layer adds header
  [IP Header][TCP Header][HTTP Request] → IP Packet

Step 4: Network Access adds header/trailer
  [Eth Header][IP][TCP][HTTP][Eth Trailer] → Ethernet Frame

Step 5: Convert to bits
  01001000110101... → Bits on wire
</code></pre>
<h3 id="receiving-data"><a class="header" href="#receiving-data">Receiving Data</a></h3>
<pre><code>Step 1: Receive bits, extract frame
  [Eth Header][IP][TCP][HTTP][Eth Trailer]

Step 2: Check Ethernet checksum, remove header
  [IP Header][TCP Header][HTTP Request]

Step 3: Check IP checksum, route to TCP
  [TCP Header][HTTP Request]

Step 4: Process TCP segment, reassemble
  "GET /index.html HTTP/1.1\r\n..."

Step 5: Deliver to HTTP server application
</code></pre>
<h2 id="complete-communication-example-1"><a class="header" href="#complete-communication-example-1">Complete Communication Example</a></h2>
<h3 id="browsing-a-website"><a class="header" href="#browsing-a-website">Browsing a Website</a></h3>
<pre><code>User types: http://www.example.com

=== Application Layer ===
1. Browser resolves domain name
   DNS Query: "What's the IP of www.example.com?"
   DNS Response: "93.184.216.34"

2. Browser creates HTTP request
   GET / HTTP/1.1
   Host: www.example.com

=== Transport Layer ===
3. TCP connection to port 80
   - 3-way handshake
   - Establish connection
   - Segment data if needed

=== Internet Layer ===
4. Create IP packet
   - Source: 192.168.1.10
   - Dest: 93.184.216.34
   - Protocol: TCP (6)
   - Add to routing queue

5. Routing
   - Check routing table
   - Forward to default gateway
   - Each router forwards packet

=== Network Access Layer ===
6. Resolve next hop MAC (ARP)
   - "Who has 192.168.1.1?"
   - "192.168.1.1 is at AA:BB:CC:DD:EE:FF"

7. Create Ethernet frame
   - Dest MAC: Gateway's MAC
   - Src MAC: PC's MAC
   - Add checksum

8. Transmit on physical medium
   - Convert to electrical signals
   - Send on Ethernet cable

=== Server Processes Request ===
9. Server receives, decapsulates
10. HTTP server processes request
11. Sends response back

=== Browser Receives Response ===
12. Decapsulate all layers
13. Browser renders HTML
</code></pre>
<h2 id="protocol-interactions"><a class="header" href="#protocol-interactions">Protocol Interactions</a></h2>
<h3 id="dns-resolution"><a class="header" href="#dns-resolution">DNS Resolution</a></h3>
<pre><code>Application: DNS client
Transport: UDP port 53
Internet: IP packet to DNS server
Network Access: Ethernet to gateway

Query: www.example.com → 93.184.216.34
</code></pre>
<h3 id="email-sending-smtp"><a class="header" href="#email-sending-smtp">Email Sending (SMTP)</a></h3>
<pre><code>Application: SMTP client (port 25)
Transport: TCP connection
Internet: Route to mail server IP
Network Access: Frame to gateway

MAIL FROM: alice@example.com
RCPT TO: bob@example.com
DATA
Subject: Hello
...
</code></pre>
<h3 id="file-transfer-ftp"><a class="header" href="#file-transfer-ftp">File Transfer (FTP)</a></h3>
<pre><code>Application: FTP client
Transport:
  - Control: TCP port 21
  - Data: TCP port 20
Internet: IP to FTP server
Network Access: Ethernet frames

Commands on port 21:
  USER alice
  PASS secret123
  RETR file.txt

Data transfer on port 20
</code></pre>
<h2 id="port-numbers-1"><a class="header" href="#port-numbers-1">Port Numbers</a></h2>
<h3 id="well-known-ports-0-1023"><a class="header" href="#well-known-ports-0-1023">Well-Known Ports (0-1023)</a></h3>
<p>Require root/admin privileges:</p>
<pre><code>20/21   FTP
22      SSH
23      Telnet
25      SMTP
53      DNS
67/68   DHCP
80      HTTP
110     POP3
143     IMAP
443     HTTPS
</code></pre>
<h3 id="registered-ports-1024-49151"><a class="header" href="#registered-ports-1024-49151">Registered Ports (1024-49151)</a></h3>
<p>For specific services:</p>
<pre><code>3306    MySQL
5432    PostgreSQL
6379    Redis
8080    HTTP alternate
8443    HTTPS alternate
27017   MongoDB
</code></pre>
<h3 id="dynamicprivate-ports-49152-65535"><a class="header" href="#dynamicprivate-ports-49152-65535">Dynamic/Private Ports (49152-65535)</a></h3>
<p>Used by clients for outgoing connections:</p>
<pre><code>Client opens connection:
  Source: 192.168.1.10:54321 (dynamic)
  Dest: 93.184.216.34:80 (well-known)
</code></pre>
<h2 id="tcpip-configuration"><a class="header" href="#tcpip-configuration">TCP/IP Configuration</a></h2>
<h3 id="manual-configuration"><a class="header" href="#manual-configuration">Manual Configuration</a></h3>
<pre><code class="language-bash"># Set IP address
sudo ip addr add 192.168.1.100/24 dev eth0

# Set default gateway
sudo ip route add default via 192.168.1.1

# Set DNS server
echo "nameserver 8.8.8.8" &gt;&gt; /etc/resolv.conf
</code></pre>
<h3 id="dhcp-dynamic-host-configuration-protocol"><a class="header" href="#dhcp-dynamic-host-configuration-protocol">DHCP (Dynamic Host Configuration Protocol)</a></h3>
<pre><code>Client                          DHCP Server
  |                                |
  | DHCP Discover (broadcast)      |
  |-------------------------------&gt;|
  |                                |
  | DHCP Offer                     |
  |&lt;-------------------------------|
  |   IP: 192.168.1.100            |
  |   Netmask: 255.255.255.0       |
  |   Gateway: 192.168.1.1         |
  |   DNS: 8.8.8.8                 |
  |                                |
  | DHCP Request                   |
  |-------------------------------&gt;|
  |                                |
  | DHCP ACK                       |
  |&lt;-------------------------------|
  |                                |

Client now configured with:
  IP Address: 192.168.1.100
  Subnet Mask: 255.255.255.0
  Default Gateway: 192.168.1.1
  DNS Server: 8.8.8.8
  Lease Time: 24 hours
</code></pre>
<h2 id="tcpip-troubleshooting"><a class="header" href="#tcpip-troubleshooting">TCP/IP Troubleshooting</a></h2>
<h3 id="layer-1-network-access"><a class="header" href="#layer-1-network-access">Layer 1: Network Access</a></h3>
<pre><code class="language-bash"># Check physical connection
ip link show
ethtool eth0

# Check link status
cat /sys/class/net/eth0/carrier

Symptoms: No link light, cable unplugged
</code></pre>
<h3 id="layer-2-network-access-data-link"><a class="header" href="#layer-2-network-access-data-link">Layer 2: Network Access (Data Link)</a></h3>
<pre><code class="language-bash"># Check ARP table
arp -a
ip neigh show

# Check switch port
show mac address-table

Symptoms: Can't reach local devices
</code></pre>
<h3 id="layer-3-internet"><a class="header" href="#layer-3-internet">Layer 3: Internet</a></h3>
<pre><code class="language-bash"># Check IP configuration
ip addr show
ifconfig

# Test gateway reachability
ping 192.168.1.1

# Check routing
ip route show
traceroute 8.8.8.8

Symptoms: No internet, can't reach remote hosts
</code></pre>
<h3 id="layer-4-transport"><a class="header" href="#layer-4-transport">Layer 4: Transport</a></h3>
<pre><code class="language-bash"># Check listening ports
netstat -tuln
ss -tuln

# Test port connectivity
telnet example.com 80
nc -zv example.com 80

# Check firewall
iptables -L
ufw status

Symptoms: Connection refused, timeout
</code></pre>
<h3 id="layer-5-application"><a class="header" href="#layer-5-application">Layer 5: Application</a></h3>
<pre><code class="language-bash"># Test HTTP
curl -v http://example.com

# Test DNS
dig example.com
nslookup example.com

# Test SMTP
telnet mail.example.com 25

Symptoms: Service not responding correctly
</code></pre>
<h2 id="tcpip-security"><a class="header" href="#tcpip-security">TCP/IP Security</a></h2>
<h3 id="common-vulnerabilities-2"><a class="header" href="#common-vulnerabilities-2">Common Vulnerabilities</a></h3>
<p><strong>1. IP Spoofing</strong></p>
<pre><code>Attacker sends packets with fake source IP
Victim: 10.0.0.5
Attacker pretends to be: 10.0.0.5
</code></pre>
<p><strong>2. TCP SYN Flood</strong></p>
<pre><code>Attacker sends many SYN packets
Server waits for ACK (never comes)
Server resources exhausted
</code></pre>
<p><strong>3. Man-in-the-Middle</strong></p>
<pre><code>Attacker intercepts traffic between client and server
Can read or modify data
</code></pre>
<h3 id="security-protocols"><a class="header" href="#security-protocols">Security Protocols</a></h3>
<p><strong>IPsec (Internet Protocol Security)</strong></p>
<pre><code>Provides:
  - Authentication Header (AH)
  - Encapsulating Security Payload (ESP)
  - Encryption and authentication

Used for VPNs
</code></pre>
<p><strong>TLS/SSL (Transport Layer Security)</strong></p>
<pre><code>Encrypts application data
Provides:
  - Confidentiality (encryption)
  - Integrity (tampering detection)
  - Authentication (certificates)

Used for HTTPS, SMTPS, etc.
</code></pre>
<h2 id="tcpip-performance-tuning"><a class="header" href="#tcpip-performance-tuning">TCP/IP Performance Tuning</a></h2>
<h3 id="tcp-window-scaling"><a class="header" href="#tcp-window-scaling">TCP Window Scaling</a></h3>
<pre><code>Default window: 65,535 bytes
With scaling: Up to 1 GB

Improves throughput on high-latency links
</code></pre>
<h3 id="tcp-congestion-control-algorithms"><a class="header" href="#tcp-congestion-control-algorithms">TCP Congestion Control Algorithms</a></h3>
<pre><code>- Tahoe: Original algorithm
- Reno: Fast recovery
- CUBIC: Default in Linux (good for high-speed)
- BBR: Google's algorithm (optimal bandwidth)
</code></pre>
<h3 id="monitoring-tcp-performance"><a class="header" href="#monitoring-tcp-performance">Monitoring TCP Performance</a></h3>
<pre><code class="language-bash"># TCP statistics
netstat -s
ss -s

# Per-connection statistics
ss -ti

# Packet captures
tcpdump -i any -w capture.pcap
</code></pre>
<h2 id="eli10-17"><a class="header" href="#eli10-17">ELI10</a></h2>
<p>TCP/IP is how computers talk to each other on the internet:</p>
<p><strong>Layer 1: Network Access (The Road)</strong></p>
<ul>
<li>Physical cables and WiFi</li>
<li>Like the road system for mail delivery</li>
</ul>
<p><strong>Layer 2: Internet (The Address)</strong></p>
<ul>
<li>IP addresses (like street addresses)</li>
<li>Routers (like post offices) send packets the right way</li>
</ul>
<p><strong>Layer 3: Transport (The Envelope)</strong></p>
<ul>
<li>TCP: Certified mail (guaranteed delivery, in order)</li>
<li>UDP: Postcard (fast, but might get lost)</li>
</ul>
<p><strong>Layer 4: Application (The Message)</strong></p>
<ul>
<li>The actual letter you're sending</li>
<li>HTTP for websites, SMTP for email, etc.</li>
</ul>
<p><strong>Example: Loading a website</strong></p>
<ol>
<li>You type www.google.com</li>
<li>DNS finds Google's address (142.250.185.78)</li>
<li>TCP opens a connection (handshake)</li>
<li>HTTP sends "Give me the homepage"</li>
<li>Routers deliver packets to Google</li>
<li>Google sends back the HTML</li>
<li>Your browser shows the page</li>
</ol>
<p>Each layer does its job without worrying about the others!</p>
<h2 id="further-resources-23"><a class="header" href="#further-resources-23">Further Resources</a></h2>
<ul>
<li><a href="https://tools.ietf.org/html/rfc1122">RFC 1122 - Requirements for Internet Hosts</a></li>
<li><a href="https://tools.ietf.org/html/rfc1123">RFC 1123 - Application and Support</a></li>
<li><a href="https://en.wikipedia.org/wiki/TCP/IP_Illustrated">TCP/IP Illustrated by W. Richard Stevens</a></li>
<li><a href="http://www.tcpipguide.com/">TCP/IP Guide</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ip-internet-protocol"><a class="header" href="#ip-internet-protocol">IP (Internet Protocol)</a></h1>
<h2 id="overview-74"><a class="header" href="#overview-74">Overview</a></h2>
<p>IP (Internet Protocol) is the network layer protocol responsible for addressing and routing packets across networks. It provides the addressing scheme that allows devices to find each other on the internet.</p>
<h2 id="ip-versions"><a class="header" href="#ip-versions">IP Versions</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Feature</th><th>IPv4</th><th>IPv6</th></tr></thead><tbody>
<tr><td><strong>Address Size</strong></td><td>32 bits</td><td>128 bits</td></tr>
<tr><td><strong>Address Format</strong></td><td>Decimal (192.168.1.1)</td><td>Hexadecimal (2001:db8::1)</td></tr>
<tr><td><strong>Total Addresses</strong></td><td>~4.3 billion</td><td>340 undecillion</td></tr>
<tr><td><strong>Header Size</strong></td><td>20-60 bytes</td><td>40 bytes (fixed)</td></tr>
<tr><td><strong>Checksum</strong></td><td>Yes</td><td>No (delegated to link layer)</td></tr>
<tr><td><strong>Fragmentation</strong></td><td>By routers</td><td>Source only</td></tr>
<tr><td><strong>Broadcast</strong></td><td>Yes</td><td>No (uses multicast)</td></tr>
<tr><td><strong>Configuration</strong></td><td>Manual or DHCP</td><td>SLAAC or DHCPv6</td></tr>
<tr><td><strong>IPSec</strong></td><td>Optional</td><td>Mandatory</td></tr>
</tbody></table>
</div>
<h2 id="ipv4-packet-format"><a class="header" href="#ipv4-packet-format">IPv4 Packet Format</a></h2>
<pre><code> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|Version|  IHL  |Type of Service|          Total Length         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         Identification        |Flags|      Fragment Offset    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Time to Live |    Protocol   |         Header Checksum       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       Source Address                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                    Destination Address                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                    Options (if IHL &gt; 5)                       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                            Data                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</code></pre>
<h3 id="ipv4-header-fields"><a class="header" href="#ipv4-header-fields">IPv4 Header Fields</a></h3>
<ol>
<li><strong>Version</strong> (4 bits): IP version (4 for IPv4)</li>
<li><strong>IHL</strong> (4 bits): Internet Header Length (5-15, in 32-bit words)</li>
<li><strong>Type of Service</strong> (8 bits): QoS, priority</li>
<li><strong>Total Length</strong> (16 bits): Entire packet size (max 65,535 bytes)</li>
<li><strong>Identification</strong> (16 bits): Fragment identification</li>
<li><strong>Flags</strong> (3 bits):
<ul>
<li>Bit 0: Reserved (must be 0)</li>
<li>Bit 1: Don't Fragment (DF)</li>
<li>Bit 2: More Fragments (MF)</li>
</ul>
</li>
<li><strong>Fragment Offset</strong> (13 bits): Position of fragment</li>
<li><strong>Time to Live (TTL)</strong> (8 bits): Max hops (decremented at each router)</li>
<li><strong>Protocol</strong> (8 bits): Upper layer protocol (6=TCP, 17=UDP, 1=ICMP)</li>
<li><strong>Header Checksum</strong> (16 bits): Error detection for header</li>
<li><strong>Source Address</strong> (32 bits): Sender IP address</li>
<li><strong>Destination Address</strong> (32 bits): Receiver IP address</li>
<li><strong>Options</strong> (variable): Rarely used (security, timestamp, etc.)</li>
</ol>
<h2 id="ipv4-address-classes"><a class="header" href="#ipv4-address-classes">IPv4 Address Classes</a></h2>
<h3 id="traditional-class-system-obsolete-replaced-by-cidr"><a class="header" href="#traditional-class-system-obsolete-replaced-by-cidr">Traditional Class System (Obsolete, replaced by CIDR)</a></h3>
<pre><code>Class A: 0.0.0.0     to 127.255.255.255   /8   (16 million hosts)
         Network: 8 bits, Host: 24 bits

Class B: 128.0.0.0   to 191.255.255.255   /16  (65,536 hosts)
         Network: 16 bits, Host: 16 bits

Class C: 192.0.0.0   to 223.255.255.255   /24  (254 hosts)
         Network: 24 bits, Host: 8 bits

Class D: 224.0.0.0   to 239.255.255.255   (Multicast)

Class E: 240.0.0.0   to 255.255.255.255   (Reserved)
</code></pre>
<h2 id="private-ip-address-ranges-1"><a class="header" href="#private-ip-address-ranges-1">Private IP Address Ranges</a></h2>
<pre><code>10.0.0.0        - 10.255.255.255     (10/8 prefix)
172.16.0.0      - 172.31.255.255     (172.16/12 prefix)
192.168.0.0     - 192.168.255.255    (192.168/16 prefix)

Used in LANs, not routed on internet (NAT required)
</code></pre>
<h2 id="special-ipv4-addresses"><a class="header" href="#special-ipv4-addresses">Special IPv4 Addresses</a></h2>
<pre><code>0.0.0.0/8         - Current network (only valid as source)
127.0.0.0/8       - Loopback (127.0.0.1 = localhost)
169.254.0.0/16    - Link-local (APIPA, auto-config failed)
192.0.2.0/24      - Documentation/examples (TEST-NET-1)
198.18.0.0/15     - Benchmark testing
224.0.0.0/4       - Multicast
255.255.255.255   - Limited broadcast
</code></pre>
<h2 id="cidr-classless-inter-domain-routing"><a class="header" href="#cidr-classless-inter-domain-routing">CIDR (Classless Inter-Domain Routing)</a></h2>
<h3 id="cidr-notation"><a class="header" href="#cidr-notation">CIDR Notation</a></h3>
<pre><code>192.168.1.0/24
            ^^
            Number of network bits

/24 = 255.255.255.0 netmask
24 bits for network, 8 bits for hosts
2^8 - 2 = 254 usable host addresses
</code></pre>
<h3 id="common-subnet-masks-1"><a class="header" href="#common-subnet-masks-1">Common Subnet Masks</a></h3>
<div class="table-wrapper"><table><thead><tr><th>CIDR</th><th>Netmask</th><th>Hosts</th><th>Use Case</th></tr></thead><tbody>
<tr><td><strong>/8</strong></td><td>255.0.0.0</td><td>16,777,214</td><td>Huge networks</td></tr>
<tr><td><strong>/16</strong></td><td>255.255.0.0</td><td>65,534</td><td>Large networks</td></tr>
<tr><td><strong>/24</strong></td><td>255.255.255.0</td><td>254</td><td>Small networks</td></tr>
<tr><td><strong>/25</strong></td><td>255.255.255.128</td><td>126</td><td>Subnet split</td></tr>
<tr><td><strong>/26</strong></td><td>255.255.255.192</td><td>62</td><td>Small subnet</td></tr>
<tr><td><strong>/27</strong></td><td>255.255.255.224</td><td>30</td><td>Very small</td></tr>
<tr><td><strong>/30</strong></td><td>255.255.255.252</td><td>2</td><td>Point-to-point</td></tr>
<tr><td><strong>/32</strong></td><td>255.255.255.255</td><td>1</td><td>Single host</td></tr>
</tbody></table>
</div>
<h3 id="subnet-calculation-example"><a class="header" href="#subnet-calculation-example">Subnet Calculation Example</a></h3>
<pre><code>Network: 192.168.1.0/24

Network Address:    192.168.1.0
First Usable:       192.168.1.1
Last Usable:        192.168.1.254
Broadcast Address:  192.168.1.255
Total Hosts:        256
Usable Hosts:       254
</code></pre>
<h3 id="subnetting-example"><a class="header" href="#subnetting-example">Subnetting Example</a></h3>
<pre><code>Original: 192.168.1.0/24 (254 hosts)

Split into 4 subnets (/26 each):
Subnet 1: 192.168.1.0/26    (192.168.1.1 - 192.168.1.62)
Subnet 2: 192.168.1.64/26   (192.168.1.65 - 192.168.1.126)
Subnet 3: 192.168.1.128/26  (192.168.1.129 - 192.168.1.190)
Subnet 4: 192.168.1.192/26  (192.168.1.193 - 192.168.1.254)

Each subnet: 62 usable hosts
</code></pre>
<h2 id="ipv6-packet-format"><a class="header" href="#ipv6-packet-format">IPv6 Packet Format</a></h2>
<pre><code>+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|Version| Traffic Class |           Flow Label                  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         Payload Length        |  Next Header  |   Hop Limit   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                         Source Address                        +
|                          (128 bits)                           |
+                                                               +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                      Destination Address                      +
|                          (128 bits)                           |
+                                                               +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</code></pre>
<h3 id="ipv6-header-fields-40-bytes-fixed"><a class="header" href="#ipv6-header-fields-40-bytes-fixed">IPv6 Header Fields (40 bytes fixed)</a></h3>
<ol>
<li><strong>Version</strong> (4 bits): IP version (6)</li>
<li><strong>Traffic Class</strong> (8 bits): QoS, similar to ToS in IPv4</li>
<li><strong>Flow Label</strong> (20 bits): QoS flow identification</li>
<li><strong>Payload Length</strong> (16 bits): Data length (excluding header)</li>
<li><strong>Next Header</strong> (8 bits): Protocol type (like IPv4 Protocol field)</li>
<li><strong>Hop Limit</strong> (8 bits): Like IPv4 TTL</li>
<li><strong>Source Address</strong> (128 bits)</li>
<li><strong>Destination Address</strong> (128 bits)</li>
</ol>
<h2 id="ipv6-address-format"><a class="header" href="#ipv6-address-format">IPv6 Address Format</a></h2>
<h3 id="full-representation"><a class="header" href="#full-representation">Full Representation</a></h3>
<pre><code>2001:0db8:0000:0042:0000:8a2e:0370:7334
</code></pre>
<h3 id="compressed-representation"><a class="header" href="#compressed-representation">Compressed Representation</a></h3>
<pre><code># Remove leading zeros
2001:db8:0:42:0:8a2e:370:7334

# Replace consecutive zeros with ::
2001:db8:0:42::8a2e:370:7334

# Loopback
::1  (equivalent to 0:0:0:0:0:0:0:1)

# Unspecified
::  (equivalent to 0:0:0:0:0:0:0:0)
</code></pre>
<h3 id="ipv6-address-types"><a class="header" href="#ipv6-address-types">IPv6 Address Types</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Type</th><th>Prefix</th><th>Example</th><th>Purpose</th></tr></thead><tbody>
<tr><td><strong>Global Unicast</strong></td><td>2000::/3</td><td>2001:db8::1</td><td>Internet routing</td></tr>
<tr><td><strong>Link-Local</strong></td><td>fe80::/10</td><td>fe80::1</td><td>Local network only</td></tr>
<tr><td><strong>Unique Local</strong></td><td>fc00::/7</td><td>fd00::1</td><td>Private (like RFC 1918)</td></tr>
<tr><td><strong>Multicast</strong></td><td>ff00::/8</td><td>ff02::1</td><td>One-to-many</td></tr>
<tr><td><strong>Loopback</strong></td><td>::1/128</td><td>::1</td><td>Localhost</td></tr>
<tr><td><strong>Unspecified</strong></td><td>::/128</td><td>::</td><td>No address</td></tr>
</tbody></table>
</div>
<h3 id="common-ipv6-multicast-addresses"><a class="header" href="#common-ipv6-multicast-addresses">Common IPv6 Multicast Addresses</a></h3>
<pre><code>ff02::1    All nodes on link
ff02::2    All routers on link
ff02::1:2  All DHCP servers
</code></pre>
<h2 id="ip-fragmentation"><a class="header" href="#ip-fragmentation">IP Fragmentation</a></h2>
<h3 id="why-fragmentation"><a class="header" href="#why-fragmentation">Why Fragmentation?</a></h3>
<pre><code>MTU (Maximum Transmission Unit) varies by network:
- Ethernet: 1500 bytes
- WiFi: 2304 bytes
- PPPoE: 1492 bytes

Larger packets must be fragmented to fit MTU
</code></pre>
<h3 id="ipv4-fragmentation-process"><a class="header" href="#ipv4-fragmentation-process">IPv4 Fragmentation Process</a></h3>
<pre><code>Original packet: 3000 bytes (1500 MTU)

Fragment 1:
  Identification: 12345
  Flags: More Fragments (MF) = 1
  Offset: 0
  Data: 1480 bytes

Fragment 2:
  Identification: 12345
  Flags: MF = 1
  Offset: 185 (1480/8)
  Data: 1480 bytes

Fragment 3:
  Identification: 12345
  Flags: MF = 0 (last fragment)
  Offset: 370 (2960/8)
  Data: 40 bytes

Receiver reassembles using Identification and Offset
</code></pre>
<h3 id="dont-fragment-df-flag"><a class="header" href="#dont-fragment-df-flag">Don't Fragment (DF) Flag</a></h3>
<pre><code>DF = 1: Don't fragment, drop if too large
       Send ICMP "Fragmentation Needed" back

Used for Path MTU Discovery
</code></pre>
<h2 id="ip-routing"><a class="header" href="#ip-routing">IP Routing</a></h2>
<h3 id="routing-decision-process"><a class="header" href="#routing-decision-process">Routing Decision Process</a></h3>
<pre><code>1. Check if destination is local (same subnet)
   → Send directly via ARP

2. If not local, find matching route:
   - Check routing table for most specific match
   - Use default gateway if no match

3. Send to next hop router

4. Repeat at each router until destination reached
</code></pre>
<h3 id="example-routing-table"><a class="header" href="#example-routing-table">Example Routing Table</a></h3>
<pre><code>Destination     Gateway         Netmask         Interface
0.0.0.0         192.168.1.1     0.0.0.0         eth0      (Default)
192.168.1.0     0.0.0.0         255.255.255.0   eth0      (Local)
10.0.0.0        192.168.1.254   255.0.0.0       eth0      (Route)
</code></pre>
<h3 id="longest-prefix-match"><a class="header" href="#longest-prefix-match">Longest Prefix Match</a></h3>
<pre><code>Routing table:
  10.0.0.0/8      → Gateway A
  10.1.0.0/16     → Gateway B
  10.1.2.0/24     → Gateway C

Packet to 10.1.2.5:
  Matches all three routes
  Most specific: /24
  → Use Gateway C
</code></pre>
<h2 id="ttl-time-to-live"><a class="header" href="#ttl-time-to-live">TTL (Time to Live)</a></h2>
<h3 id="purpose-8"><a class="header" href="#purpose-8">Purpose</a></h3>
<p>Prevents routing loops by limiting packet lifetime:</p>
<pre><code>Source sets TTL = 64

Router 1: TTL = 63
Router 2: TTL = 62
Router 3: TTL = 61
...
Router N: TTL = 0 → Drop packet, send ICMP "Time Exceeded"
</code></pre>
<h3 id="common-ttl-values"><a class="header" href="#common-ttl-values">Common TTL Values</a></h3>
<pre><code>Linux:    64
Windows:  128
Cisco:    255

Can identify OS based on initial TTL
</code></pre>
<h3 id="traceroute-uses-ttl"><a class="header" href="#traceroute-uses-ttl">Traceroute Uses TTL</a></h3>
<pre><code>Send packet with TTL=1  → Router 1 responds
Send packet with TTL=2  → Router 2 responds
Send packet with TTL=3  → Router 3 responds
...
Maps the path to destination
</code></pre>
<h2 id="ip-commands-and-tools"><a class="header" href="#ip-commands-and-tools">IP Commands and Tools</a></h2>
<h3 id="ifconfig--ip-linux"><a class="header" href="#ifconfig--ip-linux">ifconfig / ip (Linux)</a></h3>
<pre><code class="language-bash"># View IP configuration
ifconfig
ip addr show

# Assign IP address
sudo ifconfig eth0 192.168.1.100 netmask 255.255.255.0
sudo ip addr add 192.168.1.100/24 dev eth0

# Enable/disable interface
sudo ifconfig eth0 up
sudo ip link set eth0 up
</code></pre>
<h3 id="ipconfig-windows"><a class="header" href="#ipconfig-windows">ipconfig (Windows)</a></h3>
<pre><code class="language-cmd"># View IP configuration
ipconfig
ipconfig /all

# Renew DHCP lease
ipconfig /renew

# Release DHCP lease
ipconfig /release
</code></pre>
<h3 id="ping"><a class="header" href="#ping">ping</a></h3>
<pre><code class="language-bash"># Test connectivity (ICMP Echo Request/Reply)
ping 192.168.1.1
ping -c 4 192.168.1.1  # Send 4 packets

# Test with specific packet size
ping -s 1400 192.168.1.1

# Set TTL
ping -t 10 192.168.1.1
</code></pre>
<h3 id="traceroute--tracert"><a class="header" href="#traceroute--tracert">traceroute / tracert</a></h3>
<pre><code class="language-bash"># Linux
traceroute google.com

# Windows
tracert google.com

# UDP traceroute (Linux)
traceroute -U google.com

# ICMP traceroute
traceroute -I google.com
</code></pre>
<h3 id="netstat"><a class="header" href="#netstat">netstat</a></h3>
<pre><code class="language-bash"># Show routing table
netstat -r
route -n

# Show all connections
netstat -an

# Show listening ports
netstat -ln
</code></pre>
<h3 id="ip-route"><a class="header" href="#ip-route">ip route</a></h3>
<pre><code class="language-bash"># Show routing table
ip route show

# Add static route
sudo ip route add 10.0.0.0/8 via 192.168.1.254

# Delete route
sudo ip route del 10.0.0.0/8

# Add default gateway
sudo ip route add default via 192.168.1.1
</code></pre>
<h2 id="nat-network-address-translation"><a class="header" href="#nat-network-address-translation">NAT (Network Address Translation)</a></h2>
<h3 id="why-nat"><a class="header" href="#why-nat">Why NAT?</a></h3>
<pre><code>Problem: IPv4 address exhaustion
Solution: Multiple private IPs share one public IP

Private Network (192.168.1.0/24)
  PC1: 192.168.1.10
  PC2: 192.168.1.11      →  NAT Router  →  Public IP: 203.0.113.5
  PC3: 192.168.1.12              ↓
                          Tracks connections
</code></pre>
<h3 id="nat-types"><a class="header" href="#nat-types">NAT Types</a></h3>
<h4 id="1-source-nat-snat"><a class="header" href="#1-source-nat-snat">1. Source NAT (SNAT)</a></h4>
<pre><code>Outbound translation:
PC (192.168.1.10:5000) → NAT → Internet (203.0.113.5:6000)

Return traffic:
Internet (203.0.113.5:6000) → NAT → PC (192.168.1.10:5000)
</code></pre>
<h4 id="2-destination-nat-dnat--port-forwarding"><a class="header" href="#2-destination-nat-dnat--port-forwarding">2. Destination NAT (DNAT) / Port Forwarding</a></h4>
<pre><code>Internet → Public IP:80 → NAT → Web Server (192.168.1.20:80)

External: 203.0.113.5:80
Internal: 192.168.1.20:80
</code></pre>
<h4 id="3-pat-port-address-translation--nat-overload"><a class="header" href="#3-pat-port-address-translation--nat-overload">3. PAT (Port Address Translation) / NAT Overload</a></h4>
<pre><code>PC1: 192.168.1.10:5000  →  203.0.113.5:6000
PC2: 192.168.1.11:5001  →  203.0.113.5:6001
PC3: 192.168.1.12:5002  →  203.0.113.5:6002

NAT tracks: Internal IP:Port ↔ Public Port
</code></pre>
<h3 id="nat-table-example"><a class="header" href="#nat-table-example">NAT Table Example</a></h3>
<pre><code>Internal IP:Port     External IP:Port    Destination
192.168.1.10:5000    203.0.113.5:6000    8.8.8.8:53
192.168.1.11:5001    203.0.113.5:6001    1.1.1.1:443
192.168.1.10:5002    203.0.113.5:6002    93.184.216.34:80
</code></pre>
<h2 id="icmp-internet-control-message-protocol"><a class="header" href="#icmp-internet-control-message-protocol">ICMP (Internet Control Message Protocol)</a></h2>
<p>Part of IP suite, used for diagnostics and errors:</p>
<h3 id="common-icmp-message-types"><a class="header" href="#common-icmp-message-types">Common ICMP Message Types</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Type</th><th>Code</th><th>Message</th><th>Use</th></tr></thead><tbody>
<tr><td><strong>0</strong></td><td>0</td><td>Echo Reply</td><td>ping response</td></tr>
<tr><td><strong>3</strong></td><td>0</td><td>Dest Network Unreachable</td><td>Routing error</td></tr>
<tr><td><strong>3</strong></td><td>1</td><td>Dest Host Unreachable</td><td>Host down</td></tr>
<tr><td><strong>3</strong></td><td>3</td><td>Dest Port Unreachable</td><td>Port closed</td></tr>
<tr><td><strong>3</strong></td><td>4</td><td>Fragmentation Needed</td><td>MTU discovery</td></tr>
<tr><td><strong>8</strong></td><td>0</td><td>Echo Request</td><td>ping</td></tr>
<tr><td><strong>11</strong></td><td>0</td><td>Time Exceeded</td><td>TTL = 0</td></tr>
<tr><td><strong>30</strong></td><td>0</td><td>Traceroute</td><td>Traceroute packet</td></tr>
</tbody></table>
</div>
<h3 id="ping-icmp-echo-requestreply"><a class="header" href="#ping-icmp-echo-requestreply">Ping (ICMP Echo Request/Reply)</a></h3>
<pre><code>Client                          Server
  |                                |
  | ICMP Echo Request (Type 8)     |
  |-------------------------------&gt;|
  |                                |
  | ICMP Echo Reply (Type 0)       |
  |&lt;-------------------------------|
  |                                |

Measures round-trip time (RTT)
</code></pre>
<h2 id="ip-best-practices"><a class="header" href="#ip-best-practices">IP Best Practices</a></h2>
<h3 id="1-subnet-properly"><a class="header" href="#1-subnet-properly">1. Subnet Properly</a></h3>
<pre><code>Don't use /24 for everything
- Small office: /26 (62 hosts)
- Department: /24 (254 hosts)
- Campus: /16 (65,534 hosts)
</code></pre>
<h3 id="2-reserve-ip-ranges"><a class="header" href="#2-reserve-ip-ranges">2. Reserve IP Ranges</a></h3>
<pre><code>192.168.1.1    - 192.168.1.10    Static (gateway, servers)
192.168.1.11   - 192.168.1.99    Static (printers, APs)
192.168.1.100  - 192.168.1.254   DHCP pool
</code></pre>
<h3 id="3-document-network"><a class="header" href="#3-document-network">3. Document Network</a></h3>
<pre><code>Maintain IP address management (IPAM)
- Which IPs are assigned
- What devices use them
- DHCP ranges
- Static assignments
</code></pre>
<h3 id="4-use-private-ips-internally"><a class="header" href="#4-use-private-ips-internally">4. Use Private IPs Internally</a></h3>
<pre><code>Never use public IPs internally
Use 10.x.x.x, 172.16-31.x.x, or 192.168.x.x
</code></pre>
<h2 id="eli10-18"><a class="header" href="#eli10-18">ELI10</a></h2>
<p>IP addresses are like street addresses for computers:</p>
<p><strong>IPv4 Address (192.168.1.100):</strong></p>
<ul>
<li>Like a home address with 4 numbers</li>
<li>Each number is 0-255</li>
<li>Almost ran out of addresses (like running out of street addresses in a city)</li>
</ul>
<p><strong>IPv6 Address (2001:db8::1):</strong></p>
<ul>
<li>New address system with way more numbers</li>
<li>Like adding ZIP+4 codes, apartment numbers, floor numbers</li>
<li>So many addresses we'll never run out</li>
</ul>
<p><strong>Routing:</strong></p>
<ul>
<li>Routers are like mail sorting facilities</li>
<li>They look at the address and send the packet closer to its destination</li>
<li>Each router knows which direction to send packets</li>
</ul>
<p><strong>Private IPs:</strong></p>
<ul>
<li>Like apartment numbers (Apt 101, 102, 103)</li>
<li>Work inside the building (local network)</li>
<li>NAT is like the building's street address (everyone shares it for mail)</li>
</ul>
<h2 id="further-resources-24"><a class="header" href="#further-resources-24">Further Resources</a></h2>
<ul>
<li><a href="https://tools.ietf.org/html/rfc791">RFC 791 - IPv4 Specification</a></li>
<li><a href="https://tools.ietf.org/html/rfc8200">RFC 8200 - IPv6 Specification</a></li>
<li><a href="https://tools.ietf.org/html/rfc1918">RFC 1918 - Private Address Space</a></li>
<li><a href="https://www.subnet-calculator.com/">Subnet Calculator</a></li>
<li><a href="https://www.ipaddressguide.com/cidr">CIDR to IPv4 Conversion</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ipv4-internet-protocol-version-4-1"><a class="header" href="#ipv4-internet-protocol-version-4-1">IPv4 (Internet Protocol version 4)</a></h1>
<h2 id="overview-75"><a class="header" href="#overview-75">Overview</a></h2>
<p>IPv4 (Internet Protocol version 4) is the fourth version of the Internet Protocol and the first version to be widely deployed. It is the network layer protocol responsible for addressing and routing packets across networks, providing the addressing scheme that allows devices to find each other on the internet.</p>
<h2 id="key-characteristics-2"><a class="header" href="#key-characteristics-2">Key Characteristics</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Feature</th><th>IPv4</th></tr></thead><tbody>
<tr><td><strong>Address Size</strong></td><td>32 bits</td></tr>
<tr><td><strong>Address Format</strong></td><td>Decimal dotted notation (192.168.1.1)</td></tr>
<tr><td><strong>Total Addresses</strong></td><td>~4.3 billion (2³²)</td></tr>
<tr><td><strong>Header Size</strong></td><td>20-60 bytes (variable)</td></tr>
<tr><td><strong>Checksum</strong></td><td>Yes (header checksum)</td></tr>
<tr><td><strong>Fragmentation</strong></td><td>By routers and source</td></tr>
<tr><td><strong>Broadcast</strong></td><td>Yes</td></tr>
<tr><td><strong>Configuration</strong></td><td>Manual or DHCP</td></tr>
<tr><td><strong>IPSec</strong></td><td>Optional</td></tr>
</tbody></table>
</div>
<h2 id="ipv4-packet-format-1"><a class="header" href="#ipv4-packet-format-1">IPv4 Packet Format</a></h2>
<pre><code> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|Version|  IHL  |Type of Service|          Total Length         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         Identification        |Flags|      Fragment Offset    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Time to Live |    Protocol   |         Header Checksum       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       Source Address                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                    Destination Address                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                    Options (if IHL &gt; 5)                       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                            Data                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</code></pre>
<h3 id="ipv4-header-fields-1"><a class="header" href="#ipv4-header-fields-1">IPv4 Header Fields</a></h3>
<ol>
<li><strong>Version</strong> (4 bits): IP version (4 for IPv4)</li>
<li><strong>IHL</strong> (4 bits): Internet Header Length (5-15, in 32-bit words)
<ul>
<li>Minimum: 5 (20 bytes)</li>
<li>Maximum: 15 (60 bytes)</li>
</ul>
</li>
<li><strong>Type of Service</strong> (8 bits): QoS, priority
<ul>
<li>Precedence (3 bits): Priority level</li>
<li>Delay, Throughput, Reliability (3 bits)</li>
<li>Used for traffic prioritization</li>
</ul>
</li>
<li><strong>Total Length</strong> (16 bits): Entire packet size including header (max 65,535 bytes)</li>
<li><strong>Identification</strong> (16 bits): Fragment identification
<ul>
<li>All fragments of the same packet share this value</li>
</ul>
</li>
<li><strong>Flags</strong> (3 bits):
<ul>
<li>Bit 0: Reserved (must be 0)</li>
<li>Bit 1: Don't Fragment (DF) - prevents fragmentation</li>
<li>Bit 2: More Fragments (MF) - indicates more fragments follow</li>
</ul>
</li>
<li><strong>Fragment Offset</strong> (13 bits): Position of fragment in original packet (in 8-byte units)</li>
<li><strong>Time to Live (TTL)</strong> (8 bits): Max hops (decremented at each router)
<ul>
<li>Prevents infinite routing loops</li>
<li>Typical initial values: 64 (Linux), 128 (Windows), 255 (Cisco)</li>
</ul>
</li>
<li><strong>Protocol</strong> (8 bits): Upper layer protocol
<ul>
<li>1 = ICMP</li>
<li>6 = TCP</li>
<li>17 = UDP</li>
</ul>
</li>
<li><strong>Header Checksum</strong> (16 bits): Error detection for header only
<ul>
<li>Recalculated at each hop (because TTL changes)</li>
</ul>
</li>
<li><strong>Source Address</strong> (32 bits): Sender IPv4 address</li>
<li><strong>Destination Address</strong> (32 bits): Receiver IPv4 address</li>
<li><strong>Options</strong> (variable): Rarely used today
<ul>
<li>Security, timestamps, route recording, source routing</li>
</ul>
</li>
</ol>
<h2 id="ipv4-address-classes-1"><a class="header" href="#ipv4-address-classes-1">IPv4 Address Classes</a></h2>
<h3 id="traditional-class-system-obsolete-replaced-by-cidr-1"><a class="header" href="#traditional-class-system-obsolete-replaced-by-cidr-1">Traditional Class System (Obsolete, replaced by CIDR)</a></h3>
<p>The classful addressing system divided the IPv4 address space into five classes (A-E), but this system was wasteful and is now obsolete. It's still useful to understand for historical reasons.</p>
<pre><code>Class A: 0.0.0.0     to 127.255.255.255   /8   (16,777,214 hosts)
         Network: 8 bits, Host: 24 bits
         First bit: 0
         Example: 10.0.0.0/8

Class B: 128.0.0.0   to 191.255.255.255   /16  (65,534 hosts)
         Network: 16 bits, Host: 16 bits
         First two bits: 10
         Example: 172.16.0.0/16

Class C: 192.0.0.0   to 223.255.255.255   /24  (254 hosts)
         Network: 24 bits, Host: 8 bits
         First three bits: 110
         Example: 192.168.1.0/24

Class D: 224.0.0.0   to 239.255.255.255   (Multicast)
         First four bits: 1110
         Used for multicast groups

Class E: 240.0.0.0   to 255.255.255.255   (Reserved)
         First four bits: 1111
         Reserved for experimental use
</code></pre>
<h3 id="why-classes-were-abandoned"><a class="header" href="#why-classes-were-abandoned">Why Classes Were Abandoned</a></h3>
<pre><code>Problem: Wasteful allocation
- Small company needs 300 hosts
  - Class C (/24): Only 254 hosts (too small)
  - Class B (/16): 65,534 hosts (massive waste)

Solution: CIDR (Classless Inter-Domain Routing)
- Flexible subnet sizes
- Better address utilization
</code></pre>
<h2 id="private-ip-address-ranges-2"><a class="header" href="#private-ip-address-ranges-2">Private IP Address Ranges</a></h2>
<p>Private IP addresses are reserved for use in private networks and are not routed on the public internet. Network Address Translation (NAT) is required to access the internet.</p>
<pre><code>10.0.0.0        - 10.255.255.255     (10.0.0.0/8)
                                      16,777,216 addresses
                                      Typically used in large enterprises

172.16.0.0      - 172.31.255.255     (172.16.0.0/12)
                                      1,048,576 addresses
                                      Medium-sized networks

192.168.0.0     - 192.168.255.255    (192.168.0.0/16)
                                      65,536 addresses
                                      Home and small office networks
</code></pre>
<h3 id="advantages-of-private-addresses"><a class="header" href="#advantages-of-private-addresses">Advantages of Private Addresses</a></h3>
<ol>
<li><strong>Address Conservation</strong>: Reuse addresses across different private networks</li>
<li><strong>Security</strong>: Not directly accessible from the internet</li>
<li><strong>Flexibility</strong>: Can use any addressing scheme internally</li>
<li><strong>Cost</strong>: No need to purchase public IP addresses</li>
</ol>
<h2 id="special-ipv4-addresses-1"><a class="header" href="#special-ipv4-addresses-1">Special IPv4 Addresses</a></h2>
<pre><code>0.0.0.0/8         - Current network (only valid as source)
                    Used during boot before IP is configured

127.0.0.0/8       - Loopback addresses
                    127.0.0.1 = localhost (most common)
                    Packets sent to loopback never leave the host

169.254.0.0/16    - Link-local addresses (APIPA)
                    Auto-assigned when DHCP fails
                    169.254.0.0 and 169.254.255.255 reserved

192.0.2.0/24      - Documentation/examples (TEST-NET-1)
198.51.100.0/24   - Documentation (TEST-NET-2)
203.0.113.0/24    - Documentation (TEST-NET-3)
                    Safe to use in documentation, never routed

192.88.99.0/24    - 6to4 Relay Anycast (IPv6 transition)

198.18.0.0/15     - Benchmark testing
                    Network device testing

224.0.0.0/4       - Multicast (Class D)
                    224.0.0.0 - 239.255.255.255

255.255.255.255   - Limited broadcast
                    Sent to all hosts on local network segment
</code></pre>
<h2 id="cidr-classless-inter-domain-routing-1"><a class="header" href="#cidr-classless-inter-domain-routing-1">CIDR (Classless Inter-Domain Routing)</a></h2>
<p>CIDR replaced the classful addressing system, providing flexible subnetting and efficient address allocation.</p>
<h3 id="cidr-notation-1"><a class="header" href="#cidr-notation-1">CIDR Notation</a></h3>
<pre><code>192.168.1.0/24
            ^^
            Number of network bits (subnet mask length)

/24 = 255.255.255.0 netmask
      24 bits for network, 8 bits for hosts
      2^8 = 256 total addresses
      2^8 - 2 = 254 usable host addresses
      (Network address and broadcast address reserved)
</code></pre>
<h3 id="cidr-notation-breakdown"><a class="header" href="#cidr-notation-breakdown">CIDR Notation Breakdown</a></h3>
<pre><code>192.168.1.0/24

Binary:
11000000.10101000.00000001.00000000  (IP address)
11111111.11111111.11111111.00000000  (Subnet mask /24)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
24 network bits (1s)        ^^^^^^^^
                            8 host bits (0s)

Network portion: 192.168.1
Host portion: 0-255
</code></pre>
<h3 id="common-subnet-masks-2"><a class="header" href="#common-subnet-masks-2">Common Subnet Masks</a></h3>
<div class="table-wrapper"><table><thead><tr><th>CIDR</th><th>Netmask</th><th>Wildcard</th><th>Total</th><th>Usable</th><th>Use Case</th></tr></thead><tbody>
<tr><td><strong>/8</strong></td><td>255.0.0.0</td><td>0.255.255.255</td><td>16,777,216</td><td>16,777,214</td><td>Huge networks (Class A)</td></tr>
<tr><td><strong>/12</strong></td><td>255.240.0.0</td><td>0.15.255.255</td><td>1,048,576</td><td>1,048,574</td><td>Large ISPs</td></tr>
<tr><td><strong>/16</strong></td><td>255.255.0.0</td><td>0.0.255.255</td><td>65,536</td><td>65,534</td><td>Large networks (Class B)</td></tr>
<tr><td><strong>/20</strong></td><td>255.255.240.0</td><td>0.0.15.255</td><td>4,096</td><td>4,094</td><td>Medium businesses</td></tr>
<tr><td><strong>/24</strong></td><td>255.255.255.0</td><td>0.0.0.255</td><td>256</td><td>254</td><td>Small networks (Class C)</td></tr>
<tr><td><strong>/25</strong></td><td>255.255.255.128</td><td>0.0.0.127</td><td>128</td><td>126</td><td>Subnet split</td></tr>
<tr><td><strong>/26</strong></td><td>255.255.255.192</td><td>0.0.0.63</td><td>64</td><td>62</td><td>Small subnet</td></tr>
<tr><td><strong>/27</strong></td><td>255.255.255.224</td><td>0.0.0.31</td><td>32</td><td>30</td><td>Very small</td></tr>
<tr><td><strong>/28</strong></td><td>255.255.255.240</td><td>0.0.0.15</td><td>16</td><td>14</td><td>Tiny subnet</td></tr>
<tr><td><strong>/29</strong></td><td>255.255.255.248</td><td>0.0.0.7</td><td>8</td><td>6</td><td>Minimal</td></tr>
<tr><td><strong>/30</strong></td><td>255.255.255.252</td><td>0.0.0.3</td><td>4</td><td>2</td><td>Point-to-point links</td></tr>
<tr><td><strong>/31</strong></td><td>255.255.255.254</td><td>0.0.0.1</td><td>2</td><td>2</td><td>Point-to-point (RFC 3021)</td></tr>
<tr><td><strong>/32</strong></td><td>255.255.255.255</td><td>0.0.0.0</td><td>1</td><td>1</td><td>Single host route</td></tr>
</tbody></table>
</div>
<h3 id="subnet-calculation-example-1"><a class="header" href="#subnet-calculation-example-1">Subnet Calculation Example</a></h3>
<pre><code>Network: 192.168.1.0/24

Binary calculation:
IP:      11000000.10101000.00000001.00000000
Mask:    11111111.11111111.11111111.00000000
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^  Network bits
                                    ^^^^^^^^ Host bits

Network Address:    192.168.1.0      (all host bits = 0)
First Usable:       192.168.1.1      (first host)
Last Usable:        192.168.1.254    (last host)
Broadcast Address:  192.168.1.255    (all host bits = 1)

Total Addresses:    2^8 = 256
Usable Hosts:       256 - 2 = 254
                    (exclude network and broadcast)
</code></pre>
<h3 id="subnet-mask-calculation"><a class="header" href="#subnet-mask-calculation">Subnet Mask Calculation</a></h3>
<p>To calculate subnet mask from CIDR:</p>
<pre><code>/24 in binary:
11111111.11111111.11111111.00000000
^^^^^^^^ ^^^^^^^^ ^^^^^^^^ ^^^^^^^^
255      255      255      0

/26 in binary:
11111111.11111111.11111111.11000000
^^^^^^^^ ^^^^^^^^ ^^^^^^^^ ^^^^^^^^
255      255      255      192

Shortcut:
/24 = 256 - 2^(32-24) = 256 - 2^8 = 256 - 256 = 0 (last octet)
/26 = 256 - 2^(32-26) = 256 - 2^6 = 256 - 64 = 192 (last octet)
</code></pre>
<h3 id="subnetting-example-1"><a class="header" href="#subnetting-example-1">Subnetting Example</a></h3>
<pre><code>Original Network: 192.168.1.0/24 (254 usable hosts)

Requirement: Split into 4 equal subnets

Calculation:
- Need 4 subnets = 2^2 subnets
- Borrow 2 bits from host portion
- New mask: /24 + 2 = /26
- Each subnet: 2^6 = 64 addresses, 62 usable

Result:
Subnet 1: 192.168.1.0/26
  Network:    192.168.1.0
  First Host: 192.168.1.1
  Last Host:  192.168.1.62
  Broadcast:  192.168.1.63

Subnet 2: 192.168.1.64/26
  Network:    192.168.1.64
  First Host: 192.168.1.65
  Last Host:  192.168.1.126
  Broadcast:  192.168.1.127

Subnet 3: 192.168.1.128/26
  Network:    192.168.1.128
  First Host: 192.168.1.129
  Last Host:  192.168.1.190
  Broadcast:  192.168.1.191

Subnet 4: 192.168.1.192/26
  Network:    192.168.1.192
  First Host: 192.168.1.193
  Last Host:  192.168.1.254
  Broadcast:  192.168.1.255
</code></pre>
<h3 id="variable-length-subnet-masking-vlsm"><a class="header" href="#variable-length-subnet-masking-vlsm">Variable Length Subnet Masking (VLSM)</a></h3>
<p>VLSM allows different subnet sizes within the same network:</p>
<pre><code>Main Network: 10.0.0.0/8

Allocations:
Department A (needs 500 hosts): 10.0.0.0/23   (510 hosts)
Department B (needs 200 hosts): 10.0.2.0/24   (254 hosts)
Department C (needs 100 hosts): 10.0.3.0/25   (126 hosts)
Point-to-point link:             10.0.3.128/30 (2 hosts)
Server subnet:                   10.0.4.0/28   (14 hosts)

Benefits:
- Efficient address utilization
- Minimizes waste
- Flexible network design
</code></pre>
<h2 id="ip-fragmentation-1"><a class="header" href="#ip-fragmentation-1">IP Fragmentation</a></h2>
<h3 id="why-fragmentation-1"><a class="header" href="#why-fragmentation-1">Why Fragmentation?</a></h3>
<p>Every network has a Maximum Transmission Unit (MTU) that limits packet size:</p>
<pre><code>Common MTU Values:
- Ethernet: 1500 bytes
- Wi-Fi: 2304 bytes
- PPPoE: 1492 bytes
- VPN: 1400 bytes (varies)
- Jumbo Frames: 9000 bytes

When packet &gt; MTU:
- Must be fragmented to fit
- Or dropped if DF flag is set
</code></pre>
<h3 id="ipv4-fragmentation-process-1"><a class="header" href="#ipv4-fragmentation-process-1">IPv4 Fragmentation Process</a></h3>
<p>Fragmentation can occur at the source or any router along the path:</p>
<pre><code>Original Packet: 3000 bytes data + 20 byte header = 3020 bytes
MTU: 1500 bytes
Data per fragment: 1500 - 20 (header) = 1480 bytes

Fragment 1:
  IP Header (20 bytes)
  Identification: 12345
  Flags: MF = 1 (More Fragments)
  Fragment Offset: 0
  Total Length: 1500
  Data: 1480 bytes

Fragment 2:
  IP Header (20 bytes)
  Identification: 12345
  Flags: MF = 1
  Fragment Offset: 185 (1480/8 = 185)
  Total Length: 1500
  Data: 1480 bytes

Fragment 3:
  IP Header (20 bytes)
  Identification: 12345
  Flags: MF = 0 (Last Fragment)
  Fragment Offset: 370 (2960/8 = 370)
  Total Length: 60
  Data: 40 bytes

Receiver:
1. Receives all three fragments
2. Checks Identification field (12345) to group them
3. Uses Fragment Offset to order them
4. Reassembles when MF = 0 (last fragment received)
</code></pre>
<h3 id="fragment-offset-calculation"><a class="header" href="#fragment-offset-calculation">Fragment Offset Calculation</a></h3>
<pre><code>Fragment Offset is in 8-byte units:

Fragment 1: Offset 0     → Bytes 0-1479
Fragment 2: Offset 185   → Bytes 1480-2959 (185 × 8 = 1480)
Fragment 3: Offset 370   → Bytes 2960-2999 (370 × 8 = 2960)

Why 8-byte units?
- 13 bits for offset = max 8191
- 8191 × 8 = 65,528 bytes
- Covers max IP packet size (65,535 bytes)
</code></pre>
<h3 id="dont-fragment-df-flag-1"><a class="header" href="#dont-fragment-df-flag-1">Don't Fragment (DF) Flag</a></h3>
<pre><code>DF = 0: Allow fragmentation
        Router can fragment if needed

DF = 1: Don't fragment
        Router drops packet if too large
        Sends ICMP "Fragmentation Needed" back to source

        ICMP Type 3, Code 4:
        - Includes MTU of the link
        - Source can adjust packet size

Used for Path MTU Discovery (PMTUD)
</code></pre>
<h3 id="path-mtu-discovery-pmtud"><a class="header" href="#path-mtu-discovery-pmtud">Path MTU Discovery (PMTUD)</a></h3>
<pre><code>Process:
1. Source sends packet with DF=1 and large size
2. If too large, router drops and sends ICMP
3. Source reduces packet size and retries
4. Repeat until packet gets through
5. Source now knows the path MTU

Example:
Source → [MTU 1500] → Router A → [MTU 1400] → Router B → Dest

1. Send 1500-byte packet, DF=1
2. Router B drops it, sends ICMP: "Frag needed, MTU=1400"
3. Source retries with 1400-byte packets
4. Success! Path MTU = 1400
</code></pre>
<h3 id="fragmentation-issues"><a class="header" href="#fragmentation-issues">Fragmentation Issues</a></h3>
<pre><code>Problems:
1. Performance overhead (reassembly)
2. Lost fragment = entire packet lost
3. Difficulty for firewalls/NAT
4. Security concerns (fragment attacks)

Best Practices:
- Avoid fragmentation when possible
- Use TCP MSS clamping
- Enable PMTUD
- Consider smaller packet sizes
</code></pre>
<h2 id="ttl-time-to-live-1"><a class="header" href="#ttl-time-to-live-1">TTL (Time to Live)</a></h2>
<h3 id="purpose-9"><a class="header" href="#purpose-9">Purpose</a></h3>
<p>TTL prevents routing loops by limiting packet lifetime:</p>
<pre><code>Without TTL:
Router A → Router B → Router C → Router A → ...
Packet loops forever, congesting network

With TTL:
Source sets TTL = 64
Router 1: Decrements to 63
Router 2: Decrements to 62
...
Router 64: Decrements to 0
           → Drops packet
           → Sends ICMP "Time Exceeded" to source
</code></pre>
<h3 id="common-ttl-values-1"><a class="header" href="#common-ttl-values-1">Common TTL Values</a></h3>
<p>Different operating systems use different initial TTL values:</p>
<pre><code>Operating System  Initial TTL
Linux             64
Windows           128
Cisco IOS         255
FreeBSD           64
Mac OS X          64
Solaris           255

Security Note:
Can fingerprint OS based on received TTL
Received TTL = Initial TTL - Hop Count
</code></pre>
<h3 id="ttl-example"><a class="header" href="#ttl-example">TTL Example</a></h3>
<pre><code>Packet journey from Source to Destination:

Source (TTL=64)
  |
  v
Router 1 (TTL=63) → Decrements TTL
  |
  v
Router 2 (TTL=62) → Decrements TTL
  |
  v
Router 3 (TTL=61) → Decrements TTL
  |
  v
Destination (TTL=60) → Receives packet

Reverse calculation:
- Received packet with TTL=60
- If initial TTL was 64
- Hop count = 64 - 60 = 4 hops
</code></pre>
<h3 id="traceroute-uses-ttl-1"><a class="header" href="#traceroute-uses-ttl-1">Traceroute Uses TTL</a></h3>
<p>Traceroute maps network paths by manipulating TTL:</p>
<pre><code>How traceroute works:

1. Send packet with TTL=1
   → First router decrements to 0
   → Router drops packet
   → Router sends ICMP "Time Exceeded"
   → We learn first router IP

2. Send packet with TTL=2
   → First router: TTL=1
   → Second router: TTL=0
   → Second router responds
   → We learn second router IP

3. Send packet with TTL=3
   → Continue until destination reached

Result: Map of all routers in path

Example output:
1  192.168.1.1     2ms
2  10.0.0.1        5ms
3  203.0.113.1     10ms
4  93.184.216.34   15ms (destination)
</code></pre>
<h3 id="linux-traceroute-example"><a class="header" href="#linux-traceroute-example">Linux Traceroute Example</a></h3>
<pre><code class="language-bash"># Default (UDP probes)
traceroute google.com

# ICMP probes
traceroute -I google.com

# TCP SYN probes to port 80
traceroute -T -p 80 google.com

# Set max hops
traceroute -m 20 google.com

# Send 3 probes per hop (default)
traceroute -q 3 google.com
</code></pre>
<h3 id="windows-tracert-example"><a class="header" href="#windows-tracert-example">Windows Tracert Example</a></h3>
<pre><code class="language-cmd"># ICMP probes (Windows default)
tracert google.com

# Set max hops
tracert -h 20 google.com

# Don't resolve addresses to hostnames
tracert -d google.com
</code></pre>
<h2 id="ip-routing-1"><a class="header" href="#ip-routing-1">IP Routing</a></h2>
<h3 id="routing-decision-process-1"><a class="header" href="#routing-decision-process-1">Routing Decision Process</a></h3>
<p>When a host needs to send an IP packet:</p>
<pre><code>1. Determine if destination is local:
   - Perform bitwise AND of dest IP and subnet mask
   - Compare with local network address

   Example:
   Local IP: 192.168.1.100/24
   Dest IP:  192.168.1.50

   192.168.1.50 AND 255.255.255.0 = 192.168.1.0 (matches local network)
   → Send directly via ARP

2. If destination is remote:
   - Search routing table for matching route
   - Use longest prefix match algorithm
   - Forward to gateway for that route

3. If no specific route matches:
   - Use default gateway (0.0.0.0/0)

4. If no default gateway:
   - Destination unreachable error
</code></pre>
<h3 id="example-routing-table-1"><a class="header" href="#example-routing-table-1">Example Routing Table</a></h3>
<pre><code>Destination     Gateway         Netmask         Interface   Metric
0.0.0.0         192.168.1.1     0.0.0.0         eth0        100    (Default route)
10.0.0.0        192.168.1.254   255.0.0.0       eth0        10     (Static route)
192.168.1.0     0.0.0.0         255.255.255.0   eth0        0      (Connected)
192.168.2.0     192.168.1.200   255.255.255.0   eth0        20     (Static route)
172.16.0.0      192.168.1.254   255.255.0.0     eth0        15     (Static route)
</code></pre>
<h3 id="routing-table-lookup"><a class="header" href="#routing-table-lookup">Routing Table Lookup</a></h3>
<pre><code>Packet destination: 10.1.2.5

Routing table:
  0.0.0.0/0       → Gateway A    (Default route)
  10.0.0.0/8      → Gateway B    (Matches!)
  10.1.0.0/16     → Gateway C    (Matches! More specific)
  10.1.2.0/24     → Gateway D    (Matches! Most specific)
  192.168.1.0/24  → Local        (No match)

Longest Prefix Match Algorithm:
- All routes compared
- Most specific match wins (/24 &gt; /16 &gt; /8 &gt; /0)
- Forward to Gateway D
</code></pre>
<h3 id="viewing-routing-table"><a class="header" href="#viewing-routing-table">Viewing Routing Table</a></h3>
<pre><code class="language-bash"># Linux - traditional
route -n
netstat -rn

# Linux - modern
ip route show
ip route list

# Windows
route print
netstat -r

# Example output (Linux):
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
0.0.0.0         192.168.1.1     0.0.0.0         UG    100    0        0 eth0
192.168.1.0     0.0.0.0         255.255.255.0   U     0      0        0 eth0
</code></pre>
<h2 id="nat-network-address-translation-1"><a class="header" href="#nat-network-address-translation-1">NAT (Network Address Translation)</a></h2>
<h3 id="why-nat-1"><a class="header" href="#why-nat-1">Why NAT?</a></h3>
<pre><code>Problem: IPv4 Address Exhaustion
- Only ~4.3 billion addresses
- Internet growth exceeded availability
- Need to conserve public IP addresses

Solution: NAT
- Private network uses private IPs (10.x, 172.16-31.x, 192.168.x)
- Single public IP shared by many devices
- Router translates between private and public
</code></pre>
<h3 id="how-nat-works"><a class="header" href="#how-nat-works">How NAT Works</a></h3>
<pre><code>Private Network (192.168.1.0/24)
┌──────────────────────────────┐
│  PC1: 192.168.1.10           │
│  PC2: 192.168.1.11           │──→  NAT Router  ──→  Internet
│  PC3: 192.168.1.12           │     (Translates)      Public IP: 203.0.113.5
└──────────────────────────────┘

Outbound:
PC1 (192.168.1.10:5000) → NAT → Internet as (203.0.113.5:6000)

Inbound:
Internet → (203.0.113.5:6000) → NAT → PC1 (192.168.1.10:5000)

NAT maintains translation table to track connections
</code></pre>
<h3 id="nat-types-1"><a class="header" href="#nat-types-1">NAT Types</a></h3>
<h4 id="1-static-nat-one-to-one"><a class="header" href="#1-static-nat-one-to-one">1. Static NAT (One-to-One)</a></h4>
<pre><code>One private IP ↔ One public IP

Configuration:
Private: 192.168.1.10  ↔  Public: 203.0.113.10
Private: 192.168.1.11  ↔  Public: 203.0.113.11

Use case:
- Web servers
- Mail servers
- Devices that need incoming connections
</code></pre>
<h4 id="2-dynamic-nat-many-to-many"><a class="header" href="#2-dynamic-nat-many-to-many">2. Dynamic NAT (Many-to-Many)</a></h4>
<pre><code>Multiple private IPs ↔ Pool of public IPs

Configuration:
Private: 192.168.1.0/24
Public pool: 203.0.113.10 - 203.0.113.20

Connection:
PC1 (192.168.1.10) → Gets 203.0.113.10
PC2 (192.168.1.11) → Gets 203.0.113.11
PC3 (192.168.1.12) → Gets 203.0.113.12

When PC1 disconnects, 203.0.113.10 returns to pool
</code></pre>
<h4 id="3-pat-port-address-translation--nat-overload-1"><a class="header" href="#3-pat-port-address-translation--nat-overload-1">3. PAT (Port Address Translation) / NAT Overload</a></h4>
<p>Most common type, used in home routers:</p>
<pre><code>Many private IPs ↔ Single public IP (different ports)

Translation table:
Internal IP:Port      External IP:Port    Remote IP:Port
192.168.1.10:5000  →  203.0.113.5:6000 →  8.8.8.8:53
192.168.1.11:5001  →  203.0.113.5:6001 →  1.1.1.1:443
192.168.1.12:5002  →  203.0.113.5:6002 →  93.184.216.34:80
192.168.1.10:5003  →  203.0.113.5:6003 →  142.250.185.46:443

Note: Same internal IP can have multiple external ports
</code></pre>
<h4 id="4-port-forwarding-dnat---destination-nat"><a class="header" href="#4-port-forwarding-dnat---destination-nat">4. Port Forwarding (DNAT - Destination NAT)</a></h4>
<p>Allow external connections to internal servers:</p>
<pre><code>Configuration:
External: 203.0.113.5:80   → Internal: 192.168.1.20:80  (Web)
External: 203.0.113.5:443  → Internal: 192.168.1.20:443 (HTTPS)
External: 203.0.113.5:22   → Internal: 192.168.1.25:22  (SSH)
External: 203.0.113.5:3389 → Internal: 192.168.1.30:3389 (RDP)

Internet request to 203.0.113.5:80
→ Router forwards to 192.168.1.20:80
→ Web server responds
→ Router translates source back to 203.0.113.5:80
</code></pre>
<h3 id="nat-translation-table-example"><a class="header" href="#nat-translation-table-example">NAT Translation Table Example</a></h3>
<pre><code>Protocol  Inside Local      Inside Global     Outside Local     Outside Global
TCP       192.168.1.10:5000 203.0.113.5:6000  8.8.8.8:53        8.8.8.8:53
TCP       192.168.1.11:5001 203.0.113.5:6001  1.1.1.1:443       1.1.1.1:443
TCP       192.168.1.10:5002 203.0.113.5:6002  93.184.216.34:80  93.184.216.34:80

Terminology:
- Inside Local: Private IP (before NAT)
- Inside Global: Public IP (after NAT)
- Outside Local: Remote IP (before NAT)
- Outside Global: Remote IP (after NAT)
</code></pre>
<h3 id="nat-configuration-examples"><a class="header" href="#nat-configuration-examples">NAT Configuration Examples</a></h3>
<h4 id="linux-iptables"><a class="header" href="#linux-iptables">Linux (iptables)</a></h4>
<pre><code class="language-bash"># Enable IP forwarding
echo 1 &gt; /proc/sys/net/ipv4/ip_forward

# Basic NAT (masquerade)
iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE

# Or with specific IP
iptables -t nat -A POSTROUTING -o eth0 -j SNAT --to-source 203.0.113.5

# Port forwarding
iptables -t nat -A PREROUTING -i eth0 -p tcp --dport 80 \
  -j DNAT --to-destination 192.168.1.20:80

# View NAT table
iptables -t nat -L -v
</code></pre>
<h4 id="cisco-router"><a class="header" href="#cisco-router">Cisco Router</a></h4>
<pre><code class="language-cisco">! Enable NAT
interface GigabitEthernet0/0
  ip nat outside

interface GigabitEthernet0/1
  ip nat inside

! NAT overload (PAT)
ip nat inside source list 1 interface GigabitEthernet0/0 overload
access-list 1 permit 192.168.1.0 0.0.0.255

! Port forwarding
ip nat inside source static tcp 192.168.1.20 80 203.0.113.5 80

! View NAT translations
show ip nat translations
show ip nat statistics
</code></pre>
<h3 id="nat-disadvantages"><a class="header" href="#nat-disadvantages">NAT Disadvantages</a></h3>
<pre><code>1. Breaks end-to-end connectivity
   - Some protocols don't work (FTP active mode, SIP, H.323)
   - Requires ALG (Application Layer Gateway) for some apps

2. Performance overhead
   - Translation takes CPU time
   - Maintains state tables

3. Complicates peer-to-peer
   - NAT traversal techniques needed (STUN, TURN, ICE)

4. Hides internal topology
   - All traffic appears from one IP
   - Makes troubleshooting harder

5. Limited by port numbers
   - 65,535 ports per public IP
   - In practice, ~4000 concurrent connections
</code></pre>
<h2 id="icmp-internet-control-message-protocol-1"><a class="header" href="#icmp-internet-control-message-protocol-1">ICMP (Internet Control Message Protocol)</a></h2>
<p>ICMP is a network layer protocol used for diagnostics and error reporting. It's an integral part of IP.</p>
<h3 id="icmp-message-format"><a class="header" href="#icmp-message-format">ICMP Message Format</a></h3>
<pre><code> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Type      |     Code      |          Checksum             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
|                         Message Body                          |
|                         (varies by type)                      |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</code></pre>
<h3 id="common-icmp-message-types-1"><a class="header" href="#common-icmp-message-types-1">Common ICMP Message Types</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Type</th><th>Code</th><th>Message</th><th>Description</th><th>Use</th></tr></thead><tbody>
<tr><td><strong>0</strong></td><td>0</td><td>Echo Reply</td><td>Response to ping</td><td>ping response</td></tr>
<tr><td><strong>3</strong></td><td>0</td><td>Destination Network Unreachable</td><td>Cannot reach network</td><td>Routing error</td></tr>
<tr><td><strong>3</strong></td><td>1</td><td>Destination Host Unreachable</td><td>Cannot reach host</td><td>Host down/filtered</td></tr>
<tr><td><strong>3</strong></td><td>2</td><td>Destination Protocol Unreachable</td><td>Protocol not supported</td><td>Protocol error</td></tr>
<tr><td><strong>3</strong></td><td>3</td><td>Destination Port Unreachable</td><td>Port not listening</td><td>Port closed</td></tr>
<tr><td><strong>3</strong></td><td>4</td><td>Fragmentation Needed and DF Set</td><td>MTU exceeded with DF=1</td><td>PMTUD</td></tr>
<tr><td><strong>3</strong></td><td>13</td><td>Communication Administratively Prohibited</td><td>Filtered by firewall</td><td>ACL/firewall</td></tr>
<tr><td><strong>5</strong></td><td>0-3</td><td>Redirect</td><td>Better route available</td><td>Route optimization</td></tr>
<tr><td><strong>8</strong></td><td>0</td><td>Echo Request</td><td>Ping request</td><td>ping</td></tr>
<tr><td><strong>11</strong></td><td>0</td><td>Time Exceeded in Transit</td><td>TTL reached 0</td><td>traceroute</td></tr>
<tr><td><strong>11</strong></td><td>1</td><td>Fragment Reassembly Time Exceeded</td><td>Fragments timeout</td><td>Fragmentation issue</td></tr>
<tr><td><strong>12</strong></td><td>0</td><td>Parameter Problem</td><td>IP header error</td><td>Malformed packet</td></tr>
</tbody></table>
</div>
<h3 id="ping-icmp-echo-requestreply-1"><a class="header" href="#ping-icmp-echo-requestreply-1">Ping (ICMP Echo Request/Reply)</a></h3>
<p>Ping tests connectivity and measures round-trip time:</p>
<pre><code>Client                          Server
  |                                |
  | ICMP Echo Request (Type 8)     |
  |   Identifier: 1234             |
  |   Sequence: 1                  |
  |   Data: 56 bytes               |
  |-------------------------------&gt;|
  |                                |
  | ICMP Echo Reply (Type 0)       |
  |   Identifier: 1234             |
  |   Sequence: 1                  |
  |   Data: 56 bytes (echoed)      |
  |&lt;-------------------------------|
  |                                |

Round-Trip Time (RTT) measured
</code></pre>
<h3 id="ping-examples"><a class="header" href="#ping-examples">Ping Examples</a></h3>
<pre><code class="language-bash"># Basic ping
ping 8.8.8.8

# Send specific number of packets
ping -c 4 8.8.8.8

# Set packet size
ping -s 1000 8.8.8.8

# Set interval (0.2 seconds)
ping -i 0.2 8.8.8.8

# Flood ping (requires root)
sudo ping -f 8.8.8.8

# Set TTL
ping -t 5 8.8.8.8

# Disable DNS resolution
ping -n 8.8.8.8

# Example output:
PING 8.8.8.8 (8.8.8.8) 56(84) bytes of data.
64 bytes from 8.8.8.8: icmp_seq=1 ttl=117 time=10.2 ms
64 bytes from 8.8.8.8: icmp_seq=2 ttl=117 time=9.8 ms
64 bytes from 8.8.8.8: icmp_seq=3 ttl=117 time=10.1 ms

--- 8.8.8.8 ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 2003ms
rtt min/avg/max/mdev = 9.8/10.0/10.2/0.2 ms
</code></pre>
<h3 id="icmp-in-traceroute"><a class="header" href="#icmp-in-traceroute">ICMP in Traceroute</a></h3>
<pre><code>Traceroute sends packets with increasing TTL:

Packet 1: TTL=1
  → Router 1 decrements to 0
  → Router 1 sends ICMP Type 11 (Time Exceeded)
  → Reveals Router 1 IP

Packet 2: TTL=2
  → Router 1: TTL=1
  → Router 2: TTL=0
  → Router 2 sends ICMP Type 11
  → Reveals Router 2 IP

Packet N: TTL=N
  → Destination reached
  → Sends ICMP Type 3 (Port Unreachable) or Echo Reply
  → Traceroute completes
</code></pre>
<h2 id="ipv4-commands-and-tools"><a class="header" href="#ipv4-commands-and-tools">IPv4 Commands and Tools</a></h2>
<h3 id="ifconfig--ip-linux-1"><a class="header" href="#ifconfig--ip-linux-1">ifconfig / ip (Linux)</a></h3>
<pre><code class="language-bash"># View IP configuration (old style)
ifconfig

# View IP configuration (modern)
ip addr show
ip a

# Show specific interface
ip addr show eth0

# Assign IP address (temporary)
sudo ip addr add 192.168.1.100/24 dev eth0

# Remove IP address
sudo ip addr del 192.168.1.100/24 dev eth0

# Enable interface
sudo ip link set eth0 up

# Disable interface
sudo ip link set eth0 down

# Show interface statistics
ip -s link show eth0
</code></pre>
<h3 id="ipconfig-windows-1"><a class="header" href="#ipconfig-windows-1">ipconfig (Windows)</a></h3>
<pre><code class="language-cmd"># View IP configuration
ipconfig

# View detailed configuration
ipconfig /all

# Renew DHCP lease
ipconfig /renew

# Release DHCP lease
ipconfig /release

# Flush DNS cache
ipconfig /flushdns

# Display DNS cache
ipconfig /displaydns
</code></pre>
<h3 id="ip-route-linux"><a class="header" href="#ip-route-linux">ip route (Linux)</a></h3>
<pre><code class="language-bash"># Show routing table
ip route show
ip route list

# Add static route
sudo ip route add 10.0.0.0/8 via 192.168.1.254

# Add route via specific interface
sudo ip route add 10.0.0.0/8 dev eth0

# Delete route
sudo ip route del 10.0.0.0/8

# Add default gateway
sudo ip route add default via 192.168.1.1

# Delete default gateway
sudo ip route del default

# Change route
sudo ip route change 10.0.0.0/8 via 192.168.1.253

# Show route to specific destination
ip route get 8.8.8.8
</code></pre>
<h3 id="route-linuxwindows"><a class="header" href="#route-linuxwindows">route (Linux/Windows)</a></h3>
<pre><code class="language-bash"># Linux - show routing table
route -n

# Linux - add route
sudo route add -net 10.0.0.0/8 gw 192.168.1.254

# Linux - delete route
sudo route del -net 10.0.0.0/8

# Windows - show routing table
route print

# Windows - add route
route add 10.0.0.0 mask 255.0.0.0 192.168.1.254

# Windows - delete route
route delete 10.0.0.0

# Windows - add persistent route
route -p add 10.0.0.0 mask 255.0.0.0 192.168.1.254
</code></pre>
<h3 id="arp-address-resolution-protocol-1"><a class="header" href="#arp-address-resolution-protocol-1">arp (Address Resolution Protocol)</a></h3>
<pre><code class="language-bash"># View ARP cache
arp -a

# View ARP cache for specific interface (Linux)
arp -i eth0

# Add static ARP entry (Linux)
sudo arp -s 192.168.1.50 00:11:22:33:44:55

# Delete ARP entry (Linux)
sudo arp -d 192.168.1.50

# View ARP cache (modern Linux)
ip neigh show

# Delete ARP entry (modern Linux)
sudo ip neigh del 192.168.1.50 dev eth0
</code></pre>
<h2 id="ipv4-best-practices"><a class="header" href="#ipv4-best-practices">IPv4 Best Practices</a></h2>
<h3 id="1-subnet-design"><a class="header" href="#1-subnet-design">1. Subnet Design</a></h3>
<pre><code>Plan network hierarchy:

Organization: 10.0.0.0/8
├── Location A: 10.1.0.0/16
│   ├── Servers: 10.1.1.0/24
│   ├── Workstations: 10.1.2.0/24
│   └── Guests: 10.1.3.0/24
├── Location B: 10.2.0.0/16
│   ├── Servers: 10.2.1.0/24
│   └── Workstations: 10.2.2.0/24
└── Management: 10.255.0.0/16
    ├── Network Devices: 10.255.1.0/24
    └── Out-of-band: 10.255.2.0/24

Benefits:
- Logical organization
- Summarization for routing
- Security segmentation
- Growth flexibility
</code></pre>
<h3 id="2-ip-address-allocation"><a class="header" href="#2-ip-address-allocation">2. IP Address Allocation</a></h3>
<pre><code>Reserve ranges within each subnet:

Example subnet: 192.168.1.0/24

192.168.1.0         Network address (reserved)
192.168.1.1         Gateway (router)
192.168.1.2-10      Infrastructure (switches, APs)
192.168.1.11-50     Servers (static)
192.168.1.51-99     Printers/IoT (static)
192.168.1.100-254   DHCP pool (dynamic)
192.168.1.255       Broadcast address (reserved)

Document everything in IPAM (IP Address Management) system
</code></pre>
<h3 id="3-use-private-ip-ranges"><a class="header" href="#3-use-private-ip-ranges">3. Use Private IP Ranges</a></h3>
<pre><code>ALWAYS use private IPs internally:

Small networks:    192.168.x.0/24
Medium networks:   172.16.x.0/16 to 172.31.x.0/16
Large networks:    10.0.0.0/8

NEVER use:
- Public IPs internally (causes routing issues)
- TEST-NET ranges (192.0.2.0/24, 198.51.100.0/24, 203.0.113.0/24)
- Multicast ranges (224.0.0.0/4)
</code></pre>
<h3 id="4-network-documentation"><a class="header" href="#4-network-documentation">4. Network Documentation</a></h3>
<pre><code>Maintain detailed documentation:

Network Diagram:
- Physical topology
- Logical topology
- IP addressing scheme
- VLAN assignments

Spreadsheet/IPAM:
IP Address    | Hostname    | MAC Address       | Type   | Notes
192.168.1.1   | gateway     | 00:11:22:33:44:55 | Router | Primary gateway
192.168.1.10  | server1     | 00:11:22:33:44:66 | Server | Web server
192.168.1.11  | server2     | 00:11:22:33:44:77 | Server | Database
192.168.1.50  | printer1    | 00:11:22:33:44:88 | Printer| HP LaserJet
</code></pre>
<h3 id="5-dhcp-configuration"><a class="header" href="#5-dhcp-configuration">5. DHCP Configuration</a></h3>
<pre><code>DHCP best practices:

- Appropriate lease time:
  * Office: 8-24 hours
  * Guest: 1-4 hours
  * Mobile: 30-60 minutes

- Reserve space for static IPs

- Configure DHCP options:
  * Option 3: Default gateway
  * Option 6: DNS servers
  * Option 15: Domain name
  * Option 42: NTP servers

- Redundant DHCP servers (split scope or failover)

- Monitor DHCP scope utilization
</code></pre>
<h3 id="6-network-security"><a class="header" href="#6-network-security">6. Network Security</a></h3>
<pre><code>Security measures:

1. Subnetting for segmentation
   - Separate user, server, management networks
   - Use VLANs

2. Private IPs + NAT
   - Hide internal topology
   - Conserve public IPs

3. Disable unused services
   - No ICMP redirect
   - No source routing

4. Ingress/egress filtering
   - Block spoofed source IPs
   - RFC 3330 filtering

5. Monitor for IP conflicts
   - Detect ARP spoofing
   - DHCP snooping
</code></pre>
<h3 id="7-avoid-ip-conflicts"><a class="header" href="#7-avoid-ip-conflicts">7. Avoid IP Conflicts</a></h3>
<pre><code>Prevention:

1. Use DHCP for workstations
2. Static IPs for servers/infrastructure
3. Document all static assignments
4. Configure DHCP exclusions for static range
5. Use DHCP reservations for semi-static hosts
6. Enable IP conflict detection

Detection:
- arping before assigning static IP
- Monitor DHCP logs
- Use network scanning tools
- Enable DHCP conflict detection
</code></pre>
<h2 id="eli10-ipv4-explained-simply"><a class="header" href="#eli10-ipv4-explained-simply">ELI10: IPv4 Explained Simply</a></h2>
<p>Think of IPv4 addresses like street addresses for computers:</p>
<h3 id="ipv4-address-1921681100"><a class="header" href="#ipv4-address-1921681100">IPv4 Address (192.168.1.100)</a></h3>
<ul>
<li>Like a home address with 4 numbers</li>
<li>Each number is between 0 and 255</li>
<li>Separated by dots</li>
<li>Uniquely identifies your computer on the network</li>
</ul>
<h3 id="why-4-numbers"><a class="header" href="#why-4-numbers">Why 4 Numbers?</a></h3>
<pre><code>Each number is 0-255 (256 possibilities)
256 × 256 × 256 × 256 = 4.3 billion addresses

Problem: We almost ran out!
- Too many computers, phones, tablets
- Solution: NAT (share one public address)
- Future: IPv6 (way more addresses)
</code></pre>
<h3 id="private-vs-public"><a class="header" href="#private-vs-public">Private vs Public</a></h3>
<pre><code>Private IPs (like apartment numbers):
- 192.168.x.x (home networks)
- 10.x.x.x (big companies)
- Only work inside your building (network)

Public IPs (like street addresses):
- Work on the internet
- Must be unique worldwide
- Expensive and limited
</code></pre>
<h3 id="subnets"><a class="header" href="#subnets">Subnets</a></h3>
<pre><code>Like organizing streets into neighborhoods:

City: 10.0.0.0/8 (whole city)
  └─ Neighborhood: 10.1.0.0/16 (one area)
      └─ Street: 10.1.1.0/24 (one street)
          └─ House: 10.1.1.100 (your house)

/24 means: First 3 numbers are the "street", last number is your "house number"
</code></pre>
<h3 id="nat-sharing-one-address"><a class="header" href="#nat-sharing-one-address">NAT (Sharing One Address)</a></h3>
<pre><code>Your home:
- Router has public IP: 203.0.113.5 (street address)
- Devices have private IPs: 192.168.1.x (apartment numbers)
- Router is like mailroom: forwards mail to right apartment
</code></pre>
<h3 id="routing"><a class="header" href="#routing">Routing</a></h3>
<pre><code>Routers are like mail sorting facilities:
- Look at destination address
- Decide which direction to send packet
- Pass to next router
- Repeat until destination reached
</code></pre>
<h2 id="further-resources-25"><a class="header" href="#further-resources-25">Further Resources</a></h2>
<ul>
<li><a href="https://tools.ietf.org/html/rfc791">RFC 791 - IPv4 Specification</a></li>
<li><a href="https://tools.ietf.org/html/rfc1918">RFC 1918 - Private Address Space</a></li>
<li><a href="https://tools.ietf.org/html/rfc950">RFC 950 - Internet Standard Subnetting Procedure</a></li>
<li><a href="https://tools.ietf.org/html/rfc1812">RFC 1812 - Requirements for IPv4 Routers</a></li>
<li><a href="https://tools.ietf.org/html/rfc3021">RFC 3021 - Using 31-Bit Prefixes on IPv4 Point-to-Point Links</a></li>
<li><a href="https://www.subnet-calculator.com/">Subnet Calculator</a></li>
<li><a href="https://www.ipaddressguide.com/cidr">CIDR to IPv4 Conversion</a></li>
<li><a href="https://www.iana.org/assignments/ipv4-address-space/">IANA IPv4 Address Space Registry</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ipv6-internet-protocol-version-6-1"><a class="header" href="#ipv6-internet-protocol-version-6-1">IPv6 (Internet Protocol version 6)</a></h1>
<h2 id="overview-76"><a class="header" href="#overview-76">Overview</a></h2>
<p>IPv6 (Internet Protocol version 6) is the most recent version of the Internet Protocol. It was developed to address the IPv4 address exhaustion problem and to provide improvements in routing, security, and network auto-configuration. IPv6 is designed to replace IPv4 and is the future of internet addressing.</p>
<h2 id="key-characteristics-3"><a class="header" href="#key-characteristics-3">Key Characteristics</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Feature</th><th>IPv6</th></tr></thead><tbody>
<tr><td><strong>Address Size</strong></td><td>128 bits</td></tr>
<tr><td><strong>Address Format</strong></td><td>Hexadecimal colon notation (2001:db8::1)</td></tr>
<tr><td><strong>Total Addresses</strong></td><td>340 undecillion (2¹²⁸ ≈ 3.4 × 10³⁸)</td></tr>
<tr><td><strong>Header Size</strong></td><td>40 bytes (fixed, no options)</td></tr>
<tr><td><strong>Checksum</strong></td><td>No (delegated to link and transport layers)</td></tr>
<tr><td><strong>Fragmentation</strong></td><td>Source host only (not by routers)</td></tr>
<tr><td><strong>Broadcast</strong></td><td>No (replaced by multicast)</td></tr>
<tr><td><strong>Configuration</strong></td><td>SLAAC (Stateless Auto-Config) or DHCPv6</td></tr>
<tr><td><strong>IPSec</strong></td><td>Mandatory (built-in security)</td></tr>
<tr><td><strong>Address Resolution</strong></td><td>NDP (Neighbor Discovery Protocol) instead of ARP</td></tr>
</tbody></table>
</div>
<h2 id="ipv6-advantages-over-ipv4"><a class="header" href="#ipv6-advantages-over-ipv4">IPv6 Advantages Over IPv4</a></h2>
<pre><code>1. Vast Address Space
   - 340 undecillion addresses
   - Every grain of sand on Earth could have billions of IPs
   - No more address exhaustion

2. Simplified Header
   - Fixed 40-byte header (no options)
   - Faster processing by routers
   - Extension headers for optional features

3. Auto-Configuration
   - SLAAC: hosts configure themselves
   - No DHCP required (though DHCPv6 available)
   - Plug-and-play networking

4. Built-in Security
   - IPSec mandatory
   - Authentication and encryption
   - Better privacy features

5. Better Routing
   - Hierarchical addressing
   - Smaller routing tables
   - More efficient routing

6. No NAT Required
   - Every device gets public address
   - True end-to-end connectivity
   - Simplifies protocols (VoIP, gaming, P2P)

7. Multicast Improvements
   - No broadcast (more efficient)
   - Built-in multicast support
   - Scope-based addressing
</code></pre>
<h2 id="ipv6-packet-format-1"><a class="header" href="#ipv6-packet-format-1">IPv6 Packet Format</a></h2>
<pre><code> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|Version| Traffic Class |           Flow Label                  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         Payload Length        |  Next Header  |   Hop Limit   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                                                               +
|                                                               |
+                         Source Address                        +
|                          (128 bits)                           |
+                                                               +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                                                               +
|                                                               |
+                      Destination Address                      +
|                          (128 bits)                           |
+                                                               +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                       Extension Headers                       +
|                         (if present)                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                           Payload                             +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</code></pre>
<h3 id="ipv6-header-fields-40-bytes-fixed-1"><a class="header" href="#ipv6-header-fields-40-bytes-fixed-1">IPv6 Header Fields (40 bytes fixed)</a></h3>
<ol>
<li><strong>Version</strong> (4 bits): IP version = 6</li>
<li><strong>Traffic Class</strong> (8 bits): QoS and priority
<ul>
<li>Differentiated Services Code Point (DSCP): 6 bits</li>
<li>Explicit Congestion Notification (ECN): 2 bits</li>
<li>Similar to IPv4 Type of Service</li>
</ul>
</li>
<li><strong>Flow Label</strong> (20 bits): QoS flow identification
<ul>
<li>Identifies packets belonging to same flow</li>
<li>Used for QoS and ECMP (Equal-Cost Multi-Path)</li>
<li>Routers can treat flows differently</li>
</ul>
</li>
<li><strong>Payload Length</strong> (16 bits): Length of data after header
<ul>
<li>Does NOT include the 40-byte header itself</li>
<li>Maximum: 65,535 bytes</li>
<li>Jumbograms (&gt;65,535) use Hop-by-Hop extension</li>
</ul>
</li>
<li><strong>Next Header</strong> (8 bits): Type of next header
<ul>
<li>Like IPv4 Protocol field</li>
<li>Values: 6=TCP, 17=UDP, 58=ICMPv6, 59=No next header</li>
<li>Or indicates extension header type</li>
</ul>
</li>
<li><strong>Hop Limit</strong> (8 bits): Maximum hops (like IPv4 TTL)
<ul>
<li>Decremented by each router</li>
<li>Packet dropped when reaches 0</li>
<li>Typical values: 64, 128, 255</li>
</ul>
</li>
<li><strong>Source Address</strong> (128 bits): Sender IPv6 address</li>
<li><strong>Destination Address</strong> (128 bits): Receiver IPv6 address</li>
</ol>
<h3 id="comparison-with-ipv4-header"><a class="header" href="#comparison-with-ipv4-header">Comparison with IPv4 Header</a></h3>
<pre><code>Removed from IPv4:
- Header Length (IHL): Fixed at 40 bytes
- Identification, Flags, Fragment Offset: Moved to extension header
- Header Checksum: Redundant (link and transport layers handle it)
- Options: Replaced by extension headers

Added to IPv6:
- Flow Label: QoS identification

Renamed:
- TTL → Hop Limit
- Protocol → Next Header
- Type of Service → Traffic Class
</code></pre>
<h2 id="ipv6-address-format-1"><a class="header" href="#ipv6-address-format-1">IPv6 Address Format</a></h2>
<h3 id="full-representation-1"><a class="header" href="#full-representation-1">Full Representation</a></h3>
<pre><code>2001:0db8:0000:0042:0000:8a2e:0370:7334

Structure:
- 8 groups of 4 hexadecimal digits
- Separated by colons
- Each group = 16 bits
- Total: 128 bits
</code></pre>
<h3 id="address-compression-rules"><a class="header" href="#address-compression-rules">Address Compression Rules</a></h3>
<h4 id="rule-1-remove-leading-zeros"><a class="header" href="#rule-1-remove-leading-zeros">Rule 1: Remove Leading Zeros</a></h4>
<pre><code>Original:
2001:0db8:0000:0042:0000:8a2e:0370:7334

After removing leading zeros:
2001:db8:0:42:0:8a2e:370:7334

Each group can have 1-4 hex digits
</code></pre>
<h4 id="rule-2-compress-consecutive-zeros-with-"><a class="header" href="#rule-2-compress-consecutive-zeros-with-">Rule 2: Compress Consecutive Zeros with <code>::</code></a></h4>
<pre><code>Before: 2001:db8:0:42:0:8a2e:370:7334
After:  2001:db8:0:42::8a2e:370:7334

Before: 2001:db8:0:0:0:0:0:1
After:  2001:db8::1

Before: 0:0:0:0:0:0:0:1
After:  ::1  (loopback)

Before: 0:0:0:0:0:0:0:0
After:  ::  (unspecified)

IMPORTANT: Can only use :: once per address
(otherwise ambiguous which zeros are compressed)
</code></pre>
<h3 id="special-addresses"><a class="header" href="#special-addresses">Special Addresses</a></h3>
<pre><code>::                        Unspecified address
                          (0.0.0.0 in IPv4)
                          Used before address is configured

::1                       Loopback address
                          (127.0.0.1 in IPv4)
                          Local host communication

::ffff:192.0.2.1          IPv4-mapped IPv6 address
                          Used for IPv4/IPv6 compatibility
                          Last 32 bits contain IPv4 address

2001:db8::/32             Documentation prefix
                          Reserved for examples (TEST-NET)

fe80::/10                 Link-local prefix
                          Auto-configured on every interface

ff00::/8                  Multicast prefix
</code></pre>
<h2 id="ipv6-address-types-1"><a class="header" href="#ipv6-address-types-1">IPv6 Address Types</a></h2>
<h3 id="1-unicast-one-to-one"><a class="header" href="#1-unicast-one-to-one">1. Unicast (One-to-One)</a></h3>
<p>Address for a single interface.</p>
<h4 id="global-unicast-address-gua"><a class="header" href="#global-unicast-address-gua">Global Unicast Address (GUA)</a></h4>
<pre><code>Prefix: 2000::/3 (2000:0000 to 3fff:ffff)

Routable on the Internet (like public IPv4)

Format:
|    48 bits     | 16 bits |        64 bits        |
| Global Routing | Subnet  |    Interface ID       |
| Prefix         | ID      |                       |

Example:
2001:0db8:1234:0001:0000:0000:0000:0001
|-- Global --||Sub||--- Interface ID ---|

Typically:
- ISP assigns /48 or /56 to customer
- Customer has 65,536 (/48) or 256 (/56) subnets
- Each subnet is /64 with 2^64 addresses
</code></pre>
<h4 id="unique-local-address-ula"><a class="header" href="#unique-local-address-ula">Unique Local Address (ULA)</a></h4>
<pre><code>Prefix: fc00::/7 (fc00:: to fdff::)

Private addressing (like RFC 1918 in IPv4)
Not routed on public internet

Format:
fd00::/8 is used (fc00::/8 reserved for future)

|  8 bits | 40 bits  | 16 bits |    64 bits     |
|  fd     | Random   | Subnet  | Interface ID   |
|  prefix | Global   | ID      |                |
|         | ID       |         |                |

Example:
fd12:3456:789a:0001::1

Generation:
- fd prefix
- 40-bit random number (cryptographically generated)
- Ensures uniqueness even if networks merge
</code></pre>
<h4 id="link-local-address"><a class="header" href="#link-local-address">Link-Local Address</a></h4>
<pre><code>Prefix: fe80::/10

Automatically configured on every IPv6-enabled interface
Only valid on the local link (not routed)
Like IPv4 169.254.0.0/16 (APIPA)

Format:
fe80::interface-id/64

Examples:
fe80::1
fe80::20c:29ff:fe9d:8c6a

Uses:
- Neighbor Discovery Protocol (NDP)
- Router discovery
- Address autoconfiguration
- Local communication

Always present, even if GUA configured
</code></pre>
<h3 id="2-anycast-one-to-nearest"><a class="header" href="#2-anycast-one-to-nearest">2. Anycast (One-to-Nearest)</a></h3>
<pre><code>Address assigned to multiple interfaces
Packet delivered to nearest one (by routing metric)

Use cases:
- Load balancing
- Service discovery
- Root DNS servers (6 of 13 use anycast)

Same format as unicast (no special prefix)
Designated as anycast during configuration

Example:
Anycast: 2001:db8::1 assigned to 3 servers
Client sends to 2001:db8::1
Routers deliver to nearest server
</code></pre>
<h3 id="3-multicast-one-to-many"><a class="header" href="#3-multicast-one-to-many">3. Multicast (One-to-Many)</a></h3>
<pre><code>Prefix: ff00::/8

Replaces broadcast in IPv4
Packet delivered to all members of multicast group

Format:
|   8 bits   |  4 bits | 4 bits |       112 bits        |
|    ff      |  Flags  | Scope  |      Group ID         |

Flags (4 bits):
0000 = Permanent (well-known)
0001 = Temporary (transient)

Scope (4 bits):
1 = Interface-local
2 = Link-local
5 = Site-local
8 = Organization-local
e = Global
</code></pre>
<h4 id="common-multicast-addresses"><a class="header" href="#common-multicast-addresses">Common Multicast Addresses</a></h4>
<pre><code>Well-Known Multicast:

ff02::1                   All nodes on link
                          (Like 255.255.255.255 broadcast)

ff02::2                   All routers on link

ff02::1:2                 All DHCP servers/relays on link

ff02::1:ff00:0/104        Solicited-node multicast
                          Used in Neighbor Discovery

ff05::1:3                 All DHCP servers (site-local)

Solicited-Node Multicast:
Format: ff02::1:ff[last 24 bits of address]

Example:
Address: 2001:db8::1234:5678
Solicited-node: ff02::1:ff34:5678

Purpose: Efficient address resolution (NDP)
</code></pre>
<h3 id="4-no-broadcast"><a class="header" href="#4-no-broadcast">4. No Broadcast</a></h3>
<pre><code>IPv4 broadcast → IPv6 multicast

IPv4: 192.168.1.255 (broadcast to all)
IPv6: ff02::1 (all-nodes multicast)

Benefits:
- More efficient (only interested hosts listen)
- Reduces network noise
- Scalable
</code></pre>
<h2 id="ipv6-address-structure"><a class="header" href="#ipv6-address-structure">IPv6 Address Structure</a></h2>
<h3 id="eui-64-extended-unique-identifier"><a class="header" href="#eui-64-extended-unique-identifier">EUI-64 (Extended Unique Identifier)</a></h3>
<p>Method to generate interface ID from MAC address:</p>
<pre><code>MAC Address: 00:1A:2B:3C:4D:5E

Step 1: Split in half
  00:1A:2B  :  3C:4D:5E

Step 2: Insert FF:FE in middle
  00:1A:2B:FF:FE:3C:4D:5E

Step 3: Flip 7th bit (Universal/Local bit)
  00 → 02 (in binary: 00000000 → 00000010)

Result: 02:1A:2B:FF:FE:3C:4D:5E

Step 4: Format as IPv6 interface ID
  021a:2bff:fe3c:4d5e

Full address:
  2001:db8:1234:5678:021a:2bff:fe3c:4d5e

Privacy concern: MAC address visible in IP
Solution: Privacy Extensions (RFC 4941)
</code></pre>
<h3 id="privacy-extensions-rfc-4941"><a class="header" href="#privacy-extensions-rfc-4941">Privacy Extensions (RFC 4941)</a></h3>
<pre><code>Problem: EUI-64 exposes MAC address
         Allows tracking of devices

Solution: Random interface IDs
- Generated randomly
- Changed periodically (typically daily)
- Temporary addresses for outgoing connections

Example:
Stable:    2001:db8::21a:2bff:fe3c:4d5e  (EUI-64, for incoming)
Temporary: 2001:db8::a4b2:76d9:3e21:91f8 (random, for outgoing)

Benefits:
- Privacy protection
- Harder to track users
- Still allows stable addressing for servers
</code></pre>
<h2 id="ipv6-subnetting"><a class="header" href="#ipv6-subnetting">IPv6 Subnetting</a></h2>
<h3 id="standard-subnet-size-64"><a class="header" href="#standard-subnet-size-64">Standard Subnet Size: /64</a></h3>
<pre><code>Why /64?

1. SLAAC requires /64
   - 64-bit prefix + 64-bit interface ID

2. Massive address space per subnet
   - 2^64 = 18,446,744,073,709,551,616 addresses
   - 18.4 quintillion addresses per subnet!
   - Will never run out

3. Standard recommendation
   - RFC 4291, RFC 5375

Even point-to-point links should use /64
(not /127 like IPv4 /30)
</code></pre>
<h3 id="subnet-allocation-example"><a class="header" href="#subnet-allocation-example">Subnet Allocation Example</a></h3>
<pre><code>ISP allocates: 2001:db8::/32

Customer (Enterprise):
Receives: 2001:db8:abcd::/48

|       32 bits       | 16 bits | 16 bits |     64 bits      |
| ISP Prefix          | Customer| Subnet  | Interface ID     |
| 2001:db8            | abcd    | 0-ffff  |                  |

Customer has 2^16 = 65,536 subnets:
2001:db8:abcd:0000::/64
2001:db8:abcd:0001::/64
2001:db8:abcd:0002::/64
...
2001:db8:abcd:ffff::/64

Each subnet has 2^64 addresses
</code></pre>
<h3 id="hierarchical-addressing"><a class="header" href="#hierarchical-addressing">Hierarchical Addressing</a></h3>
<pre><code>Organization: 2001:db8:abcd::/48

Building 1: 2001:db8:abcd:0100::/56
  Floor 1: 2001:db8:abcd:0101::/64
  Floor 2: 2001:db8:abcd:0102::/64
  Floor 3: 2001:db8:abcd:0103::/64

Building 2: 2001:db8:abcd:0200::/56
  Floor 1: 2001:db8:abcd:0201::/64
  Floor 2: 2001:db8:abcd:0202::/64

Servers: 2001:db8:abcd:1000::/56
  Web: 2001:db8:abcd:1001::/64
  Database: 2001:db8:abcd:1002::/64
  Email: 2001:db8:abcd:1003::/64

Benefits:
- Logical organization
- Easy summarization
- Simplified routing
- Room for growth
</code></pre>
<h2 id="ipv6-auto-configuration"><a class="header" href="#ipv6-auto-configuration">IPv6 Auto-Configuration</a></h2>
<h3 id="slaac-stateless-address-auto-configuration"><a class="header" href="#slaac-stateless-address-auto-configuration">SLAAC (Stateless Address Auto-Configuration)</a></h3>
<p>Automatic IPv6 configuration without DHCP:</p>
<pre><code>Process:

1. Link-Local Address Generation
   Host creates link-local address (fe80::)
   Interface ID from EUI-64 or random

2. Duplicate Address Detection (DAD)
   Sends Neighbor Solicitation for its own address
   If no response → address is unique

3. Router Solicitation (RS)
   Host sends multicast RS to ff02::2 (all routers)
   "Are there any routers?"

4. Router Advertisement (RA)
   Router responds with:
   - Network prefix (e.g., 2001:db8:1234:5678::/64)
   - Default gateway address
   - DNS servers (if configured)
   - Other configuration flags

5. Global Address Formation
   Host combines:
   - Prefix from RA (2001:db8:1234:5678)
   - Interface ID (021a:2bff:fe3c:4d5e)
   - Result: 2001:db8:1234:5678:021a:2bff:fe3c:4d5e

6. DAD for Global Address
   Verify global address is unique

7. Ready!
   Host has link-local and global address
   No DHCP server needed!

Flags in RA:
- M (Managed): Use DHCPv6 for addresses
- O (Other): Use DHCPv6 for other info (DNS, NTP, etc.)
</code></pre>
<h3 id="dhcpv6-dynamic-host-configuration-protocol-for-ipv6"><a class="header" href="#dhcpv6-dynamic-host-configuration-protocol-for-ipv6">DHCPv6 (Dynamic Host Configuration Protocol for IPv6)</a></h3>
<p>Alternative/supplement to SLAAC:</p>
<pre><code>Stateful DHCPv6:
- Like DHCPv4
- Server assigns addresses
- Tracks assignments
- Use when: Need centralized control

Stateless DHCPv6:
- SLAAC for address
- DHCPv6 for other info (DNS, domain, etc.)
- Use when: Need SLAAC + additional config

DHCPv6 Messages:
- SOLICIT: Client requests address
- ADVERTISE: Server offers address
- REQUEST: Client accepts offer
- REPLY: Server confirms

Multicast addresses:
- ff02::1:2 - All DHCP servers/relays on link
- ff05::1:3 - All DHCP servers (site-local)
</code></pre>
<h3 id="router-advertisement-example"><a class="header" href="#router-advertisement-example">Router Advertisement Example</a></h3>
<pre><code>Router configuration (Linux):
# Enable IPv6 forwarding
net.ipv6.conf.all.forwarding = 1

# radvd configuration
interface eth0 {
    AdvSendAdvert on;
    prefix 2001:db8:1234:5678::/64 {
        AdvOnLink on;
        AdvAutonomous on;
    };
    RDNSS 2001:4860:4860::8888 {
    };
};

This advertises:
- Prefix: 2001:db8:1234:5678::/64
- DNS: 2001:4860:4860::8888 (Google DNS)
- Clients auto-configure themselves
</code></pre>
<h2 id="neighbor-discovery-protocol-ndp"><a class="header" href="#neighbor-discovery-protocol-ndp">Neighbor Discovery Protocol (NDP)</a></h2>
<p>NDP replaces ARP and adds functionality:</p>
<h3 id="ndp-functions"><a class="header" href="#ndp-functions">NDP Functions</a></h3>
<pre><code>1. Router Discovery
   - Find routers on link
   - Get network prefix

2. Address Resolution
   - Map IPv6 address to MAC address
   - Replaces ARP

3. Duplicate Address Detection (DAD)
   - Verify address uniqueness

4. Neighbor Unreachability Detection
   - Monitor neighbor reachability

5. Redirect
   - Inform hosts of better next hop
</code></pre>
<h3 id="ndp-message-types-icmpv6"><a class="header" href="#ndp-message-types-icmpv6">NDP Message Types (ICMPv6)</a></h3>
<pre><code>Type 133: Router Solicitation (RS)
  Sent by: Host
  To: ff02::2 (all routers)
  Purpose: "Are there routers here?"

Type 134: Router Advertisement (RA)
  Sent by: Router
  To: ff02::1 (all nodes) or unicast
  Purpose: "Here's my prefix and config"

Type 135: Neighbor Solicitation (NS)
  Sent by: Host
  To: Solicited-node multicast
  Purpose: "Who has this IPv6 address?" (like ARP request)
           "Is anyone using this address?" (DAD)

Type 136: Neighbor Advertisement (NA)
  Sent by: Host
  To: Unicast or ff02::1
  Purpose: "I have this IPv6 address" (like ARP reply)
           "I'm using this address" (DAD response)

Type 137: Redirect
  Sent by: Router
  To: Unicast (specific host)
  Purpose: "Use different router for this destination"
</code></pre>
<h3 id="address-resolution-example"><a class="header" href="#address-resolution-example">Address Resolution Example</a></h3>
<pre><code>Host A wants to communicate with Host B:

Host A: 2001:db8::1
Host B: 2001:db8::2
Host B MAC: 00:11:22:33:44:55

1. Host A sends Neighbor Solicitation (NS):
   From: 2001:db8::1
   To: ff02::1:ff00:2 (solicited-node multicast for ::2)
   Question: "What's the MAC address of 2001:db8::2?"

2. Host B receives NS (listening on solicited-node multicast)

3. Host B sends Neighbor Advertisement (NA):
   From: 2001:db8::2
   To: 2001:db8::1 (unicast reply)
   Answer: "My MAC is 00:11:22:33:44:55"

4. Host A caches: 2001:db8::2 → 00:11:22:33:44:55

5. Host A sends packet directly to Host B

Neighbor cache entry:
2001:db8::2  dev eth0  lladdr 00:11:22:33:44:55  REACHABLE
</code></pre>
<h3 id="duplicate-address-detection-dad"><a class="header" href="#duplicate-address-detection-dad">Duplicate Address Detection (DAD)</a></h3>
<pre><code>Before using any address:

1. Node creates address:
   - Link-local: fe80::1
   - Or global: 2001:db8::1

2. Node sends Neighbor Solicitation:
   From: :: (unspecified address)
   To: ff02::1:ff00:1 (solicited-node multicast)
   Target: fe80::1 (address being tested)
   Question: "Is anyone using fe80::1?"

3. Wait 1 second:
   - If NA received → Address in use (conflict!)
   - If no response → Address is unique ✓

4. If unique:
   - Mark address as valid
   - Start using it

If conflict detected:
- Link-local conflict: Generate new interface ID
- Global conflict: Manual intervention required
</code></pre>
<h2 id="ipv6-extension-headers"><a class="header" href="#ipv6-extension-headers">IPv6 Extension Headers</a></h2>
<p>Extension headers provide optional functionality without bloating main header:</p>
<h3 id="extension-header-types"><a class="header" href="#extension-header-types">Extension Header Types</a></h3>
<pre><code>Next Header values:

0   = Hop-by-Hop Options (must be first if present)
43  = Routing Header
44  = Fragment Header
50  = Encapsulating Security Payload (ESP)
51  = Authentication Header (AH)
60  = Destination Options
59  = No Next Header (no more headers)
6   = TCP
17  = UDP
58  = ICMPv6
</code></pre>
<h3 id="extension-header-chaining"><a class="header" href="#extension-header-chaining">Extension Header Chaining</a></h3>
<pre><code>Base IPv6 Header
  Next Header = 43 (Routing)
  ↓
Routing Header
  Next Header = 44 (Fragment)
  ↓
Fragment Header
  Next Header = 60 (Destination Options)
  ↓
Destination Options Header
  Next Header = 6 (TCP)
  ↓
TCP Header and Data

Recommended order (RFC 2460):
1. IPv6 base header
2. Hop-by-Hop Options
3. Destination Options (for intermediate destinations)
4. Routing
5. Fragment
6. Authentication (AH)
7. Encapsulating Security Payload (ESP)
8. Destination Options (for final destination)
9. Upper layer (TCP, UDP, ICMPv6, etc.)
</code></pre>
<h3 id="fragment-header"><a class="header" href="#fragment-header">Fragment Header</a></h3>
<pre><code>Fragmentation only at source (not routers!)

Format:
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Next Header  |   Reserved    |      Fragment Offset    |Res|M|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         Identification                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Next Header: Protocol after reassembly
Fragment Offset: Position in original packet (8-byte units)
M flag: More Fragments (1 = more, 0 = last)
Identification: Groups fragments together

Process:
1. Source tests path MTU
2. If packet &gt; MTU, source fragments
3. Router that cannot forward sends ICMPv6 "Packet Too Big"
4. Source reduces packet size or fragments
5. Destination reassembles

Note: Routers never fragment!
</code></pre>
<h2 id="icmpv6-internet-control-message-protocol-for-ipv6"><a class="header" href="#icmpv6-internet-control-message-protocol-for-ipv6">ICMPv6 (Internet Control Message Protocol for IPv6)</a></h2>
<p>ICMPv6 is integral to IPv6 operation:</p>
<h3 id="icmpv6-message-types"><a class="header" href="#icmpv6-message-types">ICMPv6 Message Types</a></h3>
<pre><code>Error Messages:

1   Destination Unreachable
    Code 0: No route to destination
    Code 1: Communication with destination administratively prohibited
    Code 3: Address unreachable
    Code 4: Port unreachable

2   Packet Too Big
    Used for Path MTU Discovery
    Includes MTU of next hop

3   Time Exceeded
    Code 0: Hop limit exceeded in transit
    Code 1: Fragment reassembly time exceeded

4   Parameter Problem
    Code 0: Erroneous header field
    Code 1: Unrecognized Next Header type

Informational Messages:

128 Echo Request (ping)
129 Echo Reply (ping response)

Neighbor Discovery (part of ICMPv6):

133 Router Solicitation
134 Router Advertisement
135 Neighbor Solicitation
136 Neighbor Advertisement
137 Redirect

Multicast Listener Discovery:

130 Multicast Listener Query
131 Multicast Listener Report
132 Multicast Listener Done
</code></pre>
<h3 id="ping6-example"><a class="header" href="#ping6-example">Ping6 Example</a></h3>
<pre><code class="language-bash"># Basic ping
ping6 2001:4860:4860::8888

# Ping link-local (must specify interface)
ping6 fe80::1%eth0

# Set packet size
ping6 -s 1000 2001:4860:4860::8888

# Set hop limit
ping6 -t 5 2001:4860:4860::8888

# Example output:
PING 2001:4860:4860::8888(2001:4860:4860::8888) 56 data bytes
64 bytes from 2001:4860:4860::8888: icmp_seq=1 ttl=118 time=10.2 ms
64 bytes from 2001:4860:4860::8888: icmp_seq=2 ttl=118 time=9.9 ms

--- 2001:4860:4860::8888 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1001ms
rtt min/avg/max/mdev = 9.900/10.050/10.200/0.150 ms
</code></pre>
<h3 id="path-mtu-discovery"><a class="header" href="#path-mtu-discovery">Path MTU Discovery</a></h3>
<pre><code>IPv6 requires source to fragment:

1. Source sends large packet (1500 bytes)

2. Router with smaller MTU (1400 bytes):
   - Cannot fragment (not allowed in IPv6)
   - Drops packet
   - Sends ICMPv6 Type 2 "Packet Too Big"
   - Includes MTU value (1400)

3. Source receives ICMPv6:
   - Reduces packet size to 1400
   - Retransmits

4. Success!
   - Source caches PMTU for destination
   - Uses smaller packets for this destination

Benefits:
- No fragmentation overhead at routers
- Better performance
- Source controls fragmentation
</code></pre>
<h2 id="ipv6-commands-and-tools"><a class="header" href="#ipv6-commands-and-tools">IPv6 Commands and Tools</a></h2>
<h3 id="ipv6-configuration-linux"><a class="header" href="#ipv6-configuration-linux">IPv6 Configuration (Linux)</a></h3>
<pre><code class="language-bash"># View IPv6 addresses
ip -6 addr show
ip -6 a

# Add IPv6 address
sudo ip -6 addr add 2001:db8::1/64 dev eth0

# Remove IPv6 address
sudo ip -6 addr del 2001:db8::1/64 dev eth0

# Enable IPv6 on interface
sudo sysctl -w net.ipv6.conf.eth0.disable_ipv6=0

# Disable IPv6 on interface
sudo sysctl -w net.ipv6.conf.eth0.disable_ipv6=1

# View IPv6 routing table
ip -6 route show

# Add IPv6 route
sudo ip -6 route add 2001:db8::/32 via 2001:db8::1

# Add default route
sudo ip -6 route add default via fe80::1 dev eth0

# View neighbor cache (NDP)
ip -6 neigh show
</code></pre>
<h3 id="ipv6-configuration-windows"><a class="header" href="#ipv6-configuration-windows">IPv6 Configuration (Windows)</a></h3>
<pre><code class="language-cmd"># View IPv6 configuration
netsh interface ipv6 show config
ipconfig

# Add IPv6 address
netsh interface ipv6 add address "Ethernet" 2001:db8::1/64

# Remove IPv6 address
netsh interface ipv6 delete address "Ethernet" 2001:db8::1

# Add route
netsh interface ipv6 add route 2001:db8::/32 "Ethernet" 2001:db8::1

# View IPv6 routing table
netsh interface ipv6 show route
route print -6

# View neighbor cache
netsh interface ipv6 show neighbors
</code></pre>
<h3 id="testing-connectivity"><a class="header" href="#testing-connectivity">Testing Connectivity</a></h3>
<pre><code class="language-bash"># Ping IPv6 address
ping6 2001:4860:4860::8888
ping -6 google.com

# Ping link-local (requires interface specification)
ping6 fe80::1%eth0
ping6 -I eth0 fe80::1

# Traceroute
traceroute6 google.com
traceroute -6 google.com

# TCP connection test
telnet 2001:4860:4860::8888 80
nc -6 google.com 80

# DNS lookup
host google.com
dig AAAA google.com
nslookup -type=AAAA google.com
</code></pre>
<h3 id="network-diagnostics"><a class="header" href="#network-diagnostics">Network Diagnostics</a></h3>
<pre><code class="language-bash"># View IPv6 sockets
ss -6 -tuln
netstat -6 -tuln

# View IPv6 connections
ss -6 -tun
netstat -6 -tun

# tcpdump for IPv6
sudo tcpdump -i eth0 ip6
sudo tcpdump -i eth0 'icmp6'
sudo tcpdump -i eth0 'ip6 and tcp port 80'

# Neighbor Discovery monitoring
sudo tcpdump -i eth0 'icmp6 and (ip6[40] &gt;= 133 and ip6[40] &lt;= 137)'
</code></pre>
<h2 id="ipv6-best-practices"><a class="header" href="#ipv6-best-practices">IPv6 Best Practices</a></h2>
<h3 id="1-address-planning"><a class="header" href="#1-address-planning">1. Address Planning</a></h3>
<pre><code>Use /48 for sites:
- Gives 65,536 subnets
- Future-proof
- Standard recommendation

Use /64 for subnets:
- Required for SLAAC
- Standard LAN size
- Even for point-to-point

Use /56 for small sites:
- 256 subnets
- Acceptable for small deployments

Hierarchy example:
2001:db8:abcd::/48                Organization
  2001:db8:abcd:0100::/56         Building 1
    2001:db8:abcd:0101::/64       Floor 1
    2001:db8:abcd:0102::/64       Floor 2
  2001:db8:abcd:0200::/56         Building 2
  2001:db8:abcd:1000::/56         Data center
</code></pre>
<h3 id="2-dual-stack"><a class="header" href="#2-dual-stack">2. Dual Stack</a></h3>
<pre><code>Run IPv4 and IPv6 simultaneously:

Benefits:
- Smooth transition
- Backward compatibility
- No disruption

Implementation:
- Enable IPv6 on all interfaces
- Maintain IPv4 for legacy
- Configure both protocols on servers
- Use DNS with A and AAAA records

Eventually:
- IPv6-only for new deployments
- IPv4 only where necessary
</code></pre>
<h3 id="3-security"><a class="header" href="#3-security">3. Security</a></h3>
<pre><code>IPv6-specific security considerations:

1. ICMPv6 is essential
   - Don't block all ICMPv6
   - Allow NDP (types 133-137)
   - Allow PMTU Discovery (type 2)
   - Allow Echo Request/Reply (types 128-129)

2. Link-local security
   - fe80::/10 should stay local
   - Don't route link-local

3. Disable IPv6 if not using
   - But preferably, enable and secure it
   - Attacks can use IPv6 if enabled but unmonitored

4. RA Guard
   - Prevent rogue router advertisements
   - Protect against MITM attacks

5. Extension headers
   - Many firewalls can't inspect them
   - Consider filtering or limiting

6. Privacy Extensions
   - Enable for client devices
   - Prevents tracking via EUI-64
</code></pre>
<h3 id="4-dns-configuration"><a class="header" href="#4-dns-configuration">4. DNS Configuration</a></h3>
<pre><code>Always configure both records:

example.com.     IN  A      192.0.2.1        (IPv4)
example.com.     IN  AAAA   2001:db8::1      (IPv6)

Test both:
dig A example.com
dig AAAA example.com

Reverse DNS:
IPv4: 1.2.0.192.in-addr.arpa
IPv6: 1.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.8.b.d.0.1.0.0.2.ip6.arpa

Configure resolver:
/etc/resolv.conf:
nameserver 2001:4860:4860::8888
nameserver 2001:4860:4860::8844
nameserver 8.8.8.8
</code></pre>
<h3 id="5-firewalling"><a class="header" href="#5-firewalling">5. Firewalling</a></h3>
<pre><code class="language-bash"># ip6tables example

# Allow established connections
ip6tables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT

# Allow loopback
ip6tables -A INPUT -i lo -j ACCEPT

# Allow ICMPv6
ip6tables -A INPUT -p ipv6-icmp -j ACCEPT

# Allow SSH
ip6tables -A INPUT -p tcp --dport 22 -j ACCEPT

# Allow HTTP/HTTPS
ip6tables -A INPUT -p tcp --dport 80 -j ACCEPT
ip6tables -A INPUT -p tcp --dport 443 -j ACCEPT

# Drop invalid packets
ip6tables -A INPUT -m state --state INVALID -j DROP

# Default drop
ip6tables -P INPUT DROP
ip6tables -P FORWARD DROP
ip6tables -P OUTPUT ACCEPT
</code></pre>
<h3 id="6-monitoring"><a class="header" href="#6-monitoring">6. Monitoring</a></h3>
<pre><code class="language-bash"># Monitor NDP
ip -6 neigh show
watch -n 1 'ip -6 neigh show'

# Monitor IPv6 traffic
sudo iftop -f "ip6"
sudo nethogs -6

# View IPv6 statistics
netstat -s -6

# Monitor routing
ip -6 route show
watch -n 1 'ip -6 route show'

# Check for IPv6 connectivity
ping6 -c 1 2001:4860:4860::8888 &amp;&amp; echo "IPv6 works" || echo "IPv6 fails"
</code></pre>
<h2 id="ipv6-transition-mechanisms"><a class="header" href="#ipv6-transition-mechanisms">IPv6 Transition Mechanisms</a></h2>
<h3 id="1-dual-stack"><a class="header" href="#1-dual-stack">1. Dual Stack</a></h3>
<pre><code>Run both IPv4 and IPv6:

Advantages:
+ Simple
+ No translation
+ Native performance

Disadvantages:
- Must manage both protocols
- Requires IPv4 addresses (scarce)

Best for: Long-term transition
</code></pre>
<h3 id="2-tunneling"><a class="header" href="#2-tunneling">2. Tunneling</a></h3>
<h4 id="6in4-manual-tunnel"><a class="header" href="#6in4-manual-tunnel">6in4 (Manual Tunnel)</a></h4>
<pre><code>IPv6 packets encapsulated in IPv4:

[IPv4 Header][IPv6 Header][Data]

Configuration:
# Linux
ip tunnel add ipv6tunnel mode sit remote 198.51.100.1 local 192.0.2.1
ip link set ipv6tunnel up
ip addr add 2001:db8::2/64 dev ipv6tunnel
ip route add ::/0 dev ipv6tunnel

Use case: Static IPv6 over IPv4
</code></pre>
<h4 id="6to4"><a class="header" href="#6to4">6to4</a></h4>
<pre><code>Automatic tunneling using 2002::/16:

IPv4: 192.0.2.1
IPv6: 2002:c000:0201::/48
      (c000:0201 = 192.0.2.1 in hex)

Deprecated: Security issues
</code></pre>
<h4 id="teredo"><a class="header" href="#teredo">Teredo</a></h4>
<pre><code>Tunneling for NAT environments:

Prefix: 2001::/32

Use case: Windows clients behind NAT
Status: Deprecated, use native IPv6
</code></pre>
<h3 id="3-nat64dns64"><a class="header" href="#3-nat64dns64">3. NAT64/DNS64</a></h3>
<pre><code>Allow IPv6-only clients to access IPv4 services:

IPv6 client (2001:db8::1)
    ↓ Request "www.example.com"
DNS64 server
    ↓ Returns 64:ff9b::192.0.2.1 (synthesized AAAA)
IPv6 client
    ↓ Connects to 64:ff9b::192.0.2.1
NAT64 gateway
    ↓ Translates to IPv4: 192.0.2.1
IPv4 server (192.0.2.1)

Use case: IPv6-only networks accessing IPv4 internet
</code></pre>
<h2 id="ipv6-vs-ipv4-comparison"><a class="header" href="#ipv6-vs-ipv4-comparison">IPv6 vs IPv4 Comparison</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Feature</th><th>IPv4</th><th>IPv6</th></tr></thead><tbody>
<tr><td><strong>Address length</strong></td><td>32 bits</td><td>128 bits</td></tr>
<tr><td><strong>Address format</strong></td><td>Decimal (192.0.2.1)</td><td>Hexadecimal (2001:db8::1)</td></tr>
<tr><td><strong>Address space</strong></td><td>4.3 billion</td><td>340 undecillion</td></tr>
<tr><td><strong>Header size</strong></td><td>20-60 bytes (variable)</td><td>40 bytes (fixed)</td></tr>
<tr><td><strong>Checksum</strong></td><td>Yes</td><td>No</td></tr>
<tr><td><strong>Fragmentation</strong></td><td>Routers and source</td><td>Source only</td></tr>
<tr><td><strong>Broadcast</strong></td><td>Yes</td><td>No (multicast)</td></tr>
<tr><td><strong>Multicast</strong></td><td>Optional</td><td>Built-in</td></tr>
<tr><td><strong>IPSec</strong></td><td>Optional</td><td>Mandatory</td></tr>
<tr><td><strong>Address resolution</strong></td><td>ARP</td><td>NDP</td></tr>
<tr><td><strong>Auto-configuration</strong></td><td>DHCP</td><td>SLAAC or DHCPv6</td></tr>
<tr><td><strong>NAT</strong></td><td>Common</td><td>Not needed</td></tr>
<tr><td><strong>Options</strong></td><td>In header</td><td>Extension headers</td></tr>
<tr><td><strong>Jumbograms</strong></td><td>No</td><td>Yes (&gt;65535 bytes)</td></tr>
<tr><td><strong>Mobile IP</strong></td><td>Extension</td><td>Built-in</td></tr>
</tbody></table>
</div>
<h2 id="eli10-ipv6-explained-simply"><a class="header" href="#eli10-ipv6-explained-simply">ELI10: IPv6 Explained Simply</a></h2>
<p>Think of IPv6 as a massive upgrade to the internet's addressing system:</p>
<h3 id="the-address-problem"><a class="header" href="#the-address-problem">The Address Problem</a></h3>
<pre><code>IPv4 (old):
- Like phone numbers with 10 digits
- Only 4.3 billion addresses
- Running out (like phone numbers in 1990s)

IPv6 (new):
- Like phone numbers with 39 digits
- 340 undecillion addresses
- Enough for every atom on Earth to have trillions of IPs
- We'll NEVER run out
</code></pre>
<h3 id="address-format"><a class="header" href="#address-format">Address Format</a></h3>
<pre><code>IPv4: 192.168.1.1
- Four numbers (0-255)
- Separated by dots

IPv6: 2001:db8::1
- Eight groups of hex digits (0-9, a-f)
- Separated by colons
- Can compress zeros with ::
</code></pre>
<h3 id="auto-configuration"><a class="header" href="#auto-configuration">Auto-Configuration</a></h3>
<pre><code>IPv4:
- Need DHCP server
- Manual configuration for servers
- "Hey DHCP, give me an address!"

IPv6:
- Auto-configures itself (SLAAC)
- Listens for router
- Creates own address
- "I'll make my own address, thanks!"
</code></pre>
<h3 id="no-more-nat"><a class="header" href="#no-more-nat">No More NAT</a></h3>
<pre><code>IPv4 with NAT:
Home: All devices share one public IP
      Like apartment building with one mailbox

IPv6:
Home: Every device gets its own public IP
      Like every apartment having its own mailbox
      Direct delivery, no sharing needed
</code></pre>
<h3 id="better-security"><a class="header" href="#better-security">Better Security</a></h3>
<pre><code>IPv4:
- Security added later (IPSec optional)
- Like adding locks to old houses

IPv6:
- Security built-in (IPSec mandatory)
- Like new houses with locks included
</code></pre>
<h3 id="link-local-addresses"><a class="header" href="#link-local-addresses">Link-Local Addresses</a></h3>
<pre><code>Every IPv6 device has:
1. Link-local (fe80::): For local network (like intercom)
2. Global (2001:...): For internet (like phone number)

Always have both, automatic!
</code></pre>
<h2 id="further-resources-26"><a class="header" href="#further-resources-26">Further Resources</a></h2>
<ul>
<li><a href="https://tools.ietf.org/html/rfc8200">RFC 8200 - IPv6 Specification</a></li>
<li><a href="https://tools.ietf.org/html/rfc4291">RFC 4291 - IPv6 Addressing Architecture</a></li>
<li><a href="https://tools.ietf.org/html/rfc4862">RFC 4862 - IPv6 Stateless Address Autoconfiguration</a></li>
<li><a href="https://tools.ietf.org/html/rfc4861">RFC 4861 - Neighbor Discovery for IPv6</a></li>
<li><a href="https://tools.ietf.org/html/rfc4941">RFC 4941 - Privacy Extensions for SLAAC</a></li>
<li><a href="https://tools.ietf.org/html/rfc3484">RFC 3484 - Default Address Selection</a></li>
<li><a href="https://test-ipv6.com/">IPv6 Test</a> - Test your IPv6 connectivity</li>
<li><a href="https://ipv6.he.net/certification/">Hurricane Electric IPv6 Certification</a> - Free IPv6 training</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="tcp-transmission-control-protocol-2"><a class="header" href="#tcp-transmission-control-protocol-2">TCP (Transmission Control Protocol)</a></h1>
<p>TCP is a connection-oriented, reliable transport layer protocol that provides ordered delivery of data between applications running on hosts in an IP network. It is one of the core protocols of the Internet Protocol Suite.</p>
<h2 id="key-features-17"><a class="header" href="#key-features-17">Key Features</a></h2>
<ul>
<li><strong>Connection-Oriented</strong>: Establishes connection before data transfer</li>
<li><strong>Reliable</strong>: Guarantees delivery of data in order</li>
<li><strong>Error Checking</strong>: Detects corrupted data with checksums</li>
<li><strong>Flow Control</strong>: Manages data transmission rate</li>
<li><strong>Congestion Control</strong>: Adjusts to network conditions</li>
<li><strong>Full-Duplex</strong>: Bidirectional communication</li>
</ul>
<h2 id="tcp-packet-format"><a class="header" href="#tcp-packet-format">TCP Packet Format</a></h2>
<pre><code>  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |          Source Port          |       Destination Port        |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                        Sequence Number                        |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                    Acknowledgment Number                      |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |  Data |       |C|E|U|A|P|R|S|F|                               |
 | Offset| Rsrvd |W|C|R|C|S|S|Y|I|            Window             |
 |       |       |R|E|G|K|H|T|N|N|                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |           Checksum            |         Urgent Pointer        |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                    Options                    |    Padding    |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                             Data                              |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</code></pre>
<h3 id="header-fields"><a class="header" href="#header-fields">Header Fields</a></h3>
<ul>
<li><strong>Source Port</strong> (16 bits): Sending application port number</li>
<li><strong>Destination Port</strong> (16 bits): Receiving application port number</li>
<li><strong>Sequence Number</strong> (32 bits): Position of first data byte in segment</li>
<li><strong>Acknowledgment Number</strong> (32 bits): Next expected sequence number</li>
<li><strong>Data Offset</strong> (4 bits): Size of TCP header in 32-bit words</li>
<li><strong>Reserved</strong> (3 bits): Reserved for future use</li>
<li><strong>Control Flags</strong> (9 bits): Connection control flags</li>
<li><strong>Window Size</strong> (16 bits): Receive window size</li>
<li><strong>Checksum</strong> (16 bits): Error detection</li>
<li><strong>Urgent Pointer</strong> (16 bits): Offset of urgent data</li>
<li><strong>Options</strong> (variable): Optional header extensions</li>
<li><strong>Padding</strong>: Ensures header is multiple of 32 bits</li>
</ul>
<h3 id="control-flags"><a class="header" href="#control-flags">Control Flags</a></h3>
<ul>
<li><strong>CWR</strong> (Congestion Window Reduced): ECN-Echo flag received</li>
<li><strong>ECE</strong> (ECN-Echo): Congestion experienced</li>
<li><strong>URG</strong> (Urgent): Urgent pointer field is valid</li>
<li><strong>ACK</strong> (Acknowledgment): Acknowledgment number is valid</li>
<li><strong>PSH</strong> (Push): Push buffered data to application</li>
<li><strong>RST</strong> (Reset): Reset the connection</li>
<li><strong>SYN</strong> (Synchronize): Synchronize sequence numbers (connection setup)</li>
<li><strong>FIN</strong> (Finish): No more data from sender (connection termination)</li>
</ul>
<h2 id="three-way-handshake"><a class="header" href="#three-way-handshake">Three-Way Handshake</a></h2>
<p>TCP uses a three-way handshake to establish a connection:</p>
<pre><code>Client                                  Server
  |                                       |
  |  SYN (seq=x)                         |
  |--------------------------------------&gt;|
  |                                       |
  |         SYN-ACK (seq=y, ack=x+1)    |
  |&lt;--------------------------------------|
  |                                       |
  |  ACK (seq=x+1, ack=y+1)             |
  |--------------------------------------&gt;|
  |                                       |
  |     Connection Established            |
  |                                       |
</code></pre>
<ol>
<li><strong>SYN</strong>: Client sends SYN packet with initial sequence number</li>
<li><strong>SYN-ACK</strong>: Server responds with SYN-ACK, includes its own sequence number</li>
<li><strong>ACK</strong>: Client sends ACK to confirm, connection established</li>
</ol>
<h3 id="python-example-tcp-client"><a class="header" href="#python-example-tcp-client">Python Example: TCP Client</a></h3>
<pre><code class="language-python">import socket

# Create TCP socket
client_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

# Connect to server (three-way handshake happens here)
server_address = ('localhost', 8080)
client_socket.connect(server_address)
print(f"Connected to {server_address}")

# Send data
message = "Hello, Server!"
client_socket.sendall(message.encode())

# Receive response
response = client_socket.recv(1024)
print(f"Received: {response.decode()}")

# Close connection
client_socket.close()
</code></pre>
<h3 id="python-example-tcp-server"><a class="header" href="#python-example-tcp-server">Python Example: TCP Server</a></h3>
<pre><code class="language-python">import socket

# Create TCP socket
server_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

# Bind to address and port
server_address = ('localhost', 8080)
server_socket.bind(server_address)

# Listen for connections
server_socket.listen(5)
print(f"Server listening on {server_address}")

while True:
    # Accept connection (completes three-way handshake)
    client_socket, client_address = server_socket.accept()
    print(f"Connection from {client_address}")

    try:
        # Receive data
        data = client_socket.recv(1024)
        print(f"Received: {data.decode()}")

        # Send response
        response = "Hello, Client!"
        client_socket.sendall(response.encode())
    finally:
        # Close connection
        client_socket.close()
</code></pre>
<h2 id="connection-termination"><a class="header" href="#connection-termination">Connection Termination</a></h2>
<p>TCP uses a four-way handshake to close a connection gracefully:</p>
<pre><code>Client                                  Server
  |                                       |
  |  FIN (seq=x)                         |
  |--------------------------------------&gt;|
  |                                       |
  |         ACK (ack=x+1)                |
  |&lt;--------------------------------------|
  |                                       |
  |         FIN (seq=y)                  |
  |&lt;--------------------------------------|
  |                                       |
  |  ACK (ack=y+1)                       |
  |--------------------------------------&gt;|
  |                                       |
  |     Connection Closed                 |
</code></pre>
<ol>
<li><strong>FIN</strong>: Active closer sends FIN</li>
<li><strong>ACK</strong>: Passive closer acknowledges FIN</li>
<li><strong>FIN</strong>: Passive closer sends its FIN</li>
<li><strong>ACK</strong>: Active closer acknowledges FIN</li>
</ol>
<h2 id="tcp-state-machine"><a class="header" href="#tcp-state-machine">TCP State Machine</a></h2>
<pre><code>         CLOSED
           |
           | (active open/SYN)
           v
       SYN-SENT
           |
           | (SYN received/SYN-ACK sent)
           v
    SYN-RECEIVED
           |
           | (ACK received)
           v
      ESTABLISHED
           |
           | (close/FIN sent)
           v
       FIN-WAIT-1
           |
           | (ACK received)
           v
       FIN-WAIT-2
           |
           | (FIN received/ACK sent)
           v
       TIME-WAIT
           |
           | (2*MSL timeout)
           v
         CLOSED
</code></pre>
<h3 id="tcp-states"><a class="header" href="#tcp-states">TCP States</a></h3>
<ul>
<li><strong>CLOSED</strong>: No connection</li>
<li><strong>LISTEN</strong>: Server waiting for connection request</li>
<li><strong>SYN-SENT</strong>: Client sent SYN, waiting for SYN-ACK</li>
<li><strong>SYN-RECEIVED</strong>: Server received SYN, sent SYN-ACK</li>
<li><strong>ESTABLISHED</strong>: Connection established, data transfer</li>
<li><strong>FIN-WAIT-1</strong>: Sent FIN, waiting for ACK</li>
<li><strong>FIN-WAIT-2</strong>: Received ACK of FIN, waiting for peer FIN</li>
<li><strong>CLOSE-WAIT</strong>: Received FIN, waiting for close</li>
<li><strong>CLOSING</strong>: Both sides sent FIN simultaneously</li>
<li><strong>LAST-ACK</strong>: Waiting for final ACK</li>
<li><strong>TIME-WAIT</strong>: Waiting to ensure remote received ACK</li>
<li><strong>CLOSED</strong>: Connection fully terminated</li>
</ul>
<h3 id="check-connection-states"><a class="header" href="#check-connection-states">Check Connection States</a></h3>
<pre><code class="language-bash"># Linux - Show all TCP connections
netstat -tan

# Show listening ports
netstat -tln

# Show established connections
netstat -tan | grep ESTABLISHED

# Alternative: ss command (faster)
ss -tan
ss -tln
ss -tan state established

# Show connection state for specific port
ss -tan '( dport = :80 or sport = :80 )'
</code></pre>
<h2 id="flow-control"><a class="header" href="#flow-control">Flow Control</a></h2>
<p>TCP uses a sliding window protocol for flow control:</p>
<pre><code class="language-python">import socket
import time

def tcp_receiver_with_flow_control():
    """
    Receiver controls flow using window size
    """
    server = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    server.bind(('localhost', 8080))
    server.listen(1)

    conn, addr = server.accept()

    # Set receive buffer size (affects window size)
    conn.setsockopt(socket.SOL_SOCKET, socket.SO_RCVBUF, 4096)

    total_received = 0
    while True:
        data = conn.recv(1024)
        if not data:
            break

        total_received += len(data)
        print(f"Received {len(data)} bytes, total: {total_received}")

        # Simulate slow processing
        time.sleep(0.1)

    conn.close()
    server.close()

def tcp_sender():
    """
    Sender adapts to receiver's window size
    """
    client = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    client.connect(('localhost', 8080))

    # Set send buffer size
    client.setsockopt(socket.SOL_SOCKET, socket.SO_SNDBUF, 8192)

    # Send large amount of data
    data = b'X' * 100000
    sent = 0

    while sent &lt; len(data):
        chunk = data[sent:sent+1024]
        try:
            bytes_sent = client.send(chunk)
            sent += bytes_sent
            print(f"Sent {bytes_sent} bytes, total: {sent}")
        except socket.error as e:
            print(f"Send error: {e}")
            break

    client.close()
</code></pre>
<h2 id="congestion-control"><a class="header" href="#congestion-control">Congestion Control</a></h2>
<p>TCP implements congestion control algorithms:</p>
<h3 id="algorithms-1"><a class="header" href="#algorithms-1">Algorithms</a></h3>
<ol>
<li><strong>Slow Start</strong>: Exponentially increase congestion window</li>
<li><strong>Congestion Avoidance</strong>: Linearly increase window</li>
<li><strong>Fast Retransmit</strong>: Retransmit on 3 duplicate ACKs</li>
<li><strong>Fast Recovery</strong>: Reduce window, avoid slow start</li>
</ol>
<pre><code>Window Size
    ^
    |     Slow Start  | Congestion Avoidance
    |                /|
    |              /  |
    |            /    |_______________
    |          /      |               \
    |        /        |                \
    |      /          |                 \ Fast Recovery
    |    /            |                  \_______________
    |  /              |
    |/________________|________________________&gt; Time
         Threshold
</code></pre>
<h3 id="check-tcp-congestion-control"><a class="header" href="#check-tcp-congestion-control">Check TCP Congestion Control</a></h3>
<pre><code class="language-bash"># Linux - Check current algorithm
sysctl net.ipv4.tcp_congestion_control

# Available algorithms
sysctl net.ipv4.tcp_available_congestion_control

# Set congestion control algorithm
sudo sysctl -w net.ipv4.tcp_congestion_control=cubic

# Common algorithms:
# - cubic (default on most Linux)
# - reno (traditional)
# - bbr (Google's BBR)
# - vegas
</code></pre>
<h2 id="retransmission"><a class="header" href="#retransmission">Retransmission</a></h2>
<p>TCP retransmits lost or corrupted packets:</p>
<pre><code class="language-python">import socket
import time

def tcp_with_timeout():
    """
    TCP automatically handles retransmission
    """
    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

    # Set timeout for operations
    sock.settimeout(5.0)

    try:
        sock.connect(('example.com', 80))

        # Send HTTP request
        request = b"GET / HTTP/1.1\r\nHost: example.com\r\n\r\n"
        sock.sendall(request)

        # Receive response
        response = sock.recv(4096)
        print(f"Received {len(response)} bytes")

    except socket.timeout:
        print("Operation timed out - TCP retransmission may be occurring")
    except socket.error as e:
        print(f"Socket error: {e}")
    finally:
        sock.close()
</code></pre>
<h3 id="retransmission-timeout-rto"><a class="header" href="#retransmission-timeout-rto">Retransmission Timeout (RTO)</a></h3>
<pre><code class="language-bash"># Linux - View TCP retransmission statistics
netstat -s | grep -i retrans

# Check retransmission timer settings
sysctl net.ipv4.tcp_retries1  # Threshold for alerting
sysctl net.ipv4.tcp_retries2  # Maximum retries before giving up

# Typical values:
# tcp_retries1 = 3  (alert after 3-6 seconds)
# tcp_retries2 = 15 (give up after ~13-30 minutes)
</code></pre>
<h2 id="tcp-options"><a class="header" href="#tcp-options">TCP Options</a></h2>
<p>Common TCP options in the header:</p>
<h3 id="maximum-segment-size-mss"><a class="header" href="#maximum-segment-size-mss">Maximum Segment Size (MSS)</a></h3>
<pre><code class="language-python">import socket

sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

# Set TCP_MAXSEG option (MSS)
sock.setsockopt(socket.IPPROTO_TCP, socket.TCP_MAXSEG, 1400)

# Get current MSS
mss = sock.getsockopt(socket.IPPROTO_TCP, socket.TCP_MAXSEG)
print(f"TCP MSS: {mss}")
</code></pre>
<h3 id="window-scaling"><a class="header" href="#window-scaling">Window Scaling</a></h3>
<pre><code class="language-bash"># Enable TCP window scaling (Linux)
sudo sysctl -w net.ipv4.tcp_window_scaling=1

# Check current setting
sysctl net.ipv4.tcp_window_scaling
</code></pre>
<h3 id="selective-acknowledgment-sack"><a class="header" href="#selective-acknowledgment-sack">Selective Acknowledgment (SACK)</a></h3>
<pre><code class="language-bash"># Enable SACK (Linux)
sudo sysctl -w net.ipv4.tcp_sack=1

# Check current setting
sysctl net.ipv4.tcp_sack
</code></pre>
<h3 id="timestamps"><a class="header" href="#timestamps">Timestamps</a></h3>
<pre><code class="language-bash"># Enable TCP timestamps
sudo sysctl -w net.ipv4.tcp_timestamps=1

# Check current setting
sysctl net.ipv4.tcp_timestamps
</code></pre>
<h2 id="tcp-vs-udp"><a class="header" href="#tcp-vs-udp">TCP vs UDP</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Feature</th><th>TCP</th><th>UDP</th></tr></thead><tbody>
<tr><td>Connection</td><td>Connection-oriented</td><td>Connectionless</td></tr>
<tr><td>Reliability</td><td>Guaranteed delivery</td><td>No guarantee</td></tr>
<tr><td>Ordering</td><td>In-order delivery</td><td>No ordering</td></tr>
<tr><td>Speed</td><td>Slower (overhead)</td><td>Faster (minimal overhead)</td></tr>
<tr><td>Header Size</td><td>20-60 bytes</td><td>8 bytes</td></tr>
<tr><td>Error Checking</td><td>Yes (checksum)</td><td>Yes (checksum)</td></tr>
<tr><td>Flow Control</td><td>Yes</td><td>No</td></tr>
<tr><td>Congestion Control</td><td>Yes</td><td>No</td></tr>
<tr><td>Use Cases</td><td>HTTP, FTP, SSH, Email</td><td>DNS, VoIP, Streaming, Gaming</td></tr>
</tbody></table>
</div>
<h3 id="when-to-use-tcp"><a class="header" href="#when-to-use-tcp">When to Use TCP</a></h3>
<ul>
<li>File transfers</li>
<li>Email</li>
<li>Web browsing</li>
<li>Remote shell (SSH)</li>
<li>Any application requiring reliability</li>
</ul>
<h3 id="when-to-use-udp"><a class="header" href="#when-to-use-udp">When to Use UDP</a></h3>
<ul>
<li>Real-time applications (VoIP, video streaming)</li>
<li>DNS queries</li>
<li>Online gaming</li>
<li>IoT devices with small data</li>
<li>Broadcasting/multicasting</li>
</ul>
<h2 id="performance-tuning-2"><a class="header" href="#performance-tuning-2">Performance Tuning</a></h2>
<h3 id="socket-buffer-sizes"><a class="header" href="#socket-buffer-sizes">Socket Buffer Sizes</a></h3>
<pre><code class="language-python">import socket

sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

# Increase buffer sizes for high-throughput applications
sock.setsockopt(socket.SOL_SOCKET, socket.SO_RCVBUF, 1024 * 1024)  # 1MB receive
sock.setsockopt(socket.SOL_SOCKET, socket.SO_SNDBUF, 1024 * 1024)  # 1MB send

# Get buffer sizes
rcvbuf = sock.getsockopt(socket.SOL_SOCKET, socket.SO_RCVBUF)
sndbuf = sock.getsockopt(socket.SOL_SOCKET, socket.SO_SNDBUF)
print(f"Receive buffer: {rcvbuf}, Send buffer: {sndbuf}")
</code></pre>
<h3 id="tcp-keepalive"><a class="header" href="#tcp-keepalive">TCP Keepalive</a></h3>
<pre><code class="language-python">import socket

sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

# Enable keepalive
sock.setsockopt(socket.SOL_SOCKET, socket.SO_KEEPALIVE, 1)

# Set keepalive parameters (Linux)
sock.setsockopt(socket.IPPROTO_TCP, socket.TCP_KEEPIDLE, 60)    # Start after 60s
sock.setsockopt(socket.IPPROTO_TCP, socket.TCP_KEEPINTVL, 10)   # Interval 10s
sock.setsockopt(socket.IPPROTO_TCP, socket.TCP_KEEPCNT, 3)      # Retry 3 times
</code></pre>
<h3 id="nagles-algorithm"><a class="header" href="#nagles-algorithm">Nagle's Algorithm</a></h3>
<pre><code class="language-python">import socket

sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

# Disable Nagle's algorithm for low-latency applications
sock.setsockopt(socket.IPPROTO_TCP, socket.TCP_NODELAY, 1)

# Check status
nodelay = sock.getsockopt(socket.IPPROTO_TCP, socket.TCP_NODELAY)
print(f"TCP_NODELAY: {nodelay}")
</code></pre>
<h3 id="linux-kernel-tuning"><a class="header" href="#linux-kernel-tuning">Linux Kernel Tuning</a></h3>
<pre><code class="language-bash"># Increase maximum buffer sizes
sudo sysctl -w net.core.rmem_max=16777216
sudo sysctl -w net.core.wmem_max=16777216

# Set TCP buffer sizes (min, default, max)
sudo sysctl -w net.ipv4.tcp_rmem="4096 87380 16777216"
sudo sysctl -w net.ipv4.tcp_wmem="4096 65536 16777216"

# Increase backlog queue
sudo sysctl -w net.core.somaxconn=1024
sudo sysctl -w net.ipv4.tcp_max_syn_backlog=2048

# Enable TCP Fast Open
sudo sysctl -w net.ipv4.tcp_fastopen=3

# Reuse TIME_WAIT sockets
sudo sysctl -w net.ipv4.tcp_tw_reuse=1
</code></pre>
<h2 id="troubleshooting-21"><a class="header" href="#troubleshooting-21">Troubleshooting</a></h2>
<h3 id="analyze-tcp-with-tcpdump"><a class="header" href="#analyze-tcp-with-tcpdump">Analyze TCP with tcpdump</a></h3>
<pre><code class="language-bash"># Capture TCP traffic on port 80
sudo tcpdump -i any tcp port 80 -n

# Capture SYN packets
sudo tcpdump 'tcp[tcpflags] &amp; (tcp-syn) != 0' -n

# Capture RST packets
sudo tcpdump 'tcp[tcpflags] &amp; (tcp-rst) != 0' -n

# Save to file for analysis
sudo tcpdump -i any tcp port 80 -w capture.pcap

# Read from file
tcpdump -r capture.pcap -n
</code></pre>
<h3 id="analyze-with-wireshark"><a class="header" href="#analyze-with-wireshark">Analyze with Wireshark</a></h3>
<pre><code class="language-bash"># Start Wireshark
wireshark

# Useful display filters:
# tcp.port == 80
# tcp.flags.syn == 1
# tcp.flags.reset == 1
# tcp.analysis.retransmission
# tcp.analysis.duplicate_ack
# tcp.window_size_value &lt; 1000
</code></pre>
<h3 id="common-issues-22"><a class="header" href="#common-issues-22">Common Issues</a></h3>
<p><strong>Connection Refused</strong></p>
<pre><code class="language-bash"># Check if port is listening
netstat -tln | grep :80

# Check firewall
sudo iptables -L -n | grep 80
</code></pre>
<p><strong>Connection Timeout</strong></p>
<pre><code class="language-bash"># Test connectivity
telnet example.com 80

# Check routing
traceroute example.com

# Test with timeout
timeout 5 telnet example.com 80
</code></pre>
<p><strong>Slow Connection</strong></p>
<pre><code class="language-python">import socket
import time

def measure_tcp_performance():
    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

    # Measure connection time
    start = time.time()
    sock.connect(('example.com', 80))
    connect_time = time.time() - start
    print(f"Connection time: {connect_time:.3f}s")

    # Send request
    request = b"GET / HTTP/1.1\r\nHost: example.com\r\n\r\n"
    start = time.time()
    sock.sendall(request)
    send_time = time.time() - start
    print(f"Send time: {send_time:.3f}s")

    # Receive response
    start = time.time()
    data = sock.recv(4096)
    recv_time = time.time() - start
    print(f"Receive time: {recv_time:.3f}s")
    print(f"Received {len(data)} bytes")

    sock.close()

measure_tcp_performance()
</code></pre>
<h3 id="monitoring-tcp-connections"><a class="header" href="#monitoring-tcp-connections">Monitoring TCP Connections</a></h3>
<pre><code class="language-bash"># Real-time connection monitoring
watch -n 1 'netstat -tan | grep ESTABLISHED | wc -l'

# Connection state distribution
netstat -tan | awk '{print $6}' | sort | uniq -c

# Show connections with process info
sudo netstat -tanp

# Alternative with ss
ss -tanp state established
</code></pre>
<h2 id="advanced-topics-3"><a class="header" href="#advanced-topics-3">Advanced Topics</a></h2>
<h3 id="tcp-fast-open-tfo"><a class="header" href="#tcp-fast-open-tfo">TCP Fast Open (TFO)</a></h3>
<p>Reduces latency by sending data in SYN packet:</p>
<pre><code class="language-python">import socket

# Client with TFO
sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

# Enable TFO (requires kernel support)
sock.setsockopt(socket.IPPROTO_TCP, socket.TCP_FASTOPEN, 1)

# Send data during connection (SYN packet)
data = b"GET / HTTP/1.1\r\nHost: example.com\r\n\r\n"
sock.sendto(data, socket.MSG_FASTOPEN, ('example.com', 80))
</code></pre>
<h3 id="tcp-multipath-mptcp"><a class="header" href="#tcp-multipath-mptcp">TCP Multipath (MPTCP)</a></h3>
<p>Allows connection over multiple paths:</p>
<pre><code class="language-bash"># Check if MPTCP is available (Linux)
sysctl net.mptcp.enabled

# Enable MPTCP
sudo sysctl -w net.mptcp.enabled=1
</code></pre>
<h3 id="zero-copy"><a class="header" href="#zero-copy">Zero Copy</a></h3>
<p>Improve performance with zero-copy operations:</p>
<pre><code class="language-python">import socket
import os

def sendfile_example(sock, filename):
    """
    Send file using zero-copy sendfile
    """
    with open(filename, 'rb') as f:
        # Get file size
        file_size = os.fstat(f.fileno()).st_size

        # Send file using sendfile (zero-copy)
        offset = 0
        while offset &lt; file_size:
            sent = os.sendfile(sock.fileno(), f.fileno(), offset, file_size - offset)
            offset += sent
</code></pre>
<h2 id="best-practices-69"><a class="header" href="#best-practices-69">Best Practices</a></h2>
<ol>
<li><strong>Always close sockets</strong>: Use try-finally or context managers</li>
<li><strong>Set appropriate timeouts</strong>: Avoid hanging indefinitely</li>
<li><strong>Handle errors gracefully</strong>: Network can fail at any time</li>
<li><strong>Use connection pooling</strong>: Reuse connections for better performance</li>
<li><strong>Enable keepalive for long connections</strong>: Detect dead connections</li>
<li><strong>Tune buffer sizes for workload</strong>: Larger for throughput, smaller for latency</li>
<li><strong>Monitor connection states</strong>: Watch for TIME_WAIT buildup</li>
<li><strong>Use TCP_NODELAY for interactive apps</strong>: Reduce latency</li>
<li><strong>Enable window scaling for high-bandwidth</strong>: Support larger windows</li>
<li><strong>Test under load</strong>: Verify behavior under stress</li>
</ol>
<h2 id="references-1"><a class="header" href="#references-1">References</a></h2>
<ul>
<li><a href="https://tools.ietf.org/html/rfc793">RFC 793</a> - TCP Specification</li>
<li><a href="https://tools.ietf.org/html/rfc1323">RFC 1323</a> - TCP Extensions (Window Scaling, Timestamps)</li>
<li><a href="https://tools.ietf.org/html/rfc2018">RFC 2018</a> - TCP Selective Acknowledgment</li>
<li><a href="https://tools.ietf.org/html/rfc7413">RFC 7413</a> - TCP Fast Open</li>
<li><a href="https://tools.ietf.org/html/rfc8684">RFC 8684</a> - Multipath TCP</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="udp-user-datagram-protocol-2"><a class="header" href="#udp-user-datagram-protocol-2">UDP (User Datagram Protocol)</a></h1>
<h2 id="overview-77"><a class="header" href="#overview-77">Overview</a></h2>
<p>UDP is a connectionless transport layer protocol that provides fast, unreliable data transmission. Unlike TCP, UDP doesn't guarantee delivery, ordering, or error checking, making it ideal for time-sensitive applications where speed matters more than reliability.</p>
<h2 id="udp-vs-tcp"><a class="header" href="#udp-vs-tcp">UDP vs TCP</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Feature</th><th>UDP</th><th>TCP</th></tr></thead><tbody>
<tr><td><strong>Connection</strong></td><td>Connectionless</td><td>Connection-oriented</td></tr>
<tr><td><strong>Reliability</strong></td><td>Unreliable (no guarantee)</td><td>Reliable (guaranteed delivery)</td></tr>
<tr><td><strong>Ordering</strong></td><td>No ordering</td><td>Ordered delivery</td></tr>
<tr><td><strong>Speed</strong></td><td>Fast (low overhead)</td><td>Slower (more overhead)</td></tr>
<tr><td><strong>Header Size</strong></td><td>8 bytes</td><td>20-60 bytes</td></tr>
<tr><td><strong>Error Checking</strong></td><td>Optional checksum</td><td>Mandatory checksum + retransmission</td></tr>
<tr><td><strong>Flow Control</strong></td><td>None</td><td>Yes (window-based)</td></tr>
<tr><td><strong>Congestion Control</strong></td><td>None</td><td>Yes</td></tr>
<tr><td><strong>Use Cases</strong></td><td>Streaming, gaming, DNS, VoIP</td><td>File transfer, web, email</td></tr>
</tbody></table>
</div>
<h2 id="udp-packet-format"><a class="header" href="#udp-packet-format">UDP Packet Format</a></h2>
<pre><code> 0      7 8     15 16    23 24    31
+--------+--------+--------+--------+
|     Source      |   Destination   |
|      Port       |      Port       |
+--------+--------+--------+--------+
|                 |                 |
|     Length      |    Checksum     |
+--------+--------+--------+--------+
|                                   |
|          Data octets ...          |
+-----------------------------------+
</code></pre>
<h3 id="header-fields-8-bytes-total"><a class="header" href="#header-fields-8-bytes-total">Header Fields (8 bytes total)</a></h3>
<ol>
<li><strong>Source Port</strong> (16 bits): Port number of sender (optional, can be 0)</li>
<li><strong>Destination Port</strong> (16 bits): Port number of receiver</li>
<li><strong>Length</strong> (16 bits): Length of UDP header + data (minimum 8 bytes)</li>
<li><strong>Checksum</strong> (16 bits): Error checking (optional in IPv4, mandatory in IPv6)</li>
</ol>
<h3 id="example-udp-header"><a class="header" href="#example-udp-header">Example UDP Header</a></h3>
<pre><code>Source Port: 53210 (0xCFCA)
Destination Port: 53 (0x0035) - DNS
Length: 512 bytes
Checksum: 0x1A2B
</code></pre>
<p><strong>Hexadecimal representation:</strong></p>
<pre><code>CF CA 00 35 02 00 1A 2B
[... 504 bytes of data ...]
</code></pre>
<h2 id="how-udp-works"><a class="header" href="#how-udp-works">How UDP Works</a></h2>
<h3 id="sending-data-1"><a class="header" href="#sending-data-1">Sending Data</a></h3>
<pre><code>Application → Socket → UDP Layer → IP Layer → Network

1. Application writes data to UDP socket
2. UDP adds 8-byte header
3. UDP passes datagram to IP layer
4. IP sends packet to destination
5. No acknowledgment expected
</code></pre>
<h3 id="receiving-data-1"><a class="header" href="#receiving-data-1">Receiving Data</a></h3>
<pre><code>Network → IP Layer → UDP Layer → Socket → Application

1. IP receives packet
2. IP passes to UDP based on protocol number (17)
3. UDP validates checksum (if present)
4. UDP delivers to application based on port
5. If port not listening, send ICMP "Port Unreachable"
</code></pre>
<h2 id="udp-communication-flow"><a class="header" href="#udp-communication-flow">UDP Communication Flow</a></h2>
<h3 id="one-way-communication-fire-and-forget"><a class="header" href="#one-way-communication-fire-and-forget">One-Way Communication (Fire and Forget)</a></h3>
<pre><code>Client                          Server (port 9000)
  |                                |
  |  UDP Packet (Hello)            |
  |-------------------------------&gt;|
  |                                |
  |  UDP Packet (World)            |
  |-------------------------------&gt;|
  |                                |

No handshake, no acknowledgment
</code></pre>
<h3 id="two-way-communication-request-response"><a class="header" href="#two-way-communication-request-response">Two-Way Communication (Request-Response)</a></h3>
<pre><code>Client                          Server
  |                                |
  |  DNS Query (Port 53)           |
  |-------------------------------&gt;|
  |                                |
  |  DNS Response                  |
  |&lt;-------------------------------|
  |                                |

Application must handle timeouts and retries
</code></pre>
<h2 id="udp-checksum-calculation"><a class="header" href="#udp-checksum-calculation">UDP Checksum Calculation</a></h2>
<h3 id="pseudo-header-for-checksum-calculation"><a class="header" href="#pseudo-header-for-checksum-calculation">Pseudo Header (for checksum calculation)</a></h3>
<pre><code>+--------+--------+--------+--------+
|          Source IP Address        |
+--------+--------+--------+--------+
|       Destination IP Address      |
+--------+--------+--------+--------+
|  zero  |Protocol| UDP Length      |
+--------+--------+--------+--------+
</code></pre>
<h3 id="checksum-process"><a class="header" href="#checksum-process">Checksum Process</a></h3>
<ol>
<li>Create pseudo header from IP information</li>
<li>Concatenate: Pseudo header + UDP header + data</li>
<li>Divide into 16-bit words</li>
<li>Sum all 16-bit words</li>
<li>Add carry bits to result</li>
<li>Take one's complement</li>
</ol>
<p><strong>Example:</strong></p>
<pre><code class="language-python">def calculate_checksum(data):
    # Sum all 16-bit words
    total = sum(struct.unpack("!%dH" % (len(data)//2), data))

    # Add carry
    total = (total &gt;&gt; 16) + (total &amp; 0xffff)
    total += (total &gt;&gt; 16)

    # One's complement
    return ~total &amp; 0xffff
</code></pre>
<h2 id="common-udp-ports"><a class="header" href="#common-udp-ports">Common UDP Ports</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Port</th><th>Service</th><th>Purpose</th></tr></thead><tbody>
<tr><td><strong>53</strong></td><td>DNS</td><td>Domain name resolution</td></tr>
<tr><td><strong>67/68</strong></td><td>DHCP</td><td>Dynamic IP configuration</td></tr>
<tr><td><strong>69</strong></td><td>TFTP</td><td>Trivial File Transfer</td></tr>
<tr><td><strong>123</strong></td><td>NTP</td><td>Network Time Protocol</td></tr>
<tr><td><strong>161/162</strong></td><td>SNMP</td><td>Network management</td></tr>
<tr><td><strong>514</strong></td><td>Syslog</td><td>System logging</td></tr>
<tr><td><strong>520</strong></td><td>RIP</td><td>Routing protocol</td></tr>
<tr><td><strong>1900</strong></td><td>SSDP</td><td>Service discovery (UPnP)</td></tr>
<tr><td><strong>3478</strong></td><td>STUN</td><td>NAT traversal</td></tr>
<tr><td><strong>5353</strong></td><td>mDNS</td><td>Multicast DNS</td></tr>
</tbody></table>
</div>
<h2 id="udp-use-cases"><a class="header" href="#udp-use-cases">UDP Use Cases</a></h2>
<h3 id="1-dns-domain-name-system"><a class="header" href="#1-dns-domain-name-system">1. DNS (Domain Name System)</a></h3>
<pre><code>Client sends UDP query to port 53:
+----------------+
| DNS Query      |
| example.com?   |
+----------------+

Server responds:
+----------------+
| DNS Response   |
| 93.184.216.34  |
+----------------+

Fast lookup, retry if no response
</code></pre>
<h3 id="2-video-streaming"><a class="header" href="#2-video-streaming">2. Video Streaming</a></h3>
<pre><code>Server sends video frames continuously:
Frame 1 → Frame 2 → Frame 3 → Frame 4 → Frame 5

If Frame 3 is lost, continue with Frame 4
(Old frame is useless for live streaming)
</code></pre>
<h3 id="3-online-gaming"><a class="header" href="#3-online-gaming">3. Online Gaming</a></h3>
<pre><code>Game Client → Server: Player position updates (60 FPS)
Update 1: Player at (100, 200)
Update 2: Player at (101, 201)
Update 3: [LOST]
Update 4: Player at (103, 203)

Lost packet is okay - next update corrects position
</code></pre>
<h3 id="4-voip-voice-over-ip"><a class="header" href="#4-voip-voice-over-ip">4. VoIP (Voice over IP)</a></h3>
<pre><code>Continuous audio stream:
Packet 1: Audio 0-20ms
Packet 2: Audio 20-40ms
Packet 3: Audio 40-60ms [LOST]
Packet 4: Audio 60-80ms

Lost packet = brief audio glitch
Retransmission would cause worse delay
</code></pre>
<h3 id="5-dhcp-ip-address-assignment"><a class="header" href="#5-dhcp-ip-address-assignment">5. DHCP (IP Address Assignment)</a></h3>
<pre><code>Client                          Server
  |                                |
  | DHCP Discover (broadcast)      |
  |-------------------------------&gt;|
  |                                |
  | DHCP Offer                     |
  |&lt;-------------------------------|
  |                                |
  | DHCP Request                   |
  |-------------------------------&gt;|
  |                                |
  | DHCP ACK                       |
  |&lt;-------------------------------|
</code></pre>
<h2 id="udp-socket-programming"><a class="header" href="#udp-socket-programming">UDP Socket Programming</a></h2>
<h3 id="python-udp-server"><a class="header" href="#python-udp-server">Python UDP Server</a></h3>
<pre><code class="language-python">import socket

# Create UDP socket
sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)

# Bind to address and port
server_address = ('localhost', 9000)
sock.bind(server_address)

print(f"UDP server listening on {server_address}")

while True:
    # Receive data (up to 1024 bytes)
    data, client_address = sock.recvfrom(1024)
    print(f"Received {len(data)} bytes from {client_address}")
    print(f"Data: {data.decode()}")

    # Send response
    sock.sendto(b"Message received", client_address)
</code></pre>
<h3 id="python-udp-client"><a class="header" href="#python-udp-client">Python UDP Client</a></h3>
<pre><code class="language-python">import socket

# Create UDP socket
sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)

server_address = ('localhost', 9000)

try:
    # Send data
    message = b"Hello, UDP Server!"
    sock.sendto(message, server_address)

    # Receive response (with timeout)
    sock.settimeout(5.0)
    data, server = sock.recvfrom(1024)
    print(f"Received: {data.decode()}")

except socket.timeout:
    print("No response from server")
finally:
    sock.close()
</code></pre>
<h3 id="c-udp-server"><a class="header" href="#c-udp-server">C UDP Server</a></h3>
<pre><code class="language-c">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &lt;sys/socket.h&gt;
#include &lt;netinet/in.h&gt;
#include &lt;arpa/inet.h&gt;

#define PORT 9000
#define BUFFER_SIZE 1024

int main() {
    int sockfd;
    char buffer[BUFFER_SIZE];
    struct sockaddr_in server_addr, client_addr;
    socklen_t addr_len = sizeof(client_addr);

    // Create UDP socket
    sockfd = socket(AF_INET, SOCK_DGRAM, 0);

    // Setup server address
    memset(&amp;server_addr, 0, sizeof(server_addr));
    server_addr.sin_family = AF_INET;
    server_addr.sin_addr.s_addr = INADDR_ANY;
    server_addr.sin_port = htons(PORT);

    // Bind socket
    bind(sockfd, (struct sockaddr*)&amp;server_addr, sizeof(server_addr));

    printf("UDP server listening on port %d\n", PORT);

    while(1) {
        // Receive data
        int n = recvfrom(sockfd, buffer, BUFFER_SIZE, 0,
                        (struct sockaddr*)&amp;client_addr, &amp;addr_len);
        buffer[n] = '\0';

        printf("Received: %s\n", buffer);

        // Send response
        sendto(sockfd, "ACK", 3, 0,
               (struct sockaddr*)&amp;client_addr, addr_len);
    }

    return 0;
}
</code></pre>
<h2 id="udp-broadcast-and-multicast"><a class="header" href="#udp-broadcast-and-multicast">UDP Broadcast and Multicast</a></h2>
<h3 id="broadcast-one-to-all-in-subnet"><a class="header" href="#broadcast-one-to-all-in-subnet">Broadcast (One-to-All in subnet)</a></h3>
<pre><code class="language-python">import socket

sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
sock.setsockopt(socket.SOL_SOCKET, socket.SO_BROADCAST, 1)

# Send to broadcast address
broadcast_address = ('255.255.255.255', 9000)
sock.sendto(b"Broadcast message", broadcast_address)
</code></pre>
<h3 id="multicast-one-to-many-selected"><a class="header" href="#multicast-one-to-many-selected">Multicast (One-to-Many selected)</a></h3>
<pre><code class="language-python">import socket
import struct

MCAST_GRP = '224.1.1.1'
MCAST_PORT = 5007

# Sender
sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
sock.sendto(b"Multicast message", (MCAST_GRP, MCAST_PORT))

# Receiver
sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
sock.bind(('', MCAST_PORT))

# Join multicast group
mreq = struct.pack("4sl", socket.inet_aton(MCAST_GRP),
                   socket.INADDR_ANY)
sock.setsockopt(socket.IPPROTO_IP, socket.IP_ADD_MEMBERSHIP, mreq)

data, address = sock.recvfrom(1024)
</code></pre>
<h2 id="udp-maximum-packet-size"><a class="header" href="#udp-maximum-packet-size">UDP Maximum Packet Size</a></h2>
<h3 id="theoretical-limits"><a class="header" href="#theoretical-limits">Theoretical Limits</a></h3>
<pre><code>IPv4:
- Max IP packet: 65,535 bytes
- IP header: 20 bytes (minimum)
- UDP header: 8 bytes
- Max UDP data: 65,507 bytes

IPv6:
- Max payload (jumbogram): 4,294,967,295 bytes
</code></pre>
<h3 id="practical-limits-mtu"><a class="header" href="#practical-limits-mtu">Practical Limits (MTU)</a></h3>
<pre><code>Ethernet MTU: 1500 bytes
- IP header: 20 bytes
- UDP header: 8 bytes
- Safe UDP data: 1472 bytes

To avoid fragmentation:
- Stay under 1472 bytes for IPv4
- Stay under 1452 bytes for IPv6
</code></pre>
<h2 id="udp-reliability-techniques"><a class="header" href="#udp-reliability-techniques">UDP Reliability Techniques</a></h2>
<p>Since UDP doesn't provide reliability, applications must implement it:</p>
<h3 id="1-acknowledgments"><a class="header" href="#1-acknowledgments">1. Acknowledgments</a></h3>
<pre><code>Sender                          Receiver
  |                                |
  | Packet 1                       |
  |-------------------------------&gt;|
  |                                |
  | ACK 1                          |
  |&lt;-------------------------------|
  |                                |
  | Packet 2                       |
  |-------------------------------&gt;|
  |                                |
  [timeout - no ACK received]
  |                                |
  | Packet 2 (resend)              |
  |-------------------------------&gt;|
  |                                |
  | ACK 2                          |
  |&lt;-------------------------------|
</code></pre>
<h3 id="2-sequence-numbers"><a class="header" href="#2-sequence-numbers">2. Sequence Numbers</a></h3>
<pre><code>Application adds sequence numbers:
Packet 1: [Seq=1][Data]
Packet 2: [Seq=2][Data]
Packet 3: [Seq=3][Data]

Receiver detects missing packets
Requests retransmission if needed
</code></pre>
<h3 id="3-timeouts-and-retries"><a class="header" href="#3-timeouts-and-retries">3. Timeouts and Retries</a></h3>
<pre><code class="language-python">import socket
import time

def send_with_retry(sock, data, address, max_retries=3):
    for attempt in range(max_retries):
        sock.sendto(data, address)
        sock.settimeout(1.0)

        try:
            response, _ = sock.recvfrom(1024)
            return response
        except socket.timeout:
            print(f"Retry {attempt + 1}/{max_retries}")
            continue

    raise Exception("Max retries exceeded")
</code></pre>
<h2 id="udp-advantages"><a class="header" href="#udp-advantages">UDP Advantages</a></h2>
<ol>
<li><strong>Low Latency</strong>: No connection setup, immediate transmission</li>
<li><strong>Low Overhead</strong>: 8-byte header vs TCP's 20+ bytes</li>
<li><strong>No Connection State</strong>: Simpler, uses less memory</li>
<li><strong>Broadcast/Multicast</strong>: Can send to multiple receivers</li>
<li><strong>Fast</strong>: No waiting for acknowledgments</li>
<li><strong>Transaction-Oriented</strong>: Good for request-response</li>
</ol>
<h2 id="udp-disadvantages"><a class="header" href="#udp-disadvantages">UDP Disadvantages</a></h2>
<ol>
<li><strong>Unreliable</strong>: Packets may be lost, duplicated, or reordered</li>
<li><strong>No Flow Control</strong>: Can overwhelm receiver</li>
<li><strong>No Congestion Control</strong>: Can worsen network congestion</li>
<li><strong>No Security</strong>: No encryption (use DTLS for secure UDP)</li>
<li><strong>Application Complexity</strong>: Must implement reliability if needed</li>
</ol>
<h2 id="udp-security-considerations"><a class="header" href="#udp-security-considerations">UDP Security Considerations</a></h2>
<h3 id="vulnerabilities"><a class="header" href="#vulnerabilities">Vulnerabilities</a></h3>
<ol>
<li><strong>UDP Flood Attack</strong>: Overwhelm server with UDP packets</li>
<li><strong>UDP Amplification</strong>: Small request → large response (DNS, NTP)</li>
<li><strong>Spoofing</strong>: Easy to fake source IP (no handshake)</li>
</ol>
<h3 id="mitigation"><a class="header" href="#mitigation">Mitigation</a></h3>
<pre><code>1. Rate limiting: Limit packets per second per source
2. Firewall rules: Block unnecessary UDP ports
3. Authentication: Verify sender identity
4. DTLS: Encrypted UDP (Datagram TLS)
</code></pre>
<h3 id="dtls-datagram-tls"><a class="header" href="#dtls-datagram-tls">DTLS (Datagram TLS)</a></h3>
<p>Secure UDP communication:</p>
<pre><code>UDP + TLS-style encryption = DTLS

Used in:
- WebRTC
- VPN protocols
- IoT devices
</code></pre>
<h2 id="monitoring-udp-traffic"><a class="header" href="#monitoring-udp-traffic">Monitoring UDP Traffic</a></h2>
<h3 id="using-tcpdump"><a class="header" href="#using-tcpdump">Using tcpdump</a></h3>
<pre><code class="language-bash"># Capture UDP traffic on port 53 (DNS)
tcpdump -i any udp port 53

# Capture all UDP traffic
tcpdump -i any udp

# Save to file
tcpdump -i any udp -w udp_capture.pcap

# View UDP packet details
tcpdump -i any udp -vv -X
</code></pre>
<h3 id="using-netstat"><a class="header" href="#using-netstat">Using netstat</a></h3>
<pre><code class="language-bash"># Show UDP listening ports
netstat -un

# Show UDP statistics
netstat -su

# Show processes using UDP
netstat -unp
</code></pre>
<h2 id="eli10-19"><a class="header" href="#eli10-19">ELI10</a></h2>
<p>UDP is like sending postcards:</p>
<p><strong>TCP is like certified mail:</strong></p>
<ul>
<li>You get confirmation it arrived</li>
<li>Items arrive in order</li>
<li>Lost mail is resent</li>
<li>But takes longer</li>
</ul>
<p><strong>UDP is like postcards:</strong></p>
<ul>
<li>Just drop it in the mailbox and go</li>
<li>Super fast - no waiting</li>
<li>But might get lost</li>
<li>Might arrive out of order</li>
<li>No way to know if it arrived</li>
</ul>
<p><strong>When to use UDP (postcards):</strong></p>
<ul>
<li>Quick questions (DNS: "What's this address?")</li>
<li>Live streaming (watching a game - who cares about 1 missed frame?)</li>
<li>Online games (your position updates 60 times per second)</li>
<li>Video calls (slight glitch is better than delay)</li>
</ul>
<p><strong>When to use TCP (certified mail):</strong></p>
<ul>
<li>Important files</li>
<li>Web pages</li>
<li>Emails</li>
<li>Banking transactions</li>
</ul>
<h2 id="further-resources-27"><a class="header" href="#further-resources-27">Further Resources</a></h2>
<ul>
<li><a href="https://tools.ietf.org/html/rfc768">RFC 768 - UDP Specification</a></li>
<li><a href="https://www.cloudflare.com/learning/ddos/glossary/user-datagram-protocol-udp/">UDP vs TCP Explained</a></li>
<li><a href="https://beej.us/guide/bgnet/html/">UDP Programming Guide</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="httphttps-1"><a class="header" href="#httphttps-1">HTTP/HTTPS</a></h1>
<h2 id="overview-78"><a class="header" href="#overview-78">Overview</a></h2>
<p>HTTP (HyperText Transfer Protocol) is the foundation of data communication on the web. HTTPS adds encryption for secure communication.</p>
<h2 id="http-basics"><a class="header" href="#http-basics">HTTP Basics</a></h2>
<h3 id="request-response-model"><a class="header" href="#request-response-model">Request-Response Model</a></h3>
<pre><code>Client                          Server

    HTTP Request               -&gt;

  &lt;-          HTTP Response

</code></pre>
<h3 id="http-methods-1"><a class="header" href="#http-methods-1">HTTP Methods</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Method</th><th>Purpose</th><th>Idempotent</th><th>Safe</th></tr></thead><tbody>
<tr><td><strong>GET</strong></td><td>Retrieve resource</td><td>Yes</td><td>Yes</td></tr>
<tr><td><strong>POST</strong></td><td>Create resource</td><td>No</td><td>No</td></tr>
<tr><td><strong>PUT</strong></td><td>Replace resource</td><td>Yes</td><td>No</td></tr>
<tr><td><strong>PATCH</strong></td><td>Partial update</td><td>No</td><td>No</td></tr>
<tr><td><strong>DELETE</strong></td><td>Remove resource</td><td>Yes</td><td>No</td></tr>
<tr><td><strong>HEAD</strong></td><td>Like GET, no body</td><td>Yes</td><td>Yes</td></tr>
<tr><td><strong>OPTIONS</strong></td><td>Describe options</td><td>Yes</td><td>Yes</td></tr>
</tbody></table>
</div>
<h3 id="status-codes"><a class="header" href="#status-codes">Status Codes</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Code</th><th>Meaning</th><th>Examples</th></tr></thead><tbody>
<tr><td><strong>1xx</strong></td><td>Informational</td><td>100 Continue</td></tr>
<tr><td><strong>2xx</strong></td><td>Success</td><td>200 OK, 201 Created</td></tr>
<tr><td><strong>3xx</strong></td><td>Redirection</td><td>301 Moved, 304 Not Modified</td></tr>
<tr><td><strong>4xx</strong></td><td>Client Error</td><td>400 Bad Request, 404 Not Found</td></tr>
<tr><td><strong>5xx</strong></td><td>Server Error</td><td>500 Server Error, 503 Unavailable</td></tr>
</tbody></table>
</div>
<h3 id="headers-1"><a class="header" href="#headers-1">Headers</a></h3>
<p><strong>Request Headers</strong>:</p>
<pre><code>Host: example.com
User-Agent: Mozilla/5.0
Accept: application/json
Authorization: Bearer token123
Cookie: session=abc123
Content-Type: application/json
</code></pre>
<p><strong>Response Headers</strong>:</p>
<pre><code>Content-Type: application/json
Content-Length: 256
Set-Cookie: session=def456
Cache-Control: max-age=3600
ETag: "12345abc"
</code></pre>
<h2 id="http-versions"><a class="header" href="#http-versions">HTTP Versions</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Version</th><th>Released</th><th>Features</th></tr></thead><tbody>
<tr><td><strong>HTTP/1.1</strong></td><td>1997</td><td>Keep-alive, chunked transfer</td></tr>
<tr><td><strong>HTTP/2</strong></td><td>2015</td><td>Multiplexing, server push, binary</td></tr>
<tr><td><strong>HTTP/3</strong></td><td>2022</td><td>QUIC protocol, faster</td></tr>
</tbody></table>
</div>
<h2 id="rest-api-design"><a class="header" href="#rest-api-design">REST API Design</a></h2>
<h3 id="resource-oriented"><a class="header" href="#resource-oriented">Resource-Oriented</a></h3>
<pre><code> GET /users           - List users
 POST /users          - Create user
 GET /users/123       - Get user 123
 PUT /users/123       - Update user 123
 DELETE /users/123    - Delete user 123

 GET /getUser?id=123  - Procedural (bad)
 POST /createUser     - Procedural (bad)
</code></pre>
<h3 id="requestresponse-example"><a class="header" href="#requestresponse-example">Request/Response Example</a></h3>
<pre><code class="language-python"># Request
GET /users/123 HTTP/1.1
Host: api.example.com
Authorization: Bearer token

# Response
HTTP/1.1 200 OK
Content-Type: application/json
Content-Length: 156

{
  "id": 123,
  "name": "John",
  "email": "john@example.com"
}
</code></pre>
<h2 id="https-secure-http"><a class="header" href="#https-secure-http">HTTPS (Secure HTTP)</a></h2>
<p>Adds TLS encryption on top of HTTP:</p>
<pre><code>HTTP over TLS = HTTPS
</code></pre>
<h3 id="benefits"><a class="header" href="#benefits">Benefits</a></h3>
<ul>
<li><strong>Encryption</strong>: Data unreadable to eavesdroppers</li>
<li><strong>Authentication</strong>: Verify server identity</li>
<li><strong>Integrity</strong>: Detect tampering</li>
</ul>
<h3 id="certificate-process"><a class="header" href="#certificate-process">Certificate Process</a></h3>
<pre><code>1. Generate private/public key pair
2. Request certificate from CA
3. CA verifies and signs certificate
4. Browser verifies signature with CA's public key
</code></pre>
<h2 id="caching"><a class="header" href="#caching">Caching</a></h2>
<h3 id="cache-headers"><a class="header" href="#cache-headers">Cache Headers</a></h3>
<pre><code>Cache-Control: max-age=3600     # Cache for 1 hour
Cache-Control: no-cache         # Validate before use
Cache-Control: no-store         # Don't cache
Cache-Control: private          # Only browser cache
Cache-Control: public           # Any cache can store
ETag: "12345"                   # Resource version
</code></pre>
<h3 id="conditional-requests"><a class="header" href="#conditional-requests">Conditional Requests</a></h3>
<pre><code>If-None-Match: "12345"
-&gt; Returns 304 Not Modified if unchanged
</code></pre>
<h2 id="authentication-2"><a class="header" href="#authentication-2">Authentication</a></h2>
<h3 id="basic-auth"><a class="header" href="#basic-auth">Basic Auth</a></h3>
<pre><code>Authorization: Basic base64(username:password)
</code></pre>
<h3 id="bearer-token-1"><a class="header" href="#bearer-token-1">Bearer Token</a></h3>
<pre><code>Authorization: Bearer eyJhbGc...
</code></pre>
<h3 id="oauth-20-3"><a class="header" href="#oauth-20-3">OAuth 2.0</a></h3>
<p>Multi-step authorization flow for 3rd party apps</p>
<h2 id="cors-cross-origin-resource-sharing"><a class="header" href="#cors-cross-origin-resource-sharing">CORS (Cross-Origin Resource Sharing)</a></h2>
<p>Enable browser to access cross-origin APIs:</p>
<pre><code>Server Response:
Access-Control-Allow-Origin: *
Access-Control-Allow-Methods: GET, POST
Access-Control-Allow-Headers: Content-Type
</code></pre>
<h2 id="common-issues-23"><a class="header" href="#common-issues-23">Common Issues</a></h2>
<h3 id="404-not-found"><a class="header" href="#404-not-found">404 Not Found</a></h3>
<p>Resource doesn't exist</p>
<h3 id="401-unauthorized"><a class="header" href="#401-unauthorized">401 Unauthorized</a></h3>
<p>Missing/invalid authentication</p>
<h3 id="403-forbidden"><a class="header" href="#403-forbidden">403 Forbidden</a></h3>
<p>Authenticated but not allowed</p>
<h3 id="429-too-many-requests"><a class="header" href="#429-too-many-requests">429 Too Many Requests</a></h3>
<p>Rate limit exceeded</p>
<h3 id="503-service-unavailable"><a class="header" href="#503-service-unavailable">503 Service Unavailable</a></h3>
<p>Server temporarily down</p>
<h2 id="best-practices-70"><a class="header" href="#best-practices-70">Best Practices</a></h2>
<h3 id="1-use-appropriate-methods"><a class="header" href="#1-use-appropriate-methods">1. Use Appropriate Methods</a></h3>
<pre><code> GET for reading (no side effects)
 POST for creating
 PUT for full replacement
 PATCH for partial update
</code></pre>
<h3 id="2-meaningful-status-codes"><a class="header" href="#2-meaningful-status-codes">2. Meaningful Status Codes</a></h3>
<pre><code> 200 OK for success
 201 Created for new resource
 204 No Content for delete
 200 for everything (bad)
</code></pre>
<h3 id="3-versioning"><a class="header" href="#3-versioning">3. Versioning</a></h3>
<pre><code>/api/v1/users
/api/v2/users
</code></pre>
<h3 id="4-error-responses"><a class="header" href="#4-error-responses">4. Error Responses</a></h3>
<pre><code class="language-json">{
  "error": "Invalid input",
  "details": {
    "email": "Email format invalid"
  }
}
</code></pre>
<h2 id="eli10-20"><a class="header" href="#eli10-20">ELI10</a></h2>
<p>HTTP is like sending letters:</p>
<ul>
<li><strong>GET</strong>: "What's the address of 123 Main St?"</li>
<li><strong>POST</strong>: "Please add my address to your system"</li>
<li><strong>PUT</strong>: "Update my address to..."</li>
<li><strong>DELETE</strong>: "Remove my address"</li>
</ul>
<p>The server sends back a number (status code):</p>
<ul>
<li><strong>200</strong>: "Got it, here's what you asked for!"</li>
<li><strong>404</strong>: "Can't find that address"</li>
<li><strong>500</strong>: "I have a problem..."</li>
</ul>
<p>HTTPS adds a sealed envelope so only the right person can read it!</p>
<h2 id="further-resources-28"><a class="header" href="#further-resources-28">Further Resources</a></h2>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP">MDN HTTP Guide</a></li>
<li><a href="https://httpstat.us/">HTTP Status Codes</a></li>
<li><a href="https://restfulapi.net/">REST API Best Practices</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="dns-domain-name-system-1"><a class="header" href="#dns-domain-name-system-1">DNS (Domain Name System)</a></h1>
<h2 id="overview-79"><a class="header" href="#overview-79">Overview</a></h2>
<p>DNS is the internet's phonebook that translates human-readable domain names (like <code>example.com</code>) into IP addresses (like <code>93.184.216.34</code>) that computers use to identify each other on the network.</p>
<h2 id="dns-hierarchy"><a class="header" href="#dns-hierarchy">DNS Hierarchy</a></h2>
<pre><code>                    Root (.)
                       |
         +-------------+-------------+
         |             |             |
       .com          .org          .net
         |             |             |
    example.com   wikipedia.org  archive.net
         |
    www.example.com
</code></pre>
<h2 id="dns-record-types"><a class="header" href="#dns-record-types">DNS Record Types</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Record Type</th><th>Purpose</th><th>Example</th></tr></thead><tbody>
<tr><td><strong>A</strong></td><td>IPv4 address</td><td><code>example.com -&gt; 93.184.216.34</code></td></tr>
<tr><td><strong>AAAA</strong></td><td>IPv6 address</td><td><code>example.com -&gt; 2606:2800:220:1:...</code></td></tr>
<tr><td><strong>CNAME</strong></td><td>Canonical name (alias)</td><td><code>www.example.com -&gt; example.com</code></td></tr>
<tr><td><strong>MX</strong></td><td>Mail exchange server</td><td><code>example.com -&gt; mail.example.com</code></td></tr>
<tr><td><strong>NS</strong></td><td>Name server</td><td><code>example.com -&gt; ns1.example.com</code></td></tr>
<tr><td><strong>TXT</strong></td><td>Text information</td><td>SPF, DKIM records</td></tr>
<tr><td><strong>PTR</strong></td><td>Reverse DNS lookup</td><td><code>34.216.184.93 -&gt; example.com</code></td></tr>
<tr><td><strong>SOA</strong></td><td>Start of authority</td><td>Zone information</td></tr>
<tr><td><strong>SRV</strong></td><td>Service location</td><td><code>_service._proto.name</code></td></tr>
</tbody></table>
</div>
<h2 id="dns-query-process"><a class="header" href="#dns-query-process">DNS Query Process</a></h2>
<pre><code>1. User types "example.com" in browser

2. Browser checks local cache

3. If not cached, query DNS resolver (ISP or 8.8.8.8)

4. Resolver checks its cache

5. If not cached, recursive query:

   Resolver → Root DNS Server
   Root → "Ask .com server"

   Resolver → .com TLD Server
   TLD → "Ask example.com's nameserver"

   Resolver → example.com's Nameserver
   Nameserver → "IP is 93.184.216.34"

6. Resolver caches result and returns to browser

7. Browser connects to IP address
</code></pre>
<h2 id="dns-message-format"><a class="header" href="#dns-message-format">DNS Message Format</a></h2>
<pre><code>+---------------------------+
|        Header             |  12 bytes
+---------------------------+
|        Question           |  Variable
+---------------------------+
|        Answer             |  Variable
+---------------------------+
|        Authority          |  Variable
+---------------------------+
|        Additional         |  Variable
+---------------------------+
</code></pre>
<h3 id="header-format-12-bytes"><a class="header" href="#header-format-12-bytes">Header Format (12 bytes)</a></h3>
<pre><code> 0  1  2  3  4  5  6  7  8  9  0  1  2  3  4  5
+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
|                      ID                       |
+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
|QR|   Opcode  |AA|TC|RD|RA|   Z    |   RCODE   |
+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
|                    QDCOUNT                    |
+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
|                    ANCOUNT                    |
+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
|                    NSCOUNT                    |
+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
|                    ARCOUNT                    |
+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
</code></pre>
<p><strong>Fields:</strong></p>
<ul>
<li><strong>ID</strong>: 16-bit identifier for matching requests/responses</li>
<li><strong>QR</strong>: Query (0) or Response (1)</li>
<li><strong>Opcode</strong>: Query type (0=standard, 1=inverse, 2=status)</li>
<li><strong>AA</strong>: Authoritative Answer</li>
<li><strong>TC</strong>: Truncated (message too long for UDP)</li>
<li><strong>RD</strong>: Recursion Desired</li>
<li><strong>RA</strong>: Recursion Available</li>
<li><strong>RCODE</strong>: Response code (0=no error, 3=name error)</li>
<li><strong>QDCOUNT</strong>: Number of questions</li>
<li><strong>ANCOUNT</strong>: Number of answers</li>
<li><strong>NSCOUNT</strong>: Number of authority records</li>
<li><strong>ARCOUNT</strong>: Number of additional records</li>
</ul>
<h2 id="dns-query-example"><a class="header" href="#dns-query-example">DNS Query Example</a></h2>
<h3 id="query-request"><a class="header" href="#query-request">Query (Request)</a></h3>
<pre><code>; DNS Query for example.com A record
; Header
ID: 0x1234
Flags: 0x0100 (standard query, recursion desired)
Questions: 1
Answer RRs: 0
Authority RRs: 0
Additional RRs: 0

; Question Section
example.com.    IN    A
</code></pre>
<p><strong>Hexadecimal representation:</strong></p>
<pre><code>12 34  01 00  00 01  00 00  00 00  00 00
07 65 78 61 6d 70 6c 65 03 63 6f 6d 00
00 01  00 01
</code></pre>
<h3 id="response"><a class="header" href="#response">Response</a></h3>
<pre><code>; DNS Response for example.com A record
; Header
ID: 0x1234
Flags: 0x8180 (response, recursion available)
Questions: 1
Answer RRs: 1
Authority RRs: 0
Additional RRs: 0

; Question Section
example.com.    IN    A

; Answer Section
example.com.    86400    IN    A    93.184.216.34
</code></pre>
<h2 id="dns-query-types"><a class="header" href="#dns-query-types">DNS Query Types</a></h2>
<h3 id="recursive-query"><a class="header" href="#recursive-query">Recursive Query</a></h3>
<p>Client asks DNS server to provide the final answer:</p>
<pre><code>Client → Resolver: "What's example.com?"
Resolver → Root/TLD/Auth servers (multiple queries)
Resolver → Client: "It's 93.184.216.34"
</code></pre>
<h3 id="iterative-query"><a class="header" href="#iterative-query">Iterative Query</a></h3>
<p>DNS server returns best answer it knows:</p>
<pre><code>Client → Root: "What's example.com?"
Root → Client: "Ask .com server at 192.5.6.30"

Client → TLD: "What's example.com?"
TLD → Client: "Ask ns1.example.com at 192.0.2.1"

Client → Auth: "What's example.com?"
Auth → Client: "It's 93.184.216.34"
</code></pre>
<h2 id="dns-resource-record-format"><a class="header" href="#dns-resource-record-format">DNS Resource Record Format</a></h2>
<pre><code>Name: example.com
Type: A (1)
Class: IN (1) - Internet
TTL: 86400 (24 hours)
Data Length: 4
Data: 93.184.216.34
</code></pre>
<h2 id="common-dns-operations"><a class="header" href="#common-dns-operations">Common DNS Operations</a></h2>
<h3 id="using-dig-dns-lookup-tool"><a class="header" href="#using-dig-dns-lookup-tool">Using dig (DNS lookup tool)</a></h3>
<pre><code class="language-bash"># Basic A record lookup
dig example.com

# Query specific record type
dig example.com MX
dig example.com AAAA

# Query specific DNS server
dig @8.8.8.8 example.com

# Reverse DNS lookup
dig -x 93.184.216.34

# Trace DNS resolution path
dig +trace example.com

# Short answer only
dig +short example.com
</code></pre>
<h3 id="using-nslookup"><a class="header" href="#using-nslookup">Using nslookup</a></h3>
<pre><code class="language-bash"># Basic lookup
nslookup example.com

# Query specific server
nslookup example.com 8.8.8.8

# Query specific record type
nslookup -type=MX example.com
</code></pre>
<h3 id="using-host"><a class="header" href="#using-host">Using host</a></h3>
<pre><code class="language-bash"># Simple lookup
host example.com

# Verbose output
host -v example.com

# Query MX records
host -t MX example.com
</code></pre>
<h2 id="dns-caching"><a class="header" href="#dns-caching">DNS Caching</a></h2>
<h3 id="cache-levels"><a class="header" href="#cache-levels">Cache Levels</a></h3>
<ol>
<li><strong>Browser Cache</strong>: Short-lived (seconds to minutes)</li>
<li><strong>OS Cache</strong>: System-level DNS cache</li>
<li><strong>Router Cache</strong>: Local network cache</li>
<li><strong>ISP Resolver Cache</strong>: Hours to days</li>
<li><strong>Authoritative Server</strong>: The source of truth</li>
</ol>
<h3 id="ttl-time-to-live-2"><a class="header" href="#ttl-time-to-live-2">TTL (Time To Live)</a></h3>
<p>Controls how long records are cached:</p>
<pre><code>example.com.  3600  IN  A  93.184.216.34
              ^^^^
              1 hour TTL
</code></pre>
<h3 id="flushing-dns-cache"><a class="header" href="#flushing-dns-cache">Flushing DNS Cache</a></h3>
<pre><code class="language-bash"># Windows
ipconfig /flushdns

# macOS
sudo dscacheutil -flushcache

# Linux (systemd-resolved)
sudo systemd-resolve --flush-caches

# Linux (nscd)
sudo /etc/init.d/nscd restart
</code></pre>
<h2 id="dns-security"><a class="header" href="#dns-security">DNS Security</a></h2>
<h3 id="dns-spoofingcache-poisoning"><a class="header" href="#dns-spoofingcache-poisoning">DNS Spoofing/Cache Poisoning</a></h3>
<p>Attack where fake DNS responses are injected:</p>
<pre><code>Attacker intercepts DNS query
Attacker sends fake response: "bank.com -&gt; evil.com"
Victim connects to attacker's server
</code></pre>
<p><strong>Prevention</strong>: DNSSEC</p>
<h3 id="dnssec-dns-security-extensions"><a class="header" href="#dnssec-dns-security-extensions">DNSSEC (DNS Security Extensions)</a></h3>
<p>Adds cryptographic signatures to DNS records:</p>
<pre><code>1. Zone owner signs DNS records with private key
2. Public key published in DNS
3. Resolver verifies signature
4. Chain of trust from root to domain
</code></pre>
<p><strong>Record Types:</strong></p>
<ul>
<li><strong>RRSIG</strong>: Contains signature</li>
<li><strong>DNSKEY</strong>: Public key</li>
<li><strong>DS</strong>: Delegation Signer (links parent to child)</li>
</ul>
<h3 id="dns-over-https-doh"><a class="header" href="#dns-over-https-doh">DNS over HTTPS (DoH)</a></h3>
<p>Encrypts DNS queries using HTTPS:</p>
<pre><code>Client → DoH Server (port 443)
Encrypted: "What's example.com?"
Encrypted: "It's 93.184.216.34"
</code></pre>
<p><strong>Providers:</strong></p>
<ul>
<li>Cloudflare: <code>https://1.1.1.1/dns-query</code></li>
<li>Google: <code>https://dns.google/dns-query</code></li>
</ul>
<h3 id="dns-over-tls-dot"><a class="header" href="#dns-over-tls-dot">DNS over TLS (DoT)</a></h3>
<p>Encrypts DNS queries using TLS:</p>
<pre><code>Client → DoT Server (port 853)
TLS encrypted DNS query/response
</code></pre>
<h2 id="public-dns-servers"><a class="header" href="#public-dns-servers">Public DNS Servers</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Provider</th><th>IPv4</th><th>IPv6</th><th>Features</th></tr></thead><tbody>
<tr><td><strong>Google</strong></td><td>8.8.8.8, 8.8.4.4</td><td>2001:4860:4860::8888</td><td>Fast, reliable</td></tr>
<tr><td><strong>Cloudflare</strong></td><td>1.1.1.1, 1.0.0.1</td><td>2606:4700:4700::1111</td><td>Privacy-focused</td></tr>
<tr><td><strong>Quad9</strong></td><td>9.9.9.9</td><td>2620:fe::fe</td><td>Malware blocking</td></tr>
<tr><td><strong>OpenDNS</strong></td><td>208.67.222.222</td><td>2620:119:35::35</td><td>Content filtering</td></tr>
</tbody></table>
</div>
<h2 id="dns-load-balancing"><a class="header" href="#dns-load-balancing">DNS Load Balancing</a></h2>
<p>Multiple A records for load distribution:</p>
<pre><code>example.com.  300  IN  A  192.0.2.1
example.com.  300  IN  A  192.0.2.2
example.com.  300  IN  A  192.0.2.3
</code></pre>
<p>Round-robin or geographic distribution of requests.</p>
<h2 id="common-dns-response-codes"><a class="header" href="#common-dns-response-codes">Common DNS Response Codes</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Code</th><th>Name</th><th>Meaning</th></tr></thead><tbody>
<tr><td><strong>0</strong></td><td>NOERROR</td><td>Query successful</td></tr>
<tr><td><strong>1</strong></td><td>FORMERR</td><td>Format error</td></tr>
<tr><td><strong>2</strong></td><td>SERVFAIL</td><td>Server failure</td></tr>
<tr><td><strong>3</strong></td><td>NXDOMAIN</td><td>Domain doesn't exist</td></tr>
<tr><td><strong>4</strong></td><td>NOTIMP</td><td>Not implemented</td></tr>
<tr><td><strong>5</strong></td><td>REFUSED</td><td>Query refused</td></tr>
</tbody></table>
</div>
<h2 id="dns-best-practices"><a class="header" href="#dns-best-practices">DNS Best Practices</a></h2>
<h3 id="1-use-multiple-nameservers"><a class="header" href="#1-use-multiple-nameservers">1. Use Multiple Nameservers</a></h3>
<pre><code>NS  ns1.example.com  (Primary)
NS  ns2.example.com  (Secondary)
</code></pre>
<h3 id="2-appropriate-ttl-values"><a class="header" href="#2-appropriate-ttl-values">2. Appropriate TTL Values</a></h3>
<pre><code># Stable records (rarely change)
example.com.  86400  IN  A  93.184.216.34

# Dynamic records (may change soon)
staging.example.com.  300  IN  A  192.0.2.1
</code></pre>
<h3 id="3-spf-records-for-email"><a class="header" href="#3-spf-records-for-email">3. SPF Records for Email</a></h3>
<pre><code>example.com.  IN  TXT  "v=spf1 mx include:_spf.google.com ~all"
</code></pre>
<h3 id="4-dkim-for-email-authentication"><a class="header" href="#4-dkim-for-email-authentication">4. DKIM for Email Authentication</a></h3>
<pre><code>default._domainkey.example.com.  IN  TXT  "v=DKIM1; k=rsa; p=MIGfMA0..."
</code></pre>
<h2 id="dns-troubleshooting"><a class="header" href="#dns-troubleshooting">DNS Troubleshooting</a></h2>
<h3 id="issue-domain-not-resolving"><a class="header" href="#issue-domain-not-resolving">Issue: Domain not resolving</a></h3>
<pre><code class="language-bash"># Check if domain exists
dig example.com

# Check all nameservers
dig example.com NS
dig @ns1.example.com example.com

# Check propagation
dig @8.8.8.8 example.com
dig @1.1.1.1 example.com
</code></pre>
<h3 id="issue-slow-dns-resolution"><a class="header" href="#issue-slow-dns-resolution">Issue: Slow DNS resolution</a></h3>
<pre><code class="language-bash"># Test query time
dig example.com | grep "Query time"

# Compare different DNS servers
dig @8.8.8.8 example.com | grep "Query time"
dig @1.1.1.1 example.com | grep "Query time"
</code></pre>
<h3 id="issue-nxdomain-domain-not-found"><a class="header" href="#issue-nxdomain-domain-not-found">Issue: NXDOMAIN (domain not found)</a></h3>
<ol>
<li>Check domain registration</li>
<li>Verify nameserver configuration</li>
<li>Check DNS propagation time (up to 48 hours)</li>
</ol>
<h2 id="zone-file-example"><a class="header" href="#zone-file-example">Zone File Example</a></h2>
<pre><code>$TTL 86400
@   IN  SOA  ns1.example.com. admin.example.com. (
            2024011301  ; Serial
            3600        ; Refresh
            1800        ; Retry
            604800      ; Expire
            86400 )     ; Minimum TTL

; Name servers
    IN  NS   ns1.example.com.
    IN  NS   ns2.example.com.

; Mail servers
    IN  MX   10 mail1.example.com.
    IN  MX   20 mail2.example.com.

; A records
@           IN  A    93.184.216.34
www         IN  A    93.184.216.34
mail1       IN  A    192.0.2.1
mail2       IN  A    192.0.2.2
ns1         IN  A    192.0.2.10
ns2         IN  A    192.0.2.11

; AAAA records (IPv6)
@           IN  AAAA 2606:2800:220:1:248:1893:25c8:1946

; CNAME records
ftp         IN  CNAME www.example.com.
webmail     IN  CNAME mail1.example.com.
</code></pre>
<h2 id="eli10-21"><a class="header" href="#eli10-21">ELI10</a></h2>
<p>DNS is like a phone book for the internet:</p>
<ul>
<li><strong>Without DNS</strong>: "Visit 93.184.216.34" (hard to remember!)</li>
<li><strong>With DNS</strong>: "Visit example.com" (easy!)</li>
</ul>
<p>When you type a website name:</p>
<ol>
<li>Your computer asks "Where is example.com?"</li>
<li>DNS looks it up in its huge phone book</li>
<li>DNS says "It's at 93.184.216.34"</li>
<li>Your computer connects to that address</li>
</ol>
<p>DNS servers are like helpers who:</p>
<ul>
<li>Remember answers (caching) so they can answer faster next time</li>
<li>Ask other DNS servers if they don't know the answer</li>
<li>Make sure everyone gets the same answer for the same website</li>
</ul>
<h2 id="further-resources-29"><a class="header" href="#further-resources-29">Further Resources</a></h2>
<ul>
<li><a href="https://tools.ietf.org/html/rfc1035">RFC 1035 - DNS Specification</a></li>
<li><a href="https://howdns.works/">How DNS Works (Comic)</a></li>
<li><a href="https://mxtoolbox.com/DNSLookup.aspx">DNS Lookup Tool</a></li>
<li><a href="https://dnssec-analyzer.verisignlabs.com/">DNSSEC Explained</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="mdns-multicast-dns-1"><a class="header" href="#mdns-multicast-dns-1">mDNS (Multicast DNS)</a></h1>
<h2 id="overview-80"><a class="header" href="#overview-80">Overview</a></h2>
<p>mDNS (Multicast DNS) is a protocol that resolves hostnames to IP addresses within small networks without requiring a conventional DNS server. It's part of Zero Configuration Networking (Zeroconf) and enables devices to discover each other on local networks using the <code>.local</code> domain.</p>
<h2 id="why-mdns"><a class="header" href="#why-mdns">Why mDNS?</a></h2>
<h3 id="traditional-dns-limitations"><a class="header" href="#traditional-dns-limitations">Traditional DNS Limitations</a></h3>
<pre><code>Problem: Home networks lack DNS servers

Traditional setup requires:
1. DNS server
2. Manual configuration
3. Static IP or DHCP integration
4. Administrative overhead

mDNS solution:
- No DNS server needed
- Automatic hostname resolution
- Zero configuration
- Works out of the box
</code></pre>
<h3 id="use-cases-3"><a class="header" href="#use-cases-3">Use Cases</a></h3>
<pre><code>1. Printer discovery
   - printer.local → 192.168.1.100

2. File sharing
   - macbook.local → 192.168.1.50

3. IoT devices
   - raspberry-pi.local → 192.168.1.75

4. Local development
   - webserver.local → 127.0.0.1

5. Service discovery
   - Find all printers on network
   - Find all file servers
</code></pre>
<h2 id="how-mdns-works"><a class="header" href="#how-mdns-works">How mDNS Works</a></h2>
<h3 id="query-process"><a class="header" href="#query-process">Query Process</a></h3>
<pre><code>Device wants to find "printer.local"

1. Send multicast query to 224.0.0.251:5353
   "Who has printer.local?"

2. All devices receive query

3. Device with hostname "printer" responds
   "I'm printer.local at 192.168.1.100"

4. Querying device caches response

5. Direct communication established
</code></pre>
<h3 id="multicast-address"><a class="header" href="#multicast-address">Multicast Address</a></h3>
<pre><code>IPv4: 224.0.0.251
IPv6: ff02::fb
Port: 5353 (UDP)

All devices on local network listen to this address
</code></pre>
<h2 id="mdns-message-format"><a class="header" href="#mdns-message-format">mDNS Message Format</a></h2>
<h3 id="dns-compatible-format"><a class="header" href="#dns-compatible-format">DNS-Compatible Format</a></h3>
<p>mDNS uses standard DNS message format:</p>
<pre><code>+---------------------------+
|        Header             |
+---------------------------+
|        Question           |
+---------------------------+
|        Answer             |
+---------------------------+
|        Authority          |
+---------------------------+
|        Additional         |
+---------------------------+
</code></pre>
<h3 id="header-fields-1"><a class="header" href="#header-fields-1">Header Fields</a></h3>
<pre><code>ID: Usually 0 (multicast)
QR: Query (0) or Response (1)
OPCODE: 0 (standard query)
AA: Authoritative Answer (1 for responses)
TC: Truncated
RD: Recursion Desired (0 for mDNS)
RA: Recursion Available (0 for mDNS)
RCODE: Response code

Questions: Number of questions
Answers: Number of answer RRs
Authority: Number of authority RRs
Additional: Number of additional RRs
</code></pre>
<h2 id="mdns-query-example"><a class="header" href="#mdns-query-example">mDNS Query Example</a></h2>
<h3 id="query-message"><a class="header" href="#query-message">Query Message</a></h3>
<pre><code>Multicast to 224.0.0.251:5353

Question:
  Name: printer.local
  Type: A (IPv4 address)
  Class: IN (Internet)
  QU bit: 0 (multicast query)

Header:
  ID: 0
  Flags: 0x0000 (standard query)
  Questions: 1
  Answers: 0
</code></pre>
<h3 id="response-message"><a class="header" href="#response-message">Response Message</a></h3>
<pre><code>Multicast from 192.168.1.100:5353

Answer:
  Name: printer.local
  Type: A
  Class: IN | Cache-Flush bit
  TTL: 120 seconds
  Data: 192.168.1.100

Header:
  ID: 0
  Flags: 0x8400 (authoritative answer)
  Questions: 0
  Answers: 1
</code></pre>
<h2 id="mdns-record-types"><a class="header" href="#mdns-record-types">mDNS Record Types</a></h2>
<h3 id="common-record-types"><a class="header" href="#common-record-types">Common Record Types</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Type</th><th>Purpose</th><th>Example</th></tr></thead><tbody>
<tr><td><strong>A</strong></td><td>IPv4 address</td><td><code>device.local → 192.168.1.10</code></td></tr>
<tr><td><strong>AAAA</strong></td><td>IPv6 address</td><td><code>device.local → fe80::1</code></td></tr>
<tr><td><strong>PTR</strong></td><td>Pointer (service discovery)</td><td><code>_http._tcp.local → webserver</code></td></tr>
<tr><td><strong>SRV</strong></td><td>Service location</td><td><code>webserver._http._tcp.local → device.local:80</code></td></tr>
<tr><td><strong>TXT</strong></td><td>Text information</td><td>Service metadata</td></tr>
</tbody></table>
</div>
<h3 id="service-discovery-dns-sd"><a class="header" href="#service-discovery-dns-sd">Service Discovery (DNS-SD)</a></h3>
<pre><code>PTR Record: Browse services
  _http._tcp.local → webserver._http._tcp.local

SRV Record: Service location
  webserver._http._tcp.local
    Target: myserver.local
    Port: 8080
    Priority: 0
    Weight: 0

TXT Record: Service metadata
  webserver._http._tcp.local
    "path=/admin"
    "version=1.0"

A Record: IP address
  myserver.local → 192.168.1.50
</code></pre>
<h2 id="mdns-features"><a class="header" href="#mdns-features">mDNS Features</a></h2>
<h3 id="1-multicast-queries"><a class="header" href="#1-multicast-queries">1. Multicast Queries</a></h3>
<pre><code>Traditional DNS (unicast):
  Client → DNS Server: "What's example.com?"
  DNS Server → Client: "93.184.216.34"

mDNS (multicast):
  Client → All devices: "Who has printer.local?"
  Printer → All devices: "I'm 192.168.1.100"

Benefits:
  - No dedicated server
  - All devices hear query
  - Multiple responses possible
</code></pre>
<h3 id="2-known-answer-suppression"><a class="header" href="#2-known-answer-suppression">2. Known-Answer Suppression</a></h3>
<pre><code>Query includes known answers to avoid redundant responses

Client has cached: printer.local → 192.168.1.100

Query:
  Question: printer.local?
  Known Answer: 192.168.1.100 (TTL &gt; 50% remaining)

Printer sees cached answer is still valid
  → Doesn't respond (saves bandwidth)
</code></pre>
<h3 id="3-cache-flush-bit"><a class="header" href="#3-cache-flush-bit">3. Cache-Flush Bit</a></h3>
<pre><code>Purpose: Invalidate old cache entries

Response with cache-flush:
  printer.local → 192.168.1.100
  Class: IN | 0x8000 (cache-flush bit set)

Receivers:
  - Flush old records for printer.local
  - Cache new record
  - Prevents stale data
</code></pre>
<h3 id="4-continuous-verification"><a class="header" href="#4-continuous-verification">4. Continuous Verification</a></h3>
<pre><code>Querier sends query even if cached
  - Verify host still exists
  - Detect IP changes
  - Maintain fresh cache

If no response → remove from cache
</code></pre>
<h3 id="5-graceful-shutdown"><a class="header" href="#5-graceful-shutdown">5. Graceful Shutdown</a></h3>
<pre><code>Device going offline:

Send goodbye message:
  printer.local → 192.168.1.100
  TTL: 0 (indicates removal)

Other devices:
  - Remove from cache immediately
  - Don't wait for timeout
</code></pre>
<h2 id="service-discovery-with-dns-sd"><a class="header" href="#service-discovery-with-dns-sd">Service Discovery with DNS-SD</a></h2>
<h3 id="browsing-services"><a class="header" href="#browsing-services">Browsing Services</a></h3>
<pre><code>Query:
  _services._dns-sd._udp.local PTR?

Response (all available service types):
  _http._tcp.local
  _printer._tcp.local
  _ssh._tcp.local
  _sftp-ssh._tcp.local
</code></pre>
<h3 id="finding-specific-service"><a class="header" href="#finding-specific-service">Finding Specific Service</a></h3>
<pre><code>Query:
  _http._tcp.local PTR?

Response (all HTTP services):
  webserver._http._tcp.local
  api._http._tcp.local
  admin._http._tcp.local
</code></pre>
<h3 id="getting-service-details"><a class="header" href="#getting-service-details">Getting Service Details</a></h3>
<pre><code>Query:
  webserver._http._tcp.local SRV?
  webserver._http._tcp.local TXT?

Response (SRV):
  Target: myserver.local
  Port: 8080
  Priority: 0
  Weight: 0

Response (TXT):
  path=/
  version=2.0
  https=true

Then resolve:
  myserver.local A? → 192.168.1.50
</code></pre>
<h2 id="mdns-implementation"><a class="header" href="#mdns-implementation">mDNS Implementation</a></h2>
<h3 id="python-example-query"><a class="header" href="#python-example-query">Python Example (Query)</a></h3>
<pre><code class="language-python">import socket
import struct

MDNS_ADDR = '224.0.0.251'
MDNS_PORT = 5353

def query_mdns(hostname):
    # Create UDP socket
    sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
    sock.setsockopt(socket.IPPROTO_IP, socket.IP_MULTICAST_TTL, 255)
    sock.settimeout(2)

    # Build DNS query
    # Header: ID=0, Flags=0, Questions=1
    query = struct.pack('!HHHHHH', 0, 0, 1, 0, 0, 0)

    # Question: hostname, type A, class IN
    for part in hostname.split('.'):
        query += bytes([len(part)]) + part.encode()
    query += b'\x00'  # End of name
    query += struct.pack('!HH', 1, 1)  # Type A, Class IN

    # Send query
    sock.sendto(query, (MDNS_ADDR, MDNS_PORT))

    # Receive responses
    responses = []
    try:
        while True:
            data, addr = sock.recvfrom(1024)
            responses.append((data, addr))
    except socket.timeout:
        pass

    sock.close()
    return responses

# Usage
responses = query_mdns('printer.local')
for data, addr in responses:
    print(f"Response from {addr}")
</code></pre>
<h3 id="python-example-responder-using-zeroconf"><a class="header" href="#python-example-responder-using-zeroconf">Python Example (Responder using zeroconf)</a></h3>
<pre><code class="language-python">from zeroconf import ServiceInfo, Zeroconf
import socket

# Get local IP
hostname = socket.gethostname()
local_ip = socket.gethostbyname(hostname)

# Create service info
info = ServiceInfo(
    "_http._tcp.local.",
    "My Web Server._http._tcp.local.",
    addresses=[socket.inet_aton(local_ip)],
    port=8080,
    properties={
        'path': '/',
        'version': '1.0'
    },
    server=f"{hostname}.local."
)

# Register service
zeroconf = Zeroconf()
zeroconf.register_service(info)

print(f"Service registered: {hostname}.local:8080")

try:
    input("Press Enter to unregister...\n")
finally:
    zeroconf.unregister_service(info)
    zeroconf.close()
</code></pre>
<h3 id="avahi-linux"><a class="header" href="#avahi-linux">Avahi (Linux)</a></h3>
<pre><code class="language-bash"># Install Avahi
sudo apt-get install avahi-daemon avahi-utils

# Check hostname
avahi-resolve -n hostname.local

# Browse services
avahi-browse -a

# Browse specific service
avahi-browse _http._tcp

# Publish service
avahi-publish -s "My Service" _http._tcp 8080 path=/
</code></pre>
<h3 id="bonjour-macos"><a class="header" href="#bonjour-macos">Bonjour (macOS)</a></h3>
<pre><code class="language-bash"># Resolve hostname
dns-sd -G v4 hostname.local

# Browse services
dns-sd -B _http._tcp

# Resolve service
dns-sd -L "My Service" _http._tcp

# Register service
dns-sd -R "My Service" _http._tcp . 8080 path=/
</code></pre>
<h3 id="windows-2"><a class="header" href="#windows-2">Windows</a></h3>
<pre><code class="language-powershell"># Windows 10+ includes mDNS support

# Resolve via PowerShell
Resolve-DnsName hostname.local

# Or use Bonjour SDK
# Download from Apple Developer
</code></pre>
<h2 id="mdns-service-naming"><a class="header" href="#mdns-service-naming">mDNS Service Naming</a></h2>
<h3 id="format"><a class="header" href="#format">Format</a></h3>
<pre><code>&lt;Instance&gt;._&lt;Service&gt;._&lt;Transport&gt;.local

Examples:
  My Printer._printer._tcp.local
  Living Room._airplay._tcp.local
  Office Server._smb._tcp.local
  Kitchen Speaker._raop._tcp.local
</code></pre>
<h3 id="common-service-types"><a class="header" href="#common-service-types">Common Service Types</a></h3>
<pre><code>_http._tcp        Web server
_https._tcp       Secure web server
_ssh._tcp         SSH server
_sftp-ssh._tcp    SFTP over SSH
_ftp._tcp         FTP server
_smb._tcp         Samba/Windows file sharing
_afpovertcp._tcp  Apple File Protocol
_printer._tcp     Printer
_ipp._tcp         Internet Printing Protocol
_airplay._tcp     AirPlay
_raop._tcp        Remote Audio Output Protocol
_spotify-connect._tcp  Spotify Connect
</code></pre>
<h2 id="mdns-traffic-analysis"><a class="header" href="#mdns-traffic-analysis">mDNS Traffic Analysis</a></h2>
<h3 id="capturing-mdns"><a class="header" href="#capturing-mdns">Capturing mDNS</a></h3>
<pre><code class="language-bash"># tcpdump
sudo tcpdump -i any -n port 5353

# Wireshark
# Filter: udp.port == 5353
# Follow: Right-click → Follow → UDP Stream
</code></pre>
<h3 id="example-capture"><a class="header" href="#example-capture">Example Capture</a></h3>
<pre><code>Query:
  192.168.1.10 → 224.0.0.251
  DNS Query: printer.local A?

Response:
  192.168.1.100 → 224.0.0.251
  DNS Answer: printer.local → 192.168.1.100 (TTL 120)
</code></pre>
<h2 id="mdns-security-considerations"><a class="header" href="#mdns-security-considerations">mDNS Security Considerations</a></h2>
<h3 id="vulnerabilities-1"><a class="header" href="#vulnerabilities-1">Vulnerabilities</a></h3>
<ol>
<li><strong>No Authentication</strong></li>
</ol>
<pre><code>Anyone can claim to be "printer.local"
No verification of identity
Potential for spoofing
</code></pre>
<ol start="2">
<li><strong>Local Network Only</strong></li>
</ol>
<pre><code>mDNS doesn't cross routers
Limited to link-local multicast
Good for security (confined to LAN)
</code></pre>
<ol start="3">
<li><strong>Information Disclosure</strong></li>
</ol>
<pre><code>Services broadcast their presence
Attackers can enumerate:
  - Device names
  - Service types
  - IP addresses
  - Software versions
</code></pre>
<ol start="4">
<li><strong>Name Conflicts</strong></li>
</ol>
<pre><code>Two devices with same hostname
Both respond to queries
Can cause confusion
</code></pre>
<h3 id="mitigation-1"><a class="header" href="#mitigation-1">Mitigation</a></h3>
<pre><code>1. Firewall rules
   - Block port 5353 on external interfaces
   - Allow only on trusted LANs

2. VLANs
   - Separate guest network
   - Prevent mDNS between VLANs

3. Unique hostnames
   - Avoid generic names
   - Include random identifier

4. Service filtering
   - Only advertise necessary services
   - Remove unused service announcements
</code></pre>
<h2 id="mdns-performance"><a class="header" href="#mdns-performance">mDNS Performance</a></h2>
<h3 id="bandwidth-usage"><a class="header" href="#bandwidth-usage">Bandwidth Usage</a></h3>
<pre><code>Typical traffic:
  - Query: ~50 bytes
  - Response: ~100 bytes
  - Continuous verification: ~1-2 queries/minute

Low bandwidth impact
Efficient for local networks
</code></pre>
<h3 id="cache-timing"><a class="header" href="#cache-timing">Cache Timing</a></h3>
<pre><code>TTL values:
  - Typical: 120 seconds (2 minutes)
  - High priority: 10 seconds
  - Low priority: 4500 seconds (75 minutes)

Refresh at 80% of TTL
Query again at 90% of TTL
Remove at 100% of TTL
</code></pre>
<h2 id="troubleshooting-mdns"><a class="header" href="#troubleshooting-mdns">Troubleshooting mDNS</a></h2>
<h3 id="device-not-responding"><a class="header" href="#device-not-responding">Device not responding</a></h3>
<pre><code class="language-bash"># 1. Check mDNS daemon
sudo systemctl status avahi-daemon  # Linux
sudo launchctl list | grep mDNS     # macOS

# 2. Test multicast
ping -c 3 224.0.0.251

# 3. Check firewall
sudo iptables -L | grep 5353
sudo ufw status

# 4. Capture traffic
sudo tcpdump -i any port 5353

# 5. Resolve manually
avahi-resolve -n device.local
dns-sd -G v4 device.local
</code></pre>
<h3 id="name-conflicts"><a class="header" href="#name-conflicts">Name conflicts</a></h3>
<pre><code>Error: "hostname.local already in use"

Solutions:
1. Rename device
   - hostname.local → hostname-2.local
   - Automatic on many systems

2. Check for duplicates
   - Ensure unique hostnames
   - Search network for conflicts
</code></pre>
<h3 id="slow-resolution"><a class="header" href="#slow-resolution">Slow resolution</a></h3>
<pre><code>Causes:
  - Network congestion
  - Many mDNS devices
  - Packet loss

Solutions:
  - Reduce query frequency
  - Use unicast if possible
  - Cache aggressively
</code></pre>
<h2 id="mdns-vs-dns"><a class="header" href="#mdns-vs-dns">mDNS vs DNS</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Feature</th><th>Traditional DNS</th><th>mDNS</th></tr></thead><tbody>
<tr><td><strong>Server</strong></td><td>Centralized server</td><td>Distributed (all devices)</td></tr>
<tr><td><strong>Configuration</strong></td><td>Manual setup</td><td>Zero configuration</td></tr>
<tr><td><strong>Scope</strong></td><td>Internet-wide</td><td>Local network only</td></tr>
<tr><td><strong>Domain</strong></td><td>Any TLD</td><td><code>.local</code> only</td></tr>
<tr><td><strong>Protocol</strong></td><td>Unicast</td><td>Multicast</td></tr>
<tr><td><strong>Port</strong></td><td>53</td><td>5353</td></tr>
<tr><td><strong>Security</strong></td><td>DNSSEC available</td><td>No authentication</td></tr>
</tbody></table>
</div>
<h2 id="eli10-22"><a class="header" href="#eli10-22">ELI10</a></h2>
<p>mDNS is like asking a question to everyone in a classroom:</p>
<p><strong>Traditional DNS:</strong></p>
<ul>
<li>Raise your hand and ask the teacher</li>
<li>Teacher has a list of everyone's desks</li>
<li>Teacher tells you where Alice sits</li>
</ul>
<p><strong>mDNS (Multicast DNS):</strong></p>
<ul>
<li>Stand up and ask: "Where's Alice?"</li>
<li>Alice hears you and responds: "I'm here at desk 5!"</li>
<li>Everyone hears both question and answer</li>
<li>Next time someone asks, they already know</li>
</ul>
<p><strong>Benefits:</strong></p>
<ul>
<li>No need for a teacher (DNS server)</li>
<li>Works immediately</li>
<li>Everyone learns everyone else's location</li>
</ul>
<p><strong>Limitations:</strong></p>
<ul>
<li>Only works in one classroom (local network)</li>
<li>Can't ask about people in other classrooms</li>
<li>Everyone hears everything (less private)</li>
</ul>
<p><strong>Real Examples:</strong></p>
<ul>
<li>"Where's the printer?" → "printer.local is at 192.168.1.100"</li>
<li>"Where's my MacBook?" → "macbook.local is at 192.168.1.50"</li>
<li>"Any web servers?" → "myserver.local has HTTP on port 8080"</li>
</ul>
<p>It's perfect for homes and small offices where you just want things to work!</p>
<h2 id="further-resources-30"><a class="header" href="#further-resources-30">Further Resources</a></h2>
<ul>
<li><a href="https://tools.ietf.org/html/rfc6762">RFC 6762 - mDNS Specification</a></li>
<li><a href="https://tools.ietf.org/html/rfc6763">RFC 6763 - DNS-SD</a></li>
<li><a href="https://www.avahi.org/">Avahi</a></li>
<li><a href="https://developer.apple.com/bonjour/">Apple Bonjour</a></li>
<li><a href="https://github.com/jstasiak/python-zeroconf">zeroconf Python Library</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="firewalls-1"><a class="header" href="#firewalls-1">Firewalls</a></h1>
<h2 id="overview-81"><a class="header" href="#overview-81">Overview</a></h2>
<p>A firewall is a network security system that monitors and controls incoming and outgoing network traffic based on predetermined security rules. It acts as a barrier between trusted internal networks and untrusted external networks (like the internet).</p>
<h2 id="firewall-types"><a class="header" href="#firewall-types">Firewall Types</a></h2>
<h3 id="1-packet-filtering-firewall"><a class="header" href="#1-packet-filtering-firewall">1. Packet Filtering Firewall</a></h3>
<p><strong>How it works:</strong></p>
<ul>
<li>Inspects individual packets</li>
<li>Makes decisions based on header information</li>
<li>Stateless (doesn't track connections)</li>
</ul>
<p><strong>Checks:</strong></p>
<ul>
<li>Source IP address</li>
<li>Destination IP address</li>
<li>Source port</li>
<li>Destination port</li>
<li>Protocol (TCP, UDP, ICMP)</li>
</ul>
<p><strong>Example Rule:</strong></p>
<pre><code>ALLOW TCP from 192.168.1.0/24 to any port 80
DENY TCP from any to any port 23
</code></pre>
<p><strong>Decision Process:</strong></p>
<pre><code>Incoming packet:
  Src: 192.168.1.10:54321
  Dst: 10.0.0.5:80
  Protocol: TCP

Check rules top-to-bottom:
  Rule 1: Allow 192.168.1.0/24 to port 80 → MATCH
  Action: ALLOW

Packet forwarded
</code></pre>
<p><strong>Pros:</strong></p>
<ul>
<li>Fast (minimal inspection)</li>
<li>Low resource usage</li>
<li>Simple configuration</li>
</ul>
<p><strong>Cons:</strong></p>
<ul>
<li>No state tracking</li>
<li>Can't detect complex attacks</li>
<li>Vulnerable to IP spoofing</li>
</ul>
<h3 id="2-stateful-inspection-firewall"><a class="header" href="#2-stateful-inspection-firewall">2. Stateful Inspection Firewall</a></h3>
<p><strong>How it works:</strong></p>
<ul>
<li>Tracks connection state</li>
<li>Maintains state table</li>
<li>Understands context of traffic</li>
</ul>
<p><strong>State Table Example:</strong></p>
<pre><code>Src IP        Src Port  Dst IP        Dst Port  State      Protocol
192.168.1.10  54321     93.184.216.34 80        ESTABLISHED TCP
192.168.1.11  54322     8.8.8.8       53        NEW         UDP
192.168.1.10  54323     10.0.0.5      22        SYN_SENT    TCP
</code></pre>
<p><strong>TCP Connection Tracking:</strong></p>
<pre><code>Client → Server: SYN
  State: NEW

Server → Client: SYN-ACK
  State: ESTABLISHED

Client → Server: ACK
  State: ESTABLISHED

... data transfer ...

Client → Server: FIN
  State: CLOSING

Server → Client: FIN-ACK
  State: CLOSED
</code></pre>
<p><strong>Example Rule:</strong></p>
<pre><code># Outbound rule
ALLOW TCP from 192.168.1.0/24 to any port 80 STATE NEW,ESTABLISHED

# Return traffic automatically allowed
# (tracked in state table)
</code></pre>
<p><strong>Pros:</strong></p>
<ul>
<li>Understands connection context</li>
<li>Better security than packet filtering</li>
<li>Prevents spoofing attacks</li>
<li>Allows related traffic</li>
</ul>
<p><strong>Cons:</strong></p>
<ul>
<li>More resource intensive</li>
<li>State table can be exhausted</li>
<li>Performance impact at scale</li>
</ul>
<h3 id="3-application-layer-firewall-proxy-firewall"><a class="header" href="#3-application-layer-firewall-proxy-firewall">3. Application Layer Firewall (Proxy Firewall)</a></h3>
<p><strong>How it works:</strong></p>
<ul>
<li>Operates at Layer 7 (Application)</li>
<li>Acts as intermediary (proxy)</li>
<li>Deep packet inspection</li>
<li>Understands application protocols</li>
</ul>
<p><strong>Proxy Flow:</strong></p>
<pre><code>Client → Proxy → Server

Client connects to proxy
Proxy inspects full request
Proxy makes decision
Proxy connects to server (if allowed)
Proxy relays response to client
</code></pre>
<p><strong>Inspection Capabilities:</strong></p>
<pre><code>HTTP/HTTPS:
  - URL filtering
  - Content scanning
  - Malware detection
  - Data loss prevention

FTP:
  - Command filtering
  - File type restrictions

SMTP:
  - Spam filtering
  - Attachment scanning
</code></pre>
<p><strong>Example:</strong></p>
<pre><code>HTTP Request:
  GET /admin.php HTTP/1.1
  Host: example.com

Proxy checks:
  1. Is /admin.php allowed? → NO
  2. Block request
  3. Return 403 Forbidden
</code></pre>
<p><strong>Pros:</strong></p>
<ul>
<li>Deep inspection</li>
<li>Understands application protocols</li>
<li>Can filter content</li>
<li>Hides internal network</li>
<li>Logging and auditing</li>
</ul>
<p><strong>Cons:</strong></p>
<ul>
<li>Significant performance impact</li>
<li>Complex configuration</li>
<li>May break some applications</li>
<li>Single point of failure</li>
</ul>
<h3 id="4-next-generation-firewall-ngfw"><a class="header" href="#4-next-generation-firewall-ngfw">4. Next-Generation Firewall (NGFW)</a></h3>
<p><strong>Combines:</strong></p>
<ul>
<li>Traditional firewall functions</li>
<li>Intrusion Prevention System (IPS)</li>
<li>Application awareness</li>
<li>SSL/TLS inspection</li>
<li>Advanced threat protection</li>
</ul>
<p><strong>Features:</strong></p>
<pre><code>1. Deep Packet Inspection (DPI)
   - Full packet content analysis

2. Application Control
   - Block Facebook but allow LinkedIn
   - Control by application, not just port

3. User Identity
   - Rules based on user/group
   - Active Directory integration

4. Threat Intelligence
   - Malware detection
   - Botnet protection
   - Zero-day protection

5. SSL Inspection
   - Decrypt HTTPS traffic
   - Inspect encrypted content
   - Re-encrypt and forward
</code></pre>
<p><strong>Example NGFW Rule:</strong></p>
<pre><code>DENY application "BitTorrent" for group "Employees"
ALLOW application "Salesforce" for group "Sales"
BLOCK malware signature "Trojan.Generic.123"
</code></pre>
<h2 id="firewall-architectures"><a class="header" href="#firewall-architectures">Firewall Architectures</a></h2>
<h3 id="1-packet-filtering-router"><a class="header" href="#1-packet-filtering-router">1. Packet Filtering Router</a></h3>
<pre><code>Internet → → [Router with ACL] → → Internal Network

Simple, single layer of protection
</code></pre>
<h3 id="2-dual-homed-host"><a class="header" href="#2-dual-homed-host">2. Dual-Homed Host</a></h3>
<pre><code>Internet → → [Firewall with 2 NICs] → → Internal Network
             (All traffic through firewall)

Complete traffic control
</code></pre>
<h3 id="3-screened-host"><a class="header" href="#3-screened-host">3. Screened Host</a></h3>
<pre><code>Internet → → [Router] → → [Firewall Host] → → Internal Network

Router filters basic traffic
Firewall provides additional protection
</code></pre>
<h3 id="4-screened-subnet-dmz"><a class="header" href="#4-screened-subnet-dmz">4. Screened Subnet (DMZ)</a></h3>
<pre><code>Internet → → [External FW] → → [DMZ] → → [Internal FW] → → Internal Network
                               (Web, Mail)

Public services in DMZ
Internal network isolated
</code></pre>
<p><strong>DMZ Example:</strong></p>
<pre><code>External Firewall Rules:
  - Allow HTTP/HTTPS to web server (DMZ)
  - Allow SMTP to mail server (DMZ)
  - Deny all to internal network

Internal Firewall Rules:
  - Allow web server to database (specific port)
  - Allow mail server to internal mail (specific port)
  - Deny all other DMZ traffic to internal
</code></pre>
<h2 id="firewall-rules"><a class="header" href="#firewall-rules">Firewall Rules</a></h2>
<h3 id="rule-components"><a class="header" href="#rule-components">Rule Components</a></h3>
<pre><code>1. Source: Where traffic originates
2. Destination: Where traffic is going
3. Service/Port: What service (HTTP, SSH, etc.)
4. Action: Allow, Deny, Reject
5. Direction: Inbound, Outbound
6. State: NEW, ESTABLISHED, RELATED
</code></pre>
<h3 id="rule-example-iptables"><a class="header" href="#rule-example-iptables">Rule Example (iptables)</a></h3>
<pre><code class="language-bash"># Allow SSH from specific network
iptables -A INPUT -s 192.168.1.0/24 -p tcp --dport 22 -j ACCEPT

# Allow established connections
iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT

# Allow HTTP and HTTPS
iptables -A INPUT -p tcp --dport 80 -j ACCEPT
iptables -A INPUT -p tcp --dport 443 -j ACCEPT

# Drop everything else
iptables -A INPUT -j DROP
</code></pre>
<h3 id="rule-ordering"><a class="header" href="#rule-ordering">Rule Ordering</a></h3>
<p><strong>Important:</strong> Rules processed top-to-bottom, first match wins</p>
<pre><code class="language-bash"># WRONG ORDER:
1. DENY all
2. ALLOW HTTP port 80  → Never reached!

# CORRECT ORDER:
1. ALLOW HTTP port 80
2. DENY all
</code></pre>
<h3 id="default-policy"><a class="header" href="#default-policy">Default Policy</a></h3>
<pre><code class="language-bash"># Default DENY (whitelist approach - more secure)
iptables -P INPUT DROP
iptables -P FORWARD DROP
iptables -P OUTPUT ACCEPT

# Then explicitly allow needed services

# Default ALLOW (blacklist approach - less secure)
iptables -P INPUT ACCEPT
iptables -P FORWARD ACCEPT
iptables -P OUTPUT ACCEPT

# Then explicitly block dangerous services
</code></pre>
<h2 id="common-firewall-configurations"><a class="header" href="#common-firewall-configurations">Common Firewall Configurations</a></h2>
<h3 id="1-linux-iptables"><a class="header" href="#1-linux-iptables">1. Linux iptables</a></h3>
<p><strong>View rules:</strong></p>
<pre><code class="language-bash">iptables -L -v -n
</code></pre>
<p><strong>Basic web server protection:</strong></p>
<pre><code class="language-bash"># Flush existing rules
iptables -F

# Default policies
iptables -P INPUT DROP
iptables -P FORWARD DROP
iptables -P OUTPUT ACCEPT

# Allow loopback
iptables -A INPUT -i lo -j ACCEPT

# Allow established connections
iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT

# Allow SSH (from specific network)
iptables -A INPUT -s 192.168.1.0/24 -p tcp --dport 22 -j ACCEPT

# Allow HTTP/HTTPS
iptables -A INPUT -p tcp --dport 80 -j ACCEPT
iptables -A INPUT -p tcp --dport 443 -j ACCEPT

# Allow ping
iptables -A INPUT -p icmp --icmp-type echo-request -j ACCEPT

# Log dropped packets
iptables -A INPUT -j LOG --log-prefix "DROPPED: "
iptables -A INPUT -j DROP

# Save rules
iptables-save &gt; /etc/iptables/rules.v4
</code></pre>
<h3 id="2-linux-ufw-uncomplicated-firewall"><a class="header" href="#2-linux-ufw-uncomplicated-firewall">2. Linux ufw (Uncomplicated Firewall)</a></h3>
<pre><code class="language-bash"># Enable firewall
ufw enable

# Default policies
ufw default deny incoming
ufw default allow outgoing

# Allow SSH
ufw allow 22/tcp

# Allow HTTP/HTTPS
ufw allow 80/tcp
ufw allow 443/tcp

# Allow from specific IP
ufw allow from 192.168.1.100

# Allow specific port from specific IP
ufw allow from 192.168.1.100 to any port 3306

# View rules
ufw status numbered

# Delete rule
ufw delete 5
</code></pre>
<h3 id="3-linux-firewalld"><a class="header" href="#3-linux-firewalld">3. Linux firewalld</a></h3>
<pre><code class="language-bash"># View zones
firewall-cmd --get-active-zones

# Add service to zone
firewall-cmd --zone=public --add-service=http
firewall-cmd --zone=public --add-service=https

# Add port
firewall-cmd --zone=public --add-port=8080/tcp

# Add rich rule
firewall-cmd --zone=public --add-rich-rule='rule family="ipv4" source address="192.168.1.0/24" service name="ssh" accept'

# Make permanent
firewall-cmd --runtime-to-permanent

# Reload
firewall-cmd --reload
</code></pre>
<h3 id="4-windows-firewall"><a class="header" href="#4-windows-firewall">4. Windows Firewall</a></h3>
<pre><code class="language-powershell"># View rules
Get-NetFirewallRule

# Enable firewall
Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled True

# Allow inbound port
New-NetFirewallRule -DisplayName "Allow HTTP" -Direction Inbound -LocalPort 80 -Protocol TCP -Action Allow

# Allow program
New-NetFirewallRule -DisplayName "My App" -Direction Inbound -Program "C:\App\myapp.exe" -Action Allow

# Block IP address
New-NetFirewallRule -DisplayName "Block IP" -Direction Inbound -RemoteAddress 10.0.0.5 -Action Block
</code></pre>
<h2 id="port-knocking"><a class="header" href="#port-knocking">Port Knocking</a></h2>
<p><strong>Concept:</strong> Hidden service that opens after specific sequence</p>
<p><strong>Example:</strong></p>
<pre><code class="language-bash"># Ports closed by default

# Client knocks sequence: 1234, 5678, 9012
nc -z server.com 1234
nc -z server.com 5678
nc -z server.com 9012

# Server detects sequence, opens SSH port 22 for client IP
# Client can now SSH

# After timeout, port closes again
</code></pre>
<p><strong>Configuration (knockd):</strong></p>
<pre><code>[openSSH]
sequence = 1234,5678,9012
seq_timeout = 10
command = /sbin/iptables -I INPUT -s %IP% -p tcp --dport 22 -j ACCEPT
tcpflags = syn

[closeSSH]
sequence = 9012,5678,1234
seq_timeout = 10
command = /sbin/iptables -D INPUT -s %IP% -p tcp --dport 22 -j ACCEPT
tcpflags = syn
</code></pre>
<h2 id="nat-network-address-translation-2"><a class="header" href="#nat-network-address-translation-2">NAT (Network Address Translation)</a></h2>
<h3 id="source-nat-snat--masquerading"><a class="header" href="#source-nat-snat--masquerading">Source NAT (SNAT) / Masquerading</a></h3>
<p><strong>Purpose:</strong> Hide internal IPs behind single public IP</p>
<pre><code class="language-bash"># iptables NAT
iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE

# Or specific IP
iptables -t nat -A POSTROUTING -o eth0 -j SNAT --to-source 203.0.113.5
</code></pre>
<p><strong>Traffic Flow:</strong></p>
<pre><code>Internal: 192.168.1.10:5000 → Internet
External: 203.0.113.5:6000 → Internet

Firewall tracks connection:
  192.168.1.10:5000 ↔ 203.0.113.5:6000

Return traffic:
  Internet → 203.0.113.5:6000
  Firewall translates back to: 192.168.1.10:5000
</code></pre>
<h3 id="destination-nat-dnat--port-forwarding"><a class="header" href="#destination-nat-dnat--port-forwarding">Destination NAT (DNAT) / Port Forwarding</a></h3>
<p><strong>Purpose:</strong> Expose internal service on public IP</p>
<pre><code class="language-bash"># Forward public port 80 to internal web server
iptables -t nat -A PREROUTING -i eth0 -p tcp --dport 80 -j DNAT --to-destination 192.168.1.20:80

# Forward public port 2222 to internal SSH
iptables -t nat -A PREROUTING -i eth0 -p tcp --dport 2222 -j DNAT --to-destination 192.168.1.10:22
</code></pre>
<p><strong>Traffic Flow:</strong></p>
<pre><code>Internet → 203.0.113.5:80
Firewall translates to: 192.168.1.20:80
Web server processes request
Response: 192.168.1.20:80 → Internet
Firewall translates from: 203.0.113.5:80 → Internet
</code></pre>
<h2 id="firewall-evasion-techniques-for-awareness"><a class="header" href="#firewall-evasion-techniques-for-awareness">Firewall Evasion Techniques (for awareness)</a></h2>
<h3 id="1-fragmentation"><a class="header" href="#1-fragmentation">1. Fragmentation</a></h3>
<pre><code>Split malicious payload across fragments
Some firewalls don't reassemble
</code></pre>
<h3 id="2-ip-spoofing"><a class="header" href="#2-ip-spoofing">2. IP Spoofing</a></h3>
<pre><code>Fake source IP address
Bypass source-based rules
</code></pre>
<h3 id="3-tunneling"><a class="header" href="#3-tunneling">3. Tunneling</a></h3>
<pre><code>Encapsulate forbidden traffic in allowed protocol
Example: SSH tunnel, DNS tunnel, ICMP tunnel
</code></pre>
<h3 id="4-encryption"><a class="header" href="#4-encryption">4. Encryption</a></h3>
<pre><code>Encrypt malicious traffic
Firewall can't inspect without SSL inspection
</code></pre>
<p><strong>Defense:</strong></p>
<ul>
<li>Fragment reassembly</li>
<li>Anti-spoofing rules</li>
<li>Protocol validation</li>
<li>SSL/TLS inspection</li>
<li>Deep packet inspection</li>
</ul>
<h2 id="firewall-logging"><a class="header" href="#firewall-logging">Firewall Logging</a></h2>
<h3 id="what-to-log"><a class="header" href="#what-to-log">What to Log</a></h3>
<pre><code>1. Blocked connections
2. Allowed critical connections
3. Rule changes
4. Authentication events
5. Anomalies (port scans, floods)
</code></pre>
<h3 id="iptables-logging"><a class="header" href="#iptables-logging">iptables Logging</a></h3>
<pre><code class="language-bash"># Log dropped packets
iptables -A INPUT -j LOG --log-prefix "DROPPED INPUT: " --log-level 4
iptables -A INPUT -j DROP

# Log accepted SSH
iptables -A INPUT -p tcp --dport 22 -j LOG --log-prefix "SSH ACCEPT: "
iptables -A INPUT -p tcp --dport 22 -j ACCEPT
</code></pre>
<h3 id="log-analysis"><a class="header" href="#log-analysis">Log Analysis</a></h3>
<pre><code class="language-bash"># View firewall logs (typical locations)
tail -f /var/log/syslog
tail -f /var/log/messages
tail -f /var/log/kern.log

# Search for dropped packets
grep "DROPPED" /var/log/syslog

# Count connections by source IP
grep "DROPPED" /var/log/syslog | awk '{print $NF}' | sort | uniq -c | sort -n
</code></pre>
<h2 id="firewall-best-practices"><a class="header" href="#firewall-best-practices">Firewall Best Practices</a></h2>
<h3 id="1-default-deny"><a class="header" href="#1-default-deny">1. Default Deny</a></h3>
<pre><code>Block everything by default
Explicitly allow only needed services
</code></pre>
<h3 id="2-principle-of-least-privilege"><a class="header" href="#2-principle-of-least-privilege">2. Principle of Least Privilege</a></h3>
<pre><code>Open only necessary ports
Restrict to specific sources when possible
Time-based rules when appropriate
</code></pre>
<h3 id="3-defense-in-depth"><a class="header" href="#3-defense-in-depth">3. Defense in Depth</a></h3>
<pre><code>Multiple layers:
  - Perimeter firewall
  - Host-based firewalls
  - Network segmentation
  - Application firewalls
</code></pre>
<h3 id="4-regular-updates"><a class="header" href="#4-regular-updates">4. Regular Updates</a></h3>
<pre><code>- Keep firewall software updated
- Review rules periodically
- Remove unused rules
- Update threat signatures (NGFW)
</code></pre>
<h3 id="5-monitoring-and-alerts"><a class="header" href="#5-monitoring-and-alerts">5. Monitoring and Alerts</a></h3>
<pre><code>- Enable logging
- Set up alerts for anomalies
- Regular log reviews
- Incident response plan
</code></pre>
<h3 id="6-testing"><a class="header" href="#6-testing">6. Testing</a></h3>
<pre><code>- Test rules before production
- Verify deny rules work
- Check for unintended access
- Regular security audits
</code></pre>
<h2 id="troubleshooting-firewall-issues"><a class="header" href="#troubleshooting-firewall-issues">Troubleshooting Firewall Issues</a></h2>
<h3 id="cant-connect-to-service"><a class="header" href="#cant-connect-to-service">Can't connect to service</a></h3>
<pre><code class="language-bash"># 1. Check if service is running
systemctl status nginx

# 2. Check if service is listening
netstat -tuln | grep :80
ss -tuln | grep :80

# 3. Check firewall rules
iptables -L -n -v
ufw status
firewall-cmd --list-all

# 4. Check logs
tail -f /var/log/syslog | grep UFW
journalctl -f -u firewalld

# 5. Test from different source
curl http://server-ip
telnet server-ip 80
</code></pre>
<h3 id="connection-works-locally-but-not-remotely"><a class="header" href="#connection-works-locally-but-not-remotely">Connection works locally but not remotely</a></h3>
<pre><code class="language-bash"># Likely firewall blocking external access

# Check INPUT chain
iptables -L INPUT -n -v

# Temporarily allow (testing only!)
iptables -I INPUT -p tcp --dport 80 -j ACCEPT

# If works, add permanent rule
</code></pre>
<h3 id="rule-not-working"><a class="header" href="#rule-not-working">Rule not working</a></h3>
<pre><code class="language-bash"># Check rule order
iptables -L -n -v --line-numbers

# Rules processed top-to-bottom
# Earlier DENY rule might catch traffic before ALLOW

# Reorder rules
iptables -I INPUT 1 -p tcp --dport 80 -j ACCEPT
</code></pre>
<h2 id="eli10-23"><a class="header" href="#eli10-23">ELI10</a></h2>
<p>A firewall is like a security guard at a building entrance:</p>
<p><strong>Security Guard (Firewall):</strong></p>
<ul>
<li>Checks everyone coming in and out</li>
<li>Has a list of rules (who's allowed, who's not)</li>
<li>Blocks suspicious people</li>
<li>Keeps a log of who enters</li>
</ul>
<p><strong>Types of Security:</strong></p>
<ol>
<li>
<p><strong>Basic Guard (Packet Filter):</strong></p>
<ul>
<li>Checks ID cards only</li>
<li>Fast but simple</li>
</ul>
</li>
<li>
<p><strong>Smart Guard (Stateful):</strong></p>
<ul>
<li>Remembers who entered</li>
<li>Allows them to leave</li>
<li>Tracks conversations</li>
</ul>
</li>
<li>
<p><strong>Super Guard (Application Layer):</strong></p>
<ul>
<li>Opens bags</li>
<li>Checks what you're carrying</li>
<li>Very thorough but slower</li>
</ul>
</li>
<li>
<p><strong>AI Guard (NGFW):</strong></p>
<ul>
<li>Facial recognition</li>
<li>Detects threats automatically</li>
<li>Learns from experience</li>
</ul>
</li>
</ol>
<p><strong>Rules Example:</strong></p>
<ul>
<li>"Allow employees" (like allowing HTTP port 80)</li>
<li>"Block suspicious visitors" (like blocking unknown IPs)</li>
<li>"Only executives can enter executive floor" (like restricting SSH to specific IPs)</li>
</ul>
<p><strong>DMZ is like a reception area:</strong></p>
<ul>
<li>Visitors wait here</li>
<li>Can't go into main office</li>
<li>Receptionists (DMZ servers) handle requests</li>
</ul>
<h2 id="further-resources-31"><a class="header" href="#further-resources-31">Further Resources</a></h2>
<ul>
<li><a href="https://www.frozentux.net/iptables-tutorial/iptables-tutorial.html">iptables Tutorial</a></li>
<li><a href="https://csrc.nist.gov/publications/detail/sp/800-41/rev-1/final">NIST Firewall Guide</a></li>
<li><a href="https://www.cisecurity.org/controls/">Firewall Best Practices</a></li>
<li><a href="https://www.openbsd.org/faq/pf/">pf (OpenBSD Firewall)</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="stun-session-traversal-utilities-for-nat-1"><a class="header" href="#stun-session-traversal-utilities-for-nat-1">STUN (Session Traversal Utilities for NAT)</a></h1>
<h2 id="overview-82"><a class="header" href="#overview-82">Overview</a></h2>
<p>STUN is a standardized network protocol that allows clients behind NAT (Network Address Translation) to discover their public IP address and the type of NAT they are behind. This information is crucial for establishing peer-to-peer connections in applications like VoIP, video conferencing, and WebRTC.</p>
<h2 id="the-nat-problem"><a class="header" href="#the-nat-problem">The NAT Problem</a></h2>
<h3 id="why-stun-is-needed"><a class="header" href="#why-stun-is-needed">Why STUN is Needed</a></h3>
<pre><code>Private Network              NAT Router            Internet
                             (Public IP)
+------------------+         +---------+         +----------------+
| PC1: 192.168.1.10|  ---&gt;  | Router  |  ---&gt;  | Other peer     |
| PC2: 192.168.1.11|         | External IP:     | wants to       |
| PC3: 192.168.1.12|         | 203.0.113.5      | connect to you |
+------------------+         +---------+         +----------------+

Problem: How does external peer know your public IP and port?
Solution: STUN server tells you!
</code></pre>
<h3 id="without-stun"><a class="header" href="#without-stun">Without STUN</a></h3>
<pre><code>Peer A (behind NAT) wants to connect to Peer B

Peer A knows only: 192.168.1.10 (private IP)
Peer B needs: 203.0.113.5:54321 (public IP:port)

Peer A can't tell Peer B how to reach it L
</code></pre>
<h3 id="with-stun"><a class="header" href="#with-stun">With STUN</a></h3>
<pre><code>Peer A queries STUN server
STUN server responds: "I see you as 203.0.113.5:54321"
Peer A tells Peer B: "Connect to 203.0.113.5:54321"
Peer B connects successfully 
</code></pre>
<h2 id="stun-architecture"><a class="header" href="#stun-architecture">STUN Architecture</a></h2>
<pre><code>Client                    STUN Server               Peer
(Behind NAT)              (Public IP)
  |                            |                      |
  | STUN Binding Request       |                      |
  |---------------------------&gt;|                      |
  |                            |                      |
  | STUN Binding Response      |                      |
  |&lt;---------------------------|                      |
  | (Your public IP:Port)      |                      |
  |                            |                      |
  | Send public IP:Port        |                      |
  |--------------------------------------------------&gt;|
  |                            |                      |
  |        Direct connection established              |
  |&lt;-------------------------------------------------&gt;|
</code></pre>
<h2 id="stun-message-format"><a class="header" href="#stun-message-format">STUN Message Format</a></h2>
<h3 id="message-structure"><a class="header" href="#message-structure">Message Structure</a></h3>
<pre><code> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|0 0|     STUN Message Type     |         Message Length        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         Magic Cookie                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
|                     Transaction ID (96 bits)                  |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         Attributes                            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</code></pre>
<h3 id="header-fields-2"><a class="header" href="#header-fields-2">Header Fields</a></h3>
<ol>
<li>
<p><strong>Message Type</strong> (16 bits):</p>
<ul>
<li>Class: Request (0x00), Success Response (0x01), Error Response (0x11)</li>
<li>Method: Binding (0x001)</li>
</ul>
</li>
<li>
<p><strong>Message Length</strong> (16 bits):</p>
<ul>
<li>Length of attributes (excluding 20-byte header)</li>
</ul>
</li>
<li>
<p><strong>Magic Cookie</strong> (32 bits):</p>
<ul>
<li>Fixed value: 0x2112A442</li>
<li>Helps distinguish STUN from other protocols</li>
</ul>
</li>
<li>
<p><strong>Transaction ID</strong> (96 bits):</p>
<ul>
<li>Unique identifier for matching requests/responses</li>
</ul>
</li>
</ol>
<h3 id="message-types"><a class="header" href="#message-types">Message Types</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Type</th><th>Value</th><th>Description</th></tr></thead><tbody>
<tr><td><strong>Binding Request</strong></td><td>0x0001</td><td>Request public IP/port</td></tr>
<tr><td><strong>Binding Response</strong></td><td>0x0101</td><td>Success response with address</td></tr>
<tr><td><strong>Binding Error</strong></td><td>0x0111</td><td>Error response</td></tr>
</tbody></table>
</div>
<h2 id="stun-attributes"><a class="header" href="#stun-attributes">STUN Attributes</a></h2>
<h3 id="common-attributes"><a class="header" href="#common-attributes">Common Attributes</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Attribute</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><strong>MAPPED-ADDRESS</strong></td><td>0x0001</td><td>Reflexive transport address (legacy)</td></tr>
<tr><td><strong>XOR-MAPPED-ADDRESS</strong></td><td>0x0020</td><td>XORed reflexive address (preferred)</td></tr>
<tr><td><strong>USERNAME</strong></td><td>0x0006</td><td>Username for authentication</td></tr>
<tr><td><strong>MESSAGE-INTEGRITY</strong></td><td>0x0008</td><td>HMAC-SHA1 hash</td></tr>
<tr><td><strong>ERROR-CODE</strong></td><td>0x0009</td><td>Error code and reason</td></tr>
<tr><td><strong>UNKNOWN-ATTRIBUTES</strong></td><td>0x000A</td><td>Unknown required attributes</td></tr>
<tr><td><strong>REALM</strong></td><td>0x0014</td><td>Realm for authentication</td></tr>
<tr><td><strong>NONCE</strong></td><td>0x0015</td><td>Nonce for digest authentication</td></tr>
<tr><td><strong>SOFTWARE</strong></td><td>0x8022</td><td>Software version</td></tr>
<tr><td><strong>FINGERPRINT</strong></td><td>0x8028</td><td>CRC-32 of message</td></tr>
</tbody></table>
</div>
<h3 id="xor-mapped-address-format"><a class="header" href="#xor-mapped-address-format">XOR-MAPPED-ADDRESS Format</a></h3>
<pre><code> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|0 0 0 0 0 0 0 0|    Family     |         X-Port                |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                X-Address (Variable)                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Family: 0x01 (IPv4), 0x02 (IPv6)
X-Port: Port XORed with most significant 16 bits of magic cookie
X-Address: IP address XORed with magic cookie (and transaction ID for IPv6)
</code></pre>
<p><strong>Why XOR?</strong></p>
<ul>
<li>Prevents middle boxes from modifying the address</li>
<li>Some NAT devices inspect and modify IP addresses in packets</li>
</ul>
<h2 id="stun-transaction-example"><a class="header" href="#stun-transaction-example">STUN Transaction Example</a></h2>
<h3 id="binding-request"><a class="header" href="#binding-request">Binding Request</a></h3>
<pre><code>Client → STUN Server (UDP port 3478)

Message Type: Binding Request (0x0001)
Message Length: 0
Magic Cookie: 0x2112A442
Transaction ID: 0xB7E7A701BC34D686FA87DFAE

No attributes in basic request
</code></pre>
<p><strong>Hexadecimal:</strong></p>
<pre><code>00 01 00 00 21 12 A4 42
B7 E7 A7 01 BC 34 D6 86
FA 87 DF AE
</code></pre>
<h3 id="binding-response"><a class="header" href="#binding-response">Binding Response</a></h3>
<pre><code>STUN Server → Client

Message Type: Binding Response (0x0101)
Message Length: 12 (length of attributes)
Magic Cookie: 0x2112A442
Transaction ID: 0xB7E7A701BC34D686FA87DFAE (same as request)

Attributes:
  XOR-MAPPED-ADDRESS:
    Family: IPv4 (0x01)
    Port: 54321 (XORed)
    IP: 203.0.113.5 (XORed)
</code></pre>
<p><strong>Information extracted:</strong></p>
<pre><code>Your public IP address: 203.0.113.5
Your public port: 54321
NAT binding created: 192.168.1.10:5000 ↔ 203.0.113.5:54321
</code></pre>
<h2 id="nat-types-discovered-by-stun"><a class="header" href="#nat-types-discovered-by-stun">NAT Types Discovered by STUN</a></h2>
<h3 id="1-full-cone-nat"><a class="header" href="#1-full-cone-nat">1. Full Cone NAT</a></h3>
<pre><code>Internal: 192.168.1.10:5000

NAT creates mapping:
  192.168.1.10:5000 ↔ 203.0.113.5:6000

Any external host can send to 203.0.113.5:6000
  → Forwarded to 192.168.1.10:5000

Best for P2P (easy to traverse)
</code></pre>
<h3 id="2-restricted-cone-nat"><a class="header" href="#2-restricted-cone-nat">2. Restricted Cone NAT</a></h3>
<pre><code>Internal: 192.168.1.10:5000

NAT creates mapping:
  192.168.1.10:5000 ↔ 203.0.113.5:6000

External host 1.2.3.4 can send to 203.0.113.5:6000
  ONLY IF 192.168.1.10:5000 previously sent to 1.2.3.4

Moderate difficulty to traverse
</code></pre>
<h3 id="3-port-restricted-cone-nat"><a class="header" href="#3-port-restricted-cone-nat">3. Port Restricted Cone NAT</a></h3>
<pre><code>Internal: 192.168.1.10:5000

NAT creates mapping:
  192.168.1.10:5000 ↔ 203.0.113.5:6000

External host 1.2.3.4:7000 can send to 203.0.113.5:6000
  ONLY IF 192.168.1.10:5000 previously sent to 1.2.3.4:7000

More difficult to traverse
</code></pre>
<h3 id="4-symmetric-nat"><a class="header" href="#4-symmetric-nat">4. Symmetric NAT</a></h3>
<pre><code>Internal: 192.168.1.10:5000

NAT creates different mappings per destination:
  To host A: 192.168.1.10:5000 ↔ 203.0.113.5:6000
  To host B: 192.168.1.10:5000 ↔ 203.0.113.5:6001
  To host C: 192.168.1.10:5000 ↔ 203.0.113.5:6002

Difficult to traverse (may need TURN relay)
</code></pre>
<h2 id="stun-usage-in-ice"><a class="header" href="#stun-usage-in-ice">STUN Usage in ICE</a></h2>
<p><strong>ICE (Interactive Connectivity Establishment)</strong> uses STUN:</p>
<h3 id="ice-candidate-gathering"><a class="header" href="#ice-candidate-gathering">ICE Candidate Gathering</a></h3>
<pre><code>1. Host Candidate:
   Local IP: 192.168.1.10:5000

2. Server Reflexive Candidate (from STUN):
   Public IP: 203.0.113.5:6000

3. Relayed Candidate (from TURN):
   Relay IP: 198.51.100.1:7000

Try connections in order:
  1. Direct (host to host)
  2. Through NAT (server reflexive)
  3. Through relay (last resort)
</code></pre>
<h3 id="webrtc-connection-flow"><a class="header" href="#webrtc-connection-flow">WebRTC Connection Flow</a></h3>
<pre><code>Peer A                    STUN Server              Peer B
  |                            |                      |
  | Get my public IP           |                      |
  |---------------------------&gt;|                      |
  |                            |                      |
  | 203.0.113.5:6000           |                      |
  |&lt;---------------------------|                      |
  |                            |                      |
  | Exchange candidates via signaling server          |
  |&lt;-------------------------------------------------&gt;|
  |                            |                      |
  | Try connection             |                      |
  |&lt;-------------------------------------------------&gt;|
  | Connectivity check (STUN)  |                      |
  |&lt;-------------------------------------------------&gt;|
  |                            |                      |
  | Connection established     |                      |
  |&lt;=================================================&gt;|
</code></pre>
<h2 id="stun-authentication"><a class="header" href="#stun-authentication">STUN Authentication</a></h2>
<h3 id="short-term-credentials"><a class="header" href="#short-term-credentials">Short-Term Credentials</a></h3>
<pre><code>Request:
  USERNAME: "alice:bob"
  MESSAGE-INTEGRITY: HMAC-SHA1(message, password)

Server validates:
  1. Check username exists
  2. Compute HMAC with stored password
  3. Compare with MESSAGE-INTEGRITY
  4. Accept or reject
</code></pre>
<h3 id="long-term-credentials"><a class="header" href="#long-term-credentials">Long-Term Credentials</a></h3>
<pre><code>Request 1 (no credentials):
  Binding Request

Response 1:
  Error 401 Unauthorized
  REALM: "example.com"
  NONCE: "random-nonce-12345"

Request 2 (with credentials):
  USERNAME: "alice"
  REALM: "example.com"
  NONCE: "random-nonce-12345"
  MESSAGE-INTEGRITY: HMAC-SHA1(message, MD5(username:realm:password))

Response 2:
  Binding Success Response
  XOR-MAPPED-ADDRESS: ...
</code></pre>
<h2 id="stun-client-implementation"><a class="header" href="#stun-client-implementation">STUN Client Implementation</a></h2>
<h3 id="python-example-5"><a class="header" href="#python-example-5">Python Example</a></h3>
<pre><code class="language-python">import socket
import struct
import hashlib
import hmac

STUN_SERVER = "stun.l.google.com"
STUN_PORT = 19302
MAGIC_COOKIE = 0x2112A442

def create_stun_binding_request():
    # Message type: Binding Request (0x0001)
    msg_type = 0x0001

    # Message length: 0 (no attributes)
    msg_length = 0

    # Transaction ID: 96 random bits
    transaction_id = os.urandom(12)

    # Pack header
    header = struct.pack(
        '!HHI',
        msg_type,
        msg_length,
        MAGIC_COOKIE
    ) + transaction_id

    return header, transaction_id

def parse_stun_response(data, transaction_id):
    # Parse header
    msg_type, msg_length, magic_cookie = struct.unpack('!HHI', data[:8])
    recv_transaction_id = data[8:20]

    # Verify transaction ID
    if recv_transaction_id != transaction_id:
        raise Exception("Transaction ID mismatch")

    # Parse attributes
    offset = 20
    while offset &lt; len(data):
        attr_type, attr_length = struct.unpack('!HH', data[offset:offset+4])
        offset += 4

        if attr_type == 0x0020:  # XOR-MAPPED-ADDRESS
            # Parse XOR-MAPPED-ADDRESS
            family = data[offset + 1]
            x_port = struct.unpack('!H', data[offset+2:offset+4])[0]
            x_ip = struct.unpack('!I', data[offset+4:offset+8])[0]

            # Un-XOR
            port = x_port ^ (MAGIC_COOKIE &gt;&gt; 16)
            ip = x_ip ^ MAGIC_COOKIE
            ip_addr = socket.inet_ntoa(struct.pack('!I', ip))

            return ip_addr, port

        offset += attr_length

    return None, None

def get_public_ip_port():
    sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
    sock.settimeout(3)

    try:
        # Create and send binding request
        request, transaction_id = create_stun_binding_request()
        sock.sendto(request, (STUN_SERVER, STUN_PORT))

        # Receive response
        data, addr = sock.recvfrom(1024)

        # Parse response
        public_ip, public_port = parse_stun_response(data, transaction_id)

        return public_ip, public_port
    finally:
        sock.close()

# Usage
public_ip, public_port = get_public_ip_port()
print(f"Public IP: {public_ip}:{public_port}")
</code></pre>
<h3 id="javascript-webrtc-example"><a class="header" href="#javascript-webrtc-example">JavaScript (WebRTC) Example</a></h3>
<pre><code class="language-javascript">// Create RTCPeerConnection with STUN server
const configuration = {
  iceServers: [
    { urls: 'stun:stun.l.google.com:19302' },
    { urls: 'stun:stun1.l.google.com:19302' }
  ]
};

const pc = new RTCPeerConnection(configuration);

// Listen for ICE candidates
pc.onicecandidate = (event) =&gt; {
  if (event.candidate) {
    console.log('ICE Candidate:', event.candidate);
    // Send candidate to remote peer via signaling
  }
};

// Create offer to trigger ICE gathering
pc.createOffer()
  .then(offer =&gt; pc.setLocalDescription(offer))
  .then(() =&gt; {
    // ICE candidates will be gathered
    // and onicecandidate will be called
  });
</code></pre>
<h2 id="public-stun-servers"><a class="header" href="#public-stun-servers">Public STUN Servers</a></h2>
<h3 id="free-stun-servers"><a class="header" href="#free-stun-servers">Free STUN Servers</a></h3>
<pre><code>Google:
  stun.l.google.com:19302
  stun1.l.google.com:19302
  stun2.l.google.com:19302
  stun3.l.google.com:19302
  stun4.l.google.com:19302

Twilio:
  global.stun.twilio.com:3478

OpenRelay:
  stun.relay.metered.ca:80
</code></pre>
<h3 id="testing-stun-server"><a class="header" href="#testing-stun-server">Testing STUN Server</a></h3>
<pre><code class="language-bash"># Using stunclient (stuntman tools)
stunclient stun.l.google.com

# Output example:
# Binding test: success
# Local address: 192.168.1.10:45678
# Mapped address: 203.0.113.5:45678
</code></pre>
<h2 id="stun-limitations"><a class="header" href="#stun-limitations">STUN Limitations</a></h2>
<h3 id="1-doesnt-work-with-symmetric-nat"><a class="header" href="#1-doesnt-work-with-symmetric-nat">1. Doesn't Work with Symmetric NAT</a></h3>
<pre><code>STUN tells you: 203.0.113.5:6000
But when connecting to peer, NAT assigns: 203.0.113.5:6001

Peer can't connect to you
→ Need TURN relay
</code></pre>
<h3 id="2-requires-udp"><a class="header" href="#2-requires-udp">2. Requires UDP</a></h3>
<pre><code>Some networks block UDP
STUN won't work
→ Need TCP fallback or TURN over TCP
</code></pre>
<h3 id="3-firewall-issues"><a class="header" href="#3-firewall-issues">3. Firewall Issues</a></h3>
<pre><code>Restrictive firewalls may block P2P connections
Even with correct IP:port from STUN
→ Need TURN relay
</code></pre>
<h3 id="4-no-data-relay"><a class="header" href="#4-no-data-relay">4. No Data Relay</a></h3>
<pre><code>STUN only discovers address
Doesn't relay data
If direct connection fails, need TURN
</code></pre>
<h2 id="stun-vs-turn-vs-ice"><a class="header" href="#stun-vs-turn-vs-ice">STUN vs TURN vs ICE</a></h2>
<pre><code>STUN:
  - Discovers public IP:port
  - Lightweight
  - No bandwidth cost
  - Doesn't always work

TURN:
  - Relays traffic
  - Always works
  - Bandwidth intensive
  - Costs money

ICE:
  - Uses both STUN and TURN
  - Tries STUN first
  - Falls back to TURN
  - Best of both worlds
</code></pre>
<h2 id="stun-server-setup"><a class="header" href="#stun-server-setup">STUN Server Setup</a></h2>
<h3 id="using-coturn"><a class="header" href="#using-coturn">Using coturn</a></h3>
<pre><code class="language-bash"># Install
sudo apt-get install coturn

# Configure /etc/turnserver.conf
listening-port=3478
fingerprint
lt-cred-mech
use-auth-secret
static-auth-secret=YOUR_SECRET
realm=example.com
total-quota=100
stale-nonce=600
</code></pre>
<h3 id="run-stun-server"><a class="header" href="#run-stun-server">Run STUN Server</a></h3>
<pre><code class="language-bash"># Start server
sudo turnserver -v

# Test locally
stunclient localhost
</code></pre>
<h2 id="eli10-24"><a class="header" href="#eli10-24">ELI10</a></h2>
<p>STUN is like asking a friend "What's my address?" when you can't see it yourself:</p>
<p><strong>The Problem:</strong>
You live in an apartment building (NAT)
Someone outside wants to send you mail
They need your full address, not just "Apartment 5"</p>
<p><strong>STUN Solution:</strong></p>
<ol>
<li>You call a friend outside (STUN server)</li>
<li>Friend says: "I see your address as 123 Main St, Apartment 5"</li>
<li>You tell pen pal: "Send letters to 123 Main St, Apt 5"</li>
<li>Pen pal can now reach you!</li>
</ol>
<p><strong>NAT Types:</strong></p>
<ul>
<li><strong>Full Cone:</strong> Anyone can mail you once you have the address</li>
<li><strong>Restricted:</strong> Only people you mailed first can mail back</li>
<li><strong>Symmetric:</strong> Building assigns different box for each sender (hard!)</li>
</ul>
<p><strong>When STUN Doesn't Work:</strong></p>
<ul>
<li>Symmetric NAT: Address changes for each recipient</li>
<li>Firewall: Building doesn't accept outside mail</li>
<li>→ Need TURN (a forwarding service)</li>
</ul>
<p><strong>WebRTC Uses STUN:</strong></p>
<ul>
<li>Video calls discover how to reach each other</li>
<li>Try direct connection first (with STUN)</li>
<li>Use relay (TURN) if direct doesn't work</li>
</ul>
<h2 id="further-resources-32"><a class="header" href="#further-resources-32">Further Resources</a></h2>
<ul>
<li><a href="https://tools.ietf.org/html/rfc5389">RFC 5389 - STUN Specification</a></li>
<li><a href="https://tools.ietf.org/html/rfc8489">RFC 8489 - STUN Update</a></li>
<li><a href="https://webrtc.org/">WebRTC and STUN</a></li>
<li><a href="https://webrtc.github.io/samples/src/content/peerconnection/trickle-ice/">Interactive STUN Test</a></li>
<li><a href="https://github.com/coturn/coturn">coturn Server</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="turn-traversal-using-relays-around-nat-1"><a class="header" href="#turn-traversal-using-relays-around-nat-1">TURN (Traversal Using Relays around NAT)</a></h1>
<h2 id="overview-83"><a class="header" href="#overview-83">Overview</a></h2>
<p>TURN is a protocol that helps establish connections between peers when direct peer-to-peer communication fails. Unlike STUN which only discovers addresses, TURN acts as a relay server that forwards traffic between peers when NAT or firewall restrictions prevent direct connections.</p>
<h2 id="why-turn-is-needed"><a class="header" href="#why-turn-is-needed">Why TURN is Needed</a></h2>
<h3 id="when-stun-fails"><a class="header" href="#when-stun-fails">When STUN Fails</a></h3>
<pre><code>Scenario 1: Symmetric NAT
  Peer A behind Symmetric NAT
  Different public port for each destination
  STUN can't provide usable address
  → Need TURN relay

Scenario 2: Restrictive Firewall
  Corporate firewall blocks incoming P2P
  Even with correct address from STUN
  → Need TURN relay

Scenario 3: UDP Blocked
  Network blocks UDP traffic
  Can't use STUN or direct P2P
  → Need TURN over TCP
</code></pre>
<h2 id="turn-vs-stun"><a class="header" href="#turn-vs-stun">TURN vs STUN</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Feature</th><th>STUN</th><th>TURN</th></tr></thead><tbody>
<tr><td><strong>Purpose</strong></td><td>Discover public address</td><td>Relay traffic</td></tr>
<tr><td><strong>Bandwidth</strong></td><td>Minimal (discovery only)</td><td>High (relays all data)</td></tr>
<tr><td><strong>Success Rate</strong></td><td>~80%</td><td>~100%</td></tr>
<tr><td><strong>Cost</strong></td><td>Free (public servers)</td><td>Expensive (bandwidth)</td></tr>
<tr><td><strong>Latency</strong></td><td>Low (direct connection)</td><td>Higher (via relay)</td></tr>
<tr><td><strong>When to Use</strong></td><td>First attempt</td><td>Fallback</td></tr>
</tbody></table>
</div>
<h2 id="turn-architecture"><a class="header" href="#turn-architecture">TURN Architecture</a></h2>
<h3 id="basic-relay"><a class="header" href="#basic-relay">Basic Relay</a></h3>
<pre><code>Peer A                    TURN Server                Peer B
(Behind NAT)              (Public IP)                (Behind NAT)
192.168.1.10              198.51.100.1               10.0.0.5
  |                            |                         |
  | Allocate Request           |                         |
  |---------------------------&gt;|                         |
  | Allocate Success           |                         |
  |&lt;---------------------------|                         |
  | (Relayed address assigned) |                         |
  |                            |                         |
  | Send relayed address       |                         |
  | to Peer B via signaling    |                         |
  |                            |                         |
  |         Data               |          Data           |
  |---------------------------&gt;|------------------------&gt;|
  |                            | (TURN relays)           |
  |         Data               |          Data           |
  |&lt;---------------------------|&lt;------------------------|
</code></pre>
<h3 id="allocation"><a class="header" href="#allocation">Allocation</a></h3>
<pre><code>Client requests allocation from TURN server:

1. Client: "I need a relay address"
2. TURN: "Here's 198.51.100.1:50000 for you"
3. Client: "Route traffic between me and Peer X"
4. TURN: "OK, I'll relay your traffic"

Allocation lifetime: 10 minutes (default, can be refreshed)
</code></pre>
<h2 id="turn-message-types"><a class="header" href="#turn-message-types">TURN Message Types</a></h2>
<h3 id="key-operations-1"><a class="header" href="#key-operations-1">Key Operations</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Operation</th><th>Description</th></tr></thead><tbody>
<tr><td><strong>Allocate</strong></td><td>Request relay address</td></tr>
<tr><td><strong>Refresh</strong></td><td>Extend allocation lifetime</td></tr>
<tr><td><strong>Send</strong></td><td>Send data through relay</td></tr>
<tr><td><strong>Data</strong></td><td>Receive data from relay</td></tr>
<tr><td><strong>CreatePermission</strong></td><td>Allow peer to send data</td></tr>
<tr><td><strong>ChannelBind</strong></td><td>Optimize data transfer</td></tr>
</tbody></table>
</div>
<h3 id="allocate-requestresponse"><a class="header" href="#allocate-requestresponse">Allocate Request/Response</a></h3>
<p><strong>Request:</strong></p>
<pre><code>Client → TURN Server

Method: Allocate
Attributes:
  REQUESTED-TRANSPORT: UDP (17)
  LIFETIME: 600 seconds
  USERNAME: "alice"
  MESSAGE-INTEGRITY: HMAC
</code></pre>
<p><strong>Response:</strong></p>
<pre><code>TURN Server → Client

Method: Allocate Success
Attributes:
  XOR-RELAYED-ADDRESS: 198.51.100.1:50000
  LIFETIME: 600 seconds
  XOR-MAPPED-ADDRESS: 203.0.113.5:54321 (client's public IP)
  MESSAGE-INTEGRITY: HMAC
</code></pre>
<h2 id="turn-workflow"><a class="header" href="#turn-workflow">TURN Workflow</a></h2>
<h3 id="1-allocation"><a class="header" href="#1-allocation">1. Allocation</a></h3>
<pre><code>Client                          TURN Server
  |                                |
  | Allocate Request               |
  | (credentials, transport)       |
  |-------------------------------&gt;|
  |                                |
  | Allocate Success               |
  | (relayed address)              |
  |&lt;-------------------------------|
  |                                |

Allocation created:
  Client: 203.0.113.5:54321
  Relay: 198.51.100.1:50000
  Lifetime: 600 seconds
</code></pre>
<h3 id="2-permission"><a class="header" href="#2-permission">2. Permission</a></h3>
<pre><code>Client                          TURN Server
  |                                |
  | CreatePermission Request       |
  | (peer IP: 10.0.0.5)            |
  |-------------------------------&gt;|
  |                                |
  | CreatePermission Success       |
  |&lt;-------------------------------|
  |                                |

TURN server now accepts traffic from 10.0.0.5
Permission lifetime: 300 seconds
</code></pre>
<h3 id="3-sending-data"><a class="header" href="#3-sending-data">3. Sending Data</a></h3>
<h4 id="method-a-send-indication"><a class="header" href="#method-a-send-indication">Method A: Send Indication</a></h4>
<pre><code>Client                    TURN Server               Peer
  |                            |                      |
  | Send Indication            |                      |
  | To: 10.0.0.5:6000          |                      |
  | Data: "Hello"              |                      |
  |---------------------------&gt;|                      |
  |                            | UDP: "Hello"         |
  |                            |---------------------&gt;|
  |                            |                      |
</code></pre>
<h4 id="method-b-channel-binding-optimized"><a class="header" href="#method-b-channel-binding-optimized">Method B: Channel Binding (Optimized)</a></h4>
<pre><code>Client                    TURN Server               Peer
  |                            |                      |
  | ChannelBind Request        |                      |
  | Channel: 0x4000            |                      |
  | Peer: 10.0.0.5:6000        |                      |
  |---------------------------&gt;|                      |
  |                            |                      |
  | ChannelBind Success        |                      |
  |&lt;---------------------------|                      |
  |                            |                      |
  | ChannelData (0x4000)       |                      |
  | Data: "Hello"              |                      |
  |---------------------------&gt;|                      |
  |                            | UDP: "Hello"         |
  |                            |---------------------&gt;|

ChannelData has only 4-byte overhead (vs 36 bytes for Send)
More efficient for continuous data flow
</code></pre>
<h3 id="4-receiving-data"><a class="header" href="#4-receiving-data">4. Receiving Data</a></h3>
<pre><code>Peer                      TURN Server              Client
  |                            |                      |
  | UDP: "Reply"               |                      |
  |---------------------------&gt;|                      |
  |                            | Data Indication      |
  |                            | From: 10.0.0.5:6000  |
  |                            | Data: "Reply"        |
  |                            |---------------------&gt;|
  |                            |                      |
</code></pre>
<h2 id="turn-message-format"><a class="header" href="#turn-message-format">TURN Message Format</a></h2>
<h3 id="send-indication"><a class="header" href="#send-indication">Send Indication</a></h3>
<pre><code> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|0 0|     STUN Message Type     |         Message Length        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         Magic Cookie                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     Transaction ID (96 bits)                  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                   XOR-PEER-ADDRESS                            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                        DATA                                   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</code></pre>
<h3 id="channeldata-message"><a class="header" href="#channeldata-message">ChannelData Message</a></h3>
<pre><code> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         Channel Number        |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
|                       Application Data                        |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Channel Number: 0x4000 - 0x7FFF
Length: Length of application data
</code></pre>
<h2 id="turn-attributes"><a class="header" href="#turn-attributes">TURN Attributes</a></h2>
<h3 id="common-attributes-1"><a class="header" href="#common-attributes-1">Common Attributes</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Attribute</th><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><strong>XOR-RELAYED-ADDRESS</strong></td><td>0x0016</td><td>Relay transport address</td></tr>
<tr><td><strong>XOR-PEER-ADDRESS</strong></td><td>0x0012</td><td>Peer transport address</td></tr>
<tr><td><strong>DATA</strong></td><td>0x0013</td><td>Data to relay</td></tr>
<tr><td><strong>LIFETIME</strong></td><td>0x000D</td><td>Allocation lifetime (seconds)</td></tr>
<tr><td><strong>REQUESTED-TRANSPORT</strong></td><td>0x0019</td><td>Desired transport (UDP=17)</td></tr>
<tr><td><strong>CHANNEL-NUMBER</strong></td><td>0x000C</td><td>Channel number (0x4000-0x7FFF)</td></tr>
<tr><td><strong>EVEN-PORT</strong></td><td>0x0018</td><td>Request even port (RTP/RTCP)</td></tr>
<tr><td><strong>DONT-FRAGMENT</strong></td><td>0x001A</td><td>Don't fragment</td></tr>
<tr><td><strong>RESERVATION-TOKEN</strong></td><td>0x0022</td><td>Token for port reservation</td></tr>
</tbody></table>
</div>
<h2 id="turn-authentication"><a class="header" href="#turn-authentication">TURN Authentication</a></h2>
<h3 id="long-term-credentials-1"><a class="header" href="#long-term-credentials-1">Long-Term Credentials</a></h3>
<pre><code>Request 1 (no credentials):
  Allocate Request

Response 1:
  Error 401 Unauthorized
  REALM: "example.com"
  NONCE: "abcd1234"

Request 2 (with credentials):
  USERNAME: "alice"
  REALM: "example.com"
  NONCE: "abcd1234"
  MESSAGE-INTEGRITY: HMAC-SHA1(message, key)

Key = MD5(username:realm:password)

Response 2:
  Allocate Success Response
  XOR-RELAYED-ADDRESS: ...
  LIFETIME: 600
</code></pre>
<h3 id="short-term-credentials-1"><a class="header" href="#short-term-credentials-1">Short-Term Credentials</a></h3>
<pre><code>Used within ICE (WebRTC):
  USERNAME: &lt;random&gt;:&lt;random&gt;
  PASSWORD: &lt;shared secret&gt;

Simpler, time-limited authentication
</code></pre>
<h2 id="turn-allocation-lifecycle"><a class="header" href="#turn-allocation-lifecycle">TURN Allocation Lifecycle</a></h2>
<pre><code>1. Allocate (request relay)
   ↓
2. Success (relay assigned)
   ↓
3. CreatePermission (allow peers)
   ↓
4. ChannelBind (optimize transfer)
   ↓
5. Send/Receive Data
   ↓
6. Refresh (extend lifetime)
   ↓
7. Delete or Expire

Timeline:
  0s: Allocate
  300s: Refresh (extend to 900s)
  600s: Refresh (extend to 1200s)
  900s: Refresh (extend to 1500s)
  ...
  Stop refreshing: Allocation expires
</code></pre>
<h2 id="turn-over-different-transports"><a class="header" href="#turn-over-different-transports">TURN Over Different Transports</a></h2>
<h3 id="turn-over-udp"><a class="header" href="#turn-over-udp">TURN over UDP</a></h3>
<pre><code>Default mode
Client → TURN Server: UDP
TURN Server → Peer: UDP

Fast, but UDP might be blocked
</code></pre>
<h3 id="turn-over-tcp"><a class="header" href="#turn-over-tcp">TURN over TCP</a></h3>
<pre><code>Client → TURN Server: TCP
TURN Server → Peer: UDP

Works when UDP blocked
More overhead (TCP vs UDP)
</code></pre>
<h3 id="turn-over-tls"><a class="header" href="#turn-over-tls">TURN over TLS</a></h3>
<pre><code>Client → TURN Server: TLS over TCP
TURN Server → Peer: UDP

Encrypted control channel
Works in restrictive environments
Port 443 (looks like HTTPS)
</code></pre>
<h2 id="ice-with-turn"><a class="header" href="#ice-with-turn">ICE with TURN</a></h2>
<h3 id="candidate-priority"><a class="header" href="#candidate-priority">Candidate Priority</a></h3>
<pre><code>ICE tries candidates in order:

1. Host Candidate (local IP)
   Type: host
   Priority: Highest
   Example: 192.168.1.10:5000

2. Server Reflexive (STUN)
   Type: srflx
   Priority: High
   Example: 203.0.113.5:6000

3. Relayed (TURN)
   Type: relay
   Priority: Lowest (fallback)
   Example: 198.51.100.1:50000

Connection attempt:
  Try host → Try srflx → Try relay
  Use first successful connection
</code></pre>
<h3 id="webrtc-with-turn"><a class="header" href="#webrtc-with-turn">WebRTC with TURN</a></h3>
<pre><code class="language-javascript">const configuration = {
  iceServers: [
    // STUN server (free)
    { urls: 'stun:stun.l.google.com:19302' },

    // TURN server (requires auth)
    {
      urls: 'turn:turn.example.com:3478',
      username: 'alice',
      credential: 'password123'
    },

    // TURN over TLS
    {
      urls: 'turns:turn.example.com:5349',
      username: 'alice',
      credential: 'password123'
    }
  ]
};

const pc = new RTCPeerConnection(configuration);
</code></pre>
<h2 id="turn-server-setup"><a class="header" href="#turn-server-setup">TURN Server Setup</a></h2>
<h3 id="using-coturn-1"><a class="header" href="#using-coturn-1">Using coturn</a></h3>
<p><strong>Install:</strong></p>
<pre><code class="language-bash">sudo apt-get install coturn
</code></pre>
<p><strong>Configure <code>/etc/turnserver.conf</code>:</strong></p>
<pre><code class="language-bash"># Listening ports
listening-port=3478
tls-listening-port=5349

# Relay ports
min-port=49152
max-port=65535

# Authentication
lt-cred-mech
user=alice:password123
realm=example.com

# Or use shared secret
use-auth-secret
static-auth-secret=my-secret-key

# Certificates (for TLS)
cert=/etc/ssl/turn.crt
pkey=/etc/ssl/turn.key

# Logging
log-file=/var/log/turnserver.log
verbose

# External IP (if behind NAT)
external-ip=203.0.113.5/192.168.1.10

# Limit resources
max-bps=1000000
total-quota=100
</code></pre>
<p><strong>Run:</strong></p>
<pre><code class="language-bash">sudo turnserver -v
</code></pre>
<p><strong>Test:</strong></p>
<pre><code class="language-bash"># Using turnutils
turnutils_uclient -v -u alice -w password123 turn.example.com
</code></pre>
<h2 id="turn-bandwidth-considerations"><a class="header" href="#turn-bandwidth-considerations">TURN Bandwidth Considerations</a></h2>
<h3 id="bandwidth-usage-1"><a class="header" href="#bandwidth-usage-1">Bandwidth Usage</a></h3>
<pre><code>Video call: 2 Mbps per direction

Direct P2P (no TURN):
  Client A →→ Client B
  Total bandwidth: 4 Mbps (2 up + 2 down each)

Through TURN relay:
  Client A → TURN → Client B
  TURN bandwidth: 4 Mbps (2 in + 2 out)
  Each client: 4 Mbps (2 up + 2 down)

TURN server needs 2x the bandwidth!
</code></pre>
<h3 id="cost-implications"><a class="header" href="#cost-implications">Cost Implications</a></h3>
<pre><code>Example: 1000 concurrent video calls through TURN
  Each call: 2 Mbps × 2 directions = 4 Mbps
  Total: 1000 × 4 Mbps = 4 Gbps

At $0.10/GB:
  4 Gbps = 0.5 GB/second
  Per hour: 1,800 GB = $180/hour
  Per day: 43,200 GB = $4,320/day

Why ICE tries direct connection first!
</code></pre>
<h3 id="optimization-strategies"><a class="header" href="#optimization-strategies">Optimization Strategies</a></h3>
<pre><code>1. Prefer direct connections (STUN)
   - ~80% of connections succeed
   - Zero relay bandwidth

2. Short allocation lifetimes
   - Free up resources quickly
   - Prevent unused allocations

3. Connection quality monitoring
   - Switch from relay to direct if possible
   - ICE restart

4. Rate limiting
   - Prevent abuse
   - Fair resource sharing

5. Geographic distribution
   - Regional TURN servers
   - Reduce latency
</code></pre>
<h2 id="turn-security"><a class="header" href="#turn-security">TURN Security</a></h2>
<h3 id="authentication-required"><a class="header" href="#authentication-required">Authentication Required</a></h3>
<pre><code>Public TURN servers = expensive bandwidth
Must authenticate:
  - Username/password
  - Time-limited credentials
  - Shared secrets
</code></pre>
<h3 id="quota-management"><a class="header" href="#quota-management">Quota Management</a></h3>
<pre><code>Limit per user:
  - Bandwidth (bytes/sec)
  - Total data (GB)
  - Concurrent allocations
  - Allocation lifetime
</code></pre>
<h3 id="access-control-1"><a class="header" href="#access-control-1">Access Control</a></h3>
<pre><code>Restrict by:
  - IP ranges (corporate network)
  - Time windows
  - User groups
</code></pre>
<h2 id="monitoring-turn-server"><a class="header" href="#monitoring-turn-server">Monitoring TURN Server</a></h2>
<h3 id="key-metrics"><a class="header" href="#key-metrics">Key Metrics</a></h3>
<pre><code>1. Active allocations
   - Current number
   - Peak usage

2. Bandwidth
   - Total throughput
   - Per-client usage
   - Inbound/outbound ratio

3. Connections
   - Success rate
   - Allocation duration
   - Peak concurrent

4. Authentication
   - Failed attempts
   - Expired credentials

5. Resources
   - CPU usage
   - Memory
   - Network interfaces
   - Port exhaustion
</code></pre>
<h3 id="coturn-statistics"><a class="header" href="#coturn-statistics">coturn Statistics</a></h3>
<pre><code class="language-bash"># Real-time stats
telnet localhost 5766

# Commands:
ps    # Print sessions
pid   # Show process info
pc    # Print configuration
</code></pre>
<h2 id="turn-alternatives"><a class="header" href="#turn-alternatives">TURN Alternatives</a></h2>
<h3 id="1-direct-p2p-preferred"><a class="header" href="#1-direct-p2p-preferred">1. Direct P2P (preferred)</a></h3>
<pre><code>Pros: Free, low latency
Cons: Doesn't always work
Success rate: ~80%
</code></pre>
<h3 id="2-sipvoip-gateways"><a class="header" href="#2-sipvoip-gateways">2. SIP/VoIP Gateways</a></h3>
<pre><code>Traditional VoIP infrastructure
Built-in media relays
More expensive
</code></pre>
<h3 id="3-media-servers"><a class="header" href="#3-media-servers">3. Media Servers</a></h3>
<pre><code>Janus, Jitsi, Kurento
Selective Forwarding Unit (SFU)
Different model than TURN
</code></pre>
<h2 id="troubleshooting-turn"><a class="header" href="#troubleshooting-turn">Troubleshooting TURN</a></h2>
<h3 id="cant-allocate"><a class="header" href="#cant-allocate">Can't allocate</a></h3>
<pre><code class="language-bash"># Check TURN server is running
sudo systemctl status coturn

# Check listening ports
netstat -tuln | grep 3478

# Test with turnutils
turnutils_uclient -v turn.example.com
</code></pre>
<h3 id="authentication-fails"><a class="header" href="#authentication-fails">Authentication fails</a></h3>
<pre><code class="language-bash"># Verify credentials
turnutils_uclient -u alice -w password123 turn.example.com

# Check realm configuration
grep realm /etc/turnserver.conf

# Check logs
tail -f /var/log/turnserver.log
</code></pre>
<h3 id="high-latency"><a class="header" href="#high-latency">High latency</a></h3>
<pre><code>- Use geographically closer TURN server
- Check server load (CPU, bandwidth)
- Try TURN over TCP (sometimes faster)
- Monitor network path (traceroute)
</code></pre>
<h2 id="eli10-25"><a class="header" href="#eli10-25">ELI10</a></h2>
<p>TURN is like using a friend to pass notes in class:</p>
<p><strong>Without TURN (Direct):</strong></p>
<ul>
<li>You throw note directly to friend</li>
<li>Fast and easy</li>
<li>But teacher might catch it!</li>
</ul>
<p><strong>With TURN (Through Relay):</strong></p>
<ul>
<li>You give note to trusted student</li>
<li>They walk it over to your friend</li>
<li>Slower, but always works</li>
<li>Even if teacher is watching</li>
</ul>
<p><strong>Why TURN?</strong></p>
<p>Imagine you're in Building A, friend in Building B:</p>
<ul>
<li>Can't throw note that far (NAT/firewall blocking)</li>
<li>Need someone in the middle to help</li>
<li>TURN server is that helpful person</li>
</ul>
<p><strong>Costs:</strong></p>
<ul>
<li>Direct (free): Just toss the note</li>
<li>TURN (expensive): Someone must carry every note back and forth
<ul>
<li>Video call = thousands of notes per second!</li>
<li>TURN server gets tired (bandwidth costs)</li>
</ul>
</li>
</ul>
<p><strong>Smart Strategy (ICE):</strong></p>
<ol>
<li>Try throwing directly (host candidate)</li>
<li>Try from outside (STUN)</li>
<li>Last resort: Use TURN relay</li>
</ol>
<p>Use TURN only when absolutely needed!</p>
<h2 id="further-resources-33"><a class="header" href="#further-resources-33">Further Resources</a></h2>
<ul>
<li><a href="https://tools.ietf.org/html/rfc5766">RFC 5766 - TURN Specification</a></li>
<li><a href="https://tools.ietf.org/html/rfc8656">RFC 8656 - TURN Update</a></li>
<li><a href="https://github.com/coturn/coturn">coturn Server</a></li>
<li><a href="https://webrtc.org/">WebRTC ICE</a></li>
<li><a href="https://www.twilio.com/stun-turn">TURN Server Providers</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ice-interactive-connectivity-establishment-1"><a class="header" href="#ice-interactive-connectivity-establishment-1">ICE (Interactive Connectivity Establishment)</a></h1>
<h2 id="overview-84"><a class="header" href="#overview-84">Overview</a></h2>
<p>ICE (Interactive Connectivity Establishment) is a framework used to establish peer-to-peer connections through NATs and firewalls. It's primarily used by WebRTC, VoIP applications, and other real-time communication systems to find the best path for connecting two endpoints on the internet.</p>
<h2 id="the-nat-problem-1"><a class="header" href="#the-nat-problem-1">The NAT Problem</a></h2>
<h3 id="why-ice-is-needed"><a class="header" href="#why-ice-is-needed">Why ICE is Needed</a></h3>
<pre><code>Traditional Scenario:
┌──────────────┐                    ┌──────────────┐
│  Client A    │                    │  Client B    │
│ 10.0.0.5     │                    │ 192.168.1.10 │
└──────┬───────┘                    └──────┬───────┘
       │                                   │
       │ NAT                          NAT  │
       │                                   │
┌──────▼───────┐                    ┌──────▼───────┐
│    Router    │                    │    Router    │
│ 203.0.113.5  │                    │ 198.51.100.3 │
└──────────────┘                    └──────────────┘
       │                                   │
       └───────────── Internet ────────────┘

Problems:
1. Client A only knows its private IP (10.0.0.5)
2. Client B can't reach 10.0.0.5 (not routable)
3. Client A doesn't know Client B's public IP
4. Routers block unsolicited incoming connections

ICE Solution:
1. Discover public IPs (STUN)
2. Try multiple connection paths
3. Use relay as fallback (TURN)
4. Select best working path
</code></pre>
<h2 id="how-ice-works"><a class="header" href="#how-ice-works">How ICE Works</a></h2>
<h3 id="the-ice-process"><a class="header" href="#the-ice-process">The ICE Process</a></h3>
<pre><code>1. Gather Candidates
   Collect all possible ways to reach this peer:
   - Host candidate (local IP)
   - Server reflexive (public IP from STUN)
   - Relayed candidate (TURN relay)

2. Exchange Candidates
   Send candidates to remote peer via signaling

3. Pair Candidates
   Create pairs: local candidate + remote candidate

4. Check Connectivity
   Test all pairs in priority order

5. Select Best Pair
   Use the pair with highest priority that works

6. Keep Alive
   Maintain selected connection
</code></pre>
<h3 id="detailed-flow-diagram"><a class="header" href="#detailed-flow-diagram">Detailed Flow Diagram</a></h3>
<pre><code>Peer A                    Signaling Server                    Peer B
  |                              |                               |
  |──① Gather Candidates         |                               |
  |    - host                    |                               |
  |    - srflx (STUN)            |                               |
  |    - relay (TURN)            |                               |
  |                              |                               |
  |──② Send Candidates──────────►|                               |
  |    via SDP offer             |                               |
  |                              |──③ Forward Candidates────────►|
  |                              |                               |
  |                              |                               |──④ Gather Candidates
  |                              |                               |    - host
  |                              |                               |    - srflx (STUN)
  |                              |                               |    - relay (TURN)
  |                              |                               |
  |                              |◄──⑤ Send Candidates───────────|
  |                              |    via SDP answer             |
  |◄─⑥ Forward Candidates────────|                               |
  |                              |                               |
  |──⑦ Connectivity Checks───────────────────────────────────────►|
  |   (test all candidate pairs)                                 |
  |                              |                               |
  |◄─⑧ Connectivity Checks───────────────────────────────────────|
  |   (test all candidate pairs)                                 |
  |                              |                               |
  |──⑨ Nomination (best pair)────────────────────────────────────►|
  |                              |                               |
  |◄─⑩ Confirmation──────────────────────────────────────────────|
  |                              |                               |
  |══⑪ Media/Data Flow ═══════════════════════════════════════════|
  |   (using selected pair)                                      |
</code></pre>
<h2 id="ice-candidate-types"><a class="header" href="#ice-candidate-types">ICE Candidate Types</a></h2>
<h3 id="1-host-candidate"><a class="header" href="#1-host-candidate">1. Host Candidate</a></h3>
<pre><code>Local network interface address:

Type: host
Address: 10.0.0.5:54321
Foundation: 1

Characteristics:
- Actual IP address of the interface
- No NAT traversal
- Works only on same local network
- Lowest latency
- Priority: High for local connections

Example:
candidate:1 1 UDP 2130706431 10.0.0.5 54321 typ host

Use case:
- Devices on same LAN
- No NAT between peers
</code></pre>
<h3 id="2-server-reflexive-candidate-srflx"><a class="header" href="#2-server-reflexive-candidate-srflx">2. Server Reflexive Candidate (srflx)</a></h3>
<pre><code>Public IP address as seen by STUN server:

Type: srflx
Address: 203.0.113.5:61234
Related: 10.0.0.5:54321
Foundation: 2

Characteristics:
- Discovered via STUN server
- Public IP:port after NAT
- Most common for internet connections
- Priority: Medium-High

Example:
candidate:2 1 UDP 1694498815 203.0.113.5 61234 typ srflx
    raddr 10.0.0.5 rport 54321

Discovery:
1. Client sends STUN request from 10.0.0.5:54321
2. STUN server sees request from 203.0.113.5:61234
3. STUN responds with "Your IP:port is 203.0.113.5:61234"
4. Client creates srflx candidate

Use case:
- Typical internet connections
- NAT traversal
- Peer-to-peer over internet
</code></pre>
<h3 id="3-peer-reflexive-candidate-prflx"><a class="header" href="#3-peer-reflexive-candidate-prflx">3. Peer Reflexive Candidate (prflx)</a></h3>
<pre><code>Public IP discovered during connectivity checks:

Type: prflx
Address: 203.0.113.5:61235
Foundation: 3

Characteristics:
- Discovered during checks (not via STUN)
- Learned from peer's connectivity checks
- Alternative to srflx
- Priority: Medium

Example:
candidate:3 1 UDP 1862270975 203.0.113.5 61235 typ prflx
    raddr 10.0.0.5 rport 54321

Discovery:
1. Peer B sends connectivity check
2. Peer A receives from unexpected address
3. Peer A learns new reflexive address
4. Creates prflx candidate

Use case:
- Discovered during connection attempts
- Additional connectivity options
</code></pre>
<h3 id="4-relayed-candidate-relay"><a class="header" href="#4-relayed-candidate-relay">4. Relayed Candidate (relay)</a></h3>
<pre><code>Address on TURN relay server:

Type: relay
Address: 198.51.100.10:55555
Related: 203.0.113.5:61234
Foundation: 4

Characteristics:
- Allocated on TURN server
- Relay forwards all traffic
- Works through any NAT/firewall
- Highest latency and bandwidth cost
- Priority: Low (fallback)

Example:
candidate:4 1 UDP 16777215 198.51.100.10 55555 typ relay
    raddr 203.0.113.5 rport 61234

Discovery:
1. Client requests allocation from TURN server
2. TURN allocates 198.51.100.10:55555
3. Client creates relay candidate
4. All traffic flows through TURN

Use case:
- Symmetric NATs
- Restrictive firewalls
- When direct connection fails
- Corporate networks
</code></pre>
<h2 id="candidate-priority-1"><a class="header" href="#candidate-priority-1">Candidate Priority</a></h2>
<h3 id="priority-calculation"><a class="header" href="#priority-calculation">Priority Calculation</a></h3>
<pre><code>Priority Formula:
priority = (2^24 × type preference) +
           (2^8 × local preference) +
           (256 - component ID)

Type Preference (higher = better):
- host: 126
- prflx: 110
- srflx: 100
- relay: 0

Local Preference:
- Higher for interfaces you prefer
- Typically: 65535 for best interface

Component ID:
- 1 for RTP (main media)
- 2 for RTCP (control)

Example Calculations:

Host candidate:
(2^24 × 126) + (2^8 × 65535) + (256 - 1)
= 2113667071

Srflx candidate:
(2^24 × 100) + (2^8 × 65535) + (256 - 1)
= 1694498815

Relay candidate:
(2^24 × 0) + (2^8 × 65535) + (256 - 1)
= 16777215
</code></pre>
<h3 id="priority-in-practice"><a class="header" href="#priority-in-practice">Priority in Practice</a></h3>
<pre><code>Sorted by priority (high to low):

1. host (LAN)           Priority: 2113667071
   - Try first
   - Works if same network
   - Lowest latency

2. srflx (NAT)          Priority: 1694498815
   - Try second
   - Works through NAT
   - Good latency

3. prflx (Discovered)   Priority: 1862270975
   - Try if discovered
   - Alternative path

4. relay (TURN)         Priority: 16777215
   - Try last
   - Always works
   - Higher latency/cost

Best path:
host → host (LAN)
host → srflx (NAT traversal)
srflx → srflx (Both behind NAT)
relay → relay (Fallback)
</code></pre>
<h2 id="candidate-gathering"><a class="header" href="#candidate-gathering">Candidate Gathering</a></h2>
<h3 id="ice-gathering-states"><a class="header" href="#ice-gathering-states">ICE Gathering States</a></h3>
<pre><code class="language-javascript">// ICE gathering state machine

peerConnection.onicegatheringstatechange = () =&gt; {
  console.log('ICE gathering state:',
    peerConnection.iceGatheringState);
};

/*
States:

1. new
   - Initial state
   - No gathering started

2. gathering
   - Actively gathering candidates
   - STUN/TURN requests in progress

3. complete
   - All candidates gathered
   - Ready to connect
*/

// Monitor gathering
peerConnection.addEventListener('icecandidate', (event) =&gt; {
  if (event.candidate) {
    console.log('New candidate:', event.candidate);
    // Send to remote peer
  } else {
    console.log('Gathering complete');
    // All candidates collected
  }
});
</code></pre>
<h3 id="gathering-configuration"><a class="header" href="#gathering-configuration">Gathering Configuration</a></h3>
<pre><code class="language-javascript">// Configure ICE servers
const configuration = {
  iceServers: [
    // Public STUN servers (Google)
    {
      urls: 'stun:stun.l.google.com:19302'
    },
    {
      urls: 'stun:stun1.l.google.com:19302'
    },

    // STUN server (custom)
    {
      urls: 'stun:stun.example.com:3478'
    },

    // TURN server (UDP and TCP)
    {
      urls: [
        'turn:turn.example.com:3478',
        'turn:turn.example.com:3478?transport=tcp'
      ],
      username: 'user',
      credential: 'password',
      credentialType: 'password'
    },

    // TURN server (TLS)
    {
      urls: 'turns:turn.example.com:5349',
      username: 'user',
      credential: 'password'
    }
  ],

  // ICE transport policy
  iceTransportPolicy: 'all', // 'all' or 'relay'
  // 'all': Try all candidates
  // 'relay': Only use TURN (force relay)

  // Candidate pool size
  iceCandidatePoolSize: 10
  // Pre-allocate TURN allocations
  // Higher = faster but more resources
};

const peerConnection = new RTCPeerConnection(configuration);
</code></pre>
<h3 id="trickle-ice"><a class="header" href="#trickle-ice">Trickle ICE</a></h3>
<p>Instead of waiting for all candidates, send them as discovered:</p>
<pre><code class="language-javascript">// Sender: Send candidates as discovered
peerConnection.onicecandidate = (event) =&gt; {
  if (event.candidate) {
    // Send immediately (trickle)
    signaling.send({
      type: 'ice-candidate',
      candidate: event.candidate
    });
  } else {
    // Signal end of candidates
    signaling.send({
      type: 'ice-candidate',
      candidate: null
    });
  }
};

// Receiver: Add candidates as received
signaling.on('ice-candidate', async (message) =&gt; {
  if (message.candidate) {
    try {
      await peerConnection.addIceCandidate(
        new RTCIceCandidate(message.candidate)
      );
    } catch (error) {
      console.error('Error adding candidate:', error);
    }
  } else {
    // End of candidates
    console.log('Remote candidate gathering complete');
  }
});

Benefits:
- Faster connection establishment
- Start checks before all candidates gathered
- Improved user experience
</code></pre>
<h2 id="connectivity-checks"><a class="header" href="#connectivity-checks">Connectivity Checks</a></h2>
<h3 id="stun-binding-requests"><a class="header" href="#stun-binding-requests">STUN Binding Requests</a></h3>
<p>ICE uses STUN messages to test connectivity:</p>
<pre><code>Connectivity Check Process:

1. Create Candidate Pairs
   Local Candidate    Remote Candidate         Pair
   10.0.0.5:54321  +  192.168.1.10:44444  =  Pair 1
   10.0.0.5:54321  +  198.51.100.3:55555  =  Pair 2
   203.0.113.5:61234 + 192.168.1.10:44444 =  Pair 3
   203.0.113.5:61234 + 198.51.100.3:55555 =  Pair 4
   198.51.100.10:55555 + 192.168.1.10:44444 = Pair 5
   198.51.100.10:55555 + 198.51.100.3:55555 = Pair 6

2. Sort Pairs by Priority
   Priority = min(local priority, remote priority)

3. Send STUN Binding Request
   From: Local candidate
   To: Remote candidate
   Message: STUN Binding Request
   Attributes:
   - USERNAME: ice-ufrag
   - PRIORITY: candidate priority
   - ICE-CONTROLLING or ICE-CONTROLLED
   - MESSAGE-INTEGRITY: HMAC

4. Receive STUN Binding Response
   From: Remote candidate
   To: Local candidate
   Message: STUN Binding Response (Success)
   Attributes:
   - XOR-MAPPED-ADDRESS
   - MESSAGE-INTEGRITY

5. Mark Pair as Valid
   If response received, pair works!

6. Nominate Best Pair
   Controlling agent nominates highest priority valid pair
</code></pre>
<h3 id="controlling-vs-controlled"><a class="header" href="#controlling-vs-controlled">Controlling vs Controlled</a></h3>
<pre><code>ICE Roles:

Controlling Agent (Caller):
- Makes final decision on selected pair
- Sends nomination
- Usually the offerer

Controlled Agent (Callee):
- Responds to checks
- Accepts nomination
- Usually the answerer

Role Conflict Resolution:
If both think they're controlling:
- Compare ICE tie-breaker values
- Higher value becomes controlling
- Lower value becomes controlled

Attribute:
ICE-CONTROLLING: &lt;tie-breaker&gt;
  or
ICE-CONTROLLED: &lt;tie-breaker&gt;
</code></pre>
<h3 id="connectivity-check-states"><a class="header" href="#connectivity-check-states">Connectivity Check States</a></h3>
<pre><code>Candidate Pair States:

1. Frozen
   - Initial state
   - Waiting to be checked
   - Not yet sent binding request

2. Waiting
   - Ready to check
   - Will check soon
   - Waiting for resources

3. In Progress
   - Binding request sent
   - Waiting for response
   - Timeout if no response

4. Succeeded
   - Binding response received
   - Pair is valid
   - Can be used for media

5. Failed
   - No response (timeout)
   - Or error response
   - Cannot use this pair

State Machine:
Frozen → Waiting → In Progress → Succeeded ✓
                               → Failed ✗
</code></pre>
<h2 id="connection-states"><a class="header" href="#connection-states">Connection States</a></h2>
<h3 id="ice-connection-states"><a class="header" href="#ice-connection-states">ICE Connection States</a></h3>
<pre><code class="language-javascript">peerConnection.oniceconnectionstatechange = () =&gt; {
  console.log('ICE connection state:',
    peerConnection.iceConnectionState);

  switch (peerConnection.iceConnectionState) {
    case 'new':
      // Initial state, gathering not started
      console.log('ICE gathering starting...');
      break;

    case 'checking':
      // Checking candidate pairs
      console.log('Testing connectivity...');
      break;

    case 'connected':
      // At least one working pair found
      console.log('Connection established!');
      break;

    case 'completed':
      // All checks done, best pair selected
      console.log('ICE completed');
      break;

    case 'failed':
      // All pairs failed
      console.error('Connection failed');
      // Fallback: restart ICE or use TURN
      handleConnectionFailure();
      break;

    case 'disconnected':
      // Lost connectivity (temporary?)
      console.warn('Connection lost, attempting to reconnect...');
      break;

    case 'closed':
      // Connection closed
      console.log('Connection closed');
      break;
  }
};

// Overall connection state (combines ICE + DTLS)
peerConnection.onconnectionstatechange = () =&gt; {
  console.log('Connection state:',
    peerConnection.connectionState);
  // States: new, connecting, connected, disconnected, failed, closed
};
</code></pre>
<h2 id="ice-restart"><a class="header" href="#ice-restart">ICE Restart</a></h2>
<p>When connection fails or degrades:</p>
<pre><code class="language-javascript">// Restart ICE
async function restartIce(peerConnection) {
  console.log('Restarting ICE...');

  // Create new offer with iceRestart option
  const offer = await peerConnection.createOffer({
    iceRestart: true
  });

  await peerConnection.setLocalDescription(offer);

  // Send new offer to peer
  signaling.send({
    type: 'offer',
    sdp: offer
  });

  // New candidates will be gathered
  // New connectivity checks will be performed
}

// Trigger restart on failure
peerConnection.oniceconnectionstatechange = () =&gt; {
  if (peerConnection.iceConnectionState === 'failed') {
    console.error('ICE failed, restarting...');
    restartIce(peerConnection);
  }
};

// Or restart on disconnection timeout
let disconnectTimeout;

peerConnection.oniceconnectionstatechange = () =&gt; {
  if (peerConnection.iceConnectionState === 'disconnected') {
    // Wait 5 seconds before restart
    disconnectTimeout = setTimeout(() =&gt; {
      if (peerConnection.iceConnectionState !== 'connected') {
        restartIce(peerConnection);
      }
    }, 5000);
  } else if (peerConnection.iceConnectionState === 'connected') {
    clearTimeout(disconnectTimeout);
  }
};
</code></pre>
<h2 id="advanced-ice-features"><a class="header" href="#advanced-ice-features">Advanced ICE Features</a></h2>
<h3 id="ice-lite"><a class="header" href="#ice-lite">ICE Lite</a></h3>
<p>Simplified ICE for servers:</p>
<pre><code>ICE Lite:
- Only responds to checks (doesn't initiate)
- Only gathers host candidates
- Simpler implementation
- Used by servers (not browsers)

Standard ICE vs ICE Lite:

Standard ICE (Full Agent):
- Gathers all candidate types
- Sends connectivity checks
- Can be controlling or controlled
- Used by clients

ICE Lite:
- Only host candidates
- Only responds to checks
- Always controlled role
- Used by servers

Example: Media server
- Server uses ICE Lite
- Client uses full ICE
- Client initiates all checks
- Server just responds
</code></pre>
<h3 id="consent-freshness"><a class="header" href="#consent-freshness">Consent Freshness</a></h3>
<p>Keep-alive mechanism:</p>
<pre><code>Purpose:
- Verify peer still wants to receive
- Detect path changes
- Prevent unwanted traffic

Process:
1. Every 5 seconds, send STUN Binding Request
2. Peer responds with Binding Response
3. If no response for 30 seconds → disconnected

STUN Binding Request:
- From selected local candidate
- To selected remote candidate
- Authenticated (MESSAGE-INTEGRITY)

Failure:
- 30 seconds without response
- ICE state → disconnected
- May trigger ICE restart

Automatic in WebRTC:
- Browser handles automatically
- No manual intervention needed
</code></pre>
<h3 id="aggressive-nomination"><a class="header" href="#aggressive-nomination">Aggressive Nomination</a></h3>
<p>Faster connection establishment:</p>
<pre><code>Regular Nomination:
1. Check all pairs
2. Wait for all checks to complete
3. Nominate best pair
   Time: Slow but optimal

Aggressive Nomination:
1. Check pairs in priority order
2. Nominate first working pair immediately
3. Continue checking in background
   Time: Fast but may not be optimal

Trade-off:
- Aggressive: Faster connection, may not be best path
- Regular: Slower connection, guaranteed best path

Most WebRTC implementations use regular nomination
for better quality.
</code></pre>
<h2 id="debugging-ice"><a class="header" href="#debugging-ice">Debugging ICE</a></h2>
<h3 id="analyzing-ice-candidates"><a class="header" href="#analyzing-ice-candidates">Analyzing ICE Candidates</a></h3>
<pre><code class="language-javascript">// Log all candidates
peerConnection.onicecandidate = (event) =&gt; {
  if (event.candidate) {
    const candidate = event.candidate.candidate;
    console.log('Candidate:', candidate);

    // Parse candidate
    const parts = candidate.split(' ');
    const parsed = {
      foundation: parts[0].split(':')[1],
      component: parts[1],
      protocol: parts[2],
      priority: parts[3],
      ip: parts[4],
      port: parts[5],
      type: parts[7],
      relAddr: parts[9],
      relPort: parts[11]
    };

    console.log('Parsed:', parsed);

    // Identify issues
    if (parsed.type === 'relay') {
      console.warn('Using TURN relay (may indicate NAT/firewall issues)');
    }
    if (parsed.protocol === 'tcp') {
      console.warn('Using TCP (UDP may be blocked)');
    }
  }
};

// Monitor selected pair
async function getSelectedPair(peerConnection) {
  const stats = await peerConnection.getStats();

  stats.forEach(report =&gt; {
    if (report.type === 'candidate-pair' &amp;&amp; report.state === 'succeeded') {
      console.log('Selected pair:');
      console.log('  Local:', report.localCandidateId);
      console.log('  Remote:', report.remoteCandidateId);
      console.log('  State:', report.state);
      console.log('  Priority:', report.priority);
      console.log('  RTT:', report.currentRoundTripTime);
      console.log('  Bytes sent:', report.bytesSent);
      console.log('  Bytes received:', report.bytesReceived);
    }
  });
}

// Check every second
setInterval(() =&gt; getSelectedPair(peerConnection), 1000);
</code></pre>
<h3 id="common-ice-issues"><a class="header" href="#common-ice-issues">Common ICE Issues</a></h3>
<pre><code>Issue: No candidates gathered
Cause: Missing or incorrect STUN/TURN config
Solution: Verify iceServers configuration

Issue: Only relay candidates
Cause: Restrictive firewall blocks UDP
Solution:
- Enable UDP ports
- Use TURN with TCP
- Check firewall rules

Issue: Connectivity checks fail
Cause: Firewall blocks STUN packets
Solution:
- Allow UDP 3478 (STUN)
- Allow UDP 49152-65535 (RTP)
- Use TURN as fallback

Issue: Connection works then fails
Cause: NAT binding timeout
Solution:
- Shorter keep-alive interval
- Use consent freshness
- ICE restart on failure

Issue: High latency
Cause: Using TURN relay when direct possible
Solution:
- Verify STUN server reachable
- Check NAT type (symmetric NAT requires TURN)
- Verify candidate priorities

Issue: One-way media
Cause: Asymmetric connectivity
Solution:
- Check firewall rules both directions
- Verify both peers send candidates
- Use TURN if necessary
</code></pre>
<h3 id="ice-testing-tools"><a class="header" href="#ice-testing-tools">ICE Testing Tools</a></h3>
<pre><code class="language-bash"># Test STUN server
stunclient stun.l.google.com 19302

# Output shows:
# - Your public IP
# - NAT type
# - Whether server is reachable

# Test TURN server
turnutils_uclient -v -u username -w password \
  turn.example.com

# Test with ICE
# Browser: chrome://webrtc-internals
# - View all ICE candidates
# - See connectivity checks
# - Monitor selected pair

# Command-line ICE test
npm install -g wrtc-ice-tester
wrtc-ice-tester --stun stun:stun.l.google.com:19302

# Network debugging
tcpdump -i any -n udp port 3478 or portrange 49152-65535

# WebRTC test page
https://test.webrtc.org/
</code></pre>
<h2 id="ice-configuration-examples"><a class="header" href="#ice-configuration-examples">ICE Configuration Examples</a></h2>
<h3 id="basic-configuration-4"><a class="header" href="#basic-configuration-4">Basic Configuration</a></h3>
<pre><code class="language-javascript">// Minimal config (STUN only)
const config = {
  iceServers: [
    { urls: 'stun:stun.l.google.com:19302' }
  ]
};

// With TURN fallback
const config = {
  iceServers: [
    { urls: 'stun:stun.l.google.com:19302' },
    {
      urls: 'turn:turn.example.com:3478',
      username: 'user',
      credential: 'pass'
    }
  ]
};

// Production config (redundancy)
const config = {
  iceServers: [
    // Multiple STUN servers
    { urls: 'stun:stun1.example.com:3478' },
    { urls: 'stun:stun2.example.com:3478' },

    // TURN with TCP fallback
    {
      urls: [
        'turn:turn.example.com:3478',           // UDP
        'turn:turn.example.com:3478?transport=tcp', // TCP
        'turns:turn.example.com:5349'           // TLS
      ],
      username: 'user',
      credential: 'pass'
    }
  ],
  iceCandidatePoolSize: 10,
  iceTransportPolicy: 'all' // Try everything
};
</code></pre>
<h3 id="dynamic-turn-credentials"><a class="header" href="#dynamic-turn-credentials">Dynamic TURN Credentials</a></h3>
<pre><code class="language-javascript">// Get temporary TURN credentials from your server
async function getTurnCredentials() {
  const response = await fetch('/api/turn-credentials', {
    headers: { 'Authorization': 'Bearer ' + token }
  });

  return await response.json();
  /*
  Returns:
  {
    urls: ['turn:turn.example.com:3478'],
    username: 'temporary-user-12345',
    credential: 'temporary-password',
    ttl: 86400  // 24 hours
  }
  */
}

// Use dynamic credentials
const turnCreds = await getTurnCredentials();

const config = {
  iceServers: [
    { urls: 'stun:stun.example.com:3478' },
    {
      urls: turnCreds.urls,
      username: turnCreds.username,
      credential: turnCreds.credential,
      credentialType: 'password'
    }
  ]
};

const pc = new RTCPeerConnection(config);
</code></pre>
<h3 id="server-side-turn-credential-generation"><a class="header" href="#server-side-turn-credential-generation">Server-Side TURN Credential Generation</a></h3>
<pre><code class="language-javascript">// Node.js server
const crypto = require('crypto');

function generateTurnCredentials(username, secret, ttl = 86400) {
  const timestamp = Math.floor(Date.now() / 1000) + ttl;
  const turnUsername = `${timestamp}:${username}`;

  const hmac = crypto.createHmac('sha1', secret);
  hmac.update(turnUsername);
  const turnPassword = hmac.digest('base64');

  return {
    urls: [
      'turn:turn.example.com:3478',
      'turn:turn.example.com:3478?transport=tcp',
      'turns:turn.example.com:5349'
    ],
    username: turnUsername,
    credential: turnPassword,
    ttl: ttl
  };
}

// API endpoint
app.get('/api/turn-credentials', authenticate, (req, res) =&gt; {
  const credentials = generateTurnCredentials(
    req.user.id,
    process.env.TURN_SECRET,
    86400  // 24 hours
  );

  res.json(credentials);
});
</code></pre>
<h2 id="performance-considerations"><a class="header" href="#performance-considerations">Performance Considerations</a></h2>
<h3 id="minimizing-connection-time"><a class="header" href="#minimizing-connection-time">Minimizing Connection Time</a></h3>
<pre><code class="language-javascript">// 1. Pre-gather candidates
const pc = new RTCPeerConnection({
  iceServers: [...],
  iceCandidatePoolSize: 10  // Pre-allocate TURN
});

// 2. Use trickle ICE (send candidates immediately)
pc.onicecandidate = (event) =&gt; {
  if (event.candidate) {
    signaling.send({ type: 'candidate', candidate: event.candidate });
  }
};

// 3. Start gathering early
await pc.setLocalDescription(await pc.createOffer());

// 4. Use multiple STUN servers (parallel queries)
const config = {
  iceServers: [
    { urls: 'stun:stun1.example.com:3478' },
    { urls: 'stun:stun2.example.com:3478' },
    { urls: 'stun:stun3.example.com:3478' }
  ]
};

// 5. Close old connection before creating new one
if (oldPeerConnection) {
  oldPeerConnection.close();
}

// Typical connection time:
// - LAN: 100-500ms
// - Internet (NAT): 1-3 seconds
// - TURN relay: 2-5 seconds
</code></pre>
<h3 id="bandwidth-considerations"><a class="header" href="#bandwidth-considerations">Bandwidth Considerations</a></h3>
<pre><code>TURN Relay Bandwidth:

Scenario: 10 users in video call, all using TURN

Without TURN (P2P mesh):
Each user sends to 9 others directly
Total: 10 × 9 = 90 connections
User bandwidth: 9 video streams (upload + download)

With TURN relay:
Each user → TURN server → other users
Total: 10 × 9 through TURN
TURN bandwidth: 90 video streams
User bandwidth: Same (9 streams)

TURN costs:
- P2P: No relay bandwidth
- TURN: All traffic through server
- Solution: Use TURN only when necessary

Check if using TURN:
const stats = await pc.getStats();
stats.forEach(report =&gt; {
  if (report.type === 'local-candidate' &amp;&amp;
      report.candidateType === 'relay') {
    console.warn('Using TURN relay!');
  }
});
</code></pre>
<h2 id="nat-types-and-ice-success"><a class="header" href="#nat-types-and-ice-success">NAT Types and ICE Success</a></h2>
<h3 id="nat-type-matrix"><a class="header" href="#nat-type-matrix">NAT Type Matrix</a></h3>
<pre><code>NAT Types (restrictiveness):

1. No NAT
   ✓ Direct connection
   Success rate: 100%

2. Full Cone NAT
   ✓ Any external host can connect
   Success rate: 100%

3. Restricted Cone NAT
   ✓ Can connect after outbound packet
   Success rate: 95%

4. Port Restricted Cone NAT
   ✓ Can connect after outbound to specific port
   Success rate: 90%

5. Symmetric NAT
   ✗ Different port for each destination
   Needs TURN relay
   Success rate: 100% (with TURN)

Connection Matrix:

                 Peer B
              Full  Restricted  Symmetric
Peer A
Full          ✓     ✓           ✓*
Restricted    ✓     ✓           ✓*
Symmetric     ✓*    ✓*          ✗ (need TURN)

✓ = Direct connection (STUN sufficient)
✓* = May need TURN
✗ = Requires TURN relay
</code></pre>
<h2 id="eli10-ice-explained-simply"><a class="header" href="#eli10-ice-explained-simply">ELI10: ICE Explained Simply</a></h2>
<p>ICE is like finding the best way to connect two phones:</p>
<h3 id="the-problem"><a class="header" href="#the-problem">The Problem</a></h3>
<pre><code>You: Inside your house (private network)
Friend: Inside their house (private network)

Can't call directly:
- You don't know their full address
- Their house blocks unknown callers
- Your house blocks incoming calls
</code></pre>
<h3 id="ice-solution"><a class="header" href="#ice-solution">ICE Solution</a></h3>
<pre><code>1. Find All Your Phone Numbers
   - Room extension (host): 101
   - House number (srflx): (555) 123-4567
   - Call-forwarding service (relay): (555) 999-0000

2. Share Numbers
   - You send your 3 numbers to friend
   - Friend sends their 3 numbers to you

3. Try All Combinations (9 attempts)
   Your 101 → Their 101 (works if same house)
   Your 101 → Their (555) 234-5678 (fails)
   Your (555) 123-4567 → Their (555) 234-5678 (works!)
   ... etc

4. Use Best Connection
   - Direct if possible (faster, cheaper)
   - Through forwarding if necessary (works always)

5. Keep Checking
   - "Are you still there?"
   - If no answer, try again
</code></pre>
<h3 id="real-terms"><a class="header" href="#real-terms">Real Terms</a></h3>
<pre><code>House = Private network
House number = Public IP (STUN)
Call forwarding = Relay (TURN)
Trying combinations = Connectivity checks
Best connection = Selected candidate pair
</code></pre>
<h2 id="further-resources-34"><a class="header" href="#further-resources-34">Further Resources</a></h2>
<h3 id="specifications"><a class="header" href="#specifications">Specifications</a></h3>
<ul>
<li><a href="https://tools.ietf.org/html/rfc8445">RFC 8445 - ICE</a></li>
<li><a href="https://tools.ietf.org/html/rfc5389">RFC 5389 - STUN</a></li>
<li><a href="https://tools.ietf.org/html/rfc5766">RFC 5766 - TURN</a></li>
<li><a href="https://tools.ietf.org/html/rfc8656">RFC 8656 - TURN Extensions</a></li>
</ul>
<h3 id="tools-10"><a class="header" href="#tools-10">Tools</a></h3>
<ul>
<li><a href="https://webrtc.github.io/samples/src/content/peerconnection/trickle-ice/">Trickle ICE</a> - Test ICE candidates</li>
<li><a href="https://test.webrtc.org/">WebRTC Troubleshooter</a> - Connection testing</li>
<li><a href="https://www.nattest.net/">NAT Type Test</a> - Identify NAT type</li>
</ul>
<h3 id="debugging-6"><a class="header" href="#debugging-6">Debugging</a></h3>
<ul>
<li><a href="chrome://webrtc-internals">chrome://webrtc-internals</a> - Chrome ICE debug</li>
<li><a href="about:webrtc">about:webrtc</a> - Firefox ICE debug</li>
</ul>
<h3 id="stunturn-servers"><a class="header" href="#stunturn-servers">STUN/TURN Servers</a></h3>
<ul>
<li><a href="https://github.com/coturn/coturn">Coturn</a> - Open source TURN server</li>
<li><a href="https://xirsys.com/">Xirsys</a> - TURN server hosting</li>
<li><a href="https://www.twilio.com/stun-turn">Twilio STUN/TURN</a> - Managed service</li>
</ul>
<h3 id="articles"><a class="header" href="#articles">Articles</a></h3>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebRTC_API/Connectivity">WebRTC ICE</a></li>
<li><a href="https://bloggeek.me/webrtc-ice/">Understanding ICE</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="pcp-port-control-protocol-1"><a class="header" href="#pcp-port-control-protocol-1">PCP (Port Control Protocol)</a></h1>
<h2 id="overview-85"><a class="header" href="#overview-85">Overview</a></h2>
<p>PCP (Port Control Protocol) is a protocol that allows hosts to control how incoming packets are forwarded by upstream devices such as NAT gateways and firewalls. It's the successor to NAT-PMP and provides more features and flexibility for port mapping and firewall control.</p>
<h2 id="key-characteristics-4"><a class="header" href="#key-characteristics-4">Key Characteristics</a></h2>
<pre><code>Protocol: UDP
Port: 5351
RFC: 6887 (2013)
Predecessor: NAT-PMP (RFC 6886)

Features:
✓ Port mapping (like NAT-PMP)
✓ Firewall control
✓ IPv4 and IPv6 support
✓ Explicit lifetime management
✓ Multiple NATs/firewalls
✓ Third-party port mapping
✓ Failure detection
✓ Security improvements
</code></pre>
<h2 id="why-pcp"><a class="header" href="#why-pcp">Why PCP?</a></h2>
<h3 id="problems-with-manual-port-forwarding"><a class="header" href="#problems-with-manual-port-forwarding">Problems with Manual Port Forwarding</a></h3>
<pre><code>Traditional Approach:
1. User logs into router web interface
2. Manually configures port forwarding
3. Must remember to remove when done
4. Doesn't work with multiple NATs
5. Requires user intervention

Problems:
- Not suitable for applications
- Doesn't scale
- Security risk (ports left open)
- Complex for users
</code></pre>
<h3 id="pcp-solution"><a class="header" href="#pcp-solution">PCP Solution</a></h3>
<pre><code>Automated Approach:
1. Application requests port mapping via PCP
2. Router automatically configures forwarding
3. Mapping has lifetime (auto-expires)
4. Application can renew or delete
5. Works with cascaded NATs

Benefits:
✓ Fully automated
✓ Application-controlled
✓ Time-limited (secure)
✓ Works across multiple NATs
✓ Standardized protocol
</code></pre>
<h2 id="pcp-vs-upnp-vs-nat-pmp"><a class="header" href="#pcp-vs-upnp-vs-nat-pmp">PCP vs UPnP vs NAT-PMP</a></h2>
<pre><code>Feature               PCP        UPnP-IGD    NAT-PMP
Protocol              UDP        HTTP/SOAP   UDP
Complexity            Medium     High        Low
IPv6 Support          Yes        Partial     No
Multiple NATs         Yes        No          No
Explicit Lifetime     Yes        No          Yes
Firewall Control      Yes        No          No
Third-party Mapping   Yes        No          No
Security              Good       Weak        Basic
Standardization       IETF RFC   UPnP Forum  IETF RFC

Use PCP when:
- Need IPv6 support
- Multiple NATs in path
- Firewall control needed
- Modern deployment

Use NAT-PMP when:
- Simple IPv4 NAT
- Apple ecosystem
- Lightweight solution

Use UPnP when:
- Legacy device support
- Already deployed
- Complex scenarios
</code></pre>
<h2 id="pcp-architecture"><a class="header" href="#pcp-architecture">PCP Architecture</a></h2>
<pre><code>┌─────────────────────────────────────────────────────────────┐
│                      Internet                                │
└─────────────────┬───────────────────────────────────────────┘
                  │
         ┌────────▼────────┐
         │  ISP Router     │
         │  (PCP Server)   │
         └────────┬────────┘
                  │
         ┌────────▼────────┐
         │  Home Router    │
         │  (PCP Server)   │ ← Responds to PCP requests
         └────────┬────────┘
                  │
         ┌────────▼────────┐
         │  PCP Client     │ ← Sends PCP requests
         │  (Application)  │
         └─────────────────┘

Flow:
1. Client sends PCP request to server
2. Server creates/modifies mapping
3. Server responds with mapping details
4. Client maintains mapping with renewals
5. Mapping expires or client deletes it
</code></pre>
<h2 id="pcp-message-format"><a class="header" href="#pcp-message-format">PCP Message Format</a></h2>
<h3 id="request-header"><a class="header" href="#request-header">Request Header</a></h3>
<pre><code> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Version = 2  |R|   Opcode    |         Reserved              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                 Requested Lifetime (seconds)                  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
|            PCP Client's IP Address (128 bits)                 |
|                                                               |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
:                       Opcode-specific data                    :
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:                       PCP Options (optional)                  :
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Fields:

Version (8 bits): Protocol version (2)
R (1 bit): 0 for request, 1 for response
Opcode (7 bits):
  - 0: ANNOUNCE
  - 1: MAP
  - 2: PEER
Reserved (16 bits): Must be 0
Requested Lifetime (32 bits): Seconds (0 = delete)
PCP Client IP (128 bits): Client's IP address
  - IPv4: ::ffff:a.b.c.d (IPv4-mapped)
  - IPv6: Full 128-bit address
</code></pre>
<h3 id="response-header"><a class="header" href="#response-header">Response Header</a></h3>
<pre><code> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Version = 2  |R|   Opcode    |   Reserved    | Result Code   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      Lifetime (seconds)                       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     Epoch Time (seconds)                      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         Reserved (96 bits)                    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
:                       Opcode-specific data                    :
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:                       PCP Options (optional)                  :
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Result Code:
0: SUCCESS
1: UNSUPP_VERSION
2: NOT_AUTHORIZED
3: MALFORMED_REQUEST
4: UNSUPP_OPCODE
5: UNSUPP_OPTION
6: MALFORMED_OPTION
7: NETWORK_FAILURE
8: NO_RESOURCES
9: UNSUPP_PROTOCOL
10: USER_EX_QUOTA
11: CANNOT_PROVIDE_EXTERNAL
12: ADDRESS_MISMATCH
13: EXCESSIVE_REMOTE_PEERS

Epoch Time:
- Seconds since PCP server started
- Used to detect server reboots
- Client must refresh mappings if changed
</code></pre>
<h2 id="pcp-opcodes"><a class="header" href="#pcp-opcodes">PCP Opcodes</a></h2>
<h3 id="map-opcode"><a class="header" href="#map-opcode">MAP Opcode</a></h3>
<p>Create a mapping for inbound traffic:</p>
<pre><code>MAP Request (after common header):

 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         Mapping Nonce                         |
|                         (96 bits)                             |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Protocol    |          Reserved (24 bits)                   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        Internal Port          |  Suggested External Port      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
|           Suggested External IP Address (128 bits)            |
|                                                               |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Mapping Nonce:
- Random value to match request/response
- Prevents off-path attacks

Protocol:
- 6 = TCP
- 17 = UDP
- 0 = All protocols

Internal Port:
- Port on PCP client

Suggested External Port:
- Preferred external port
- 0 = server chooses

Suggested External IP:
- Preferred external IP
- 0 = server chooses

MAP Response (after common header):

 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         Mapping Nonce                         |
|                         (96 bits)                             |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Protocol    |          Reserved (24 bits)                   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        Internal Port          |    Assigned External Port     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
|           Assigned External IP Address (128 bits)             |
|                                                               |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Server assigns:
- External port (may differ from suggested)
- External IP address
- Lifetime for mapping
</code></pre>
<h3 id="peer-opcode"><a class="header" href="#peer-opcode">PEER Opcode</a></h3>
<p>Create a mapping for bidirectional traffic with a specific peer:</p>
<pre><code>PEER Request (after common header):

Similar to MAP, but includes remote peer address:

 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         Mapping Nonce                         |
|                         (96 bits)                             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Protocol    |          Reserved (24 bits)                   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        Internal Port          |  Suggested External Port      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
|           Suggested External IP Address (128 bits)            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       Remote Peer Port        |     Reserved (16 bits)        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
|              Remote Peer IP Address (128 bits)                |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Remote Peer Port:
- Port on remote peer

Remote Peer IP:
- IP address of remote peer

Use cases:
- P2P applications
- WebRTC
- VoIP
- Gaming
</code></pre>
<h3 id="announce-opcode"><a class="header" href="#announce-opcode">ANNOUNCE Opcode</a></h3>
<p>Solicit mappings from PCP-controlled devices:</p>
<pre><code>Used by client to discover mappings after:
- Client restart
- Network change
- Epoch time mismatch

Server responds with all active mappings for client
</code></pre>
<h2 id="pcp-options"><a class="header" href="#pcp-options">PCP Options</a></h2>
<h3 id="third_party-option"><a class="header" href="#third_party-option">THIRD_PARTY Option</a></h3>
<p>Allow one host to request mappings for another:</p>
<pre><code> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Option Code=1|  Reserved     |   Option Length=16            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
|                Internal IP Address (128 bits)                 |
|                                                               |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Use case:
- NAT gateway requests mapping for internal host
- Application server requests for clients
- Proxy services
</code></pre>
<h3 id="prefer_failure-option"><a class="header" href="#prefer_failure-option">PREFER_FAILURE Option</a></h3>
<p>Indicate client prefers error over server changing parameters:</p>
<pre><code> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Option Code=2|  Reserved     |   Option Length=0             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

With this option:
- Server must honor requested port/IP exactly
- Or return error
- No substitutions allowed

Without this option:
- Server can assign different port/IP
- Client should accept
</code></pre>
<h3 id="filter-option"><a class="header" href="#filter-option">FILTER Option</a></h3>
<p>Create a firewall filter:</p>
<pre><code> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Option Code=3|  Reserved     |   Option Length=20            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    Reserved   | Prefix Length |       Remote Peer Port        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
|              Remote Peer IP Address (128 bits)                |
|                                                               |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Prefix Length:
- 0 = Allow all
- 1-128 = IP prefix match

Use case:
- Restrict mapping to specific source
- Security filtering
- Allow only known peers
</code></pre>
<h2 id="pcp-client-implementation"><a class="header" href="#pcp-client-implementation">PCP Client Implementation</a></h2>
<h3 id="python-example-6"><a class="header" href="#python-example-6">Python Example</a></h3>
<pre><code class="language-python">import socket
import struct
import random
import time

class PCPClient:
    PCP_VERSION = 2
    PCP_SERVER_PORT = 5351
    OPCODE_MAP = 1
    OPCODE_PEER = 2

    def __init__(self, server_ip):
        self.server_ip = server_ip
        self.sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
        self.sock.settimeout(3)

    def create_mapping(self, internal_port, external_port=0,
                      protocol=6, lifetime=3600):
        """
        Create a port mapping.

        Args:
            internal_port: Port on client
            external_port: Suggested external port (0 = any)
            protocol: 6=TCP, 17=UDP
            lifetime: Mapping lifetime in seconds

        Returns:
            (external_ip, external_port, lifetime)
        """
        # Generate random nonce
        nonce = random.randint(0, 2**96 - 1)

        # Build request
        request = self._build_map_request(
            nonce, protocol, internal_port,
            external_port, lifetime
        )

        # Send request
        self.sock.sendto(request, (self.server_ip, self.PCP_SERVER_PORT))

        try:
            # Receive response
            response, addr = self.sock.recvfrom(1024)
            return self._parse_map_response(response, nonce)
        except socket.timeout:
            raise Exception("PCP request timeout")

    def delete_mapping(self, internal_port, protocol=6):
        """Delete a mapping by setting lifetime to 0."""
        return self.create_mapping(
            internal_port,
            protocol=protocol,
            lifetime=0
        )

    def _build_map_request(self, nonce, protocol, internal_port,
                          external_port, lifetime):
        """Build MAP request packet."""
        # Common header
        version_r_opcode = (self.PCP_VERSION &lt;&lt; 8) | self.OPCODE_MAP
        reserved = 0

        # Client IP (IPv4-mapped IPv6)
        client_ip = self._get_client_ip()
        client_ip_bytes = self._ipv4_to_ipv6_mapped(client_ip)

        # MAP opcode data
        nonce_bytes = nonce.to_bytes(12, 'big')
        protocol_byte = protocol
        reserved_24 = 0
        internal_port_field = internal_port
        external_port_field = external_port
        external_ip_bytes = bytes(16)  # All zeros = any

        # Pack request
        request = struct.pack(
            '!HHI',
            version_r_opcode,
            reserved,
            lifetime
        )
        request += client_ip_bytes
        request += nonce_bytes
        request += struct.pack(
            '!BxxxHH',
            protocol_byte,
            internal_port_field,
            external_port_field
        )
        request += external_ip_bytes

        return request

    def _parse_map_response(self, response, expected_nonce):
        """Parse MAP response packet."""
        # Parse common header
        version_r_opcode, reserved_result, lifetime, epoch = \
            struct.unpack('!HHII', response[:12])

        # Extract result code
        result = reserved_result &amp; 0xFF

        if result != 0:
            raise Exception(f"PCP error: result code {result}")

        # Skip reserved bytes
        offset = 12 + 12  # Header + reserved

        # Parse MAP response data
        nonce_bytes = response[offset:offset+12]
        nonce = int.from_bytes(nonce_bytes, 'big')

        if nonce != expected_nonce:
            raise Exception("Nonce mismatch")

        offset += 12

        protocol, internal_port, external_port = \
            struct.unpack('!BxxxHH', response[offset:offset+8])

        offset += 8

        external_ip_bytes = response[offset:offset+16]
        external_ip = self._ipv6_mapped_to_ipv4(external_ip_bytes)

        return (external_ip, external_port, lifetime)

    def _get_client_ip(self):
        """Get client's local IP address."""
        # Connect to PCP server to determine local IP
        s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
        try:
            s.connect((self.server_ip, self.PCP_SERVER_PORT))
            return s.getsockname()[0]
        finally:
            s.close()

    def _ipv4_to_ipv6_mapped(self, ipv4):
        """Convert IPv4 address to IPv4-mapped IPv6."""
        parts = [int(p) for p in ipv4.split('.')]
        # ::ffff:a.b.c.d
        return bytes([0]*10 + [0xff, 0xff] + parts)

    def _ipv6_mapped_to_ipv4(self, ipv6_bytes):
        """Convert IPv4-mapped IPv6 to IPv4."""
        if ipv6_bytes[:12] == bytes([0]*10 + [0xff, 0xff]):
            # IPv4-mapped
            return '.'.join(str(b) for b in ipv6_bytes[12:])
        else:
            # Full IPv6 - return as string
            parts = struct.unpack('!8H', ipv6_bytes)
            return ':'.join(f'{p:x}' for p in parts)

    def close(self):
        self.sock.close()


# Usage example
if __name__ == '__main__':
    # Find PCP server (usually gateway)
    gateway = '192.168.1.1'

    client = PCPClient(gateway)

    try:
        # Create mapping for local port 8080
        external_ip, external_port, lifetime = \
            client.create_mapping(
                internal_port=8080,
                external_port=8080,  # Suggest same port
                protocol=6,          # TCP
                lifetime=3600        # 1 hour
            )

        print(f"Mapping created:")
        print(f"  External: {external_ip}:{external_port}")
        print(f"  Internal: localhost:8080")
        print(f"  Lifetime: {lifetime} seconds")

        # Keep mapping alive
        print("\nMapping active. Press Ctrl+C to delete...")
        try:
            while True:
                # Renew every 30 minutes
                time.sleep(1800)
                external_ip, external_port, lifetime = \
                    client.create_mapping(8080, protocol=6, lifetime=3600)
                print(f"Mapping renewed: {lifetime}s remaining")
        except KeyboardInterrupt:
            pass

        # Delete mapping
        print("\nDeleting mapping...")
        client.delete_mapping(8080)
        print("Mapping deleted")

    finally:
        client.close()
</code></pre>
<h3 id="nodejs-example"><a class="header" href="#nodejs-example">Node.js Example</a></h3>
<pre><code class="language-javascript">const dgram = require('dgram');
const crypto = require('crypto');

class PCPClient {
  constructor(serverIP) {
    this.serverIP = serverIP;
    this.serverPort = 5351;
    this.socket = dgram.createSocket('udp4');
    this.PCP_VERSION = 2;
    this.OPCODE_MAP = 1;
  }

  async createMapping(internalPort, externalPort = 0, protocol = 6, lifetime = 3600) {
    const nonce = crypto.randomBytes(12);

    const request = this.buildMapRequest(
      nonce,
      protocol,
      internalPort,
      externalPort,
      lifetime
    );

    return new Promise((resolve, reject) =&gt; {
      const timeout = setTimeout(() =&gt; {
        reject(new Error('PCP request timeout'));
      }, 3000);

      this.socket.once('message', (response) =&gt; {
        clearTimeout(timeout);
        try {
          const result = this.parseMapResponse(response, nonce);
          resolve(result);
        } catch (error) {
          reject(error);
        }
      });

      this.socket.send(request, this.serverPort, this.serverIP);
    });
  }

  buildMapRequest(nonce, protocol, internalPort, externalPort, lifetime) {
    const buffer = Buffer.alloc(60);
    let offset = 0;

    // Version and opcode
    buffer.writeUInt8(this.PCP_VERSION, offset++);
    buffer.writeUInt8(this.OPCODE_MAP, offset++);

    // Reserved
    buffer.writeUInt16BE(0, offset);
    offset += 2;

    // Lifetime
    buffer.writeUInt32BE(lifetime, offset);
    offset += 4;

    // Client IP (IPv4-mapped)
    buffer.fill(0, offset, offset + 10);
    offset += 10;
    buffer.writeUInt16BE(0xffff, offset);
    offset += 2;
    // Would write actual IP here
    offset += 4;

    // Nonce
    nonce.copy(buffer, offset);
    offset += 12;

    // Protocol
    buffer.writeUInt8(protocol, offset);
    offset += 4; // 1 byte + 3 reserved

    // Ports
    buffer.writeUInt16BE(internalPort, offset);
    offset += 2;
    buffer.writeUInt16BE(externalPort, offset);
    offset += 2;

    // External IP (all zeros = any)
    buffer.fill(0, offset, offset + 16);

    return buffer;
  }

  parseMapResponse(response, expectedNonce) {
    let offset = 0;

    // Parse header
    const version = response.readUInt8(offset++);
    const opcode = response.readUInt8(offset++) &amp; 0x7f;
    const reserved = response.readUInt8(offset++);
    const result = response.readUInt8(offset++);
    const lifetime = response.readUInt32BE(offset);
    offset += 4;

    if (result !== 0) {
      throw new Error(`PCP error: result code ${result}`);
    }

    // Skip epoch and reserved
    offset += 16;

    // Check nonce
    const nonce = response.slice(offset, offset + 12);
    if (!nonce.equals(expectedNonce)) {
      throw new Error('Nonce mismatch');
    }
    offset += 12;

    // Parse MAP data
    const protocol = response.readUInt8(offset);
    offset += 4; // 1 byte + 3 reserved

    const internalPort = response.readUInt16BE(offset);
    offset += 2;
    const externalPort = response.readUInt16BE(offset);
    offset += 2;

    // External IP
    const externalIP = this.parseIP(response.slice(offset, offset + 16));

    return { externalIP, externalPort, lifetime };
  }

  parseIP(buffer) {
    // Check if IPv4-mapped
    if (buffer.slice(0, 12).equals(Buffer.from([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0xff, 0xff]))) {
      return `${buffer[12]}.${buffer[13]}.${buffer[14]}.${buffer[15]}`;
    }
    // IPv6
    const parts = [];
    for (let i = 0; i &lt; 16; i += 2) {
      parts.push(buffer.readUInt16BE(i).toString(16));
    }
    return parts.join(':');
  }

  close() {
    this.socket.close();
  }
}

// Usage
const client = new PCPClient('192.168.1.1');

client.createMapping(8080, 8080, 6, 3600)
  .then(result =&gt; {
    console.log('Mapping created:');
    console.log(`  External: ${result.externalIP}:${result.externalPort}`);
    console.log(`  Lifetime: ${result.lifetime}s`);
  })
  .catch(error =&gt; {
    console.error('Error:', error.message);
  })
  .finally(() =&gt; {
    client.close();
  });
</code></pre>
<h2 id="pcp-server-discovery"><a class="header" href="#pcp-server-discovery">PCP Server Discovery</a></h2>
<pre><code>Methods to find PCP server:

1. DHCP Option
   - Option 128 (DHCPv4)
   - Option 86 (DHCPv6)
   - Contains PCP server IP address

2. Default Gateway
   - Try gateway address first
   - Most common case

3. Well-Known Anycast Address
   - IPv4: (none defined)
   - IPv6: (none defined yet)

4. Manual Configuration
   - User configures PCP server
   - For complex networks

Discovery process:
1. Check DHCP options
2. Try default gateway
3. Try manual config
4. Give up (no PCP available)
</code></pre>
<h2 id="security-considerations-5"><a class="header" href="#security-considerations-5">Security Considerations</a></h2>
<pre><code>Authentication:
- PCP has no built-in authentication
- Relies on network trust
- Server trusts requests from local network

Threats:
1. Unauthorized mappings
   - Malware opens ports
   - Mitigation: Firewall rules on server

2. Mapping hijacking
   - Another host modifies mapping
   - Mitigation: Nonce verification

3. Denial of service
   - Exhaust mapping resources
   - Mitigation: Per-client quotas

4. Information disclosure
   - Reveal internal topology
   - Mitigation: Restrict query responses

Best practices:
- Deploy PCP-aware firewall
- Monitor mapping activity
- Set reasonable quotas
- Log suspicious requests
- Use short lifetimes
</code></pre>
<h2 id="common-use-cases-7"><a class="header" href="#common-use-cases-7">Common Use Cases</a></h2>
<h3 id="1-gaming"><a class="header" href="#1-gaming">1. Gaming</a></h3>
<pre><code class="language-python"># Game server
pcp = PCPClient('192.168.1.1')

# Create mapping for game server
external_ip, external_port, _ = pcp.create_mapping(
    internal_port=27015,  # Game server port
    external_port=27015,
    protocol=17,  # UDP
    lifetime=7200  # 2 hours
)

print(f"Server address: {external_ip}:{external_port}")
print("Share this with friends to join!")

# Register with matchmaking
register_with_matchmaking(external_ip, external_port)

# Keep mapping alive
while game_running:
    time.sleep(3600)
    pcp.create_mapping(27015, protocol=17, lifetime=7200)
</code></pre>
<h3 id="2-p2p-applications"><a class="header" href="#2-p2p-applications">2. P2P Applications</a></h3>
<pre><code class="language-python"># P2P file sharing
pcp = PCPClient(gateway)

# Create PEER mapping for specific peer
peer_ip = '203.0.113.50'
peer_port = 6881

mapping = pcp.create_peer_mapping(
    internal_port=6881,
    peer_ip=peer_ip,
    peer_port=peer_port,
    protocol=6,  # TCP
    lifetime=3600
)

print(f"Connected to peer: {peer_ip}:{peer_port}")
print(f"Via external: {mapping['external_ip']}:{mapping['external_port']}")
</code></pre>
<h3 id="3-iot-devices"><a class="header" href="#3-iot-devices">3. IoT Devices</a></h3>
<pre><code class="language-python"># Smart home device
pcp = PCPClient(gateway)

# Create long-lived mapping
external_ip, external_port, lifetime = pcp.create_mapping(
    internal_port=8883,  # MQTT over TLS
    protocol=6,
    lifetime=86400  # 24 hours
)

# Register with cloud service
register_device(device_id, external_ip, external_port)

# Renew daily
schedule_renewal(pcp, 8883, 86400)
</code></pre>
<h2 id="troubleshooting-22"><a class="header" href="#troubleshooting-22">Troubleshooting</a></h2>
<pre><code class="language-bash"># Check if PCP server is responding
nc -u 192.168.1.1 5351

# Send test request (hex)
echo -n "020100000000..." | nc -u 192.168.1.1 5351

# tcpdump PCP traffic
sudo tcpdump -i any -n udp port 5351

# Example output:
# Request
# 02 01 00 00 00 0e 10 00  # Version, opcode, reserved, lifetime
# 00 00 00 00 00 00 00 00  # Client IP (first 8 bytes)
# 00 00 ff ff c0 a8 01 64  # Client IP (last 8 bytes)
# ...

# Check router logs
# Look for "PCP" or "port mapping"

# Test with pcpdump (if available)
pcpdump -i eth0

# Common issues:
# - Router doesn't support PCP
# - PCP disabled in router config
# - Firewall blocks UDP 5351
# - Multiple NATs in path
# - Quota exceeded
</code></pre>
<h2 id="eli10-pcp-explained-simply"><a class="header" href="#eli10-pcp-explained-simply">ELI10: PCP Explained Simply</a></h2>
<p>PCP is like asking the gatekeeper to let your friends visit:</p>
<h3 id="without-pcp-manual"><a class="header" href="#without-pcp-manual">Without PCP (Manual)</a></h3>
<pre><code>You: "Mom, can you open the door at 3pm for my friend?"
Mom: Manually opens door at 3pm
Friend: Can enter
Problem: Mom must remember, manual work
</code></pre>
<h3 id="with-pcp-automatic"><a class="header" href="#with-pcp-automatic">With PCP (Automatic)</a></h3>
<pre><code>You: "Open door for 2 hours when friend arrives"
Smart Lock: Automatically opens
Friend: Arrives, enters
Smart Lock: Closes after 2 hours

Benefits:
- Automatic
- Time-limited
- You control it
- No manual work
</code></pre>
<h3 id="real-network"><a class="header" href="#real-network">Real Network</a></h3>
<pre><code>Your App: "Need port 8080 open for 1 hour"
Router: Creates port mapping
Internet: Can now reach your app
Router: Closes port after 1 hour

Secure because:
- Time-limited
- Application controlled
- Automatic cleanup
</code></pre>
<h2 id="further-resources-35"><a class="header" href="#further-resources-35">Further Resources</a></h2>
<h3 id="specifications-1"><a class="header" href="#specifications-1">Specifications</a></h3>
<ul>
<li><a href="https://tools.ietf.org/html/rfc6887">RFC 6887 - PCP</a></li>
<li><a href="https://tools.ietf.org/html/rfc6886">RFC 6886 - NAT-PMP</a></li>
<li><a href="https://tools.ietf.org/html/rfc7488">RFC 7488 - PCP Server Discovery</a></li>
</ul>
<h3 id="implementations"><a class="header" href="#implementations">Implementations</a></h3>
<ul>
<li><a href="https://github.com/libpcp/pcp">libpcp</a> - C library</li>
<li><a href="https://github.com/koron/go-pcp">go-pcp</a> - Go implementation</li>
<li><a href="https://github.com/miniupnp/miniupnp">miniupnpc</a> - Includes PCP support</li>
</ul>
<h3 id="tools-11"><a class="header" href="#tools-11">Tools</a></h3>
<ul>
<li>pcpdump - PCP packet analyzer</li>
<li>pcptest - PCP testing tool</li>
</ul>
<h3 id="comparison-3"><a class="header" href="#comparison-3">Comparison</a></h3>
<ul>
<li><a href="https://tools.ietf.org/html/rfc6887#appendix-B">PCP vs UPnP-IGD</a></li>
<li><a href="https://tools.ietf.org/html/rfc6887#appendix-A">PCP vs NAT-PMP</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="nat-pmp-nat-port-mapping-protocol-1"><a class="header" href="#nat-pmp-nat-port-mapping-protocol-1">NAT-PMP (NAT Port Mapping Protocol)</a></h1>
<h2 id="overview-86"><a class="header" href="#overview-86">Overview</a></h2>
<p>NAT-PMP (NAT Port Mapping Protocol) is a network protocol for establishing port forwarding rules in a NAT gateway automatically. It provides a simple, lightweight mechanism for applications to request port mappings without manual configuration. NAT-PMP was developed by Apple and later standardized as RFC 6886.</p>
<h2 id="key-characteristics-5"><a class="header" href="#key-characteristics-5">Key Characteristics</a></h2>
<pre><code>Protocol: UDP
Port: 5351
RFC: 6886 (2013)
Developed by: Apple Inc.
Successor: PCP (Port Control Protocol)

Features:
✓ Automatic port mapping
✓ Simple protocol (easy to implement)
✓ UDP-based (low overhead)
✓ Time-limited mappings
✓ Gateway discovery
✓ External address discovery
✓ Lightweight

Limitations:
✗ IPv4 only
✗ Single NAT only
✗ No authentication
✗ Limited features vs PCP
</code></pre>
<h2 id="why-nat-pmp"><a class="header" href="#why-nat-pmp">Why NAT-PMP?</a></h2>
<h3 id="the-problem-1"><a class="header" href="#the-problem-1">The Problem</a></h3>
<pre><code>Traditional Port Forwarding:
1. User manually logs into router
2. Navigates to port forwarding settings
3. Adds rule: External Port → Internal IP:Port
4. Application must document this for users
5. Users often configure incorrectly
6. Ports left open indefinitely

Issues:
- Not user-friendly
- Security risk (forgotten mappings)
- Doesn't work for non-technical users
- Can't be automated by applications
</code></pre>
<h3 id="nat-pmp-solution"><a class="header" href="#nat-pmp-solution">NAT-PMP Solution</a></h3>
<pre><code>Automatic Approach:
1. Application requests mapping via NAT-PMP
2. Router creates mapping automatically
3. Mapping has expiration time
4. Application renews as needed
5. Mapping removed when no longer needed

Benefits:
✓ Zero user configuration
✓ Automatic cleanup
✓ Application-controlled
✓ Simple to implement
✓ Secure (time-limited)
</code></pre>
<h2 id="nat-pmp-vs-alternatives"><a class="header" href="#nat-pmp-vs-alternatives">NAT-PMP vs Alternatives</a></h2>
<pre><code>Feature             NAT-PMP    UPnP-IGD    PCP
Protocol            UDP        HTTP/SOAP   UDP
Complexity          Low        High        Medium
IPv6 Support        No         Partial     Yes
Port              5351       Variable    5351
Packet Size         12 bytes   KB+         24+ bytes
Overhead            Minimal    High        Low
Deployment          Apple      Wide        Growing
Year Introduced     2005       2000        2013

Use NAT-PMP when:
- IPv4 only network
- Simple requirements
- Apple ecosystem
- Lightweight solution
- Easy implementation

Use PCP when:
- Need IPv6
- Modern deployment
- Advanced features
- Multiple NATs

Use UPnP when:
- Legacy compatibility
- Already deployed
- Complex scenarios
</code></pre>
<h2 id="protocol-design"><a class="header" href="#protocol-design">Protocol Design</a></h2>
<h3 id="message-types-1"><a class="header" href="#message-types-1">Message Types</a></h3>
<pre><code>Request Types (Client → NAT Gateway):
- Opcode 0: Determine external IP address
- Opcode 1: Map UDP port
- Opcode 2: Map TCP port

Response Types (NAT Gateway → Client):
- Opcode 128: External IP address response
- Opcode 129: UDP port mapping response
- Opcode 130: TCP port mapping response

All opcodes in responses have bit 7 set (add 128)
</code></pre>
<h3 id="packet-format"><a class="header" href="#packet-format">Packet Format</a></h3>
<pre><code>All NAT-PMP packets start with:

 0                   1
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Version = 0  |    Opcode     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Version: Always 0
Opcode: Request or response type
</code></pre>
<h2 id="external-ip-address-request"><a class="header" href="#external-ip-address-request">External IP Address Request</a></h2>
<h3 id="request-format"><a class="header" href="#request-format">Request Format</a></h3>
<pre><code> 0                   1
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Version = 0  |  Opcode = 0   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Total: 2 bytes

Purpose:
- Discover NAT gateway's external IP
- Check if NAT-PMP is supported
- Verify connectivity to gateway
</code></pre>
<h3 id="response-format"><a class="header" href="#response-format">Response Format</a></h3>
<pre><code> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Version = 0  | Opcode = 128  |        Result Code            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                  Seconds Since Start of Epoch                 |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     External IP Address                       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Total: 12 bytes

Result Code:
0: Success
1: Unsupported Version
2: Not Authorized/Refused
3: Network Failure
4: Out of Resources
5: Unsupported Opcode

Seconds Since Start of Epoch:
- Time since gateway booted/restarted
- Used to detect gateway reboots
- Incremented every second

External IP Address:
- Gateway's public IP address
- 32-bit IPv4 address
</code></pre>
<h2 id="port-mapping-request"><a class="header" href="#port-mapping-request">Port Mapping Request</a></h2>
<h3 id="request-format-1"><a class="header" href="#request-format-1">Request Format</a></h3>
<pre><code> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Version = 0  | Opcode (1/2)  |          Reserved (0)         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        Internal Port          |     Suggested External Port   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|              Requested Port Mapping Lifetime                  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Total: 12 bytes

Opcode:
- 1 = UDP port mapping
- 2 = TCP port mapping

Reserved: Must be 0

Internal Port:
- Port on the client machine
- Port application is listening on

Suggested External Port:
- Preferred external port
- 0 = gateway chooses
- Non-zero = client preference

Requested Lifetime:
- Duration in seconds
- 0 = delete mapping
- Recommended: 3600 (1 hour)
- Maximum: 2^32 - 1 seconds
</code></pre>
<h3 id="response-format-1"><a class="header" href="#response-format-1">Response Format</a></h3>
<pre><code> 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Version = 0  | Opcode (129/130) |        Result Code         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                  Seconds Since Start of Epoch                 |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        Internal Port          |      Mapped External Port     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                Port Mapping Lifetime (seconds)                |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Total: 16 bytes

Opcode:
- 129 = UDP port mapping response
- 130 = TCP port mapping response

Mapped External Port:
- Actual external port assigned
- May differ from suggested port
- 0 = mapping failed or deleted

Port Mapping Lifetime:
- Actual lifetime granted
- May be less than requested
- Gateway may reduce based on policy
</code></pre>
<h2 id="gateway-discovery"><a class="header" href="#gateway-discovery">Gateway Discovery</a></h2>
<h3 id="how-to-find-nat-gateway"><a class="header" href="#how-to-find-nat-gateway">How to Find NAT Gateway</a></h3>
<pre><code>Method 1: Default Gateway (Recommended)
- Use system's default gateway
- Most common case
- Works in 99% of deployments

import socket
import struct

def get_default_gateway():
    """Get default gateway IP (Linux)."""
    with open('/proc/net/route') as f:
        for line in f:
            fields = line.strip().split()
            if fields[1] == '00000000':  # Default route
                gateway_hex = fields[2]
                # Convert hex to IP
                gateway_int = int(gateway_hex, 16)
                return socket.inet_ntoa(struct.pack('&lt;I', gateway_int))
    return None

# Or use netifaces library
import netifaces
gws = netifaces.gateways()
gateway = gws['default'][netifaces.AF_INET][0]

Method 2: DHCP Option
- DHCP Option 120 (NAT-PMP Gateway)
- Rarely used in practice

Method 3: Multicast (Legacy)
- Send to 224.0.0.1 (all hosts)
- Gateway responds
- Not recommended

Best Practice:
Always try default gateway first
</code></pre>
<h2 id="client-implementation"><a class="header" href="#client-implementation">Client Implementation</a></h2>
<h3 id="python-example-7"><a class="header" href="#python-example-7">Python Example</a></h3>
<pre><code class="language-python">import socket
import struct
import time

class NATPMPClient:
    def __init__(self, gateway_ip):
        self.gateway_ip = gateway_ip
        self.gateway_port = 5351
        self.sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
        self.sock.settimeout(3.0)

    def get_external_ip(self):
        """
        Get NAT gateway's external IP address.

        Returns:
            (external_ip, epoch_seconds)
        """
        # Build request
        request = struct.pack('!BB', 0, 0)  # Version 0, Opcode 0

        # Send request
        self.sock.sendto(request, (self.gateway_ip, self.gateway_port))

        try:
            # Receive response
            response, addr = self.sock.recvfrom(1024)

            # Parse response
            if len(response) &lt; 12:
                raise Exception("Invalid response length")

            version, opcode, result_code, epoch, ext_ip = \
                struct.unpack('!BBHII', response)

            if result_code != 0:
                raise Exception(f"Error: result code {result_code}")

            # Convert IP to string
            external_ip = socket.inet_ntoa(struct.pack('!I', ext_ip))

            return (external_ip, epoch)

        except socket.timeout:
            raise Exception("Request timeout - NAT-PMP not supported?")

    def add_port_mapping(self, internal_port, external_port=0,
                        protocol='tcp', lifetime=3600):
        """
        Add a port mapping.

        Args:
            internal_port: Port on local machine
            external_port: Desired external port (0 = any)
            protocol: 'tcp' or 'udp'
            lifetime: Mapping duration in seconds (0 = delete)

        Returns:
            (mapped_external_port, actual_lifetime, epoch)
        """
        # Build request
        opcode = 1 if protocol == 'udp' else 2
        request = struct.pack(
            '!BBHHHI',
            0,              # Version
            opcode,         # 1=UDP, 2=TCP
            0,              # Reserved
            internal_port,
            external_port,
            lifetime
        )

        # Send request
        self.sock.sendto(request, (self.gateway_ip, self.gateway_port))

        try:
            # Receive response
            response, addr = self.sock.recvfrom(1024)

            # Parse response
            if len(response) &lt; 16:
                raise Exception("Invalid response length")

            version, resp_opcode, result_code, epoch, \
                int_port, ext_port, actual_lifetime = \
                struct.unpack('!BBHIHHI', response)

            if result_code != 0:
                raise Exception(f"Error: result code {result_code}")

            return (ext_port, actual_lifetime, epoch)

        except socket.timeout:
            raise Exception("Request timeout")

    def delete_port_mapping(self, internal_port, protocol='tcp'):
        """Delete a port mapping by setting lifetime to 0."""
        return self.add_port_mapping(
            internal_port,
            external_port=0,
            protocol=protocol,
            lifetime=0
        )

    def close(self):
        self.sock.close()


# Usage example
if __name__ == '__main__':
    # Get gateway from system
    import netifaces
    gws = netifaces.gateways()
    gateway = gws['default'][netifaces.AF_INET][0]

    print(f"Using gateway: {gateway}")

    client = NATPMPClient(gateway)

    try:
        # Get external IP
        external_ip, epoch = client.get_external_ip()
        print(f"External IP: {external_ip}")
        print(f"Gateway uptime: {epoch} seconds")

        # Add port mapping
        print("\nCreating port mapping...")
        external_port, lifetime, epoch = client.add_port_mapping(
            internal_port=8080,
            external_port=8080,  # Prefer 8080
            protocol='tcp',
            lifetime=3600  # 1 hour
        )

        print(f"Mapping created:")
        print(f"  Internal: localhost:8080")
        print(f"  External: {external_ip}:{external_port}")
        print(f"  Lifetime: {lifetime} seconds")

        # Keep mapping alive
        print("\nMapping active. Press Ctrl+C to delete...")
        try:
            last_epoch = epoch
            while True:
                time.sleep(1800)  # Renew every 30 minutes

                # Renew mapping
                external_port, lifetime, epoch = client.add_port_mapping(
                    internal_port=8080,
                    protocol='tcp',
                    lifetime=3600
                )

                # Check for gateway reboot
                if epoch &lt; last_epoch:
                    print("Warning: Gateway rebooted! Mapping recreated.")

                last_epoch = epoch
                print(f"Mapping renewed: {lifetime}s remaining")

        except KeyboardInterrupt:
            pass

        # Delete mapping
        print("\nDeleting mapping...")
        client.delete_port_mapping(8080, 'tcp')
        print("Mapping deleted")

    except Exception as e:
        print(f"Error: {e}")

    finally:
        client.close()
</code></pre>
<h3 id="javascriptnodejs-example"><a class="header" href="#javascriptnodejs-example">JavaScript/Node.js Example</a></h3>
<pre><code class="language-javascript">const dgram = require('dgram');

class NATPMPClient {
  constructor(gatewayIP) {
    this.gatewayIP = gatewayIP;
    this.gatewayPort = 5351;
    this.socket = dgram.createSocket('udp4');
  }

  getExternalIP() {
    return new Promise((resolve, reject) =&gt; {
      // Build request
      const request = Buffer.alloc(2);
      request.writeUInt8(0, 0);  // Version
      request.writeUInt8(0, 1);  // Opcode

      const timeout = setTimeout(() =&gt; {
        reject(new Error('Request timeout'));
      }, 3000);

      this.socket.once('message', (response) =&gt; {
        clearTimeout(timeout);

        try {
          const version = response.readUInt8(0);
          const opcode = response.readUInt8(1);
          const resultCode = response.readUInt16BE(2);

          if (resultCode !== 0) {
            throw new Error(`Error: result code ${resultCode}`);
          }

          const epoch = response.readUInt32BE(4);
          const ipBytes = [
            response.readUInt8(8),
            response.readUInt8(9),
            response.readUInt8(10),
            response.readUInt8(11)
          ];
          const externalIP = ipBytes.join('.');

          resolve({ externalIP, epoch });
        } catch (error) {
          reject(error);
        }
      });

      this.socket.send(request, this.gatewayPort, this.gatewayIP);
    });
  }

  addPortMapping(internalPort, externalPort = 0, protocol = 'tcp', lifetime = 3600) {
    return new Promise((resolve, reject) =&gt; {
      // Build request
      const request = Buffer.alloc(12);
      request.writeUInt8(0, 0);  // Version
      request.writeUInt8(protocol === 'udp' ? 1 : 2, 1);  // Opcode
      request.writeUInt16BE(0, 2);  // Reserved
      request.writeUInt16BE(internalPort, 4);
      request.writeUInt16BE(externalPort, 6);
      request.writeUInt32BE(lifetime, 8);

      const timeout = setTimeout(() =&gt; {
        reject(new Error('Request timeout'));
      }, 3000);

      this.socket.once('message', (response) =&gt; {
        clearTimeout(timeout);

        try {
          const resultCode = response.readUInt16BE(2);

          if (resultCode !== 0) {
            throw new Error(`Error: result code ${resultCode}`);
          }

          const epoch = response.readUInt32BE(4);
          const mappedPort = response.readUInt16BE(10);
          const actualLifetime = response.readUInt32BE(12);

          resolve({
            externalPort: mappedPort,
            lifetime: actualLifetime,
            epoch
          });
        } catch (error) {
          reject(error);
        }
      });

      this.socket.send(request, this.gatewayPort, this.gatewayIP);
    });
  }

  deletePortMapping(internalPort, protocol = 'tcp') {
    return this.addPortMapping(internalPort, 0, protocol, 0);
  }

  close() {
    this.socket.close();
  }
}

// Usage
const os = require('os');

function getDefaultGateway() {
  // Simple gateway detection (platform-specific)
  const interfaces = os.networkInterfaces();
  // This is simplified - use proper gateway detection in production
  return '192.168.1.1';
}

const gateway = getDefaultGateway();
const client = new NATPMPClient(gateway);

async function main() {
  try {
    // Get external IP
    const { externalIP, epoch } = await client.getExternalIP();
    console.log(`External IP: ${externalIP}`);
    console.log(`Gateway uptime: ${epoch}s`);

    // Add port mapping
    const mapping = await client.addPortMapping(8080, 8080, 'tcp', 3600);
    console.log('Mapping created:');
    console.log(`  External: ${externalIP}:${mapping.externalPort}`);
    console.log(`  Lifetime: ${mapping.lifetime}s`);

    // Renew periodically
    setInterval(async () =&gt; {
      const renewed = await client.addPortMapping(8080, 8080, 'tcp', 3600);
      console.log(`Mapping renewed: ${renewed.lifetime}s`);
    }, 30 * 60 * 1000);  // Every 30 minutes

  } catch (error) {
    console.error('Error:', error.message);
  }
}

main();
</code></pre>
<h2 id="mapping-lifetime-management"><a class="header" href="#mapping-lifetime-management">Mapping Lifetime Management</a></h2>
<h3 id="recommended-practices"><a class="header" href="#recommended-practices">Recommended Practices</a></h3>
<pre><code>1. Initial Lifetime
   - Request 3600 seconds (1 hour)
   - Gateway may grant less
   - Never request &gt; 1 day

2. Renewal Strategy
   - Renew at 50% of lifetime
   - If lifetime is 3600s, renew at 1800s
   - Provides safety margin

3. Exponential Backoff
   - If renewal fails, retry with backoff
   - 1s, 2s, 4s, 8s, 16s, 32s
   - Eventually recreate mapping

4. Epoch Monitoring
   - Check epoch in each response
   - If epoch &lt; last_epoch: gateway rebooted
   - Recreate all mappings

5. Cleanup
   - Always delete mappings when done
   - Set lifetime=0 to delete
   - Graceful shutdown
</code></pre>
<h3 id="example-lifetime-management"><a class="header" href="#example-lifetime-management">Example: Lifetime Management</a></h3>
<pre><code class="language-python">class MappingManager:
    def __init__(self, client, internal_port, protocol='tcp'):
        self.client = client
        self.internal_port = internal_port
        self.protocol = protocol
        self.external_port = None
        self.lifetime = None
        self.last_epoch = None
        self.running = False

    def start(self):
        """Create and maintain mapping."""
        self.running = True

        # Create initial mapping
        self._create_mapping()

        # Renewal loop
        while self.running:
            # Sleep for half of lifetime
            sleep_time = self.lifetime / 2
            time.sleep(sleep_time)

            if not self.running:
                break

            try:
                # Renew mapping
                ext_port, lifetime, epoch = self.client.add_port_mapping(
                    self.internal_port,
                    self.external_port,  # Request same port
                    self.protocol,
                    3600
                )

                # Check for gateway reboot
                if epoch &lt; self.last_epoch:
                    print("Gateway rebooted - mapping recreated")

                self.external_port = ext_port
                self.lifetime = lifetime
                self.last_epoch = epoch

                print(f"Mapping renewed: {lifetime}s")

            except Exception as e:
                print(f"Renewal failed: {e}")
                # Retry with backoff
                self._retry_with_backoff()

    def _create_mapping(self):
        """Create initial mapping."""
        ext_port, lifetime, epoch = self.client.add_port_mapping(
            self.internal_port,
            0,  # Any port
            self.protocol,
            3600
        )

        self.external_port = ext_port
        self.lifetime = lifetime
        self.last_epoch = epoch

        print(f"Mapping created: :{ext_port} -&gt; localhost:{self.internal_port}")

    def _retry_with_backoff(self):
        """Retry with exponential backoff."""
        delays = [1, 2, 4, 8, 16, 32]

        for delay in delays:
            time.sleep(delay)
            try:
                self._create_mapping()
                return
            except Exception as e:
                print(f"Retry failed: {e}")

        print("All retries failed")
        self.running = False

    def stop(self):
        """Stop and delete mapping."""
        self.running = False

        try:
            self.client.delete_port_mapping(self.internal_port, self.protocol)
            print("Mapping deleted")
        except Exception as e:
            print(f"Failed to delete mapping: {e}")


# Usage
client = NATPMPClient(gateway)
manager = MappingManager(client, 8080, 'tcp')

# Start in background thread
import threading
thread = threading.Thread(target=manager.start)
thread.start()

# Application runs...

# Cleanup on exit
manager.stop()
thread.join()
client.close()
</code></pre>
<h2 id="security-considerations-6"><a class="header" href="#security-considerations-6">Security Considerations</a></h2>
<pre><code>Threats:

1. Unauthorized Mappings
   - Malware can open ports
   - No authentication in protocol
   - Mitigation: Monitor gateway logs

2. Resource Exhaustion
   - Many mappings consume gateway resources
   - DoS via mapping requests
   - Mitigation: Gateway enforces limits

3. Information Disclosure
   - External IP revealed
   - Internal topology visible
   - Mitigation: Minimal, inherent to NAT

4. Spoofing
   - Off-path attacker sends fake responses
   - Mitigation: Check source IP/port

Best Practices:

1. Only request needed mappings
2. Use shortest lifetime necessary
3. Delete mappings when done
4. Monitor for unexpected mappings
5. Validate response source
6. Handle errors gracefully
</code></pre>
<h2 id="troubleshooting-23"><a class="header" href="#troubleshooting-23">Troubleshooting</a></h2>
<pre><code class="language-bash"># Test if gateway supports NAT-PMP
nc -u 192.168.1.1 5351

# Send external IP request (hex)
echo -n "\x00\x00" | nc -u 192.168.1.1 5351

# Expected response (hex):
# 00 80 00 00 SSSS SSSS EE EE EE EE
# 00: Version
# 80: Opcode (128 = external IP response)
# 00 00: Result (success)
# SSSS SSSS: Epoch seconds
# EE EE EE EE: External IP

# tcpdump NAT-PMP traffic
sudo tcpdump -i any -n udp port 5351 -X

# Check if gateway has NAT-PMP enabled
# Router admin interface → Port Forwarding → NAT-PMP

# Common issues:
# - Gateway doesn't support NAT-PMP
# - NAT-PMP disabled in gateway
# - Firewall blocks UDP 5351
# - Wrong gateway address
# - Gateway behind another NAT

# Test with real client
pip install nat-pmp
natpmpc -g 192.168.1.1 -a 8080 8080 tcp 3600
</code></pre>
<h2 id="comparison-with-other-protocols"><a class="header" href="#comparison-with-other-protocols">Comparison with Other Protocols</a></h2>
<h3 id="nat-pmp-vs-pcp"><a class="header" href="#nat-pmp-vs-pcp">NAT-PMP vs PCP</a></h3>
<pre><code>NAT-PMP:
+ Simple, easy to implement
+ Low overhead (12-16 bytes)
+ Widely supported (Apple devices)
+ Battle-tested (since 2005)
- IPv4 only
- Single NAT only
- Limited features

PCP:
+ IPv4 and IPv6
+ Multiple NATs
+ More features (PEER, filters)
+ Modern design
- More complex
- Less deployed
- Larger packets

Migration Path:
- PCP designed as NAT-PMP successor
- PCP port (5351) intentionally same
- Clients can try both
</code></pre>
<h3 id="feature-comparison"><a class="header" href="#feature-comparison">Feature Comparison</a></h3>
<pre><code>Feature                  NAT-PMP    PCP       UPnP-IGD
Packet Size              12-16B     24+B      KB+
Round Trips              1          1         Multiple
IPv6                     No         Yes       Partial
Lifetime Management      Yes        Yes       No
Third-party Mapping      No         Yes       No
Firewall Control         No         Yes       No
Authentication           No         No        No
Complexity               Low        Medium    High
Apple Support            Native     Native    Emulated
Linux Support            Good       Good      Good
</code></pre>
<h2 id="common-use-cases-8"><a class="header" href="#common-use-cases-8">Common Use Cases</a></h2>
<h3 id="1-bittorrent-client"><a class="header" href="#1-bittorrent-client">1. BitTorrent Client</a></h3>
<pre><code class="language-python"># BitTorrent client
client = NATPMPClient(gateway)

# Map port for incoming connections
port = 6881
ext_port, lifetime, _ = client.add_port_mapping(
    internal_port=port,
    external_port=port,
    protocol='tcp',
    lifetime=7200  # 2 hours
)

print(f"Listening on port {ext_port}")

# Announce to tracker with external port
announce_to_tracker(ext_port)

# Maintain mapping while downloading
while downloading:
    time.sleep(3600)
    client.add_port_mapping(port, protocol='tcp', lifetime=7200)

# Cleanup
client.delete_port_mapping(port, 'tcp')
</code></pre>
<h3 id="2-voip-application"><a class="header" href="#2-voip-application">2. VoIP Application</a></h3>
<pre><code class="language-python"># VoIP client
client = NATPMPClient(gateway)

# Map SIP and RTP ports
sip_port = 5060
rtp_port = 16384

# SIP (TCP)
sip_ext, _, _ = client.add_port_mapping(
    sip_port, sip_port, 'tcp', 3600
)

# RTP (UDP)
rtp_ext, _, _ = client.add_port_mapping(
    rtp_port, rtp_port, 'udp', 3600
)

# Register with external address
external_ip, _ = client.get_external_ip()
register_with_server(external_ip, sip_ext, rtp_ext)
</code></pre>
<h3 id="3-game-server"><a class="header" href="#3-game-server">3. Game Server</a></h3>
<pre><code class="language-python"># Game server
client = NATPMPClient(gateway)

# Map game port
game_port = 27015
ext_port, lifetime, _ = client.add_port_mapping(
    game_port, game_port, 'udp', 7200
)

external_ip, _ = client.get_external_ip()

# Advertise server
advertise_server(f"{external_ip}:{ext_port}")

print(f"Server accessible at {external_ip}:{ext_port}")
</code></pre>
<h2 id="eli10-nat-pmp-explained-simply"><a class="header" href="#eli10-nat-pmp-explained-simply">ELI10: NAT-PMP Explained Simply</a></h2>
<p>NAT-PMP is like asking your house to automatically open a window:</p>
<h3 id="without-nat-pmp"><a class="header" href="#without-nat-pmp">Without NAT-PMP</a></h3>
<pre><code>You: Want friend to visit
Problem: Door is locked
Solution: Ask parent to unlock door manually
Issue: Parent must remember, manual work
</code></pre>
<h3 id="with-nat-pmp"><a class="header" href="#with-nat-pmp">With NAT-PMP</a></h3>
<pre><code>You: "Please open door for 1 hour"
Smart House: Opens door automatically
Friend: Can enter for 1 hour
Smart House: Locks door after 1 hour

Automatic + Safe!
</code></pre>
<h3 id="in-computer-terms"><a class="header" href="#in-computer-terms">In Computer Terms</a></h3>
<pre><code>Your App: "Need port 8080 open for 1 hour"
Router: Opens port 8080 automatically
Internet: Can now reach your app on port 8080
Router: Closes port after 1 hour

Benefits:
- No manual configuration
- Automatic cleanup
- Time-limited (secure)
- Application controls it
</code></pre>
<h2 id="further-resources-36"><a class="header" href="#further-resources-36">Further Resources</a></h2>
<h3 id="specifications-2"><a class="header" href="#specifications-2">Specifications</a></h3>
<ul>
<li><a href="https://tools.ietf.org/html/rfc6886">RFC 6886 - NAT-PMP</a></li>
<li><a href="https://tools.ietf.org/html/rfc6887">RFC 6887 - PCP</a> (Successor)</li>
</ul>
<h3 id="implementations-1"><a class="header" href="#implementations-1">Implementations</a></h3>
<ul>
<li><a href="https://github.com/miniupnp/libnatpmp">libnatpmp</a> - C library</li>
<li><a href="https://pypi.org/project/nat-pmp/">nat-pmp</a> - Python</li>
<li><a href="https://www.npmjs.com/package/nat-upnp">nat-upnp</a> - Node.js</li>
</ul>
<h3 id="tools-12"><a class="header" href="#tools-12">Tools</a></h3>
<ul>
<li>natpmpc - Command-line client</li>
<li><a href="https://en.wikipedia.org/wiki/NAT_Port_Mapping_Protocol">NAT Port Mapping Protocol</a></li>
</ul>
<h3 id="apple-documentation"><a class="header" href="#apple-documentation">Apple Documentation</a></h3>
<ul>
<li><a href="https://developer.apple.com/library/archive/qa/qa1458/_index.html">NAT-PMP on macOS</a></li>
<li>Bonjour implementation includes NAT-PMP</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="upnp-universal-plug-and-play-1"><a class="header" href="#upnp-universal-plug-and-play-1">UPnP (Universal Plug and Play)</a></h1>
<h2 id="overview-87"><a class="header" href="#overview-87">Overview</a></h2>
<p>UPnP is a set of networking protocols that enables devices on a network to seamlessly discover each other and establish functional network services for data sharing, communications, and entertainment. It allows devices to automatically configure themselves and announce their presence to other devices.</p>
<h2 id="upnp-components"><a class="header" href="#upnp-components">UPnP Components</a></h2>
<pre><code>1. Discovery (SSDP)
   - Find devices on network
   - Announce presence

2. Description
   - Device capabilities
   - Services offered

3. Control
   - Invoke actions
   - Query state

4. Eventing
   - Subscribe to state changes
   - Receive notifications

5. Presentation
   - Web-based UI
   - Human interaction
</code></pre>
<h2 id="upnp-architecture"><a class="header" href="#upnp-architecture">UPnP Architecture</a></h2>
<pre><code>Control Point (Client)         Device (Server)
       |                            |
       | 1. Discovery (SSDP)        |
       |&lt;--------------------------&gt;|
       |                            |
       | 2. Description (XML)       |
       |---------------------------&gt;|
       |&lt;---------------------------|
       |                            |
       | 3. Control (SOAP)          |
       |---------------------------&gt;|
       |&lt;---------------------------|
       |                            |
       | 4. Eventing (GENA)         |
       |---------------------------&gt;|
       | (Subscribe)                |
       |&lt;---------------------------|
       | (Events)                   |
</code></pre>
<h2 id="ssdp-simple-service-discovery-protocol"><a class="header" href="#ssdp-simple-service-discovery-protocol">SSDP (Simple Service Discovery Protocol)</a></h2>
<h3 id="discovery-process"><a class="header" href="#discovery-process">Discovery Process</a></h3>
<p><strong>Device Announcement:</strong></p>
<pre><code>Device joins network:

NOTIFY * HTTP/1.1
Host: 239.255.255.250:1900
Cache-Control: max-age=1800
Location: http://192.168.1.100:8080/description.xml
NT: upnp:rootdevice
NTS: ssdp:alive
Server: Linux/5.4 UPnP/1.0 MyDevice/1.0
USN: uuid:12345678-1234-1234-1234-123456789abc::upnp:rootdevice

Sent to multicast address 239.255.255.250:1900
Announces device presence
</code></pre>
<p><strong>Device Search (M-SEARCH):</strong></p>
<pre><code>Control point searches for devices:

M-SEARCH * HTTP/1.1
Host: 239.255.255.250:1900
Man: "ssdp:discover"
ST: ssdp:all
MX: 3
(Search for all devices, wait up to 3 seconds)

Multicast to 239.255.255.250:1900
</code></pre>
<p><strong>Device Response:</strong></p>
<pre><code>HTTP/1.1 200 OK
Cache-Control: max-age=1800
Location: http://192.168.1.100:8080/description.xml
Server: Linux/5.4 UPnP/1.0 MyDevice/1.0
ST: upnp:rootdevice
USN: uuid:12345678-1234-1234-1234-123456789abc::upnp:rootdevice

Unicast response back to control point
</code></pre>
<h3 id="ssdp-multicast"><a class="header" href="#ssdp-multicast">SSDP Multicast</a></h3>
<pre><code>IPv4 Address: 239.255.255.250
Port: 1900 (UDP)

All UPnP devices listen on this address
Used for discovery announcements
</code></pre>
<h3 id="search-targets-st"><a class="header" href="#search-targets-st">Search Targets (ST)</a></h3>
<pre><code>ssdp:all                    - All devices and services
upnp:rootdevice             - Root devices only
uuid:&lt;device-uuid&gt;          - Specific device
urn:schemas-upnp-org:device:&lt;deviceType&gt;:&lt;version&gt;
urn:schemas-upnp-org:service:&lt;serviceType&gt;:&lt;version&gt;

Examples:
  ST: urn:schemas-upnp-org:device:MediaRenderer:1
  ST: urn:schemas-upnp-org:service:ContentDirectory:1
</code></pre>
<h2 id="device-description"><a class="header" href="#device-description">Device Description</a></h2>
<h3 id="description-xml"><a class="header" href="#description-xml">Description XML</a></h3>
<pre><code class="language-xml">&lt;?xml version="1.0"?&gt;
&lt;root xmlns="urn:schemas-upnp-org:device-1-0"&gt;
  &lt;specVersion&gt;
    &lt;major&gt;1&lt;/major&gt;
    &lt;minor&gt;0&lt;/minor&gt;
  &lt;/specVersion&gt;
  &lt;device&gt;
    &lt;deviceType&gt;urn:schemas-upnp-org:device:MediaRenderer:1&lt;/deviceType&gt;
    &lt;friendlyName&gt;Living Room TV&lt;/friendlyName&gt;
    &lt;manufacturer&gt;Samsung&lt;/manufacturer&gt;
    &lt;manufacturerURL&gt;http://www.samsung.com&lt;/manufacturerURL&gt;
    &lt;modelDescription&gt;Smart TV&lt;/modelDescription&gt;
    &lt;modelName&gt;UN55TU8000&lt;/modelName&gt;
    &lt;modelNumber&gt;8000&lt;/modelNumber&gt;
    &lt;serialNumber&gt;123456789&lt;/serialNumber&gt;
    &lt;UDN&gt;uuid:12345678-1234-1234-1234-123456789abc&lt;/UDN&gt;
    &lt;presentationURL&gt;http://192.168.1.100:8080/&lt;/presentationURL&gt;

    &lt;serviceList&gt;
      &lt;service&gt;
        &lt;serviceType&gt;urn:schemas-upnp-org:service:AVTransport:1&lt;/serviceType&gt;
        &lt;serviceId&gt;urn:upnp-org:serviceId:AVTransport&lt;/serviceId&gt;
        &lt;SCPDURL&gt;/service/AVTransport/scpd.xml&lt;/SCPDURL&gt;
        &lt;controlURL&gt;/service/AVTransport/control&lt;/controlURL&gt;
        &lt;eventSubURL&gt;/service/AVTransport/event&lt;/eventSubURL&gt;
      &lt;/service&gt;
    &lt;/serviceList&gt;
  &lt;/device&gt;
&lt;/root&gt;
</code></pre>
<h3 id="service-description-scpd"><a class="header" href="#service-description-scpd">Service Description (SCPD)</a></h3>
<pre><code class="language-xml">&lt;?xml version="1.0"?&gt;
&lt;scpd xmlns="urn:schemas-upnp-org:service-1-0"&gt;
  &lt;specVersion&gt;
    &lt;major&gt;1&lt;/major&gt;
    &lt;minor&gt;0&lt;/minor&gt;
  &lt;/specVersion&gt;

  &lt;actionList&gt;
    &lt;action&gt;
      &lt;name&gt;Play&lt;/name&gt;
      &lt;argumentList&gt;
        &lt;argument&gt;
          &lt;name&gt;Speed&lt;/name&gt;
          &lt;direction&gt;in&lt;/direction&gt;
          &lt;relatedStateVariable&gt;TransportPlaySpeed&lt;/relatedStateVariable&gt;
        &lt;/argument&gt;
      &lt;/argumentList&gt;
    &lt;/action&gt;

    &lt;action&gt;
      &lt;name&gt;Stop&lt;/name&gt;
    &lt;/action&gt;
  &lt;/actionList&gt;

  &lt;serviceStateTable&gt;
    &lt;stateVariable sendEvents="yes"&gt;
      &lt;name&gt;TransportState&lt;/name&gt;
      &lt;dataType&gt;string&lt;/dataType&gt;
      &lt;allowedValueList&gt;
        &lt;allowedValue&gt;PLAYING&lt;/allowedValue&gt;
        &lt;allowedValue&gt;STOPPED&lt;/allowedValue&gt;
        &lt;allowedValue&gt;PAUSED_PLAYBACK&lt;/allowedValue&gt;
      &lt;/allowedValueList&gt;
    &lt;/stateVariable&gt;

    &lt;stateVariable sendEvents="no"&gt;
      &lt;name&gt;TransportPlaySpeed&lt;/name&gt;
      &lt;dataType&gt;string&lt;/dataType&gt;
      &lt;defaultValue&gt;1&lt;/defaultValue&gt;
    &lt;/stateVariable&gt;
  &lt;/serviceStateTable&gt;
&lt;/scpd&gt;
</code></pre>
<h2 id="upnp-control-soap"><a class="header" href="#upnp-control-soap">UPnP Control (SOAP)</a></h2>
<h3 id="action-invocation"><a class="header" href="#action-invocation">Action Invocation</a></h3>
<p><strong>Request:</strong></p>
<pre><code class="language-xml">POST /service/AVTransport/control HTTP/1.1
Host: 192.168.1.100:8080
Content-Type: text/xml; charset="utf-8"
SOAPAction: "urn:schemas-upnp-org:service:AVTransport:1#Play"
Content-Length: 299

&lt;?xml version="1.0"?&gt;
&lt;s:Envelope
  xmlns:s="http://schemas.xmlsoap.org/soap/envelope/"
  s:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"&gt;
  &lt;s:Body&gt;
    &lt;u:Play xmlns:u="urn:schemas-upnp-org:service:AVTransport:1"&gt;
      &lt;InstanceID&gt;0&lt;/InstanceID&gt;
      &lt;Speed&gt;1&lt;/Speed&gt;
    &lt;/u:Play&gt;
  &lt;/s:Body&gt;
&lt;/s:Envelope&gt;
</code></pre>
<p><strong>Response:</strong></p>
<pre><code class="language-xml">HTTP/1.1 200 OK
Content-Type: text/xml; charset="utf-8"
Content-Length: 250

&lt;?xml version="1.0"?&gt;
&lt;s:Envelope
  xmlns:s="http://schemas.xmlsoap.org/soap/envelope/"
  s:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"&gt;
  &lt;s:Body&gt;
    &lt;u:PlayResponse xmlns:u="urn:schemas-upnp-org:service:AVTransport:1"&gt;
    &lt;/u:PlayResponse&gt;
  &lt;/s:Body&gt;
&lt;/s:Envelope&gt;
</code></pre>
<h3 id="error-response"><a class="header" href="#error-response">Error Response</a></h3>
<pre><code class="language-xml">HTTP/1.1 500 Internal Server Error
Content-Type: text/xml; charset="utf-8"

&lt;?xml version="1.0"?&gt;
&lt;s:Envelope
  xmlns:s="http://schemas.xmlsoap.org/soap/envelope/"
  s:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"&gt;
  &lt;s:Body&gt;
    &lt;s:Fault&gt;
      &lt;faultcode&gt;s:Client&lt;/faultcode&gt;
      &lt;faultstring&gt;UPnPError&lt;/faultstring&gt;
      &lt;detail&gt;
        &lt;UPnPError xmlns="urn:schemas-upnp-org:control-1-0"&gt;
          &lt;errorCode&gt;701&lt;/errorCode&gt;
          &lt;errorDescription&gt;Transition not available&lt;/errorDescription&gt;
        &lt;/UPnPError&gt;
      &lt;/detail&gt;
    &lt;/s:Fault&gt;
  &lt;/s:Body&gt;
&lt;/s:Envelope&gt;
</code></pre>
<h2 id="upnp-eventing-gena"><a class="header" href="#upnp-eventing-gena">UPnP Eventing (GENA)</a></h2>
<h3 id="subscribe-to-events"><a class="header" href="#subscribe-to-events">Subscribe to Events</a></h3>
<p><strong>Request:</strong></p>
<pre><code>SUBSCRIBE /service/AVTransport/event HTTP/1.1
Host: 192.168.1.100:8080
Callback: &lt;http://192.168.1.50:8888/notify&gt;
NT: upnp:event
Timeout: Second-1800
</code></pre>
<p><strong>Response:</strong></p>
<pre><code>HTTP/1.1 200 OK
SID: uuid:subscription-12345
Timeout: Second-1800
</code></pre>
<h3 id="initial-event-state-snapshot"><a class="header" href="#initial-event-state-snapshot">Initial Event (State Snapshot)</a></h3>
<pre><code class="language-xml">NOTIFY /notify HTTP/1.1
Host: 192.168.1.50:8888
Content-Type: text/xml
NT: upnp:event
NTS: upnp:propchange
SID: uuid:subscription-12345
SEQ: 0

&lt;?xml version="1.0"?&gt;
&lt;e:propertyset xmlns:e="urn:schemas-upnp-org:event-1-0"&gt;
  &lt;e:property&gt;
    &lt;TransportState&gt;STOPPED&lt;/TransportState&gt;
  &lt;/e:property&gt;
  &lt;e:property&gt;
    &lt;CurrentTrack&gt;1&lt;/CurrentTrack&gt;
  &lt;/e:property&gt;
&lt;/e:propertyset&gt;
</code></pre>
<h3 id="subsequent-events"><a class="header" href="#subsequent-events">Subsequent Events</a></h3>
<pre><code class="language-xml">NOTIFY /notify HTTP/1.1
Host: 192.168.1.50:8888
Content-Type: text/xml
NT: upnp:event
NTS: upnp:propchange
SID: uuid:subscription-12345
SEQ: 1

&lt;?xml version="1.0"?&gt;
&lt;e:propertyset xmlns:e="urn:schemas-upnp-org:event-1-0"&gt;
  &lt;e:property&gt;
    &lt;TransportState&gt;PLAYING&lt;/TransportState&gt;
  &lt;/e:property&gt;
&lt;/e:propertyset&gt;
</code></pre>
<h3 id="unsubscribe"><a class="header" href="#unsubscribe">Unsubscribe</a></h3>
<pre><code>UNSUBSCRIBE /service/AVTransport/event HTTP/1.1
Host: 192.168.1.100:8080
SID: uuid:subscription-12345
</code></pre>
<h2 id="upnp-igd-internet-gateway-device"><a class="header" href="#upnp-igd-internet-gateway-device">UPnP IGD (Internet Gateway Device)</a></h2>
<h3 id="port-mapping"><a class="header" href="#port-mapping">Port Mapping</a></h3>
<p>One of the most common UPnP uses:</p>
<p><strong>Add Port Mapping Request:</strong></p>
<pre><code class="language-xml">POST /control/WANIPConnection HTTP/1.1
Host: 192.168.1.1:5000
Content-Type: text/xml; charset="utf-8"
SOAPAction: "urn:schemas-upnp-org:service:WANIPConnection:1#AddPortMapping"

&lt;?xml version="1.0"?&gt;
&lt;s:Envelope ...&gt;
  &lt;s:Body&gt;
    &lt;u:AddPortMapping xmlns:u="urn:schemas-upnp-org:service:WANIPConnection:1"&gt;
      &lt;NewRemoteHost&gt;&lt;/NewRemoteHost&gt;
      &lt;NewExternalPort&gt;8080&lt;/NewExternalPort&gt;
      &lt;NewProtocol&gt;TCP&lt;/NewProtocol&gt;
      &lt;NewInternalPort&gt;8080&lt;/NewInternalPort&gt;
      &lt;NewInternalClient&gt;192.168.1.50&lt;/NewInternalClient&gt;
      &lt;NewEnabled&gt;1&lt;/NewEnabled&gt;
      &lt;NewPortMappingDescription&gt;My Web Server&lt;/NewPortMappingDescription&gt;
      &lt;NewLeaseDuration&gt;0&lt;/NewLeaseDuration&gt;
    &lt;/u:AddPortMapping&gt;
  &lt;/s:Body&gt;
&lt;/s:Envelope&gt;
</code></pre>
<p><strong>Result:</strong></p>
<pre><code>External: &lt;public-ip&gt;:8080
    ↓
Internal: 192.168.1.50:8080

Automatic NAT traversal!
</code></pre>
<h3 id="get-external-ip"><a class="header" href="#get-external-ip">Get External IP</a></h3>
<pre><code class="language-xml">POST /control/WANIPConnection HTTP/1.1
SOAPAction: "urn:schemas-upnp-org:service:WANIPConnection:1#GetExternalIPAddress"

&lt;u:GetExternalIPAddress xmlns:u="urn:schemas-upnp-org:service:WANIPConnection:1"&gt;
&lt;/u:GetExternalIPAddress&gt;
</code></pre>
<p><strong>Response:</strong></p>
<pre><code class="language-xml">&lt;u:GetExternalIPAddressResponse&gt;
  &lt;NewExternalIPAddress&gt;203.0.113.5&lt;/NewExternalIPAddress&gt;
&lt;/u:GetExternalIPAddressResponse&gt;
</code></pre>
<h2 id="common-upnp-device-types"><a class="header" href="#common-upnp-device-types">Common UPnP Device Types</a></h2>
<pre><code>MediaServer              - Content provider (NAS, PC)
MediaRenderer            - Content consumer (TV, speaker)
InternetGatewayDevice    - Router/NAT
WANConnectionDevice      - WAN connection management
PrinterBasic             - Network printer
Scanner                  - Network scanner
HVAC                     - Heating/cooling control
Lighting                 - Smart lights
SecurityDevice           - Cameras, sensors
</code></pre>
<h2 id="upnp-client-implementation"><a class="header" href="#upnp-client-implementation">UPnP Client Implementation</a></h2>
<h3 id="python-example-discovery"><a class="header" href="#python-example-discovery">Python Example (Discovery)</a></h3>
<pre><code class="language-python">import socket

SSDP_ADDR = '239.255.255.250'
SSDP_PORT = 1900

def discover_devices():
    # M-SEARCH message
    message = '\r\n'.join([
        'M-SEARCH * HTTP/1.1',
        f'Host: {SSDP_ADDR}:{SSDP_PORT}',
        'Man: "ssdp:discover"',
        'ST: ssdp:all',
        'MX: 3',
        '',
        ''
    ])

    # Create socket
    sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
    sock.settimeout(5)

    # Send M-SEARCH
    sock.sendto(message.encode(), (SSDP_ADDR, SSDP_PORT))

    # Receive responses
    devices = []
    try:
        while True:
            data, addr = sock.recvfrom(1024)
            response = data.decode()

            # Parse location
            for line in response.split('\r\n'):
                if line.startswith('Location:'):
                    location = line.split(':', 1)[1].strip()
                    devices.append(location)
                    break
    except socket.timeout:
        pass

    sock.close()
    return devices

# Usage
devices = discover_devices()
for device in devices:
    print(f"Found device: {device}")
</code></pre>
<h3 id="python-example-control"><a class="header" href="#python-example-control">Python Example (Control)</a></h3>
<pre><code class="language-python">import requests
import xml.etree.ElementTree as ET

def control_device(control_url, service_type, action, args):
    # Build SOAP envelope
    soap_body = f'''&lt;?xml version="1.0"?&gt;
    &lt;s:Envelope
      xmlns:s="http://schemas.xmlsoap.org/soap/envelope/"
      s:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"&gt;
      &lt;s:Body&gt;
        &lt;u:{action} xmlns:u="{service_type}"&gt;
          {''.join(f'&lt;{k}&gt;{v}&lt;/{k}&gt;' for k, v in args.items())}
        &lt;/u:{action}&gt;
      &lt;/s:Body&gt;
    &lt;/s:Envelope&gt;'''

    headers = {
        'Content-Type': 'text/xml; charset="utf-8"',
        'SOAPAction': f'"{service_type}#{action}"'
    }

    response = requests.post(control_url, data=soap_body, headers=headers)
    return response.text

# Usage
control_url = 'http://192.168.1.100:8080/service/AVTransport/control'
service_type = 'urn:schemas-upnp-org:service:AVTransport:1'
action = 'Play'
args = {'InstanceID': '0', 'Speed': '1'}

result = control_device(control_url, service_type, action, args)
print(result)
</code></pre>
<h2 id="upnp-tools"><a class="header" href="#upnp-tools">UPnP Tools</a></h2>
<h3 id="command-line-tools-1"><a class="header" href="#command-line-tools-1">Command Line Tools</a></h3>
<pre><code class="language-bash"># upnpc (miniupnpc)
# Install: apt-get install miniupnpc

# Discover IGD devices
upnpc -l

# Get external IP
upnpc -s

# Add port mapping
upnpc -a 192.168.1.50 8080 8080 TCP

# List port mappings
upnpc -L

# Delete port mapping
upnpc -d 8080 TCP
</code></pre>
<h3 id="gui-tools"><a class="header" href="#gui-tools">GUI Tools</a></h3>
<pre><code>- UPnP Inspector (Linux)
- UPnP Test Tool (Windows)
- Device Spy (UPnP Forum)
</code></pre>
<h2 id="upnp-security-issues"><a class="header" href="#upnp-security-issues">UPnP Security Issues</a></h2>
<h3 id="major-vulnerabilities"><a class="header" href="#major-vulnerabilities">Major Vulnerabilities</a></h3>
<h4 id="1-no-authentication"><a class="header" href="#1-no-authentication">1. No Authentication</a></h4>
<pre><code>Any device can control any other device
No password required
No encryption

Attack: Malicious app opens ports in router
</code></pre>
<h4 id="2-port-forwarding-abuse"><a class="header" href="#2-port-forwarding-abuse">2. Port Forwarding Abuse</a></h4>
<pre><code>Malware can:
  - Open ports in router
  - Expose internal services
  - Create backdoors

Example:
  Malware opens port 3389 (RDP)
  Attacker can remotely access PC
</code></pre>
<h4 id="3-ssdp-amplification-ddos"><a class="header" href="#3-ssdp-amplification-ddos">3. SSDP Amplification DDoS</a></h4>
<pre><code>Attacker spoofs source IP as victim
Sends M-SEARCH to many UPnP devices
Devices respond to victim
Victim overwhelmed with traffic

Amplification factor: 30x-50x
</code></pre>
<h4 id="4-xml-external-entity-xxe"><a class="header" href="#4-xml-external-entity-xxe">4. XML External Entity (XXE)</a></h4>
<pre><code>Malicious device description:
&lt;!DOCTYPE foo [
  &lt;!ENTITY xxe SYSTEM "file:///etc/passwd"&gt;
]&gt;
&lt;root&gt;&amp;xxe;&lt;/root&gt;

Can read local files
Server-side request forgery
</code></pre>
<h3 id="security-best-practices-9"><a class="header" href="#security-best-practices-9">Security Best Practices</a></h3>
<pre><code>1. Disable UPnP on router
   - If not needed, turn it off
   - Most secure option

2. Use UPnP-UP (UPnP with User Profile)
   - Authentication layer
   - Access control

3. Firewall rules
   - Block SSDP multicast from WAN
   - Limit UPnP to trusted VLANs

4. Whitelist devices
   - Only allow known devices
   - MAC address filtering

5. Monitor port mappings
   - Regular audits
   - Alert on unexpected changes

6. Update firmware
   - Patch vulnerabilities
   - Keep devices current
</code></pre>
<h2 id="upnp-vs-alternatives"><a class="header" href="#upnp-vs-alternatives">UPnP vs Alternatives</a></h2>
<h3 id="vs-manual-port-forwarding"><a class="header" href="#vs-manual-port-forwarding">vs Manual Port Forwarding</a></h3>
<pre><code>UPnP:
  Pros: Automatic, easy
  Cons: Security risk, no control

Manual:
  Pros: Secure, controlled
  Cons: Technical knowledge required
</code></pre>
<h3 id="vs-nat-pmp--pcp"><a class="header" href="#vs-nat-pmp--pcp">vs NAT-PMP / PCP</a></h3>
<pre><code>NAT-PMP (Apple):
  - Similar to UPnP
  - Simpler protocol
  - Better security

PCP (Port Control Protocol):
  - Successor to NAT-PMP
  - IETF standard
  - IPv6 support
</code></pre>
<h3 id="vs-stunturn"><a class="header" href="#vs-stunturn">vs STUN/TURN</a></h3>
<pre><code>UPnP: Local network discovery and control
STUN/TURN: NAT traversal for P2P connections

Different use cases, can complement each other
</code></pre>
<h2 id="eli10-26"><a class="header" href="#eli10-26">ELI10</a></h2>
<p>UPnP is like devices introducing themselves and asking for help:</p>
<p><strong>Discovery (Meeting New Friends):</strong></p>
<pre><code>New TV joins network:
  TV: "Hi everyone! I'm a TV and can play videos!"
  All devices hear the announcement
  Your phone: "Cool, I found a TV!"
</code></pre>
<p><strong>Control (Asking for Favors):</strong></p>
<pre><code>Phone to TV: "Can you play this video?"
TV: "Sure! Playing now."

Gaming console to router: "Can you open port 3478?"
Router: "Done! Port is open."
</code></pre>
<p><strong>Problems (Security Issues):</strong></p>
<pre><code>Bad actor: "Hey router, open all ports!"
Router: "OK!" (No questions asked)
  → This is dangerous!

Better approach:
  Router: "Who are you? Do you have permission?"
  Bad actor: "Uh... never mind."
</code></pre>
<p><strong>When to Use:</strong></p>
<ul>
<li>Home media streaming</li>
<li>Gaming (automatic port opening)</li>
<li>Smart home devices</li>
<li>Printing</li>
</ul>
<p><strong>When to Disable:</strong></p>
<ul>
<li>Public networks</li>
<li>When security is critical</li>
<li>Enterprise environments</li>
<li>If you don't need it</li>
</ul>
<p><strong>Rule of Thumb:</strong></p>
<ul>
<li>Home network: Convenient (but understand risks)</li>
<li>Business network: Usually disable</li>
<li>Gaming: Helpful for matchmaking</li>
<li>Important: Monitor what ports get opened!</li>
</ul>
<h2 id="further-resources-37"><a class="header" href="#further-resources-37">Further Resources</a></h2>
<ul>
<li><a href="https://openconnectivity.org/developer/specifications/upnp-resources">UPnP Forum</a></li>
<li><a href="https://tools.ietf.org/html/rfc6970">RFC 6970 - UPnP IGD-PCP Interworking</a></li>
<li><a href="http://upnp.org/specs/arch/UPnP-arch-DeviceArchitecture-v2.0.pdf">UPnP Device Architecture</a></li>
<li><a href="https://miniupnp.tuxfamily.org/">miniupnpc Library</a></li>
<li><a href="https://www.upnp-hacks.org/">Security Concerns</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="websocket-1"><a class="header" href="#websocket-1">WebSocket</a></h1>
<h2 id="overview-88"><a class="header" href="#overview-88">Overview</a></h2>
<p>WebSocket is a communication protocol that provides full-duplex communication channels over a single TCP connection. It enables real-time, bidirectional communication between a client and server with low overhead, making it ideal for interactive web applications.</p>
<h2 id="key-characteristics-6"><a class="header" href="#key-characteristics-6">Key Characteristics</a></h2>
<pre><code>Protocol: ws:// (unencrypted) or wss:// (encrypted)
Port: 80 (ws) or 443 (wss)
Transport: TCP
Connection: Long-lived, persistent
Communication: Full-duplex (bidirectional)
Latency: Low (no HTTP overhead after handshake)
Overhead: 2-14 bytes per frame
Status: RFC 6455 (2011)

Benefits:
✓ Real-time bidirectional communication
✓ Low latency (no polling overhead)
✓ Efficient (minimal frame overhead)
✓ Server can push data to client
✓ Single TCP connection
✓ Works through proxies and firewalls
✓ Subprotocol support
</code></pre>
<h2 id="websocket-vs-alternatives"><a class="header" href="#websocket-vs-alternatives">WebSocket vs Alternatives</a></h2>
<h3 id="http-polling"><a class="header" href="#http-polling">HTTP Polling</a></h3>
<pre><code>Traditional HTTP Request/Response:

Client                           Server
  |                                |
  |──── HTTP GET (new data?) ─────&gt;|
  |                                |
  |&lt;─── HTTP Response (no) ────────|
  |                                |
  [wait 1 second]
  |                                |
  |──── HTTP GET (new data?) ─────&gt;|
  |                                |
  |&lt;─── HTTP Response (yes!) ──────|
  |                                |

Problems:
- High latency (constant polling)
- Wasted requests (most return nothing)
- Server load (many unnecessary requests)
- HTTP overhead on every request
</code></pre>
<h3 id="long-polling"><a class="header" href="#long-polling">Long Polling</a></h3>
<pre><code>HTTP Long Polling:

Client                           Server
  |                                |
  |──── HTTP GET (wait) ──────────&gt;|
  |                                | [server holds request]
  |                                | [data arrives]
  |&lt;─── HTTP Response (data!) ─────|
  |                                |
  |──── HTTP GET (wait) ──────────&gt;|
  |                                |

Better, but:
- Still HTTP overhead
- Reconnect after each message
- Server must handle many pending connections
- Not truly bidirectional
</code></pre>
<h3 id="server-sent-events-sse"><a class="header" href="#server-sent-events-sse">Server-Sent Events (SSE)</a></h3>
<pre><code>Server-Sent Events:

Client                           Server
  |                                |
  |──── HTTP GET (subscribe) ─────&gt;|
  |                                |
  |&lt;═══ Event stream ══════════════| (one-way)
  |&lt;═══ data: message 1 ═══════════|
  |&lt;═══ data: message 2 ═══════════|
  |&lt;═══ data: message 3 ═══════════|
  |                                |

Good for:
✓ Server → Client only
✓ Text-based data
✓ Auto-reconnect
✓ Simpler than WebSocket

Limited:
✗ One-way only (server to client)
✗ HTTP/1.1 connection limit (6 per domain)
✗ Text only (no binary)
</code></pre>
<h3 id="websocket-2"><a class="header" href="#websocket-2">WebSocket</a></h3>
<pre><code>WebSocket:

Client                           Server
  |                                |
  |──── HTTP Upgrade ─────────────&gt;|
  |&lt;─── 101 Switching Protocols ───|
  |                                |
  |&lt;══════ WebSocket Open ═════════&gt;|
  |                                |
  |──── Message 1 ────────────────&gt;|
  |&lt;─── Message 2 ─────────────────|
  |──── Message 3 ────────────────&gt;|
  |──── Message 4 ────────────────&gt;|
  |&lt;─── Message 5 ─────────────────|
  |                                |

Best for:
✓ Bidirectional communication
✓ Real-time updates
✓ Low latency required
✓ High message frequency
✓ Binary data support
</code></pre>
<h2 id="websocket-protocol"><a class="header" href="#websocket-protocol">WebSocket Protocol</a></h2>
<h3 id="connection-handshake"><a class="header" href="#connection-handshake">Connection Handshake</a></h3>
<p>WebSocket starts with an HTTP upgrade request:</p>
<pre><code class="language-http">Client Request:
GET /chat HTTP/1.1
Host: example.com
Upgrade: websocket
Connection: Upgrade
Sec-WebSocket-Key: dGhlIHNhbXBsZSBub25jZQ==
Sec-WebSocket-Version: 13
Origin: https://example.com

Server Response:
HTTP/1.1 101 Switching Protocols
Upgrade: websocket
Connection: Upgrade
Sec-WebSocket-Accept: s3pPLMBiTxaQ9kYGzzhZRbK+xOo=

Key Fields:

Upgrade: websocket
- Request protocol upgrade from HTTP to WebSocket

Connection: Upgrade
- Indicates connection upgrade needed

Sec-WebSocket-Key: &lt;base64-encoded-random&gt;
- 16-byte random value, base64 encoded
- Prevents caching proxies from confusing requests

Sec-WebSocket-Version: 13
- WebSocket protocol version (13 is current)

Sec-WebSocket-Accept: &lt;computed-hash&gt;
- Server proves it understands WebSocket
- Computed as: base64(SHA-1(Key + magic-string))
- Magic string: 258EAFA5-E914-47DA-95CA-C5AB0DC85B11

Origin: https://example.com
- Browser sends origin for CORS check
- Server can validate allowed origins

After handshake:
- HTTP connection becomes WebSocket connection
- Both sides can send messages anytime
- Connection stays open until explicitly closed
</code></pre>
<h3 id="handshake-validation"><a class="header" href="#handshake-validation">Handshake Validation</a></h3>
<pre><code class="language-javascript">// Server-side validation (conceptual)
const crypto = require('crypto');

function computeAcceptKey(clientKey) {
  const MAGIC = '258EAFA5-E914-47DA-95CA-C5AB0DC85B11';
  const hash = crypto
    .createHash('sha1')
    .update(clientKey + MAGIC)
    .digest('base64');
  return hash;
}

// Example:
const clientKey = 'dGhlIHNhbXBsZSBub25jZQ==';
const acceptKey = computeAcceptKey(clientKey);
console.log(acceptKey);
// Output: s3pPLMBiTxaQ9kYGzzhZRbK+xOo=
</code></pre>
<h3 id="frame-format"><a class="header" href="#frame-format">Frame Format</a></h3>
<p>After handshake, data is sent in frames:</p>
<pre><code>WebSocket Frame Structure:

 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-------+-+-------------+-------------------------------+
|F|R|R|R| opcode|M| Payload len |    Extended payload length    |
|I|S|S|S|  (4)  |A|     (7)     |             (16/64)           |
|N|V|V|V|       |S|             |   (if payload len==126/127)   |
| |1|2|3|       |K|             |                               |
+-+-+-+-+-------+-+-------------+ - - - - - - - - - - - - - - - +
|     Extended payload length continued, if payload len == 127  |
+ - - - - - - - - - - - - - - - +-------------------------------+
|                               | Masking-key, if MASK set to 1 |
+-------------------------------+-------------------------------+
| Masking-key (continued)       |          Payload Data         |
+-------------------------------- - - - - - - - - - - - - - - - +
:                     Payload Data continued ...                :
+ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +
|                     Payload Data continued ...                |
+---------------------------------------------------------------+

Fields:

FIN (1 bit):
- 1 = final fragment
- 0 = more fragments coming

RSV1, RSV2, RSV3 (3 bits):
- Reserved for extensions
- Must be 0 unless extension negotiated

Opcode (4 bits):
- 0x0 = Continuation frame
- 0x1 = Text frame (UTF-8)
- 0x2 = Binary frame
- 0x8 = Connection close
- 0x9 = Ping
- 0xA = Pong

MASK (1 bit):
- 1 = payload is masked (required for client → server)
- 0 = payload not masked (server → client)

Payload Length (7 bits, or 7+16, or 7+64):
- 0-125: actual length
- 126: next 16 bits contain length
- 127: next 64 bits contain length

Masking Key (32 bits):
- Present if MASK = 1
- Random 4-byte key
- Client must mask all frames to server

Payload Data:
- Actual message data
- If masked, XOR with masking key

Minimum Frame Size:
- 2 bytes (no masking, payload ≤ 125 bytes)
- 6 bytes (with masking, payload ≤ 125 bytes)
</code></pre>
<h3 id="message-types-2"><a class="header" href="#message-types-2">Message Types</a></h3>
<pre><code>Text Frame (Opcode 0x1):
- UTF-8 encoded text
- Most common for JSON, strings

Binary Frame (Opcode 0x2):
- Raw binary data
- Images, files, protocol buffers

Ping Frame (Opcode 0x9):
- Sent by either side
- Keep connection alive
- Check if peer responsive

Pong Frame (Opcode 0xA):
- Response to ping
- Sent automatically
- Contains same data as ping

Close Frame (Opcode 0x8):
- Initiates connection close
- Contains optional close code and reason
- Peer responds with close frame
</code></pre>
<h2 id="client-side-implementation-1"><a class="header" href="#client-side-implementation-1">Client-Side Implementation</a></h2>
<h3 id="javascript-browser"><a class="header" href="#javascript-browser">JavaScript (Browser)</a></h3>
<pre><code class="language-javascript">// Create WebSocket connection
const socket = new WebSocket('ws://localhost:8080');

// Alternative: secure WebSocket
// const socket = new WebSocket('wss://example.com/socket');

// Connection opened
socket.addEventListener('open', (event) =&gt; {
  console.log('Connected to server');

  // Send message
  socket.send('Hello Server!');

  // Send JSON
  socket.send(JSON.stringify({
    type: 'chat',
    message: 'Hello!',
    timestamp: Date.now()
  }));

  // Send binary data
  const buffer = new Uint8Array([1, 2, 3, 4]);
  socket.send(buffer);
});

// Receive message
socket.addEventListener('message', (event) =&gt; {
  console.log('Message from server:', event.data);

  // Handle text data
  if (typeof event.data === 'string') {
    try {
      const data = JSON.parse(event.data);
      handleMessage(data);
    } catch (e) {
      console.log('Text:', event.data);
    }
  }

  // Handle binary data
  if (event.data instanceof Blob) {
    event.data.arrayBuffer().then(buffer =&gt; {
      const view = new Uint8Array(buffer);
      console.log('Binary data:', view);
    });
  }

  // Or receive as ArrayBuffer
  // socket.binaryType = 'arraybuffer';
});

// Connection closed
socket.addEventListener('close', (event) =&gt; {
  console.log('Disconnected from server');
  console.log('Code:', event.code);
  console.log('Reason:', event.reason);
  console.log('Clean:', event.wasClean);
});

// Connection error
socket.addEventListener('error', (error) =&gt; {
  console.error('WebSocket error:', error);
});

// Send messages
function sendMessage(text) {
  if (socket.readyState === WebSocket.OPEN) {
    socket.send(text);
  } else {
    console.error('WebSocket not connected');
  }
}

// Close connection
function closeConnection() {
  socket.close(1000, 'User closed connection');
}

// WebSocket states
console.log('CONNECTING:', WebSocket.CONNECTING); // 0
console.log('OPEN:', WebSocket.OPEN);             // 1
console.log('CLOSING:', WebSocket.CLOSING);       // 2
console.log('CLOSED:', WebSocket.CLOSED);         // 3

// Check current state
console.log('Current state:', socket.readyState);
</code></pre>
<h3 id="advanced-client-features"><a class="header" href="#advanced-client-features">Advanced Client Features</a></h3>
<pre><code class="language-javascript">class WebSocketClient {
  constructor(url, options = {}) {
    this.url = url;
    this.options = {
      reconnect: true,
      reconnectInterval: 1000,
      reconnectDecay: 1.5,
      maxReconnectInterval: 30000,
      maxReconnectAttempts: 10,
      ...options
    };

    this.ws = null;
    this.reconnectAttempts = 0;
    this.messageQueue = [];
    this.handlers = new Map();

    this.connect();
  }

  connect() {
    this.ws = new WebSocket(this.url);

    this.ws.onopen = () =&gt; {
      console.log('Connected');
      this.reconnectAttempts = 0;

      // Send queued messages
      while (this.messageQueue.length &gt; 0) {
        this.send(this.messageQueue.shift());
      }

      this.emit('connect');
    };

    this.ws.onmessage = (event) =&gt; {
      try {
        const data = JSON.parse(event.data);
        this.emit(data.type || 'message', data);
      } catch (e) {
        this.emit('message', event.data);
      }
    };

    this.ws.onclose = (event) =&gt; {
      console.log('Disconnected:', event.code, event.reason);
      this.emit('disconnect', event);

      if (this.options.reconnect) {
        this.reconnect();
      }
    };

    this.ws.onerror = (error) =&gt; {
      console.error('WebSocket error:', error);
      this.emit('error', error);
    };
  }

  reconnect() {
    if (this.reconnectAttempts &gt;= this.options.maxReconnectAttempts) {
      console.error('Max reconnect attempts reached');
      this.emit('reconnect_failed');
      return;
    }

    this.reconnectAttempts++;
    const delay = Math.min(
      this.options.reconnectInterval *
        Math.pow(this.options.reconnectDecay, this.reconnectAttempts - 1),
      this.options.maxReconnectInterval
    );

    console.log(`Reconnecting in ${delay}ms (attempt ${this.reconnectAttempts})`);

    setTimeout(() =&gt; {
      this.emit('reconnecting', this.reconnectAttempts);
      this.connect();
    }, delay);
  }

  send(data) {
    if (this.ws.readyState === WebSocket.OPEN) {
      const message = typeof data === 'string'
        ? data
        : JSON.stringify(data);
      this.ws.send(message);
    } else {
      console.log('Queueing message (not connected)');
      this.messageQueue.push(data);
    }
  }

  on(event, handler) {
    if (!this.handlers.has(event)) {
      this.handlers.set(event, []);
    }
    this.handlers.get(event).push(handler);
  }

  emit(event, data) {
    if (this.handlers.has(event)) {
      this.handlers.get(event).forEach(handler =&gt; handler(data));
    }
  }

  close() {
    this.options.reconnect = false;
    if (this.ws) {
      this.ws.close(1000, 'Client closed');
    }
  }
}

// Usage
const client = new WebSocketClient('ws://localhost:8080', {
  reconnect: true,
  maxReconnectAttempts: 5
});

client.on('connect', () =&gt; {
  console.log('Connected!');
  client.send({ type: 'auth', token: 'abc123' });
});

client.on('message', (data) =&gt; {
  console.log('Received:', data);
});

client.on('disconnect', () =&gt; {
  console.log('Connection lost');
});

client.send({ type: 'chat', message: 'Hello' });
</code></pre>
<h2 id="server-side-implementation"><a class="header" href="#server-side-implementation">Server-Side Implementation</a></h2>
<h3 id="nodejs-with-ws-library"><a class="header" href="#nodejs-with-ws-library">Node.js with 'ws' Library</a></h3>
<pre><code class="language-javascript">const WebSocket = require('ws');
const http = require('http');

// Create HTTP server
const server = http.createServer((req, res) =&gt; {
  res.writeHead(200);
  res.end('WebSocket server running');
});

// Create WebSocket server
const wss = new WebSocket.Server({ server });

// Track connected clients
const clients = new Set();

// Connection handler
wss.on('connection', (ws, req) =&gt; {
  console.log('Client connected from', req.socket.remoteAddress);

  // Add to client set
  clients.add(ws);

  // Send welcome message
  ws.send(JSON.stringify({
    type: 'welcome',
    message: 'Connected to server',
    clients: clients.size
  }));

  // Broadcast new connection to all clients
  broadcast({
    type: 'user-joined',
    clients: clients.size
  }, ws);

  // Message handler
  ws.on('message', (data) =&gt; {
    console.log('Received:', data.toString());

    try {
      const message = JSON.parse(data);

      // Handle different message types
      switch (message.type) {
        case 'chat':
          // Broadcast chat message
          broadcast({
            type: 'chat',
            message: message.message,
            timestamp: Date.now()
          });
          break;

        case 'ping':
          // Respond to ping
          ws.send(JSON.stringify({
            type: 'pong',
            timestamp: Date.now()
          }));
          break;

        default:
          console.log('Unknown message type:', message.type);
      }
    } catch (e) {
      console.error('Invalid JSON:', e);
    }
  });

  // Pong handler (heartbeat)
  ws.on('pong', () =&gt; {
    ws.isAlive = true;
  });

  // Close handler
  ws.on('close', (code, reason) =&gt; {
    console.log('Client disconnected:', code, reason.toString());
    clients.delete(ws);

    // Notify others
    broadcast({
      type: 'user-left',
      clients: clients.size
    });
  });

  // Error handler
  ws.on('error', (error) =&gt; {
    console.error('WebSocket error:', error);
  });

  // Mark as alive for heartbeat
  ws.isAlive = true;
});

// Broadcast to all clients
function broadcast(data, exclude = null) {
  const message = JSON.stringify(data);

  clients.forEach(client =&gt; {
    if (client !== exclude &amp;&amp; client.readyState === WebSocket.OPEN) {
      client.send(message);
    }
  });
}

// Heartbeat (detect dead connections)
const heartbeatInterval = setInterval(() =&gt; {
  clients.forEach(ws =&gt; {
    if (!ws.isAlive) {
      console.log('Terminating dead connection');
      ws.terminate();
      clients.delete(ws);
      return;
    }

    ws.isAlive = false;
    ws.ping();
  });
}, 30000); // Every 30 seconds

// Cleanup on server close
wss.on('close', () =&gt; {
  clearInterval(heartbeatInterval);
});

// Start server
const PORT = 8080;
server.listen(PORT, () =&gt; {
  console.log(`WebSocket server listening on port ${PORT}`);
});
</code></pre>
<h3 id="advanced-server-features"><a class="header" href="#advanced-server-features">Advanced Server Features</a></h3>
<pre><code class="language-javascript">const WebSocket = require('ws');
const http = require('http');
const url = require('url');

class WebSocketServer {
  constructor(options = {}) {
    this.options = {
      port: 8080,
      pingInterval: 30000,
      maxClients: 1000,
      ...options
    };

    this.server = http.createServer();
    this.wss = new WebSocket.Server({ server: this.server });

    this.rooms = new Map(); // roomId -&gt; Set of clients
    this.clients = new Map(); // ws -&gt; client info

    this.setupHandlers();
    this.startHeartbeat();
  }

  setupHandlers() {
    this.wss.on('connection', (ws, req) =&gt; {
      // Check max clients
      if (this.clients.size &gt;= this.options.maxClients) {
        ws.close(1008, 'Server full');
        return;
      }

      // Parse URL parameters
      const params = url.parse(req.url, true).query;

      // Create client info
      const clientInfo = {
        id: this.generateId(),
        ip: req.socket.remoteAddress,
        rooms: new Set(),
        authenticated: false,
        metadata: {}
      };

      this.clients.set(ws, clientInfo);
      ws.isAlive = true;

      console.log(`Client ${clientInfo.id} connected`);

      // Send client ID
      this.send(ws, {
        type: 'connected',
        clientId: clientInfo.id
      });

      // Message handler
      ws.on('message', (data) =&gt; {
        this.handleMessage(ws, data);
      });

      // Pong handler
      ws.on('pong', () =&gt; {
        ws.isAlive = true;
      });

      // Close handler
      ws.on('close', () =&gt; {
        this.handleDisconnect(ws);
      });

      // Error handler
      ws.on('error', (error) =&gt; {
        console.error('Error:', error);
      });
    });
  }

  handleMessage(ws, data) {
    const client = this.clients.get(ws);
    if (!client) return;

    try {
      const message = JSON.parse(data);

      switch (message.type) {
        case 'auth':
          this.handleAuth(ws, message);
          break;

        case 'join-room':
          this.joinRoom(ws, message.room);
          break;

        case 'leave-room':
          this.leaveRoom(ws, message.room);
          break;

        case 'message':
          this.handleRoomMessage(ws, message);
          break;

        default:
          console.log('Unknown message type:', message.type);
      }
    } catch (e) {
      console.error('Invalid message:', e);
      this.send(ws, {
        type: 'error',
        message: 'Invalid message format'
      });
    }
  }

  handleAuth(ws, message) {
    const client = this.clients.get(ws);

    // Validate token (simplified)
    if (message.token === 'valid-token') {
      client.authenticated = true;
      client.metadata.username = message.username;

      this.send(ws, {
        type: 'auth-success',
        username: message.username
      });
    } else {
      this.send(ws, {
        type: 'auth-failed',
        message: 'Invalid token'
      });

      ws.close(1008, 'Authentication failed');
    }
  }

  joinRoom(ws, roomId) {
    const client = this.clients.get(ws);
    if (!client?.authenticated) return;

    // Create room if doesn't exist
    if (!this.rooms.has(roomId)) {
      this.rooms.set(roomId, new Set());
    }

    // Add client to room
    this.rooms.get(roomId).add(ws);
    client.rooms.add(roomId);

    console.log(`Client ${client.id} joined room ${roomId}`);

    // Notify client
    this.send(ws, {
      type: 'joined-room',
      room: roomId,
      members: this.rooms.get(roomId).size
    });

    // Notify room members
    this.broadcastToRoom(roomId, {
      type: 'user-joined',
      userId: client.id,
      username: client.metadata.username,
      members: this.rooms.get(roomId).size
    }, ws);
  }

  leaveRoom(ws, roomId) {
    const client = this.clients.get(ws);
    if (!client) return;

    if (this.rooms.has(roomId)) {
      this.rooms.get(roomId).delete(ws);
      client.rooms.delete(roomId);

      // Notify others
      this.broadcastToRoom(roomId, {
        type: 'user-left',
        userId: client.id,
        members: this.rooms.get(roomId).size
      });

      // Clean up empty rooms
      if (this.rooms.get(roomId).size === 0) {
        this.rooms.delete(roomId);
      }
    }
  }

  handleRoomMessage(ws, message) {
    const client = this.clients.get(ws);
    if (!client?.authenticated) return;

    if (message.room &amp;&amp; this.rooms.has(message.room)) {
      this.broadcastToRoom(message.room, {
        type: 'message',
        userId: client.id,
        username: client.metadata.username,
        message: message.content,
        timestamp: Date.now()
      });
    }
  }

  handleDisconnect(ws) {
    const client = this.clients.get(ws);
    if (!client) return;

    console.log(`Client ${client.id} disconnected`);

    // Remove from all rooms
    client.rooms.forEach(roomId =&gt; {
      this.leaveRoom(ws, roomId);
    });

    // Remove from clients
    this.clients.delete(ws);
  }

  send(ws, data) {
    if (ws.readyState === WebSocket.OPEN) {
      ws.send(JSON.stringify(data));
    }
  }

  broadcastToRoom(roomId, data, exclude = null) {
    if (!this.rooms.has(roomId)) return;

    const message = JSON.stringify(data);
    this.rooms.get(roomId).forEach(client =&gt; {
      if (client !== exclude &amp;&amp; client.readyState === WebSocket.OPEN) {
        client.send(message);
      }
    });
  }

  broadcastToAll(data, exclude = null) {
    const message = JSON.stringify(data);
    this.clients.forEach((clientInfo, ws) =&gt; {
      if (ws !== exclude &amp;&amp; ws.readyState === WebSocket.OPEN) {
        ws.send(message);
      }
    });
  }

  startHeartbeat() {
    this.heartbeatInterval = setInterval(() =&gt; {
      this.clients.forEach((clientInfo, ws) =&gt; {
        if (!ws.isAlive) {
          console.log(`Terminating dead connection: ${clientInfo.id}`);
          ws.terminate();
          return;
        }

        ws.isAlive = false;
        ws.ping();
      });
    }, this.options.pingInterval);
  }

  generateId() {
    return Math.random().toString(36).substring(2, 15);
  }

  start() {
    this.server.listen(this.options.port, () =&gt; {
      console.log(`WebSocket server listening on port ${this.options.port}`);
    });
  }

  stop() {
    clearInterval(this.heartbeatInterval);
    this.wss.close();
    this.server.close();
  }
}

// Usage
const server = new WebSocketServer({
  port: 8080,
  pingInterval: 30000,
  maxClients: 1000
});

server.start();
</code></pre>
<h2 id="use-cases-4"><a class="header" href="#use-cases-4">Use Cases</a></h2>
<h3 id="1-chat-application"><a class="header" href="#1-chat-application">1. Chat Application</a></h3>
<pre><code class="language-javascript">// Client
class ChatClient {
  constructor(url) {
    this.socket = new WebSocket(url);
    this.setupHandlers();
  }

  setupHandlers() {
    this.socket.onopen = () =&gt; {
      console.log('Connected to chat');
      this.authenticate();
    };

    this.socket.onmessage = (event) =&gt; {
      const data = JSON.parse(event.data);

      switch (data.type) {
        case 'message':
          this.displayMessage(data);
          break;
        case 'user-joined':
          this.showNotification(`${data.username} joined`);
          break;
        case 'user-left':
          this.showNotification(`${data.username} left`);
          break;
      }
    };
  }

  authenticate() {
    this.socket.send(JSON.stringify({
      type: 'auth',
      token: localStorage.getItem('token'),
      username: localStorage.getItem('username')
    }));
  }

  joinRoom(roomId) {
    this.socket.send(JSON.stringify({
      type: 'join-room',
      room: roomId
    }));
  }

  sendMessage(roomId, message) {
    this.socket.send(JSON.stringify({
      type: 'message',
      room: roomId,
      content: message
    }));
  }

  displayMessage(data) {
    const messageElement = document.createElement('div');
    messageElement.className = 'message';
    messageElement.innerHTML = `
      &lt;span class="username"&gt;${data.username}:&lt;/span&gt;
      &lt;span class="content"&gt;${data.message}&lt;/span&gt;
      &lt;span class="timestamp"&gt;${new Date(data.timestamp).toLocaleTimeString()}&lt;/span&gt;
    `;
    document.getElementById('messages').appendChild(messageElement);
  }

  showNotification(text) {
    console.log(text);
  }
}

const chat = new ChatClient('ws://localhost:8080');
chat.joinRoom('general');
</code></pre>
<h3 id="2-real-time-dashboard"><a class="header" href="#2-real-time-dashboard">2. Real-Time Dashboard</a></h3>
<pre><code class="language-javascript">// Server: Push updates to dashboard
function broadcastMetrics() {
  const metrics = {
    type: 'metrics',
    cpu: getCpuUsage(),
    memory: getMemoryUsage(),
    activeUsers: clients.size,
    requestsPerSecond: getRequestRate(),
    timestamp: Date.now()
  };

  broadcastToAll(metrics);
}

setInterval(broadcastMetrics, 1000);

// Client: Display real-time metrics
socket.onmessage = (event) =&gt; {
  const data = JSON.parse(event.data);

  if (data.type === 'metrics') {
    updateChart('cpu', data.cpu);
    updateChart('memory', data.memory);
    updateCounter('users', data.activeUsers);
    updateCounter('rps', data.requestsPerSecond);
  }
};
</code></pre>
<h3 id="3-live-notifications"><a class="header" href="#3-live-notifications">3. Live Notifications</a></h3>
<pre><code class="language-javascript">// Server: Send notifications
function notifyUser(userId, notification) {
  const client = getUserWebSocket(userId);

  if (client &amp;&amp; client.readyState === WebSocket.OPEN) {
    client.send(JSON.stringify({
      type: 'notification',
      title: notification.title,
      message: notification.message,
      priority: notification.priority,
      timestamp: Date.now()
    }));
  }
}

// Client: Display notifications
socket.onmessage = (event) =&gt; {
  const data = JSON.parse(event.data);

  if (data.type === 'notification') {
    showNotification(data.title, data.message);

    // Play sound for high priority
    if (data.priority === 'high') {
      playNotificationSound();
    }

    // Desktop notification
    if (Notification.permission === 'granted') {
      new Notification(data.title, {
        body: data.message,
        icon: '/icon.png'
      });
    }
  }
};
</code></pre>
<h3 id="4-collaborative-editing"><a class="header" href="#4-collaborative-editing">4. Collaborative Editing</a></h3>
<pre><code class="language-javascript">// Server: Broadcast document changes
wss.on('connection', (ws) =&gt; {
  ws.on('message', (data) =&gt; {
    const change = JSON.parse(data);

    if (change.type === 'edit') {
      // Apply change to document
      applyChange(change.documentId, change.operation);

      // Broadcast to others in same document
      broadcastToDocument(change.documentId, {
        type: 'edit',
        operation: change.operation,
        userId: ws.userId
      }, ws);
    }
  });
});

// Client: Send and receive edits
let editor = document.getElementById('editor');

editor.addEventListener('input', debounce((e) =&gt; {
  socket.send(JSON.stringify({
    type: 'edit',
    documentId: currentDocId,
    operation: {
      type: 'insert',
      position: e.target.selectionStart,
      text: e.data
    }
  }));
}, 100));

socket.onmessage = (event) =&gt; {
  const data = JSON.parse(event.data);

  if (data.type === 'edit' &amp;&amp; data.userId !== myUserId) {
    applyRemoteEdit(data.operation);
  }
};
</code></pre>
<h3 id="5-gamingmultiplayer"><a class="header" href="#5-gamingmultiplayer">5. Gaming/Multiplayer</a></h3>
<pre><code class="language-javascript">// Server: Game state synchronization
const gameState = {
  players: new Map(),
  entities: []
};

function updateGameState() {
  broadcastToAll({
    type: 'state',
    players: Array.from(gameState.players.values()),
    entities: gameState.entities,
    timestamp: Date.now()
  });
}

// 60 updates per second
setInterval(updateGameState, 1000 / 60);

// Client: Send player input
const input = {
  keys: {},
  mouse: { x: 0, y: 0 }
};

document.addEventListener('keydown', (e) =&gt; {
  input.keys[e.key] = true;

  socket.send(JSON.stringify({
    type: 'input',
    keys: input.keys,
    timestamp: Date.now()
  }));
});

// Receive game state
socket.onmessage = (event) =&gt; {
  const data = JSON.parse(event.data);

  if (data.type === 'state') {
    renderGameState(data.players, data.entities);
  }
};
</code></pre>
<h2 id="security-6"><a class="header" href="#security-6">Security</a></h2>
<h3 id="authentication-3"><a class="header" href="#authentication-3">Authentication</a></h3>
<pre><code class="language-javascript">// Server: Verify token on connection
wss.on('connection', (ws, req) =&gt; {
  // Extract token from query string
  const params = new URLSearchParams(req.url.split('?')[1]);
  const token = params.get('token');

  // Verify token
  if (!verifyToken(token)) {
    ws.close(1008, 'Invalid authentication');
    return;
  }

  ws.userId = decodeToken(token).userId;
});

// Or: Authenticate after connection
ws.on('message', (data) =&gt; {
  const message = JSON.parse(data);

  if (message.type === 'auth') {
    if (verifyToken(message.token)) {
      ws.authenticated = true;
      ws.userId = decodeToken(message.token).userId;
      ws.send(JSON.stringify({ type: 'auth-success' }));
    } else {
      ws.close(1008, 'Authentication failed');
    }
  } else if (!ws.authenticated) {
    ws.send(JSON.stringify({
      type: 'error',
      message: 'Not authenticated'
    }));
  }
});
</code></pre>
<h3 id="origin-validation"><a class="header" href="#origin-validation">Origin Validation</a></h3>
<pre><code class="language-javascript">// Server: Validate origin
wss.on('connection', (ws, req) =&gt; {
  const origin = req.headers.origin;
  const allowedOrigins = [
    'https://example.com',
    'https://app.example.com'
  ];

  if (!allowedOrigins.includes(origin)) {
    console.log('Rejected connection from:', origin);
    ws.close(1008, 'Origin not allowed');
    return;
  }

  // Accept connection
});
</code></pre>
<h3 id="rate-limiting-1"><a class="header" href="#rate-limiting-1">Rate Limiting</a></h3>
<pre><code class="language-javascript">// Server: Rate limit messages
const rateLimits = new Map(); // clientId -&gt; message count

ws.on('message', (data) =&gt; {
  const clientId = ws.userId || ws.ip;

  if (!rateLimits.has(clientId)) {
    rateLimits.set(clientId, { count: 0, resetAt: Date.now() + 60000 });
  }

  const limit = rateLimits.get(clientId);

  // Reset if window expired
  if (Date.now() &gt; limit.resetAt) {
    limit.count = 0;
    limit.resetAt = Date.now() + 60000;
  }

  // Check limit (100 messages per minute)
  if (limit.count &gt;= 100) {
    ws.send(JSON.stringify({
      type: 'error',
      message: 'Rate limit exceeded'
    }));
    return;
  }

  limit.count++;

  // Process message
  handleMessage(ws, data);
});
</code></pre>
<h3 id="input-validation"><a class="header" href="#input-validation">Input Validation</a></h3>
<pre><code class="language-javascript">// Server: Validate and sanitize input
function handleMessage(ws, data) {
  let message;

  try {
    message = JSON.parse(data);
  } catch (e) {
    ws.send(JSON.stringify({
      type: 'error',
      message: 'Invalid JSON'
    }));
    return;
  }

  // Validate message structure
  if (!message.type || typeof message.type !== 'string') {
    ws.send(JSON.stringify({
      type: 'error',
      message: 'Invalid message format'
    }));
    return;
  }

  // Validate message size
  if (data.length &gt; 10000) {
    ws.send(JSON.stringify({
      type: 'error',
      message: 'Message too large'
    }));
    return;
  }

  // Sanitize text content
  if (message.content) {
    message.content = sanitizeHtml(message.content);
  }

  // Process validated message
  processMessage(ws, message);
}
</code></pre>
<h3 id="secure-websocket-wss"><a class="header" href="#secure-websocket-wss">Secure WebSocket (wss://)</a></h3>
<pre><code class="language-javascript">// Server: Use HTTPS/WSS
const https = require('https');
const fs = require('fs');

const server = https.createServer({
  cert: fs.readFileSync('cert.pem'),
  key: fs.readFileSync('key.pem')
});

const wss = new WebSocket.Server({ server });

server.listen(443);

// Client: Connect with wss://
const socket = new WebSocket('wss://example.com/socket');
</code></pre>
<h2 id="best-practices-71"><a class="header" href="#best-practices-71">Best Practices</a></h2>
<h3 id="1-heartbeatping-pong"><a class="header" href="#1-heartbeatping-pong">1. Heartbeat/Ping-Pong</a></h3>
<pre><code class="language-javascript">// Server: Detect dead connections
const heartbeatInterval = setInterval(() =&gt; {
  wss.clients.forEach((ws) =&gt; {
    if (ws.isAlive === false) {
      return ws.terminate();
    }

    ws.isAlive = false;
    ws.ping();
  });
}, 30000);

wss.on('connection', (ws) =&gt; {
  ws.isAlive = true;

  ws.on('pong', () =&gt; {
    ws.isAlive = true;
  });
});

// Client: Respond to pings (automatic in browsers)
// Or implement custom heartbeat:
setInterval(() =&gt; {
  socket.send(JSON.stringify({ type: 'ping' }));
}, 30000);
</code></pre>
<h3 id="2-reconnection-strategy"><a class="header" href="#2-reconnection-strategy">2. Reconnection Strategy</a></h3>
<pre><code class="language-javascript">// Client: Exponential backoff
class ReconnectingWebSocket {
  constructor(url) {
    this.url = url;
    this.reconnectDelay = 1000;
    this.maxReconnectDelay = 30000;
    this.reconnectAttempts = 0;
    this.connect();
  }

  connect() {
    this.ws = new WebSocket(this.url);

    this.ws.onopen = () =&gt; {
      console.log('Connected');
      this.reconnectDelay = 1000;
      this.reconnectAttempts = 0;
    };

    this.ws.onclose = () =&gt; {
      console.log('Disconnected');
      this.scheduleReconnect();
    };
  }

  scheduleReconnect() {
    const delay = Math.min(
      this.reconnectDelay * Math.pow(2, this.reconnectAttempts),
      this.maxReconnectDelay
    );

    console.log(`Reconnecting in ${delay}ms`);

    setTimeout(() =&gt; {
      this.reconnectAttempts++;
      this.connect();
    }, delay);
  }
}
</code></pre>
<h3 id="3-message-queuing"><a class="header" href="#3-message-queuing">3. Message Queuing</a></h3>
<pre><code class="language-javascript">// Client: Queue messages when disconnected
class QueuedWebSocket {
  constructor(url) {
    this.url = url;
    this.queue = [];
    this.connect();
  }

  connect() {
    this.ws = new WebSocket(this.url);

    this.ws.onopen = () =&gt; {
      // Send queued messages
      while (this.queue.length &gt; 0) {
        this.ws.send(this.queue.shift());
      }
    };
  }

  send(data) {
    if (this.ws.readyState === WebSocket.OPEN) {
      this.ws.send(data);
    } else {
      this.queue.push(data);
    }
  }
}
</code></pre>
<h3 id="4-binary-data"><a class="header" href="#4-binary-data">4. Binary Data</a></h3>
<pre><code class="language-javascript">// Send binary efficiently
const buffer = new ArrayBuffer(8);
const view = new DataView(buffer);

view.setUint32(0, 12345);
view.setFloat32(4, 3.14);

socket.send(buffer);

// Receive binary
socket.binaryType = 'arraybuffer';

socket.onmessage = (event) =&gt; {
  if (event.data instanceof ArrayBuffer) {
    const view = new DataView(event.data);
    const num = view.getUint32(0);
    const float = view.getFloat32(4);
  }
};
</code></pre>
<h3 id="5-compression"><a class="header" href="#5-compression">5. Compression</a></h3>
<pre><code class="language-javascript">// Server: Enable per-message deflate
const wss = new WebSocket.Server({
  server,
  perMessageDeflate: {
    zlibDeflateOptions: {
      chunkSize: 1024,
      memLevel: 7,
      level: 3
    },
    zlibInflateOptions: {
      chunkSize: 10 * 1024
    },
    clientNoContextTakeover: true,
    serverNoContextTakeover: true,
    serverMaxWindowBits: 10,
    concurrencyLimit: 10,
    threshold: 1024 // Compress only messages &gt; 1KB
  }
});
</code></pre>
<h2 id="debugging-7"><a class="header" href="#debugging-7">Debugging</a></h2>
<h3 id="browser-devtools"><a class="header" href="#browser-devtools">Browser DevTools</a></h3>
<pre><code class="language-javascript">// Chrome/Firefox DevTools
// Network tab → WS/Messages

// View frames
// - Sent (green arrow)
// - Received (red arrow)
// - Click to view content

// Console logging
const socket = new WebSocket('ws://localhost:8080');

socket.addEventListener('message', (event) =&gt; {
  console.log('%c⬇ Received', 'color: blue', event.data);
});

socket.send = new Proxy(socket.send, {
  apply(target, thisArg, args) {
    console.log('%c⬆ Sent', 'color: green', args[0]);
    return target.apply(thisArg, args);
  }
});
</code></pre>
<h3 id="command-line-tools-2"><a class="header" href="#command-line-tools-2">Command-Line Tools</a></h3>
<pre><code class="language-bash"># wscat - WebSocket client
npm install -g wscat

# Connect to server
wscat -c ws://localhost:8080

# Send message
&gt; {"type": "chat", "message": "Hello"}

# Listen for messages
&lt; {"type": "message", "content": "Hi there"}

# WebSocket with headers
wscat -c ws://localhost:8080 -H "Authorization: Bearer token"

# Test wss:// with self-signed cert
wscat -c wss://localhost:443 -n

# websocat - More features
cargo install websocat

# Connect
websocat ws://localhost:8080

# Binary mode
websocat --binary ws://localhost:8080

# tcpdump - Capture WebSocket traffic
sudo tcpdump -i any -A 'tcp port 8080'

# Wireshark
# Filter: websocket
# Analyze → Decode As → WebSocket
</code></pre>
<h2 id="common-issues-24"><a class="header" href="#common-issues-24">Common Issues</a></h2>
<pre><code>Issue: Connection fails immediately
Causes:
- Wrong URL (ws:// vs wss://)
- Server not running
- Firewall blocking port
- CORS/Origin mismatch

Solution:
- Check server logs
- Verify URL and port
- Check browser console for errors
- Validate origin on server

Issue: Connection drops frequently
Causes:
- No heartbeat/ping
- Idle timeout
- Network issues
- Proxy timeout

Solution:
- Implement ping/pong
- Send periodic messages
- Reduce ping interval
- Use wss:// for better stability

Issue: Messages not received
Causes:
- Wrong readyState
- Connection closed
- Message too large
- Server not broadcasting

Solution:
- Check socket.readyState === OPEN
- Add message queuing
- Split large messages
- Verify server broadcast logic

Issue: High memory usage
Causes:
- Not closing connections
- Large message buffers
- Too many connections
- Memory leaks

Solution:
- Close unused connections
- Limit message size
- Set max connections
- Use heartbeat to detect dead connections
</code></pre>
<h2 id="eli10-websocket-explained-simply"><a class="header" href="#eli10-websocket-explained-simply">ELI10: WebSocket Explained Simply</a></h2>
<p>WebSocket is like having a phone call instead of sending letters:</p>
<h3 id="traditional-http-letters"><a class="header" href="#traditional-http-letters">Traditional HTTP (Letters)</a></h3>
<pre><code>You: "Any new messages?" [wait for response]
Server: "No"

[1 second later]
You: "Any new messages?" [wait for response]
Server: "No"

[1 second later]
You: "Any new messages?" [wait for response]
Server: "Yes! Here's one"

Problem: Lots of wasted "letters" (requests)
</code></pre>
<h3 id="websocket-phone-call"><a class="header" href="#websocket-phone-call">WebSocket (Phone Call)</a></h3>
<pre><code>You: "Hello!" [open connection]
Server: "Hi!" [connection open]

[Connection stays open]

Server: "New message for you!"
You: "Thanks! Here's my reply"
Server: "Got it!"
You: "Question?"
Server: "Answer!"

Connection stays open until you hang up
</code></pre>
<h3 id="key-differences-1"><a class="header" href="#key-differences-1">Key Differences</a></h3>
<pre><code>HTTP:
- Ask → Wait → Answer → Close
- Repeat every time
- Like knocking on door for each question

WebSocket:
- Open door once
- Walk in and stay
- Talk back and forth
- Like having a conversation
</code></pre>
<h3 id="real-examples"><a class="header" href="#real-examples">Real Examples</a></h3>
<pre><code>HTTP: Checking email every minute
WebSocket: Email app shows new mail instantly

HTTP: Refreshing page to see chat messages
WebSocket: Messages appear as sent

HTTP: Reloading dashboard for new data
WebSocket: Dashboard updates in real-time
</code></pre>
<h2 id="further-resources-38"><a class="header" href="#further-resources-38">Further Resources</a></h2>
<h3 id="specifications-3"><a class="header" href="#specifications-3">Specifications</a></h3>
<ul>
<li><a href="https://tools.ietf.org/html/rfc6455">RFC 6455 - WebSocket Protocol</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebSocket">WebSocket API - MDN</a></li>
<li><a href="https://www.iana.org/assignments/websocket/websocket.xml">WebSocket Extensions</a></li>
</ul>
<h3 id="libraries-1"><a class="header" href="#libraries-1">Libraries</a></h3>
<p><strong>JavaScript (Client)</strong></p>
<ul>
<li>Native WebSocket API (built-in)</li>
<li><a href="https://socket.io/">Socket.IO</a> - High-level library with fallbacks</li>
<li><a href="https://github.com/sockjs/sockjs-client">SockJS</a> - WebSocket emulation</li>
</ul>
<p><strong>Node.js (Server)</strong></p>
<ul>
<li><a href="https://github.com/websockets/ws">ws</a> - Fast, standards-compliant</li>
<li><a href="https://socket.io/">Socket.IO</a> - Client + server library</li>
<li><a href="https://github.com/uNetworking/uWebSockets.js">uWebSockets.js</a> - Ultra fast</li>
</ul>
<p><strong>Python</strong></p>
<ul>
<li><a href="https://websockets.readthedocs.io/">websockets</a> - asyncio library</li>
<li><a href="https://docs.aiohttp.org/">aiohttp</a> - WebSocket support</li>
<li><a href="https://flask-socketio.readthedocs.io/">Flask-SocketIO</a> - Flask integration</li>
</ul>
<p><strong>Go</strong></p>
<ul>
<li><a href="https://github.com/gorilla/websocket">gorilla/websocket</a></li>
<li><a href="https://github.com/nhooyr/websocket">nhooyr/websocket</a></li>
</ul>
<p><strong>Rust</strong></p>
<ul>
<li><a href="https://github.com/snapview/tokio-tungstenite">tokio-tungstenite</a></li>
<li><a href="https://actix.rs/">actix-web</a> - WebSocket support</li>
</ul>
<h3 id="tools-13"><a class="header" href="#tools-13">Tools</a></h3>
<ul>
<li><a href="https://github.com/websockets/wscat">wscat</a> - WebSocket CLI</li>
<li><a href="https://github.com/vi/websocat">websocat</a> - netcat for WebSockets</li>
<li><a href="https://www.postman.com/">Postman</a> - WebSocket testing</li>
</ul>
<h3 id="testing-4"><a class="header" href="#testing-4">Testing</a></h3>
<ul>
<li><a href="https://websocketking.com/">WebSocket King</a> - Online tester</li>
<li><a href="https://www.piesocket.com/websocket-tester">PieSocket</a> - Testing tool</li>
</ul>
<h3 id="books--tutorials"><a class="header" href="#books--tutorials">Books &amp; Tutorials</a></h3>
<ul>
<li><a href="https://www.apress.com/gp/book/9781430247401">The Definitive Guide to HTML5 WebSocket</a></li>
<li><a href="https://www.oreilly.com/library/view/real-time-web-application/9781484232705/">Real-Time Web Application Development</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="webrtc-web-real-time-communication-1"><a class="header" href="#webrtc-web-real-time-communication-1">WebRTC (Web Real-Time Communication)</a></h1>
<h2 id="overview-89"><a class="header" href="#overview-89">Overview</a></h2>
<p>WebRTC (Web Real-Time Communication) is an open-source framework that enables real-time peer-to-peer communication directly between web browsers and mobile applications. It supports video, audio, and arbitrary data transfer without requiring plugins or third-party software.</p>
<h2 id="key-features-18"><a class="header" href="#key-features-18">Key Features</a></h2>
<pre><code>1. Peer-to-Peer Communication
   - Direct browser-to-browser connections
   - Low latency (no server relay required*)
   - Reduced bandwidth costs

2. Media Support
   - Audio streaming
   - Video streaming
   - Screen sharing
   - Data channels for arbitrary data

3. Built-in Security
   - Mandatory encryption (DTLS, SRTP)
   - No unencrypted media transmission
   - Secure signaling required

4. NAT/Firewall Traversal
   - ICE protocol for connectivity
   - STUN for public address discovery
   - TURN as relay fallback

5. Adaptive Quality
   - Bandwidth estimation
   - Codec negotiation
   - Quality adjusts to network conditions

* Direct P2P when possible; TURN relay as fallback
</code></pre>
<h2 id="webrtc-architecture"><a class="header" href="#webrtc-architecture">WebRTC Architecture</a></h2>
<pre><code>┌─────────────────────────────────────────────────────────────┐
│                    WebRTC Application                        │
│  (JavaScript API in browser or native mobile app)           │
└────────────────────┬────────────────────────────────────────┘
                     │
     ┌───────────────┼───────────────┐
     │               │               │
     ▼               ▼               ▼
┌─────────┐   ┌──────────┐   ┌──────────┐
│  Media  │   │   Data   │   │ Signaling│
│ Streams │   │ Channels │   │ (Custom) │
└─────────┘   └──────────┘   └──────────┘
     │               │               │
     ▼               ▼               │
┌─────────────────────────┐         │
│   WebRTC Core APIs      │         │
│                         │         │
│ - getUserMedia()        │         │
│ - RTCPeerConnection     │         │
│ - RTCDataChannel        │         │
└─────────────────────────┘         │
     │                               │
     ▼                               │
┌─────────────────────────┐         │
│   ICE/STUN/TURN         │         │
│ (NAT Traversal)         │         │
└─────────────────────────┘         │
     │                               │
     └───────────────┬───────────────┘
                     │
                     ▼
           ┌──────────────────┐
           │   Network Layer   │
           │  (UDP/TCP/TLS)    │
           └──────────────────┘
</code></pre>
<h2 id="core-components-3"><a class="header" href="#core-components-3">Core Components</a></h2>
<h3 id="1-getusermedia-api"><a class="header" href="#1-getusermedia-api">1. getUserMedia API</a></h3>
<p>Access local camera and microphone:</p>
<pre><code class="language-javascript">// Basic usage
async function getLocalMedia() {
  try {
    const stream = await navigator.mediaDevices.getUserMedia({
      video: true,
      audio: true
    });

    // Display local video
    document.getElementById('localVideo').srcObject = stream;
    return stream;
  } catch (error) {
    console.error('Error accessing media devices:', error);
  }
}

// Advanced constraints
const constraints = {
  video: {
    width: { min: 640, ideal: 1280, max: 1920 },
    height: { min: 480, ideal: 720, max: 1080 },
    frameRate: { ideal: 30, max: 60 },
    facingMode: 'user' // or 'environment' for rear camera
  },
  audio: {
    echoCancellation: true,
    noiseSuppression: true,
    autoGainControl: true
  }
};

const stream = await navigator.mediaDevices.getUserMedia(constraints);

// List available devices
const devices = await navigator.mediaDevices.enumerateDevices();
devices.forEach(device =&gt; {
  console.log(`${device.kind}: ${device.label} (${device.deviceId})`);
});

// Screen sharing
const screenStream = await navigator.mediaDevices.getDisplayMedia({
  video: {
    cursor: 'always',
    displaySurface: 'monitor' // 'window', 'application', 'browser'
  },
  audio: false
});
</code></pre>
<h3 id="2-rtcpeerconnection"><a class="header" href="#2-rtcpeerconnection">2. RTCPeerConnection</a></h3>
<p>Core API for peer-to-peer connection:</p>
<pre><code class="language-javascript">// Create peer connection
const configuration = {
  iceServers: [
    { urls: 'stun:stun.l.google.com:19302' },
    { urls: 'stun:stun1.l.google.com:19302' },
    {
      urls: 'turn:turn.example.com:3478',
      username: 'user',
      credential: 'pass'
    }
  ],
  iceCandidatePoolSize: 10
};

const peerConnection = new RTCPeerConnection(configuration);

// Add local stream to connection
localStream.getTracks().forEach(track =&gt; {
  peerConnection.addTrack(track, localStream);
});

// Listen for remote stream
peerConnection.ontrack = (event) =&gt; {
  const remoteVideo = document.getElementById('remoteVideo');
  if (remoteVideo.srcObject !== event.streams[0]) {
    remoteVideo.srcObject = event.streams[0];
    console.log('Received remote stream');
  }
};

// Handle ICE candidates
peerConnection.onicecandidate = (event) =&gt; {
  if (event.candidate) {
    // Send candidate to remote peer via signaling
    sendToSignalingServer({
      type: 'ice-candidate',
      candidate: event.candidate
    });
  }
};

// Monitor connection state
peerConnection.onconnectionstatechange = () =&gt; {
  console.log('Connection state:', peerConnection.connectionState);
  // States: new, connecting, connected, disconnected, failed, closed
};

peerConnection.oniceconnectionstatechange = () =&gt; {
  console.log('ICE state:', peerConnection.iceConnectionState);
  // States: new, checking, connected, completed, failed, disconnected, closed
};
</code></pre>
<h3 id="3-rtcdatachannel"><a class="header" href="#3-rtcdatachannel">3. RTCDataChannel</a></h3>
<p>Bi-directional data transfer:</p>
<pre><code class="language-javascript">// Sender creates data channel
const dataChannel = peerConnection.createDataChannel('chat', {
  ordered: true,        // Guarantee order
  maxRetransmits: 3     // Retry failed messages 3 times
  // OR: maxPacketLifeTime: 3000  // Drop after 3 seconds
});

dataChannel.onopen = () =&gt; {
  console.log('Data channel opened');
  dataChannel.send('Hello!');
};

dataChannel.onmessage = (event) =&gt; {
  console.log('Received:', event.data);
};

dataChannel.onerror = (error) =&gt; {
  console.error('Data channel error:', error);
};

dataChannel.onclose = () =&gt; {
  console.log('Data channel closed');
};

// Receiver listens for data channel
peerConnection.ondatachannel = (event) =&gt; {
  const receiveChannel = event.channel;

  receiveChannel.onmessage = (event) =&gt; {
    console.log('Received:', event.data);
  };

  receiveChannel.onopen = () =&gt; {
    console.log('Receive channel opened');
  };
};

// Send different data types
dataChannel.send('Text message');
dataChannel.send(JSON.stringify({ type: 'chat', message: 'Hi' }));
dataChannel.send(new Uint8Array([1, 2, 3, 4])); // Binary
dataChannel.send(new Blob(['file content'])); // Blob

// Check buffered amount before sending large data
if (dataChannel.bufferedAmount === 0) {
  dataChannel.send(largeData);
}
</code></pre>
<h2 id="connection-establishment-signaling"><a class="header" href="#connection-establishment-signaling">Connection Establishment (Signaling)</a></h2>
<p>WebRTC doesn't define signaling - you implement it yourself:</p>
<h3 id="offeranswer-exchange-sdp"><a class="header" href="#offeranswer-exchange-sdp">Offer/Answer Exchange (SDP)</a></h3>
<pre><code class="language-javascript">// ============================================
// Caller (Initiator)
// ============================================

// 1. Create offer
const offer = await peerConnection.createOffer({
  offerToReceiveAudio: true,
  offerToReceiveVideo: true
});

// 2. Set local description
await peerConnection.setLocalDescription(offer);

// 3. Send offer to remote peer via signaling
sendToSignalingServer({
  type: 'offer',
  sdp: peerConnection.localDescription
});

// 4. Receive answer from signaling server
signalingSocket.on('answer', async (answer) =&gt; {
  await peerConnection.setRemoteDescription(
    new RTCSessionDescription(answer)
  );
});

// ============================================
// Callee (Responder)
// ============================================

// 1. Receive offer from signaling server
signalingSocket.on('offer', async (offer) =&gt; {
  // 2. Set remote description
  await peerConnection.setRemoteDescription(
    new RTCSessionDescription(offer)
  );

  // 3. Create answer
  const answer = await peerConnection.createAnswer();

  // 4. Set local description
  await peerConnection.setLocalDescription(answer);

  // 5. Send answer back via signaling
  sendToSignalingServer({
    type: 'answer',
    sdp: peerConnection.localDescription
  });
});

// ============================================
// Both Peers
// ============================================

// Handle ICE candidates
peerConnection.onicecandidate = (event) =&gt; {
  if (event.candidate) {
    sendToSignalingServer({
      type: 'ice-candidate',
      candidate: event.candidate
    });
  }
};

// Receive ICE candidates from signaling
signalingSocket.on('ice-candidate', async (candidate) =&gt; {
  try {
    await peerConnection.addIceCandidate(
      new RTCIceCandidate(candidate)
    );
  } catch (error) {
    console.error('Error adding ICE candidate:', error);
  }
});
</code></pre>
<h3 id="sdp-session-description-protocol"><a class="header" href="#sdp-session-description-protocol">SDP (Session Description Protocol)</a></h3>
<p>SDP describes the media session:</p>
<pre><code>Example SDP Offer:

v=0
o=- 123456789 2 IN IP4 127.0.0.1
s=-
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS stream1

m=audio 9 UDP/TLS/RTP/SAVPF 111 103 104
c=IN IP4 0.0.0.0
a=rtcp:9 IN IP4 0.0.0.0
a=ice-ufrag:F7gI
a=ice-pwd:x9cml6RvRClHPcAy
a=ice-options:trickle
a=fingerprint:sha-256 8B:87:09:8A:5D:C2:...
a=setup:actpass
a=mid:0
a=sendrecv
a=rtcp-mux
a=rtpmap:111 opus/48000/2
a=rtpmap:103 ISAC/16000
a=rtpmap:104 ISAC/32000

m=video 9 UDP/TLS/RTP/SAVPF 96 97 98
c=IN IP4 0.0.0.0
a=rtcp:9 IN IP4 0.0.0.0
a=ice-ufrag:F7gI
a=ice-pwd:x9cml6RvRClHPcAy
a=ice-options:trickle
a=fingerprint:sha-256 8B:87:09:8A:5D:C2:...
a=setup:actpass
a=mid:1
a=sendrecv
a=rtcp-mux
a=rtpmap:96 VP8/90000
a=rtpmap:97 VP9/90000
a=rtpmap:98 H264/90000

Key Fields:
- v=0: SDP version
- m=: Media description (audio/video)
- c=: Connection information
- a=: Attributes (ICE, codecs, etc.)
- rtpmap: RTP payload mapping
- ice-ufrag/ice-pwd: ICE credentials
- fingerprint: DTLS certificate fingerprint
</code></pre>
<h2 id="signaling-implementation-examples"><a class="header" href="#signaling-implementation-examples">Signaling Implementation Examples</a></h2>
<h3 id="websocket-signaling-server-nodejs"><a class="header" href="#websocket-signaling-server-nodejs">WebSocket Signaling Server (Node.js)</a></h3>
<pre><code class="language-javascript">// Server
const WebSocket = require('ws');
const wss = new WebSocket.Server({ port: 8080 });

const rooms = new Map(); // roomId -&gt; Set of clients

wss.on('connection', (ws) =&gt; {
  console.log('Client connected');

  ws.on('message', (data) =&gt; {
    const message = JSON.parse(data);

    switch (message.type) {
      case 'join':
        // Join room
        if (!rooms.has(message.room)) {
          rooms.set(message.room, new Set());
        }
        rooms.get(message.room).add(ws);
        ws.room = message.room;

        // Notify others in room
        broadcast(message.room, ws, {
          type: 'user-joined',
          userId: message.userId
        });
        break;

      case 'offer':
      case 'answer':
      case 'ice-candidate':
        // Forward to specific peer or broadcast
        if (message.target) {
          sendToUser(message.target, message);
        } else {
          broadcast(ws.room, ws, message);
        }
        break;

      case 'leave':
        leaveRoom(ws);
        break;
    }
  });

  ws.on('close', () =&gt; {
    console.log('Client disconnected');
    leaveRoom(ws);
  });
});

function broadcast(room, sender, message) {
  if (!rooms.has(room)) return;

  rooms.get(room).forEach(client =&gt; {
    if (client !== sender &amp;&amp; client.readyState === WebSocket.OPEN) {
      client.send(JSON.stringify(message));
    }
  });
}

function leaveRoom(ws) {
  if (ws.room &amp;&amp; rooms.has(ws.room)) {
    rooms.get(ws.room).delete(ws);
    broadcast(ws.room, ws, {
      type: 'user-left',
      userId: ws.userId
    });
  }
}

console.log('Signaling server running on ws://localhost:8080');
</code></pre>
<h3 id="client-side-signaling"><a class="header" href="#client-side-signaling">Client-Side Signaling</a></h3>
<pre><code class="language-javascript">// Client
class SignalingClient {
  constructor(url) {
    this.socket = new WebSocket(url);
    this.handlers = new Map();

    this.socket.onmessage = (event) =&gt; {
      const message = JSON.parse(event.data);
      const handler = this.handlers.get(message.type);
      if (handler) {
        handler(message);
      }
    };

    this.socket.onopen = () =&gt; {
      console.log('Signaling connected');
    };

    this.socket.onerror = (error) =&gt; {
      console.error('Signaling error:', error);
    };

    this.socket.onclose = () =&gt; {
      console.log('Signaling disconnected');
    };
  }

  on(type, handler) {
    this.handlers.set(type, handler);
  }

  send(message) {
    this.socket.send(JSON.stringify(message));
  }

  join(room, userId) {
    this.send({ type: 'join', room, userId });
  }

  sendOffer(offer, target) {
    this.send({ type: 'offer', sdp: offer, target });
  }

  sendAnswer(answer, target) {
    this.send({ type: 'answer', sdp: answer, target });
  }

  sendIceCandidate(candidate, target) {
    this.send({ type: 'ice-candidate', candidate, target });
  }
}

// Usage
const signaling = new SignalingClient('ws://localhost:8080');

signaling.on('offer', handleOffer);
signaling.on('answer', handleAnswer);
signaling.on('ice-candidate', handleIceCandidate);

signaling.join('room123', 'user1');
</code></pre>
<h2 id="complete-webrtc-example"><a class="header" href="#complete-webrtc-example">Complete WebRTC Example</a></h2>
<h3 id="simple-video-chat-application"><a class="header" href="#simple-video-chat-application">Simple Video Chat Application</a></h3>
<pre><code class="language-javascript">class WebRTCVideoChat {
  constructor(signalingUrl) {
    this.signaling = new SignalingClient(signalingUrl);
    this.peerConnection = null;
    this.localStream = null;

    this.setupSignaling();
  }

  setupSignaling() {
    this.signaling.on('offer', async (message) =&gt; {
      await this.handleOffer(message.sdp, message.sender);
    });

    this.signaling.on('answer', async (message) =&gt; {
      await this.handleAnswer(message.sdp);
    });

    this.signaling.on('ice-candidate', async (message) =&gt; {
      await this.handleIceCandidate(message.candidate);
    });

    this.signaling.on('user-joined', (message) =&gt; {
      console.log('User joined:', message.userId);
      // Initiate call if you're the caller
    });
  }

  async start(localVideoElement, remoteVideoElement) {
    // Get local media
    this.localStream = await navigator.mediaDevices.getUserMedia({
      video: { width: 1280, height: 720 },
      audio: true
    });

    localVideoElement.srcObject = this.localStream;

    // Create peer connection
    this.peerConnection = new RTCPeerConnection({
      iceServers: [
        { urls: 'stun:stun.l.google.com:19302' }
      ]
    });

    // Add local stream
    this.localStream.getTracks().forEach(track =&gt; {
      this.peerConnection.addTrack(track, this.localStream);
    });

    // Handle remote stream
    this.peerConnection.ontrack = (event) =&gt; {
      remoteVideoElement.srcObject = event.streams[0];
    };

    // Handle ICE candidates
    this.peerConnection.onicecandidate = (event) =&gt; {
      if (event.candidate) {
        this.signaling.sendIceCandidate(event.candidate);
      }
    };

    // Monitor connection
    this.peerConnection.onconnectionstatechange = () =&gt; {
      console.log('Connection state:',
        this.peerConnection.connectionState);
    };
  }

  async call() {
    // Create and send offer
    const offer = await this.peerConnection.createOffer();
    await this.peerConnection.setLocalDescription(offer);
    this.signaling.sendOffer(offer);
  }

  async handleOffer(offer, sender) {
    await this.peerConnection.setRemoteDescription(
      new RTCSessionDescription(offer)
    );

    const answer = await this.peerConnection.createAnswer();
    await this.peerConnection.setLocalDescription(answer);

    this.signaling.sendAnswer(answer, sender);
  }

  async handleAnswer(answer) {
    await this.peerConnection.setRemoteDescription(
      new RTCSessionDescription(answer)
    );
  }

  async handleIceCandidate(candidate) {
    await this.peerConnection.addIceCandidate(
      new RTCIceCandidate(candidate)
    );
  }

  hangup() {
    if (this.peerConnection) {
      this.peerConnection.close();
      this.peerConnection = null;
    }

    if (this.localStream) {
      this.localStream.getTracks().forEach(track =&gt; track.stop());
      this.localStream = null;
    }
  }

  toggleAudio() {
    const audioTrack = this.localStream.getAudioTracks()[0];
    audioTrack.enabled = !audioTrack.enabled;
    return audioTrack.enabled;
  }

  toggleVideo() {
    const videoTrack = this.localStream.getVideoTracks()[0];
    videoTrack.enabled = !videoTrack.enabled;
    return videoTrack.enabled;
  }
}

// Usage
const chat = new WebRTCVideoChat('ws://localhost:8080');

const localVideo = document.getElementById('localVideo');
const remoteVideo = document.getElementById('remoteVideo');

await chat.start(localVideo, remoteVideo);
chat.signaling.join('room123', 'user1');

// When ready to call
document.getElementById('callButton').onclick = () =&gt; chat.call();
document.getElementById('hangupButton').onclick = () =&gt; chat.hangup();
document.getElementById('muteButton').onclick = () =&gt; chat.toggleAudio();
document.getElementById('videoButton').onclick = () =&gt; chat.toggleVideo();
</code></pre>
<h2 id="media-codecs"><a class="header" href="#media-codecs">Media Codecs</a></h2>
<h3 id="audio-codecs"><a class="header" href="#audio-codecs">Audio Codecs</a></h3>
<pre><code>Opus (Preferred)
- Bitrate: 6-510 kbps
- Latency: 5-66.5 ms
- Best quality and efficiency
- Supports stereo and mono
- Adaptive bitrate

G.711 (PCMU/PCMA)
- Bitrate: 64 kbps
- Latency: Low
- Widely supported
- Lower quality than Opus

iSAC
- Bitrate: 10-32 kbps
- Adaptive bitrate
- Good for low bandwidth

iLBC
- Bitrate: 13.33 or 15.2 kbps
- Packet loss resilience
- Voice only
</code></pre>
<h3 id="video-codecs"><a class="header" href="#video-codecs">Video Codecs</a></h3>
<pre><code>VP8 (Mandatory in WebRTC)
- Open source
- Good quality
- Hardware acceleration common
- Bitrate: 100-2000 kbps typically

VP9 (Better than VP8)
- 50% better compression than VP8
- Supports 4K
- Lower bandwidth usage
- Newer, less hardware support

H.264 (Most compatible)
- Patent-encumbered
- Excellent hardware support
- Multiple profiles (Baseline, Main, High)
- Most widely supported

AV1 (Future)
- Best compression
- Open source
- Still emerging
- Limited hardware support
</code></pre>
<h3 id="codec-selection"><a class="header" href="#codec-selection">Codec Selection</a></h3>
<pre><code class="language-javascript">// Prefer specific codec
function preferCodec(sdp, codecName) {
  const lines = sdp.split('\n');
  const mLineIndex = lines.findIndex(line =&gt; line.startsWith('m=video'));
  if (mLineIndex === -1) return sdp;

  const codecRegex = new RegExp(`rtpmap:(\\d+) ${codecName}`, 'i');
  const codecPayload = lines
    .find(line =&gt; codecRegex.test(line))
    ?.match(codecRegex)?.[1];

  if (!codecPayload) return sdp;

  const mLine = lines[mLineIndex].split(' ');
  const codecs = mLine.slice(3);

  // Move preferred codec to front
  const newCodecs = [
    codecPayload,
    ...codecs.filter(c =&gt; c !== codecPayload)
  ];

  mLine.splice(3, codecs.length, ...newCodecs);
  lines[mLineIndex] = mLine.join(' ');

  return lines.join('\n');
}

// Usage
const offer = await peerConnection.createOffer();
offer.sdp = preferCodec(offer.sdp, 'VP9');
await peerConnection.setLocalDescription(offer);
</code></pre>
<h2 id="quality-adaptation"><a class="header" href="#quality-adaptation">Quality Adaptation</a></h2>
<h3 id="bandwidth-estimation"><a class="header" href="#bandwidth-estimation">Bandwidth Estimation</a></h3>
<pre><code class="language-javascript">// Monitor bandwidth
peerConnection.getStats().then(stats =&gt; {
  stats.forEach(report =&gt; {
    if (report.type === 'candidate-pair' &amp;&amp; report.state === 'succeeded') {
      console.log('Available bandwidth:',
        report.availableOutgoingBitrate);
      console.log('Current bandwidth:',
        report.currentRoundTripTime);
    }

    if (report.type === 'inbound-rtp' &amp;&amp; report.mediaType === 'video') {
      console.log('Bytes received:', report.bytesReceived);
      console.log('Packets lost:', report.packetsLost);
      console.log('Jitter:', report.jitter);
    }
  });
});

// Periodic monitoring
setInterval(async () =&gt; {
  const stats = await peerConnection.getStats();
  analyzeStats(stats);
}, 1000);
</code></pre>
<h3 id="simulcast-multiple-qualities"><a class="header" href="#simulcast-multiple-qualities">Simulcast (Multiple Qualities)</a></h3>
<pre><code class="language-javascript">// Sender: Send multiple resolutions
const sender = peerConnection
  .getSenders()
  .find(s =&gt; s.track.kind === 'video');

const parameters = sender.getParameters();
if (!parameters.encodings) {
  parameters.encodings = [
    { rid: 'h', maxBitrate: 1500000 },  // High quality
    { rid: 'm', maxBitrate: 600000, scaleResolutionDownBy: 2 },  // Medium
    { rid: 'l', maxBitrate: 200000, scaleResolutionDownBy: 4 }   // Low
  ];
}

await sender.setParameters(parameters);

// Receiver: Select layer
const receiver = peerConnection
  .getReceivers()
  .find(r =&gt; r.track.kind === 'video');

// Request specific layer
receiver.getParameters().encodings = [
  { active: true, rid: 'm' }  // Request medium quality
];
</code></pre>
<h3 id="manual-bitrate-control"><a class="header" href="#manual-bitrate-control">Manual Bitrate Control</a></h3>
<pre><code class="language-javascript">async function setMaxBitrate(peerConnection, maxBitrate) {
  const sender = peerConnection
    .getSenders()
    .find(s =&gt; s.track.kind === 'video');

  const parameters = sender.getParameters();

  if (!parameters.encodings) {
    parameters.encodings = [{}];
  }

  parameters.encodings[0].maxBitrate = maxBitrate;

  await sender.setParameters(parameters);
  console.log(`Set max bitrate to ${maxBitrate} bps`);
}

// Usage
setMaxBitrate(peerConnection, 500000); // 500 kbps
</code></pre>
<h2 id="data-channels-use-cases"><a class="header" href="#data-channels-use-cases">Data Channels Use Cases</a></h2>
<h3 id="file-transfer"><a class="header" href="#file-transfer">File Transfer</a></h3>
<pre><code class="language-javascript">class FileTransfer {
  constructor(dataChannel) {
    this.channel = dataChannel;
    this.chunkSize = 16384; // 16 KB chunks
  }

  async sendFile(file) {
    const arrayBuffer = await file.arrayBuffer();
    const totalChunks = Math.ceil(arrayBuffer.byteLength / this.chunkSize);

    // Send metadata
    this.channel.send(JSON.stringify({
      type: 'file-start',
      name: file.name,
      size: file.size,
      totalChunks: totalChunks
    }));

    // Send chunks
    for (let i = 0; i &lt; totalChunks; i++) {
      const start = i * this.chunkSize;
      const end = Math.min(start + this.chunkSize, arrayBuffer.byteLength);
      const chunk = arrayBuffer.slice(start, end);

      // Wait if buffer is filling up
      while (this.channel.bufferedAmount &gt; this.chunkSize * 10) {
        await new Promise(resolve =&gt; setTimeout(resolve, 10));
      }

      this.channel.send(chunk);

      // Progress update
      const progress = ((i + 1) / totalChunks * 100).toFixed(1);
      console.log(`Sending: ${progress}%`);
    }

    // Send completion
    this.channel.send(JSON.stringify({ type: 'file-end' }));
  }

  receiveFile(onProgress, onComplete) {
    const chunks = [];
    let metadata = null;

    this.channel.onmessage = (event) =&gt; {
      if (typeof event.data === 'string') {
        const message = JSON.parse(event.data);

        if (message.type === 'file-start') {
          metadata = message;
          chunks.length = 0;
        } else if (message.type === 'file-end') {
          const blob = new Blob(chunks);
          onComplete(blob, metadata);
        }
      } else {
        // Binary chunk
        chunks.push(event.data);

        if (metadata) {
          const progress = (chunks.length / metadata.totalChunks * 100)
            .toFixed(1);
          onProgress(progress);
        }
      }
    };
  }
}

// Usage
const fileTransfer = new FileTransfer(dataChannel);

// Sender
document.getElementById('fileInput').onchange = async (e) =&gt; {
  const file = e.target.files[0];
  await fileTransfer.sendFile(file);
};

// Receiver
fileTransfer.receiveFile(
  (progress) =&gt; console.log(`Receiving: ${progress}%`),
  (blob, metadata) =&gt; {
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = metadata.name;
    a.click();
  }
);
</code></pre>
<h3 id="gamingreal-time-data"><a class="header" href="#gamingreal-time-data">Gaming/Real-time Data</a></h3>
<pre><code class="language-javascript">class GameDataChannel {
  constructor(dataChannel) {
    this.channel = dataChannel;
    this.channel.binaryType = 'arraybuffer';

    // Unreliable, unordered for low latency
    this.channel = peerConnection.createDataChannel('game', {
      ordered: false,
      maxRetransmits: 0
    });
  }

  sendPlayerPosition(x, y, angle) {
    const buffer = new ArrayBuffer(12);
    const view = new DataView(buffer);

    view.setFloat32(0, x, true);
    view.setFloat32(4, y, true);
    view.setFloat32(8, angle, true);

    this.channel.send(buffer);
  }

  onPlayerPosition(callback) {
    this.channel.onmessage = (event) =&gt; {
      const view = new DataView(event.data);

      const x = view.getFloat32(0, true);
      const y = view.getFloat32(4, true);
      const angle = view.getFloat32(8, true);

      callback(x, y, angle);
    };
  }
}

// Usage
const gameChannel = new GameDataChannel(dataChannel);

// Send position 60 times per second
setInterval(() =&gt; {
  gameChannel.sendPlayerPosition(
    player.x,
    player.y,
    player.angle
  );
}, 1000 / 60);

gameChannel.onPlayerPosition((x, y, angle) =&gt; {
  updateRemotePlayer(x, y, angle);
});
</code></pre>
<h2 id="security-considerations-7"><a class="header" href="#security-considerations-7">Security Considerations</a></h2>
<h3 id="encryption-3"><a class="header" href="#encryption-3">Encryption</a></h3>
<pre><code>WebRTC Security Stack:

Application Data
       ↓
SRTP (Secure RTP)
  - Encrypts media (audio/video)
  - AES encryption
  - HMAC authentication
       ↓
DTLS (Datagram TLS)
  - Encrypts data channels
  - Key exchange for SRTP
  - Certificate verification
       ↓
UDP/TCP Transport

All WebRTC traffic is encrypted!
No option for unencrypted communication.
</code></pre>
<h3 id="certificate-verification"><a class="header" href="#certificate-verification">Certificate Verification</a></h3>
<pre><code class="language-javascript">// Verify peer certificate fingerprint
peerConnection.onicecandidate = (event) =&gt; {
  if (event.candidate === null) {
    // Get local certificate
    peerConnection.getConfiguration().certificates.forEach(cert =&gt; {
      cert.getFingerprints().forEach(fingerprint =&gt; {
        console.log('Local fingerprint:', fingerprint);
        // Send to peer via secure signaling
        // Peer should verify this matches SDP
      });
    });
  }
};

// Check SDP fingerprint matches expected
function verifySdpFingerprint(sdp, expectedFingerprint) {
  const fingerprintMatch = sdp.match(/a=fingerprint:(\S+) (\S+)/);
  if (!fingerprintMatch) {
    throw new Error('No fingerprint in SDP');
  }

  const [, algorithm, fingerprint] = fingerprintMatch;

  if (fingerprint !== expectedFingerprint) {
    throw new Error('Fingerprint mismatch! Possible MITM attack.');
  }

  return true;
}
</code></pre>
<h3 id="best-practices-72"><a class="header" href="#best-practices-72">Best Practices</a></h3>
<pre><code>1. Secure Signaling
   - Use TLS/WSS for signaling
   - Authenticate users
   - Verify peer identity

2. Certificate Pinning
   - Verify SDP fingerprints
   - Out-of-band verification if possible

3. Access Control
   - Verify room/session authorization
   - Implement user authentication
   - Rate limiting

4. Media Permissions
   - Request minimal permissions
   - Explain why access is needed
   - Allow users to deny

5. Privacy
   - Minimize data collection
   - No recording without consent
   - Clear privacy policy

6. Network Security
   - Use TURN with authentication
   - Restrict TURN access
   - Monitor for abuse
</code></pre>
<h2 id="debugging-and-troubleshooting"><a class="header" href="#debugging-and-troubleshooting">Debugging and Troubleshooting</a></h2>
<h3 id="enable-debug-logs"><a class="header" href="#enable-debug-logs">Enable Debug Logs</a></h3>
<pre><code class="language-javascript">// Chrome: Enable WebRTC internals
// Navigate to: chrome://webrtc-internals

// Firefox: Enable logging
// Navigate to: about:webrtc

// Console logging
peerConnection.addEventListener('track', e =&gt; {
  console.log('Track event:', e);
});

peerConnection.addEventListener('icecandidate', e =&gt; {
  console.log('ICE candidate:', e.candidate);
});

peerConnection.addEventListener('icecandidateerror', e =&gt; {
  console.error('ICE candidate error:', e);
});

peerConnection.addEventListener('connectionstatechange', e =&gt; {
  console.log('Connection state:', peerConnection.connectionState);
});

peerConnection.addEventListener('iceconnectionstatechange', e =&gt; {
  console.log('ICE connection state:',
    peerConnection.iceConnectionState);
});
</code></pre>
<h3 id="get-detailed-statistics"><a class="header" href="#get-detailed-statistics">Get Detailed Statistics</a></h3>
<pre><code class="language-javascript">async function getDetailedStats(peerConnection) {
  const stats = await peerConnection.getStats();
  const report = {};

  stats.forEach(stat =&gt; {
    if (stat.type === 'inbound-rtp' &amp;&amp; stat.kind === 'video') {
      report.video = {
        bytesReceived: stat.bytesReceived,
        packetsReceived: stat.packetsReceived,
        packetsLost: stat.packetsLost,
        jitter: stat.jitter,
        frameWidth: stat.frameWidth,
        frameHeight: stat.frameHeight,
        framesPerSecond: stat.framesPerSecond,
        framesDecoded: stat.framesDecoded,
        framesDropped: stat.framesDropped
      };
    }

    if (stat.type === 'inbound-rtp' &amp;&amp; stat.kind === 'audio') {
      report.audio = {
        bytesReceived: stat.bytesReceived,
        packetsReceived: stat.packetsReceived,
        packetsLost: stat.packetsLost,
        jitter: stat.jitter,
        audioLevel: stat.audioLevel
      };
    }

    if (stat.type === 'candidate-pair' &amp;&amp; stat.state === 'succeeded') {
      report.connection = {
        localCandidateType: stat.localCandidateType,
        remoteCandidateType: stat.remoteCandidateType,
        currentRoundTripTime: stat.currentRoundTripTime,
        availableOutgoingBitrate: stat.availableOutgoingBitrate,
        bytesReceived: stat.bytesReceived,
        bytesSent: stat.bytesSent
      };
    }
  });

  return report;
}

// Monitor every second
setInterval(async () =&gt; {
  const stats = await getDetailedStats(peerConnection);
  console.table(stats);
}, 1000);
</code></pre>
<h3 id="common-issues-and-solutions"><a class="header" href="#common-issues-and-solutions">Common Issues and Solutions</a></h3>
<pre><code>Issue: ICE connection fails
Solutions:
- Check STUN/TURN server configuration
- Verify firewall allows UDP traffic
- Add TURN server as fallback
- Check ICE candidate gathering

Issue: No video/audio
Solutions:
- Verify getUserMedia constraints
- Check browser permissions
- Verify tracks added to peer connection
- Check ontrack event handler

Issue: One-way audio/video
Solutions:
- Verify both peers add tracks
- Check SDP offer/answer exchange
- Verify both peers handle ontrack
- Check NAT/firewall rules

Issue: Poor quality
Solutions:
- Reduce resolution/bitrate
- Enable simulcast
- Check network bandwidth
- Monitor packet loss
- Verify codec support

Issue: High latency
Solutions:
- Use TURN server closer to users
- Enable unreliable data channels for gaming
- Reduce buffering
- Optimize codec settings
</code></pre>
<h2 id="browser-support"><a class="header" href="#browser-support">Browser Support</a></h2>
<pre><code>Desktop Browsers:
✓ Chrome 23+
✓ Firefox 22+
✓ Safari 11+
✓ Edge 79+ (Chromium-based)
✓ Opera 18+

Mobile Browsers:
✓ Chrome Android 28+
✓ Firefox Android 24+
✓ Safari iOS 11+
✓ Samsung Internet 4+

Feature Support:
- getUserMedia: All modern browsers
- RTCPeerConnection: All modern browsers
- RTCDataChannel: All modern browsers
- Screen sharing: Desktop only (most browsers)
- VP9 codec: Chrome, Firefox, Edge
- H.264 codec: All browsers (licensing)

Check: https://caniuse.com/rtcpeerconnection
</code></pre>
<h2 id="performance-optimization-3"><a class="header" href="#performance-optimization-3">Performance Optimization</a></h2>
<h3 id="tips-for-better-performance"><a class="header" href="#tips-for-better-performance">Tips for Better Performance</a></h3>
<pre><code class="language-javascript">// 1. Reuse peer connections
const peerConnections = new Map();

function getOrCreatePeerConnection(peerId) {
  if (!peerConnections.has(peerId)) {
    peerConnections.set(peerId, createPeerConnection());
  }
  return peerConnections.get(peerId);
}

// 2. Batch ICE candidates (trickle ICE)
const pendingCandidates = [];

peerConnection.onicecandidate = (event) =&gt; {
  if (event.candidate) {
    pendingCandidates.push(event.candidate);

    // Send in batches
    if (pendingCandidates.length &gt;= 5) {
      signaling.send({
        type: 'ice-candidates',
        candidates: pendingCandidates.splice(0)
      });
    }
  }
};

// 3. Use efficient codecs
// VP9 or H.264 for video, Opus for audio

// 4. Enable hardware acceleration
// Automatic in most browsers

// 5. Limit resolution based on network
async function adaptToNetwork(peerConnection) {
  const stats = await peerConnection.getStats();
  // Analyze and adjust bitrate/resolution
}

// 6. Use object fit for video elements
&lt;video style="object-fit: cover;" /&gt;

// 7. Clean up resources
function cleanup() {
  localStream?.getTracks().forEach(track =&gt; track.stop());
  peerConnection?.close();
  dataChannel?.close();
}
</code></pre>
<h2 id="eli10-webrtc-explained-simply"><a class="header" href="#eli10-webrtc-explained-simply">ELI10: WebRTC Explained Simply</a></h2>
<p>WebRTC lets browsers talk directly to each other without a server in the middle:</p>
<h3 id="traditional-communication"><a class="header" href="#traditional-communication">Traditional Communication</a></h3>
<pre><code>Your Browser → Server → Friend's Browser
- Everything goes through server
- Server sees all your data
- Costs more (server bandwidth)
- Higher latency
</code></pre>
<h3 id="webrtc-communication"><a class="header" href="#webrtc-communication">WebRTC Communication</a></h3>
<pre><code>Your Browser ←→ Friend's Browser
- Direct connection (peer-to-peer)
- Server only introduces you
- Private (server can't see)
- Faster (no middleman)
</code></pre>
<h3 id="the-process"><a class="header" href="#the-process">The Process</a></h3>
<pre><code>1. Get Permission
   "Can I use your camera and microphone?"

2. Signaling (Meeting)
   Server: "Hey Browser A, meet Browser B"
   Exchange: "Here's how to reach me"

3. ICE/STUN (Finding the Path)
   "What's my public address?"
   "Can we connect directly?"

4. Connection!
   Direct video/audio/data
   Encrypted automatically

5. If Direct Fails
   TURN server relays traffic
   Still encrypted
</code></pre>
<h3 id="real-world-analogy"><a class="header" href="#real-world-analogy">Real-World Analogy</a></h3>
<pre><code>Traditional: Passing notes through teacher
WebRTC: Sitting next to friend and talking
Signaling: Teacher introduces you
STUN: Finding where each person sits
TURN: Using walkie-talkies if too far
</code></pre>
<h2 id="further-resources-39"><a class="header" href="#further-resources-39">Further Resources</a></h2>
<h3 id="documentation-6"><a class="header" href="#documentation-6">Documentation</a></h3>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebRTC_API">MDN WebRTC API</a></li>
<li><a href="https://www.w3.org/TR/webrtc/">WebRTC Specification</a></li>
<li><a href="https://webrtc.github.io/samples/">WebRTC Samples</a></li>
</ul>
<h3 id="tools-14"><a class="header" href="#tools-14">Tools</a></h3>
<ul>
<li><a href="chrome://webrtc-internals">chrome://webrtc-internals</a> - Chrome debugging</li>
<li><a href="about:webrtc">about:webrtc</a> - Firefox debugging</li>
<li><a href="https://test.webrtc.org/">WebRTC Troubleshooter</a></li>
</ul>
<h3 id="libraries-2"><a class="header" href="#libraries-2">Libraries</a></h3>
<ul>
<li><a href="https://simplewebrtc.com/">SimpleWebRTC</a> - Simplified WebRTC</li>
<li><a href="https://peerjs.com/">PeerJS</a> - Easy peer-to-peer</li>
<li><a href="https://janus.conf.meetecho.com/">Janus Gateway</a> - WebRTC server</li>
<li><a href="https://www.kurento.org/">Kurento</a> - Media server</li>
</ul>
<h3 id="testing-5"><a class="header" href="#testing-5">Testing</a></h3>
<ul>
<li><a href="https://networktest.twilio.com/">WebRTC Network Tester</a></li>
<li><a href="https://webrtc.github.io/samples/src/content/peerconnection/trickle-ice/">STUN/TURN Server Test</a></li>
</ul>
<h3 id="books-5"><a class="header" href="#books-5">Books</a></h3>
<ul>
<li><em>Real-Time Communication with WebRTC</em> by Salvatore Loreto</li>
<li><em>WebRTC Cookbook</em> by Andrii Sergiienko</li>
<li><em>High Performance Browser Networking</em> by Ilya Grigorik</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="finance"><a class="header" href="#finance">Finance</a></h1>
<h2 id="overview-90"><a class="header" href="#overview-90">Overview</a></h2>
<p>Finance is the management of money, investments, and other financial instruments. This guide covers various aspects of financial markets, investment strategies, and trading concepts essential for understanding modern finance and making informed investment decisions.</p>
<h2 id="what-is-finance"><a class="header" href="#what-is-finance">What is Finance?</a></h2>
<p>Finance encompasses the creation, management, and study of money, banking, credit, investments, assets, and liabilities. It involves:</p>
<ul>
<li><strong>Personal Finance</strong>: Managing individual/household money</li>
<li><strong>Corporate Finance</strong>: Managing business finances</li>
<li><strong>Public Finance</strong>: Government revenue and expenditure</li>
<li><strong>Investment Finance</strong>: Growing wealth through financial instruments</li>
</ul>
<h2 id="financial-markets"><a class="header" href="#financial-markets">Financial Markets</a></h2>
<h3 id="market-types"><a class="header" href="#market-types">Market Types</a></h3>
<ol>
<li><strong>Stock Market</strong>: Equity securities (shares of companies)</li>
<li><strong>Bond Market</strong>: Debt securities (loans to companies/governments)</li>
<li><strong>Commodity Market</strong>: Physical goods (gold, oil, agricultural products)</li>
<li><strong>Forex Market</strong>: Currency exchange</li>
<li><strong>Derivatives Market</strong>: Contracts based on underlying assets</li>
</ol>
<h3 id="market-participants"><a class="header" href="#market-participants">Market Participants</a></h3>
<ul>
<li><strong>Retail Investors</strong>: Individual investors</li>
<li><strong>Institutional Investors</strong>: Banks, hedge funds, pension funds</li>
<li><strong>Market Makers</strong>: Provide liquidity</li>
<li><strong>Brokers</strong>: Execute trades on behalf of clients</li>
<li><strong>Regulators</strong>: Ensure fair and orderly markets</li>
</ul>
<h2 id="investment-instruments"><a class="header" href="#investment-instruments">Investment Instruments</a></h2>
<h3 id="1-stocks-equities"><a class="header" href="#1-stocks-equities">1. Stocks (Equities)</a></h3>
<p>Ownership shares in a company.</p>
<p><strong>Types:</strong></p>
<ul>
<li><strong>Common Stock</strong>: Voting rights, dividends</li>
<li><strong>Preferred Stock</strong>: Fixed dividends, priority over common</li>
</ul>
<p><strong>Metrics:</strong></p>
<ul>
<li><strong>Price-to-Earnings (P/E) Ratio</strong>: Stock price / Earnings per share</li>
<li><strong>Dividend Yield</strong>: Annual dividend / Stock price</li>
<li><strong>Market Capitalization</strong>: Share price × Shares outstanding</li>
</ul>
<pre><code class="language-python"># Calculate basic stock metrics
def calculate_pe_ratio(price, earnings_per_share):
    """Price-to-Earnings Ratio"""
    return price / earnings_per_share

def calculate_dividend_yield(annual_dividend, stock_price):
    """Dividend Yield as percentage"""
    return (annual_dividend / stock_price) * 100

def calculate_market_cap(price, shares_outstanding):
    """Market Capitalization"""
    return price * shares_outstanding

# Example
stock_price = 150.00
eps = 10.00
annual_dividend = 3.00
shares = 1_000_000_000

pe_ratio = calculate_pe_ratio(stock_price, eps)
dividend_yield = calculate_dividend_yield(annual_dividend, stock_price)
market_cap = calculate_market_cap(stock_price, shares)

print(f"P/E Ratio: {pe_ratio:.2f}")
print(f"Dividend Yield: {dividend_yield:.2f}%")
print(f"Market Cap: ${market_cap:,.0f}")
</code></pre>
<p>See: <a href="finance/stocks.html">Stocks Guide</a></p>
<h3 id="2-options"><a class="header" href="#2-options">2. Options</a></h3>
<p>Contracts giving the right (not obligation) to buy/sell at a specific price.</p>
<p><strong>Types:</strong></p>
<ul>
<li><strong>Call Option</strong>: Right to buy</li>
<li><strong>Put Option</strong>: Right to sell</li>
</ul>
<p><strong>Key Terms:</strong></p>
<ul>
<li><strong>Strike Price</strong>: Exercise price</li>
<li><strong>Premium</strong>: Option cost</li>
<li><strong>Expiration Date</strong>: Contract end date</li>
<li><strong>In-the-Money (ITM)</strong>: Profitable to exercise</li>
<li><strong>Out-of-the-Money (OTM)</strong>: Not profitable to exercise</li>
<li><strong>At-the-Money (ATM)</strong>: Strike ≈ Current price</li>
</ul>
<p><strong>Greeks:</strong></p>
<ul>
<li><strong>Delta</strong>: Price sensitivity to underlying</li>
<li><strong>Gamma</strong>: Rate of delta change</li>
<li><strong>Theta</strong>: Time decay</li>
<li><strong>Vega</strong>: Volatility sensitivity</li>
<li><strong>Rho</strong>: Interest rate sensitivity</li>
</ul>
<p>See: <a href="finance/options.html">Options Trading</a></p>
<h3 id="3-futures"><a class="header" href="#3-futures">3. Futures</a></h3>
<p>Obligatory contracts to buy/sell at a future date and price.</p>
<p><strong>Characteristics:</strong></p>
<ul>
<li>Standardized contracts</li>
<li>Exchange-traded</li>
<li>Margin requirements</li>
<li>Daily settlement</li>
</ul>
<p><strong>Uses:</strong></p>
<ul>
<li>Hedging risk</li>
<li>Speculation</li>
<li>Price discovery</li>
</ul>
<p><strong>Common Futures:</strong></p>
<ul>
<li>Equity index futures (S&amp;P 500, NASDAQ)</li>
<li>Commodity futures (oil, gold, corn)</li>
<li>Currency futures</li>
<li>Interest rate futures</li>
</ul>
<p>See: <a href="finance/futures.html">Futures Trading</a></p>
<h3 id="4-cryptocurrencies"><a class="header" href="#4-cryptocurrencies">4. Cryptocurrencies</a></h3>
<p>Digital or virtual currencies using cryptography.</p>
<p><strong>Popular Cryptocurrencies:</strong></p>
<ul>
<li><strong>Bitcoin (BTC)</strong>: First cryptocurrency</li>
<li><strong>Ethereum (ETH)</strong>: Smart contract platform</li>
<li><strong>Altcoins</strong>: Alternative cryptocurrencies</li>
</ul>
<p><strong>Key Concepts:</strong></p>
<ul>
<li><strong>Blockchain</strong>: Distributed ledger technology</li>
<li><strong>Mining</strong>: Transaction verification process</li>
<li><strong>Wallet</strong>: Storage for private keys</li>
<li><strong>Exchange</strong>: Platform for trading crypto</li>
</ul>
<p>See: <a href="finance/crypto.html">Cryptocurrency Guide</a></p>
<h2 id="investment-strategies"><a class="header" href="#investment-strategies">Investment Strategies</a></h2>
<h3 id="value-investing"><a class="header" href="#value-investing">Value Investing</a></h3>
<p>Buy undervalued securities based on fundamental analysis.</p>
<p><strong>Key Principles:</strong></p>
<ul>
<li>Focus on intrinsic value</li>
<li>Margin of safety</li>
<li>Long-term perspective</li>
<li>Fundamental analysis</li>
</ul>
<p><strong>Metrics:</strong></p>
<ul>
<li>P/E ratio</li>
<li>Price-to-Book (P/B) ratio</li>
<li>Debt-to-Equity ratio</li>
<li>Free cash flow</li>
</ul>
<h3 id="growth-investing"><a class="header" href="#growth-investing">Growth Investing</a></h3>
<p>Invest in companies with high growth potential.</p>
<p><strong>Characteristics:</strong></p>
<ul>
<li>High P/E ratios</li>
<li>Revenue growth</li>
<li>Market expansion</li>
<li>Innovation focus</li>
</ul>
<h3 id="dividend-investing"><a class="header" href="#dividend-investing">Dividend Investing</a></h3>
<p>Focus on stocks paying regular dividends.</p>
<p><strong>Benefits:</strong></p>
<ul>
<li>Steady income stream</li>
<li>Lower volatility</li>
<li>Compound growth</li>
</ul>
<p><strong>Metrics:</strong></p>
<ul>
<li>Dividend yield</li>
<li>Payout ratio</li>
<li>Dividend growth rate</li>
</ul>
<h3 id="index-investing"><a class="header" href="#index-investing">Index Investing</a></h3>
<p>Track market indices through index funds/ETFs.</p>
<p><strong>Advantages:</strong></p>
<ul>
<li>Diversification</li>
<li>Low fees</li>
<li>Passive management</li>
<li>Market returns</li>
</ul>
<p><strong>Popular Indices:</strong></p>
<ul>
<li>S&amp;P 500</li>
<li>NASDAQ-100</li>
<li>Dow Jones Industrial Average</li>
<li>Russell 2000</li>
</ul>
<h2 id="analysis-methods"><a class="header" href="#analysis-methods">Analysis Methods</a></h2>
<h3 id="fundamental-analysis"><a class="header" href="#fundamental-analysis">Fundamental Analysis</a></h3>
<p>Evaluate intrinsic value through financial statements.</p>
<p><strong>Financial Statements:</strong></p>
<ol>
<li><strong>Income Statement</strong>: Revenue, expenses, profit</li>
<li><strong>Balance Sheet</strong>: Assets, liabilities, equity</li>
<li><strong>Cash Flow Statement</strong>: Operating, investing, financing cash flows</li>
</ol>
<p><strong>Key Ratios:</strong></p>
<pre><code class="language-python"># Profitability Ratios
def gross_margin(revenue, cogs):
    return ((revenue - cogs) / revenue) * 100

def net_profit_margin(net_income, revenue):
    return (net_income / revenue) * 100

def return_on_equity(net_income, shareholders_equity):
    return (net_income / shareholders_equity) * 100

# Liquidity Ratios
def current_ratio(current_assets, current_liabilities):
    return current_assets / current_liabilities

def quick_ratio(current_assets, inventory, current_liabilities):
    return (current_assets - inventory) / current_liabilities

# Leverage Ratios
def debt_to_equity(total_debt, total_equity):
    return total_debt / total_equity

def interest_coverage(ebit, interest_expense):
    return ebit / interest_expense

# Efficiency Ratios
def asset_turnover(revenue, total_assets):
    return revenue / total_assets

def inventory_turnover(cogs, average_inventory):
    return cogs / average_inventory
</code></pre>
<p>See: <a href="finance/fundamental_analysis.html">Fundamental Analysis</a></p>
<h3 id="technical-analysis"><a class="header" href="#technical-analysis">Technical Analysis</a></h3>
<p>Analyze price patterns and trends using charts.</p>
<p><strong>Common Indicators:</strong></p>
<ul>
<li><strong>Moving Averages</strong>: Simple (SMA), Exponential (EMA)</li>
<li><strong>RSI</strong>: Relative Strength Index (overbought/oversold)</li>
<li><strong>MACD</strong>: Moving Average Convergence Divergence</li>
<li><strong>Bollinger Bands</strong>: Volatility indicator</li>
<li><strong>Volume</strong>: Trading activity</li>
</ul>
<pre><code class="language-python">import pandas as pd
import numpy as np

def simple_moving_average(prices, period):
    """Calculate SMA"""
    return prices.rolling(window=period).mean()

def exponential_moving_average(prices, period):
    """Calculate EMA"""
    return prices.ewm(span=period, adjust=False).mean()

def relative_strength_index(prices, period=14):
    """Calculate RSI"""
    delta = prices.diff()
    gain = (delta.where(delta &gt; 0, 0)).rolling(window=period).mean()
    loss = (-delta.where(delta &lt; 0, 0)).rolling(window=period).mean()
    rs = gain / loss
    rsi = 100 - (100 / (1 + rs))
    return rsi

def bollinger_bands(prices, period=20, std_dev=2):
    """Calculate Bollinger Bands"""
    sma = simple_moving_average(prices, period)
    std = prices.rolling(window=period).std()
    upper_band = sma + (std * std_dev)
    lower_band = sma - (std * std_dev)
    return upper_band, sma, lower_band

def macd(prices, fast=12, slow=26, signal=9):
    """Calculate MACD"""
    ema_fast = exponential_moving_average(prices, fast)
    ema_slow = exponential_moving_average(prices, slow)
    macd_line = ema_fast - ema_slow
    signal_line = macd_line.ewm(span=signal, adjust=False).mean()
    histogram = macd_line - signal_line
    return macd_line, signal_line, histogram
</code></pre>
<p>See: <a href="finance/technical_analysis.html">Technical Analysis</a></p>
<h2 id="risk-management"><a class="header" href="#risk-management">Risk Management</a></h2>
<h3 id="portfolio-diversification"><a class="header" href="#portfolio-diversification">Portfolio Diversification</a></h3>
<p>Don't put all eggs in one basket.</p>
<p><strong>Diversification Strategies:</strong></p>
<ul>
<li>Across asset classes (stocks, bonds, real estate)</li>
<li>Across sectors (tech, healthcare, finance)</li>
<li>Across geographies (domestic, international)</li>
<li>Across market caps (large, mid, small)</li>
</ul>
<h3 id="position-sizing"><a class="header" href="#position-sizing">Position Sizing</a></h3>
<p>Determine how much to invest in each position.</p>
<pre><code class="language-python">def position_size_fixed_dollar(account_balance, risk_per_trade):
    """Fixed dollar amount per trade"""
    return risk_per_trade

def position_size_percentage(account_balance, risk_percentage):
    """Percentage of account balance"""
    return account_balance * (risk_percentage / 100)

def position_size_volatility(account_balance, risk_percentage, entry_price, stop_loss):
    """Based on volatility and stop loss"""
    risk_per_share = abs(entry_price - stop_loss)
    total_risk = account_balance * (risk_percentage / 100)
    shares = total_risk / risk_per_share
    return int(shares)

# Example
account = 100000
risk_pct = 2  # 2% risk per trade
entry = 150
stop = 145

shares = position_size_volatility(account, risk_pct, entry, stop)
print(f"Buy {shares} shares at ${entry} with stop at ${stop}")
</code></pre>
<h3 id="stop-loss-orders"><a class="header" href="#stop-loss-orders">Stop Loss Orders</a></h3>
<p>Automatic sell orders to limit losses.</p>
<p><strong>Types:</strong></p>
<ul>
<li><strong>Fixed Stop</strong>: Specific price level</li>
<li><strong>Trailing Stop</strong>: Adjusts with price movement</li>
<li><strong>Percentage Stop</strong>: Based on percentage decline</li>
</ul>
<pre><code class="language-python">def calculate_stop_loss(entry_price, stop_percentage, position_type='long'):
    """Calculate stop loss price"""
    if position_type == 'long':
        return entry_price * (1 - stop_percentage / 100)
    else:  # short
        return entry_price * (1 + stop_percentage / 100)

def calculate_take_profit(entry_price, risk_reward_ratio, stop_loss, position_type='long'):
    """Calculate take profit based on risk/reward ratio"""
    risk = abs(entry_price - stop_loss)
    reward = risk * risk_reward_ratio
    
    if position_type == 'long':
        return entry_price + reward
    else:  # short
        return entry_price - reward

# Example: 2:1 risk/reward ratio
entry = 100
stop_pct = 5
rr_ratio = 2

stop = calculate_stop_loss(entry, stop_pct, 'long')
target = calculate_take_profit(entry, rr_ratio, stop, 'long')

print(f"Entry: ${entry}")
print(f"Stop Loss: ${stop:.2f}")
print(f"Take Profit: ${target:.2f}")
print(f"Risk: ${entry - stop:.2f}")
print(f"Reward: ${target - entry:.2f}")
</code></pre>
<h2 id="performance-metrics"><a class="header" href="#performance-metrics">Performance Metrics</a></h2>
<h3 id="returns"><a class="header" href="#returns">Returns</a></h3>
<pre><code class="language-python">def simple_return(start_value, end_value):
    """Simple return percentage"""
    return ((end_value - start_value) / start_value) * 100

def compound_annual_growth_rate(start_value, end_value, years):
    """CAGR"""
    return (((end_value / start_value) ** (1 / years)) - 1) * 100

def total_return(initial_investment, final_value, dividends):
    """Total return including dividends"""
    return ((final_value + dividends - initial_investment) / initial_investment) * 100
</code></pre>
<h3 id="risk-metrics"><a class="header" href="#risk-metrics">Risk Metrics</a></h3>
<pre><code class="language-python">import numpy as np

def volatility(returns):
    """Standard deviation of returns (annualized)"""
    return np.std(returns) * np.sqrt(252)  # 252 trading days

def sharpe_ratio(returns, risk_free_rate=0.02):
    """Risk-adjusted return"""
    excess_returns = returns - risk_free_rate / 252
    return np.mean(excess_returns) / np.std(excess_returns) * np.sqrt(252)

def maximum_drawdown(prices):
    """Maximum peak-to-trough decline"""
    cummax = np.maximum.accumulate(prices)
    drawdown = (prices - cummax) / cummax
    return np.min(drawdown) * 100

def beta(asset_returns, market_returns):
    """Measure of volatility relative to market"""
    covariance = np.cov(asset_returns, market_returns)[0][1]
    market_variance = np.var(market_returns)
    return covariance / market_variance
</code></pre>
<h2 id="trading-psychology"><a class="header" href="#trading-psychology">Trading Psychology</a></h2>
<h3 id="emotional-discipline"><a class="header" href="#emotional-discipline">Emotional Discipline</a></h3>
<p><strong>Common Pitfalls:</strong></p>
<ul>
<li><strong>Fear of Missing Out (FOMO)</strong>: Chasing rallies</li>
<li><strong>Loss Aversion</strong>: Holding losers too long</li>
<li><strong>Overconfidence</strong>: Taking excessive risk</li>
<li><strong>Confirmation Bias</strong>: Seeking supporting evidence only</li>
<li><strong>Anchoring</strong>: Fixating on specific price points</li>
</ul>
<p><strong>Best Practices:</strong></p>
<ul>
<li>Follow your trading plan</li>
<li>Keep emotions in check</li>
<li>Accept losses gracefully</li>
<li>Don't overtrade</li>
<li>Take breaks when needed</li>
</ul>
<h3 id="trading-plan"><a class="header" href="#trading-plan">Trading Plan</a></h3>
<p>Essential components:</p>
<ol>
<li><strong>Entry Criteria</strong>: When to buy</li>
<li><strong>Exit Criteria</strong>: When to sell (profit and loss)</li>
<li><strong>Position Sizing</strong>: How much to invest</li>
<li><strong>Risk Management</strong>: Stop loss levels</li>
<li><strong>Record Keeping</strong>: Track all trades</li>
</ol>
<h2 id="financial-calculations"><a class="header" href="#financial-calculations">Financial Calculations</a></h2>
<h3 id="time-value-of-money"><a class="header" href="#time-value-of-money">Time Value of Money</a></h3>
<pre><code class="language-python">def future_value(present_value, rate, periods):
    """FV = PV × (1 + r)^n"""
    return present_value * (1 + rate) ** periods

def present_value(future_value, rate, periods):
    """PV = FV / (1 + r)^n"""
    return future_value / (1 + rate) ** periods

def compound_interest(principal, rate, periods, compounds_per_period=1):
    """Compound interest formula"""
    return principal * (1 + rate / compounds_per_period) ** (periods * compounds_per_period)

# Example: $10,000 invested for 10 years at 7% annual return
principal = 10000
rate = 0.07
years = 10

fv = future_value(principal, rate, years)
print(f"${principal:,.2f} grows to ${fv:,.2f} in {years} years")
</code></pre>
<h3 id="annuities"><a class="header" href="#annuities">Annuities</a></h3>
<pre><code class="language-python">def future_value_annuity(payment, rate, periods):
    """FV of regular payments"""
    return payment * (((1 + rate) ** periods - 1) / rate)

def present_value_annuity(payment, rate, periods):
    """PV of regular payments"""
    return payment * ((1 - (1 + rate) ** -periods) / rate)

def loan_payment(principal, rate, periods):
    """Calculate loan payment"""
    return principal * (rate * (1 + rate) ** periods) / ((1 + rate) ** periods - 1)

# Example: Mortgage calculation
loan_amount = 300000
annual_rate = 0.04
years = 30
monthly_rate = annual_rate / 12
months = years * 12

monthly_payment = loan_payment(loan_amount, monthly_rate, months)
total_paid = monthly_payment * months
total_interest = total_paid - loan_amount

print(f"Monthly Payment: ${monthly_payment:,.2f}")
print(f"Total Interest: ${total_interest:,.2f}")
</code></pre>
<h2 id="investment-accounts"><a class="header" href="#investment-accounts">Investment Accounts</a></h2>
<h3 id="account-types"><a class="header" href="#account-types">Account Types</a></h3>
<p><strong>Taxable Accounts:</strong></p>
<ul>
<li>Individual brokerage accounts</li>
<li>Joint accounts</li>
<li>Margin accounts</li>
</ul>
<p><strong>Tax-Advantaged (US):</strong></p>
<ul>
<li><strong>401(k)</strong>: Employer-sponsored retirement</li>
<li><strong>IRA</strong>: Individual Retirement Account</li>
<li><strong>Roth IRA</strong>: Tax-free growth and withdrawals</li>
<li><strong>HSA</strong>: Health Savings Account</li>
</ul>
<h3 id="fees-and-costs"><a class="header" href="#fees-and-costs">Fees and Costs</a></h3>
<ul>
<li><strong>Expense Ratios</strong>: Mutual fund/ETF annual fees</li>
<li><strong>Trading Commissions</strong>: Per-trade fees</li>
<li><strong>Management Fees</strong>: Advisory fees</li>
<li><strong>Tax Implications</strong>: Capital gains, dividends</li>
</ul>
<h2 id="market-orders"><a class="header" href="#market-orders">Market Orders</a></h2>
<h3 id="order-types"><a class="header" href="#order-types">Order Types</a></h3>
<pre><code class="language-python"># Common order types

class Order:
    """Order examples"""
    
    @staticmethod
    def market_order():
        """Execute at current market price"""
        return {
            "type": "market",
            "execution": "immediate",
            "price": "current market price"
        }
    
    @staticmethod
    def limit_order(limit_price):
        """Execute at specific price or better"""
        return {
            "type": "limit",
            "limit_price": limit_price,
            "execution": "when price reaches limit"
        }
    
    @staticmethod
    def stop_loss_order(stop_price):
        """Sell when price falls to stop level"""
        return {
            "type": "stop_loss",
            "stop_price": stop_price,
            "execution": "when price hits stop"
        }
    
    @staticmethod
    def stop_limit_order(stop_price, limit_price):
        """Combines stop and limit orders"""
        return {
            "type": "stop_limit",
            "stop_price": stop_price,
            "limit_price": limit_price,
            "execution": "limit order triggered at stop"
        }
</code></pre>
<h3 id="order-duration"><a class="header" href="#order-duration">Order Duration</a></h3>
<ul>
<li><strong>Day Order</strong>: Expires at end of trading day</li>
<li><strong>Good Till Canceled (GTC)</strong>: Active until executed or canceled</li>
<li><strong>Fill or Kill (FOK)</strong>: Execute immediately in full or cancel</li>
<li><strong>Immediate or Cancel (IOC)</strong>: Execute immediately, cancel remainder</li>
</ul>
<h2 id="resources-and-tools"><a class="header" href="#resources-and-tools">Resources and Tools</a></h2>
<h3 id="financial-data-sources"><a class="header" href="#financial-data-sources">Financial Data Sources</a></h3>
<ul>
<li>Yahoo Finance</li>
<li>Bloomberg Terminal</li>
<li>TradingView</li>
<li>Alpha Vantage API</li>
<li>IEX Cloud</li>
</ul>
<h3 id="analysis-tools"><a class="header" href="#analysis-tools">Analysis Tools</a></h3>
<ul>
<li>Excel/Google Sheets</li>
<li>Python (pandas, numpy, matplotlib)</li>
<li>TradingView</li>
<li>ThinkOrSwim</li>
<li>MetaTrader</li>
</ul>
<h3 id="educational-resources"><a class="header" href="#educational-resources">Educational Resources</a></h3>
<ul>
<li>Investopedia</li>
<li>Khan Academy (Finance)</li>
<li>CFA Institute</li>
<li>Financial news (WSJ, FT, Bloomberg)</li>
</ul>
<h2 id="available-guides"><a class="header" href="#available-guides">Available Guides</a></h2>
<p>Explore detailed guides for specific topics:</p>
<ol>
<li><a href="finance/general.html">General Finance</a> - Fundamental concepts and principles</li>
<li><a href="finance/stocks.html">Stocks</a> - Equity investing and analysis</li>
<li><a href="finance/options.html">Options</a> - Options trading strategies</li>
<li><a href="finance/futures.html">Futures</a> - Futures contracts and trading</li>
<li><a href="finance/crypto.html">Cryptocurrency</a> - Digital assets and blockchain</li>
<li><a href="finance/fundamental_analysis.html">Fundamental Analysis</a> - Company valuation</li>
<li><a href="finance/technical_analysis.html">Technical Analysis</a> - Chart patterns and indicators</li>
</ol>
<h2 id="important-disclaimers"><a class="header" href="#important-disclaimers">Important Disclaimers</a></h2>
<ol>
<li><strong>Not Financial Advice</strong>: This is educational content only</li>
<li><strong>Do Your Own Research</strong>: Always verify information</li>
<li><strong>Risk Warning</strong>: Investing involves risk of loss</li>
<li><strong>Past Performance</strong>: Does not guarantee future results</li>
<li><strong>Diversification</strong>: Does not ensure profit or protect against loss</li>
<li><strong>Consult Professionals</strong>: Consider seeking professional advice</li>
</ol>
<h2 id="key-principles"><a class="header" href="#key-principles">Key Principles</a></h2>
<h3 id="investment-principles"><a class="header" href="#investment-principles">Investment Principles</a></h3>
<ol>
<li><strong>Start Early</strong>: Compound interest is powerful</li>
<li><strong>Diversify</strong>: Spread risk across assets</li>
<li><strong>Invest Regularly</strong>: Dollar-cost averaging</li>
<li><strong>Control Costs</strong>: Minimize fees and taxes</li>
<li><strong>Stay Disciplined</strong>: Stick to your plan</li>
<li><strong>Educate Yourself</strong>: Continuous learning</li>
<li><strong>Manage Risk</strong>: Protect your capital</li>
<li><strong>Think Long-Term</strong>: Avoid emotional decisions</li>
</ol>
<h3 id="risk-management-rules"><a class="header" href="#risk-management-rules">Risk Management Rules</a></h3>
<ol>
<li>Never risk more than you can afford to lose</li>
<li>Use stop losses to limit downside</li>
<li>Diversify across multiple positions</li>
<li>Size positions appropriately</li>
<li>Have a clear exit strategy</li>
<li>Don't let winners become losers</li>
<li>Cut losses quickly</li>
<li>Let profits run (within reason)</li>
</ol>
<h2 id="next-steps-4"><a class="header" href="#next-steps-4">Next Steps</a></h2>
<ol>
<li>Learn the basics of <a href="finance/general.html">General Finance</a></li>
<li>Study <a href="finance/fundamental_analysis.html">Fundamental Analysis</a></li>
<li>Explore <a href="finance/technical_analysis.html">Technical Analysis</a></li>
<li>Understand <a href="finance/stocks.html">Stocks</a> and equity markets</li>
<li>Learn about <a href="finance/options.html">Options</a> for hedging and income</li>
<li>Research <a href="finance/crypto.html">Cryptocurrency</a> opportunities</li>
<li>Practice with paper trading before using real money</li>
<li>Build a diversified portfolio aligned with your goals</li>
<li>Continuously educate yourself</li>
<li>Start investing with money you can afford to lose</li>
</ol>
<p>Remember: Successful investing requires knowledge, discipline, and patience. Take time to learn, practice with small amounts, and gradually build your skills and portfolio.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="general"><a class="header" href="#general">General</a></h1>
<h2 id="sharpe-ratio"><a class="header" href="#sharpe-ratio">Sharpe Ratio</a></h2>
<p>The Sharpe Ratio is a widely used metric in finance to evaluate the performance of an investment by measuring the excess return per unit of risk. It is calculated by dividing the difference between the return of the investment and the risk-free rate by the standard deviation of the investment's returns.</p>
<p>$$
SR = \frac{R_p - R_f}{\sigma_p}
$$</p>
<p>Where:</p>
<ul>
<li>( R_p ) is the return of the portfolio</li>
<li>( R_f ) is the risk-free rate (usually the return of a benchmark like the S&amp;P 500)</li>
<li>( \sigma_p ) is the standard deviation of the portfolio's returns</li>
</ul>
<h2 id="calculating-standard-deviation-of-returns"><a class="header" href="#calculating-standard-deviation-of-returns">Calculating Standard Deviation of Returns</a></h2>
<p>The standard deviation of returns is a measure of the dispersion or variability of investment returns over a period of time. It helps in understanding the risk associated with the investment. Here is a step-by-step process to calculate the standard deviation of returns:</p>
<ol>
<li>
<p><strong>Collect the Returns Data</strong>: Gather the periodic returns of the investment. These returns can be daily, monthly, or yearly.</p>
</li>
<li>
<p><strong>Calculate the Mean Return</strong>: Compute the average return over the period.</p>
</li>
</ol>
<p>$$
\bar{R} = \frac{\sum_{i=1}^{n} R_i}{n}
$$</p>
<p>Where:</p>
<ul>
<li>( \bar{R} ) is the mean return</li>
<li>( R_i ) is the return for period ( i )</li>
<li>( n ) is the number of periods</li>
</ul>
<ol start="3">
<li><strong>Compute the Variance</strong>: Calculate the variance by finding the average of the squared differences between each return and the mean return.</li>
</ol>
<p>$$
\sigma^2 = \frac{\sum_{i=1}^{n} (R_i - \bar{R})^2}{n}
$$</p>
<p>Where:</p>
<ul>
<li>( \sigma^2 ) is the variance</li>
</ul>
<ol start="4">
<li><strong>Calculate the Standard Deviation</strong>: Take the square root of the variance to get the standard deviation.</li>
</ol>
<p>$$
\sigma = \sqrt{\sigma^2}
$$</p>
<p>Where:</p>
<ul>
<li>( \sigma ) is the standard deviation</li>
</ul>
<h3 id="sample-calculation"><a class="header" href="#sample-calculation">Sample Calculation</a></h3>
<p>Assume the following monthly returns for an investment over 5 months: 2%, 3%, -1%, 4%, and 5%.</p>
<ol>
<li><strong>Mean Return</strong>:</li>
</ol>
<p>$$
\bar{R} = \frac{2 + 3 - 1 + 4 + 5}{5} = \frac{13}{5} = 2.6%
$$</p>
<ol start="2">
<li><strong>Variance</strong>:</li>
</ol>
<p>$$
\sigma^2 = \frac{(2 - 2.6)^2 + (3 - 2.6)^2 + (-1 - 2.6)^2 + (4 - 2.6)^2 + (5 - 2.6)^2}{5}
$$</p>
<p>$$
\sigma^2 = \frac{(-0.6)^2 + (0.4)^2 + (-3.6)^2 + (1.4)^2 + (2.4)^2}{5}
$$</p>
<p>$$
\sigma^2 = \frac{0.36 + 0.16 + 12.96 + 1.96 + 5.76}{5} = \frac{21.2}{5} = 4.24
$$</p>
<ol start="3">
<li><strong>Standard Deviation</strong>:</li>
</ol>
<p>$$
\sigma = \sqrt{4.24} \approx 2.06%
$$</p>
<p>In this example, the standard deviation of the returns is approximately 2.06%, indicating the variability of the investment returns over the period.</p>
<h3 id="sample-scenario"><a class="header" href="#sample-scenario">Sample Scenario</a></h3>
<p>To better understand the Sharpe Ratio, let's consider a practical example.</p>
<p>Assume the following data for a portfolio:</p>
<ul>
<li>Portfolio return (( R_p )): 12% or 0.12</li>
<li>Risk-free rate (( R_f )): 2% or 0.02</li>
<li>Portfolio standard deviation (( \sigma_p )): 8% or 0.08</li>
</ul>
<p>Using the Sharpe Ratio formula:</p>
<p>$$
SR = \frac{R_p - R_f}{\sigma_p}
$$</p>
<p>Substituting the values:</p>
<p>$$
SR = \frac{0.12 - 0.02}{0.08} = \frac{0.10}{0.08} = 1.25
$$</p>
<p>In this scenario, the Sharpe Ratio is 1.25, indicating that the portfolio generates 1.25 units of excess return for each unit of risk taken.</p>
<h2 id="kelly-criterion"><a class="header" href="#kelly-criterion">Kelly Criterion</a></h2>
<p>The Kelly Criterion is a formula used to determine the optimal size of a series of bets. It calculates the ratio of edge over odds, helping to maximize the growth of capital over time. The formula is expressed as (k), where (p) and (q) are the probabilities of winning and losing, respectively.</p>
<p>$$
k = \frac{p - q}{o}
$$</p>
<p>Where:</p>
<ul>
<li>(p) is the probability of winning</li>
<li>(q) is the probability of losing</li>
<li>(o) is the odds of the bet</li>
</ul>
<h3 id="sample-scenario-1"><a class="header" href="#sample-scenario-1">Sample Scenario</a></h3>
<p>Consider a scenario to illustrate the Kelly Criterion.</p>
<p>Assume the following data for a bet:</p>
<ul>
<li>Probability of winning (( p )): 60% or 0.60</li>
<li>Probability of losing (( q )): 40% or 0.40</li>
<li>Odds of the bet (( o )): 2:1</li>
</ul>
<h3 id="understanding-odds-of-a-bet"><a class="header" href="#understanding-odds-of-a-bet">Understanding Odds of a Bet</a></h3>
<p>The odds of a bet represent the ratio of the probability of winning to the probability of losing. They are a crucial component in betting strategies, including the Kelly Criterion. Odds can be expressed in different formats, such as fractional, decimal, and moneyline.</p>
<h4 id="fractional-odds"><a class="header" href="#fractional-odds">Fractional Odds</a></h4>
<p>Fractional odds are commonly used in the UK and are represented as a fraction (e.g., 2/1). The numerator (first number) represents the potential profit, while the denominator (second number) represents the stake. For example, 2/1 odds mean you win $2 for every $1 bet.</p>
<h4 id="decimal-odds"><a class="header" href="#decimal-odds">Decimal Odds</a></h4>
<p>Decimal odds are popular in Europe and Australia. They are represented as a decimal number (e.g., 3.00). The decimal number includes the original stake, so the total payout is calculated by multiplying the stake by the decimal odds. For example, 3.00 odds mean a $1 bet returns $3 (including the $1 stake).</p>
<h4 id="moneyline-odds"><a class="header" href="#moneyline-odds">Moneyline Odds</a></h4>
<p>Moneyline odds are commonly used in the United States and can be positive or negative. Positive moneyline odds (e.g., +200) indicate how much profit you make on a $100 bet. Negative moneyline odds (e.g., -150) indicate how much you need to bet to win $100.</p>
<h3 id="calculating-odds"><a class="header" href="#calculating-odds">Calculating Odds</a></h3>
<p>To calculate the odds of a bet, you need to know the probabilities of winning and losing. The formula for calculating fractional odds is:</p>
<p>$$
\text{Odds} = \frac{p}{q}
$$</p>
<p>Where:</p>
<ul>
<li>( p ) is the probability of winning</li>
<li>( q ) is the probability of losing</li>
</ul>
<p>For example, if the probability of winning is 60% (0.60) and the probability of losing is 40% (0.40), the fractional odds are:</p>
<p>$$
\text{Odds} = \frac{0.60}{0.40} = \frac{3}{2} = 1.5
$$</p>
<p>To convert fractional odds to decimal odds, add 1 to the fractional odds:</p>
<p>$$
\text{Decimal Odds} = \text{Fractional Odds} + 1
$$</p>
<p>Using the previous example:</p>
<p>$$
\text{Decimal Odds} = 1.5 + 1 = 2.5
$$</p>
<p>To convert fractional odds to moneyline odds:</p>
<ul>
<li>If the fractional odds are greater than 1 (e.g., 2/1), the moneyline odds are positive: ( \text{Moneyline Odds} = \text{Fractional Odds} \times 100 )</li>
<li>If the fractional odds are less than 1 (e.g., 1/2), the moneyline odds are negative: ( \text{Moneyline Odds} = -\left(\frac{100}{\text{Fractional Odds}}\right) )</li>
</ul>
<p>Using the previous example (1.5 fractional odds):</p>
<p>$$
\text{Moneyline Odds} = 1.5 \times 100 = +150
$$</p>
<p>Understanding and calculating the odds of a bet is essential for making informed betting decisions and optimizing strategies like the Kelly Criterion.</p>
<p>Using the Kelly Criterion formula:</p>
<p>$$
k = \frac{p - q}{o}
$$</p>
<p>Substituting the values:</p>
<p>$$
k = \frac{0.60 - 0.40}{2} = \frac{0.20}{2} = 0.10
$$</p>
<p>In this scenario, the Kelly Criterion suggests betting 10% of your bankroll. For example, with a $1000 bankroll, you should bet $100.</p>
<h2 id="intuition-of-the-kelly-criterion"><a class="header" href="#intuition-of-the-kelly-criterion">Intuition of the Kelly Criterion</a></h2>
<p>The Kelly Criterion is a mathematical formula used to determine the optimal size of a series of bets to maximize the logarithm of wealth over time. It is particularly useful in scenarios where the goal is to grow wealth exponentially while managing risk. The intuition behind the Kelly Criterion can be broken down into several key concepts:</p>
<h3 id="key-concepts-29"><a class="header" href="#key-concepts-29">Key Concepts</a></h3>
<ol>
<li>
<p><strong>Maximizing Growth</strong>: The Kelly Criterion aims to maximize the long-term growth rate of your bankroll. By betting a fraction of your bankroll that is proportional to the edge you have over the odds, you can achieve exponential growth over time.</p>
</li>
<li>
<p><strong>Balancing Risk and Reward</strong>: The formula balances the potential reward of a bet with the risk of losing. By betting too much, you risk significant losses that can deplete your bankroll. By betting too little, you miss out on potential gains. The Kelly Criterion finds the optimal balance.</p>
</li>
<li>
<p><strong>Proportional Betting</strong>: The Kelly Criterion suggests betting a fraction of your bankroll that is proportional to your edge. This means that as your edge increases, the fraction of your bankroll you should bet also increases. Conversely, if your edge decreases, you should bet a smaller fraction.</p>
</li>
<li>
<p><strong>Logarithmic Utility</strong>: The Kelly Criterion is based on the concept of logarithmic utility, which means that the utility (or satisfaction) derived from wealth increases logarithmically. This approach ensures that the strategy is focused on long-term growth rather than short-term gains.</p>
</li>
</ol>
<h3 id="example-scenario"><a class="header" href="#example-scenario">Example Scenario</a></h3>
<p>Consider a scenario where you have a 60% chance of winning a bet (probability ( p = 0.60 )) and a 40% chance of losing (probability ( q = 0.40 )). The odds offered are 2:1 (decimal odds of 2.0).</p>
<p>Using the Kelly Criterion formula:</p>
<p>$$
k = \frac{p - q}{o}
$$</p>
<p>Substituting the values:</p>
<p>$$
k = \frac{0.60 - 0.40}{2} = \frac{0.20}{2} = 0.10
$$</p>
<p>In this scenario, the Kelly Criterion suggests betting 10% of your bankroll. For example, with a $1000 bankroll, you should bet $100.</p>
<h3 id="advantages-of-the-kelly-criterion"><a class="header" href="#advantages-of-the-kelly-criterion">Advantages of the Kelly Criterion</a></h3>
<ol>
<li><strong>Optimal Growth</strong>: The Kelly Criterion maximizes the long-term growth rate of your bankroll, ensuring that you achieve exponential growth over time.</li>
<li><strong>Risk Management</strong>: By betting a fraction of your bankroll, the Kelly Criterion helps manage risk and prevent significant losses.</li>
<li><strong>Adaptability</strong>: The formula adjusts the bet size based on the edge, allowing for flexible and adaptive betting strategies.</li>
</ol>
<h3 id="conclusion-27"><a class="header" href="#conclusion-27">Conclusion</a></h3>
<p>The Kelly Criterion is a powerful tool for optimizing bet sizes and maximizing long-term growth. By balancing risk and reward and focusing on proportional betting, the Kelly Criterion provides a strategic approach to betting that can lead to exponential wealth growth over time. Understanding the intuition behind the Kelly Criterion can help you make more informed and strategic betting decisions.</p>
<h2 id="pot-geometry"><a class="header" href="#pot-geometry">Pot Geometry</a></h2>
<p>Pot Geometry is a strategic betting approach where a consistent fraction of the pot is wagered on each round. Also known as geometric bet sizing, this strategy aims to maximize the amount of money an opponent contributes to the pot.</p>
<h3 id="detailed-explanation-of-pot-geometry"><a class="header" href="#detailed-explanation-of-pot-geometry">Detailed Explanation of Pot Geometry</a></h3>
<p>Pot Geometry is particularly useful in games like poker, where managing the pot size and betting strategically can significantly impact outcomes. By betting a fixed fraction of the pot on each round, the pot size grows exponentially, maximizing potential winnings while managing risk.</p>
<h3 id="key-concepts-30"><a class="header" href="#key-concepts-30">Key Concepts</a></h3>
<ol>
<li>
<p><strong>Fractional Betting</strong>: A fixed fraction of the current pot size is bet on each round. For instance, if the fraction is 50%, then 50% of the current pot size is added to the pot each round.</p>
</li>
<li>
<p><strong>Exponential Growth</strong>: Consistent fractional betting leads to exponential growth of the pot size, potentially increasing winnings over multiple rounds.</p>
</li>
<li>
<p><strong>Risk Management</strong>: Pot Geometry ensures bets are proportional to the current pot size, preventing over-betting and large losses.</p>
</li>
</ol>
<h3 id="example-scenario-1"><a class="header" href="#example-scenario-1">Example Scenario</a></h3>
<p>Consider an example to demonstrate Pot Geometry:</p>
<ul>
<li>Initial pot size: $100</li>
<li>Fraction of pot to bet: 50% (0.50)</li>
</ul>
<h4 id="round-1"><a class="header" href="#round-1">Round 1:</a></h4>
<ul>
<li>Current pot size: $100</li>
<li>Bet size: 50% of $100 = $50</li>
<li>New pot size: $100 + $50 = $150</li>
</ul>
<h4 id="round-2"><a class="header" href="#round-2">Round 2:</a></h4>
<ul>
<li>Current pot size: $150</li>
<li>Bet size: 50% of $150 = $75</li>
<li>New pot size: $150 + $75 = $225</li>
</ul>
<h4 id="round-3"><a class="header" href="#round-3">Round 3:</a></h4>
<ul>
<li>Current pot size: $225</li>
<li>Bet size: 50% of $225 = $112.50</li>
<li>New pot size: $225 + $112.50 = $337.50</li>
</ul>
<p>As shown, the pot size grows exponentially with each betting round.</p>
<h3 id="advantages-of-pot-geometry"><a class="header" href="#advantages-of-pot-geometry">Advantages of Pot Geometry</a></h3>
<ol>
<li><strong>Consistent Growth</strong>: The pot grows steadily, allowing for potentially higher winnings over multiple rounds.</li>
<li><strong>Controlled Risk</strong>: Betting a fraction of the pot controls risk, keeping it proportional to the current pot size.</li>
<li><strong>Strategic Flexibility</strong>: Players can adjust the betting fraction based on confidence and game dynamics.</li>
</ol>
<h3 id="conclusion-28"><a class="header" href="#conclusion-28">Conclusion</a></h3>
<p>Pot Geometry is a powerful betting strategy that leverages exponential growth and risk management principles. By consistently betting a fraction of the pot, players can maximize potential winnings while maintaining controlled risk. This strategy is particularly effective in poker, where strategic pot management can significantly influence long-term success.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="technical-analysis-1"><a class="header" href="#technical-analysis-1">Technical Analysis</a></h1>
<h2 id="stock-technical-analysis"><a class="header" href="#stock-technical-analysis">Stock Technical Analysis</a></h2>
<p>Stock technical analysis is a method used to evaluate and predict the future price movements of stocks by analyzing historical price data, trading volume, and other market indicators. Unlike fundamental analysis, which focuses on a company's financial health and intrinsic value, technical analysis relies on chart patterns, technical indicators, and statistical measures to make trading decisions.</p>
<h3 id="key-concepts-31"><a class="header" href="#key-concepts-31">Key Concepts</a></h3>
<ol>
<li>
<p><strong>Price Trends</strong>: Technical analysts study price trends to identify the direction in which a stock's price is moving. Trends can be upward (bullish), downward (bearish), or sideways (neutral). Recognizing trends helps traders make informed decisions about when to buy or sell stocks.</p>
</li>
<li>
<p><strong>Support and Resistance Levels</strong>: Support levels are price points where a stock tends to find buying interest, preventing it from falling further. Resistance levels are price points where selling interest is strong enough to prevent the stock from rising further. Identifying these levels helps traders set entry and exit points.</p>
</li>
<li>
<p><strong>Chart Patterns</strong>: Chart patterns are visual formations created by the price movements of a stock. Common patterns include head and shoulders, double tops and bottoms, triangles, and flags. These patterns can signal potential reversals or continuations in price trends.</p>
</li>
<li>
<p><strong>Technical Indicators</strong>: Technical indicators are mathematical calculations based on price, volume, or open interest data. Popular indicators include moving averages, relative strength index (RSI), moving average convergence divergence (MACD), and Bollinger Bands. These indicators help traders identify overbought or oversold conditions, trend strength, and potential reversal points.</p>
</li>
<li>
<p><strong>Volume Analysis</strong>: Trading volume is the number of shares traded during a specific period. Analyzing volume helps confirm the strength of price movements. For example, a price increase accompanied by high volume suggests strong buying interest, while a price increase with low volume may indicate weak buying interest.</p>
</li>
</ol>
<h3 id="example-scenario-2"><a class="header" href="#example-scenario-2">Example Scenario</a></h3>
<p>Consider a stock that has been in an upward trend for several months. A technical analyst might use the following steps to evaluate the stock:</p>
<ol>
<li>
<p><strong>Identify the Trend</strong>: The analyst observes that the stock is in a bullish trend, with higher highs and higher lows on the price chart.</p>
</li>
<li>
<p><strong>Determine Support and Resistance Levels</strong>: The analyst identifies key support levels at $50 and $55, and resistance levels at $65 and $70.</p>
</li>
<li>
<p><strong>Analyze Chart Patterns</strong>: The analyst notices a bullish flag pattern forming, indicating a potential continuation of the upward trend.</p>
</li>
<li>
<p><strong>Use Technical Indicators</strong>: The analyst checks the RSI, which shows the stock is not yet overbought, and the MACD, which indicates strong bullish momentum.</p>
</li>
<li>
<p><strong>Examine Volume</strong>: The analyst observes that recent price increases are accompanied by high trading volume, confirming strong buying interest.</p>
</li>
</ol>
<p>Based on this analysis, the technical analyst might decide to buy the stock, anticipating further price increases.</p>
<h3 id="advantages-of-technical-analysis"><a class="header" href="#advantages-of-technical-analysis">Advantages of Technical Analysis</a></h3>
<ol>
<li><strong>Timely Decision-Making</strong>: Technical analysis provides real-time data and signals, allowing traders to make quick and informed decisions.</li>
<li><strong>Market Sentiment Insight</strong>: By analyzing price and volume data, technical analysis helps traders gauge market sentiment and investor behavior.</li>
<li><strong>Versatility</strong>: Technical analysis can be applied to various financial instruments, including stocks, options, futures, and cryptocurrencies.</li>
</ol>
<h3 id="conclusion-29"><a class="header" href="#conclusion-29">Conclusion</a></h3>
<p>Stock technical analysis is a valuable tool for traders and investors seeking to predict future price movements and make informed trading decisions. By understanding key concepts such as price trends, support and resistance levels, chart patterns, technical indicators, and volume analysis, traders can develop effective strategies to navigate the stock market. While technical analysis has its limitations, it remains a popular and widely used method for analyzing and trading stocks.</p>
<h2 id="moving-averages"><a class="header" href="#moving-averages">Moving Averages</a></h2>
<p>Moving averages are one of the most commonly used technical indicators in stock analysis. They smooth out price data to identify the direction of the trend over a specific period. There are two main types of moving averages:</p>
<ol>
<li>
<p><strong>Simple Moving Average (SMA)</strong>: The SMA is calculated by taking the average of a stock's price over a specific number of periods. For example, a 10-day SMA is the average of the closing prices of the last 10 days.</p>
</li>
<li>
<p><strong>Exponential Moving Average (EMA)</strong>: The EMA gives more weight to recent prices, making it more responsive to new information. It is calculated using a formula that applies a weighting factor to the most recent price data.</p>
</li>
</ol>
<h3 id="example-scenario-3"><a class="header" href="#example-scenario-3">Example Scenario</a></h3>
<p>Consider a stock with the following closing prices over 5 days: $10, $12, $14, $16, and $18.</p>
<ul>
<li>The 5-day SMA would be: (10 + 12 + 14 + 16 + 18) / 5 = $14.</li>
<li>The 5-day EMA would place more weight on the recent prices, resulting in a value closer to the latest price of $18.</li>
</ul>
<h3 id="advantages-of-moving-averages"><a class="header" href="#advantages-of-moving-averages">Advantages of Moving Averages</a></h3>
<ol>
<li><strong>Trend Identification</strong>: Moving averages help identify the direction of the trend, making it easier for traders to follow the market's momentum.</li>
<li><strong>Support and Resistance Levels</strong>: Moving averages can act as dynamic support and resistance levels, providing entry and exit points for trades.</li>
</ol>
<h2 id="relative-strength-index-rsi"><a class="header" href="#relative-strength-index-rsi">Relative Strength Index (RSI)</a></h2>
<p>The Relative Strength Index (RSI) is a momentum oscillator that measures the speed and change of price movements. It ranges from 0 to 100 and is used to identify overbought or oversold conditions in a stock.</p>
<ul>
<li><strong>Overbought</strong>: An RSI above 70 suggests that a stock may be overbought and due for a correction.</li>
<li><strong>Oversold</strong>: An RSI below 30 indicates that a stock may be oversold and could be due for a rebound.</li>
</ul>
<h3 id="example-scenario-4"><a class="header" href="#example-scenario-4">Example Scenario</a></h3>
<p>Consider a stock with an RSI of 75. This high RSI value suggests that the stock is overbought, and a trader might consider selling or shorting the stock in anticipation of a price correction.</p>
<h3 id="advantages-of-rsi"><a class="header" href="#advantages-of-rsi">Advantages of RSI</a></h3>
<ol>
<li><strong>Momentum Measurement</strong>: RSI helps measure the strength of a stock's price movement, providing insights into potential reversals.</li>
<li><strong>Overbought/Oversold Signals</strong>: RSI provides clear signals for overbought and oversold conditions, aiding in decision-making.</li>
</ol>
<h2 id="moving-average-convergence-divergence-macd"><a class="header" href="#moving-average-convergence-divergence-macd">Moving Average Convergence Divergence (MACD)</a></h2>
<p>The Moving Average Convergence Divergence (MACD) is a trend-following momentum indicator that shows the relationship between two moving averages of a stock's price. It consists of three components:</p>
<ol>
<li><strong>MACD Line</strong>: The difference between the 12-day EMA and the 26-day EMA.</li>
<li><strong>Signal Line</strong>: A 9-day EMA of the MACD line.</li>
<li><strong>Histogram</strong>: The difference between the MACD line and the signal line.</li>
</ol>
<h3 id="example-scenario-5"><a class="header" href="#example-scenario-5">Example Scenario</a></h3>
<p>Consider a stock where the MACD line crosses above the signal line. This bullish crossover indicates a potential buy signal, suggesting that the stock's price may rise.</p>
<h3 id="advantages-of-macd"><a class="header" href="#advantages-of-macd">Advantages of MACD</a></h3>
<ol>
<li><strong>Trend and Momentum</strong>: MACD combines trend and momentum analysis, providing a comprehensive view of the stock's price action.</li>
<li><strong>Crossover Signals</strong>: MACD crossovers generate buy and sell signals, aiding in timing trades.</li>
</ol>
<h2 id="bollinger-bands"><a class="header" href="#bollinger-bands">Bollinger Bands</a></h2>
<p>Bollinger Bands are a volatility indicator that consists of three lines: the middle band (SMA), the upper band, and the lower band. The upper and lower bands are typically set two standard deviations away from the middle band.</p>
<ul>
<li><strong>Upper Band</strong>: Indicates overbought conditions when the price touches or exceeds it.</li>
<li><strong>Lower Band</strong>: Indicates oversold conditions when the price touches or falls below it.</li>
</ul>
<h3 id="example-scenario-6"><a class="header" href="#example-scenario-6">Example Scenario</a></h3>
<p>Consider a stock trading near the upper Bollinger Band. This suggests that the stock may be overbought, and a trader might consider selling or shorting the stock.</p>
<h3 id="advantages-of-bollinger-bands"><a class="header" href="#advantages-of-bollinger-bands">Advantages of Bollinger Bands</a></h3>
<ol>
<li><strong>Volatility Measurement</strong>: Bollinger Bands adjust to market volatility, providing dynamic support and resistance levels.</li>
<li><strong>Overbought/Oversold Conditions</strong>: Bollinger Bands help identify overbought and oversold conditions, aiding in decision-making.</li>
</ol>
<p>By understanding and utilizing these technical indicators—moving averages, RSI, MACD, and Bollinger Bands—traders can develop more informed and effective trading strategies to navigate the stock market.</p>
<h2 id="chart-patterns"><a class="header" href="#chart-patterns">Chart Patterns</a></h2>
<p>Chart patterns are formations created by the price movements of a stock or other financial instrument on a chart. These patterns are used by technical analysts to predict future price movements based on historical data. Chart patterns can be classified into two main categories: continuation patterns and reversal patterns.</p>
<h3 id="continuation-patterns"><a class="header" href="#continuation-patterns">Continuation Patterns</a></h3>
<p>Continuation patterns indicate that the current trend is likely to continue after the pattern is completed. Some common continuation patterns include:</p>
<ol>
<li>
<p><strong>Triangles</strong>: Triangles are formed by converging trendlines that represent a period of consolidation before the price breaks out in the direction of the existing trend. There are three types of triangles:</p>
<ul>
<li><strong>Ascending Triangle</strong>: Characterized by a flat upper trendline and a rising lower trendline, indicating a potential bullish breakout.</li>
<li><strong>Descending Triangle</strong>: Characterized by a flat lower trendline and a descending upper trendline, indicating a potential bearish breakout.</li>
<li><strong>Symmetrical Triangle</strong>: Formed by converging upper and lower trendlines, indicating a potential breakout in either direction.</li>
</ul>
</li>
<li>
<p><strong>Flags and Pennants</strong>: Flags and pennants are short-term continuation patterns that represent brief periods of consolidation before the price resumes its previous trend.</p>
<ul>
<li><strong>Flag</strong>: A rectangular pattern that slopes against the prevailing trend, indicating a brief consolidation before the trend continues.</li>
<li><strong>Pennant</strong>: A small symmetrical triangle that forms after a strong price movement, indicating a brief consolidation before the trend continues.</li>
</ul>
</li>
<li>
<p><strong>Rectangles</strong>: Rectangles are formed by horizontal support and resistance levels, indicating a period of consolidation before the price breaks out in the direction of the existing trend.</p>
</li>
</ol>
<h3 id="reversal-patterns"><a class="header" href="#reversal-patterns">Reversal Patterns</a></h3>
<p>Reversal patterns indicate that the current trend is likely to reverse after the pattern is completed. Some common reversal patterns include:</p>
<ol>
<li>
<p><strong>Head and Shoulders</strong>: The head and shoulders pattern is a bearish reversal pattern that consists of three peaks: a higher peak (head) between two lower peaks (shoulders). The pattern is confirmed when the price breaks below the neckline, indicating a potential trend reversal.</p>
</li>
<li>
<p><strong>Inverse Head and Shoulders</strong>: The inverse head and shoulders pattern is a bullish reversal pattern that consists of three troughs: a lower trough (head) between two higher troughs (shoulders). The pattern is confirmed when the price breaks above the neckline, indicating a potential trend reversal.</p>
</li>
<li>
<p><strong>Double Top and Double Bottom</strong>: The double top is a bearish reversal pattern that consists of two peaks at approximately the same price level, indicating a potential trend reversal when the price breaks below the support level. The double bottom is a bullish reversal pattern that consists of two troughs at approximately the same price level, indicating a potential trend reversal when the price breaks above the resistance level.</p>
</li>
<li>
<p><strong>Triple Top and Triple Bottom</strong>: The triple top is a bearish reversal pattern that consists of three peaks at approximately the same price level, indicating a potential trend reversal when the price breaks below the support level. The triple bottom is a bullish reversal pattern that consists of three troughs at approximately the same price level, indicating a potential trend reversal when the price breaks above the resistance level.</p>
</li>
</ol>
<h3 id="example-scenario-7"><a class="header" href="#example-scenario-7">Example Scenario</a></h3>
<p>Consider a stock that forms an ascending triangle pattern. The stock's price has been rising, and the pattern is characterized by a flat upper trendline and a rising lower trendline. This suggests that the stock is likely to break out to the upside, continuing its upward trend.</p>
<h3 id="advantages-of-chart-patterns"><a class="header" href="#advantages-of-chart-patterns">Advantages of Chart Patterns</a></h3>
<ol>
<li><strong>Predictive Power</strong>: Chart patterns provide insights into potential future price movements based on historical data.</li>
<li><strong>Visual Representation</strong>: Chart patterns offer a visual representation of market psychology and investor behavior.</li>
<li><strong>Versatility</strong>: Chart patterns can be applied to various financial instruments and timeframes, making them a versatile tool for technical analysis.</li>
</ol>
<p>By understanding and utilizing chart patterns, traders can enhance their ability to predict future price movements and make more informed trading decisions. Combining chart patterns with other technical indicators can further improve the accuracy of trading strategies.</p>
<h2 id="how-to-find-support-levels"><a class="header" href="#how-to-find-support-levels">How to Find Support Levels</a></h2>
<p>Support levels are price levels at which a stock or other financial instrument tends to find buying interest, preventing the price from falling further. Identifying support levels is crucial for traders as it helps them make informed decisions about entry and exit points. Here are some methods to find support levels:</p>
<h3 id="methods-to-identify-support-levels"><a class="header" href="#methods-to-identify-support-levels">Methods to Identify Support Levels</a></h3>
<ol>
<li>
<p><strong>Historical Price Levels</strong>: Look for price levels where the stock has previously found support. These levels can be identified by examining past price charts and noting where the price has repeatedly bounced back up.</p>
</li>
<li>
<p><strong>Moving Averages</strong>: Moving averages, such as the 50-day or 200-day moving average, can act as dynamic support levels. When the price approaches these moving averages, it often finds support and reverses direction.</p>
</li>
<li>
<p><strong>Trendlines</strong>: Draw trendlines by connecting the lows of an uptrend. These trendlines can act as support levels, indicating where the price is likely to find buying interest.</p>
</li>
<li>
<p><strong>Fibonacci Retracement Levels</strong>: Use Fibonacci retracement levels to identify potential support levels. Common retracement levels include 38.2%, 50%, and 61.8%. These levels are based on the Fibonacci sequence and can indicate where the price may find support during a pullback.</p>
</li>
<li>
<p><strong>Volume Profile</strong>: Analyze the volume profile to identify price levels with high trading activity. These levels often act as support, as they represent areas where a significant number of buyers have previously entered the market.</p>
</li>
<li>
<p><strong>Psychological Levels</strong>: Round numbers, such as $50, $100, or $1000, often act as psychological support levels. Traders tend to place buy orders at these levels, creating support.</p>
</li>
</ol>
<h3 id="example-scenario-8"><a class="header" href="#example-scenario-8">Example Scenario</a></h3>
<p>Consider a stock that has been in an uptrend and is currently trading at $150. By examining the historical price chart, you notice that the stock has previously found support at $140. Additionally, the 50-day moving average is currently at $140, reinforcing this level as a potential support. You also draw a trendline connecting the recent lows, which intersects at $140. Based on this analysis, you identify $140 as a strong support level for the stock.</p>
<h3 id="advantages-of-identifying-support-levels"><a class="header" href="#advantages-of-identifying-support-levels">Advantages of Identifying Support Levels</a></h3>
<ol>
<li><strong>Informed Decision-Making</strong>: Knowing support levels helps traders make informed decisions about when to enter or exit a trade.</li>
<li><strong>Risk Management</strong>: Identifying support levels allows traders to set stop-loss orders below these levels, managing risk and minimizing potential losses.</li>
<li><strong>Improved Timing</strong>: By recognizing support levels, traders can improve their timing for entering trades, increasing the likelihood of profitable outcomes.</li>
</ol>
<p>By understanding and utilizing support levels, traders can enhance their ability to predict price movements and make more strategic trading decisions. Combining support levels with other technical indicators and chart patterns can further improve the accuracy of trading strategies.</p>
<h2 id="best-brokers-for-futures-trading"><a class="header" href="#best-brokers-for-futures-trading">Best Brokers for Futures Trading</a></h2>
<p>Choosing the right broker is crucial for successful futures trading. Here are some of the best brokers for futures trading, known for their robust platforms, competitive fees, and excellent customer support:</p>
<ol>
<li>
<p><strong>TD Ameritrade</strong>: TD Ameritrade offers a powerful trading platform called thinkorswim, which is highly regarded for its advanced charting tools, technical analysis features, and real-time data. They provide competitive commission rates and a wide range of futures products.</p>
</li>
<li>
<p><strong>Interactive Brokers</strong>: Interactive Brokers is known for its low-cost trading and extensive range of futures contracts. Their Trader Workstation (TWS) platform is highly customizable and offers advanced trading tools, including algorithmic trading and risk management features.</p>
</li>
<li>
<p><strong>E*TRADE</strong>: E<em>TRADE provides a user-friendly platform with comprehensive research tools and educational resources. Their Power E</em>TRADE platform is designed for active traders and offers advanced charting, technical analysis, and real-time data.</p>
</li>
<li>
<p><strong>Charles Schwab</strong>: Charles Schwab offers a robust trading platform with a wide range of futures products. Their StreetSmart Edge platform provides advanced charting tools, technical analysis, and real-time data. Schwab is also known for its excellent customer service and educational resources.</p>
</li>
<li>
<p><strong>NinjaTrader</strong>: NinjaTrader is a popular choice among futures traders for its advanced charting and analysis tools. The platform offers a wide range of technical indicators, automated trading capabilities, and competitive commission rates. NinjaTrader also provides access to a large community of traders and educational resources.</p>
</li>
<li>
<p><strong>TradeStation</strong>: TradeStation is known for its powerful trading platform and advanced analytical tools. They offer a wide range of futures products and competitive commission rates. TradeStation's platform is highly customizable and provides access to real-time data, advanced charting, and technical analysis.</p>
</li>
</ol>
<h3 id="example-scenario-9"><a class="header" href="#example-scenario-9">Example Scenario</a></h3>
<p>Consider a trader who wants to trade crude oil futures. They choose Interactive Brokers for its low-cost trading and extensive range of futures contracts. The trader uses the Trader Workstation (TWS) platform to analyze crude oil price charts and identify trading opportunities. They place a market order to buy one crude oil futures contract and set stop-loss and take-profit levels based on their analysis. The trader continuously monitors the market and adjusts their orders as needed, ultimately achieving a profitable trade.</p>
<h3 id="advantages-of-choosing-the-right-broker"><a class="header" href="#advantages-of-choosing-the-right-broker">Advantages of Choosing the Right Broker</a></h3>
<ol>
<li><strong>Advanced Trading Tools</strong>: The best brokers offer advanced trading platforms with powerful charting, technical analysis, and real-time data.</li>
<li><strong>Competitive Fees</strong>: Low commission rates and competitive fees can significantly impact overall trading profitability.</li>
<li><strong>Customer Support</strong>: Excellent customer support ensures that traders can get help when needed, improving their trading experience.</li>
<li><strong>Educational Resources</strong>: Access to educational resources and research tools can help traders improve their skills and make more informed decisions.</li>
</ol>
<p>By choosing the right broker, traders can enhance their futures trading experience and increase their chances of success. It's important to consider factors such as trading platform features, commission rates, customer support, and educational resources when selecting a broker for futures trading.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="fundamental-analysis-1"><a class="header" href="#fundamental-analysis-1">Fundamental Analysis</a></h1>
<h2 id="what-is-fundamental-analysis"><a class="header" href="#what-is-fundamental-analysis">What is Fundamental Analysis?</a></h2>
<p>Fundamental analysis is a method of evaluating the intrinsic value of an asset, such as a stock, by examining related economic, financial, and other qualitative and quantitative factors. The goal of fundamental analysis is to determine whether an asset is overvalued or undervalued by the market, and to make investment decisions based on this assessment.</p>
<h2 id="key-components-of-fundamental-analysis"><a class="header" href="#key-components-of-fundamental-analysis">Key Components of Fundamental Analysis</a></h2>
<ol>
<li>
<p><strong>Economic Analysis</strong>: This involves analyzing the overall economic environment, including factors such as GDP growth, inflation rates, interest rates, and employment levels. Economic conditions can have a significant impact on the performance of individual companies and industries.</p>
</li>
<li>
<p><strong>Industry Analysis</strong>: This involves examining the specific industry in which a company operates. Factors to consider include industry growth rates, competitive dynamics, regulatory environment, and technological advancements. Understanding the industry context helps in assessing a company's potential for growth and profitability.</p>
</li>
<li>
<p><strong>Company Analysis</strong>: This involves a detailed examination of a company's financial statements, management team, business model, and competitive position. Key financial metrics to analyze include revenue, earnings, profit margins, return on equity, and debt levels. Qualitative factors such as management quality, corporate governance, and brand strength are also important.</p>
</li>
</ol>
<h2 id="financial-statements"><a class="header" href="#financial-statements">Financial Statements</a></h2>
<p>Fundamental analysis relies heavily on the analysis of financial statements, which provide a comprehensive view of a company's financial health. The three main financial statements are:</p>
<ol>
<li>
<p><strong>Income Statement</strong>: This statement provides information about a company's revenues, expenses, and profits over a specific period. Key metrics to analyze include gross profit, operating income, and net income.</p>
</li>
<li>
<p><strong>Balance Sheet</strong>: This statement provides a snapshot of a company's assets, liabilities, and shareholders' equity at a specific point in time. Key metrics to analyze include current assets, current liabilities, long-term debt, and equity.</p>
</li>
<li>
<p><strong>Cash Flow Statement</strong>: This statement provides information about a company's cash inflows and outflows over a specific period. Key metrics to analyze include operating cash flow, investing cash flow, and financing cash flow.</p>
</li>
</ol>
<h2 id="valuation-methods"><a class="header" href="#valuation-methods">Valuation Methods</a></h2>
<p>Fundamental analysis involves various valuation methods to estimate the intrinsic value of an asset. Some common valuation methods include:</p>
<ol>
<li>
<p><strong>Discounted Cash Flow (DCF) Analysis</strong>: This method involves estimating the present value of a company's future cash flows. The DCF analysis requires making assumptions about future revenue growth, profit margins, and discount rates.</p>
</li>
<li>
<p><strong>Price-to-Earnings (P/E) Ratio</strong>: This ratio compares a company's current stock price to its earnings per share (EPS). A high P/E ratio may indicate that a stock is overvalued, while a low P/E ratio may indicate that it is undervalued.</p>
</li>
<li>
<p><strong>Price-to-Book (P/B) Ratio</strong>: This ratio compares a company's current stock price to its book value per share. The book value is the value of a company's assets minus its liabilities. A low P/B ratio may indicate that a stock is undervalued.</p>
</li>
<li>
<p><strong>Dividend Discount Model (DDM)</strong>: This method involves estimating the present value of a company's future dividend payments. The DDM is particularly useful for valuing companies with a stable dividend payout history.</p>
</li>
</ol>
<h2 id="conclusion-30"><a class="header" href="#conclusion-30">Conclusion</a></h2>
<p>Fundamental analysis is a comprehensive approach to evaluating the intrinsic value of an asset by examining economic, industry, and company-specific factors. By analyzing financial statements and using various valuation methods, investors can make informed decisions about whether to buy, hold, or sell an asset. While fundamental analysis requires a thorough understanding of financial concepts and data, it provides valuable insights into the true worth of an investment.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="stocks"><a class="header" href="#stocks">Stocks</a></h1>
<h2 id="key-financial-ratios"><a class="header" href="#key-financial-ratios">Key Financial Ratios</a></h2>
<h3 id="price-to-earnings-ratio-pe"><a class="header" href="#price-to-earnings-ratio-pe">Price to Earnings Ratio (P/E)</a></h3>
<p>The Price to Earnings Ratio (P/E) is a fundamental valuation tool that compares a company's current share price to its earnings per share (EPS). It is expressed as:</p>
<p>$$
P/E = \frac{Price\ per\ Share}{Earnings\ per\ Share}
$$</p>
<p>A high P/E ratio might suggest that a stock is overvalued or that investors anticipate significant growth. Conversely, a low P/E ratio could indicate undervaluation or potential challenges faced by the company.</p>
<h3 id="price-to-book-ratio-pb"><a class="header" href="#price-to-book-ratio-pb">Price to Book Ratio (P/B)</a></h3>
<p>The Price to Book Ratio (P/B) evaluates a company's market value against its book value. It is determined by:</p>
<p>$$
P/B = \frac{Market\ Price\ per\ Share}{Book\ Value\ per\ Share}
$$</p>
<p>The book value represents the net asset value, calculated as total assets minus intangible assets and liabilities. A lower P/B ratio may signal undervaluation, while a higher ratio could imply overvaluation.</p>
<h3 id="debt-to-equity-ratio-de"><a class="header" href="#debt-to-equity-ratio-de">Debt to Equity Ratio (D/E)</a></h3>
<p>The Debt to Equity Ratio (D/E) assesses a company's financial leverage by comparing its total liabilities to shareholder equity. It is calculated as:</p>
<p>$$
D/E = \frac{Total\ Liabilities}{Shareholder\ Equity}
$$</p>
<p>A higher D/E ratio indicates greater reliance on debt for financing, which can be risky if not managed well. A lower ratio suggests a more conservative financial strategy.</p>
<h3 id="return-on-equity-roe"><a class="header" href="#return-on-equity-roe">Return on Equity (ROE)</a></h3>
<p>Return on Equity (ROE) measures a company's profitability by comparing net income to shareholder equity. It is expressed as:</p>
<p>$$
ROE = \frac{Net\ Income}{Shareholder\ Equity}
$$</p>
<p>A higher ROE signifies effective profit generation from equity investments, serving as a crucial indicator of financial performance and efficiency.</p>
<h3 id="current-ratio"><a class="header" href="#current-ratio">Current Ratio</a></h3>
<p>The Current Ratio is a liquidity metric that evaluates a company's ability to meet short-term obligations with its current assets. It is calculated as:</p>
<p>$$
Current\ Ratio = \frac{Current\ Assets}{Current\ Liabilities}
$$</p>
<p>A higher current ratio suggests strong short-term financial health, while a lower ratio may indicate potential liquidity challenges.</p>
<h3 id="quick-ratio"><a class="header" href="#quick-ratio">Quick Ratio</a></h3>
<p>The Quick Ratio, or acid-test ratio, is a stringent liquidity measure that excludes inventory from current assets. It is calculated as:</p>
<p>$$
Quick\ Ratio = \frac{Current\ Assets - Inventory}{Current\ Liabilities}
$$</p>
<p>A higher quick ratio indicates the ability to meet short-term obligations without relying on inventory sales.</p>
<h3 id="dividend-yield"><a class="header" href="#dividend-yield">Dividend Yield</a></h3>
<p>The Dividend Yield reflects the annual dividend income relative to the market price per share. It is calculated as:</p>
<p>$$
Dividend\ Yield = \frac{Annual\ Dividends\ per\ Share}{Price\ per\ Share}
$$</p>
<p>A higher dividend yield suggests a company is returning more income to shareholders, appealing to income-focused investors.</p>
<h3 id="earnings-per-share-eps"><a class="header" href="#earnings-per-share-eps">Earnings Per Share (EPS)</a></h3>
<p>Earnings Per Share (EPS) is a critical profitability metric indicating the profit generated per share of stock. It is calculated as:</p>
<p>$$
EPS = \frac{Net\ Income - Dividends\ on\ Preferred\ Stock}{Average\ Outstanding\ Shares}
$$</p>
<p>A higher EPS reflects better profitability and is a key factor for investors assessing financial health.</p>
<h3 id="price-to-sales-ratio-ps"><a class="header" href="#price-to-sales-ratio-ps">Price to Sales Ratio (P/S)</a></h3>
<p>The Price to Sales Ratio (P/S) compares a company's market capitalization to its total sales or revenue. It is expressed as:</p>
<p>$$
P/S = \frac{Market\ Capitalization}{Total\ Sales}
$$</p>
<p>A lower P/S ratio may indicate undervaluation, while a higher ratio could suggest overvaluation, especially useful for companies with minimal earnings.</p>
<h3 id="conclusion-31"><a class="header" href="#conclusion-31">Conclusion</a></h3>
<p>Analyzing these financial ratios offers valuable insights into a company's valuation, financial health, and performance. Investors leverage these metrics to make informed decisions and compare companies within the same industry.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="options"><a class="header" href="#options">Options</a></h1>
<h2 id="black-scholes-model"><a class="header" href="#black-scholes-model">Black-Scholes Model</a></h2>
<p>The Black-Scholes model is a renowned mathematical model used to price options and other financial derivatives. Developed by Fischer Black and Myron Scholes, the model was first published in 1973. It assumes that the underlying asset's price follows a geometric Brownian motion and uses a no-arbitrage approach to derive the option's price.</p>
<h2 id="greeks"><a class="header" href="#greeks">Greeks</a></h2>
<p>The Greeks are a set of mathematical tools used in the Black-Scholes model to measure the sensitivity of an option's price to changes in various parameters. The most common Greeks include delta, gamma, theta, vega, and rho.</p>
<h3 id="detailed-explanation-of-greeks"><a class="header" href="#detailed-explanation-of-greeks">Detailed Explanation of Greeks</a></h3>
<p>The Greeks are essential tools for options traders, providing insights into how different factors impact the price of an option. Here are the most common Greeks and their significance:</p>
<ol>
<li>
<p><strong>Delta ($\Delta$)</strong>: Delta measures the sensitivity of an option's price to changes in the price of the underlying asset. It represents the rate of change of the option's price with respect to a $1 change in the underlying asset's price. For call options, delta ranges from 0 to 1, while for put options, delta ranges from -1 to 0. A higher delta indicates greater sensitivity to price changes in the underlying asset.</p>
</li>
<li>
<p><strong>Gamma ($\Gamma$)</strong>: Gamma measures the rate of change of delta with respect to changes in the underlying asset's price. It indicates how much the delta of an option will change for a $1 change in the underlying asset's price. Gamma is highest for at-the-money options and decreases as the option moves further in-the-money or out-of-the-money. High gamma values indicate that delta is more sensitive to price changes in the underlying asset.</p>
</li>
<li>
<p><strong>Theta ($\Theta$)</strong>: Theta measures the sensitivity of an option's price to the passage of time, also known as time decay. It represents the rate at which the option's price decreases as time to expiration approaches. Theta is typically negative for both call and put options, as the value of options erodes over time. Options with shorter time to expiration have higher theta values, indicating faster time decay.</p>
</li>
<li>
<p><strong>Vega ($\nu$)</strong>: Vega measures the sensitivity of an option's price to changes in the volatility of the underlying asset. It represents the amount by which the option's price will change for a $1%$ change in the underlying asset's volatility. Higher vega values indicate that the option's price is more sensitive to changes in volatility. Vega is highest for at-the-money options and decreases as the option moves further in-the-money or out-of-the-money.</p>
</li>
<li>
<p><strong>Rho ($\rho$)</strong>: Rho measures the sensitivity of an option's price to changes in interest rates. It represents the amount by which the option's price will change for a $1%$ change in the risk-free interest rate. For call options, rho is positive, indicating that an increase in interest rates will increase the option's price. For put options, rho is negative, indicating that an increase in interest rates will decrease the option's price.</p>
</li>
</ol>
<h3 id="practical-applications-of-greeks"><a class="header" href="#practical-applications-of-greeks">Practical Applications of Greeks</a></h3>
<p>Understanding the Greeks is crucial for options traders, as they help in managing risk and making informed trading decisions. Here are some practical applications:</p>
<ul>
<li><strong>Hedging</strong>: Traders use delta to hedge their positions by ensuring that the overall delta of their portfolio is neutral, reducing exposure to price movements in the underlying asset.</li>
<li><strong>Adjusting Positions</strong>: Gamma helps traders understand how their delta will change with price movements, allowing them to adjust their positions accordingly.</li>
<li><strong>Time Decay Management</strong>: Theta is important for traders who sell options, as it helps them understand how the value of their options will erode over time.</li>
<li><strong>Volatility Trading</strong>: Vega is crucial for traders who speculate on changes in volatility, as it helps them gauge the impact of volatility changes on their options' prices.</li>
<li><strong>Interest Rate Impact</strong>: Rho is useful for understanding how changes in interest rates will affect the value of options, particularly for long-term options.</li>
</ul>
<p>By mastering the Greeks, options traders can better navigate the complexities of the options market and enhance their trading strategies.</p>
<h2 id="option-strategies"><a class="header" href="#option-strategies">Option Strategies</a></h2>
<p>Option strategies are various combinations of buying and selling options to achieve specific financial goals, such as hedging risk, generating income, or speculating on price movements. Here are some common option strategies:</p>
<h3 id="1-covered-call"><a class="header" href="#1-covered-call">1. Covered Call</a></h3>
<p>A covered call involves holding a long position in an underlying asset and selling a call option on that same asset. This strategy generates income from the option premium but limits the upside potential if the asset's price rises significantly.</p>
<h3 id="2-protective-put"><a class="header" href="#2-protective-put">2. Protective Put</a></h3>
<p>A protective put involves holding a long position in an underlying asset and buying a put option on that same asset. This strategy provides downside protection, as the put option gains value if the asset's price falls.</p>
<h3 id="3-straddle"><a class="header" href="#3-straddle">3. Straddle</a></h3>
<p>A straddle involves buying both a call option and a put option with the same strike price and expiration date. This strategy profits from significant price movements in either direction, making it suitable for volatile markets.</p>
<h3 id="4-strangle"><a class="header" href="#4-strangle">4. Strangle</a></h3>
<p>A strangle involves buying a call option and a put option with different strike prices but the same expiration date. This strategy is similar to a straddle but requires a larger price movement to be profitable.</p>
<h3 id="5-bull-call-spread"><a class="header" href="#5-bull-call-spread">5. Bull Call Spread</a></h3>
<p>A bull call spread involves buying a call option with a lower strike price and selling a call option with a higher strike price. This strategy profits from a moderate rise in the underlying asset's price while limiting potential losses.</p>
<h3 id="6-bear-put-spread"><a class="header" href="#6-bear-put-spread">6. Bear Put Spread</a></h3>
<p>A bear put spread involves buying a put option with a higher strike price and selling a put option with a lower strike price. This strategy profits from a moderate decline in the underlying asset's price while limiting potential losses.</p>
<h3 id="7-iron-condor"><a class="header" href="#7-iron-condor">7. Iron Condor</a></h3>
<p>An iron condor involves selling an out-of-the-money call option and an out-of-the-money put option while simultaneously buying a further out-of-the-money call option and put option. This strategy profits from low volatility and a narrow price range for the underlying asset.</p>
<h3 id="8-butterfly-spread"><a class="header" href="#8-butterfly-spread">8. Butterfly Spread</a></h3>
<p>A butterfly spread involves buying a call option (or put option) with a lower strike price, selling two call options (or put options) with a middle strike price, and buying a call option (or put option) with a higher strike price. This strategy profits from low volatility and a stable price for the underlying asset.</p>
<h3 id="9-calendar-spread"><a class="header" href="#9-calendar-spread">9. Calendar Spread</a></h3>
<p>A calendar spread involves buying and selling options with the same strike price but different expiration dates. This strategy profits from changes in volatility and the passage of time.</p>
<h3 id="10-collar"><a class="header" href="#10-collar">10. Collar</a></h3>
<p>A collar involves holding a long position in an underlying asset, buying a protective put option, and selling a covered call option. This strategy provides downside protection while limiting upside potential.</p>
<p>Each of these strategies has its own risk and reward profile, making them suitable for different market conditions and investment goals. Understanding and selecting the appropriate option strategy can help investors manage risk and enhance returns.</p>
<h3 id="11-long-call"><a class="header" href="#11-long-call">11. Long Call</a></h3>
<p>A long call involves buying a call option with the expectation that the underlying asset's price will rise above the strike price before the option expires. This strategy offers unlimited profit potential with limited risk, as the maximum loss is the premium paid for the option.</p>
<h3 id="12-long-put"><a class="header" href="#12-long-put">12. Long Put</a></h3>
<p>A long put involves buying a put option with the expectation that the underlying asset's price will fall below the strike price before the option expires. This strategy offers significant profit potential with limited risk, as the maximum loss is the premium paid for the option.</p>
<h3 id="13-short-call"><a class="header" href="#13-short-call">13. Short Call</a></h3>
<p>A short call involves selling a call option without owning the underlying asset. This strategy generates income from the option premium but carries unlimited risk if the asset's price rises significantly.</p>
<h3 id="14-short-put"><a class="header" href="#14-short-put">14. Short Put</a></h3>
<p>A short put involves selling a put option with the expectation that the underlying asset's price will remain above the strike price. This strategy generates income from the option premium but carries significant risk if the asset's price falls below the strike price.</p>
<h3 id="15-diagonal-spread"><a class="header" href="#15-diagonal-spread">15. Diagonal Spread</a></h3>
<p>A diagonal spread involves buying and selling options with different strike prices and expiration dates. This strategy combines elements of both calendar and vertical spreads, allowing traders to profit from changes in volatility and price movements.</p>
<h3 id="16-ratio-spread"><a class="header" href="#16-ratio-spread">16. Ratio Spread</a></h3>
<p>A ratio spread involves buying a certain number of options and selling a different number of options with the same expiration date but different strike prices. This strategy can be used to profit from moderate price movements while managing risk.</p>
<h3 id="17-box-spread"><a class="header" href="#17-box-spread">17. Box Spread</a></h3>
<p>A box spread involves combining a bull call spread and a bear put spread with the same strike prices and expiration dates. This strategy is used to lock in a risk-free profit when there is a discrepancy in option pricing.</p>
<h3 id="18-synthetic-long-stock"><a class="header" href="#18-synthetic-long-stock">18. Synthetic Long Stock</a></h3>
<p>A synthetic long stock involves buying a call option and selling a put option with the same strike price and expiration date. This strategy mimics the payoff of holding the underlying asset without actually owning it.</p>
<h3 id="19-synthetic-short-stock"><a class="header" href="#19-synthetic-short-stock">19. Synthetic Short Stock</a></h3>
<p>A synthetic short stock involves selling a call option and buying a put option with the same strike price and expiration date. This strategy mimics the payoff of shorting the underlying asset without actually shorting it.</p>
<h3 id="20-iron-butterfly"><a class="header" href="#20-iron-butterfly">20. Iron Butterfly</a></h3>
<p>An iron butterfly involves selling an at-the-money call option and an at-the-money put option while simultaneously buying an out-of-the-money call option and an out-of-the-money put option. This strategy profits from low volatility and a stable price for the underlying asset.</p>
<p>By understanding and utilizing these additional option strategies, traders can further diversify their approaches to managing risk and capitalizing on market opportunities. Each strategy has its own unique characteristics and potential benefits, making it essential for traders to carefully consider their objectives and market conditions when selecting an appropriate strategy.</p>
<h2 id="how-to-trade-options"><a class="header" href="#how-to-trade-options">How to Trade Options</a></h2>
<p>Trading options involves several steps, from understanding the market to executing trades. Here is a step-by-step guide on how to trade options:</p>
<h3 id="step-1-understand-the-basics"><a class="header" href="#step-1-understand-the-basics">Step 1: Understand the Basics</a></h3>
<p>Before trading options, it's essential to understand the basics of how options contracts work. This includes knowing the key terms, such as strike price, expiration date, premium, and the difference between call and put options. Familiarize yourself with the different types of options strategies available, such as covered calls, protective puts, and spreads.</p>
<h3 id="step-2-choose-an-options-broker"><a class="header" href="#step-2-choose-an-options-broker">Step 2: Choose an Options Broker</a></h3>
<p>To trade options, you need to open an account with an options broker. Look for a broker that offers a user-friendly trading platform, competitive fees, and reliable customer support. Ensure the broker is regulated and has a good reputation in the industry.</p>
<h3 id="step-3-develop-a-trading-plan"><a class="header" href="#step-3-develop-a-trading-plan">Step 3: Develop a Trading Plan</a></h3>
<p>A trading plan is crucial for success in options trading. Your plan should outline your trading goals, risk tolerance, and strategies. Decide on the types of options contracts you want to trade and the timeframes you will focus on. Set clear entry and exit points, as well as stop-loss and take-profit levels.</p>
<h3 id="step-4-analyze-the-market"><a class="header" href="#step-4-analyze-the-market">Step 4: Analyze the Market</a></h3>
<p>Conduct thorough market analysis to identify trading opportunities. Use technical analysis tools, such as charts, indicators, and patterns, to analyze price movements. Additionally, consider fundamental analysis by keeping track of economic news, reports, and events that may impact the options markets.</p>
<h3 id="step-5-place-your-trade"><a class="header" href="#step-5-place-your-trade">Step 5: Place Your Trade</a></h3>
<p>Once you have identified a trading opportunity, place your trade through your broker's trading platform. Specify the contract you want to trade, the number of contracts, and the order type (e.g., market order, limit order). Ensure you have sufficient margin in your account to cover the trade.</p>
<h3 id="step-6-monitor-and-manage-your-trade"><a class="header" href="#step-6-monitor-and-manage-your-trade">Step 6: Monitor and Manage Your Trade</a></h3>
<p>After placing your trade, continuously monitor the market and manage your position. Adjust your stop-loss and take-profit levels as needed to protect your profits and limit losses. Be prepared to exit the trade if the market moves against you or if your target is reached.</p>
<h3 id="step-7-review-and-learn"><a class="header" href="#step-7-review-and-learn">Step 7: Review and Learn</a></h3>
<p>After closing your trade, review the outcome and analyze your performance. Identify what worked well and what could be improved. Use this information to refine your trading plan and strategies for future trades.</p>
<h3 id="example-scenario-10"><a class="header" href="#example-scenario-10">Example Scenario</a></h3>
<p>Consider a trader who wants to trade call options on a tech stock. Here is how they might approach the trade:</p>
<ol>
<li><strong>Understand the Basics</strong>: The trader learns that a call option gives them the right to buy the stock at a specific price before the expiration date.</li>
<li><strong>Choose an Options Broker</strong>: The trader opens an account with a reputable broker that offers competitive fees and a robust trading platform.</li>
<li><strong>Develop a Trading Plan</strong>: The trader sets a goal to profit from short-term price movements in the tech stock and decides to use technical analysis for entry and exit points.</li>
<li><strong>Analyze the Market</strong>: The trader analyzes the stock's price charts and identifies a bullish trend supported by positive earnings reports.</li>
<li><strong>Place the Trade</strong>: The trader places a market order to buy call options with a strike price close to the current stock price.</li>
<li><strong>Monitor and Manage</strong>: The trader sets a stop-loss order below a recent support level and a take-profit order at a higher resistance level. They monitor the trade and adjust the orders as needed.</li>
<li><strong>Review and Learn</strong>: After closing the trade, the trader reviews the outcome and notes that the bullish trend continued, resulting in a profitable trade. They use this experience to refine their future trading strategies.</li>
</ol>
<h3 id="conclusion-32"><a class="header" href="#conclusion-32">Conclusion</a></h3>
<p>Trading options can be a rewarding endeavor, but it requires a solid understanding of the market, a well-developed trading plan, and disciplined execution. By following these steps and continuously learning from your experiences, you can improve your chances of success in the options markets.</p>
<h2 id="where-to-get-good-options-data"><a class="header" href="#where-to-get-good-options-data">Where to Get Good Options Data</a></h2>
<p>Access to reliable and accurate options data is crucial for making informed trading decisions. Here are some sources where you can get good options data:</p>
<ol>
<li>
<p><strong>Brokerage Platforms</strong>: Many brokerage platforms provide comprehensive options data, including real-time quotes, historical data, and analytical tools. Examples include TD Ameritrade, E*TRADE, and Interactive Brokers.</p>
</li>
<li>
<p><strong>Financial News Websites</strong>: Websites like Yahoo Finance, Google Finance, and Bloomberg offer options data along with news, analysis, and market insights.</p>
</li>
<li>
<p><strong>Market Data Providers</strong>: Companies like Cboe Global Markets, Nasdaq, and NYSE provide extensive options data, including real-time and historical data, market statistics, and analytics.</p>
</li>
<li>
<p><strong>Data Aggregators</strong>: Services like Options Data Warehouse and Quandl aggregate options data from multiple sources, providing a centralized platform for accessing comprehensive data sets.</p>
</li>
<li>
<p><strong>Specialized Tools</strong>: Tools like OptionVue, LiveVol, and ThinkOrSwim offer advanced options analysis and data visualization features, catering to both retail and professional traders.</p>
</li>
</ol>
<h2 id="brokers-with-automated-trading"><a class="header" href="#brokers-with-automated-trading">Brokers with Automated Trading</a></h2>
<p>Automated trading can help you execute trades more efficiently and take advantage of market opportunities in real-time. Here are some brokers that offer automated trading capabilities:</p>
<ol>
<li>
<p><strong>Interactive Brokers</strong>: Interactive Brokers provides a robust API that allows traders to automate their trading strategies using various programming languages, including Python, Java, and C++.</p>
</li>
<li>
<p><strong>TD Ameritrade</strong>: TD Ameritrade's thinkorswim platform offers automated trading through its thinkScript language, enabling traders to create custom scripts and strategies.</p>
</li>
<li>
<p><strong>E*TRADE</strong>: E*TRADE offers automated trading through its API, allowing traders to develop and implement automated trading strategies using their preferred programming languages.</p>
</li>
<li>
<p><strong>TradeStation</strong>: TradeStation provides a powerful platform for automated trading, with EasyLanguage for strategy development and integration with various third-party tools and APIs.</p>
</li>
<li>
<p><strong>Alpaca</strong>: Alpaca is a commission-free broker that offers a user-friendly API for automated trading, making it accessible for both beginner and experienced traders.</p>
</li>
<li>
<p><strong>QuantConnect</strong>: QuantConnect is a cloud-based algorithmic trading platform that integrates with multiple brokers, including Interactive Brokers and Tradier, allowing traders to develop and deploy automated trading strategies.</p>
</li>
</ol>
<p>By leveraging these sources for options data and brokers with automated trading capabilities, you can enhance your trading strategies and improve your overall trading performance.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="futures"><a class="header" href="#futures">Futures</a></h1>
<h2 id="what-are-futures"><a class="header" href="#what-are-futures">What are Futures?</a></h2>
<p>Futures are financial contracts obligating the buyer to purchase an asset or the seller to sell an asset at a predetermined future date and price. These contracts are standardized and traded on futures exchanges. Futures can be used for hedging or speculative purposes.</p>
<h3 id="key-features-of-futures"><a class="header" href="#key-features-of-futures">Key Features of Futures</a></h3>
<ol>
<li><strong>Standardization</strong>: Futures contracts are standardized in terms of quantity, quality, and delivery time, making them easily tradable on exchanges.</li>
<li><strong>Leverage</strong>: Futures allow traders to control large positions with a relatively small amount of capital, providing the potential for significant gains or losses.</li>
<li><strong>Margin Requirements</strong>: Traders are required to deposit a margin, which is a fraction of the contract's value, to enter into a futures position. This margin acts as a security deposit to cover potential losses.</li>
<li><strong>Settlement</strong>: Futures contracts can be settled either by physical delivery of the underlying asset or by cash settlement, depending on the terms of the contract.</li>
</ol>
<h3 id="types-of-futures-contracts"><a class="header" href="#types-of-futures-contracts">Types of Futures Contracts</a></h3>
<ol>
<li><strong>Commodity Futures</strong>: These contracts involve physical commodities such as oil, gold, wheat, and corn. They are commonly used by producers and consumers to hedge against price fluctuations.</li>
<li><strong>Financial Futures</strong>: These contracts involve financial instruments such as currencies, interest rates, and stock indices. They are often used by investors and institutions to manage financial risk.</li>
<li><strong>Index Futures</strong>: These contracts are based on stock market indices like the S&amp;P 500 or the Dow Jones Industrial Average. They allow traders to speculate on the overall direction of the market.</li>
<li><strong>Currency Futures</strong>: These contracts involve the exchange of one currency for another at a future date. They are used by businesses and investors to hedge against currency risk.</li>
</ol>
<h3 id="example-scenario-11"><a class="header" href="#example-scenario-11">Example Scenario</a></h3>
<p>Consider a wheat farmer who wants to lock in a price for their crop to protect against the risk of falling prices. The farmer can sell wheat futures contracts, agreeing to deliver a specified quantity of wheat at a predetermined price on a future date. If the market price of wheat falls, the farmer is protected because they have locked in a higher price through the futures contract.</p>
<h3 id="advantages-of-futures"><a class="header" href="#advantages-of-futures">Advantages of Futures</a></h3>
<ol>
<li><strong>Risk Management</strong>: Futures allow businesses and investors to hedge against price fluctuations, reducing uncertainty and managing risk.</li>
<li><strong>Liquidity</strong>: Futures markets are highly liquid, allowing traders to enter and exit positions easily.</li>
<li><strong>Price Discovery</strong>: Futures markets provide valuable information about future price expectations, helping businesses and investors make informed decisions.</li>
<li><strong>Diversification</strong>: Futures offer opportunities to diversify investment portfolios by gaining exposure to different asset classes.</li>
</ol>
<h3 id="conclusion-33"><a class="header" href="#conclusion-33">Conclusion</a></h3>
<p>Futures are powerful financial instruments that provide opportunities for hedging and speculation. By understanding the key features, types, and advantages of futures, traders and investors can effectively manage risk and capitalize on market opportunities. Whether used for hedging against price fluctuations or speculating on market movements, futures play a crucial role in the global financial markets.</p>
<h2 id="difference-between-futures-and-options"><a class="header" href="#difference-between-futures-and-options">Difference Between Futures and Options</a></h2>
<p>Futures and options are both financial derivatives that allow traders to speculate on the price movements of underlying assets. However, there are key differences between the two:</p>
<h3 id="futures-1"><a class="header" href="#futures-1">Futures</a></h3>
<ol>
<li><strong>Obligation</strong>: Futures contracts obligate the buyer to purchase and the seller to sell the underlying asset at a predetermined price and date.</li>
<li><strong>Standardization</strong>: Futures contracts are standardized in terms of quantity, quality, and delivery time, making them easily tradable on exchanges.</li>
<li><strong>Leverage</strong>: Futures allow traders to control large positions with a relatively small amount of capital, providing the potential for significant gains or losses.</li>
<li><strong>Margin Requirements</strong>: Traders are required to deposit a margin, which is a fraction of the contract's value, to enter into a futures position. This margin acts as a security deposit to cover potential losses.</li>
<li><strong>Settlement</strong>: Futures contracts can be settled either by physical delivery of the underlying asset or by cash settlement, depending on the terms of the contract.</li>
</ol>
<h3 id="options-1"><a class="header" href="#options-1">Options</a></h3>
<ol>
<li><strong>Right, Not Obligation</strong>: Options contracts give the buyer the right, but not the obligation, to buy (call option) or sell (put option) the underlying asset at a predetermined price and date.</li>
<li><strong>Premium</strong>: The buyer of an options contract pays a premium to the seller for the right to exercise the option. This premium is the maximum loss the buyer can incur.</li>
<li><strong>Leverage</strong>: Options also provide leverage, allowing traders to control large positions with a relatively small amount of capital. However, the potential loss for the buyer is limited to the premium paid.</li>
<li><strong>Types of Options</strong>: There are two main types of options: call options and put options. Call options give the buyer the right to buy the underlying asset, while put options give the buyer the right to sell the underlying asset.</li>
<li><strong>Expiration</strong>: Options contracts have an expiration date, after which the option becomes worthless if not exercised.</li>
</ol>
<h3 id="key-differences-2"><a class="header" href="#key-differences-2">Key Differences</a></h3>
<ol>
<li><strong>Obligation vs. Right</strong>: Futures contracts create an obligation for both parties, while options contracts provide the buyer with a right without obligation.</li>
<li><strong>Risk and Reward</strong>: In futures, both parties face unlimited risk and reward potential. In options, the buyer's risk is limited to the premium paid, while the seller faces unlimited risk.</li>
<li><strong>Cost</strong>: Futures require margin deposits, while options require the payment of a premium.</li>
<li><strong>Flexibility</strong>: Options offer more flexibility due to the right to exercise, while futures are more rigid with mandatory settlement.</li>
</ol>
<h3 id="example-scenario-12"><a class="header" href="#example-scenario-12">Example Scenario</a></h3>
<p>Consider an investor who wants to speculate on the price of gold. They can choose between futures and options:</p>
<ul>
<li><strong>Futures</strong>: The investor buys a gold futures contract, obligating them to purchase gold at a specified price on a future date. If the price of gold rises, the investor profits. If the price falls, the investor incurs a loss.</li>
<li><strong>Options</strong>: The investor buys a call option on gold, giving them the right to buy gold at a specified price on or before the expiration date. If the price of gold rises, the investor can exercise the option and profit. If the price falls, the investor's loss is limited to the premium paid for the option.</li>
</ul>
<h3 id="conclusion-34"><a class="header" href="#conclusion-34">Conclusion</a></h3>
<p>Both futures and options are valuable tools for traders and investors to manage risk and speculate on price movements. Understanding the differences between these derivatives is crucial for making informed trading decisions. Futures provide an obligation to buy or sell, while options offer the right without obligation, each with its own risk and reward profile.</p>
<h2 id="how-to-trade-futures"><a class="header" href="#how-to-trade-futures">How to Trade Futures</a></h2>
<p>Trading futures involves several steps, from understanding the market to executing trades. Here is a step-by-step guide on how to trade futures:</p>
<h3 id="step-1-understand-the-basics-1"><a class="header" href="#step-1-understand-the-basics-1">Step 1: Understand the Basics</a></h3>
<p>Before trading futures, it's essential to understand the basics of how futures contracts work. This includes knowing the key terms, such as contract size, expiration date, and margin requirements. Familiarize yourself with the different types of futures contracts available, such as commodities, financials, and indices.</p>
<h3 id="step-2-choose-a-futures-broker"><a class="header" href="#step-2-choose-a-futures-broker">Step 2: Choose a Futures Broker</a></h3>
<p>To trade futures, you need to open an account with a futures broker. Look for a broker that offers a user-friendly trading platform, competitive fees, and reliable customer support. Ensure the broker is regulated and has a good reputation in the industry.</p>
<h3 id="step-3-develop-a-trading-plan-1"><a class="header" href="#step-3-develop-a-trading-plan-1">Step 3: Develop a Trading Plan</a></h3>
<p>A trading plan is crucial for success in futures trading. Your plan should outline your trading goals, risk tolerance, and strategies. Decide on the types of futures contracts you want to trade and the timeframes you will focus on. Set clear entry and exit points, as well as stop-loss and take-profit levels.</p>
<h3 id="step-4-analyze-the-market-1"><a class="header" href="#step-4-analyze-the-market-1">Step 4: Analyze the Market</a></h3>
<p>Conduct thorough market analysis to identify trading opportunities. Use technical analysis tools, such as charts, indicators, and patterns, to analyze price movements. Additionally, consider fundamental analysis by keeping track of economic news, reports, and events that may impact the futures markets.</p>
<h3 id="step-5-place-your-trade-1"><a class="header" href="#step-5-place-your-trade-1">Step 5: Place Your Trade</a></h3>
<p>Once you have identified a trading opportunity, place your trade through your broker's trading platform. Specify the contract you want to trade, the number of contracts, and the order type (e.g., market order, limit order). Ensure you have sufficient margin in your account to cover the trade.</p>
<h3 id="step-6-monitor-and-manage-your-trade-1"><a class="header" href="#step-6-monitor-and-manage-your-trade-1">Step 6: Monitor and Manage Your Trade</a></h3>
<p>After placing your trade, continuously monitor the market and manage your position. Adjust your stop-loss and take-profit levels as needed to protect your profits and limit losses. Be prepared to exit the trade if the market moves against you or if your target is reached.</p>
<h3 id="step-7-review-and-learn-1"><a class="header" href="#step-7-review-and-learn-1">Step 7: Review and Learn</a></h3>
<p>After closing your trade, review the outcome and analyze your performance. Identify what worked well and what could be improved. Use this information to refine your trading plan and strategies for future trades.</p>
<h3 id="example-scenario-13"><a class="header" href="#example-scenario-13">Example Scenario</a></h3>
<p>Consider a trader who wants to trade crude oil futures. Here is how they might approach the trade:</p>
<ol>
<li><strong>Understand the Basics</strong>: The trader learns that a crude oil futures contract represents 1,000 barrels of oil and has specific expiration dates.</li>
<li><strong>Choose a Futures Broker</strong>: The trader opens an account with a reputable broker that offers competitive fees and a robust trading platform.</li>
<li><strong>Develop a Trading Plan</strong>: The trader sets a goal to profit from short-term price movements in crude oil and decides to use technical analysis for entry and exit points.</li>
<li><strong>Analyze the Market</strong>: The trader analyzes crude oil price charts and identifies a bullish trend supported by positive economic news.</li>
<li><strong>Place the Trade</strong>: The trader places a market order to buy one crude oil futures contract at the current price.</li>
<li><strong>Monitor and Manage</strong>: The trader sets a stop-loss order below a recent support level and a take-profit order at a higher resistance level. They monitor the trade and adjust the orders as needed.</li>
<li><strong>Review and Learn</strong>: After closing the trade, the trader reviews the outcome and notes that the bullish trend continued, resulting in a profitable trade. They use this experience to refine their future trading strategies.</li>
</ol>
<h3 id="conclusion-35"><a class="header" href="#conclusion-35">Conclusion</a></h3>
<p>Trading futures can be a rewarding endeavor, but it requires a solid understanding of the market, a well-developed trading plan, and disciplined execution. By following these steps and continuously learning from your experiences, you can improve your chances of success in the futures markets.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="crypto"><a class="header" href="#crypto">Crypto</a></h1>
<h2 id="proof-of-work"><a class="header" href="#proof-of-work">Proof of Work</a></h2>
<p>Proof of Work (PoW) is a consensus mechanism used in blockchain networks to validate transactions and secure the network. It requires participants, known as miners, to solve complex mathematical puzzles to add new blocks to the blockchain. The first miner to solve the puzzle gets the right to add the block and is rewarded with cryptocurrency.</p>
<h3 id="how-proof-of-work-works"><a class="header" href="#how-proof-of-work-works">How Proof of Work Works</a></h3>
<ol>
<li><strong>Transaction Collection</strong>: Miners collect and verify transactions from the network, grouping them into a block.</li>
<li><strong>Puzzle Solving</strong>: Miners compete to solve a cryptographic puzzle, which involves finding a nonce (a random number) that, when hashed with the block's data, produces a hash that meets the network's difficulty target.</li>
<li><strong>Block Validation</strong>: The first miner to solve the puzzle broadcasts the solution to the network. Other miners validate the solution and the block.</li>
<li><strong>Block Addition</strong>: Once validated, the block is added to the blockchain, and the miner receives a reward, typically in the form of newly minted cryptocurrency and transaction fees.</li>
<li><strong>Difficulty Adjustment</strong>: The network periodically adjusts the difficulty of the puzzle to ensure a consistent block generation time, usually around 10 minutes for Bitcoin.</li>
</ol>
<h3 id="key-concepts-32"><a class="header" href="#key-concepts-32">Key Concepts</a></h3>
<ol>
<li><strong>Hash Function</strong>: A cryptographic function that converts input data into a fixed-size string of characters, which appears random. Bitcoin uses the SHA-256 hash function.</li>
<li><strong>Nonce</strong>: A random number that miners change to find a hash that meets the difficulty target.</li>
<li><strong>Difficulty Target</strong>: A value that determines how hard it is to find a valid hash. The lower the target, the more difficult the puzzle.</li>
<li><strong>Block Reward</strong>: The incentive miners receive for adding a new block to the blockchain. This reward decreases over time in events known as "halvings."</li>
</ol>
<h3 id="advantages-of-proof-of-work"><a class="header" href="#advantages-of-proof-of-work">Advantages of Proof of Work</a></h3>
<ol>
<li><strong>Security</strong>: PoW provides strong security by making it computationally expensive to alter the blockchain. An attacker would need more computational power than the rest of the network combined to succeed.</li>
<li><strong>Decentralization</strong>: PoW promotes decentralization by allowing anyone with the necessary hardware to participate in mining, reducing the risk of central control.</li>
<li><strong>Proven Track Record</strong>: PoW has been successfully used by Bitcoin and other cryptocurrencies for over a decade, demonstrating its effectiveness in securing blockchain networks.</li>
</ol>
<h3 id="disadvantages-of-proof-of-work"><a class="header" href="#disadvantages-of-proof-of-work">Disadvantages of Proof of Work</a></h3>
<ol>
<li><strong>Energy Consumption</strong>: PoW requires significant computational power, leading to high energy consumption and environmental concerns.</li>
<li><strong>Centralization Risk</strong>: Over time, mining can become concentrated in regions with cheap electricity or among entities with access to specialized hardware, potentially reducing decentralization.</li>
<li><strong>Scalability</strong>: PoW can limit the scalability of blockchain networks due to the time and resources required to solve puzzles and add new blocks.</li>
</ol>
<h3 id="conclusion-36"><a class="header" href="#conclusion-36">Conclusion</a></h3>
<p>Proof of Work is a foundational consensus mechanism in blockchain technology, providing security and decentralization through computational effort. While it has proven effective, its energy consumption and scalability challenges have led to the exploration of alternative mechanisms like Proof of Stake (PoS). Nonetheless, PoW remains a critical component of many blockchain networks, ensuring the integrity and trustworthiness of decentralized systems.</p>
<h2 id="proof-of-stake"><a class="header" href="#proof-of-stake">Proof of Stake</a></h2>
<p>Proof of Stake (PoS) is an alternative consensus mechanism to Proof of Work (PoW) used in blockchain networks to validate transactions and secure the network. Instead of relying on computational power to solve complex puzzles, PoS selects validators based on the number of coins they hold and are willing to "stake" as collateral.</p>
<h3 id="how-proof-of-stake-works"><a class="header" href="#how-proof-of-stake-works">How Proof of Stake Works</a></h3>
<ol>
<li><strong>Validator Selection</strong>: Validators are chosen to create new blocks and validate transactions based on the number of coins they hold and lock up as collateral. The more coins a validator stakes, the higher their chances of being selected.</li>
<li><strong>Block Creation</strong>: The selected validator creates a new block and adds it to the blockchain. This process is known as "forging" or "minting" rather than "mining."</li>
<li><strong>Transaction Validation</strong>: Other validators in the network verify the new block. If the block is valid, it is added to the blockchain, and the validator receives a reward.</li>
<li><strong>Slashing</strong>: If a validator is found to act maliciously or validate fraudulent transactions, a portion of their staked coins can be forfeited as a penalty. This mechanism is known as "slashing" and helps maintain network security and integrity.</li>
</ol>
<h3 id="key-concepts-33"><a class="header" href="#key-concepts-33">Key Concepts</a></h3>
<ol>
<li><strong>Staking</strong>: The process of locking up a certain amount of cryptocurrency to participate in the validation process. Validators are incentivized to act honestly to avoid losing their staked coins.</li>
<li><strong>Validator</strong>: A participant in the network who is responsible for creating new blocks and validating transactions. Validators are chosen based on the amount of cryptocurrency they stake.</li>
<li><strong>Slashing</strong>: A penalty mechanism that confiscates a portion of a validator's staked coins if they are found to act maliciously or validate fraudulent transactions.</li>
<li><strong>Delegated Proof of Stake (DPoS)</strong>: A variation of PoS where stakeholders vote for a small number of delegates to validate transactions and create new blocks on their behalf. This system aims to improve efficiency and scalability.</li>
</ol>
<h3 id="advantages-of-proof-of-stake"><a class="header" href="#advantages-of-proof-of-stake">Advantages of Proof of Stake</a></h3>
<ol>
<li><strong>Energy Efficiency</strong>: PoS is significantly more energy-efficient than PoW, as it does not require extensive computational power to validate transactions and create new blocks.</li>
<li><strong>Security</strong>: PoS provides strong security by aligning the interests of validators with the network. Validators are incentivized to act honestly to avoid losing their staked coins.</li>
<li><strong>Decentralization</strong>: PoS promotes decentralization by allowing a broader range of participants to become validators, as it does not require specialized hardware or significant energy consumption.</li>
<li><strong>Scalability</strong>: PoS can improve the scalability of blockchain networks by reducing the time and resources required to validate transactions and create new blocks.</li>
</ol>
<h3 id="disadvantages-of-proof-of-stake"><a class="header" href="#disadvantages-of-proof-of-stake">Disadvantages of Proof of Stake</a></h3>
<ol>
<li><strong>Wealth Concentration</strong>: PoS can lead to wealth concentration, as validators with more coins have a higher chance of being selected to create new blocks and earn rewards.</li>
<li><strong>Initial Distribution</strong>: The initial distribution of coins can impact the fairness and decentralization of the network, as early adopters or large holders may have more influence.</li>
<li><strong>Complexity</strong>: PoS mechanisms can be more complex to implement and understand compared to PoW, requiring careful design to ensure security and fairness.</li>
</ol>
<h3 id="conclusion-37"><a class="header" href="#conclusion-37">Conclusion</a></h3>
<p>Proof of Stake is a promising alternative to Proof of Work, offering significant improvements in energy efficiency, security, and scalability. By selecting validators based on the number of coins they stake, PoS aligns the interests of participants with the network's integrity. While it has its challenges, such as potential wealth concentration and complexity, PoS continues to gain traction as a viable consensus mechanism for blockchain networks, driving innovation and sustainability in the cryptocurrency space.</p>
<h2 id="solana"><a class="header" href="#solana">Solana</a></h2>
<h3 id="important-concepts-and-token-economics-of-solana"><a class="header" href="#important-concepts-and-token-economics-of-solana">Important Concepts and Token Economics of Solana</a></h3>
<p>Solana is a high-performance blockchain platform designed for decentralized applications and crypto-currencies. It aims to provide scalability without compromising decentralization and security. Here are some important concepts and token economics of Solana:</p>
<h3 id="important-concepts"><a class="header" href="#important-concepts">Important Concepts</a></h3>
<ol>
<li>
<p><strong>Proof of History (PoH)</strong>: Proof of History is a unique consensus mechanism used by Solana to timestamp transactions before they are included in the blockchain. PoH creates a historical record that proves that an event has occurred at a specific moment in time. This allows the network to order transactions and improve efficiency.</p>
</li>
<li>
<p><strong>Tower BFT</strong>: Tower Byzantine Fault Tolerance (BFT) is Solana's consensus algorithm that leverages PoH as a cryptographic clock to achieve consensus. Tower BFT reduces the communication overhead and latency, enabling faster transaction finality.</p>
</li>
<li>
<p><strong>Turbine</strong>: Turbine is Solana's block propagation protocol. It breaks data into smaller packets and transmits them across the network in a way that reduces bandwidth requirements and increases the speed of data transmission.</p>
</li>
<li>
<p><strong>Gulf Stream</strong>: Gulf Stream is Solana's mempool-less transaction forwarding protocol. It pushes transaction caching and forwarding to the edge of the network, allowing validators to execute transactions ahead of time, reducing confirmation times and improving network efficiency.</p>
</li>
<li>
<p><strong>Sealevel</strong>: Sealevel is Solana's parallel smart contract runtime. It allows multiple smart contracts to run in parallel, leveraging the multi-core processors in modern hardware to achieve high throughput.</p>
</li>
<li>
<p><strong>Pipelining</strong>: Pipelining is a process used by Solana to optimize the validation process. It involves a series of stages where different parts of transaction validation are handled by different hardware units, improving overall throughput.</p>
</li>
<li>
<p><strong>Cloudbreak</strong>: Cloudbreak is Solana's horizontally-scalable accounts database. It allows the network to handle a large number of accounts and transactions efficiently by distributing the data across multiple storage devices.</p>
</li>
<li>
<p><strong>Archivers</strong>: Archivers are nodes in the Solana network responsible for storing data. They offload the storage burden from validators, ensuring that the blockchain remains lightweight and efficient.</p>
</li>
</ol>
<h3 id="token-economics"><a class="header" href="#token-economics">Token Economics</a></h3>
<ol>
<li>
<p><strong>SOL Token</strong>: SOL is the native cryptocurrency of the Solana network. It is used to pay for transaction fees, participate in the network's consensus mechanism, and interact with smart contracts.</p>
</li>
<li>
<p><strong>Staking</strong>: SOL token holders can stake their tokens to become validators or delegate their tokens to other validators. Staking helps secure the network and participants earn rewards in the form of additional SOL tokens.</p>
</li>
<li>
<p><strong>Inflation</strong>: Solana has an inflationary supply model, where new SOL tokens are minted and distributed as staking rewards. The initial inflation rate is set at 8% per year and is designed to decrease over time, eventually stabilizing at around 1.5% per year.</p>
</li>
<li>
<p><strong>Transaction Fees</strong>: Transaction fees on the Solana network are paid in SOL tokens. These fees are relatively low compared to other blockchain networks, making Solana an attractive platform for high-frequency and micro-transactions.</p>
</li>
<li>
<p><strong>Burn Mechanism</strong>: A portion of the transaction fees collected on the Solana network is burned, reducing the total supply of SOL tokens over time. This deflationary mechanism helps counteract the inflationary supply model and can potentially increase the value of SOL tokens.</p>
</li>
<li>
<p><strong>Ecosystem Incentives</strong>: Solana has various incentive programs to encourage the development and growth of its ecosystem. These include grants, hackathons, and partnerships aimed at attracting developers, projects, and users to the platform.</p>
</li>
</ol>
<p>Solana's innovative technology and well-designed token economics make it a promising platform for scalable and efficient decentralized applications. Its focus on high throughput, low latency, and low transaction costs positions it as a strong contender in the blockchain space.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="databases--data-engineering"><a class="header" href="#databases--data-engineering">Databases &amp; Data Engineering</a></h1>
<p>Database systems and data engineering concepts for storing, querying, and managing data at scale.</p>
<h2 id="topics-covered"><a class="header" href="#topics-covered">Topics Covered</a></h2>
<h3 id="relational-databases"><a class="header" href="#relational-databases">Relational Databases</a></h3>
<ul>
<li><strong><a href="databases/sql.html">SQL</a></strong> - SQL fundamentals, queries, joins, indexes, transactions</li>
<li><strong><a href="databases/postgres.html">PostgreSQL</a></strong> - Advanced PostgreSQL features, JSON support, performance tuning</li>
<li><strong><a href="databases/sqlite.html">SQLite</a></strong> - Lightweight embedded database for applications</li>
<li><strong><a href="databases/duckdb.html">DuckDB</a></strong> - Analytical database for data analysis and OLAP queries</li>
</ul>
<h3 id="nosql-databases"><a class="header" href="#nosql-databases">NoSQL Databases</a></h3>
<ul>
<li><strong><a href="databases/nosql.html">NoSQL</a></strong> - NoSQL databases overview, types, and use cases</li>
<li><strong><a href="databases/mongodb.html">MongoDB</a></strong> - Document-oriented NoSQL database with rich query language</li>
<li><strong><a href="databases/redis.html">Redis</a></strong> - In-memory data store for caching, pub/sub, and real-time applications</li>
</ul>
<h3 id="message-queues--event-streaming"><a class="header" href="#message-queues--event-streaming">Message Queues &amp; Event Streaming</a></h3>
<ul>
<li><strong><a href="databases/kafka.html">Apache Kafka</a></strong> - Distributed event streaming platform for high-throughput data pipelines</li>
</ul>
<h2 id="database-concepts"><a class="header" href="#database-concepts">Database Concepts</a></h2>
<ul>
<li><strong>Data Modeling</strong>: Schema design, normalization, relationships</li>
<li><strong>Caching</strong>: In-memory stores, cache invalidation strategies</li>
<li><strong>Data Pipelines</strong>: ETL, streaming, batch processing</li>
<li><strong>Database Optimization</strong>: Query optimization, indexing strategies</li>
</ul>
<h2 id="navigation"><a class="header" href="#navigation">Navigation</a></h2>
<p>Use the menu to explore each topic in depth.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sql-structured-query-language-1"><a class="header" href="#sql-structured-query-language-1">SQL (Structured Query Language)</a></h1>
<h2 id="overview-91"><a class="header" href="#overview-91">Overview</a></h2>
<p>SQL is the standard language for querying and managing relational databases. Used by PostgreSQL, MySQL, SQL Server, Oracle, and others.</p>
<h2 id="basic-queries"><a class="header" href="#basic-queries">Basic Queries</a></h2>
<h3 id="select-1"><a class="header" href="#select-1">SELECT</a></h3>
<pre><code class="language-sql">SELECT column1, column2 FROM table WHERE condition;
SELECT * FROM users WHERE age &gt; 18;
SELECT DISTINCT city FROM customers;
</code></pre>
<h3 id="insert-1"><a class="header" href="#insert-1">INSERT</a></h3>
<pre><code class="language-sql">INSERT INTO users (name, email) VALUES ('John', 'john@example.com');
INSERT INTO users VALUES (1, 'John', 'john@example.com');
</code></pre>
<h3 id="update-1"><a class="header" href="#update-1">UPDATE</a></h3>
<pre><code class="language-sql">UPDATE users SET age = 30 WHERE id = 1;
UPDATE products SET price = price * 1.1;
</code></pre>
<h3 id="delete-1"><a class="header" href="#delete-1">DELETE</a></h3>
<pre><code class="language-sql">DELETE FROM users WHERE id = 1;
DELETE FROM logs WHERE created_at &lt; '2023-01-01';
</code></pre>
<h2 id="joins-1"><a class="header" href="#joins-1">Joins</a></h2>
<pre><code class="language-sql">-- INNER JOIN: Only matching rows
SELECT u.name, o.order_id
FROM users u INNER JOIN orders o ON u.id = o.user_id;

-- LEFT JOIN: All from left table
SELECT u.name, o.order_id
FROM users u LEFT JOIN orders o ON u.id = o.user_id;

-- RIGHT JOIN: All from right table
SELECT u.name, o.order_id
FROM users u RIGHT JOIN orders o ON u.id = o.user_id;

-- FULL OUTER JOIN: All rows
SELECT u.name, o.order_id
FROM users u FULL OUTER JOIN orders o ON u.id = o.user_id;
</code></pre>
<h2 id="aggregation-1"><a class="header" href="#aggregation-1">Aggregation</a></h2>
<pre><code class="language-sql">SELECT COUNT(*) FROM users;
SELECT AVG(price) FROM products;
SELECT SUM(amount) FROM transactions WHERE status = 'completed';
SELECT MAX(salary) FROM employees;

-- GROUP BY
SELECT department, COUNT(*) FROM employees GROUP BY department;
SELECT category, AVG(price) FROM products GROUP BY category;

-- HAVING (filter groups)
SELECT department, AVG(salary)
FROM employees
GROUP BY department
HAVING AVG(salary) &gt; 50000;
</code></pre>
<h2 id="indexes-1"><a class="header" href="#indexes-1">Indexes</a></h2>
<pre><code class="language-sql">-- Create index for faster queries
CREATE INDEX idx_email ON users(email);
CREATE INDEX idx_user_date ON orders(user_id, created_at);

-- Drop index
DROP INDEX idx_email;
</code></pre>
<h2 id="transactions-1"><a class="header" href="#transactions-1">Transactions</a></h2>
<pre><code class="language-sql">BEGIN TRANSACTION;

UPDATE accounts SET balance = balance - 100 WHERE id = 1;
UPDATE accounts SET balance = balance + 100 WHERE id = 2;

COMMIT;  -- Save changes
-- ROLLBACK;  -- Undo changes
</code></pre>
<h2 id="window-functions-1"><a class="header" href="#window-functions-1">Window Functions</a></h2>
<pre><code class="language-sql">-- Rank rows
SELECT name, salary,
  RANK() OVER (ORDER BY salary DESC) as rank
FROM employees;

-- Running total
SELECT date, amount,
  SUM(amount) OVER (ORDER BY date) as running_total
FROM transactions;
</code></pre>
<h2 id="common-patterns-19"><a class="header" href="#common-patterns-19">Common Patterns</a></h2>
<h3 id="duplicate-finding"><a class="header" href="#duplicate-finding">Duplicate Finding</a></h3>
<pre><code class="language-sql">SELECT email, COUNT(*) FROM users GROUP BY email HAVING COUNT(*) &gt; 1;
</code></pre>
<h3 id="top-n-per-group"><a class="header" href="#top-n-per-group">Top N per Group</a></h3>
<pre><code class="language-sql">SELECT DISTINCT ON (department) name, salary, department
FROM employees ORDER BY department, salary DESC;
</code></pre>
<h3 id="data-validation"><a class="header" href="#data-validation">Data Validation</a></h3>
<pre><code class="language-sql">SELECT * FROM users WHERE email NOT LIKE '%@%.%';
</code></pre>
<h2 id="performance-tips-1"><a class="header" href="#performance-tips-1">Performance Tips</a></h2>
<ol>
<li><strong>Use indexes</strong> on frequently queried columns</li>
<li><strong>EXPLAIN</strong> query plans: <code>EXPLAIN SELECT ...</code></li>
<li>**Avoid SELECT *** - specify columns needed</li>
<li><strong>Use LIMIT</strong> for large result sets</li>
<li><strong>Batch operations</strong> instead of individual queries</li>
</ol>
<h2 id="acid-properties"><a class="header" href="#acid-properties">ACID Properties</a></h2>
<ul>
<li><strong>Atomicity</strong>: All or nothing</li>
<li><strong>Consistency</strong>: Valid state to valid state</li>
<li><strong>Isolation</strong>: Concurrent transactions independent</li>
<li><strong>Durability</strong>: Committed data survives failures</li>
</ul>
<h2 id="eli10-27"><a class="header" href="#eli10-27">ELI10</a></h2>
<p>SQL is like a filing system for data:</p>
<ul>
<li><strong>SELECT</strong>: "Show me these files"</li>
<li><strong>INSERT</strong>: "Add new file"</li>
<li><strong>UPDATE</strong>: "Modify existing file"</li>
<li><strong>DELETE</strong>: "Remove file"</li>
</ul>
<p>Joins = combining data from multiple filing cabinets!</p>
<h2 id="further-resources-40"><a class="header" href="#further-resources-40">Further Resources</a></h2>
<ul>
<li><a href="https://www.w3schools.com/sql/">SQL Tutorial</a></li>
<li><a href="https://www.postgresql.org/docs/">PostgreSQL Docs</a></li>
<li><a href="https://www.postgresql.org/docs/current/sql-explain.html">Explain Plans</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="postgresql-1"><a class="header" href="#postgresql-1">PostgreSQL</a></h1>
<p>PostgreSQL is a powerful, open-source object-relational database system with over 35 years of active development. It's known for its reliability, feature robustness, and performance.</p>
<h2 id="installation-16"><a class="header" href="#installation-16">Installation</a></h2>
<pre><code class="language-bash"># Ubuntu/Debian
sudo apt update
sudo apt install postgresql postgresql-contrib

# macOS
brew install postgresql@15
brew services start postgresql@15

# CentOS/RHEL
sudo yum install postgresql-server postgresql-contrib
sudo postgresql-setup initdb
sudo systemctl start postgresql

# Check version
psql --version
</code></pre>
<h2 id="basic-usage-9"><a class="header" href="#basic-usage-9">Basic Usage</a></h2>
<pre><code class="language-bash"># Connect as postgres user
sudo -u postgres psql

# Connect to specific database
psql -U username -d database_name

# Connect to remote database
psql -h hostname -U username -d database_name

# Execute SQL file
psql -U username -d database_name -f script.sql

# Execute command from shell
psql -U username -d database_name -c "SELECT * FROM users;"
</code></pre>
<h2 id="database-operations-1"><a class="header" href="#database-operations-1">Database Operations</a></h2>
<pre><code class="language-sql">-- Create database
CREATE DATABASE mydb;

-- List databases
\l
\list

-- Connect to database
\c mydb
\connect mydb

-- Drop database
DROP DATABASE mydb;

-- Create database with options
CREATE DATABASE mydb
    WITH OWNER = myuser
    ENCODING = 'UTF8'
    LC_COLLATE = 'en_US.UTF-8'
    LC_CTYPE = 'en_US.UTF-8'
    TEMPLATE = template0;
</code></pre>
<h2 id="table-operations"><a class="header" href="#table-operations">Table Operations</a></h2>
<pre><code class="language-sql">-- Create table
CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    username VARCHAR(50) UNIQUE NOT NULL,
    email VARCHAR(100) UNIQUE NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- List tables
\dt
\dt+  -- with sizes

-- Describe table
\d users
\d+ users  -- detailed

-- Drop table
DROP TABLE users;
DROP TABLE IF EXISTS users;

-- Alter table
ALTER TABLE users ADD COLUMN age INTEGER;
ALTER TABLE users DROP COLUMN age;
ALTER TABLE users RENAME COLUMN username TO user_name;
ALTER TABLE users ALTER COLUMN email SET NOT NULL;
</code></pre>
<h2 id="crud-operations"><a class="header" href="#crud-operations">CRUD Operations</a></h2>
<pre><code class="language-sql">-- Insert
INSERT INTO users (username, email)
VALUES ('john', 'john@example.com');

-- Insert multiple
INSERT INTO users (username, email) VALUES
    ('alice', 'alice@example.com'),
    ('bob', 'bob@example.com');

-- Insert with RETURNING
INSERT INTO users (username, email)
VALUES ('jane', 'jane@example.com')
RETURNING id, username;

-- Select
SELECT * FROM users;
SELECT username, email FROM users WHERE id = 1;
SELECT * FROM users WHERE username LIKE 'jo%';
SELECT * FROM users ORDER BY created_at DESC LIMIT 10;

-- Update
UPDATE users SET email = 'newemail@example.com' WHERE id = 1;
UPDATE users SET email = 'newemail@example.com' WHERE id = 1 RETURNING *;

-- Delete
DELETE FROM users WHERE id = 1;
DELETE FROM users WHERE created_at &lt; '2023-01-01';
</code></pre>
<h2 id="indexes-2"><a class="header" href="#indexes-2">Indexes</a></h2>
<pre><code class="language-sql">-- Create index
CREATE INDEX idx_users_username ON users(username);
CREATE INDEX idx_users_email ON users(email);

-- Unique index
CREATE UNIQUE INDEX idx_users_username_unique ON users(username);

-- Composite index
CREATE INDEX idx_users_name_email ON users(username, email);

-- Partial index
CREATE INDEX idx_active_users ON users(username) WHERE active = true;

-- Full-text search index
CREATE INDEX idx_users_fulltext ON users USING GIN(to_tsvector('english', username || ' ' || email));

-- List indexes
\di
SELECT * FROM pg_indexes WHERE tablename = 'users';

-- Drop index
DROP INDEX idx_users_username;
</code></pre>
<h2 id="constraints"><a class="header" href="#constraints">Constraints</a></h2>
<pre><code class="language-sql">-- Primary key
CREATE TABLE products (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100)
);

-- Foreign key
CREATE TABLE orders (
    id SERIAL PRIMARY KEY,
    user_id INTEGER REFERENCES users(id) ON DELETE CASCADE,
    product_id INTEGER REFERENCES products(id)
);

-- Unique constraint
ALTER TABLE users ADD CONSTRAINT users_email_unique UNIQUE (email);

-- Check constraint
ALTER TABLE products ADD CONSTRAINT products_price_positive
    CHECK (price &gt; 0);

-- Not null
ALTER TABLE users ALTER COLUMN email SET NOT NULL;

-- Default
ALTER TABLE users ALTER COLUMN active SET DEFAULT true;
</code></pre>
<h2 id="joins-2"><a class="header" href="#joins-2">Joins</a></h2>
<pre><code class="language-sql">-- Inner join
SELECT u.username, o.id AS order_id
FROM users u
INNER JOIN orders o ON u.id = o.user_id;

-- Left join
SELECT u.username, o.id AS order_id
FROM users u
LEFT JOIN orders o ON u.id = o.user_id;

-- Right join
SELECT u.username, o.id AS order_id
FROM users u
RIGHT JOIN orders o ON u.id = o.user_id;

-- Full outer join
SELECT u.username, o.id AS order_id
FROM users u
FULL OUTER JOIN orders o ON u.id = o.user_id;

-- Self join
SELECT e1.name AS employee, e2.name AS manager
FROM employees e1
LEFT JOIN employees e2 ON e1.manager_id = e2.id;
</code></pre>
<h2 id="aggregations"><a class="header" href="#aggregations">Aggregations</a></h2>
<pre><code class="language-sql">-- Count
SELECT COUNT(*) FROM users;
SELECT COUNT(DISTINCT email) FROM users;

-- Sum, Avg, Min, Max
SELECT
    COUNT(*) AS total_orders,
    SUM(amount) AS total_amount,
    AVG(amount) AS avg_amount,
    MIN(amount) AS min_amount,
    MAX(amount) AS max_amount
FROM orders;

-- Group by
SELECT user_id, COUNT(*) AS order_count
FROM orders
GROUP BY user_id;

-- Having
SELECT user_id, COUNT(*) AS order_count
FROM orders
GROUP BY user_id
HAVING COUNT(*) &gt; 5;

-- Window functions
SELECT
    username,
    created_at,
    ROW_NUMBER() OVER (ORDER BY created_at) AS row_num,
    RANK() OVER (ORDER BY created_at) AS rank,
    LAG(created_at) OVER (ORDER BY created_at) AS prev_created
FROM users;
</code></pre>
<h2 id="transactions-2"><a class="header" href="#transactions-2">Transactions</a></h2>
<pre><code class="language-sql">-- Begin transaction
BEGIN;

INSERT INTO users (username, email) VALUES ('test', 'test@example.com');
UPDATE accounts SET balance = balance - 100 WHERE id = 1;
UPDATE accounts SET balance = balance + 100 WHERE id = 2;

-- Commit
COMMIT;

-- Rollback
ROLLBACK;

-- Savepoint
BEGIN;
INSERT INTO users (username, email) VALUES ('test', 'test@example.com');
SAVEPOINT my_savepoint;
UPDATE users SET email = 'new@example.com' WHERE username = 'test';
ROLLBACK TO my_savepoint;
COMMIT;
</code></pre>
<h2 id="views-1"><a class="header" href="#views-1">Views</a></h2>
<pre><code class="language-sql">-- Create view
CREATE VIEW active_users AS
SELECT id, username, email
FROM users
WHERE active = true;

-- Use view
SELECT * FROM active_users;

-- Materialized view
CREATE MATERIALIZED VIEW user_stats AS
SELECT
    user_id,
    COUNT(*) AS order_count,
    SUM(amount) AS total_spent
FROM orders
GROUP BY user_id;

-- Refresh materialized view
REFRESH MATERIALIZED VIEW user_stats;

-- Drop view
DROP VIEW active_users;
DROP MATERIALIZED VIEW user_stats;
</code></pre>
<h2 id="functions-and-procedures"><a class="header" href="#functions-and-procedures">Functions and Procedures</a></h2>
<pre><code class="language-sql">-- Create function
CREATE OR REPLACE FUNCTION get_user_count()
RETURNS INTEGER AS $$
BEGIN
    RETURN (SELECT COUNT(*) FROM users);
END;
$$ LANGUAGE plpgsql;

-- Call function
SELECT get_user_count();

-- Function with parameters
CREATE OR REPLACE FUNCTION get_user_by_id(user_id INTEGER)
RETURNS TABLE(username VARCHAR, email VARCHAR) AS $$
BEGIN
    RETURN QUERY
    SELECT u.username, u.email
    FROM users u
    WHERE u.id = user_id;
END;
$$ LANGUAGE plpgsql;

-- Call
SELECT * FROM get_user_by_id(1);

-- Procedure (PostgreSQL 11+)
CREATE OR REPLACE PROCEDURE add_user(
    p_username VARCHAR,
    p_email VARCHAR
)
LANGUAGE plpgsql AS $$
BEGIN
    INSERT INTO users (username, email)
    VALUES (p_username, p_email);
END;
$$;

-- Call procedure
CALL add_user('newuser', 'new@example.com');
</code></pre>
<h2 id="triggers"><a class="header" href="#triggers">Triggers</a></h2>
<pre><code class="language-sql">-- Create trigger function
CREATE OR REPLACE FUNCTION update_modified_column()
RETURNS TRIGGER AS $$
BEGIN
    NEW.updated_at = NOW();
    RETURN NEW;
END;
$$ LANGUAGE plpgsql;

-- Create trigger
CREATE TRIGGER update_users_modtime
BEFORE UPDATE ON users
FOR EACH ROW
EXECUTE FUNCTION update_modified_column();

-- List triggers
\dft
SELECT * FROM pg_trigger WHERE tgrelid = 'users'::regclass;

-- Drop trigger
DROP TRIGGER update_users_modtime ON users;
</code></pre>
<h2 id="json-operations"><a class="header" href="#json-operations">JSON Operations</a></h2>
<pre><code class="language-sql">-- JSON column
CREATE TABLE events (
    id SERIAL PRIMARY KEY,
    data JSONB
);

-- Insert JSON
INSERT INTO events (data) VALUES ('{"type": "click", "count": 1}');

-- Query JSON
SELECT data-&gt;&gt;'type' AS event_type FROM events;
SELECT * FROM events WHERE data-&gt;&gt;'type' = 'click';
SELECT * FROM events WHERE data-&gt;'count' &gt; '5';

-- Update JSON
UPDATE events SET data = jsonb_set(data, '{count}', '10') WHERE id = 1;

-- JSON aggregation
SELECT jsonb_agg(username) FROM users;
SELECT jsonb_object_agg(id, username) FROM users;
</code></pre>
<h2 id="full-text-search"><a class="header" href="#full-text-search">Full-Text Search</a></h2>
<pre><code class="language-sql">-- Create tsvector column
ALTER TABLE articles ADD COLUMN textsearch tsvector;

-- Update tsvector
UPDATE articles SET textsearch =
    to_tsvector('english', title || ' ' || body);

-- Create index
CREATE INDEX idx_articles_textsearch ON articles USING GIN(textsearch);

-- Search
SELECT title FROM articles
WHERE textsearch @@ to_tsquery('english', 'postgresql &amp; performance');

-- Ranking
SELECT title, ts_rank(textsearch, query) AS rank
FROM articles, to_tsquery('english', 'postgresql') query
WHERE textsearch @@ query
ORDER BY rank DESC;
</code></pre>
<h2 id="user-management-1"><a class="header" href="#user-management-1">User Management</a></h2>
<pre><code class="language-sql">-- Create user
CREATE USER myuser WITH PASSWORD 'mypassword';

-- Create role
CREATE ROLE readonly;

-- Grant privileges
GRANT SELECT ON ALL TABLES IN SCHEMA public TO readonly;
GRANT ALL PRIVILEGES ON DATABASE mydb TO myuser;
GRANT SELECT, INSERT, UPDATE ON users TO myuser;

-- Revoke privileges
REVOKE INSERT ON users FROM myuser;

-- Alter user
ALTER USER myuser WITH PASSWORD 'newpassword';
ALTER USER myuser WITH SUPERUSER;

-- Drop user
DROP USER myuser;

-- List users
\du
SELECT * FROM pg_user;
</code></pre>
<h2 id="backup-and-restore"><a class="header" href="#backup-and-restore">Backup and Restore</a></h2>
<pre><code class="language-bash"># Dump database
pg_dump -U username -d mydb &gt; mydb_backup.sql
pg_dump -U username -d mydb -F c &gt; mydb_backup.dump

# Dump specific table
pg_dump -U username -d mydb -t users &gt; users_backup.sql

# Dump all databases
pg_dumpall -U postgres &gt; all_dbs.sql

# Restore from SQL file
psql -U username -d mydb &lt; mydb_backup.sql

# Restore from custom format
pg_restore -U username -d mydb mydb_backup.dump

# Restore specific table
pg_restore -U username -d mydb -t users mydb_backup.dump
</code></pre>
<h2 id="performance-tuning-3"><a class="header" href="#performance-tuning-3">Performance Tuning</a></h2>
<pre><code class="language-sql">-- Analyze table
ANALYZE users;

-- Vacuum
VACUUM users;
VACUUM FULL users;
VACUUM ANALYZE users;

-- Explain query
EXPLAIN SELECT * FROM users WHERE username = 'john';
EXPLAIN ANALYZE SELECT * FROM users WHERE username = 'john';

-- Query statistics
SELECT * FROM pg_stat_user_tables WHERE relname = 'users';
SELECT * FROM pg_stat_user_indexes WHERE relname = 'users';

-- Active connections
SELECT * FROM pg_stat_activity;

-- Kill query
SELECT pg_cancel_backend(pid);
SELECT pg_terminate_backend(pid);

-- Table size
SELECT pg_size_pretty(pg_total_relation_size('users'));
</code></pre>
<h2 id="configuration-3"><a class="header" href="#configuration-3">Configuration</a></h2>
<pre><code class="language-bash"># postgresql.conf key settings

# Memory
shared_buffers = 256MB          # 25% of RAM
effective_cache_size = 1GB      # 50-75% of RAM
work_mem = 4MB
maintenance_work_mem = 64MB

# WAL
wal_buffers = 16MB
checkpoint_completion_target = 0.9
max_wal_size = 1GB

# Query planner
random_page_cost = 1.1         # For SSD
effective_io_concurrency = 200  # For SSD

# Connections
max_connections = 100

# Logging
log_destination = 'stderr'
logging_collector = on
log_directory = 'pg_log'
log_filename = 'postgresql-%Y-%m-%d_%H%M%S.log'
log_statement = 'all'
log_duration = on
log_min_duration_statement = 1000  # Log queries &gt; 1s
</code></pre>
<h2 id="psql-commands"><a class="header" href="#psql-commands">psql Commands</a></h2>
<pre><code class="language-bash"># Meta-commands
\?              # Help on psql commands
\h ALTER TABLE  # Help on SQL command
\l              # List databases
\c dbname       # Connect to database
\dt             # List tables
\dt+            # List tables with sizes
\d tablename    # Describe table
\d+ tablename   # Detailed table info
\di             # List indexes
\dv             # List views
\df             # List functions
\du             # List users
\dn             # List schemas
\timing         # Toggle timing
\x              # Toggle expanded output
\q              # Quit
\! command      # Execute shell command
\i file.sql     # Execute SQL file
\o file.txt     # Output to file
\o              # Output to stdout
</code></pre>
<h2 id="quick-reference-15"><a class="header" href="#quick-reference-15">Quick Reference</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody>
<tr><td><code>\l</code></td><td>List databases</td></tr>
<tr><td><code>\c database</code></td><td>Connect to database</td></tr>
<tr><td><code>\dt</code></td><td>List tables</td></tr>
<tr><td><code>\d table</code></td><td>Describe table</td></tr>
<tr><td><code>\di</code></td><td>List indexes</td></tr>
<tr><td><code>\du</code></td><td>List users</td></tr>
<tr><td><code>EXPLAIN</code></td><td>Show query plan</td></tr>
<tr><td><code>VACUUM</code></td><td>Cleanup database</td></tr>
<tr><td><code>pg_dump</code></td><td>Backup database</td></tr>
<tr><td><code>psql -f file.sql</code></td><td>Execute SQL file</td></tr>
</tbody></table>
</div>
<p>PostgreSQL is a robust, feature-rich database system suitable for applications ranging from small projects to large-scale enterprise systems.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="sqlite"><a class="header" href="#sqlite">SQLite</a></h1>
<p>SQLite is a C-language library that implements a small, fast, self-contained, high-reliability, full-featured SQL database engine. It's the most widely deployed database in the world.</p>
<h2 id="overview-92"><a class="header" href="#overview-92">Overview</a></h2>
<p>SQLite is embedded into the application, requiring no separate server process. The entire database is stored in a single cross-platform file.</p>
<p><strong>Key Features:</strong></p>
<ul>
<li>Serverless, zero-configuration</li>
<li>Self-contained (single file database)</li>
<li>Cross-platform</li>
<li>ACID compliant</li>
<li>Supports most SQL standards</li>
<li>Public domain (no license required)</li>
</ul>
<h2 id="installation-17"><a class="header" href="#installation-17">Installation</a></h2>
<pre><code class="language-bash"># Ubuntu/Debian
sudo apt update
sudo apt install sqlite3

# macOS (pre-installed, or use Homebrew)
brew install sqlite

# CentOS/RHEL
sudo yum install sqlite

# Verify
sqlite3 --version
</code></pre>
<h2 id="basic-usage-10"><a class="header" href="#basic-usage-10">Basic Usage</a></h2>
<pre><code class="language-bash"># Create/open database
sqlite3 mydb.db

# Open existing database
sqlite3 existing.db

# Execute command from shell
sqlite3 mydb.db "SELECT * FROM users;"

# Execute SQL file
sqlite3 mydb.db &lt; script.sql

# Dump database
sqlite3 mydb.db .dump &gt; backup.sql

# Exit
.quit
.exit
</code></pre>
<h2 id="database-operations-2"><a class="header" href="#database-operations-2">Database Operations</a></h2>
<pre><code class="language-sql">-- Attach database
ATTACH DATABASE 'other.db' AS other;

-- List databases
.databases

-- Detach
DETACH DATABASE other;

-- Backup database
.backup backup.db

-- Restore from backup
.restore backup.db
</code></pre>
<h2 id="table-operations-1"><a class="header" href="#table-operations-1">Table Operations</a></h2>
<pre><code class="language-sql">-- Create table
CREATE TABLE users (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    username TEXT NOT NULL UNIQUE,
    email TEXT NOT NULL UNIQUE,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);

-- List tables
.tables
.schema

-- Show table schema
.schema users
PRAGMA table_info(users);

-- Drop table
DROP TABLE users;
DROP TABLE IF EXISTS users;

-- Rename table
ALTER TABLE users RENAME TO customers;

-- Add column
ALTER TABLE users ADD COLUMN age INTEGER;

-- Rename column (SQLite 3.25.0+)
ALTER TABLE users RENAME COLUMN username TO user_name;

-- Drop column (SQLite 3.35.0+)
ALTER TABLE users DROP COLUMN age;
</code></pre>
<h2 id="data-types-6"><a class="header" href="#data-types-6">Data Types</a></h2>
<pre><code class="language-sql">-- SQLite has 5 storage classes
-- INTEGER, REAL, TEXT, BLOB, NULL

CREATE TABLE examples (
    int_col INTEGER,
    real_col REAL,
    text_col TEXT,
    blob_col BLOB,

    -- Type affinity examples
    bool_col BOOLEAN,         -- Stored as INTEGER (0 or 1)
    date_col DATE,            -- Stored as TEXT, INTEGER, or REAL
    datetime_col DATETIME,
    varchar_col VARCHAR(100), -- Stored as TEXT
    decimal_col DECIMAL(10,2) -- Stored as REAL or TEXT
);
</code></pre>
<h2 id="crud-operations-1"><a class="header" href="#crud-operations-1">CRUD Operations</a></h2>
<pre><code class="language-sql">-- Insert
INSERT INTO users (username, email)
VALUES ('john', 'john@example.com');

-- Insert multiple
INSERT INTO users (username, email) VALUES
    ('alice', 'alice@example.com'),
    ('bob', 'bob@example.com');

-- Insert or replace
INSERT OR REPLACE INTO users (id, username, email)
VALUES (1, 'john', 'newemail@example.com');

-- Insert or ignore
INSERT OR IGNORE INTO users (username, email)
VALUES ('john', 'john@example.com');

-- Select
SELECT * FROM users;
SELECT username, email FROM users WHERE id = 1;
SELECT * FROM users WHERE username LIKE 'jo%';
SELECT * FROM users ORDER BY created_at DESC LIMIT 10;
SELECT * FROM users LIMIT 10 OFFSET 20;

-- Update
UPDATE users SET email = 'newemail@example.com' WHERE id = 1;

-- Delete
DELETE FROM users WHERE id = 1;
DELETE FROM users WHERE created_at &lt; '2023-01-01';
</code></pre>
<h2 id="indexes-3"><a class="header" href="#indexes-3">Indexes</a></h2>
<pre><code class="language-sql">-- Create index
CREATE INDEX idx_users_username ON users(username);
CREATE INDEX idx_users_email ON users(email);

-- Unique index
CREATE UNIQUE INDEX idx_users_username_unique ON users(username);

-- Composite index
CREATE INDEX idx_users_name_email ON users(username, email);

-- Partial index
CREATE INDEX idx_active_users ON users(username) WHERE active = 1;

-- Expression index
CREATE INDEX idx_users_lower_username ON users(LOWER(username));

-- List indexes
.indexes
.indexes users
PRAGMA index_list(users);

-- Show index info
PRAGMA index_info(idx_users_username);

-- Drop index
DROP INDEX idx_users_username;
</code></pre>
<h2 id="constraints-1"><a class="header" href="#constraints-1">Constraints</a></h2>
<pre><code class="language-sql">-- Primary key
CREATE TABLE products (
    id INTEGER PRIMARY KEY,  -- Alias for rowid
    name TEXT NOT NULL
);

-- Composite primary key
CREATE TABLE order_items (
    order_id INTEGER,
    product_id INTEGER,
    quantity INTEGER,
    PRIMARY KEY (order_id, product_id)
);

-- Foreign key (must enable)
PRAGMA foreign_keys = ON;

CREATE TABLE orders (
    id INTEGER PRIMARY KEY,
    user_id INTEGER,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
);

-- Unique constraint
CREATE TABLE users (
    id INTEGER PRIMARY KEY,
    email TEXT UNIQUE
);

-- Check constraint
CREATE TABLE products (
    id INTEGER PRIMARY KEY,
    price REAL CHECK(price &gt; 0),
    quantity INTEGER CHECK(quantity &gt;= 0)
);

-- Not null
CREATE TABLE users (
    id INTEGER PRIMARY KEY,
    username TEXT NOT NULL
);

-- Default value
CREATE TABLE users (
    id INTEGER PRIMARY KEY,
    active INTEGER DEFAULT 1,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);
</code></pre>
<h2 id="joins-3"><a class="header" href="#joins-3">Joins</a></h2>
<pre><code class="language-sql">-- Inner join
SELECT u.username, o.id AS order_id
FROM users u
INNER JOIN orders o ON u.id = o.user_id;

-- Left join
SELECT u.username, o.id AS order_id
FROM users u
LEFT JOIN orders o ON u.id = o.user_id;

-- Cross join
SELECT u.username, p.name
FROM users u
CROSS JOIN products p;

-- Natural join (not recommended)
SELECT * FROM users NATURAL JOIN orders;
</code></pre>
<h2 id="aggregations-1"><a class="header" href="#aggregations-1">Aggregations</a></h2>
<pre><code class="language-sql">-- Count
SELECT COUNT(*) FROM users;
SELECT COUNT(DISTINCT email) FROM users;

-- Sum, Avg, Min, Max
SELECT
    COUNT(*) AS total_orders,
    SUM(amount) AS total_amount,
    AVG(amount) AS avg_amount,
    MIN(amount) AS min_amount,
    MAX(amount) AS max_amount
FROM orders;

-- Group by
SELECT user_id, COUNT(*) AS order_count
FROM orders
GROUP BY user_id;

-- Having
SELECT user_id, COUNT(*) AS order_count
FROM orders
GROUP BY user_id
HAVING COUNT(*) &gt; 5;

-- Group concat
SELECT user_id, GROUP_CONCAT(product_name, ', ') AS products
FROM order_items
GROUP BY user_id;
</code></pre>
<h2 id="transactions-3"><a class="header" href="#transactions-3">Transactions</a></h2>
<pre><code class="language-sql">-- Begin transaction
BEGIN TRANSACTION;

INSERT INTO users (username, email) VALUES ('test', 'test@example.com');
UPDATE accounts SET balance = balance - 100 WHERE id = 1;
UPDATE accounts SET balance = balance + 100 WHERE id = 2;

-- Commit
COMMIT;

-- Rollback
ROLLBACK;

-- Transaction modes
BEGIN DEFERRED TRANSACTION;   -- Default
BEGIN IMMEDIATE TRANSACTION;  -- Acquire write lock
BEGIN EXCLUSIVE TRANSACTION;  -- Exclusive access

-- Savepoint
BEGIN;
INSERT INTO users (username, email) VALUES ('test', 'test@example.com');
SAVEPOINT sp1;
UPDATE users SET email = 'new@example.com' WHERE username = 'test';
ROLLBACK TO sp1;
COMMIT;
</code></pre>
<h2 id="views-2"><a class="header" href="#views-2">Views</a></h2>
<pre><code class="language-sql">-- Create view
CREATE VIEW active_users AS
SELECT id, username, email
FROM users
WHERE active = 1;

-- Use view
SELECT * FROM active_users;

-- Temporary view
CREATE TEMP VIEW temp_users AS
SELECT * FROM users WHERE created_at &gt; date('now', '-7 days');

-- Drop view
DROP VIEW active_users;
</code></pre>
<h2 id="triggers-1"><a class="header" href="#triggers-1">Triggers</a></h2>
<pre><code class="language-sql">-- Before insert trigger
CREATE TRIGGER validate_email
BEFORE INSERT ON users
BEGIN
    SELECT CASE
        WHEN NEW.email NOT LIKE '%@%' THEN
            RAISE(ABORT, 'Invalid email format')
    END;
END;

-- After insert trigger
CREATE TRIGGER log_user_creation
AFTER INSERT ON users
BEGIN
    INSERT INTO audit_log (table_name, action, timestamp)
    VALUES ('users', 'INSERT', datetime('now'));
END;

-- Update trigger
CREATE TRIGGER update_modified_time
AFTER UPDATE ON users
BEGIN
    UPDATE users SET updated_at = datetime('now')
    WHERE id = NEW.id;
END;

-- Instead of trigger (for views)
CREATE TRIGGER update_active_users
INSTEAD OF UPDATE ON active_users
BEGIN
    UPDATE users SET email = NEW.email WHERE id = NEW.id;
END;

-- List triggers
.schema users
SELECT * FROM sqlite_master WHERE type = 'trigger';

-- Drop trigger
DROP TRIGGER validate_email;
</code></pre>
<h2 id="date-and-time"><a class="header" href="#date-and-time">Date and Time</a></h2>
<pre><code class="language-sql">-- Current date/time
SELECT date('now');               -- 2024-01-15
SELECT time('now');               -- 14:30:45
SELECT datetime('now');           -- 2024-01-15 14:30:45
SELECT strftime('%Y-%m-%d %H:%M', 'now');

-- Date arithmetic
SELECT date('now', '+7 days');
SELECT date('now', '-1 month');
SELECT datetime('now', '+5 hours');
SELECT date('now', 'start of month');
SELECT date('now', 'start of year');

-- Extract parts
SELECT strftime('%Y', 'now') AS year;
SELECT strftime('%m', 'now') AS month;
SELECT strftime('%d', 'now') AS day;
SELECT strftime('%H', 'now') AS hour;

-- Julian day
SELECT julianday('now');
SELECT julianday('now') - julianday('2024-01-01');

-- Unix timestamp
SELECT strftime('%s', 'now');  -- Unix timestamp
SELECT datetime(1234567890, 'unixepoch');  -- From timestamp
</code></pre>
<h2 id="json-operations-sqlite-3380"><a class="header" href="#json-operations-sqlite-3380">JSON Operations (SQLite 3.38.0+)</a></h2>
<pre><code class="language-sql">-- JSON functions
SELECT json('{"name":"John","age":30}');

-- Extract value
SELECT json_extract('{"name":"John","age":30}', '$.name');
SELECT '{"name":"John","age":30}' -&gt; 'name';  -- Shorthand

-- Array operations
SELECT json_each.value
FROM json_each('[1,2,3,4,5]');

-- Store JSON
CREATE TABLE events (
    id INTEGER PRIMARY KEY,
    data TEXT
);

INSERT INTO events (data) VALUES ('{"type":"click","count":1}');

-- Query JSON
SELECT * FROM events
WHERE json_extract(data, '$.type') = 'click';

-- Update JSON
UPDATE events
SET data = json_set(data, '$.count', json_extract(data, '$.count') + 1)
WHERE id = 1;
</code></pre>
<h2 id="full-text-search-1"><a class="header" href="#full-text-search-1">Full-Text Search</a></h2>
<pre><code class="language-sql">-- Create FTS5 table
CREATE VIRTUAL TABLE articles_fts USING fts5(
    title,
    body,
    content=articles,
    content_rowid=id
);

-- Populate FTS table
INSERT INTO articles_fts(rowid, title, body)
SELECT id, title, body FROM articles;

-- Search
SELECT * FROM articles_fts WHERE articles_fts MATCH 'sqlite performance';

-- Ranking
SELECT *, rank FROM articles_fts
WHERE articles_fts MATCH 'sqlite'
ORDER BY rank;

-- Phrase search
SELECT * FROM articles_fts WHERE articles_fts MATCH '"sqlite database"';

-- Column-specific search
SELECT * FROM articles_fts WHERE title MATCH 'tutorial';
</code></pre>
<h2 id="pragma-statements"><a class="header" href="#pragma-statements">Pragma Statements</a></h2>
<pre><code class="language-sql">-- Database info
PRAGMA database_list;
PRAGMA table_info(users);
PRAGMA index_list(users);
PRAGMA foreign_key_list(orders);

-- Performance
PRAGMA cache_size = 10000;        -- Pages in cache
PRAGMA page_size = 4096;          -- Page size in bytes
PRAGMA journal_mode = WAL;        -- Write-Ahead Logging
PRAGMA synchronous = NORMAL;      -- Sync mode
PRAGMA temp_store = MEMORY;       -- Temp tables in memory

-- Foreign keys
PRAGMA foreign_keys = ON;
PRAGMA foreign_keys;              -- Check status

-- Integrity check
PRAGMA integrity_check;
PRAGMA quick_check;

-- Database size
PRAGMA page_count;
PRAGMA page_size;
-- Total size = page_count * page_size

-- Optimization
PRAGMA optimize;
VACUUM;
</code></pre>
<h2 id="performance-optimization-4"><a class="header" href="#performance-optimization-4">Performance Optimization</a></h2>
<pre><code class="language-sql">-- Enable WAL mode (Write-Ahead Logging)
PRAGMA journal_mode = WAL;

-- Increase cache size
PRAGMA cache_size = -64000;  -- 64MB

-- Disable synchronous (faster but less safe)
PRAGMA synchronous = OFF;
PRAGMA synchronous = NORMAL;  -- Balanced

-- Analyze tables
ANALYZE;
ANALYZE users;

-- Vacuum database
VACUUM;

-- Batch inserts
BEGIN TRANSACTION;
-- Multiple INSERT statements
COMMIT;

-- Use prepared statements (in code)
-- Better performance and security

-- Indexes for frequently queried columns
CREATE INDEX idx_users_email ON users(email);
</code></pre>
<h2 id="backup-and-recovery"><a class="header" href="#backup-and-recovery">Backup and Recovery</a></h2>
<pre><code class="language-bash"># Backup database
sqlite3 mydb.db ".backup backup.db"
sqlite3 mydb.db .dump &gt; backup.sql
cp mydb.db mydb_backup.db  # Simple copy

# Restore from backup
sqlite3 newdb.db ".restore backup.db"
sqlite3 newdb.db &lt; backup.sql

# Export to CSV
.mode csv
.output users.csv
SELECT * FROM users;
.output stdout

# Import from CSV
.mode csv
.import users.csv users
</code></pre>
<h2 id="sqlite-cli-commands"><a class="header" href="#sqlite-cli-commands">SQLite CLI Commands</a></h2>
<pre><code class="language-bash"># Meta-commands
.help               # Show help
.databases          # List databases
.tables             # List tables
.schema             # Show all schemas
.schema users       # Show table schema
.indexes users      # Show indexes
.mode column        # Column output mode
.mode csv           # CSV output mode
.mode json          # JSON output mode
.headers on         # Show column headers
.width 10 20 30     # Set column widths
.output file.txt    # Output to file
.output stdout      # Output to screen
.read file.sql      # Execute SQL file
.timer on           # Show execution time
.quit               # Exit
</code></pre>
<h2 id="common-patterns-20"><a class="header" href="#common-patterns-20">Common Patterns</a></h2>
<pre><code class="language-sql">-- Upsert (Insert or Update)
INSERT INTO users (id, username, email)
VALUES (1, 'john', 'john@example.com')
ON CONFLICT(id) DO UPDATE SET
    username = excluded.username,
    email = excluded.email;

-- Conditional insert
INSERT INTO users (username, email)
SELECT 'john', 'john@example.com'
WHERE NOT EXISTS (
    SELECT 1 FROM users WHERE username = 'john'
);

-- Auto-increment
CREATE TABLE users (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    username TEXT
);

-- Get last insert rowid
SELECT last_insert_rowid();

-- Pagination
SELECT * FROM users
ORDER BY id
LIMIT 10 OFFSET 20;

-- Random row
SELECT * FROM users ORDER BY RANDOM() LIMIT 1;
</code></pre>
<h2 id="best-practices-73"><a class="header" href="#best-practices-73">Best Practices</a></h2>
<pre><code class="language-sql">-- 1. Enable foreign keys
PRAGMA foreign_keys = ON;

-- 2. Use WAL mode for better concurrency
PRAGMA journal_mode = WAL;

-- 3. Use transactions for bulk operations
BEGIN TRANSACTION;
-- Multiple operations
COMMIT;

-- 4. Create indexes for frequently queried columns
CREATE INDEX idx_users_email ON users(email);

-- 5. Use INTEGER PRIMARY KEY for auto-increment
CREATE TABLE users (
    id INTEGER PRIMARY KEY,
    username TEXT
);

-- 6. Analyze database periodically
ANALYZE;

-- 7. Use prepared statements in code
-- Prevents SQL injection and improves performance

-- 8. Vacuum database periodically
VACUUM;

-- 9. Use appropriate data types
-- SQLite is flexible but using correct types helps

-- 10. Regular backups
-- Use .backup command or copy the database file
</code></pre>
<h2 id="quick-reference-16"><a class="header" href="#quick-reference-16">Quick Reference</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody>
<tr><td><code>.tables</code></td><td>List tables</td></tr>
<tr><td><code>.schema TABLE</code></td><td>Show table structure</td></tr>
<tr><td><code>.mode column</code></td><td>Set output format</td></tr>
<tr><td><code>.headers on</code></td><td>Show column headers</td></tr>
<tr><td><code>.backup FILE</code></td><td>Backup database</td></tr>
<tr><td><code>.import FILE TABLE</code></td><td>Import CSV</td></tr>
<tr><td><code>PRAGMA foreign_keys=ON</code></td><td>Enable foreign keys</td></tr>
<tr><td><code>PRAGMA journal_mode=WAL</code></td><td>Enable WAL mode</td></tr>
<tr><td><code>VACUUM</code></td><td>Optimize database</td></tr>
<tr><td><code>ANALYZE</code></td><td>Update statistics</td></tr>
</tbody></table>
</div>
<p>SQLite is ideal for embedded systems, mobile apps, desktop applications, and scenarios where a simple, reliable, serverless database is needed.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="duckdb"><a class="header" href="#duckdb">DuckDB</a></h1>
<p>DuckDB is an in-process SQL OLAP (Online Analytical Processing) database management system designed for analytical query workloads. It's often described as "SQLite for analytics."</p>
<h2 id="overview-93"><a class="header" href="#overview-93">Overview</a></h2>
<p>DuckDB is optimized for analytical queries with columnar storage, vectorized execution, and minimal dependencies.</p>
<p><strong>Key Features:</strong></p>
<ul>
<li>In-process, embedded database</li>
<li>Columnar storage for analytics</li>
<li>ACID compliant</li>
<li>Vectorized query execution</li>
<li>No external dependencies</li>
<li>SQL compatible</li>
<li>Direct querying of CSV, Parquet, JSON</li>
</ul>
<h2 id="installation-18"><a class="header" href="#installation-18">Installation</a></h2>
<pre><code class="language-bash"># Ubuntu/Debian
sudo apt install duckdb

# macOS
brew install duckdb

# Python
pip install duckdb

# From binary
wget https://github.com/duckdb/duckdb/releases/download/v0.9.2/duckdb_cli-linux-amd64.zip
unzip duckdb_cli-linux-amd64.zip
sudo mv duckdb /usr/local/bin/

# Verify
duckdb --version
</code></pre>
<h2 id="basic-usage-11"><a class="header" href="#basic-usage-11">Basic Usage</a></h2>
<pre><code class="language-bash"># Start DuckDB CLI
duckdb

# Create/open database file
duckdb mydb.duckdb

# In-memory database
duckdb :memory:

# Execute command from shell
duckdb mydb.duckdb "SELECT * FROM users;"

# Execute SQL file
duckdb mydb.duckdb &lt; script.sql

# Exit
.quit
</code></pre>
<h2 id="python-api"><a class="header" href="#python-api">Python API</a></h2>
<pre><code class="language-python">import duckdb

# Connect to database
con = duckdb.connect('mydb.duckdb')

# In-memory database
con = duckdb.connect(':memory:')

# Execute query
result = con.execute("SELECT * FROM users").fetchall()

# Fetch as DataFrame
df = con.execute("SELECT * FROM users").df()

# Direct DataFrame query
import pandas as pd
df = pd.DataFrame({'a': [1, 2, 3], 'b': [4, 5, 6]})
result = duckdb.query("SELECT * FROM df WHERE a &gt; 1").df()

# Close connection
con.close()
</code></pre>
<h2 id="table-operations-2"><a class="header" href="#table-operations-2">Table Operations</a></h2>
<pre><code class="language-sql">-- Create table
CREATE TABLE users (
    id INTEGER PRIMARY KEY,
    username VARCHAR,
    email VARCHAR,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Create table from query
CREATE TABLE new_users AS
SELECT * FROM users WHERE created_at &gt; '2024-01-01';

-- Show tables
SHOW TABLES;
.tables

-- Describe table
DESCRIBE users;
.schema users

-- Drop table
DROP TABLE users;
</code></pre>
<h2 id="reading-external-files"><a class="header" href="#reading-external-files">Reading External Files</a></h2>
<pre><code class="language-sql">-- Read CSV
SELECT * FROM read_csv_auto('data.csv');

-- Read CSV with options
SELECT * FROM read_csv('data.csv',
    header=true,
    delim=',',
    quote='"',
    types={'id': 'INTEGER', 'name': 'VARCHAR'}
);

-- Create table from CSV
CREATE TABLE users AS
SELECT * FROM read_csv_auto('users.csv');

-- Read Parquet
SELECT * FROM read_parquet('data.parquet');
SELECT * FROM 'data.parquet';  -- Shorthand

-- Read multiple Parquet files
SELECT * FROM read_parquet(['file1.parquet', 'file2.parquet']);
SELECT * FROM read_parquet('data/*.parquet');

-- Read JSON
SELECT * FROM read_json_auto('data.json');
SELECT * FROM read_json('data.json', format='array');

-- Read JSON lines
SELECT * FROM read_json_auto('data.jsonl', format='newline_delimited');
</code></pre>
<h2 id="writing-to-files-1"><a class="header" href="#writing-to-files-1">Writing to Files</a></h2>
<pre><code class="language-sql">-- Export to CSV
COPY users TO 'users.csv' (HEADER, DELIMITER ',');

-- Export to Parquet
COPY users TO 'users.parquet' (FORMAT PARQUET);

-- Export query result
COPY (SELECT * FROM users WHERE active = true)
TO 'active_users.parquet' (FORMAT PARQUET);

-- Export to JSON
COPY users TO 'users.json';
</code></pre>
<h2 id="crud-operations-2"><a class="header" href="#crud-operations-2">CRUD Operations</a></h2>
<pre><code class="language-sql">-- Insert
INSERT INTO users (username, email)
VALUES ('john', 'john@example.com');

-- Insert multiple
INSERT INTO users (username, email) VALUES
    ('alice', 'alice@example.com'),
    ('bob', 'bob@example.com');

-- Insert from SELECT
INSERT INTO users (username, email)
SELECT username, email FROM temp_users;

-- Select
SELECT * FROM users;
SELECT * FROM users WHERE username LIKE 'jo%';
SELECT * FROM users ORDER BY created_at DESC LIMIT 10;

-- Update
UPDATE users SET email = 'newemail@example.com' WHERE id = 1;

-- Delete
DELETE FROM users WHERE id = 1;
</code></pre>
<h2 id="analytical-queries"><a class="header" href="#analytical-queries">Analytical Queries</a></h2>
<pre><code class="language-sql">-- Window functions
SELECT
    username,
    created_at,
    ROW_NUMBER() OVER (ORDER BY created_at) AS row_num,
    RANK() OVER (ORDER BY created_at) AS rank,
    DENSE_RANK() OVER (ORDER BY created_at) AS dense_rank,
    NTILE(4) OVER (ORDER BY created_at) AS quartile
FROM users;

-- Moving average
SELECT
    date,
    revenue,
    AVG(revenue) OVER (ORDER BY date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS moving_avg_7d
FROM sales;

-- Cumulative sum
SELECT
    date,
    amount,
    SUM(amount) OVER (ORDER BY date) AS cumulative_total
FROM transactions;

-- Percent rank
SELECT
    username,
    score,
    PERCENT_RANK() OVER (ORDER BY score) AS percentile
FROM scores;
</code></pre>
<h2 id="aggregations-2"><a class="header" href="#aggregations-2">Aggregations</a></h2>
<pre><code class="language-sql">-- Basic aggregations
SELECT
    COUNT(*) AS total,
    COUNT(DISTINCT user_id) AS unique_users,
    SUM(amount) AS total_amount,
    AVG(amount) AS avg_amount,
    MIN(amount) AS min_amount,
    MAX(amount) AS max_amount,
    STDDEV(amount) AS std_dev,
    MEDIAN(amount) AS median_amount
FROM orders;

-- Group by with ROLLUP
SELECT
    category,
    subcategory,
    SUM(amount) AS total
FROM sales
GROUP BY ROLLUP (category, subcategory);

-- Group by with CUBE
SELECT
    region,
    product,
    SUM(revenue) AS total
FROM sales
GROUP BY CUBE (region, product);

-- GROUPING SETS
SELECT
    region,
    product,
    SUM(revenue) AS total
FROM sales
GROUP BY GROUPING SETS ((region), (product), ());
</code></pre>
<h2 id="time-series"><a class="header" href="#time-series">Time Series</a></h2>
<pre><code class="language-sql">-- Generate date series
SELECT * FROM generate_series(
    TIMESTAMP '2024-01-01',
    TIMESTAMP '2024-12-31',
    INTERVAL '1 day'
) AS t(date);

-- Time bucket
SELECT
    time_bucket(INTERVAL '1 hour', timestamp) AS hour,
    COUNT(*) AS events,
    AVG(value) AS avg_value
FROM events
GROUP BY hour
ORDER BY hour;

-- Date truncation
SELECT
    date_trunc('month', created_at) AS month,
    COUNT(*) AS user_count
FROM users
GROUP BY month;

-- Extract date parts
SELECT
    EXTRACT(year FROM created_at) AS year,
    EXTRACT(month FROM created_at) AS month,
    EXTRACT(day FROM created_at) AS day,
    EXTRACT(hour FROM created_at) AS hour
FROM events;
</code></pre>
<h2 id="joins-4"><a class="header" href="#joins-4">Joins</a></h2>
<pre><code class="language-sql">-- Inner join
SELECT u.username, o.amount
FROM users u
INNER JOIN orders o ON u.id = o.user_id;

-- Left join
SELECT u.username, o.amount
FROM users u
LEFT JOIN orders o ON u.id = o.user_id;

-- Right join
SELECT u.username, o.amount
FROM users u
RIGHT JOIN orders o ON u.id = o.user_id;

-- Full outer join
SELECT u.username, o.amount
FROM users u
FULL OUTER JOIN orders o ON u.id = o.user_id;

-- Cross join
SELECT u.username, p.name
FROM users u
CROSS JOIN products p;

-- Join with USING
SELECT * FROM users u
JOIN orders o USING (user_id);

-- ASOF join (temporal join)
SELECT * FROM trades
ASOF JOIN quotes
ON trades.symbol = quotes.symbol
AND trades.timestamp &gt;= quotes.timestamp;
</code></pre>
<h2 id="common-table-expressions-ctes"><a class="header" href="#common-table-expressions-ctes">Common Table Expressions (CTEs)</a></h2>
<pre><code class="language-sql">-- Basic CTE
WITH active_users AS (
    SELECT * FROM users WHERE active = true
)
SELECT * FROM active_users WHERE created_at &gt; '2024-01-01';

-- Multiple CTEs
WITH
    active_users AS (
        SELECT * FROM users WHERE active = true
    ),
    recent_orders AS (
        SELECT * FROM orders WHERE created_at &gt; '2024-01-01'
    )
SELECT u.username, COUNT(o.id) AS order_count
FROM active_users u
LEFT JOIN recent_orders o ON u.id = o.user_id
GROUP BY u.username;

-- Recursive CTE
WITH RECURSIVE countdown(n) AS (
    SELECT 10 AS n
    UNION ALL
    SELECT n - 1 FROM countdown WHERE n &gt; 1
)
SELECT * FROM countdown;
</code></pre>
<h2 id="pivot-and-unpivot"><a class="header" href="#pivot-and-unpivot">Pivot and Unpivot</a></h2>
<pre><code class="language-sql">-- Pivot
PIVOT sales
ON product_category
USING SUM(amount)
GROUP BY region;

-- Manual pivot
SELECT
    region,
    SUM(CASE WHEN category = 'Electronics' THEN amount ELSE 0 END) AS electronics,
    SUM(CASE WHEN category = 'Clothing' THEN amount ELSE 0 END) AS clothing,
    SUM(CASE WHEN category = 'Food' THEN amount ELSE 0 END) AS food
FROM sales
GROUP BY region;

-- Unpivot
UNPIVOT sales
ON electronics, clothing, food
INTO NAME category VALUE amount;
</code></pre>
<h2 id="string-functions-1"><a class="header" href="#string-functions-1">String Functions</a></h2>
<pre><code class="language-sql">-- String operations
SELECT
    UPPER(username) AS upper_name,
    LOWER(username) AS lower_name,
    CONCAT(first_name, ' ', last_name) AS full_name,
    SUBSTRING(email, 1, 5) AS email_prefix,
    LENGTH(username) AS name_length,
    REPLACE(email, '@gmail.com', '@example.com') AS new_email,
    SPLIT_PART(email, '@', 1) AS email_user,
    TRIM(username) AS trimmed,
    REGEXP_MATCHES(text, '[0-9]+') AS numbers,
    REGEXP_REPLACE(text, '[0-9]', 'X') AS masked
FROM users;

-- String aggregation
SELECT
    category,
    STRING_AGG(product_name, ', ') AS products
FROM products
GROUP BY category;

-- List functions
SELECT
    LIST(['a', 'b', 'c']) AS my_list,
    LIST_VALUE('a', 'b', 'c') AS another_list,
    [1, 2, 3] AS numeric_list;

SELECT list[1] FROM (SELECT [1, 2, 3] AS list);
</code></pre>
<h2 id="array-and-struct-operations"><a class="header" href="#array-and-struct-operations">Array and Struct Operations</a></h2>
<pre><code class="language-sql">-- Arrays
SELECT [1, 2, 3, 4, 5] AS numbers;
SELECT LIST_VALUE(1, 2, 3, 4, 5) AS numbers;
SELECT UNNEST([1, 2, 3]) AS num;

-- Array aggregation
SELECT LIST(username) AS all_users FROM users;

-- Struct
SELECT {'name': 'John', 'age': 30} AS person;
SELECT person.name FROM (SELECT {'name': 'John', 'age': 30} AS person);

-- Nested structures
SELECT {
    'user': {'name': 'John', 'email': 'john@example.com'},
    'orders': [1, 2, 3]
} AS complex_data;
</code></pre>
<h2 id="constraints-and-indexes"><a class="header" href="#constraints-and-indexes">Constraints and Indexes</a></h2>
<pre><code class="language-sql">-- Primary key
CREATE TABLE users (
    id INTEGER PRIMARY KEY,
    username VARCHAR UNIQUE NOT NULL
);

-- Check constraint
CREATE TABLE products (
    id INTEGER PRIMARY KEY,
    price DECIMAL CHECK (price &gt; 0),
    quantity INTEGER CHECK (quantity &gt;= 0)
);

-- Create index
CREATE INDEX idx_users_email ON users(email);

-- Drop index
DROP INDEX idx_users_email;

-- Show indexes
PRAGMA show_index('users');
</code></pre>
<h2 id="transactions-4"><a class="header" href="#transactions-4">Transactions</a></h2>
<pre><code class="language-sql">-- Begin transaction
BEGIN TRANSACTION;

INSERT INTO users (username, email) VALUES ('test', 'test@example.com');
UPDATE accounts SET balance = balance - 100 WHERE id = 1;

-- Commit
COMMIT;

-- Rollback
ROLLBACK;
</code></pre>
<h2 id="views-3"><a class="header" href="#views-3">Views</a></h2>
<pre><code class="language-sql">-- Create view
CREATE VIEW active_users AS
SELECT id, username, email
FROM users
WHERE active = true;

-- Use view
SELECT * FROM active_users;

-- Drop view
DROP VIEW active_users;
</code></pre>
<h2 id="performance-optimization-5"><a class="header" href="#performance-optimization-5">Performance Optimization</a></h2>
<pre><code class="language-sql">-- Analyze query plan
EXPLAIN SELECT * FROM users WHERE username = 'john';
EXPLAIN ANALYZE SELECT * FROM users JOIN orders ON users.id = orders.user_id;

-- Vacuum and analyze
VACUUM;
ANALYZE users;

-- Parallel query execution (automatic)
SET threads TO 4;

-- Memory limit
SET memory_limit = '4GB';

-- Temp directory
SET temp_directory = '/path/to/temp';
</code></pre>
<h2 id="settings-and-configuration"><a class="header" href="#settings-and-configuration">Settings and Configuration</a></h2>
<pre><code class="language-sql">-- Show settings
SELECT * FROM duckdb_settings();

-- Set configuration
SET memory_limit = '8GB';
SET threads TO 8;
SET max_memory = '16GB';
SET temp_directory = '/tmp';

-- Progress bar
SET enable_progress_bar = true;

-- Profiling
SET enable_profiling = true;
SET profiling_mode = 'detailed';
</code></pre>
<h2 id="importing-from-other-databases"><a class="header" href="#importing-from-other-databases">Importing from Other Databases</a></h2>
<pre><code class="language-sql">-- Attach SQLite database
ATTACH 'mydb.sqlite' AS sqlite_db (TYPE SQLITE);
SELECT * FROM sqlite_db.users;

-- Attach PostgreSQL
ATTACH 'dbname=mydb user=postgres host=localhost' AS pg_db (TYPE POSTGRES);
SELECT * FROM pg_db.users;

-- Copy data
CREATE TABLE local_users AS
SELECT * FROM pg_db.users;

-- Detach
DETACH sqlite_db;
</code></pre>
<h2 id="python-integration"><a class="header" href="#python-integration">Python Integration</a></h2>
<pre><code class="language-python">import duckdb
import pandas as pd

# Create connection
con = duckdb.connect('mydb.duckdb')

# Query to DataFrame
df = con.execute("SELECT * FROM users").df()

# Register DataFrame as table
con.register('df_users', df)
result = con.execute("SELECT * FROM df_users WHERE age &gt; 30").df()

# Direct query on DataFrame
result = duckdb.query("SELECT * FROM df WHERE column_a &gt; 10").df()

# Arrow integration
import pyarrow as pa
arrow_table = con.execute("SELECT * FROM users").arrow()

# Register Arrow table
con.register('arrow_users', arrow_table)

# Relation API
rel = con.table('users')
result = rel.filter('age &gt; 30').project('username, email').df()

# Close
con.close()
</code></pre>
<h2 id="cli-commands"><a class="header" href="#cli-commands">CLI Commands</a></h2>
<pre><code class="language-bash"># Meta-commands
.help              # Show help
.tables            # List tables
.schema            # Show all schemas
.schema users      # Show table schema
.mode              # Show output mode
.mode csv          # Set CSV output
.mode json         # Set JSON output
.mode markdown     # Set Markdown output
.output file.csv   # Output to file
.timer on          # Show query timing
.maxrows 100       # Limit output rows
.quit              # Exit
</code></pre>
<h2 id="best-practices-74"><a class="header" href="#best-practices-74">Best Practices</a></h2>
<pre><code class="language-sql">-- 1. Use columnar storage (Parquet) for large datasets
COPY large_table TO 'data.parquet' (FORMAT PARQUET);

-- 2. Leverage parallel execution
SET threads TO 8;

-- 3. Use appropriate data types
CREATE TABLE optimized (
    id INTEGER,
    name VARCHAR,
    value DOUBLE,
    date DATE
);

-- 4. Create indexes for frequently filtered columns
CREATE INDEX idx_users_email ON users(email);

-- 5. Use window functions instead of self-joins
SELECT username, LAG(score) OVER (ORDER BY date) AS prev_score
FROM scores;

-- 6. Partition large queries
SELECT * FROM large_table
WHERE date &gt;= '2024-01-01' AND date &lt; '2024-02-01';

-- 7. Use CTEs for readability
WITH filtered AS (SELECT * FROM users WHERE active = true)
SELECT * FROM filtered;

-- 8. Analyze queries for optimization
EXPLAIN ANALYZE SELECT * FROM complex_query;

-- 9. Read directly from files when possible
SELECT * FROM 'data.parquet' WHERE column &gt; 100;

-- 10. Use appropriate compression
COPY data TO 'compressed.parquet' (FORMAT PARQUET, COMPRESSION ZSTD);
</code></pre>
<h2 id="quick-reference-17"><a class="header" href="#quick-reference-17">Quick Reference</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody>
<tr><td><code>read_csv_auto('file.csv')</code></td><td>Read CSV file</td></tr>
<tr><td><code>read_parquet('file.parquet')</code></td><td>Read Parquet file</td></tr>
<tr><td><code>COPY table TO 'file.csv'</code></td><td>Export to CSV</td></tr>
<tr><td><code>EXPLAIN ANALYZE</code></td><td>Show query plan</td></tr>
<tr><td><code>SET threads TO 8</code></td><td>Set thread count</td></tr>
<tr><td><code>DESCRIBE table</code></td><td>Show table schema</td></tr>
<tr><td><code>.tables</code></td><td>List tables</td></tr>
<tr><td><code>.mode csv</code></td><td>Set output format</td></tr>
<tr><td><code>VACUUM</code></td><td>Optimize database</td></tr>
<tr><td><code>ANALYZE</code></td><td>Update statistics</td></tr>
</tbody></table>
</div>
<p>DuckDB excels at analytical queries on local data files, making it perfect for data analysis, ETL pipelines, and embedded analytics applications.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="nosql-databases-1"><a class="header" href="#nosql-databases-1">NoSQL Databases</a></h1>
<h2 id="overview-94"><a class="header" href="#overview-94">Overview</a></h2>
<p>NoSQL databases store data in non-relational formats (documents, key-value, graph, etc.). Designed for scalability, flexibility, and high-performance.</p>
<h2 id="types-1"><a class="header" href="#types-1">Types</a></h2>
<h3 id="document-databases-mongodb"><a class="header" href="#document-databases-mongodb">Document Databases (MongoDB)</a></h3>
<pre><code class="language-javascript">// Insert
db.users.insertOne({ name: "John", age: 30, email: "john@example.com" });

// Find
db.users.findOne({ name: "John" });
db.users.find({ age: { $gt: 25 } });

// Update
db.users.updateOne({ _id: ObjectId("...") }, { $set: { age: 31 } });

// Delete
db.users.deleteOne({ name: "John" });

// Aggregation
db.users.aggregate([
  { $match: { age: { $gt: 25 } } },
  { $group: { _id: "$city", count: { $sum: 1 } } },
  { $sort: { count: -1 } }
]);
</code></pre>
<h3 id="key-value-stores-redis"><a class="header" href="#key-value-stores-redis">Key-Value Stores (Redis)</a></h3>
<pre><code class="language-bash"># Strings
SET key value
GET key
INCR counter

# Lists
LPUSH mylist "a" "b" "c"
LPOP mylist
LRANGE mylist 0 -1

# Sets
SADD myset "a" "b" "c"
SMEMBERS myset

# Hashes
HSET user:1 name "John" age 30
HGET user:1 name
HGETALL user:1

# Expiration
EXPIRE key 3600  # 1 hour TTL
</code></pre>
<h3 id="column-family-cassandra"><a class="header" href="#column-family-cassandra">Column-Family (Cassandra)</a></h3>
<pre><code class="language-sql">-- Wide, denormalized columns
CREATE TABLE users (
  user_id UUID PRIMARY KEY,
  name TEXT,
  email TEXT,
  created_at TIMESTAMP,
  metadata MAP&lt;TEXT, TEXT&gt;
);
</code></pre>
<h3 id="graph-databases-neo4j"><a class="header" href="#graph-databases-neo4j">Graph Databases (Neo4j)</a></h3>
<pre><code class="language-cypher">// Create
CREATE (n:Person {name: "John", age: 30})
CREATE (m:Company {name: "Acme"})
CREATE (n)-[:WORKS_AT]-&gt;(m)

// Query
MATCH (p:Person)-[:WORKS_AT]-&gt;(c:Company)
WHERE p.age &gt; 25
RETURN p.name, c.name

// Find friends
MATCH (p:Person {name: "John"})-[:FRIEND*1..2]-(friend)
RETURN friend.name
</code></pre>
<h2 id="cap-theorem"><a class="header" href="#cap-theorem">CAP Theorem</a></h2>
<p>Every distributed database trades off:</p>
<ul>
<li><strong>Consistency</strong>: All nodes see same data</li>
<li><strong>Availability</strong>: System always responsive</li>
<li><strong>Partition Tolerance</strong>: Survive network splits</li>
</ul>
<p><strong>You can have 2 of 3:</strong></p>
<ul>
<li><strong>CP</strong>: Strong consistency, unavailable during partitions (Spanner)</li>
<li><strong>AP</strong>: Always available, eventual consistency (Dynamo, Cassandra)</li>
<li><strong>CA</strong>: Consistent and available, can't handle partitions (traditional DB)</li>
</ul>
<h2 id="use-cases-5"><a class="header" href="#use-cases-5">Use Cases</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Database</th><th>Best For</th></tr></thead><tbody>
<tr><td><strong>MongoDB</strong></td><td>Flexible schema, documents</td></tr>
<tr><td><strong>Redis</strong></td><td>Caching, sessions, real-time</td></tr>
<tr><td><strong>Cassandra</strong></td><td>Time-series, massive scale</td></tr>
<tr><td><strong>Neo4j</strong></td><td>Graph queries, relationships</td></tr>
<tr><td><strong>Elasticsearch</strong></td><td>Full-text search, logs</td></tr>
</tbody></table>
</div>
<h2 id="data-modeling"><a class="header" href="#data-modeling">Data Modeling</a></h2>
<pre><code class="language-python"># Denormalization (NoSQL style)
# One document with all info
{
  "_id": "user_1",
  "name": "John",
  "orders": [
    { "id": "order_1", "amount": 100 },
    { "id": "order_2", "amount": 200 }
  ]
}

# vs SQL (normalization)
# users table + orders table + JOIN
</code></pre>
<h2 id="eli10-28"><a class="header" href="#eli10-28">ELI10</a></h2>
<p>NoSQL is like a flexible filing system:</p>
<ul>
<li><strong>Document DB</strong>: Store complete documents (like PDF files)</li>
<li><strong>Key-Value</strong>: Simple lookup (like phone book)</li>
<li><strong>Graph</strong>: Show relationships (like social network)</li>
<li><strong>Column</strong>: Organize by columns not rows (like spreadsheet)</li>
</ul>
<p>Trade flexibility and speed for less strict structure!</p>
<h2 id="further-resources-41"><a class="header" href="#further-resources-41">Further Resources</a></h2>
<ul>
<li><a href="https://docs.mongodb.com/">MongoDB Docs</a></li>
<li><a href="https://redis.io/commands/">Redis Commands</a></li>
<li><a href="https://neo4j.com/docs/">Neo4j Guide</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="mongodb"><a class="header" href="#mongodb">MongoDB</a></h1>
<p>MongoDB is a popular NoSQL database that stores data in flexible, JSON-like documents. It's designed for scalability, high performance, and ease of development, making it ideal for modern applications that require flexible schema design and horizontal scaling.</p>
<h2 id="table-of-contents-43"><a class="header" href="#table-of-contents-43">Table of Contents</a></h2>
<ul>
<li><a href="databases/mongodb.html#introduction">Introduction</a></li>
<li><a href="databases/mongodb.html#installation-and-setup">Installation and Setup</a></li>
<li><a href="databases/mongodb.html#crud-operations">CRUD Operations</a></li>
<li><a href="databases/mongodb.html#data-modeling">Data Modeling</a></li>
<li><a href="databases/mongodb.html#queries-and-aggregation">Queries and Aggregation</a></li>
<li><a href="databases/mongodb.html#indexing">Indexing</a></li>
<li><a href="databases/mongodb.html#mongodb-with-nodejs">MongoDB with Node.js</a></li>
<li><a href="databases/mongodb.html#best-practices">Best Practices</a></li>
<li><a href="databases/mongodb.html#performance-optimization">Performance Optimization</a></li>
</ul>
<hr />
<h2 id="introduction-23"><a class="header" href="#introduction-23">Introduction</a></h2>
<p><strong>Key Features:</strong></p>
<ul>
<li>Document-oriented storage (JSON/BSON)</li>
<li>Flexible schema design</li>
<li>High performance</li>
<li>High availability (Replica Sets)</li>
<li>Horizontal scalability (Sharding)</li>
<li>Rich query language</li>
<li>Aggregation framework</li>
<li>GridFS for large files</li>
<li>Change Streams for real-time data</li>
</ul>
<p><strong>Use Cases:</strong></p>
<ul>
<li>Content management systems</li>
<li>Real-time analytics</li>
<li>IoT applications</li>
<li>Mobile applications</li>
<li>Catalogs and inventory</li>
<li>User data management</li>
<li>Caching layer</li>
</ul>
<hr />
<h2 id="installation-and-setup-1"><a class="header" href="#installation-and-setup-1">Installation and Setup</a></h2>
<h3 id="install-mongodb"><a class="header" href="#install-mongodb">Install MongoDB</a></h3>
<p><strong>macOS:</strong></p>
<pre><code class="language-bash">brew tap mongodb/brew
brew install mongodb-community
brew services start mongodb-community
</code></pre>
<p><strong>Ubuntu:</strong></p>
<pre><code class="language-bash">wget -qO - https://www.mongodb.org/static/pgp/server-6.0.asc | sudo apt-key add -
echo "deb [ arch=amd64,arm64 ] https://repo.mongodb.org/apt/ubuntu focal/mongodb-org/6.0 multiverse" | sudo tee /etc/apt/sources.list.d/mongodb-org-6.0.list
sudo apt-get update
sudo apt-get install -y mongodb-org
sudo systemctl start mongod
</code></pre>
<p><strong>Docker:</strong></p>
<pre><code class="language-bash">docker run -d -p 27017:27017 --name mongodb mongo:latest
</code></pre>
<h3 id="mongodb-shell"><a class="header" href="#mongodb-shell">MongoDB Shell</a></h3>
<pre><code class="language-bash"># Connect to MongoDB
mongosh

# Show databases
show dbs

# Use/create database
use mydb

# Show collections
show collections

# Exit
exit
</code></pre>
<hr />
<h2 id="crud-operations-3"><a class="header" href="#crud-operations-3">CRUD Operations</a></h2>
<h3 id="create-insert"><a class="header" href="#create-insert">Create (Insert)</a></h3>
<pre><code class="language-javascript">// Insert one document
db.users.insertOne({
  name: "John Doe",
  email: "john@example.com",
  age: 30,
  createdAt: new Date()
})

// Insert multiple documents
db.users.insertMany([
  { name: "Jane Smith", email: "jane@example.com", age: 28 },
  { name: "Bob Johnson", email: "bob@example.com", age: 35 }
])
</code></pre>
<h3 id="read-query"><a class="header" href="#read-query">Read (Query)</a></h3>
<pre><code class="language-javascript">// Find all documents
db.users.find()

// Find with filter
db.users.find({ age: { $gte: 30 } })

// Find one document
db.users.findOne({ email: "john@example.com" })

// Projection (select specific fields)
db.users.find({}, { name: 1, email: 1, _id: 0 })

// Limit and sort
db.users.find().limit(10).sort({ age: -1 })

// Count documents
db.users.countDocuments({ age: { $gte: 30 } })
</code></pre>
<h3 id="update-2"><a class="header" href="#update-2">Update</a></h3>
<pre><code class="language-javascript">// Update one document
db.users.updateOne(
  { email: "john@example.com" },
  { $set: { age: 31, updatedAt: new Date() } }
)

// Update multiple documents
db.users.updateMany(
  { age: { $lt: 30 } },
  { $set: { status: "young" } }
)

// Replace document
db.users.replaceOne(
  { email: "john@example.com" },
  { name: "John Doe", email: "john@example.com", age: 31 }
)

// Upsert (update or insert)
db.users.updateOne(
  { email: "new@example.com" },
  { $set: { name: "New User", age: 25 } },
  { upsert: true }
)

// Increment field
db.users.updateOne(
  { email: "john@example.com" },
  { $inc: { loginCount: 1 } }
)

// Add to array
db.users.updateOne(
  { email: "john@example.com" },
  { $push: { hobbies: "reading" } }
)
</code></pre>
<h3 id="delete-2"><a class="header" href="#delete-2">Delete</a></h3>
<pre><code class="language-javascript">// Delete one document
db.users.deleteOne({ email: "john@example.com" })

// Delete multiple documents
db.users.deleteMany({ age: { $lt: 18 } })

// Delete all documents
db.users.deleteMany({})
</code></pre>
<hr />
<h2 id="data-modeling-1"><a class="header" href="#data-modeling-1">Data Modeling</a></h2>
<h3 id="embedded-documents"><a class="header" href="#embedded-documents">Embedded Documents</a></h3>
<pre><code class="language-javascript">// User with embedded address
db.users.insertOne({
  name: "John Doe",
  email: "john@example.com",
  address: {
    street: "123 Main St",
    city: "New York",
    state: "NY",
    zip: "10001"
  },
  phoneNumbers: [
    { type: "home", number: "555-1234" },
    { type: "work", number: "555-5678" }
  ]
})
</code></pre>
<h3 id="document-references"><a class="header" href="#document-references">Document References</a></h3>
<pre><code class="language-javascript">// Posts collection
db.posts.insertOne({
  title: "My First Post",
  content: "This is my first blog post",
  authorId: ObjectId("user_id_here"),
  comments: [
    {
      userId: ObjectId("commenter_id"),
      text: "Great post!",
      createdAt: new Date()
    }
  ]
})

// Query with lookup
db.posts.aggregate([
  {
    $lookup: {
      from: "users",
      localField: "authorId",
      foreignField: "_id",
      as: "author"
    }
  }
])
</code></pre>
<h3 id="schema-design-patterns"><a class="header" href="#schema-design-patterns">Schema Design Patterns</a></h3>
<pre><code class="language-javascript">// One-to-One (Embedded)
{
  _id: ObjectId(),
  username: "john_doe",
  profile: {
    firstName: "John",
    lastName: "Doe",
    bio: "Software developer"
  }
}

// One-to-Many (Embedded - for small arrays)
{
  _id: ObjectId(),
  title: "Blog Post",
  tags: ["mongodb", "database", "nosql"]
}

// One-to-Many (Referenced - for large collections)
{
  _id: ObjectId(),
  name: "Category",
  products: [
    ObjectId("product_1"),
    ObjectId("product_2")
  ]
}

// Many-to-Many
// Users collection
{
  _id: ObjectId("user_1"),
  name: "John",
  courseIds: [ObjectId("course_1"), ObjectId("course_2")]
}

// Courses collection
{
  _id: ObjectId("course_1"),
  title: "MongoDB Course",
  studentIds: [ObjectId("user_1"), ObjectId("user_2")]
}
</code></pre>
<hr />
<h2 id="queries-and-aggregation"><a class="header" href="#queries-and-aggregation">Queries and Aggregation</a></h2>
<h3 id="query-operators"><a class="header" href="#query-operators">Query Operators</a></h3>
<pre><code class="language-javascript">// Comparison operators
db.users.find({ age: { $eq: 30 } })      // Equal
db.users.find({ age: { $ne: 30 } })      // Not equal
db.users.find({ age: { $gt: 30 } })      // Greater than
db.users.find({ age: { $gte: 30 } })     // Greater than or equal
db.users.find({ age: { $lt: 30 } })      // Less than
db.users.find({ age: { $lte: 30 } })     // Less than or equal
db.users.find({ age: { $in: [25, 30, 35] } })  // In array
db.users.find({ age: { $nin: [25, 30] } })     // Not in array

// Logical operators
db.users.find({
  $and: [
    { age: { $gte: 25 } },
    { age: { $lte: 35 } }
  ]
})

db.users.find({
  $or: [
    { age: { $lt: 25 } },
    { age: { $gt: 35 } }
  ]
})

db.users.find({ age: { $not: { $gte: 30 } } })

// Element operators
db.users.find({ email: { $exists: true } })
db.users.find({ age: { $type: "number" } })

// Array operators
db.users.find({ hobbies: { $all: ["reading", "gaming"] } })
db.users.find({ hobbies: { $size: 3 } })
db.users.find({ "hobbies.0": "reading" })

// Text search
db.posts.createIndex({ title: "text", content: "text" })
db.posts.find({ $text: { $search: "mongodb tutorial" } })
</code></pre>
<h3 id="aggregation-pipeline"><a class="header" href="#aggregation-pipeline">Aggregation Pipeline</a></h3>
<pre><code class="language-javascript">// Basic aggregation
db.orders.aggregate([
  // Match stage (filter)
  { $match: { status: "completed" } },

  // Group stage
  {
    $group: {
      _id: "$customerId",
      totalSpent: { $sum: "$amount" },
      orderCount: { $sum: 1 },
      avgOrderAmount: { $avg: "$amount" }
    }
  },

  // Sort stage
  { $sort: { totalSpent: -1 } },

  // Limit stage
  { $limit: 10 }
])

// Complex aggregation with lookup
db.orders.aggregate([
  // Join with users collection
  {
    $lookup: {
      from: "users",
      localField: "userId",
      foreignField: "_id",
      as: "user"
    }
  },

  // Unwind array
  { $unwind: "$user" },

  // Project (reshape documents)
  {
    $project: {
      orderNumber: 1,
      amount: 1,
      userName: "$user.name",
      userEmail: "$user.email"
    }
  }
])

// Aggregation operators
db.sales.aggregate([
  {
    $group: {
      _id: "$category",
      total: { $sum: "$amount" },
      avg: { $avg: "$amount" },
      min: { $min: "$amount" },
      max: { $max: "$amount" },
      count: { $sum: 1 },
      items: { $push: "$productName" },
      first: { $first: "$date" },
      last: { $last: "$date" }
    }
  }
])
</code></pre>
<hr />
<h2 id="indexing"><a class="header" href="#indexing">Indexing</a></h2>
<h3 id="creating-indexes"><a class="header" href="#creating-indexes">Creating Indexes</a></h3>
<pre><code class="language-javascript">// Single field index
db.users.createIndex({ email: 1 })

// Compound index
db.users.createIndex({ lastName: 1, firstName: 1 })

// Unique index
db.users.createIndex({ email: 1 }, { unique: true })

// Text index
db.posts.createIndex({ title: "text", content: "text" })

// 2dsphere index (geospatial)
db.locations.createIndex({ coordinates: "2dsphere" })

// TTL index (auto-delete after time)
db.sessions.createIndex(
  { createdAt: 1 },
  { expireAfterSeconds: 3600 }
)

// Partial index
db.orders.createIndex(
  { status: 1 },
  { partialFilterExpression: { status: "active" } }
)

// Sparse index
db.users.createIndex(
  { phoneNumber: 1 },
  { sparse: true }
)
</code></pre>
<h3 id="index-management"><a class="header" href="#index-management">Index Management</a></h3>
<pre><code class="language-javascript">// List indexes
db.users.getIndexes()

// Drop index
db.users.dropIndex("email_1")

// Drop all indexes
db.users.dropIndexes()

// Explain query (check index usage)
db.users.find({ email: "john@example.com" }).explain("executionStats")
</code></pre>
<hr />
<h2 id="mongodb-with-nodejs"><a class="header" href="#mongodb-with-nodejs">MongoDB with Node.js</a></h2>
<h3 id="installation-19"><a class="header" href="#installation-19">Installation</a></h3>
<pre><code class="language-bash">npm install mongodb
# or
npm install mongoose
</code></pre>
<h3 id="native-mongodb-driver"><a class="header" href="#native-mongodb-driver">Native MongoDB Driver</a></h3>
<pre><code class="language-javascript">const { MongoClient } = require('mongodb');

const url = 'mongodb://localhost:27017';
const client = new MongoClient(url);

async function main() {
  await client.connect();
  console.log('Connected to MongoDB');

  const db = client.db('mydb');
  const users = db.collection('users');

  // Insert
  const result = await users.insertOne({
    name: 'John Doe',
    email: 'john@example.com',
    age: 30
  });
  console.log('Inserted:', result.insertedId);

  // Find
  const user = await users.findOne({ email: 'john@example.com' });
  console.log('Found:', user);

  // Update
  await users.updateOne(
    { email: 'john@example.com' },
    { $set: { age: 31 } }
  );

  // Delete
  await users.deleteOne({ email: 'john@example.com' });

  await client.close();
}

main().catch(console.error);
</code></pre>
<h3 id="mongoose-odm"><a class="header" href="#mongoose-odm">Mongoose ODM</a></h3>
<pre><code class="language-javascript">const mongoose = require('mongoose');

// Connect
mongoose.connect('mongodb://localhost:27017/mydb', {
  useNewUrlParser: true,
  useUnifiedTopology: true
});

// Define schema
const userSchema = new mongoose.Schema({
  name: { type: String, required: true },
  email: { type: String, required: true, unique: true },
  age: { type: Number, min: 0, max: 120 },
  createdAt: { type: Date, default: Date.now },
  address: {
    street: String,
    city: String,
    state: String,
    zip: String
  },
  hobbies: [String],
  status: {
    type: String,
    enum: ['active', 'inactive', 'banned'],
    default: 'active'
  }
});

// Instance methods
userSchema.methods.getFullInfo = function() {
  return `${this.name} (${this.email})`;
};

// Static methods
userSchema.statics.findByEmail = function(email) {
  return this.findOne({ email });
};

// Virtuals
userSchema.virtual('isAdult').get(function() {
  return this.age &gt;= 18;
});

// Middleware
userSchema.pre('save', function(next) {
  console.log('About to save user:', this.name);
  next();
});

// Create model
const User = mongoose.model('User', userSchema);

// CRUD operations
async function examples() {
  // Create
  const user = new User({
    name: 'John Doe',
    email: 'john@example.com',
    age: 30,
    hobbies: ['reading', 'coding']
  });
  await user.save();

  // Find
  const users = await User.find({ age: { $gte: 25 } });
  const john = await User.findByEmail('john@example.com');

  // Update
  await User.updateOne({ email: 'john@example.com' }, { age: 31 });
  // or
  john.age = 31;
  await john.save();

  // Delete
  await User.deleteOne({ email: 'john@example.com' });

  // Populate (references)
  const postSchema = new mongoose.Schema({
    title: String,
    author: { type: mongoose.Schema.Types.ObjectId, ref: 'User' }
  });
  const Post = mongoose.model('Post', postSchema);

  const posts = await Post.find().populate('author');
}
</code></pre>
<h3 id="express--mongoose-api"><a class="header" href="#express--mongoose-api">Express + Mongoose API</a></h3>
<pre><code class="language-javascript">const express = require('express');
const mongoose = require('mongoose');

const app = express();
app.use(express.json());

// Connect to MongoDB
mongoose.connect('mongodb://localhost:27017/mydb');

// User model
const User = mongoose.model('User', new mongoose.Schema({
  name: { type: String, required: true },
  email: { type: String, required: true, unique: true },
  age: Number
}));

// Routes
app.get('/users', async (req, res) =&gt; {
  try {
    const users = await User.find();
    res.json(users);
  } catch (error) {
    res.status(500).json({ error: error.message });
  }
});

app.get('/users/:id', async (req, res) =&gt; {
  try {
    const user = await User.findById(req.params.id);
    if (!user) return res.status(404).json({ error: 'User not found' });
    res.json(user);
  } catch (error) {
    res.status(500).json({ error: error.message });
  }
});

app.post('/users', async (req, res) =&gt; {
  try {
    const user = new User(req.body);
    await user.save();
    res.status(201).json(user);
  } catch (error) {
    res.status(400).json({ error: error.message });
  }
});

app.put('/users/:id', async (req, res) =&gt; {
  try {
    const user = await User.findByIdAndUpdate(
      req.params.id,
      req.body,
      { new: true, runValidators: true }
    );
    if (!user) return res.status(404).json({ error: 'User not found' });
    res.json(user);
  } catch (error) {
    res.status(400).json({ error: error.message });
  }
});

app.delete('/users/:id', async (req, res) =&gt; {
  try {
    const user = await User.findByIdAndDelete(req.params.id);
    if (!user) return res.status(404).json({ error: 'User not found' });
    res.json({ message: 'User deleted' });
  } catch (error) {
    res.status(500).json({ error: error.message });
  }
});

app.listen(3000, () =&gt; console.log('Server running on port 3000'));
</code></pre>
<hr />
<h2 id="best-practices-75"><a class="header" href="#best-practices-75">Best Practices</a></h2>
<h3 id="1-schema-design"><a class="header" href="#1-schema-design">1. Schema Design</a></h3>
<pre><code class="language-javascript">// Embed related data when:
// - Data is frequently accessed together
// - Data doesn't change often
// - Array size is bounded

// Reference when:
// - Data is frequently accessed separately
// - Data changes frequently
// - Array size is unbounded
</code></pre>
<h3 id="2-use-appropriate-indexes"><a class="header" href="#2-use-appropriate-indexes">2. Use Appropriate Indexes</a></h3>
<pre><code class="language-javascript">// Index fields used in queries
db.users.createIndex({ email: 1 })

// Compound indexes for multi-field queries
db.users.createIndex({ status: 1, createdAt: -1 })

// Monitor index usage
db.users.aggregate([{ $indexStats: {} }])
</code></pre>
<h3 id="3-validate-data"><a class="header" href="#3-validate-data">3. Validate Data</a></h3>
<pre><code class="language-javascript">// Mongoose validation
const userSchema = new mongoose.Schema({
  email: {
    type: String,
    required: true,
    validate: {
      validator: function(v) {
        return /^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/.test(v);
      },
      message: props =&gt; `${props.value} is not a valid email!`
    }
  },
  age: {
    type: Number,
    min: [0, 'Age must be positive'],
    max: [120, 'Age seems unrealistic']
  }
});
</code></pre>
<h3 id="4-handle-errors"><a class="header" href="#4-handle-errors">4. Handle Errors</a></h3>
<pre><code class="language-javascript">try {
  await User.create({ email: 'invalid' });
} catch (error) {
  if (error.name === 'ValidationError') {
    // Handle validation error
  } else if (error.code === 11000) {
    // Handle duplicate key error
  }
}
</code></pre>
<h3 id="5-use-transactions-for-multi-document-operations"><a class="header" href="#5-use-transactions-for-multi-document-operations">5. Use Transactions (for multi-document operations)</a></h3>
<pre><code class="language-javascript">const session = await mongoose.startSession();
session.startTransaction();

try {
  await User.create([{ name: 'John' }], { session });
  await Post.create([{ title: 'First Post' }], { session });

  await session.commitTransaction();
} catch (error) {
  await session.abortTransaction();
  throw error;
} finally {
  session.endSession();
}
</code></pre>
<hr />
<h2 id="performance-optimization-6"><a class="header" href="#performance-optimization-6">Performance Optimization</a></h2>
<h3 id="1-query-optimization"><a class="header" href="#1-query-optimization">1. Query Optimization</a></h3>
<pre><code class="language-javascript">// Use projection
db.users.find({}, { name: 1, email: 1 })

// Use covered queries (query uses only indexed fields)
db.users.createIndex({ email: 1, name: 1 })
db.users.find({ email: 'john@example.com' }, { email: 1, name: 1, _id: 0 })

// Limit results
db.users.find().limit(10)

// Use lean() in Mongoose (skip hydration)
const users = await User.find().lean()
</code></pre>
<h3 id="2-connection-pooling"><a class="header" href="#2-connection-pooling">2. Connection Pooling</a></h3>
<pre><code class="language-javascript">const mongoose = require('mongoose');

mongoose.connect('mongodb://localhost:27017/mydb', {
  maxPoolSize: 10,
  minPoolSize: 5
});
</code></pre>
<h3 id="3-batch-operations"><a class="header" href="#3-batch-operations">3. Batch Operations</a></h3>
<pre><code class="language-javascript">// Bulk insert
db.users.insertMany([
  { name: 'User 1' },
  { name: 'User 2' },
  { name: 'User 3' }
], { ordered: false })

// Bulk write
db.users.bulkWrite([
  { insertOne: { document: { name: 'John' } } },
  { updateOne: { filter: { name: 'Jane' }, update: { $set: { age: 30 } } } },
  { deleteOne: { filter: { name: 'Bob' } } }
])
</code></pre>
<h3 id="4-caching"><a class="header" href="#4-caching">4. Caching</a></h3>
<pre><code class="language-javascript">const Redis = require('redis');
const redis = Redis.createClient();

async function getUser(id) {
  // Check cache first
  const cached = await redis.get(`user:${id}`);
  if (cached) return JSON.parse(cached);

  // Query database
  const user = await User.findById(id);

  // Store in cache
  await redis.setex(`user:${id}`, 3600, JSON.stringify(user));

  return user;
}
</code></pre>
<hr />
<h2 id="resources-37"><a class="header" href="#resources-37">Resources</a></h2>
<p><strong>Official Documentation:</strong></p>
<ul>
<li><a href="https://docs.mongodb.com/">MongoDB Documentation</a></li>
<li><a href="https://university.mongodb.com/">MongoDB University</a></li>
<li><a href="https://mongoosejs.com/">Mongoose Documentation</a></li>
</ul>
<p><strong>Tools:</strong></p>
<ul>
<li><a href="https://www.mongodb.com/products/compass">MongoDB Compass</a> - GUI</li>
<li><a href="https://studio3t.com/">Studio 3T</a> - IDE for MongoDB</li>
<li><a href="https://www.mongodb.com/docs/mongodb-shell/">mongosh</a> - MongoDB Shell</li>
</ul>
<p><strong>Learning:</strong></p>
<ul>
<li><a href="https://www.mongodb.com/docs/manual/tutorial/">MongoDB Tutorial</a></li>
<li><a href="https://mongoosejs.com/docs/guide.html">Mongoose Guide</a></li>
<li><a href="https://www.mongodb.com/docs/manual/administration/analyzing-mongodb-performance/">MongoDB Performance</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="redis"><a class="header" href="#redis">Redis</a></h1>
<p>Redis (Remote Dictionary Server) is an open-source, in-memory data structure store used as a database, cache, message broker, and streaming engine. Known for its high performance and versatility, Redis supports various data structures and is widely used for real-time applications.</p>
<h2 id="table-of-contents-44"><a class="header" href="#table-of-contents-44">Table of Contents</a></h2>
<ul>
<li><a href="databases/redis.html#introduction">Introduction</a></li>
<li><a href="databases/redis.html#installation-and-setup">Installation and Setup</a></li>
<li><a href="databases/redis.html#data-structures">Data Structures</a></li>
<li><a href="databases/redis.html#common-operations">Common Operations</a></li>
<li><a href="databases/redis.html#caching-strategies">Caching Strategies</a></li>
<li><a href="databases/redis.html#pubsub-messaging">Pub/Sub Messaging</a></li>
<li><a href="databases/redis.html#redis-with-nodejs">Redis with Node.js</a></li>
<li><a href="databases/redis.html#best-practices">Best Practices</a></li>
<li><a href="databases/redis.html#performance-and-persistence">Performance and Persistence</a></li>
</ul>
<hr />
<h2 id="introduction-24"><a class="header" href="#introduction-24">Introduction</a></h2>
<p><strong>Key Features:</strong></p>
<ul>
<li>In-memory data storage</li>
<li>Sub-millisecond latency</li>
<li>Multiple data structures (strings, hashes, lists, sets, sorted sets)</li>
<li>Pub/Sub messaging</li>
<li>Transactions</li>
<li>Lua scripting</li>
<li>Persistence options (RDB, AOF)</li>
<li>Replication and high availability</li>
<li>Clustering for horizontal scaling</li>
</ul>
<p><strong>Use Cases:</strong></p>
<ul>
<li>Caching</li>
<li>Session storage</li>
<li>Real-time analytics</li>
<li>Leaderboards and counting</li>
<li>Rate limiting</li>
<li>Message queues</li>
<li>Real-time chat applications</li>
<li>Geospatial data</li>
</ul>
<hr />
<h2 id="installation-and-setup-2"><a class="header" href="#installation-and-setup-2">Installation and Setup</a></h2>
<h3 id="install-redis"><a class="header" href="#install-redis">Install Redis</a></h3>
<p><strong>macOS:</strong></p>
<pre><code class="language-bash">brew install redis
brew services start redis
</code></pre>
<p><strong>Ubuntu:</strong></p>
<pre><code class="language-bash">sudo apt update
sudo apt install redis-server
sudo systemctl start redis-server
</code></pre>
<p><strong>Docker:</strong></p>
<pre><code class="language-bash">docker run -d -p 6379:6379 --name redis redis:latest
</code></pre>
<h3 id="redis-cli"><a class="header" href="#redis-cli">Redis CLI</a></h3>
<pre><code class="language-bash"># Connect to Redis
redis-cli

# Test connection
127.0.0.1:6379&gt; PING
PONG

# Select database (0-15)
127.0.0.1:6379&gt; SELECT 1

# Get all keys
127.0.0.1:6379&gt; KEYS *

# Clear database
127.0.0.1:6379&gt; FLUSHDB

# Clear all databases
127.0.0.1:6379&gt; FLUSHALL
</code></pre>
<hr />
<h2 id="data-structures-4"><a class="header" href="#data-structures-4">Data Structures</a></h2>
<h3 id="strings-4"><a class="header" href="#strings-4">Strings</a></h3>
<pre><code class="language-bash"># Set and get
SET name "John Doe"
GET name

# Set with expiration (seconds)
SETEX session:123 3600 "user_data"

# Set if not exists
SETNX key "value"

# Multiple set/get
MSET key1 "value1" key2 "value2"
MGET key1 key2

# Increment/decrement
SET counter 10
INCR counter        # 11
INCRBY counter 5    # 16
DECR counter        # 15
DECRBY counter 3    # 12

# Append
APPEND key "more_data"

# Get length
STRLEN key
</code></pre>
<h3 id="hashes-objects"><a class="header" href="#hashes-objects">Hashes (Objects)</a></h3>
<pre><code class="language-bash"># Set hash field
HSET user:1 name "John" age 30 email "john@example.com"

# Get hash field
HGET user:1 name

# Get all fields
HGETALL user:1

# Get multiple fields
HMGET user:1 name email

# Check if field exists
HEXISTS user:1 name

# Delete field
HDEL user:1 age

# Get all keys/values
HKEYS user:1
HVALS user:1

# Increment hash field
HINCRBY user:1 loginCount 1
</code></pre>
<h3 id="lists-1"><a class="header" href="#lists-1">Lists</a></h3>
<pre><code class="language-bash"># Push to list
LPUSH mylist "first"    # Push to left
RPUSH mylist "last"     # Push to right

# Pop from list
LPOP mylist             # Pop from left
RPOP mylist             # Pop from right

# Get range
LRANGE mylist 0 -1      # Get all
LRANGE mylist 0 9       # Get first 10

# Get by index
LINDEX mylist 0

# List length
LLEN mylist

# Trim list
LTRIM mylist 0 99       # Keep first 100 items

# Blocking pop (for queues)
BLPOP mylist 0          # Block until item available
</code></pre>
<h3 id="sets-1"><a class="header" href="#sets-1">Sets</a></h3>
<pre><code class="language-bash"># Add members
SADD myset "member1" "member2" "member3"

# Get all members
SMEMBERS myset

# Check membership
SISMEMBER myset "member1"

# Remove member
SREM myset "member1"

# Set operations
SUNION set1 set2        # Union
SINTER set1 set2        # Intersection
SDIFF set1 set2         # Difference

# Random member
SRANDMEMBER myset
SPOP myset              # Pop random member

# Set size
SCARD myset
</code></pre>
<h3 id="sorted-sets-leaderboards"><a class="header" href="#sorted-sets-leaderboards">Sorted Sets (Leaderboards)</a></h3>
<pre><code class="language-bash"># Add members with scores
ZADD leaderboard 100 "player1" 200 "player2" 150 "player3"

# Get range by rank
ZRANGE leaderboard 0 9           # Top 10 (ascending)
ZREVRANGE leaderboard 0 9        # Top 10 (descending)

# Get range with scores
ZRANGE leaderboard 0 9 WITHSCORES

# Get rank
ZRANK leaderboard "player1"      # Ascending rank
ZREVRANK leaderboard "player1"   # Descending rank

# Get score
ZSCORE leaderboard "player1"

# Increment score
ZINCRBY leaderboard 50 "player1"

# Range by score
ZRANGEBYSCORE leaderboard 100 200

# Count in range
ZCOUNT leaderboard 100 200

# Remove member
ZREM leaderboard "player1"
</code></pre>
<hr />
<h2 id="common-operations-3"><a class="header" href="#common-operations-3">Common Operations</a></h2>
<h3 id="key-management-2"><a class="header" href="#key-management-2">Key Management</a></h3>
<pre><code class="language-bash"># Set expiration
EXPIRE key 60           # Expire in 60 seconds
EXPIREAT key 1609459200 # Expire at timestamp
TTL key                 # Get time to live
PERSIST key             # Remove expiration

# Delete keys
DEL key1 key2 key3

# Check if key exists
EXISTS key

# Get key type
TYPE key

# Rename key
RENAME oldkey newkey
RENAMENX oldkey newkey  # Rename if new key doesn't exist

# Get all keys matching pattern
KEYS user:*
SCAN 0 MATCH user:* COUNT 10  # Better for production
</code></pre>
<h3 id="transactions-5"><a class="header" href="#transactions-5">Transactions</a></h3>
<pre><code class="language-bash">MULTI
SET key1 "value1"
SET key2 "value2"
INCR counter
EXEC

# With watch (optimistic locking)
WATCH key
MULTI
SET key "new_value"
EXEC
</code></pre>
<hr />
<h2 id="caching-strategies"><a class="header" href="#caching-strategies">Caching Strategies</a></h2>
<h3 id="cache-aside-lazy-loading"><a class="header" href="#cache-aside-lazy-loading">Cache-Aside (Lazy Loading)</a></h3>
<pre><code class="language-javascript">async function getUser(id) {
  const cacheKey = `user:${id}`;

  // Try cache first
  let user = await redis.get(cacheKey);

  if (user) {
    return JSON.parse(user);
  }

  // Cache miss - load from database
  user = await db.users.findById(id);

  // Store in cache
  await redis.setex(cacheKey, 3600, JSON.stringify(user));

  return user;
}
</code></pre>
<h3 id="write-through-cache"><a class="header" href="#write-through-cache">Write-Through Cache</a></h3>
<pre><code class="language-javascript">async function updateUser(id, data) {
  const cacheKey = `user:${id}`;

  // Update database
  const user = await db.users.updateById(id, data);

  // Update cache
  await redis.setex(cacheKey, 3600, JSON.stringify(user));

  return user;
}
</code></pre>
<h3 id="write-behind-write-back-cache"><a class="header" href="#write-behind-write-back-cache">Write-Behind (Write-Back) Cache</a></h3>
<pre><code class="language-javascript">async function updateUser(id, data) {
  const cacheKey = `user:${id}`;

  // Update cache immediately
  await redis.setex(cacheKey, 3600, JSON.stringify(data));

  // Queue database write
  await redis.lpush('user:updates', JSON.stringify({ id, data }));

  return data;
}

// Background worker
async function processUpdates() {
  while (true) {
    const update = await redis.brpop('user:updates', 0);
    if (update) {
      const { id, data } = JSON.parse(update[1]);
      await db.users.updateById(id, data);
    }
  }
}
</code></pre>
<hr />
<h2 id="pubsub-messaging"><a class="header" href="#pubsub-messaging">Pub/Sub Messaging</a></h2>
<h3 id="basic-pubsub"><a class="header" href="#basic-pubsub">Basic Pub/Sub</a></h3>
<pre><code class="language-javascript">const redis = require('redis');

// Publisher
const publisher = redis.createClient();

publisher.publish('news', 'Breaking news!');

// Subscriber
const subscriber = redis.createClient();

subscriber.subscribe('news');

subscriber.on('message', (channel, message) =&gt; {
  console.log(`Received from ${channel}: ${message}`);
});

// Pattern subscribe
subscriber.psubscribe('user:*');

subscriber.on('pmessage', (pattern, channel, message) =&gt; {
  console.log(`Pattern ${pattern}, Channel ${channel}: ${message}`);
});
</code></pre>
<h3 id="real-time-chat-example"><a class="header" href="#real-time-chat-example">Real-Time Chat Example</a></h3>
<pre><code class="language-javascript">const express = require('express');
const http = require('http');
const socketIo = require('socket.io');
const redis = require('redis');

const app = express();
const server = http.createServer(app);
const io = socketIo(server);

const publisher = redis.createClient();
const subscriber = redis.createClient();

subscriber.subscribe('chat:messages');

// Handle Redis messages
subscriber.on('message', (channel, message) =&gt; {
  if (channel === 'chat:messages') {
    io.emit('message', JSON.parse(message));
  }
});

// Handle WebSocket connections
io.on('connection', (socket) =&gt; {
  console.log('User connected');

  socket.on('message', (msg) =&gt; {
    const message = {
      user: socket.id,
      text: msg,
      timestamp: Date.now()
    };

    // Publish to Redis
    publisher.publish('chat:messages', JSON.stringify(message));

    // Store in list
    redis.lpush('chat:history', JSON.stringify(message));
    redis.ltrim('chat:history', 0, 99); // Keep last 100 messages
  });

  socket.on('disconnect', () =&gt; {
    console.log('User disconnected');
  });
});

server.listen(3000);
</code></pre>
<hr />
<h2 id="redis-with-nodejs"><a class="header" href="#redis-with-nodejs">Redis with Node.js</a></h2>
<h3 id="using-node-redis"><a class="header" href="#using-node-redis">Using node-redis</a></h3>
<pre><code class="language-bash">npm install redis
</code></pre>
<p><strong>Basic Usage:</strong></p>
<pre><code class="language-javascript">const redis = require('redis');

const client = redis.createClient({
  url: 'redis://localhost:6379'
});

client.on('error', (err) =&gt; console.error('Redis error:', err));
client.on('connect', () =&gt; console.log('Connected to Redis'));

await client.connect();

// String operations
await client.set('key', 'value');
const value = await client.get('key');

// Hash operations
await client.hSet('user:1', 'name', 'John');
await client.hSet('user:1', 'age', '30');
const user = await client.hGetAll('user:1');

// List operations
await client.lPush('mylist', 'item1');
await client.rPush('mylist', 'item2');
const items = await client.lRange('mylist', 0, -1);

// Set operations
await client.sAdd('myset', 'member1');
await client.sAdd('myset', 'member2');
const members = await client.sMembers('myset');

// Sorted set operations
await client.zAdd('leaderboard', { score: 100, value: 'player1' });
const top = await client.zRange('leaderboard', 0, 9, { REV: true });

await client.disconnect();
</code></pre>
<h3 id="caching-middleware-express"><a class="header" href="#caching-middleware-express">Caching Middleware (Express)</a></h3>
<pre><code class="language-javascript">const redis = require('redis');
const client = redis.createClient();

await client.connect();

function cache(duration) {
  return async (req, res, next) =&gt; {
    const key = `cache:${req.originalUrl}`;

    try {
      const cachedResponse = await client.get(key);

      if (cachedResponse) {
        return res.json(JSON.parse(cachedResponse));
      }

      // Modify res.json to cache response
      const originalJson = res.json.bind(res);

      res.json = (body) =&gt; {
        client.setex(key, duration, JSON.stringify(body));
        return originalJson(body);
      };

      next();
    } catch (error) {
      next();
    }
  };
}

// Usage
app.get('/api/users', cache(300), async (req, res) =&gt; {
  const users = await db.users.findAll();
  res.json(users);
});
</code></pre>
<h3 id="session-storage"><a class="header" href="#session-storage">Session Storage</a></h3>
<pre><code class="language-javascript">const session = require('express-session');
const RedisStore = require('connect-redis').default;
const redis = require('redis');

const redisClient = redis.createClient();
await redisClient.connect();

app.use(
  session({
    store: new RedisStore({ client: redisClient }),
    secret: 'your-secret',
    resave: false,
    saveUninitialized: false,
    cookie: {
      secure: false, // Set true for HTTPS
      httpOnly: true,
      maxAge: 1000 * 60 * 60 * 24 // 1 day
    }
  })
);

app.get('/', (req, res) =&gt; {
  if (req.session.views) {
    req.session.views++;
  } else {
    req.session.views = 1;
  }
  res.send(`Views: ${req.session.views}`);
});
</code></pre>
<h3 id="rate-limiting-2"><a class="header" href="#rate-limiting-2">Rate Limiting</a></h3>
<pre><code class="language-javascript">async function rateLimiter(userId, maxRequests = 10, windowSeconds = 60) {
  const key = `rate_limit:${userId}`;
  const current = await client.incr(key);

  if (current === 1) {
    await client.expire(key, windowSeconds);
  }

  if (current &gt; maxRequests) {
    const ttl = await client.ttl(key);
    throw new Error(`Rate limit exceeded. Try again in ${ttl} seconds`);
  }

  return {
    remaining: maxRequests - current,
    reset: windowSeconds
  };
}

// Middleware
async function rateLimitMiddleware(req, res, next) {
  const userId = req.user?.id || req.ip;

  try {
    const result = await rateLimiter(userId);
    res.set('X-RateLimit-Remaining', result.remaining);
    res.set('X-RateLimit-Reset', result.reset);
    next();
  } catch (error) {
    res.status(429).json({ error: error.message });
  }
}

app.use(rateLimitMiddleware);
</code></pre>
<h3 id="distributed-locking"><a class="header" href="#distributed-locking">Distributed Locking</a></h3>
<pre><code class="language-javascript">async function acquireLock(lockKey, timeout = 10000) {
  const lockValue = Math.random().toString(36);
  const result = await client.set(lockKey, lockValue, {
    NX: true,
    PX: timeout
  });

  if (result === 'OK') {
    return lockValue;
  }

  return null;
}

async function releaseLock(lockKey, lockValue) {
  const script = `
    if redis.call("get", KEYS[1]) == ARGV[1] then
      return redis.call("del", KEYS[1])
    else
      return 0
    end
  `;

  return await client.eval(script, {
    keys: [lockKey],
    arguments: [lockValue]
  });
}

// Usage
async function criticalSection() {
  const lock = await acquireLock('resource:lock');

  if (!lock) {
    throw new Error('Could not acquire lock');
  }

  try {
    // Perform critical operation
    await performOperation();
  } finally {
    await releaseLock('resource:lock', lock);
  }
}
</code></pre>
<hr />
<h2 id="best-practices-76"><a class="header" href="#best-practices-76">Best Practices</a></h2>
<h3 id="1-key-naming-conventions"><a class="header" href="#1-key-naming-conventions">1. Key Naming Conventions</a></h3>
<pre><code class="language-bash"># Use descriptive, hierarchical names
user:1:profile
user:1:sessions
order:12345:items

# Use consistent separators
user:1:profile  # Colon-separated
user_1_profile  # Underscore-separated

# Include type in key name
string:user:1:name
hash:user:1
list:user:1:notifications
</code></pre>
<h3 id="2-set-expiration-times"><a class="header" href="#2-set-expiration-times">2. Set Expiration Times</a></h3>
<pre><code class="language-javascript">// Always set TTL for cache keys
await client.setex('cache:key', 3600, 'value');

// Use appropriate expiration times
const MINUTE = 60;
const HOUR = 60 * MINUTE;
const DAY = 24 * HOUR;

await client.setex('session:123', 30 * MINUTE, data);
await client.setex('cache:user:1', 1 * HOUR, data);
await client.setex('temp:verification', 10 * MINUTE, code);
</code></pre>
<h3 id="3-use-pipelines-for-multiple-commands"><a class="header" href="#3-use-pipelines-for-multiple-commands">3. Use Pipelines for Multiple Commands</a></h3>
<pre><code class="language-javascript">const pipeline = client.multi();

pipeline.set('key1', 'value1');
pipeline.set('key2', 'value2');
pipeline.incr('counter');
pipeline.hSet('user:1', 'name', 'John');

const results = await pipeline.exec();
</code></pre>
<h3 id="4-handle-connection-errors"><a class="header" href="#4-handle-connection-errors">4. Handle Connection Errors</a></h3>
<pre><code class="language-javascript">const client = redis.createClient({
  url: 'redis://localhost:6379',
  socket: {
    reconnectStrategy: (retries) =&gt; {
      if (retries &gt; 10) {
        return new Error('Max retries reached');
      }
      return retries * 100;
    }
  }
});

client.on('error', (err) =&gt; {
  console.error('Redis error:', err);
});

client.on('reconnecting', () =&gt; {
  console.log('Reconnecting to Redis...');
});

client.on('ready', () =&gt; {
  console.log('Redis is ready');
});
</code></pre>
<h3 id="5-memory-management"><a class="header" href="#5-memory-management">5. Memory Management</a></h3>
<pre><code class="language-javascript">// Set maxmemory and eviction policy in redis.conf
// maxmemory 256mb
// maxmemory-policy allkeys-lru

// Monitor memory usage
const info = await client.info('memory');
console.log(info);

// Use SCAN instead of KEYS
let cursor = 0;
do {
  const result = await client.scan(cursor, {
    MATCH: 'user:*',
    COUNT: 100
  });
  cursor = result.cursor;
  const keys = result.keys;
  // Process keys
} while (cursor !== 0);
</code></pre>
<hr />
<h2 id="performance-and-persistence"><a class="header" href="#performance-and-persistence">Performance and Persistence</a></h2>
<h3 id="persistence-options"><a class="header" href="#persistence-options">Persistence Options</a></h3>
<p><strong>RDB (Redis Database Backup):</strong></p>
<pre><code class="language-conf"># redis.conf
save 900 1      # Save if 1 key changed in 15 minutes
save 300 10     # Save if 10 keys changed in 5 minutes
save 60 10000   # Save if 10000 keys changed in 1 minute

dbfilename dump.rdb
dir /var/lib/redis
</code></pre>
<p><strong>AOF (Append Only File):</strong></p>
<pre><code class="language-conf"># redis.conf
appendonly yes
appendfilename "appendonly.aof"

# Sync strategy
appendfsync always      # Slowest, safest
appendfsync everysec   # Good balance (recommended)
appendfsync no         # Fastest, least safe
</code></pre>
<h3 id="replication"><a class="header" href="#replication">Replication</a></h3>
<pre><code class="language-bash"># On replica
redis-cli
&gt; REPLICAOF master-host 6379

# Check replication status
&gt; INFO replication
</code></pre>
<h3 id="monitoring"><a class="header" href="#monitoring">Monitoring</a></h3>
<pre><code class="language-javascript">// Monitor commands
client.monitor((err, res) =&gt; {
  console.log(res);
});

// Get stats
const info = await client.info();
console.log(info);

// Slow log
const slowlog = await client.slowlog('GET', 10);
console.log(slowlog);
</code></pre>
<hr />
<h2 id="resources-38"><a class="header" href="#resources-38">Resources</a></h2>
<p><strong>Official Documentation:</strong></p>
<ul>
<li><a href="https://redis.io/documentation">Redis Documentation</a></li>
<li><a href="https://redis.io/commands">Redis Commands</a></li>
<li><a href="https://github.com/redis/node-redis">node-redis</a></li>
</ul>
<p><strong>Tools:</strong></p>
<ul>
<li><a href="https://redis.com/redis-enterprise/redis-insight/">RedisInsight</a> - GUI</li>
<li><a href="https://redis.io/topics/rediscli">redis-cli</a> - Command line</li>
<li><a href="https://redis.io/topics/benchmarks">redis-benchmark</a> - Performance testing</li>
</ul>
<p><strong>Learning:</strong></p>
<ul>
<li><a href="https://university.redis.com/">Redis University</a></li>
<li><a href="https://try.redis.io/">Try Redis</a></li>
<li><a href="https://redis.io/topics/patterns">Redis Patterns</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="apache-kafka"><a class="header" href="#apache-kafka">Apache Kafka</a></h1>
<p>Apache Kafka is a distributed event streaming platform capable of handling trillions of events a day. It's used for building real-time data pipelines and streaming applications, providing high-throughput, fault-tolerant, and scalable messaging.</p>
<h2 id="table-of-contents-45"><a class="header" href="#table-of-contents-45">Table of Contents</a></h2>
<ul>
<li><a href="databases/kafka.html#introduction">Introduction</a></li>
<li><a href="databases/kafka.html#core-concepts">Core Concepts</a></li>
<li><a href="databases/kafka.html#installation-and-setup">Installation and Setup</a></li>
<li><a href="databases/kafka.html#producers">Producers</a></li>
<li><a href="databases/kafka.html#consumers">Consumers</a></li>
<li><a href="databases/kafka.html#topics-and-partitions">Topics and Partitions</a></li>
<li><a href="databases/kafka.html#kafka-with-nodejs">Kafka with Node.js</a></li>
<li><a href="databases/kafka.html#best-practices">Best Practices</a></li>
<li><a href="databases/kafka.html#production-considerations">Production Considerations</a></li>
</ul>
<hr />
<h2 id="introduction-25"><a class="header" href="#introduction-25">Introduction</a></h2>
<p><strong>Key Features:</strong></p>
<ul>
<li>High-throughput message streaming</li>
<li>Fault-tolerant and durable</li>
<li>Horizontal scalability</li>
<li>Low latency (sub-millisecond)</li>
<li>Replay capability</li>
<li>Stream processing with Kafka Streams</li>
<li>Connect framework for integrations</li>
</ul>
<p><strong>Use Cases:</strong></p>
<ul>
<li>Event-driven architectures</li>
<li>Log aggregation</li>
<li>Real-time analytics</li>
<li>Change Data Capture (CDC)</li>
<li>Microservices communication</li>
<li>Stream processing</li>
<li>Message queuing</li>
<li>Activity tracking</li>
</ul>
<hr />
<h2 id="core-concepts-5"><a class="header" href="#core-concepts-5">Core Concepts</a></h2>
<h3 id="topics"><a class="header" href="#topics">Topics</a></h3>
<p>Logical channels for messages, similar to database tables.</p>
<h3 id="partitions"><a class="header" href="#partitions">Partitions</a></h3>
<p>Topics are split into partitions for parallel processing.</p>
<h3 id="producers"><a class="header" href="#producers">Producers</a></h3>
<p>Applications that publish messages to topics.</p>
<h3 id="consumers"><a class="header" href="#consumers">Consumers</a></h3>
<p>Applications that subscribe to topics and process messages.</p>
<h3 id="consumer-groups"><a class="header" href="#consumer-groups">Consumer Groups</a></h3>
<p>Multiple consumers working together to process messages from a topic.</p>
<h3 id="brokers"><a class="header" href="#brokers">Brokers</a></h3>
<p>Kafka servers that store and serve data.</p>
<h3 id="zookeeperkraft"><a class="header" href="#zookeeperkraft">Zookeeper/KRaft</a></h3>
<p>Coordination service for managing Kafka cluster (KRaft is the newer alternative).</p>
<hr />
<h2 id="installation-and-setup-3"><a class="header" href="#installation-and-setup-3">Installation and Setup</a></h2>
<h3 id="docker-compose-setup"><a class="header" href="#docker-compose-setup">Docker Compose Setup</a></h3>
<p><strong>docker-compose.yml:</strong></p>
<pre><code class="language-yaml">version: '3'
services:
  zookeeper:
    image: confluentinc/cp-zookeeper:latest
    environment:
      ZOOKEEPER_CLIENT_PORT: 2181
      ZOOKEEPER_TICK_TIME: 2000

  kafka:
    image: confluentinc/cp-kafka:latest
    depends_on:
      - zookeeper
    ports:
      - "9092:9092"
    environment:
      KAFKA_BROKER_ID: 1
      KAFKA_ZOOKEEPER_CONNECT: zookeeper:2181
      KAFKA_ADVERTISED_LISTENERS: PLAINTEXT://localhost:9092
      KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR: 1
</code></pre>
<pre><code class="language-bash">docker-compose up -d
</code></pre>
<h3 id="cli-commands-1"><a class="header" href="#cli-commands-1">CLI Commands</a></h3>
<pre><code class="language-bash"># Create topic
kafka-topics --create \
  --bootstrap-server localhost:9092 \
  --topic my-topic \
  --partitions 3 \
  --replication-factor 1

# List topics
kafka-topics --list --bootstrap-server localhost:9092

# Describe topic
kafka-topics --describe \
  --bootstrap-server localhost:9092 \
  --topic my-topic

# Delete topic
kafka-topics --delete \
  --bootstrap-server localhost:9092 \
  --topic my-topic

# Produce messages
kafka-console-producer \
  --bootstrap-server localhost:9092 \
  --topic my-topic

# Consume messages
kafka-console-consumer \
  --bootstrap-server localhost:9092 \
  --topic my-topic \
  --from-beginning
</code></pre>
<hr />
<h2 id="producers-1"><a class="header" href="#producers-1">Producers</a></h2>
<h3 id="basic-producer-concept"><a class="header" href="#basic-producer-concept">Basic Producer Concept</a></h3>
<pre><code class="language-javascript">// Producer sends messages to topics
Message → Producer → Kafka Broker → Topic Partition
</code></pre>
<h3 id="producer-configuration"><a class="header" href="#producer-configuration">Producer Configuration</a></h3>
<pre><code class="language-javascript">{
  'bootstrap.servers': 'localhost:9092',
  'client.id': 'my-producer',
  'acks': 'all',                    // Wait for all replicas
  'compression.type': 'gzip',       // Compress messages
  'max.in.flight.requests.per.connection': 5,
  'retries': 3,                     // Retry failed sends
  'batch.size': 16384,              // Batch size in bytes
  'linger.ms': 10                   // Wait time before sending batch
}
</code></pre>
<hr />
<h2 id="consumers-1"><a class="header" href="#consumers-1">Consumers</a></h2>
<h3 id="basic-consumer-concept"><a class="header" href="#basic-consumer-concept">Basic Consumer Concept</a></h3>
<pre><code class="language-javascript">// Consumers read messages from topics
Kafka Broker → Topic Partition → Consumer Group → Consumer
</code></pre>
<h3 id="consumer-groups-1"><a class="header" href="#consumer-groups-1">Consumer Groups</a></h3>
<ul>
<li>Multiple consumers in a group share the workload</li>
<li>Each partition is consumed by only one consumer in a group</li>
<li>Enables parallel processing and fault tolerance</li>
</ul>
<h3 id="consumer-configuration"><a class="header" href="#consumer-configuration">Consumer Configuration</a></h3>
<pre><code class="language-javascript">{
  'bootstrap.servers': 'localhost:9092',
  'group.id': 'my-consumer-group',
  'auto.offset.reset': 'earliest',  // Start from beginning if no offset
  'enable.auto.commit': false,      // Manual commit for reliability
  'max.poll.records': 500           // Max records per poll
}
</code></pre>
<hr />
<h2 id="topics-and-partitions"><a class="header" href="#topics-and-partitions">Topics and Partitions</a></h2>
<h3 id="topic-design"><a class="header" href="#topic-design">Topic Design</a></h3>
<pre><code class="language-javascript">// Good topic naming
user.events
order.created
payment.processed
notification.email.sent

// Partition strategy
// - More partitions = more parallelism
// - But more partitions = more overhead
// Start with: partitions = throughput (MB/s) / partition throughput (MB/s)
</code></pre>
<h3 id="message-keys"><a class="header" href="#message-keys">Message Keys</a></h3>
<pre><code class="language-javascript">// Messages with same key go to same partition
// Ensures ordering for related events
{
  key: 'user:123',        // All events for user 123 in same partition
  value: { ... }
}
</code></pre>
<hr />
<h2 id="kafka-with-nodejs"><a class="header" href="#kafka-with-nodejs">Kafka with Node.js</a></h2>
<h3 id="installation-20"><a class="header" href="#installation-20">Installation</a></h3>
<pre><code class="language-bash">npm install kafkajs
</code></pre>
<h3 id="producer-example"><a class="header" href="#producer-example">Producer Example</a></h3>
<pre><code class="language-javascript">const { Kafka } = require('kafkajs');

const kafka = new Kafka({
  clientId: 'my-app',
  brokers: ['localhost:9092']
});

const producer = kafka.producer();

async function sendMessage() {
  await producer.connect();

  // Send single message
  await producer.send({
    topic: 'user-events',
    messages: [
      {
        key: 'user:123',
        value: JSON.stringify({
          userId: 123,
          action: 'login',
          timestamp: Date.now()
        })
      }
    ]
  });

  // Send multiple messages
  await producer.sendBatch({
    topicMessages: [
      {
        topic: 'user-events',
        messages: [
          { key: 'user:123', value: JSON.stringify({ action: 'login' }) },
          { key: 'user:124', value: JSON.stringify({ action: 'logout' }) }
        ]
      }
    ]
  });

  await producer.disconnect();
}

sendMessage().catch(console.error);
</code></pre>
<h3 id="consumer-example"><a class="header" href="#consumer-example">Consumer Example</a></h3>
<pre><code class="language-javascript">const { Kafka } = require('kafkajs');

const kafka = new Kafka({
  clientId: 'my-app',
  brokers: ['localhost:9092']
});

const consumer = kafka.consumer({
  groupId: 'my-consumer-group'
});

async function consume() {
  await consumer.connect();

  await consumer.subscribe({
    topic: 'user-events',
    fromBeginning: true
  });

  await consumer.run({
    eachMessage: async ({ topic, partition, message }) =&gt; {
      console.log({
        topic,
        partition,
        offset: message.offset,
        key: message.key?.toString(),
        value: message.value.toString()
      });

      // Process message
      const event = JSON.parse(message.value.toString());
      await processEvent(event);
    }
  });
}

async function processEvent(event) {
  console.log('Processing:', event);
  // Your business logic here
}

consume().catch(console.error);
</code></pre>
<h3 id="batch-processing"><a class="header" href="#batch-processing">Batch Processing</a></h3>
<pre><code class="language-javascript">await consumer.run({
  eachBatch: async ({
    batch,
    resolveOffset,
    heartbeat,
    isRunning,
    isStale
  }) =&gt; {
    const messages = batch.messages;

    for (let message of messages) {
      if (!isRunning() || isStale()) break;

      await processMessage(message);

      // Commit offset for this message
      resolveOffset(message.offset);

      // Send heartbeat to keep consumer alive
      await heartbeat();
    }
  }
});
</code></pre>
<h3 id="error-handling-9"><a class="header" href="#error-handling-9">Error Handling</a></h3>
<pre><code class="language-javascript">const consumer = kafka.consumer({
  groupId: 'my-group',
  retry: {
    retries: 8,
    initialRetryTime: 100,
    multiplier: 2
  }
});

consumer.on('consumer.crash', async (event) =&gt; {
  console.error('Consumer crashed:', event);
  // Implement restart logic
});

await consumer.run({
  eachMessage: async ({ topic, partition, message }) =&gt; {
    try {
      await processMessage(message);
    } catch (error) {
      console.error('Processing error:', error);

      // Dead letter queue
      await producer.send({
        topic: 'dead-letter-queue',
        messages: [{
          key: message.key,
          value: message.value,
          headers: {
            originalTopic: topic,
            error: error.message
          }
        }]
      });
    }
  }
});
</code></pre>
<h3 id="express-integration"><a class="header" href="#express-integration">Express Integration</a></h3>
<pre><code class="language-javascript">const express = require('express');
const { Kafka } = require('kafkajs');

const app = express();
app.use(express.json());

const kafka = new Kafka({
  clientId: 'api-server',
  brokers: ['localhost:9092']
});

const producer = kafka.producer();

// Connect producer on startup
producer.connect();

// API endpoint to publish events
app.post('/api/events', async (req, res) =&gt; {
  try {
    const { userId, action, data } = req.body;

    await producer.send({
      topic: 'user-events',
      messages: [{
        key: `user:${userId}`,
        value: JSON.stringify({
          userId,
          action,
          data,
          timestamp: Date.now()
        })
      }]
    });

    res.json({ success: true, message: 'Event published' });
  } catch (error) {
    res.status(500).json({ error: error.message });
  }
});

// Graceful shutdown
process.on('SIGTERM', async () =&gt; {
  await producer.disconnect();
  process.exit(0);
});

app.listen(3000);
</code></pre>
<h3 id="microservices-communication"><a class="header" href="#microservices-communication">Microservices Communication</a></h3>
<p><strong>Order Service (Producer):</strong></p>
<pre><code class="language-javascript">// order-service/producer.js
const { Kafka } = require('kafkajs');

const kafka = new Kafka({
  clientId: 'order-service',
  brokers: ['localhost:9092']
});

const producer = kafka.producer();

async function createOrder(orderData) {
  await producer.connect();

  // Publish order created event
  await producer.send({
    topic: 'order.created',
    messages: [{
      key: `order:${orderData.id}`,
      value: JSON.stringify(orderData)
    }]
  });

  console.log('Order created event published');
}
</code></pre>
<p><strong>Inventory Service (Consumer):</strong></p>
<pre><code class="language-javascript">// inventory-service/consumer.js
const { Kafka } = require('kafkajs');

const kafka = new Kafka({
  clientId: 'inventory-service',
  brokers: ['localhost:9092']
});

const consumer = kafka.consumer({
  groupId: 'inventory-service-group'
});

async function start() {
  await consumer.connect();
  await consumer.subscribe({ topic: 'order.created' });

  await consumer.run({
    eachMessage: async ({ message }) =&gt; {
      const order = JSON.parse(message.value.toString());

      console.log('Processing order:', order.id);

      // Update inventory
      await updateInventory(order.items);

      // Publish inventory updated event
      await producer.send({
        topic: 'inventory.updated',
        messages: [{
          key: `order:${order.id}`,
          value: JSON.stringify({
            orderId: order.id,
            status: 'inventory_reserved'
          })
        }]
      });
    }
  });
}

start().catch(console.error);
</code></pre>
<hr />
<h2 id="best-practices-77"><a class="header" href="#best-practices-77">Best Practices</a></h2>
<h3 id="1-message-design"><a class="header" href="#1-message-design">1. Message Design</a></h3>
<pre><code class="language-javascript">// Include metadata
{
  id: 'uuid',
  type: 'order.created',
  timestamp: 1234567890,
  version: '1.0',
  data: {
    orderId: 123,
    userId: 456,
    items: [...]
  }
}

// Use schema registry for validation
// Use Avro or Protobuf for efficient serialization
</code></pre>
<h3 id="2-error-handling"><a class="header" href="#2-error-handling">2. Error Handling</a></h3>
<pre><code class="language-javascript">// Implement retry logic
async function processWithRetry(message, maxRetries = 3) {
  for (let attempt = 1; attempt &lt;= maxRetries; attempt++) {
    try {
      await processMessage(message);
      return;
    } catch (error) {
      if (attempt === maxRetries) {
        // Send to dead letter queue
        await sendToDeadLetterQueue(message, error);
      } else {
        await sleep(Math.pow(2, attempt) * 1000); // Exponential backoff
      }
    }
  }
}
</code></pre>
<h3 id="3-consumer-groups"><a class="header" href="#3-consumer-groups">3. Consumer Groups</a></h3>
<pre><code class="language-javascript">// Use consumer groups for scalability
// Same group = load balancing
// Different groups = broadcast
const consumer = kafka.consumer({
  groupId: 'order-processing-group'
});
</code></pre>
<h3 id="4-idempotency"><a class="header" href="#4-idempotency">4. Idempotency</a></h3>
<pre><code class="language-javascript">// Ensure idempotent message processing
async function processMessage(message) {
  const messageId = message.headers.messageId;

  // Check if already processed
  const processed = await redis.get(`processed:${messageId}`);

  if (processed) {
    console.log('Message already processed');
    return;
  }

  // Process message
  await doWork(message);

  // Mark as processed
  await redis.set(`processed:${messageId}`, '1', 'EX', 86400);
}
</code></pre>
<h3 id="5-monitoring"><a class="header" href="#5-monitoring">5. Monitoring</a></h3>
<pre><code class="language-javascript">const producer = kafka.producer({
  // Enable metrics
  metricReporters: [
    {
      name: 'my-metrics',
      interval: 5000,
      async report(event) {
        console.log('Metrics:', event);
      }
    }
  ]
});

// Monitor lag
await admin.fetchOffsets({
  groupId: 'my-group',
  topics: ['my-topic']
});
</code></pre>
<hr />
<h2 id="production-considerations"><a class="header" href="#production-considerations">Production Considerations</a></h2>
<h3 id="high-availability"><a class="header" href="#high-availability">High Availability</a></h3>
<pre><code class="language-javascript">// Multiple brokers for redundancy
const kafka = new Kafka({
  clientId: 'my-app',
  brokers: [
    'kafka1:9092',
    'kafka2:9092',
    'kafka3:9092'
  ],
  retry: {
    retries: 10,
    initialRetryTime: 300,
    multiplier: 2
  }
});

// Replication factor for topics
await admin.createTopics({
  topics: [{
    topic: 'critical-events',
    numPartitions: 6,
    replicationFactor: 3  // Data replicated on 3 brokers
  }]
});
</code></pre>
<h3 id="performance-tuning-4"><a class="header" href="#performance-tuning-4">Performance Tuning</a></h3>
<pre><code class="language-javascript">// Producer optimization
const producer = kafka.producer({
  idempotent: true,          // Exactly-once semantics
  maxInFlightRequests: 5,
  compression: CompressionTypes.GZIP,
  batch: {
    size: 16384,
    lingerMs: 10
  }
});

// Consumer optimization
const consumer = kafka.consumer({
  groupId: 'my-group',
  sessionTimeout: 30000,
  heartbeatInterval: 3000,
  maxBytesPerPartition: 1048576,
  maxWaitTimeInMs: 5000
});
</code></pre>
<h3 id="security-7"><a class="header" href="#security-7">Security</a></h3>
<pre><code class="language-javascript">const kafka = new Kafka({
  clientId: 'secure-app',
  brokers: ['kafka:9093'],
  ssl: true,
  sasl: {
    mechanism: 'plain',
    username: 'my-username',
    password: 'my-password'
  }
});
</code></pre>
<hr />
<h2 id="resources-39"><a class="header" href="#resources-39">Resources</a></h2>
<p><strong>Official Documentation:</strong></p>
<ul>
<li><a href="https://kafka.apache.org/documentation/">Apache Kafka Documentation</a></li>
<li><a href="https://kafka.js.org/">KafkaJS Documentation</a></li>
<li><a href="https://docs.confluent.io/">Confluent Documentation</a></li>
</ul>
<p><strong>Tools:</strong></p>
<ul>
<li><a href="https://github.com/provectus/kafka-ui">Kafka UI</a> - Web UI for Kafka</li>
<li><a href="https://github.com/obsidiandynamics/kafdrop">Kafdrop</a> - Kafka Web UI</li>
<li><a href="https://www.kafkatool.com/">Kafka Tool</a> - GUI</li>
</ul>
<p><strong>Learning:</strong></p>
<ul>
<li><a href="https://www.confluent.io/resources/kafka-the-definitive-guide/">Kafka: The Definitive Guide</a></li>
<li><a href="https://www.confluent.io/">Confluent Platform</a></li>
<li><a href="https://kafka.apache.org/quickstart">Apache Kafka Quickstart</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="web-development"><a class="header" href="#web-development">Web Development</a></h1>
<p>Modern web development covering frontend, backend, APIs, and full-stack technologies.</p>
<h2 id="topics-covered-1"><a class="header" href="#topics-covered-1">Topics Covered</a></h2>
<h3 id="frontend-frameworks"><a class="header" href="#frontend-frameworks">Frontend Frameworks</a></h3>
<ul>
<li><strong><a href="web_development/react.html">React</a></strong>: Components, hooks, state management</li>
<li><strong><a href="web_development/nextjs.html">Next.js</a></strong>: Production-ready React framework with SSR, SSG, and API routes</li>
<li><strong><a href="web_development/vuejs.html">Vue.js</a></strong>: Progressive framework with Composition API</li>
<li><strong><a href="web_development/svelte.html">Svelte</a></strong>: Compiled framework with reactive programming</li>
<li><strong><a href="web_development/tailwind.html">Tailwind CSS</a></strong>: Utility-first CSS framework</li>
</ul>
<h3 id="backend-frameworks"><a class="header" href="#backend-frameworks">Backend Frameworks</a></h3>
<h4 id="nodejs-frameworks"><a class="header" href="#nodejs-frameworks">Node.js Frameworks</a></h4>
<ul>
<li><strong><a href="web_development/expressjs.html">Express.js</a></strong>: Minimal and flexible Node.js web framework</li>
<li><strong><a href="web_development/nestjs.html">NestJS</a></strong>: TypeScript-first progressive Node.js framework with dependency injection</li>
</ul>
<h4 id="python-frameworks"><a class="header" href="#python-frameworks">Python Frameworks</a></h4>
<ul>
<li><strong><a href="web_development/django.html">Django</a></strong>: High-level Python web framework for rapid development</li>
<li><strong><a href="web_development/flask.html">Flask</a></strong>: Lightweight and flexible Python microframework</li>
<li><strong><a href="web_development/fastapi.html">FastAPI</a></strong>: Modern, fast Python framework with automatic API documentation</li>
</ul>
<h3 id="browser-apis"><a class="header" href="#browser-apis">Browser APIs</a></h3>
<ul>
<li><strong><a href="web_development/web_apis.html">Web APIs</a></strong>: Browser APIs for storage, workers, notifications, and more
<ul>
<li>Storage: localStorage, sessionStorage, IndexedDB, Cache API</li>
<li>Workers: Web Workers, Service Workers, Shared Workers</li>
<li>Notifications: Notification API, Push API</li>
<li>Device APIs: Geolocation, Battery Status</li>
<li>File APIs: File, Blob, FileReader</li>
<li>Observers: Intersection, Mutation, Resize Observer</li>
<li>Other: Clipboard, History, Performance, Page Visibility</li>
</ul>
</li>
</ul>
<h3 id="api--communication"><a class="header" href="#api--communication">API &amp; Communication</a></h3>
<ul>
<li><strong><a href="web_development/rest_apis.html">REST APIs</a></strong>: RESTful API design and best practices</li>
<li><strong><a href="web_development/graphql.html">GraphQL</a></strong>: Query language, schema design</li>
<li><strong><a href="web_development/grpc.html">gRPC</a></strong>: High-performance RPC framework with Protocol Buffers</li>
</ul>
<h3 id="other-topics"><a class="header" href="#other-topics">Other Topics</a></h3>
<ul>
<li><strong>Frontend</strong>: HTML, CSS, JavaScript fundamentals</li>
<li><strong>Backend</strong>: Express.js, Node.js</li>
<li><strong>Authentication</strong>: JWT, OAuth, sessions</li>
<li><strong>Databases</strong>: Integration with web apps</li>
<li><strong>Deployment</strong>: Hosting, CI/CD for web</li>
</ul>
<h2 id="frontend-stack"><a class="header" href="#frontend-stack">Frontend Stack</a></h2>
<ul>
<li>HTML/CSS/JavaScript</li>
<li>React, Vue, or Angular</li>
<li>State management (Redux, Vuex)</li>
<li>Build tools (Webpack, Vite)</li>
</ul>
<h2 id="backend-stack"><a class="header" href="#backend-stack">Backend Stack</a></h2>
<ul>
<li>Node.js/Express or Python/Django</li>
<li>REST or GraphQL APIs</li>
<li>Database integration</li>
<li>Authentication &amp; authorization</li>
</ul>
<h2 id="full-stack"><a class="header" href="#full-stack">Full Stack</a></h2>
<p>Combining frontend and backend to build complete applications.</p>
<h2 id="navigation-1"><a class="header" href="#navigation-1">Navigation</a></h2>
<p>Explore each topic to build modern web applications.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="react"><a class="header" href="#react">React</a></h1>
<h2 id="overview-95"><a class="header" href="#overview-95">Overview</a></h2>
<p>React is a JavaScript library for building user interfaces with reusable components and efficient rendering.</p>
<h2 id="components-3"><a class="header" href="#components-3">Components</a></h2>
<h3 id="functional-components-modern"><a class="header" href="#functional-components-modern">Functional Components (Modern)</a></h3>
<pre><code class="language-javascript">function Welcome({ name }) {
  return &lt;h1&gt;Hello, {name}!&lt;/h1&gt;;
}

// Arrow function
const Greeting = ({ message }) =&gt; &lt;p&gt;{message}&lt;/p&gt;;
</code></pre>
<h3 id="class-components-legacy"><a class="header" href="#class-components-legacy">Class Components (Legacy)</a></h3>
<pre><code class="language-javascript">class Welcome extends React.Component {
  render() {
    return &lt;h1&gt;Hello, {this.props.name}!&lt;/h1&gt;;
  }
}
</code></pre>
<h2 id="hooks"><a class="header" href="#hooks">Hooks</a></h2>
<p>Modern way to manage state and effects:</p>
<pre><code class="language-javascript">import { useState, useEffect } from 'react';

function Counter() {
  const [count, setCount] = useState(0);

  useEffect(() =&gt; {
    console.log('Count changed:', count);
    // Cleanup
    return () =&gt; console.log('Cleanup');
  }, [count]); // Dependencies

  return (
    &lt;div&gt;
      &lt;p&gt;Count: {count}&lt;/p&gt;
      &lt;button onClick={() =&gt; setCount(count + 1)}&gt;Increment&lt;/button&gt;
    &lt;/div&gt;
  );
}
</code></pre>
<h2 id="common-hooks"><a class="header" href="#common-hooks">Common Hooks</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Hook</th><th>Purpose</th></tr></thead><tbody>
<tr><td><strong>useState</strong></td><td>Manage state</td></tr>
<tr><td><strong>useEffect</strong></td><td>Side effects</td></tr>
<tr><td><strong>useContext</strong></td><td>Access context</td></tr>
<tr><td><strong>useReducer</strong></td><td>Complex state logic</td></tr>
<tr><td><strong>useCallback</strong></td><td>Memoize function</td></tr>
<tr><td><strong>useMemo</strong></td><td>Memoize value</td></tr>
</tbody></table>
</div>
<h2 id="props"><a class="header" href="#props">Props</a></h2>
<pre><code class="language-javascript">// Parent
&lt;Child name="John" age={30} onClick={handleClick} /&gt;

// Child
function Child({ name, age, onClick }) {
  return (
    &lt;div onClick={onClick}&gt;
      {name} is {age}
    &lt;/div&gt;
  );
}
</code></pre>
<h2 id="conditional-rendering"><a class="header" href="#conditional-rendering">Conditional Rendering</a></h2>
<pre><code class="language-javascript">{isLoggedIn &amp;&amp; &lt;Dashboard /&gt;}
{user ? &lt;UserProfile /&gt; : &lt;LoginForm /&gt;}

{status === 'loading' &amp;&amp; &lt;Spinner /&gt;}
{status === 'error' &amp;&amp; &lt;Error /&gt;}
{status === 'success' &amp;&amp; &lt;Data /&gt;}
</code></pre>
<h2 id="lists-2"><a class="header" href="#lists-2">Lists</a></h2>
<pre><code class="language-javascript">const users = [
  { id: 1, name: 'John' },
  { id: 2, name: 'Jane' }
];

&lt;ul&gt;
  {users.map(user =&gt; (
    &lt;li key={user.id}&gt;{user.name}&lt;/li&gt;
  ))}
&lt;/ul&gt;
</code></pre>
<h2 id="event-handling"><a class="header" href="#event-handling">Event Handling</a></h2>
<pre><code class="language-javascript">function Button() {
  const handleClick = (e) =&gt; {
    console.log('Clicked');
  };

  const handleChange = (e) =&gt; {
    const value = e.target.value;
  };

  return (
    &lt;&gt;
      &lt;button onClick={handleClick}&gt;Click&lt;/button&gt;
      &lt;input onChange={handleChange} /&gt;
    &lt;/&gt;
  );
}
</code></pre>
<h2 id="forms"><a class="header" href="#forms">Forms</a></h2>
<pre><code class="language-javascript">function LoginForm() {
  const [email, setEmail] = useState('');
  const [password, setPassword] = useState('');

  const handleSubmit = (e) =&gt; {
    e.preventDefault();
    console.log(email, password);
  };

  return (
    &lt;form onSubmit={handleSubmit}&gt;
      &lt;input
        type="email"
        value={email}
        onChange={(e) =&gt; setEmail(e.target.value)}
      /&gt;
      &lt;input
        type="password"
        value={password}
        onChange={(e) =&gt; setPassword(e.target.value)}
      /&gt;
      &lt;button type="submit"&gt;Login&lt;/button&gt;
    &lt;/form&gt;
  );
}
</code></pre>
<h2 id="state-management"><a class="header" href="#state-management">State Management</a></h2>
<h3 id="local-state-usestate"><a class="header" href="#local-state-usestate">Local State (useState)</a></h3>
<pre><code class="language-javascript">const [state, setState] = useState(initialValue);
</code></pre>
<h3 id="context-api-global"><a class="header" href="#context-api-global">Context API (Global)</a></h3>
<pre><code class="language-javascript">const UserContext = createContext();

function App() {
  return (
    &lt;UserContext.Provider value={{ user: 'John' }}&gt;
      &lt;Child /&gt;
    &lt;/UserContext.Provider&gt;
  );
}

function Child() {
  const { user } = useContext(UserContext);
}
</code></pre>
<h3 id="redux-complex"><a class="header" href="#redux-complex">Redux (Complex)</a></h3>
<ul>
<li>Centralized store</li>
<li>Actions → Reducers → State</li>
</ul>
<h2 id="lifecycle-class-components"><a class="header" href="#lifecycle-class-components">Lifecycle (Class Components)</a></h2>
<pre><code class="language-javascript">componentDidMount() { } // After render
componentDidUpdate() { } // After update
componentWillUnmount() { } // Before remove
</code></pre>
<h2 id="best-practices-78"><a class="header" href="#best-practices-78">Best Practices</a></h2>
<ol>
<li><strong>Functional components</strong> (with hooks)</li>
<li><strong>Keep components small</strong></li>
<li><strong>Lift state up</strong> when needed</li>
<li><strong>Use keys</strong> in lists</li>
<li><strong>Memoize</strong> expensive computations</li>
<li><strong>Lazy load</strong> components</li>
</ol>
<h2 id="eli10-29"><a class="header" href="#eli10-29">ELI10</a></h2>
<p>React is like LEGO blocks:</p>
<ul>
<li>Build reusable pieces (components)</li>
<li>Combine to make complex UIs</li>
<li>Reuse same piece many times</li>
<li>Efficient updates when data changes!</li>
</ul>
<h2 id="further-resources-42"><a class="header" href="#further-resources-42">Further Resources</a></h2>
<ul>
<li><a href="https://react.dev/">React Documentation</a></li>
<li><a href="https://react.dev/reference/react">React Hooks</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="nextjs"><a class="header" href="#nextjs">Next.js</a></h1>
<p>Next.js is a production-ready React framework that provides server-side rendering, static site generation, API routes, and many other features out of the box. Built by Vercel, it's designed to give you the best developer experience with all the features needed for production.</p>
<h2 id="table-of-contents-46"><a class="header" href="#table-of-contents-46">Table of Contents</a></h2>
<ul>
<li><a href="web_development/nextjs.html#introduction">Introduction</a></li>
<li><a href="web_development/nextjs.html#installation-and-setup">Installation and Setup</a></li>
<li><a href="web_development/nextjs.html#file-based-routing">File-Based Routing</a></li>
<li><a href="web_development/nextjs.html#pages-and-layouts">Pages and Layouts</a></li>
<li><a href="web_development/nextjs.html#data-fetching">Data Fetching</a></li>
<li><a href="web_development/nextjs.html#api-routes">API Routes</a></li>
<li><a href="web_development/nextjs.html#dynamic-routes">Dynamic Routes</a></li>
<li><a href="web_development/nextjs.html#image-optimization">Image Optimization</a></li>
<li><a href="web_development/nextjs.html#css-and-styling">CSS and Styling</a></li>
<li><a href="web_development/nextjs.html#authentication">Authentication</a></li>
<li><a href="web_development/nextjs.html#deployment">Deployment</a></li>
<li><a href="web_development/nextjs.html#best-practices">Best Practices</a></li>
</ul>
<hr />
<h2 id="introduction-26"><a class="header" href="#introduction-26">Introduction</a></h2>
<p><strong>Key Features:</strong></p>
<ul>
<li>Server-Side Rendering (SSR)</li>
<li>Static Site Generation (SSG)</li>
<li>Incremental Static Regeneration (ISR)</li>
<li>API Routes</li>
<li>File-based routing</li>
<li>Automatic code splitting</li>
<li>Built-in image optimization</li>
<li>TypeScript support</li>
<li>Fast Refresh</li>
<li>Zero configuration</li>
</ul>
<p><strong>Use Cases:</strong></p>
<ul>
<li>E-commerce websites</li>
<li>Marketing websites</li>
<li>Blogs and content sites</li>
<li>Dashboards</li>
<li>SaaS applications</li>
<li>Mobile applications (with React Native)</li>
</ul>
<hr />
<h2 id="installation-and-setup-4"><a class="header" href="#installation-and-setup-4">Installation and Setup</a></h2>
<h3 id="create-new-project"><a class="header" href="#create-new-project">Create New Project</a></h3>
<pre><code class="language-bash"># Create Next.js app
npx create-next-app@latest my-next-app
cd my-next-app

# Or with TypeScript
npx create-next-app@latest my-next-app --typescript

# Start development server
npm run dev
</code></pre>
<h3 id="project-structure-4"><a class="header" href="#project-structure-4">Project Structure</a></h3>
<pre><code>my-next-app/
├── app/                    # App directory (Next.js 13+)
│   ├── layout.tsx         # Root layout
│   ├── page.tsx           # Home page
│   ├── api/               # API routes
│   └── [folder]/          # Routes
├── public/                # Static files
├── components/            # React components
├── lib/                   # Utility functions
├── styles/               # CSS files
├── next.config.js        # Next.js configuration
├── package.json
└── tsconfig.json         # TypeScript configuration
</code></pre>
<h3 id="configuration-4"><a class="header" href="#configuration-4">Configuration</a></h3>
<p><strong>next.config.js:</strong></p>
<pre><code class="language-javascript">/** @type {import('next').NextConfig} */
const nextConfig = {
  reactStrictMode: true,
  images: {
    domains: ['example.com', 'cdn.example.com'],
  },
  env: {
    CUSTOM_KEY: process.env.CUSTOM_KEY,
  },
  async rewrites() {
    return [
      {
        source: '/api/:path*',
        destination: 'https://api.example.com/:path*',
      },
    ]
  },
}

module.exports = nextConfig
</code></pre>
<hr />
<h2 id="file-based-routing"><a class="header" href="#file-based-routing">File-Based Routing</a></h2>
<h3 id="app-router-nextjs-13"><a class="header" href="#app-router-nextjs-13">App Router (Next.js 13+)</a></h3>
<pre><code>app/
├── page.tsx              # / route
├── about/
│   └── page.tsx         # /about route
├── blog/
│   ├── page.tsx         # /blog route
│   └── [slug]/
│       └── page.tsx     # /blog/[slug] route
└── dashboard/
    ├── layout.tsx       # Dashboard layout
    ├── page.tsx         # /dashboard route
    └── settings/
        └── page.tsx     # /dashboard/settings route
</code></pre>
<p><strong>app/page.tsx:</strong></p>
<pre><code class="language-typescript">import Link from 'next/link'

export default function Home() {
  return (
    &lt;main&gt;
      &lt;h1&gt;Welcome to Next.js&lt;/h1&gt;
      &lt;Link href="/about"&gt;About&lt;/Link&gt;
      &lt;Link href="/blog"&gt;Blog&lt;/Link&gt;
    &lt;/main&gt;
  )
}
</code></pre>
<p><strong>app/about/page.tsx:</strong></p>
<pre><code class="language-typescript">export default function About() {
  return (
    &lt;div&gt;
      &lt;h1&gt;About Us&lt;/h1&gt;
      &lt;p&gt;This is the about page&lt;/p&gt;
    &lt;/div&gt;
  )
}
</code></pre>
<hr />
<h2 id="pages-and-layouts"><a class="header" href="#pages-and-layouts">Pages and Layouts</a></h2>
<h3 id="root-layout"><a class="header" href="#root-layout">Root Layout</a></h3>
<p><strong>app/layout.tsx:</strong></p>
<pre><code class="language-typescript">import type { Metadata } from 'next'
import { Inter } from 'next/font/google'
import './globals.css'

const inter = Inter({ subsets: ['latin'] })

export const metadata: Metadata = {
  title: 'My Next.js App',
  description: 'Built with Next.js',
}

export default function RootLayout({
  children,
}: {
  children: React.ReactNode
}) {
  return (
    &lt;html lang="en"&gt;
      &lt;body className={inter.className}&gt;
        &lt;nav&gt;
          &lt;a href="/"&gt;Home&lt;/a&gt;
          &lt;a href="/about"&gt;About&lt;/a&gt;
          &lt;a href="/blog"&gt;Blog&lt;/a&gt;
        &lt;/nav&gt;
        {children}
        &lt;footer&gt;© 2024 My App&lt;/footer&gt;
      &lt;/body&gt;
    &lt;/html&gt;
  )
}
</code></pre>
<h3 id="nested-layouts"><a class="header" href="#nested-layouts">Nested Layouts</a></h3>
<p><strong>app/dashboard/layout.tsx:</strong></p>
<pre><code class="language-typescript">export default function DashboardLayout({
  children,
}: {
  children: React.ReactNode
}) {
  return (
    &lt;div className="dashboard"&gt;
      &lt;aside&gt;
        &lt;nav&gt;
          &lt;a href="/dashboard"&gt;Overview&lt;/a&gt;
          &lt;a href="/dashboard/settings"&gt;Settings&lt;/a&gt;
          &lt;a href="/dashboard/profile"&gt;Profile&lt;/a&gt;
        &lt;/nav&gt;
      &lt;/aside&gt;
      &lt;main&gt;{children}&lt;/main&gt;
    &lt;/div&gt;
  )
}
</code></pre>
<h3 id="loading-and-error-states"><a class="header" href="#loading-and-error-states">Loading and Error States</a></h3>
<p><strong>app/loading.tsx:</strong></p>
<pre><code class="language-typescript">export default function Loading() {
  return &lt;div&gt;Loading...&lt;/div&gt;
}
</code></pre>
<p><strong>app/error.tsx:</strong></p>
<pre><code class="language-typescript">'use client'

export default function Error({
  error,
  reset,
}: {
  error: Error &amp; { digest?: string }
  reset: () =&gt; void
}) {
  return (
    &lt;div&gt;
      &lt;h2&gt;Something went wrong!&lt;/h2&gt;
      &lt;p&gt;{error.message}&lt;/p&gt;
      &lt;button onClick={reset}&gt;Try again&lt;/button&gt;
    &lt;/div&gt;
  )
}
</code></pre>
<hr />
<h2 id="data-fetching"><a class="header" href="#data-fetching">Data Fetching</a></h2>
<h3 id="server-components-default"><a class="header" href="#server-components-default">Server Components (Default)</a></h3>
<pre><code class="language-typescript">async function getData() {
  const res = await fetch('https://api.example.com/data', {
    cache: 'no-store', // or 'force-cache'
  })

  if (!res.ok) {
    throw new Error('Failed to fetch data')
  }

  return res.json()
}

export default async function Page() {
  const data = await getData()

  return (
    &lt;div&gt;
      &lt;h1&gt;Data from API&lt;/h1&gt;
      &lt;pre&gt;{JSON.stringify(data, null, 2)}&lt;/pre&gt;
    &lt;/div&gt;
  )
}
</code></pre>
<h3 id="static-generation"><a class="header" href="#static-generation">Static Generation</a></h3>
<pre><code class="language-typescript">async function getStaticData() {
  const res = await fetch('https://api.example.com/posts')
  return res.json()
}

export default async function BlogPage() {
  const posts = await getStaticData()

  return (
    &lt;div&gt;
      {posts.map((post: any) =&gt; (
        &lt;article key={post.id}&gt;
          &lt;h2&gt;{post.title}&lt;/h2&gt;
          &lt;p&gt;{post.excerpt}&lt;/p&gt;
        &lt;/article&gt;
      ))}
    &lt;/div&gt;
  )
}

// Revalidate every hour
export const revalidate = 3600
</code></pre>
<h3 id="dynamic-data-with-params"><a class="header" href="#dynamic-data-with-params">Dynamic Data with Params</a></h3>
<pre><code class="language-typescript">async function getPost(slug: string) {
  const res = await fetch(`https://api.example.com/posts/${slug}`)
  return res.json()
}

export default async function Post({ params }: { params: { slug: string } }) {
  const post = await getPost(params.slug)

  return (
    &lt;article&gt;
      &lt;h1&gt;{post.title}&lt;/h1&gt;
      &lt;div dangerouslySetInnerHTML={{ __html: post.content }} /&gt;
    &lt;/article&gt;
  )
}

// Generate static params for dynamic routes
export async function generateStaticParams() {
  const posts = await fetch('https://api.example.com/posts').then((res) =&gt;
    res.json()
  )

  return posts.map((post: any) =&gt; ({
    slug: post.slug,
  }))
}
</code></pre>
<h3 id="client-components"><a class="header" href="#client-components">Client Components</a></h3>
<pre><code class="language-typescript">'use client'

import { useState, useEffect } from 'react'

export default function ClientComponent() {
  const [data, setData] = useState(null)
  const [loading, setLoading] = useState(true)

  useEffect(() =&gt; {
    fetch('/api/data')
      .then((res) =&gt; res.json())
      .then((data) =&gt; {
        setData(data)
        setLoading(false)
      })
  }, [])

  if (loading) return &lt;div&gt;Loading...&lt;/div&gt;

  return &lt;div&gt;{JSON.stringify(data)}&lt;/div&gt;
}
</code></pre>
<hr />
<h2 id="api-routes"><a class="header" href="#api-routes">API Routes</a></h2>
<h3 id="basic-api-route"><a class="header" href="#basic-api-route">Basic API Route</a></h3>
<p><strong>app/api/hello/route.ts:</strong></p>
<pre><code class="language-typescript">import { NextResponse } from 'next/server'

export async function GET() {
  return NextResponse.json({ message: 'Hello from Next.js!' })
}

export async function POST(request: Request) {
  const body = await request.json()
  return NextResponse.json({ received: body })
}
</code></pre>
<h3 id="dynamic-api-routes"><a class="header" href="#dynamic-api-routes">Dynamic API Routes</a></h3>
<p><strong>app/api/users/[id]/route.ts:</strong></p>
<pre><code class="language-typescript">import { NextResponse } from 'next/server'

export async function GET(
  request: Request,
  { params }: { params: { id: string } }
) {
  const id = params.id

  // Fetch user from database
  const user = await fetchUser(id)

  if (!user) {
    return NextResponse.json({ error: 'User not found' }, { status: 404 })
  }

  return NextResponse.json(user)
}

export async function PUT(
  request: Request,
  { params }: { params: { id: string } }
) {
  const id = params.id
  const body = await request.json()

  // Update user in database
  const updatedUser = await updateUser(id, body)

  return NextResponse.json(updatedUser)
}

export async function DELETE(
  request: Request,
  { params }: { params: { id: string } }
) {
  const id = params.id

  await deleteUser(id)

  return NextResponse.json({ message: 'User deleted' })
}
</code></pre>
<h3 id="api-with-database"><a class="header" href="#api-with-database">API with Database</a></h3>
<pre><code class="language-typescript">import { NextResponse } from 'next/server'
import { prisma } from '@/lib/prisma'

export async function GET() {
  try {
    const users = await prisma.user.findMany()
    return NextResponse.json(users)
  } catch (error) {
    return NextResponse.json(
      { error: 'Failed to fetch users' },
      { status: 500 }
    )
  }
}

export async function POST(request: Request) {
  try {
    const body = await request.json()
    const user = await prisma.user.create({
      data: body,
    })
    return NextResponse.json(user, { status: 201 })
  } catch (error) {
    return NextResponse.json(
      { error: 'Failed to create user' },
      { status: 500 }
    )
  }
}
</code></pre>
<hr />
<h2 id="dynamic-routes"><a class="header" href="#dynamic-routes">Dynamic Routes</a></h2>
<h3 id="catch-all-routes"><a class="header" href="#catch-all-routes">Catch-All Routes</a></h3>
<p><strong>app/shop/[...slug]/page.tsx:</strong></p>
<pre><code class="language-typescript">export default function ShopPage({ params }: { params: { slug: string[] } }) {
  return (
    &lt;div&gt;
      &lt;h1&gt;Shop&lt;/h1&gt;
      &lt;p&gt;Category: {params.slug.join('/')}&lt;/p&gt;
    &lt;/div&gt;
  )
}

// Matches:
// /shop/electronics
// /shop/electronics/laptops
// /shop/electronics/laptops/gaming
</code></pre>
<h3 id="optional-catch-all-routes"><a class="header" href="#optional-catch-all-routes">Optional Catch-All Routes</a></h3>
<p><strong>app/docs/[[...slug]]/page.tsx:</strong></p>
<pre><code class="language-typescript">export default function DocsPage({
  params,
}: {
  params: { slug?: string[] }
}) {
  if (!params.slug) {
    return &lt;div&gt;Documentation Home&lt;/div&gt;
  }

  return &lt;div&gt;Path: {params.slug.join('/')}&lt;/div&gt;
}

// Matches:
// /docs
// /docs/getting-started
// /docs/api/reference
</code></pre>
<hr />
<h2 id="image-optimization"><a class="header" href="#image-optimization">Image Optimization</a></h2>
<pre><code class="language-typescript">import Image from 'next/image'

export default function ImageExample() {
  return (
    &lt;div&gt;
      {/* Static Image */}
      &lt;Image
        src="/hero.jpg"
        alt="Hero"
        width={1200}
        height={600}
        priority
      /&gt;

      {/* External Image */}
      &lt;Image
        src="https://example.com/image.jpg"
        alt="External"
        width={800}
        height={600}
        quality={85}
      /&gt;

      {/* Responsive Image */}
      &lt;Image
        src="/profile.jpg"
        alt="Profile"
        fill
        sizes="(max-width: 768px) 100vw, 50vw"
        style={{ objectFit: 'cover' }}
      /&gt;

      {/* With Placeholder */}
      &lt;Image
        src="/photo.jpg"
        alt="Photo"
        width={600}
        height={400}
        placeholder="blur"
        blurDataURL="data:image/jpeg;base64,..."
      /&gt;
    &lt;/div&gt;
  )
}
</code></pre>
<hr />
<h2 id="css-and-styling"><a class="header" href="#css-and-styling">CSS and Styling</a></h2>
<h3 id="css-modules"><a class="header" href="#css-modules">CSS Modules</a></h3>
<p><strong>components/Button.module.css:</strong></p>
<pre><code class="language-css">.button {
  padding: 12px 24px;
  background: blue;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

.button:hover {
  background: darkblue;
}
</code></pre>
<p><strong>components/Button.tsx:</strong></p>
<pre><code class="language-typescript">import styles from './Button.module.css'

export default function Button({ children }: { children: React.ReactNode }) {
  return &lt;button className={styles.button}&gt;{children}&lt;/button&gt;
}
</code></pre>
<h3 id="tailwind-css"><a class="header" href="#tailwind-css">Tailwind CSS</a></h3>
<pre><code class="language-bash">npm install -D tailwindcss postcss autoprefixer
npx tailwindcss init -p
</code></pre>
<p><strong>tailwind.config.js:</strong></p>
<pre><code class="language-javascript">module.exports = {
  content: [
    './app/**/*.{js,ts,jsx,tsx,mdx}',
    './components/**/*.{js,ts,jsx,tsx,mdx}',
  ],
  theme: {
    extend: {},
  },
  plugins: [],
}
</code></pre>
<p><strong>app/globals.css:</strong></p>
<pre><code class="language-css">@tailwind base;
@tailwind components;
@tailwind utilities;
</code></pre>
<p><strong>Usage:</strong></p>
<pre><code class="language-typescript">export default function Home() {
  return (
    &lt;div className="min-h-screen bg-gray-100"&gt;
      &lt;h1 className="text-4xl font-bold text-blue-600"&gt;
        Hello Tailwind!
      &lt;/h1&gt;
      &lt;button className="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600"&gt;
        Click Me
      &lt;/button&gt;
    &lt;/div&gt;
  )
}
</code></pre>
<hr />
<h2 id="authentication-4"><a class="header" href="#authentication-4">Authentication</a></h2>
<h3 id="nextauthjs"><a class="header" href="#nextauthjs">NextAuth.js</a></h3>
<pre><code class="language-bash">npm install next-auth
</code></pre>
<p><strong>app/api/auth/[...nextauth]/route.ts:</strong></p>
<pre><code class="language-typescript">import NextAuth from 'next-auth'
import GoogleProvider from 'next-auth/providers/google'
import CredentialsProvider from 'next-auth/providers/credentials'

const handler = NextAuth({
  providers: [
    GoogleProvider({
      clientId: process.env.GOOGLE_CLIENT_ID!,
      clientSecret: process.env.GOOGLE_CLIENT_SECRET!,
    }),
    CredentialsProvider({
      name: 'Credentials',
      credentials: {
        email: { label: "Email", type: "email" },
        password: { label: "Password", type: "password" }
      },
      async authorize(credentials) {
        // Verify credentials
        const user = await verifyUser(credentials)

        if (user) {
          return user
        }
        return null
      }
    })
  ],
  pages: {
    signIn: '/auth/signin',
  },
  callbacks: {
    async jwt({ token, user }) {
      if (user) {
        token.id = user.id
      }
      return token
    },
    async session({ session, token }) {
      if (session.user) {
        session.user.id = token.id as string
      }
      return session
    },
  },
})

export { handler as GET, handler as POST }
</code></pre>
<p><strong>app/providers.tsx:</strong></p>
<pre><code class="language-typescript">'use client'

import { SessionProvider } from 'next-auth/react'

export function Providers({ children }: { children: React.ReactNode }) {
  return &lt;SessionProvider&gt;{children}&lt;/SessionProvider&gt;
}
</code></pre>
<p><strong>Protected Route:</strong></p>
<pre><code class="language-typescript">import { getServerSession } from 'next-auth'
import { redirect } from 'next/navigation'

export default async function DashboardPage() {
  const session = await getServerSession()

  if (!session) {
    redirect('/auth/signin')
  }

  return (
    &lt;div&gt;
      &lt;h1&gt;Dashboard&lt;/h1&gt;
      &lt;p&gt;Welcome, {session.user?.name}&lt;/p&gt;
    &lt;/div&gt;
  )
}
</code></pre>
<p><strong>Client-Side Auth:</strong></p>
<pre><code class="language-typescript">'use client'

import { useSession, signIn, signOut } from 'next-auth/react'

export default function LoginButton() {
  const { data: session, status } = useSession()

  if (status === 'loading') {
    return &lt;div&gt;Loading...&lt;/div&gt;
  }

  if (session) {
    return (
      &lt;&gt;
        &lt;p&gt;Signed in as {session.user?.email}&lt;/p&gt;
        &lt;button onClick={() =&gt; signOut()}&gt;Sign out&lt;/button&gt;
      &lt;/&gt;
    )
  }

  return &lt;button onClick={() =&gt; signIn()}&gt;Sign in&lt;/button&gt;
}
</code></pre>
<hr />
<h2 id="deployment-2"><a class="header" href="#deployment-2">Deployment</a></h2>
<h3 id="vercel-recommended"><a class="header" href="#vercel-recommended">Vercel (Recommended)</a></h3>
<pre><code class="language-bash"># Install Vercel CLI
npm i -g vercel

# Deploy
vercel

# Production deployment
vercel --prod
</code></pre>
<h3 id="docker-2"><a class="header" href="#docker-2">Docker</a></h3>
<p><strong>Dockerfile:</strong></p>
<pre><code class="language-dockerfile">FROM node:18-alpine AS base

FROM base AS deps
WORKDIR /app
COPY package.json package-lock.json ./
RUN npm ci

FROM base AS builder
WORKDIR /app
COPY --from=deps /app/node_modules ./node_modules
COPY . .
RUN npm run build

FROM base AS runner
WORKDIR /app
ENV NODE_ENV production

COPY --from=builder /app/public ./public
COPY --from=builder /app/.next/standalone ./
COPY --from=builder /app/.next/static ./.next/static

EXPOSE 3000
CMD ["node", "server.js"]
</code></pre>
<p><strong>next.config.js:</strong></p>
<pre><code class="language-javascript">module.exports = {
  output: 'standalone',
}
</code></pre>
<h3 id="environment-variables-1"><a class="header" href="#environment-variables-1">Environment Variables</a></h3>
<p><strong>.env.local:</strong></p>
<pre><code class="language-bash">DATABASE_URL="postgresql://..."
NEXTAUTH_SECRET="your-secret"
NEXTAUTH_URL="http://localhost:3000"
GOOGLE_CLIENT_ID="..."
GOOGLE_CLIENT_SECRET="..."
</code></pre>
<hr />
<h2 id="best-practices-79"><a class="header" href="#best-practices-79">Best Practices</a></h2>
<h3 id="1-server-vs-client-components"><a class="header" href="#1-server-vs-client-components">1. Server vs Client Components</a></h3>
<pre><code class="language-typescript">// Server Component (default) - Use for:
// - Data fetching
// - Direct database access
// - API calls
export default async function ServerComponent() {
  const data = await fetchData()
  return &lt;div&gt;{data}&lt;/div&gt;
}

// Client Component - Use for:
// - Interactivity (onClick, onChange, etc.)
// - State management
// - Browser APIs
'use client'
export default function ClientComponent() {
  const [count, setCount] = useState(0)
  return &lt;button onClick={() =&gt; setCount(count + 1)}&gt;{count}&lt;/button&gt;
}
</code></pre>
<h3 id="2-data-fetching-strategies"><a class="header" href="#2-data-fetching-strategies">2. Data Fetching Strategies</a></h3>
<pre><code class="language-typescript">// Static - Fetch at build time
export const revalidate = false

// ISR - Revalidate every 60 seconds
export const revalidate = 60

// Dynamic - Fetch on every request
export const dynamic = 'force-dynamic'

// Cache specific requests
fetch('https://api.example.com/data', {
  next: { revalidate: 3600 } // Revalidate every hour
})
</code></pre>
<h3 id="3-metadata"><a class="header" href="#3-metadata">3. Metadata</a></h3>
<pre><code class="language-typescript">import type { Metadata } from 'next'

export const metadata: Metadata = {
  title: 'My Page',
  description: 'Page description',
  openGraph: {
    title: 'My Page',
    description: 'Page description',
    images: ['/og-image.jpg'],
  },
  twitter: {
    card: 'summary_large_image',
  },
}
</code></pre>
<h3 id="4-error-boundaries"><a class="header" href="#4-error-boundaries">4. Error Boundaries</a></h3>
<pre><code class="language-typescript">// app/error.tsx
'use client'

export default function Error({
  error,
  reset,
}: {
  error: Error
  reset: () =&gt; void
}) {
  useEffect(() =&gt; {
    console.error(error)
  }, [error])

  return (
    &lt;div&gt;
      &lt;h2&gt;Something went wrong!&lt;/h2&gt;
      &lt;button onClick={reset}&gt;Try again&lt;/button&gt;
    &lt;/div&gt;
  )
}
</code></pre>
<h3 id="5-performance-optimization"><a class="header" href="#5-performance-optimization">5. Performance Optimization</a></h3>
<pre><code class="language-typescript">// Dynamic imports
import dynamic from 'next/dynamic'

const DynamicComponent = dynamic(() =&gt; import('@/components/Heavy'), {
  loading: () =&gt; &lt;p&gt;Loading...&lt;/p&gt;,
  ssr: false, // Disable SSR for this component
})

// Lazy load images
&lt;Image
  src="/photo.jpg"
  alt="Photo"
  loading="lazy"
  width={600}
  height={400}
/&gt;
</code></pre>
<hr />
<h2 id="resources-40"><a class="header" href="#resources-40">Resources</a></h2>
<p><strong>Official Documentation:</strong></p>
<ul>
<li><a href="https://nextjs.org/docs">Next.js Documentation</a></li>
<li><a href="https://nextjs.org/learn">Next.js Learn Course</a></li>
<li><a href="https://github.com/vercel/next.js/tree/canary/examples">Next.js Examples</a></li>
</ul>
<p><strong>Tools and Ecosystem:</strong></p>
<ul>
<li><a href="https://next-auth.js.org/">Next Auth</a></li>
<li><a href="https://www.prisma.io/">Prisma</a></li>
<li><a href="https://tailwindcss.com/">TailwindCSS</a></li>
<li><a href="https://vercel.com/">Vercel</a></li>
</ul>
<p><strong>Community:</strong></p>
<ul>
<li><a href="https://github.com/vercel/next.js">Next.js GitHub</a></li>
<li><a href="https://nextjs.org/discord">Next.js Discord</a></li>
<li><a href="https://stackoverflow.com/questions/tagged/next.js">Stack Overflow</a></li>
</ul>
<p><strong>Learning Resources:</strong></p>
<ul>
<li><a href="https://nextjs.org/conf">Next.js Conf</a></li>
<li><a href="https://vercel.com/guides">Vercel Guide</a></li>
<li><a href="https://github.com/unicodeveloper/awesome-nextjs">Awesome Next.js</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="vuejs"><a class="header" href="#vuejs">Vue.js</a></h1>
<p>Vue.js is a progressive JavaScript framework for building user interfaces. It's designed to be incrementally adoptable and focuses on the view layer.</p>
<h2 id="installation-21"><a class="header" href="#installation-21">Installation</a></h2>
<pre><code class="language-bash"># Create Vue 3 project
npm create vue@latest my-app
cd my-app
npm install
npm run dev

# Or via CDN
&lt;script src="https://unpkg.com/vue@3"&gt;&lt;/script&gt;
</code></pre>
<h2 id="component-basics"><a class="header" href="#component-basics">Component Basics</a></h2>
<pre><code class="language-vue">&lt;!-- HelloWorld.vue --&gt;
&lt;template&gt;
  &lt;div&gt;
    &lt;h1&gt;{{ message }}&lt;/h1&gt;
    &lt;button @click="increment"&gt;Count: {{ count }}&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import { ref } from 'vue'

const message = ref('Hello Vue!')
const count = ref(0)

function increment() {
  count.value++
}
&lt;/script&gt;

&lt;style scoped&gt;
h1 {
  color: #42b983;
}
&lt;/style&gt;
</code></pre>
<h2 id="reactivity"><a class="header" href="#reactivity">Reactivity</a></h2>
<pre><code class="language-vue">&lt;script setup&gt;
import { ref, reactive, computed, watch } from 'vue'

// Refs
const count = ref(0)

// Reactive objects
const state = reactive({
  name: 'John',
  age: 30
})

// Computed properties
const doubled = computed(() =&gt; count.value * 2)

// Watchers
watch(count, (newVal, oldVal) =&gt; {
  console.log(`Count changed from ${oldVal} to ${newVal}`)
})
&lt;/script&gt;
</code></pre>
<h2 id="props-and-emits"><a class="header" href="#props-and-emits">Props and Emits</a></h2>
<pre><code class="language-vue">&lt;!-- Child.vue --&gt;
&lt;script setup&gt;
const props = defineProps({
  title: String,
  count: {
    type: Number,
    default: 0
  }
})

const emit = defineEmits(['update', 'delete'])

function handleClick() {
  emit('update', { id: 1, value: 'new' })
}
&lt;/script&gt;

&lt;template&gt;
  &lt;h2&gt;{{ title }}&lt;/h2&gt;
  &lt;button @click="handleClick"&gt;Update&lt;/button&gt;
&lt;/template&gt;

&lt;!-- Parent.vue --&gt;
&lt;Child
  title="My Component"
  :count="10"
  @update="handleUpdate"
/&gt;
</code></pre>
<h2 id="directives"><a class="header" href="#directives">Directives</a></h2>
<pre><code class="language-vue">&lt;template&gt;
  &lt;!-- Conditional rendering --&gt;
  &lt;div v-if="show"&gt;Visible&lt;/div&gt;
  &lt;div v-else&gt;Hidden&lt;/div&gt;

  &lt;!-- List rendering --&gt;
  &lt;ul&gt;
    &lt;li v-for="item in items" :key="item.id"&gt;
      {{ item.name }}
    &lt;/li&gt;
  &lt;/ul&gt;

  &lt;!-- Two-way binding --&gt;
  &lt;input v-model="text" /&gt;

  &lt;!-- Event handling --&gt;
  &lt;button @click="handleClick"&gt;Click me&lt;/button&gt;

  &lt;!-- Dynamic attributes --&gt;
  &lt;img :src="imageUrl" :alt="description" /&gt;
&lt;/template&gt;
</code></pre>
<h2 id="lifecycle-hooks"><a class="header" href="#lifecycle-hooks">Lifecycle Hooks</a></h2>
<pre><code class="language-vue">&lt;script setup&gt;
import { onMounted, onUpdated, onUnmounted } from 'vue'

onMounted(() =&gt; {
  console.log('Component mounted')
})

onUpdated(() =&gt; {
  console.log('Component updated')
})

onUnmounted(() =&gt; {
  console.log('Component unmounted')
})
&lt;/script&gt;
</code></pre>
<h2 id="quick-reference-18"><a class="header" href="#quick-reference-18">Quick Reference</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Feature</th><th>Syntax</th></tr></thead><tbody>
<tr><td>Data binding</td><td><code>{{ variable }}</code></td></tr>
<tr><td>Attribute binding</td><td><code>:attribute="value"</code></td></tr>
<tr><td>Event handling</td><td><code>@event="handler"</code></td></tr>
<tr><td>Two-way binding</td><td><code>v-model="variable"</code></td></tr>
<tr><td>Conditional</td><td><code>v-if</code>, <code>v-else-if</code>, <code>v-else</code></td></tr>
<tr><td>Loop</td><td><code>v-for="item in items"</code></td></tr>
</tbody></table>
</div>
<p>Vue.js provides an approachable, versatile, and performant framework for building modern web interfaces.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="svelte"><a class="header" href="#svelte">Svelte</a></h1>
<p>Svelte is a radical new approach to building user interfaces. Unlike frameworks that do the bulk of their work in the browser, Svelte shifts that work into a compile step.</p>
<h2 id="installation-22"><a class="header" href="#installation-22">Installation</a></h2>
<pre><code class="language-bash"># Create new Svelte project
npm create vite@latest my-app -- --template svelte
cd my-app
npm install
npm run dev
</code></pre>
<h2 id="component-basics-1"><a class="header" href="#component-basics-1">Component Basics</a></h2>
<pre><code class="language-svelte">&lt;!-- App.svelte --&gt;
&lt;script&gt;
  let count = 0;

  function increment() {
    count += 1;
  }
&lt;/script&gt;

&lt;button on:click={increment}&gt;
  Clicked {count} {count === 1 ? 'time' : 'times'}
&lt;/button&gt;

&lt;style&gt;
  button {
    background: #ff3e00;
    color: white;
    padding: 10px 20px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
  }
&lt;/style&gt;
</code></pre>
<h2 id="reactivity-1"><a class="header" href="#reactivity-1">Reactivity</a></h2>
<pre><code class="language-svelte">&lt;script&gt;
  let count = 0;

  // Reactive declaration
  $: doubled = count * 2;

  // Reactive statement
  $: if (count &gt;= 10) {
    alert('count is high!');
  }

  // Reactive block
  $: {
    console.log(`count is ${count}`);
  }
&lt;/script&gt;
</code></pre>
<h2 id="props-1"><a class="header" href="#props-1">Props</a></h2>
<pre><code class="language-svelte">&lt;!-- Child.svelte --&gt;
&lt;script&gt;
  export let name;
  export let age = 25; // default value
&lt;/script&gt;

&lt;p&gt;{name} is {age} years old&lt;/p&gt;

&lt;!-- Parent.svelte --&gt;
&lt;script&gt;
  import Child from './Child.svelte';
&lt;/script&gt;

&lt;Child name="John" age={30} /&gt;
</code></pre>
<h2 id="events"><a class="header" href="#events">Events</a></h2>
<pre><code class="language-svelte">&lt;script&gt;
  import { createEventDispatcher } from 'svelte';

  const dispatch = createEventDispatcher();

  function handleClick() {
    dispatch('message', { text: 'Hello!' });
  }
&lt;/script&gt;

&lt;button on:click={handleClick}&gt;
  Send message
&lt;/button&gt;

&lt;!-- Parent --&gt;
&lt;Child on:message={e =&gt; console.log(e.detail.text)} /&gt;
</code></pre>
<h2 id="stores"><a class="header" href="#stores">Stores</a></h2>
<pre><code class="language-javascript">// store.js
import { writable } from 'svelte/store';

export const count = writable(0);
</code></pre>
<pre><code class="language-svelte">&lt;script&gt;
  import { count } from './store.js';
&lt;/script&gt;

&lt;button on:click={() =&gt; $count += 1}&gt;
  Count: {$count}
&lt;/button&gt;
</code></pre>
<h2 id="quick-reference-19"><a class="header" href="#quick-reference-19">Quick Reference</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Feature</th><th>Syntax</th></tr></thead><tbody>
<tr><td>Reactive variable</td><td><code>$: value = ...</code></td></tr>
<tr><td>Event handler</td><td><code>on:click={handler}</code></td></tr>
<tr><td>Two-way binding</td><td><code>bind:value={variable}</code></td></tr>
<tr><td>Conditional</td><td><code>{#if condition}...{/if}</code></td></tr>
<tr><td>Loop</td><td><code>{#each items as item}...{/each}</code></td></tr>
<tr><td>Await</td><td><code>{#await promise}...{/await}</code></td></tr>
</tbody></table>
</div>
<p>Svelte compiles components to highly efficient imperative code, resulting in small bundle sizes and excellent performance.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="tailwind-css-1"><a class="header" href="#tailwind-css-1">Tailwind CSS</a></h1>
<p>Tailwind CSS is a utility-first CSS framework for rapidly building custom user interfaces. Instead of opinionated predesigned components, Tailwind provides low-level utility classes.</p>
<h2 id="installation-23"><a class="header" href="#installation-23">Installation</a></h2>
<pre><code class="language-bash"># Via npm
npm install -D tailwindcss
npx tailwindcss init

# Via CDN (development only)
&lt;script src="https://cdn.tailwindcss.com"&gt;&lt;/script&gt;
</code></pre>
<h2 id="configuration-5"><a class="header" href="#configuration-5">Configuration</a></h2>
<pre><code class="language-javascript">// tailwind.config.js
module.exports = {
  content: ["./src/**/*.{html,js,jsx,ts,tsx}"],
  theme: {
    extend: {
      colors: {
        primary: '#3490dc',
        secondary: '#ffed4e',
      },
    },
  },
  plugins: [],
}
</code></pre>
<h2 id="basic-usage-12"><a class="header" href="#basic-usage-12">Basic Usage</a></h2>
<pre><code class="language-html">&lt;!-- Flexbox layout --&gt;
&lt;div class="flex items-center justify-between p-4"&gt;
  &lt;h1 class="text-2xl font-bold text-gray-900"&gt;Title&lt;/h1&gt;
  &lt;button class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600"&gt;
    Button
  &lt;/button&gt;
&lt;/div&gt;

&lt;!-- Grid layout --&gt;
&lt;div class="grid grid-cols-3 gap-4"&gt;
  &lt;div class="bg-gray-200 p-4"&gt;Item 1&lt;/div&gt;
  &lt;div class="bg-gray-200 p-4"&gt;Item 2&lt;/div&gt;
  &lt;div class="bg-gray-200 p-4"&gt;Item 3&lt;/div&gt;
&lt;/div&gt;

&lt;!-- Responsive design --&gt;
&lt;div class="w-full md:w-1/2 lg:w-1/3 xl:w-1/4"&gt;
  Responsive width
&lt;/div&gt;
</code></pre>
<h2 id="common-classes"><a class="header" href="#common-classes">Common Classes</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Category</th><th>Classes</th></tr></thead><tbody>
<tr><td>Layout</td><td><code>container</code>, <code>mx-auto</code>, <code>flex</code>, <code>grid</code></td></tr>
<tr><td>Spacing</td><td><code>p-4</code>, <code>m-2</code>, <code>px-6</code>, <code>py-3</code></td></tr>
<tr><td>Typography</td><td><code>text-xl</code>, <code>font-bold</code>, <code>text-center</code></td></tr>
<tr><td>Colors</td><td><code>bg-blue-500</code>, <code>text-white</code></td></tr>
<tr><td>Borders</td><td><code>border</code>, <code>rounded</code>, <code>border-gray-300</code></td></tr>
</tbody></table>
</div>
<p>Tailwind promotes rapid UI development with utility classes and responsive design built-in.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="expressjs"><a class="header" href="#expressjs">Express.js</a></h1>
<p>Express.js is a minimal and flexible Node.js web application framework that provides a robust set of features for building web and mobile applications. It's the de facto standard server framework for Node.js and is widely used for building RESTful APIs and web applications.</p>
<h2 id="table-of-contents-47"><a class="header" href="#table-of-contents-47">Table of Contents</a></h2>
<ul>
<li><a href="web_development/expressjs.html#introduction">Introduction</a></li>
<li><a href="web_development/expressjs.html#installation-and-setup">Installation and Setup</a></li>
<li><a href="web_development/expressjs.html#basic-application">Basic Application</a></li>
<li><a href="web_development/expressjs.html#routing">Routing</a></li>
<li><a href="web_development/expressjs.html#middleware">Middleware</a></li>
<li><a href="web_development/expressjs.html#request-and-response">Request and Response</a></li>
<li><a href="web_development/expressjs.html#error-handling">Error Handling</a></li>
<li><a href="web_development/expressjs.html#template-engines">Template Engines</a></li>
<li><a href="web_development/expressjs.html#static-files">Static Files</a></li>
<li><a href="web_development/expressjs.html#database-integration">Database Integration</a></li>
<li><a href="web_development/expressjs.html#authentication">Authentication</a></li>
<li><a href="web_development/expressjs.html#restful-api">RESTful API</a></li>
<li><a href="web_development/expressjs.html#file-uploads">File Uploads</a></li>
<li><a href="web_development/expressjs.html#security-best-practices">Security Best Practices</a></li>
<li><a href="web_development/expressjs.html#testing">Testing</a></li>
<li><a href="web_development/expressjs.html#production-deployment">Production Deployment</a></li>
</ul>
<hr />
<h2 id="introduction-27"><a class="header" href="#introduction-27">Introduction</a></h2>
<p><strong>Key Features:</strong></p>
<ul>
<li>Minimal and unopinionated framework</li>
<li>Robust routing system</li>
<li>Focus on high performance</li>
<li>Super-high test coverage</li>
<li>HTTP helpers (redirection, caching, etc.)</li>
<li>View system with 14+ template engines</li>
<li>Content negotiation</li>
<li>Executable for generating applications quickly</li>
</ul>
<p><strong>Use Cases:</strong></p>
<ul>
<li>RESTful APIs</li>
<li>Web applications</li>
<li>Microservices</li>
<li>Real-time applications (with Socket.io)</li>
<li>Server-side rendering</li>
<li>Proxy servers</li>
</ul>
<hr />
<h2 id="installation-and-setup-5"><a class="header" href="#installation-and-setup-5">Installation and Setup</a></h2>
<h3 id="create-new-project-1"><a class="header" href="#create-new-project-1">Create New Project</a></h3>
<pre><code class="language-bash"># Create project directory
mkdir my-express-app
cd my-express-app

# Initialize npm project
npm init -y

# Install Express
npm install express

# Install development dependencies
npm install --save-dev nodemon typescript @types/node @types/express
</code></pre>
<h3 id="typescript-setup"><a class="header" href="#typescript-setup">TypeScript Setup</a></h3>
<pre><code class="language-bash"># Initialize TypeScript
npx tsc --init
</code></pre>
<p><strong>tsconfig.json:</strong></p>
<pre><code class="language-json">{
  "compilerOptions": {
    "target": "ES2020",
    "module": "commonjs",
    "lib": ["ES2020"],
    "outDir": "./dist",
    "rootDir": "./src",
    "strict": true,
    "esModuleInterop": true,
    "skipLibCheck": true,
    "forceConsistentCasingInFileNames": true,
    "resolveJsonModule": true
  },
  "include": ["src/**/*"],
  "exclude": ["node_modules"]
}
</code></pre>
<p><strong>package.json scripts:</strong></p>
<pre><code class="language-json">{
  "scripts": {
    "build": "tsc",
    "start": "node dist/index.js",
    "dev": "nodemon --exec ts-node src/index.ts",
    "watch": "tsc --watch"
  }
}
</code></pre>
<hr />
<h2 id="basic-application"><a class="header" href="#basic-application">Basic Application</a></h2>
<h3 id="minimal-express-app"><a class="header" href="#minimal-express-app">Minimal Express App</a></h3>
<pre><code class="language-javascript">const express = require('express');
const app = express();
const PORT = 3000;

app.get('/', (req, res) =&gt; {
  res.send('Hello World!');
});

app.listen(PORT, () =&gt; {
  console.log(`Server running on http://localhost:${PORT}`);
});
</code></pre>
<h3 id="typescript-version"><a class="header" href="#typescript-version">TypeScript Version</a></h3>
<pre><code class="language-typescript">import express, { Express, Request, Response } from 'express';

const app: Express = express();
const PORT = process.env.PORT || 3000;

app.get('/', (req: Request, res: Response) =&gt; {
  res.send('Hello World!');
});

app.listen(PORT, () =&gt; {
  console.log(`Server running on http://localhost:${PORT}`);
});
</code></pre>
<h3 id="application-structure"><a class="header" href="#application-structure">Application Structure</a></h3>
<pre><code>my-express-app/
├── src/
│   ├── index.ts              # Entry point
│   ├── config/
│   │   ├── database.ts       # Database configuration
│   │   └── environment.ts    # Environment variables
│   ├── controllers/          # Route controllers
│   │   └── userController.ts
│   ├── middleware/           # Custom middleware
│   │   ├── auth.ts
│   │   └── errorHandler.ts
│   ├── models/               # Data models
│   │   └── User.ts
│   ├── routes/               # Route definitions
│   │   └── userRoutes.ts
│   ├── services/             # Business logic
│   │   └── userService.ts
│   └── utils/                # Utility functions
│       └── validators.ts
├── tests/                    # Test files
├── dist/                     # Compiled JavaScript
├── node_modules/
├── package.json
├── tsconfig.json
└── .env
</code></pre>
<hr />
<h2 id="routing-1"><a class="header" href="#routing-1">Routing</a></h2>
<h3 id="basic-routes"><a class="header" href="#basic-routes">Basic Routes</a></h3>
<pre><code class="language-typescript">import express from 'express';
const app = express();

// GET request
app.get('/users', (req, res) =&gt; {
  res.json({ message: 'Get all users' });
});

// POST request
app.post('/users', (req, res) =&gt; {
  res.json({ message: 'Create user' });
});

// PUT request
app.put('/users/:id', (req, res) =&gt; {
  res.json({ message: `Update user ${req.params.id}` });
});

// DELETE request
app.delete('/users/:id', (req, res) =&gt; {
  res.json({ message: `Delete user ${req.params.id}` });
});

// PATCH request
app.patch('/users/:id', (req, res) =&gt; {
  res.json({ message: `Partially update user ${req.params.id}` });
});
</code></pre>
<h3 id="route-parameters"><a class="header" href="#route-parameters">Route Parameters</a></h3>
<pre><code class="language-typescript">// Single parameter
app.get('/users/:id', (req, res) =&gt; {
  const userId = req.params.id;
  res.json({ userId });
});

// Multiple parameters
app.get('/users/:userId/posts/:postId', (req, res) =&gt; {
  const { userId, postId } = req.params;
  res.json({ userId, postId });
});

// Optional parameters (using regex)
app.get('/users/:id(\\d+)?', (req, res) =&gt; {
  res.json({ id: req.params.id || 'all' });
});
</code></pre>
<h3 id="query-parameters"><a class="header" href="#query-parameters">Query Parameters</a></h3>
<pre><code class="language-typescript">// GET /search?q=express&amp;limit=10
app.get('/search', (req, res) =&gt; {
  const { q, limit = 10 } = req.query;
  res.json({ query: q, limit });
});
</code></pre>
<h3 id="route-handlers"><a class="header" href="#route-handlers">Route Handlers</a></h3>
<pre><code class="language-typescript">// Single callback
app.get('/example1', (req, res) =&gt; {
  res.send('Single callback');
});

// Multiple callbacks
app.get('/example2',
  (req, res, next) =&gt; {
    console.log('First handler');
    next();
  },
  (req, res) =&gt; {
    res.send('Second handler');
  }
);

// Array of callbacks
const cb1 = (req, res, next) =&gt; {
  console.log('CB1');
  next();
};

const cb2 = (req, res, next) =&gt; {
  console.log('CB2');
  next();
};

app.get('/example3', [cb1, cb2], (req, res) =&gt; {
  res.send('Array of callbacks');
});
</code></pre>
<h3 id="express-router"><a class="header" href="#express-router">Express Router</a></h3>
<pre><code class="language-typescript">// routes/userRoutes.ts
import { Router } from 'express';
import * as userController from '../controllers/userController';

const router = Router();

router.get('/', userController.getAllUsers);
router.get('/:id', userController.getUserById);
router.post('/', userController.createUser);
router.put('/:id', userController.updateUser);
router.delete('/:id', userController.deleteUser);

export default router;

// index.ts
import userRoutes from './routes/userRoutes';
app.use('/api/users', userRoutes);
</code></pre>
<h3 id="route-chaining"><a class="header" href="#route-chaining">Route Chaining</a></h3>
<pre><code class="language-typescript">app.route('/users')
  .get((req, res) =&gt; {
    res.json({ message: 'Get all users' });
  })
  .post((req, res) =&gt; {
    res.json({ message: 'Create user' });
  });

app.route('/users/:id')
  .get((req, res) =&gt; {
    res.json({ message: 'Get user' });
  })
  .put((req, res) =&gt; {
    res.json({ message: 'Update user' });
  })
  .delete((req, res) =&gt; {
    res.json({ message: 'Delete user' });
  });
</code></pre>
<hr />
<h2 id="middleware"><a class="header" href="#middleware">Middleware</a></h2>
<p>Middleware functions have access to request, response, and the next middleware function in the application's request-response cycle.</p>
<h3 id="built-in-middleware"><a class="header" href="#built-in-middleware">Built-in Middleware</a></h3>
<pre><code class="language-typescript">import express from 'express';
const app = express();

// Parse JSON bodies
app.use(express.json());

// Parse URL-encoded bodies
app.use(express.urlencoded({ extended: true }));

// Serve static files
app.use(express.static('public'));
</code></pre>
<h3 id="application-level-middleware"><a class="header" href="#application-level-middleware">Application-Level Middleware</a></h3>
<pre><code class="language-typescript">// Executed for every request
app.use((req, res, next) =&gt; {
  console.log(`${req.method} ${req.url}`);
  next();
});

// Executed for specific path
app.use('/api', (req, res, next) =&gt; {
  console.log('API request');
  next();
});
</code></pre>
<h3 id="router-level-middleware"><a class="header" href="#router-level-middleware">Router-Level Middleware</a></h3>
<pre><code class="language-typescript">const router = express.Router();

router.use((req, res, next) =&gt; {
  console.log('Router middleware');
  next();
});

router.get('/users', (req, res) =&gt; {
  res.json({ message: 'Users' });
});

app.use('/api', router);
</code></pre>
<h3 id="custom-middleware"><a class="header" href="#custom-middleware">Custom Middleware</a></h3>
<pre><code class="language-typescript">// Logger middleware
const logger = (req: Request, res: Response, next: NextFunction) =&gt; {
  const timestamp = new Date().toISOString();
  console.log(`[${timestamp}] ${req.method} ${req.path}`);
  next();
};

// Request timing middleware
const requestTimer = (req: Request, res: Response, next: NextFunction) =&gt; {
  const start = Date.now();

  res.on('finish', () =&gt; {
    const duration = Date.now() - start;
    console.log(`Request took ${duration}ms`);
  });

  next();
};

// Auth middleware
const authenticate = (req: Request, res: Response, next: NextFunction) =&gt; {
  const token = req.headers.authorization;

  if (!token) {
    return res.status(401).json({ error: 'No token provided' });
  }

  try {
    // Verify token
    const decoded = verifyToken(token);
    req.user = decoded;
    next();
  } catch (error) {
    res.status(401).json({ error: 'Invalid token' });
  }
};

// Usage
app.use(logger);
app.use(requestTimer);
app.use('/api/protected', authenticate);
</code></pre>
<h3 id="third-party-middleware"><a class="header" href="#third-party-middleware">Third-Party Middleware</a></h3>
<pre><code class="language-typescript">// CORS
import cors from 'cors';
app.use(cors({
  origin: 'http://localhost:3000',
  credentials: true
}));

// Helmet (security headers)
import helmet from 'helmet';
app.use(helmet());

// Compression
import compression from 'compression';
app.use(compression());

// Cookie parser
import cookieParser from 'cookie-parser';
app.use(cookieParser());

// Morgan (HTTP request logger)
import morgan from 'morgan';
app.use(morgan('combined'));

// Express validator
import { body, validationResult } from 'express-validator';

app.post('/users',
  body('email').isEmail(),
  body('password').isLength({ min: 6 }),
  (req, res) =&gt; {
    const errors = validationResult(req);
    if (!errors.isEmpty()) {
      return res.status(400).json({ errors: errors.array() });
    }
    // Process request
  }
);
</code></pre>
<hr />
<h2 id="request-and-response"><a class="header" href="#request-and-response">Request and Response</a></h2>
<h3 id="request-object"><a class="header" href="#request-object">Request Object</a></h3>
<pre><code class="language-typescript">app.post('/example', (req: Request, res: Response) =&gt; {
  // Request body (requires body-parser or express.json())
  console.log(req.body);

  // URL parameters
  console.log(req.params);

  // Query parameters
  console.log(req.query);

  // Headers
  console.log(req.headers);
  console.log(req.get('Content-Type'));

  // Cookies (requires cookie-parser)
  console.log(req.cookies);
  console.log(req.signedCookies);

  // Request URL info
  console.log(req.protocol);      // http or https
  console.log(req.hostname);      // Host name
  console.log(req.path);          // Path part of URL
  console.log(req.originalUrl);   // Original URL
  console.log(req.baseUrl);       // Base URL

  // Request method
  console.log(req.method);        // GET, POST, etc.

  // IP address
  console.log(req.ip);
  console.log(req.ips);

  // Check content type
  console.log(req.is('json'));
  console.log(req.is('html'));

  res.send('OK');
});
</code></pre>
<h3 id="response-object"><a class="header" href="#response-object">Response Object</a></h3>
<pre><code class="language-typescript">app.get('/response-examples', (req: Request, res: Response) =&gt; {
  // Send text
  res.send('Hello World');

  // Send JSON
  res.json({ message: 'Success', data: [] });

  // Set status code and send
  res.status(201).json({ message: 'Created' });

  // Send file
  res.sendFile('/path/to/file.pdf');

  // Download file
  res.download('/path/to/file.pdf', 'filename.pdf');

  // Redirect
  res.redirect('/new-url');
  res.redirect(301, '/permanent-redirect');

  // Set headers
  res.set('Content-Type', 'text/html');
  res.set({
    'Content-Type': 'text/html',
    'X-Custom-Header': 'value'
  });

  // Set cookies
  res.cookie('name', 'value', {
    maxAge: 900000,
    httpOnly: true,
    secure: true
  });

  // Clear cookie
  res.clearCookie('name');

  // Render view (requires template engine)
  res.render('index', { title: 'Home' });

  // End response
  res.end();

  // Send status with message
  res.sendStatus(404); // Sends "Not Found"
});
</code></pre>
<h3 id="response-status-codes"><a class="header" href="#response-status-codes">Response Status Codes</a></h3>
<pre><code class="language-typescript">// Success
res.status(200).json({ message: 'OK' });
res.status(201).json({ message: 'Created' });
res.status(204).send(); // No Content

// Client Errors
res.status(400).json({ error: 'Bad Request' });
res.status(401).json({ error: 'Unauthorized' });
res.status(403).json({ error: 'Forbidden' });
res.status(404).json({ error: 'Not Found' });
res.status(422).json({ error: 'Unprocessable Entity' });

// Server Errors
res.status(500).json({ error: 'Internal Server Error' });
res.status(503).json({ error: 'Service Unavailable' });
</code></pre>
<hr />
<h2 id="error-handling-10"><a class="header" href="#error-handling-10">Error Handling</a></h2>
<h3 id="basic-error-handling"><a class="header" href="#basic-error-handling">Basic Error Handling</a></h3>
<pre><code class="language-typescript">// Synchronous error
app.get('/sync-error', (req, res) =&gt; {
  throw new Error('Synchronous error');
});

// Asynchronous error (must use next)
app.get('/async-error', (req, res, next) =&gt; {
  setTimeout(() =&gt; {
    try {
      throw new Error('Async error');
    } catch (err) {
      next(err);
    }
  }, 100);
});

// Promise rejection
app.get('/promise-error', async (req, res, next) =&gt; {
  try {
    await someAsyncOperation();
    res.json({ success: true });
  } catch (err) {
    next(err);
  }
});
</code></pre>
<h3 id="error-handling-middleware"><a class="header" href="#error-handling-middleware">Error Handling Middleware</a></h3>
<pre><code class="language-typescript">// Error handler (must have 4 parameters)
app.use((err: Error, req: Request, res: Response, next: NextFunction) =&gt; {
  console.error(err.stack);
  res.status(500).json({
    error: {
      message: err.message,
      stack: process.env.NODE_ENV === 'development' ? err.stack : undefined
    }
  });
});
</code></pre>
<h3 id="custom-error-classes"><a class="header" href="#custom-error-classes">Custom Error Classes</a></h3>
<pre><code class="language-typescript">// errors/AppError.ts
export class AppError extends Error {
  statusCode: number;
  isOperational: boolean;

  constructor(message: string, statusCode: number) {
    super(message);
    this.statusCode = statusCode;
    this.isOperational = true;

    Error.captureStackTrace(this, this.constructor);
  }
}

export class ValidationError extends AppError {
  constructor(message: string) {
    super(message, 400);
  }
}

export class NotFoundError extends AppError {
  constructor(message: string = 'Resource not found') {
    super(message, 404);
  }
}

export class UnauthorizedError extends AppError {
  constructor(message: string = 'Unauthorized') {
    super(message, 401);
  }
}

// Usage in controllers
import { NotFoundError } from '../errors/AppError';

app.get('/users/:id', async (req, res, next) =&gt; {
  try {
    const user = await findUserById(req.params.id);
    if (!user) {
      throw new NotFoundError('User not found');
    }
    res.json(user);
  } catch (err) {
    next(err);
  }
});

// Error handler
app.use((err: Error | AppError, req: Request, res: Response, next: NextFunction) =&gt; {
  if (err instanceof AppError) {
    return res.status(err.statusCode).json({
      error: {
        message: err.message,
        statusCode: err.statusCode
      }
    });
  }

  // Unknown error
  console.error('Unknown error:', err);
  res.status(500).json({
    error: {
      message: 'Internal server error'
    }
  });
});
</code></pre>
<h3 id="async-error-wrapper"><a class="header" href="#async-error-wrapper">Async Error Wrapper</a></h3>
<pre><code class="language-typescript">// utils/asyncHandler.ts
export const asyncHandler = (fn: Function) =&gt; {
  return (req: Request, res: Response, next: NextFunction) =&gt; {
    Promise.resolve(fn(req, res, next)).catch(next);
  };
};

// Usage
app.get('/users', asyncHandler(async (req: Request, res: Response) =&gt; {
  const users = await User.find();
  res.json(users);
}));
</code></pre>
<h3 id="404-handler"><a class="header" href="#404-handler">404 Handler</a></h3>
<pre><code class="language-typescript">// Catch 404 and forward to error handler
app.use((req, res, next) =&gt; {
  res.status(404).json({
    error: {
      message: 'Route not found',
      path: req.originalUrl
    }
  });
});
</code></pre>
<hr />
<h2 id="template-engines"><a class="header" href="#template-engines">Template Engines</a></h2>
<h3 id="ejs-embedded-javascript"><a class="header" href="#ejs-embedded-javascript">EJS (Embedded JavaScript)</a></h3>
<pre><code class="language-bash">npm install ejs
</code></pre>
<pre><code class="language-typescript">import express from 'express';
const app = express();

// Set view engine
app.set('view engine', 'ejs');
app.set('views', './views');

// Render template
app.get('/', (req, res) =&gt; {
  res.render('index', {
    title: 'Home Page',
    user: { name: 'John' }
  });
});
</code></pre>
<p><strong>views/index.ejs:</strong></p>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;title&gt;&lt;%= title %&gt;&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;h1&gt;Welcome, &lt;%= user.name %&gt;!&lt;/h1&gt;

  &lt;% if (user.isAdmin) { %&gt;
    &lt;p&gt;Admin panel&lt;/p&gt;
  &lt;% } %&gt;

  &lt;ul&gt;
    &lt;% ['Item 1', 'Item 2', 'Item 3'].forEach(item =&gt; { %&gt;
      &lt;li&gt;&lt;%= item %&gt;&lt;/li&gt;
    &lt;% }); %&gt;
  &lt;/ul&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h3 id="pug-formerly-jade"><a class="header" href="#pug-formerly-jade">Pug (formerly Jade)</a></h3>
<pre><code class="language-bash">npm install pug
</code></pre>
<pre><code class="language-typescript">app.set('view engine', 'pug');
app.set('views', './views');

app.get('/', (req, res) =&gt; {
  res.render('index', { title: 'Home', message: 'Hello Pug!' });
});
</code></pre>
<p><strong>views/index.pug:</strong></p>
<pre><code class="language-pug">html
  head
    title= title
  body
    h1= message
    ul
      each item in ['Item 1', 'Item 2', 'Item 3']
        li= item
</code></pre>
<h3 id="handlebars"><a class="header" href="#handlebars">Handlebars</a></h3>
<pre><code class="language-bash">npm install express-handlebars
</code></pre>
<pre><code class="language-typescript">import { engine } from 'express-handlebars';

app.engine('handlebars', engine());
app.set('view engine', 'handlebars');
app.set('views', './views');

app.get('/', (req, res) =&gt; {
  res.render('home', {
    title: 'Home',
    items: ['Item 1', 'Item 2', 'Item 3']
  });
});
</code></pre>
<hr />
<h2 id="static-files"><a class="header" href="#static-files">Static Files</a></h2>
<h3 id="serving-static-files"><a class="header" href="#serving-static-files">Serving Static Files</a></h3>
<pre><code class="language-typescript">// Serve from 'public' directory
app.use(express.static('public'));

// Now you can access:
// http://localhost:3000/images/logo.png
// http://localhost:3000/css/style.css
// http://localhost:3000/js/app.js

// Multiple static directories
app.use(express.static('public'));
app.use(express.static('files'));

// Virtual path prefix
app.use('/static', express.static('public'));
// Now: http://localhost:3000/static/images/logo.png

// Absolute path
import path from 'path';
app.use('/static', express.static(path.join(__dirname, 'public')));
</code></pre>
<h3 id="static-file-options"><a class="header" href="#static-file-options">Static File Options</a></h3>
<pre><code class="language-typescript">app.use(express.static('public', {
  maxAge: '1d',           // Cache for 1 day
  dotfiles: 'ignore',     // Ignore dotfiles
  index: 'index.html',    // Directory index file
  extensions: ['html'],   // File extension fallbacks
  setHeaders: (res, path) =&gt; {
    res.set('X-Custom-Header', 'value');
  }
}));
</code></pre>
<hr />
<h2 id="database-integration"><a class="header" href="#database-integration">Database Integration</a></h2>
<h3 id="mongodb-with-mongoose"><a class="header" href="#mongodb-with-mongoose">MongoDB with Mongoose</a></h3>
<pre><code class="language-bash">npm install mongoose
</code></pre>
<pre><code class="language-typescript">// config/database.ts
import mongoose from 'mongoose';

export const connectDatabase = async () =&gt; {
  try {
    await mongoose.connect(process.env.MONGODB_URI || 'mongodb://localhost:27017/myapp');
    console.log('MongoDB connected');
  } catch (error) {
    console.error('MongoDB connection error:', error);
    process.exit(1);
  }
};

// models/User.ts
import mongoose, { Document, Schema } from 'mongoose';

export interface IUser extends Document {
  name: string;
  email: string;
  password: string;
  createdAt: Date;
}

const UserSchema = new Schema({
  name: { type: String, required: true },
  email: { type: String, required: true, unique: true },
  password: { type: String, required: true },
  createdAt: { type: Date, default: Date.now }
});

export default mongoose.model&lt;IUser&gt;('User', UserSchema);

// controllers/userController.ts
import User from '../models/User';

export const getAllUsers = async (req: Request, res: Response) =&gt; {
  try {
    const users = await User.find().select('-password');
    res.json(users);
  } catch (error) {
    res.status(500).json({ error: 'Server error' });
  }
};

export const createUser = async (req: Request, res: Response) =&gt; {
  try {
    const user = new User(req.body);
    await user.save();
    res.status(201).json(user);
  } catch (error) {
    res.status(400).json({ error: 'Invalid data' });
  }
};

// index.ts
import { connectDatabase } from './config/database';

connectDatabase();
</code></pre>
<h3 id="postgresql-with-sequelize"><a class="header" href="#postgresql-with-sequelize">PostgreSQL with Sequelize</a></h3>
<pre><code class="language-bash">npm install sequelize pg pg-hstore
</code></pre>
<pre><code class="language-typescript">// config/database.ts
import { Sequelize } from 'sequelize';

export const sequelize = new Sequelize(
  process.env.DB_NAME || 'myapp',
  process.env.DB_USER || 'postgres',
  process.env.DB_PASSWORD || 'password',
  {
    host: process.env.DB_HOST || 'localhost',
    dialect: 'postgres',
    logging: false
  }
);

export const connectDatabase = async () =&gt; {
  try {
    await sequelize.authenticate();
    console.log('PostgreSQL connected');
    await sequelize.sync();
  } catch (error) {
    console.error('Database connection error:', error);
  }
};

// models/User.ts
import { DataTypes, Model } from 'sequelize';
import { sequelize } from '../config/database';

export class User extends Model {
  public id!: number;
  public name!: string;
  public email!: string;
  public readonly createdAt!: Date;
}

User.init(
  {
    id: {
      type: DataTypes.INTEGER,
      autoIncrement: true,
      primaryKey: true
    },
    name: {
      type: DataTypes.STRING,
      allowNull: false
    },
    email: {
      type: DataTypes.STRING,
      allowNull: false,
      unique: true
    }
  },
  {
    sequelize,
    tableName: 'users'
  }
);
</code></pre>
<h3 id="mysql-with-mysql2"><a class="header" href="#mysql-with-mysql2">MySQL with mysql2</a></h3>
<pre><code class="language-bash">npm install mysql2
</code></pre>
<pre><code class="language-typescript">import mysql from 'mysql2/promise';

const pool = mysql.createPool({
  host: 'localhost',
  user: 'root',
  password: 'password',
  database: 'myapp',
  waitForConnections: true,
  connectionLimit: 10,
  queueLimit: 0
});

app.get('/users', async (req, res) =&gt; {
  try {
    const [rows] = await pool.query('SELECT * FROM users');
    res.json(rows);
  } catch (error) {
    res.status(500).json({ error: 'Database error' });
  }
});
</code></pre>
<hr />
<h2 id="authentication-5"><a class="header" href="#authentication-5">Authentication</a></h2>
<h3 id="jwt-authentication"><a class="header" href="#jwt-authentication">JWT Authentication</a></h3>
<pre><code class="language-bash">npm install jsonwebtoken bcryptjs
npm install --save-dev @types/jsonwebtoken @types/bcryptjs
</code></pre>
<pre><code class="language-typescript">import jwt from 'jsonwebtoken';
import bcrypt from 'bcryptjs';

const JWT_SECRET = process.env.JWT_SECRET || 'your-secret-key';

// Register
app.post('/auth/register', async (req, res) =&gt; {
  try {
    const { email, password, name } = req.body;

    // Check if user exists
    const existingUser = await User.findOne({ email });
    if (existingUser) {
      return res.status(400).json({ error: 'User already exists' });
    }

    // Hash password
    const hashedPassword = await bcrypt.hash(password, 10);

    // Create user
    const user = new User({
      email,
      password: hashedPassword,
      name
    });

    await user.save();

    // Generate token
    const token = jwt.sign(
      { userId: user.id, email: user.email },
      JWT_SECRET,
      { expiresIn: '7d' }
    );

    res.status(201).json({ token, user: { id: user.id, email, name } });
  } catch (error) {
    res.status(500).json({ error: 'Registration failed' });
  }
});

// Login
app.post('/auth/login', async (req, res) =&gt; {
  try {
    const { email, password } = req.body;

    // Find user
    const user = await User.findOne({ email });
    if (!user) {
      return res.status(401).json({ error: 'Invalid credentials' });
    }

    // Verify password
    const isValidPassword = await bcrypt.compare(password, user.password);
    if (!isValidPassword) {
      return res.status(401).json({ error: 'Invalid credentials' });
    }

    // Generate token
    const token = jwt.sign(
      { userId: user.id, email: user.email },
      JWT_SECRET,
      { expiresIn: '7d' }
    );

    res.json({
      token,
      user: { id: user.id, email: user.email, name: user.name }
    });
  } catch (error) {
    res.status(500).json({ error: 'Login failed' });
  }
});

// Auth middleware
interface AuthRequest extends Request {
  user?: any;
}

const authenticate = (req: AuthRequest, res: Response, next: NextFunction) =&gt; {
  try {
    const token = req.headers.authorization?.split(' ')[1];

    if (!token) {
      return res.status(401).json({ error: 'No token provided' });
    }

    const decoded = jwt.verify(token, JWT_SECRET);
    req.user = decoded;
    next();
  } catch (error) {
    res.status(401).json({ error: 'Invalid token' });
  }
};

// Protected route
app.get('/profile', authenticate, async (req: AuthRequest, res) =&gt; {
  try {
    const user = await User.findById(req.user.userId).select('-password');
    res.json(user);
  } catch (error) {
    res.status(500).json({ error: 'Server error' });
  }
});
</code></pre>
<h3 id="session-based-authentication"><a class="header" href="#session-based-authentication">Session-Based Authentication</a></h3>
<pre><code class="language-bash">npm install express-session connect-mongo
</code></pre>
<pre><code class="language-typescript">import session from 'express-session';
import MongoStore from 'connect-mongo';

app.use(session({
  secret: process.env.SESSION_SECRET || 'your-secret',
  resave: false,
  saveUninitialized: false,
  store: MongoStore.create({
    mongoUrl: process.env.MONGODB_URI
  }),
  cookie: {
    secure: process.env.NODE_ENV === 'production',
    httpOnly: true,
    maxAge: 1000 * 60 * 60 * 24 * 7 // 7 days
  }
}));

// Login
app.post('/login', async (req, res) =&gt; {
  const { email, password } = req.body;

  const user = await User.findOne({ email });
  if (!user || !(await bcrypt.compare(password, user.password))) {
    return res.status(401).json({ error: 'Invalid credentials' });
  }

  req.session.userId = user.id;
  res.json({ message: 'Logged in successfully' });
});

// Logout
app.post('/logout', (req, res) =&gt; {
  req.session.destroy((err) =&gt; {
    if (err) {
      return res.status(500).json({ error: 'Logout failed' });
    }
    res.clearCookie('connect.sid');
    res.json({ message: 'Logged out successfully' });
  });
});

// Auth middleware
const requireAuth = (req: Request, res: Response, next: NextFunction) =&gt; {
  if (!req.session.userId) {
    return res.status(401).json({ error: 'Unauthorized' });
  }
  next();
};
</code></pre>
<hr />
<h2 id="restful-api"><a class="header" href="#restful-api">RESTful API</a></h2>
<h3 id="complete-rest-api-example"><a class="header" href="#complete-rest-api-example">Complete REST API Example</a></h3>
<pre><code class="language-typescript">// routes/api/users.ts
import { Router } from 'express';
import {
  getAllUsers,
  getUserById,
  createUser,
  updateUser,
  deleteUser
} from '../../controllers/userController';
import { authenticate } from '../../middleware/auth';
import { validateUser } from '../../middleware/validation';

const router = Router();

// GET /api/users - Get all users
router.get('/', authenticate, getAllUsers);

// GET /api/users/:id - Get user by ID
router.get('/:id', authenticate, getUserById);

// POST /api/users - Create new user
router.post('/', validateUser, createUser);

// PUT /api/users/:id - Update user
router.put('/:id', authenticate, validateUser, updateUser);

// DELETE /api/users/:id - Delete user
router.delete('/:id', authenticate, deleteUser);

export default router;

// controllers/userController.ts
import { Request, Response } from 'express';
import User from '../models/User';

export const getAllUsers = async (req: Request, res: Response) =&gt; {
  try {
    const page = parseInt(req.query.page as string) || 1;
    const limit = parseInt(req.query.limit as string) || 10;
    const skip = (page - 1) * limit;

    const users = await User.find()
      .select('-password')
      .limit(limit)
      .skip(skip);

    const total = await User.countDocuments();

    res.json({
      users,
      pagination: {
        page,
        limit,
        total,
        pages: Math.ceil(total / limit)
      }
    });
  } catch (error) {
    res.status(500).json({ error: 'Server error' });
  }
};

export const getUserById = async (req: Request, res: Response) =&gt; {
  try {
    const user = await User.findById(req.params.id).select('-password');

    if (!user) {
      return res.status(404).json({ error: 'User not found' });
    }

    res.json(user);
  } catch (error) {
    res.status(500).json({ error: 'Server error' });
  }
};

export const createUser = async (req: Request, res: Response) =&gt; {
  try {
    const user = new User(req.body);
    await user.save();

    const userResponse = user.toObject();
    delete userResponse.password;

    res.status(201).json(userResponse);
  } catch (error) {
    res.status(400).json({ error: 'Invalid data' });
  }
};

export const updateUser = async (req: Request, res: Response) =&gt; {
  try {
    const user = await User.findByIdAndUpdate(
      req.params.id,
      req.body,
      { new: true, runValidators: true }
    ).select('-password');

    if (!user) {
      return res.status(404).json({ error: 'User not found' });
    }

    res.json(user);
  } catch (error) {
    res.status(400).json({ error: 'Invalid data' });
  }
};

export const deleteUser = async (req: Request, res: Response) =&gt; {
  try {
    const user = await User.findByIdAndDelete(req.params.id);

    if (!user) {
      return res.status(404).json({ error: 'User not found' });
    }

    res.status(204).send();
  } catch (error) {
    res.status(500).json({ error: 'Server error' });
  }
};
</code></pre>
<h3 id="api-versioning"><a class="header" href="#api-versioning">API Versioning</a></h3>
<pre><code class="language-typescript">// v1 routes
import v1Router from './routes/v1';
app.use('/api/v1', v1Router);

// v2 routes
import v2Router from './routes/v2';
app.use('/api/v2', v2Router);
</code></pre>
<h3 id="rate-limiting-3"><a class="header" href="#rate-limiting-3">Rate Limiting</a></h3>
<pre><code class="language-bash">npm install express-rate-limit
</code></pre>
<pre><code class="language-typescript">import rateLimit from 'express-rate-limit';

const limiter = rateLimit({
  windowMs: 15 * 60 * 1000, // 15 minutes
  max: 100, // Limit each IP to 100 requests per windowMs
  message: 'Too many requests from this IP'
});

app.use('/api/', limiter);

// Different limits for different routes
const authLimiter = rateLimit({
  windowMs: 15 * 60 * 1000,
  max: 5,
  message: 'Too many login attempts'
});

app.use('/api/auth/login', authLimiter);
</code></pre>
<hr />
<h2 id="file-uploads"><a class="header" href="#file-uploads">File Uploads</a></h2>
<h3 id="multer-for-file-uploads"><a class="header" href="#multer-for-file-uploads">Multer for File Uploads</a></h3>
<pre><code class="language-bash">npm install multer
npm install --save-dev @types/multer
</code></pre>
<pre><code class="language-typescript">import multer from 'multer';
import path from 'path';

// Storage configuration
const storage = multer.diskStorage({
  destination: (req, file, cb) =&gt; {
    cb(null, 'uploads/');
  },
  filename: (req, file, cb) =&gt; {
    const uniqueSuffix = Date.now() + '-' + Math.round(Math.random() * 1E9);
    cb(null, file.fieldname + '-' + uniqueSuffix + path.extname(file.originalname));
  }
});

// File filter
const fileFilter = (req: Request, file: Express.Multer.File, cb: multer.FileFilterCallback) =&gt; {
  const allowedTypes = ['image/jpeg', 'image/png', 'image/gif'];

  if (allowedTypes.includes(file.mimetype)) {
    cb(null, true);
  } else {
    cb(new Error('Invalid file type'));
  }
};

const upload = multer({
  storage: storage,
  limits: {
    fileSize: 5 * 1024 * 1024 // 5MB
  },
  fileFilter: fileFilter
});

// Single file upload
app.post('/upload', upload.single('avatar'), (req, res) =&gt; {
  if (!req.file) {
    return res.status(400).json({ error: 'No file uploaded' });
  }

  res.json({
    message: 'File uploaded successfully',
    file: {
      filename: req.file.filename,
      path: req.file.path,
      size: req.file.size
    }
  });
});

// Multiple files
app.post('/upload-multiple', upload.array('photos', 5), (req, res) =&gt; {
  res.json({
    message: 'Files uploaded successfully',
    files: req.files
  });
});

// Multiple fields
app.post('/upload-fields',
  upload.fields([
    { name: 'avatar', maxCount: 1 },
    { name: 'gallery', maxCount: 5 }
  ]),
  (req, res) =&gt; {
    res.json({
      message: 'Files uploaded successfully',
      files: req.files
    });
  }
);
</code></pre>
<hr />
<h2 id="security-best-practices-10"><a class="header" href="#security-best-practices-10">Security Best Practices</a></h2>
<h3 id="essential-security-packages"><a class="header" href="#essential-security-packages">Essential Security Packages</a></h3>
<pre><code class="language-bash">npm install helmet cors express-rate-limit express-validator
npm install --save-dev @types/cors
</code></pre>
<pre><code class="language-typescript">import helmet from 'helmet';
import cors from 'cors';
import rateLimit from 'express-rate-limit';

// Helmet - Set security headers
app.use(helmet());

// CORS configuration
app.use(cors({
  origin: process.env.ALLOWED_ORIGINS?.split(',') || 'http://localhost:3000',
  credentials: true,
  methods: ['GET', 'POST', 'PUT', 'DELETE', 'PATCH'],
  allowedHeaders: ['Content-Type', 'Authorization']
}));

// Rate limiting
const limiter = rateLimit({
  windowMs: 15 * 60 * 1000,
  max: 100
});
app.use(limiter);

// Prevent parameter pollution
import hpp from 'hpp';
app.use(hpp());

// Sanitize data
import mongoSanitize from 'express-mongo-sanitize';
app.use(mongoSanitize());

// XSS protection
import xss from 'xss-clean';
app.use(xss());
</code></pre>
<h3 id="input-validation-1"><a class="header" href="#input-validation-1">Input Validation</a></h3>
<pre><code class="language-typescript">import { body, param, validationResult } from 'express-validator';

app.post('/users',
  body('email').isEmail().normalizeEmail(),
  body('password').isLength({ min: 8 }).matches(/\d/).matches(/[a-zA-Z]/),
  body('name').trim().isLength({ min: 2, max: 50 }),
  (req, res) =&gt; {
    const errors = validationResult(req);
    if (!errors.isEmpty()) {
      return res.status(400).json({ errors: errors.array() });
    }

    // Process request
  }
);
</code></pre>
<h3 id="sql-injection-prevention"><a class="header" href="#sql-injection-prevention">SQL Injection Prevention</a></h3>
<pre><code class="language-typescript">// Use parameterized queries
const [rows] = await pool.query(
  'SELECT * FROM users WHERE email = ?',
  [email]
);

// Use ORM/ODM
const user = await User.findOne({ email }); // Mongoose
</code></pre>
<h3 id="https-enforcement"><a class="header" href="#https-enforcement">HTTPS Enforcement</a></h3>
<pre><code class="language-typescript">// Redirect HTTP to HTTPS
app.use((req, res, next) =&gt; {
  if (req.header('x-forwarded-proto') !== 'https' &amp;&amp; process.env.NODE_ENV === 'production') {
    res.redirect(`https://${req.header('host')}${req.url}`);
  } else {
    next();
  }
});
</code></pre>
<hr />
<h2 id="testing-6"><a class="header" href="#testing-6">Testing</a></h2>
<h3 id="jest-and-supertest"><a class="header" href="#jest-and-supertest">Jest and Supertest</a></h3>
<pre><code class="language-bash">npm install --save-dev jest supertest @types/jest @types/supertest ts-jest
</code></pre>
<p><strong>jest.config.js:</strong></p>
<pre><code class="language-javascript">module.exports = {
  preset: 'ts-jest',
  testEnvironment: 'node',
  testMatch: ['**/__tests__/**/*.ts', '**/?(*.)+(spec|test).ts'],
  collectCoverageFrom: ['src/**/*.ts', '!src/**/*.d.ts']
};
</code></pre>
<p><strong>tests/app.test.ts:</strong></p>
<pre><code class="language-typescript">import request from 'supertest';
import app from '../src/app';

describe('User API', () =&gt; {
  it('GET /api/users should return all users', async () =&gt; {
    const response = await request(app)
      .get('/api/users')
      .expect('Content-Type', /json/)
      .expect(200);

    expect(response.body).toHaveProperty('users');
    expect(Array.isArray(response.body.users)).toBe(true);
  });

  it('POST /api/users should create a user', async () =&gt; {
    const newUser = {
      name: 'John Doe',
      email: 'john@example.com',
      password: 'password123'
    };

    const response = await request(app)
      .post('/api/users')
      .send(newUser)
      .expect('Content-Type', /json/)
      .expect(201);

    expect(response.body).toHaveProperty('id');
    expect(response.body.email).toBe(newUser.email);
  });

  it('GET /api/users/:id should return a user', async () =&gt; {
    const response = await request(app)
      .get('/api/users/1')
      .expect(200);

    expect(response.body).toHaveProperty('id');
    expect(response.body).toHaveProperty('name');
  });

  it('PUT /api/users/:id should update a user', async () =&gt; {
    const updates = { name: 'Jane Doe' };

    const response = await request(app)
      .put('/api/users/1')
      .send(updates)
      .expect(200);

    expect(response.body.name).toBe(updates.name);
  });

  it('DELETE /api/users/:id should delete a user', async () =&gt; {
    await request(app)
      .delete('/api/users/1')
      .expect(204);
  });
});

describe('Authentication', () =&gt; {
  it('POST /auth/register should register a user', async () =&gt; {
    const user = {
      name: 'Test User',
      email: 'test@example.com',
      password: 'password123'
    };

    const response = await request(app)
      .post('/auth/register')
      .send(user)
      .expect(201);

    expect(response.body).toHaveProperty('token');
    expect(response.body).toHaveProperty('user');
  });

  it('POST /auth/login should login a user', async () =&gt; {
    const credentials = {
      email: 'test@example.com',
      password: 'password123'
    };

    const response = await request(app)
      .post('/auth/login')
      .send(credentials)
      .expect(200);

    expect(response.body).toHaveProperty('token');
  });
});
</code></pre>
<hr />
<h2 id="production-deployment"><a class="header" href="#production-deployment">Production Deployment</a></h2>
<h3 id="environment-variables-2"><a class="header" href="#environment-variables-2">Environment Variables</a></h3>
<p><strong>.env:</strong></p>
<pre><code>NODE_ENV=production
PORT=3000
DATABASE_URL=mongodb://localhost:27017/myapp
JWT_SECRET=your-jwt-secret
SESSION_SECRET=your-session-secret
ALLOWED_ORIGINS=https://yourdomain.com
</code></pre>
<h3 id="process-manager-pm2"><a class="header" href="#process-manager-pm2">Process Manager (PM2)</a></h3>
<pre><code class="language-bash">npm install -g pm2

# Start application
pm2 start dist/index.js --name "my-app"

# Start with cluster mode
pm2 start dist/index.js -i max --name "my-app"

# Save configuration
pm2 save

# Startup script
pm2 startup
</code></pre>
<p><strong>ecosystem.config.js:</strong></p>
<pre><code class="language-javascript">module.exports = {
  apps: [{
    name: 'my-app',
    script: './dist/index.js',
    instances: 'max',
    exec_mode: 'cluster',
    env: {
      NODE_ENV: 'production',
      PORT: 3000
    },
    error_file: './logs/error.log',
    out_file: './logs/out.log',
    log_date_format: 'YYYY-MM-DD HH:mm:ss'
  }]
};
</code></pre>
<h3 id="docker-deployment"><a class="header" href="#docker-deployment">Docker Deployment</a></h3>
<p><strong>Dockerfile:</strong></p>
<pre><code class="language-dockerfile">FROM node:18-alpine

WORKDIR /app

COPY package*.json ./

RUN npm ci --only=production

COPY . .

RUN npm run build

EXPOSE 3000

CMD ["node", "dist/index.js"]
</code></pre>
<p><strong>docker-compose.yml:</strong></p>
<pre><code class="language-yaml">version: '3.8'

services:
  app:
    build: .
    ports:
      - "3000:3000"
    environment:
      - NODE_ENV=production
      - DATABASE_URL=mongodb://mongo:27017/myapp
    depends_on:
      - mongo

  mongo:
    image: mongo:6
    volumes:
      - mongo-data:/data/db
    ports:
      - "27017:27017"

volumes:
  mongo-data:
</code></pre>
<h3 id="nginx-reverse-proxy"><a class="header" href="#nginx-reverse-proxy">Nginx Reverse Proxy</a></h3>
<pre><code class="language-nginx">server {
    listen 80;
    server_name yourdomain.com;

    location / {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
</code></pre>
<h3 id="performance-optimization-7"><a class="header" href="#performance-optimization-7">Performance Optimization</a></h3>
<pre><code class="language-typescript">// Compression
import compression from 'compression';
app.use(compression());

// Response caching
import apicache from 'apicache';
const cache = apicache.middleware;

app.get('/api/users', cache('5 minutes'), getAllUsers);

// Database connection pooling
mongoose.connect(uri, {
  maxPoolSize: 10,
  minPoolSize: 5
});

// Clustering
import cluster from 'cluster';
import os from 'os';

if (cluster.isPrimary) {
  const cpuCount = os.cpus().length;

  for (let i = 0; i &lt; cpuCount; i++) {
    cluster.fork();
  }

  cluster.on('exit', (worker) =&gt; {
    console.log(`Worker ${worker.process.pid} died`);
    cluster.fork();
  });
} else {
  app.listen(PORT);
}
</code></pre>
<hr />
<h2 id="resources-41"><a class="header" href="#resources-41">Resources</a></h2>
<ul>
<li><strong>Official Documentation</strong>: <a href="https://expressjs.com/">https://expressjs.com/</a></li>
<li><strong>GitHub Repository</strong>: <a href="https://github.com/expressjs/express">https://github.com/expressjs/express</a></li>
<li><strong>Express Generator</strong>: <a href="https://expressjs.com/en/starter/generator.html">https://expressjs.com/en/starter/generator.html</a></li>
<li><strong>Best Practices</strong>: <a href="https://expressjs.com/en/advanced/best-practice-performance.html">https://expressjs.com/en/advanced/best-practice-performance.html</a></li>
</ul>
<hr />
<p>Express.js remains the most popular Node.js framework due to its simplicity, flexibility, and robust ecosystem. Its minimalist approach allows developers to structure applications as they see fit, making it suitable for everything from small APIs to large-scale enterprise applications.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="nestjs"><a class="header" href="#nestjs">NestJS</a></h1>
<p>NestJS is a progressive Node.js framework for building efficient, reliable, and scalable server-side applications. It uses TypeScript by default and combines elements of Object-Oriented Programming (OOP), Functional Programming (FP), and Functional Reactive Programming (FRP). NestJS is heavily inspired by Angular's architecture and provides a robust application structure out of the box.</p>
<h2 id="table-of-contents-48"><a class="header" href="#table-of-contents-48">Table of Contents</a></h2>
<ul>
<li><a href="web_development/nestjs.html#introduction">Introduction</a></li>
<li><a href="web_development/nestjs.html#installation-and-setup">Installation and Setup</a></li>
<li><a href="web_development/nestjs.html#core-concepts">Core Concepts</a></li>
<li><a href="web_development/nestjs.html#controllers">Controllers</a></li>
<li><a href="web_development/nestjs.html#providers-and-dependency-injection">Providers and Dependency Injection</a></li>
<li><a href="web_development/nestjs.html#modules">Modules</a></li>
<li><a href="web_development/nestjs.html#middleware">Middleware</a></li>
<li><a href="web_development/nestjs.html#exception-filters">Exception Filters</a></li>
<li><a href="web_development/nestjs.html#pipes">Pipes</a></li>
<li><a href="web_development/nestjs.html#guards">Guards</a></li>
<li><a href="web_development/nestjs.html#interceptors">Interceptors</a></li>
<li><a href="web_development/nestjs.html#database-integration">Database Integration</a></li>
<li><a href="web_development/nestjs.html#authentication-and-authorization">Authentication and Authorization</a></li>
<li><a href="web_development/nestjs.html#graphql">GraphQL</a></li>
<li><a href="web_development/nestjs.html#microservices">Microservices</a></li>
<li><a href="web_development/nestjs.html#testing">Testing</a></li>
<li><a href="web_development/nestjs.html#best-practices">Best Practices</a></li>
<li><a href="web_development/nestjs.html#production-deployment">Production Deployment</a></li>
</ul>
<hr />
<h2 id="introduction-28"><a class="header" href="#introduction-28">Introduction</a></h2>
<p><strong>Key Features:</strong></p>
<ul>
<li>TypeScript-first framework with full TypeScript support</li>
<li>Modular architecture with dependency injection</li>
<li>Built on top of Express (or Fastify)</li>
<li>Extensive ecosystem and CLI tools</li>
<li>WebSockets and GraphQL support</li>
<li>Microservices architecture support</li>
<li>Comprehensive testing utilities</li>
<li>OpenAPI (Swagger) integration</li>
<li>Excellent documentation</li>
</ul>
<p><strong>Use Cases:</strong></p>
<ul>
<li>Enterprise-grade REST APIs</li>
<li>GraphQL APIs</li>
<li>Microservices architectures</li>
<li>Real-time applications with WebSockets</li>
<li>Server-side rendered applications</li>
<li>Backend for mobile applications</li>
<li>Monolithic or distributed systems</li>
</ul>
<p><strong>Philosophy:</strong>
NestJS provides an opinionated structure while remaining flexible, making it ideal for large teams and enterprise applications where maintainability and scalability are crucial.</p>
<hr />
<h2 id="installation-and-setup-6"><a class="header" href="#installation-and-setup-6">Installation and Setup</a></h2>
<h3 id="prerequisites-1"><a class="header" href="#prerequisites-1">Prerequisites</a></h3>
<pre><code class="language-bash"># Node.js 16+ and npm required
node --version
npm --version
</code></pre>
<h3 id="create-new-project-2"><a class="header" href="#create-new-project-2">Create New Project</a></h3>
<pre><code class="language-bash"># Install NestJS CLI globally
npm install -g @nestjs/cli

# Create new project
nest new my-nest-app

# Navigate to project
cd my-nest-app

# Start development server
npm run start:dev
</code></pre>
<h3 id="manual-setup"><a class="header" href="#manual-setup">Manual Setup</a></h3>
<pre><code class="language-bash"># Create project directory
mkdir my-nest-app
cd my-nest-app

# Initialize npm
npm init -y

# Install core dependencies
npm install @nestjs/common @nestjs/core @nestjs/platform-express reflect-metadata rxjs

# Install development dependencies
npm install -D @nestjs/cli @nestjs/schematics typescript @types/node @types/express ts-node
</code></pre>
<h3 id="project-structure-5"><a class="header" href="#project-structure-5">Project Structure</a></h3>
<pre><code>my-nest-app/
├── src/
│   ├── main.ts                 # Application entry point
│   ├── app.module.ts           # Root module
│   ├── app.controller.ts       # Root controller
│   ├── app.service.ts          # Root service
│   ├── modules/                # Feature modules
│   │   ├── users/
│   │   │   ├── users.module.ts
│   │   │   ├── users.controller.ts
│   │   │   ├── users.service.ts
│   │   │   ├── dto/            # Data Transfer Objects
│   │   │   ├── entities/       # Database entities
│   │   │   └── interfaces/     # TypeScript interfaces
│   │   └── auth/
│   ├── common/                 # Shared utilities
│   │   ├── guards/
│   │   ├── interceptors/
│   │   ├── pipes/
│   │   ├── filters/
│   │   └── decorators/
│   └── config/                 # Configuration files
├── test/                       # E2E tests
├── nest-cli.json              # NestJS CLI configuration
├── tsconfig.json              # TypeScript configuration
└── package.json
</code></pre>
<h3 id="configuration-files-3"><a class="header" href="#configuration-files-3">Configuration Files</a></h3>
<p><strong>tsconfig.json:</strong></p>
<pre><code class="language-json">{
  "compilerOptions": {
    "module": "commonjs",
    "declaration": true,
    "removeComments": true,
    "emitDecoratorMetadata": true,
    "experimentalDecorators": true,
    "allowSyntheticDefaultImports": true,
    "target": "ES2021",
    "sourceMap": true,
    "outDir": "./dist",
    "baseUrl": "./",
    "incremental": true,
    "skipLibCheck": true,
    "strictNullChecks": false,
    "noImplicitAny": false,
    "strictBindCallApply": false,
    "forceConsistentCasingInFileNames": false,
    "noFallthroughCasesInSwitch": false
  }
}
</code></pre>
<p><strong>nest-cli.json:</strong></p>
<pre><code class="language-json">{
  "collection": "@nestjs/schematics",
  "sourceRoot": "src",
  "compilerOptions": {
    "deleteOutDir": true
  }
}
</code></pre>
<hr />
<h2 id="core-concepts-6"><a class="header" href="#core-concepts-6">Core Concepts</a></h2>
<h3 id="application-bootstrap"><a class="header" href="#application-bootstrap">Application Bootstrap</a></h3>
<p><strong>src/main.ts:</strong></p>
<pre><code class="language-typescript">import { NestFactory } from '@nestjs/core';
import { AppModule } from './app.module';
import { ValidationPipe } from '@nestjs/common';
import { DocumentBuilder, SwaggerModule } from '@nestjs/swagger';

async function bootstrap() {
  const app = await NestFactory.create(AppModule);

  // Enable CORS
  app.enableCors();

  // Global prefix
  app.setGlobalPrefix('api/v1');

  // Global validation pipe
  app.useGlobalPipes(new ValidationPipe({
    whitelist: true,
    forbidNonWhitelisted: true,
    transform: true,
  }));

  // Swagger documentation
  const config = new DocumentBuilder()
    .setTitle('My API')
    .setDescription('API documentation')
    .setVersion('1.0')
    .addBearerAuth()
    .build();
  const document = SwaggerModule.createDocument(app, config);
  SwaggerModule.setup('api/docs', app, document);

  await app.listen(3000);
  console.log(`Application is running on: ${await app.getUrl()}`);
}

bootstrap();
</code></pre>
<hr />
<h2 id="controllers"><a class="header" href="#controllers">Controllers</a></h2>
<p>Controllers handle incoming requests and return responses to the client.</p>
<h3 id="basic-controller"><a class="header" href="#basic-controller">Basic Controller</a></h3>
<pre><code class="language-typescript">import { Controller, Get, Post, Put, Delete, Body, Param, Query, HttpCode, HttpStatus } from '@nestjs/common';
import { UsersService } from './users.service';
import { CreateUserDto } from './dto/create-user.dto';
import { UpdateUserDto } from './dto/update-user.dto';

@Controller('users')
export class UsersController {
  constructor(private readonly usersService: UsersService) {}

  @Get()
  findAll(@Query('page') page: number = 1, @Query('limit') limit: number = 10) {
    return this.usersService.findAll(page, limit);
  }

  @Get(':id')
  findOne(@Param('id') id: string) {
    return this.usersService.findOne(+id);
  }

  @Post()
  @HttpCode(HttpStatus.CREATED)
  create(@Body() createUserDto: CreateUserDto) {
    return this.usersService.create(createUserDto);
  }

  @Put(':id')
  update(@Param('id') id: string, @Body() updateUserDto: UpdateUserDto) {
    return this.usersService.update(+id, updateUserDto);
  }

  @Delete(':id')
  @HttpCode(HttpStatus.NO_CONTENT)
  remove(@Param('id') id: string) {
    return this.usersService.remove(+id);
  }
}
</code></pre>
<h3 id="advanced-controller-features"><a class="header" href="#advanced-controller-features">Advanced Controller Features</a></h3>
<pre><code class="language-typescript">import {
  Controller,
  Get,
  Post,
  UseGuards,
  UseInterceptors,
  UsePipes,
  Req,
  Res,
  Headers,
  Session
} from '@nestjs/common';
import { Request, Response } from 'express';
import { AuthGuard } from '@nestjs/passport';
import { LoggingInterceptor } from '../common/interceptors/logging.interceptor';
import { ValidationPipe } from '@nestjs/common';

@Controller('products')
@UseGuards(AuthGuard('jwt'))
@UseInterceptors(LoggingInterceptor)
export class ProductsController {
  @Get()
  async findAll(@Req() request: Request, @Headers('authorization') auth: string) {
    return {
      data: [],
      user: request.user,
    };
  }

  @Post()
  @UsePipes(new ValidationPipe({ transform: true }))
  async create(@Body() body: any, @Res() response: Response) {
    const result = await this.createProduct(body);
    return response.status(201).json(result);
  }

  @Get('download')
  async download(@Res() res: Response) {
    res.download('./files/report.pdf');
  }
}
</code></pre>
<hr />
<h2 id="providers-and-dependency-injection"><a class="header" href="#providers-and-dependency-injection">Providers and Dependency Injection</a></h2>
<p>Providers are the fundamental concept in NestJS. Services, repositories, factories, and helpers can all be providers.</p>
<h3 id="basic-service"><a class="header" href="#basic-service">Basic Service</a></h3>
<pre><code class="language-typescript">import { Injectable, NotFoundException } from '@nestjs/common';
import { CreateUserDto } from './dto/create-user.dto';
import { UpdateUserDto } from './dto/update-user.dto';

@Injectable()
export class UsersService {
  private users = [];

  findAll(page: number, limit: number) {
    const start = (page - 1) * limit;
    const end = start + limit;

    return {
      data: this.users.slice(start, end),
      total: this.users.length,
      page,
      limit,
    };
  }

  findOne(id: number) {
    const user = this.users.find(u =&gt; u.id === id);
    if (!user) {
      throw new NotFoundException(`User with ID ${id} not found`);
    }
    return user;
  }

  create(createUserDto: CreateUserDto) {
    const user = {
      id: this.users.length + 1,
      ...createUserDto,
      createdAt: new Date(),
    };
    this.users.push(user);
    return user;
  }

  update(id: number, updateUserDto: UpdateUserDto) {
    const user = this.findOne(id);
    Object.assign(user, updateUserDto);
    return user;
  }

  remove(id: number) {
    const index = this.users.findIndex(u =&gt; u.id === id);
    if (index === -1) {
      throw new NotFoundException(`User with ID ${id} not found`);
    }
    this.users.splice(index, 1);
  }
}
</code></pre>
<h3 id="custom-provider"><a class="header" href="#custom-provider">Custom Provider</a></h3>
<pre><code class="language-typescript">// Value provider
const configProvider = {
  provide: 'CONFIG',
  useValue: {
    apiKey: process.env.API_KEY,
    apiUrl: process.env.API_URL,
  },
};

// Factory provider
const databaseProvider = {
  provide: 'DATABASE_CONNECTION',
  useFactory: async () =&gt; {
    const connection = await createConnection({
      type: 'postgres',
      host: 'localhost',
      port: 5432,
    });
    return connection;
  },
};

// Class provider
const loggerProvider = {
  provide: 'LOGGER',
  useClass: CustomLogger,
};

// Usage in module
@Module({
  providers: [configProvider, databaseProvider, loggerProvider],
})
export class AppModule {}
</code></pre>
<h3 id="dependency-injection"><a class="header" href="#dependency-injection">Dependency Injection</a></h3>
<pre><code class="language-typescript">import { Injectable, Inject } from '@nestjs/common';

@Injectable()
export class ProductsService {
  constructor(
    @Inject('CONFIG') private config: any,
    @Inject('DATABASE_CONNECTION') private db: any,
    private readonly usersService: UsersService,
  ) {}

  async findAll() {
    const apiUrl = this.config.apiUrl;
    const users = await this.usersService.findAll(1, 10);
    const products = await this.db.query('SELECT * FROM products');
    return products;
  }
}
</code></pre>
<hr />
<h2 id="modules-1"><a class="header" href="#modules-1">Modules</a></h2>
<p>Modules organize the application structure and enable modular architecture.</p>
<h3 id="feature-module"><a class="header" href="#feature-module">Feature Module</a></h3>
<pre><code class="language-typescript">import { Module } from '@nestjs/common';
import { UsersController } from './users.controller';
import { UsersService } from './users.service';
import { TypeOrmModule } from '@nestjs/typeorm';
import { User } from './entities/user.entity';

@Module({
  imports: [TypeOrmModule.forFeature([User])],
  controllers: [UsersController],
  providers: [UsersService],
  exports: [UsersService], // Export to use in other modules
})
export class UsersModule {}
</code></pre>
<h3 id="root-module"><a class="header" href="#root-module">Root Module</a></h3>
<pre><code class="language-typescript">import { Module } from '@nestjs/common';
import { ConfigModule } from '@nestjs/config';
import { TypeOrmModule } from '@nestjs/typeorm';
import { UsersModule } from './modules/users/users.module';
import { AuthModule } from './modules/auth/auth.module';
import { ProductsModule } from './modules/products/products.module';

@Module({
  imports: [
    ConfigModule.forRoot({
      isGlobal: true,
      envFilePath: '.env',
    }),
    TypeOrmModule.forRoot({
      type: 'postgres',
      host: process.env.DB_HOST,
      port: parseInt(process.env.DB_PORT),
      username: process.env.DB_USERNAME,
      password: process.env.DB_PASSWORD,
      database: process.env.DB_NAME,
      autoLoadEntities: true,
      synchronize: process.env.NODE_ENV !== 'production',
    }),
    UsersModule,
    AuthModule,
    ProductsModule,
  ],
})
export class AppModule {}
</code></pre>
<h3 id="global-module"><a class="header" href="#global-module">Global Module</a></h3>
<pre><code class="language-typescript">import { Module, Global } from '@nestjs/common';
import { LoggerService } from './logger.service';

@Global()
@Module({
  providers: [LoggerService],
  exports: [LoggerService],
})
export class LoggerModule {}
</code></pre>
<h3 id="dynamic-module"><a class="header" href="#dynamic-module">Dynamic Module</a></h3>
<pre><code class="language-typescript">import { Module, DynamicModule } from '@nestjs/common';
import { DatabaseService } from './database.service';

@Module({})
export class DatabaseModule {
  static forRoot(options: DatabaseOptions): DynamicModule {
    return {
      module: DatabaseModule,
      providers: [
        {
          provide: 'DATABASE_OPTIONS',
          useValue: options,
        },
        DatabaseService,
      ],
      exports: [DatabaseService],
    };
  }
}

// Usage
@Module({
  imports: [
    DatabaseModule.forRoot({
      host: 'localhost',
      port: 5432,
    }),
  ],
})
export class AppModule {}
</code></pre>
<hr />
<h2 id="middleware-1"><a class="header" href="#middleware-1">Middleware</a></h2>
<p>Middleware functions execute before the route handler.</p>
<h3 id="functional-middleware"><a class="header" href="#functional-middleware">Functional Middleware</a></h3>
<pre><code class="language-typescript">import { Request, Response, NextFunction } from 'express';

export function logger(req: Request, res: Response, next: NextFunction) {
  console.log(`[${new Date().toISOString()}] ${req.method} ${req.url}`);
  next();
}
</code></pre>
<h3 id="class-based-middleware"><a class="header" href="#class-based-middleware">Class-based Middleware</a></h3>
<pre><code class="language-typescript">import { Injectable, NestMiddleware } from '@nestjs/common';
import { Request, Response, NextFunction } from 'express';

@Injectable()
export class LoggerMiddleware implements NestMiddleware {
  use(req: Request, res: Response, next: NextFunction) {
    console.log(`[${new Date().toISOString()}] ${req.method} ${req.url}`);
    next();
  }
}

// Apply in module
import { Module, NestModule, MiddlewareConsumer } from '@nestjs/common';

@Module({})
export class AppModule implements NestModule {
  configure(consumer: MiddlewareConsumer) {
    consumer
      .apply(LoggerMiddleware)
      .forRoutes('*'); // Apply to all routes

    // Or specific routes
    consumer
      .apply(LoggerMiddleware)
      .forRoutes({ path: 'users', method: RequestMethod.GET });
  }
}
</code></pre>
<hr />
<h2 id="exception-filters"><a class="header" href="#exception-filters">Exception Filters</a></h2>
<p>Exception filters handle all thrown exceptions.</p>
<h3 id="custom-exception-filter"><a class="header" href="#custom-exception-filter">Custom Exception Filter</a></h3>
<pre><code class="language-typescript">import {
  ExceptionFilter,
  Catch,
  ArgumentsHost,
  HttpException,
  HttpStatus
} from '@nestjs/common';
import { Request, Response } from 'express';

@Catch(HttpException)
export class HttpExceptionFilter implements ExceptionFilter {
  catch(exception: HttpException, host: ArgumentsHost) {
    const ctx = host.switchToHttp();
    const response = ctx.getResponse&lt;Response&gt;();
    const request = ctx.getRequest&lt;Request&gt;();
    const status = exception.getStatus();
    const exceptionResponse = exception.getResponse();

    response.status(status).json({
      statusCode: status,
      timestamp: new Date().toISOString(),
      path: request.url,
      method: request.method,
      message: exceptionResponse['message'] || exception.message,
    });
  }
}

// Apply globally
app.useGlobalFilters(new HttpExceptionFilter());

// Or use in controller
@Controller('users')
@UseFilters(HttpExceptionFilter)
export class UsersController {}
</code></pre>
<h3 id="all-exceptions-filter"><a class="header" href="#all-exceptions-filter">All Exceptions Filter</a></h3>
<pre><code class="language-typescript">@Catch()
export class AllExceptionsFilter implements ExceptionFilter {
  catch(exception: unknown, host: ArgumentsHost) {
    const ctx = host.switchToHttp();
    const response = ctx.getResponse&lt;Response&gt;();
    const request = ctx.getRequest&lt;Request&gt;();

    const status =
      exception instanceof HttpException
        ? exception.getStatus()
        : HttpStatus.INTERNAL_SERVER_ERROR;

    const message =
      exception instanceof HttpException
        ? exception.message
        : 'Internal server error';

    response.status(status).json({
      statusCode: status,
      timestamp: new Date().toISOString(),
      path: request.url,
      message,
    });
  }
}
</code></pre>
<hr />
<h2 id="pipes"><a class="header" href="#pipes">Pipes</a></h2>
<p>Pipes transform input data or validate it before it reaches the route handler.</p>
<h3 id="built-in-validation"><a class="header" href="#built-in-validation">Built-in Validation</a></h3>
<pre><code class="language-typescript">import { IsString, IsEmail, IsInt, Min, Max, IsOptional } from 'class-validator';

export class CreateUserDto {
  @IsString()
  @Length(3, 50)
  name: string;

  @IsEmail()
  email: string;

  @IsInt()
  @Min(18)
  @Max(120)
  age: number;

  @IsString()
  @IsOptional()
  bio?: string;
}

// Controller
@Post()
create(@Body() createUserDto: CreateUserDto) {
  return this.usersService.create(createUserDto);
}
</code></pre>
<h3 id="custom-pipe"><a class="header" href="#custom-pipe">Custom Pipe</a></h3>
<pre><code class="language-typescript">import { PipeTransform, Injectable, ArgumentMetadata, BadRequestException } from '@nestjs/common';

@Injectable()
export class ParseIntPipe implements PipeTransform&lt;string, number&gt; {
  transform(value: string, metadata: ArgumentMetadata): number {
    const val = parseInt(value, 10);
    if (isNaN(val)) {
      throw new BadRequestException('Validation failed');
    }
    return val;
  }
}

// Usage
@Get(':id')
findOne(@Param('id', ParseIntPipe) id: number) {
  return this.usersService.findOne(id);
}
</code></pre>
<h3 id="transformation-pipe"><a class="header" href="#transformation-pipe">Transformation Pipe</a></h3>
<pre><code class="language-typescript">import { PipeTransform, Injectable, ArgumentMetadata } from '@nestjs/common';

@Injectable()
export class TrimPipe implements PipeTransform {
  transform(value: any, metadata: ArgumentMetadata) {
    if (typeof value === 'string') {
      return value.trim();
    }
    if (typeof value === 'object') {
      Object.keys(value).forEach(key =&gt; {
        if (typeof value[key] === 'string') {
          value[key] = value[key].trim();
        }
      });
    }
    return value;
  }
}
</code></pre>
<hr />
<h2 id="guards"><a class="header" href="#guards">Guards</a></h2>
<p>Guards determine whether a request should be handled by the route handler.</p>
<h3 id="authentication-guard"><a class="header" href="#authentication-guard">Authentication Guard</a></h3>
<pre><code class="language-typescript">import { Injectable, CanActivate, ExecutionContext, UnauthorizedException } from '@nestjs/common';
import { JwtService } from '@nestjs/jwt';

@Injectable()
export class AuthGuard implements CanActivate {
  constructor(private jwtService: JwtService) {}

  async canActivate(context: ExecutionContext): Promise&lt;boolean&gt; {
    const request = context.switchToHttp().getRequest();
    const token = this.extractTokenFromHeader(request);

    if (!token) {
      throw new UnauthorizedException('No token provided');
    }

    try {
      const payload = await this.jwtService.verifyAsync(token);
      request.user = payload;
      return true;
    } catch {
      throw new UnauthorizedException('Invalid token');
    }
  }

  private extractTokenFromHeader(request: any): string | undefined {
    const [type, token] = request.headers.authorization?.split(' ') ?? [];
    return type === 'Bearer' ? token : undefined;
  }
}
</code></pre>
<h3 id="roles-guard"><a class="header" href="#roles-guard">Roles Guard</a></h3>
<pre><code class="language-typescript">import { Injectable, CanActivate, ExecutionContext } from '@nestjs/common';
import { Reflector } from '@nestjs/core';
import { SetMetadata } from '@nestjs/common';

export const ROLES_KEY = 'roles';
export const Roles = (...roles: string[]) =&gt; SetMetadata(ROLES_KEY, roles);

@Injectable()
export class RolesGuard implements CanActivate {
  constructor(private reflector: Reflector) {}

  canActivate(context: ExecutionContext): boolean {
    const requiredRoles = this.reflector.getAllAndOverride&lt;string[]&gt;(ROLES_KEY, [
      context.getHandler(),
      context.getClass(),
    ]);

    if (!requiredRoles) {
      return true;
    }

    const { user } = context.switchToHttp().getRequest();
    return requiredRoles.some((role) =&gt; user.roles?.includes(role));
  }
}

// Usage
@Controller('admin')
@UseGuards(AuthGuard, RolesGuard)
export class AdminController {
  @Get()
  @Roles('admin')
  findAll() {
    return 'This route is only for admins';
  }
}
</code></pre>
<hr />
<h2 id="interceptors"><a class="header" href="#interceptors">Interceptors</a></h2>
<p>Interceptors can transform the result returned from a function or extend basic function behavior.</p>
<h3 id="logging-interceptor"><a class="header" href="#logging-interceptor">Logging Interceptor</a></h3>
<pre><code class="language-typescript">import {
  Injectable,
  NestInterceptor,
  ExecutionContext,
  CallHandler,
} from '@nestjs/common';
import { Observable } from 'rxjs';
import { tap } from 'rxjs/operators';

@Injectable()
export class LoggingInterceptor implements NestInterceptor {
  intercept(context: ExecutionContext, next: CallHandler): Observable&lt;any&gt; {
    const now = Date.now();
    const request = context.switchToHttp().getRequest();
    const method = request.method;
    const url = request.url;

    return next.handle().pipe(
      tap(() =&gt; {
        const responseTime = Date.now() - now;
        console.log(`${method} ${url} - ${responseTime}ms`);
      }),
    );
  }
}
</code></pre>
<h3 id="transform-interceptor"><a class="header" href="#transform-interceptor">Transform Interceptor</a></h3>
<pre><code class="language-typescript">import {
  Injectable,
  NestInterceptor,
  ExecutionContext,
  CallHandler,
} from '@nestjs/common';
import { Observable } from 'rxjs';
import { map } from 'rxjs/operators';

export interface Response&lt;T&gt; {
  data: T;
  statusCode: number;
  timestamp: string;
}

@Injectable()
export class TransformInterceptor&lt;T&gt; implements NestInterceptor&lt;T, Response&lt;T&gt;&gt; {
  intercept(context: ExecutionContext, next: CallHandler): Observable&lt;Response&lt;T&gt;&gt; {
    return next.handle().pipe(
      map(data =&gt; ({
        data,
        statusCode: context.switchToHttp().getResponse().statusCode,
        timestamp: new Date().toISOString(),
      })),
    );
  }
}
</code></pre>
<h3 id="caching-interceptor"><a class="header" href="#caching-interceptor">Caching Interceptor</a></h3>
<pre><code class="language-typescript">import {
  Injectable,
  NestInterceptor,
  ExecutionContext,
  CallHandler,
} from '@nestjs/common';
import { Observable, of } from 'rxjs';
import { tap } from 'rxjs/operators';

@Injectable()
export class CacheInterceptor implements NestInterceptor {
  private cache = new Map();

  intercept(context: ExecutionContext, next: CallHandler): Observable&lt;any&gt; {
    const request = context.switchToHttp().getRequest();
    const key = request.url;

    if (this.cache.has(key)) {
      return of(this.cache.get(key));
    }

    return next.handle().pipe(
      tap(response =&gt; {
        this.cache.set(key, response);
      }),
    );
  }
}
</code></pre>
<hr />
<h2 id="database-integration-1"><a class="header" href="#database-integration-1">Database Integration</a></h2>
<h3 id="typeorm-integration"><a class="header" href="#typeorm-integration">TypeORM Integration</a></h3>
<p><strong>Installation:</strong></p>
<pre><code class="language-bash">npm install @nestjs/typeorm typeorm pg
</code></pre>
<p><strong>Entity:</strong></p>
<pre><code class="language-typescript">import { Entity, Column, PrimaryGeneratedColumn, CreateDateColumn, UpdateDateColumn } from 'typeorm';

@Entity('users')
export class User {
  @PrimaryGeneratedColumn()
  id: number;

  @Column({ unique: true })
  email: string;

  @Column()
  name: string;

  @Column()
  password: string;

  @Column({ default: true })
  isActive: boolean;

  @CreateDateColumn()
  createdAt: Date;

  @UpdateDateColumn()
  updatedAt: Date;
}
</code></pre>
<p><strong>Service with Repository:</strong></p>
<pre><code class="language-typescript">import { Injectable } from '@nestjs/common';
import { InjectRepository } from '@nestjs/typeorm';
import { Repository } from 'typeorm';
import { User } from './entities/user.entity';
import { CreateUserDto } from './dto/create-user.dto';

@Injectable()
export class UsersService {
  constructor(
    @InjectRepository(User)
    private usersRepository: Repository&lt;User&gt;,
  ) {}

  async findAll(): Promise&lt;User[]&gt; {
    return this.usersRepository.find();
  }

  async findOne(id: number): Promise&lt;User&gt; {
    return this.usersRepository.findOne({ where: { id } });
  }

  async create(createUserDto: CreateUserDto): Promise&lt;User&gt; {
    const user = this.usersRepository.create(createUserDto);
    return this.usersRepository.save(user);
  }

  async update(id: number, updateData: Partial&lt;User&gt;): Promise&lt;User&gt; {
    await this.usersRepository.update(id, updateData);
    return this.findOne(id);
  }

  async remove(id: number): Promise&lt;void&gt; {
    await this.usersRepository.delete(id);
  }
}
</code></pre>
<h3 id="prisma-integration"><a class="header" href="#prisma-integration">Prisma Integration</a></h3>
<p><strong>Installation:</strong></p>
<pre><code class="language-bash">npm install @prisma/client
npm install -D prisma
npx prisma init
</code></pre>
<p><strong>Prisma Service:</strong></p>
<pre><code class="language-typescript">import { Injectable, OnModuleInit, OnModuleDestroy } from '@nestjs/common';
import { PrismaClient } from '@prisma/client';

@Injectable()
export class PrismaService extends PrismaClient implements OnModuleInit, OnModuleDestroy {
  async onModuleInit() {
    await this.$connect();
  }

  async onModuleDestroy() {
    await this.$disconnect();
  }
}
</code></pre>
<hr />
<h2 id="authentication-and-authorization"><a class="header" href="#authentication-and-authorization">Authentication and Authorization</a></h2>
<h3 id="jwt-authentication-1"><a class="header" href="#jwt-authentication-1">JWT Authentication</a></h3>
<p><strong>Installation:</strong></p>
<pre><code class="language-bash">npm install @nestjs/jwt @nestjs/passport passport passport-jwt
npm install -D @types/passport-jwt
</code></pre>
<p><strong>Auth Module:</strong></p>
<pre><code class="language-typescript">import { Module } from '@nestjs/common';
import { JwtModule } from '@nestjs/jwt';
import { PassportModule } from '@nestjs/passport';
import { AuthService } from './auth.service';
import { AuthController } from './auth.controller';
import { JwtStrategy } from './strategies/jwt.strategy';
import { UsersModule } from '../users/users.module';

@Module({
  imports: [
    UsersModule,
    PassportModule,
    JwtModule.register({
      secret: process.env.JWT_SECRET,
      signOptions: { expiresIn: '1d' },
    }),
  ],
  controllers: [AuthController],
  providers: [AuthService, JwtStrategy],
  exports: [AuthService],
})
export class AuthModule {}
</code></pre>
<p><strong>Auth Service:</strong></p>
<pre><code class="language-typescript">import { Injectable, UnauthorizedException } from '@nestjs/common';
import { JwtService } from '@nestjs/jwt';
import { UsersService } from '../users/users.service';
import * as bcrypt from 'bcrypt';

@Injectable()
export class AuthService {
  constructor(
    private usersService: UsersService,
    private jwtService: JwtService,
  ) {}

  async signIn(email: string, password: string) {
    const user = await this.usersService.findByEmail(email);

    if (!user) {
      throw new UnauthorizedException('Invalid credentials');
    }

    const isPasswordValid = await bcrypt.compare(password, user.password);

    if (!isPasswordValid) {
      throw new UnauthorizedException('Invalid credentials');
    }

    const payload = { sub: user.id, email: user.email };

    return {
      access_token: await this.jwtService.signAsync(payload),
      user: {
        id: user.id,
        email: user.email,
        name: user.name,
      },
    };
  }

  async signUp(email: string, password: string, name: string) {
    const hashedPassword = await bcrypt.hash(password, 10);

    const user = await this.usersService.create({
      email,
      password: hashedPassword,
      name,
    });

    const payload = { sub: user.id, email: user.email };

    return {
      access_token: await this.jwtService.signAsync(payload),
      user: {
        id: user.id,
        email: user.email,
        name: user.name,
      },
    };
  }
}
</code></pre>
<p><strong>JWT Strategy:</strong></p>
<pre><code class="language-typescript">import { Injectable } from '@nestjs/common';
import { PassportStrategy } from '@nestjs/passport';
import { ExtractJwt, Strategy } from 'passport-jwt';

@Injectable()
export class JwtStrategy extends PassportStrategy(Strategy) {
  constructor() {
    super({
      jwtFromRequest: ExtractJwt.fromAuthHeaderAsBearerToken(),
      ignoreExpiration: false,
      secretOrKey: process.env.JWT_SECRET,
    });
  }

  async validate(payload: any) {
    return { userId: payload.sub, email: payload.email };
  }
}
</code></pre>
<hr />
<h2 id="graphql"><a class="header" href="#graphql">GraphQL</a></h2>
<p><strong>Installation:</strong></p>
<pre><code class="language-bash">npm install @nestjs/graphql @nestjs/apollo @apollo/server graphql
</code></pre>
<p><strong>Configuration:</strong></p>
<pre><code class="language-typescript">import { Module } from '@nestjs/common';
import { GraphQLModule } from '@nestjs/graphql';
import { ApolloDriver, ApolloDriverConfig } from '@nestjs/apollo';

@Module({
  imports: [
    GraphQLModule.forRoot&lt;ApolloDriverConfig&gt;({
      driver: ApolloDriver,
      autoSchemaFile: true,
      playground: true,
    }),
  ],
})
export class AppModule {}
</code></pre>
<p><strong>Resolver:</strong></p>
<pre><code class="language-typescript">import { Resolver, Query, Mutation, Args, Int } from '@nestjs/graphql';
import { User } from './models/user.model';
import { UsersService } from './users.service';
import { CreateUserInput } from './dto/create-user.input';

@Resolver(() =&gt; User)
export class UsersResolver {
  constructor(private usersService: UsersService) {}

  @Query(() =&gt; [User], { name: 'users' })
  findAll() {
    return this.usersService.findAll();
  }

  @Query(() =&gt; User, { name: 'user' })
  findOne(@Args('id', { type: () =&gt; Int }) id: number) {
    return this.usersService.findOne(id);
  }

  @Mutation(() =&gt; User)
  createUser(@Args('createUserInput') createUserInput: CreateUserInput) {
    return this.usersService.create(createUserInput);
  }
}
</code></pre>
<hr />
<h2 id="microservices"><a class="header" href="#microservices">Microservices</a></h2>
<h3 id="tcp-microservice"><a class="header" href="#tcp-microservice">TCP Microservice</a></h3>
<p><strong>Server:</strong></p>
<pre><code class="language-typescript">import { NestFactory } from '@nestjs/core';
import { Transport, MicroserviceOptions } from '@nestjs/microservices';
import { AppModule } from './app.module';

async function bootstrap() {
  const app = await NestFactory.createMicroservice&lt;MicroserviceOptions&gt;(AppModule, {
    transport: Transport.TCP,
    options: {
      host: '127.0.0.1',
      port: 8877,
    },
  });

  await app.listen();
}

bootstrap();
</code></pre>
<p><strong>Controller:</strong></p>
<pre><code class="language-typescript">import { Controller } from '@nestjs/common';
import { MessagePattern, Payload } from '@nestjs/microservices';

@Controller()
export class MathController {
  @MessagePattern({ cmd: 'sum' })
  accumulate(@Payload() data: number[]): number {
    return (data || []).reduce((a, b) =&gt; a + b);
  }
}
</code></pre>
<p><strong>Client:</strong></p>
<pre><code class="language-typescript">import { Injectable } from '@nestjs/common';
import { ClientProxy, ClientProxyFactory, Transport } from '@nestjs/microservices';

@Injectable()
export class AppService {
  private client: ClientProxy;

  constructor() {
    this.client = ClientProxyFactory.create({
      transport: Transport.TCP,
      options: {
        host: '127.0.0.1',
        port: 8877,
      },
    });
  }

  async accumulate() {
    const pattern = { cmd: 'sum' };
    const payload = [1, 2, 3];
    return this.client.send&lt;number&gt;(pattern, payload);
  }
}
</code></pre>
<hr />
<h2 id="testing-7"><a class="header" href="#testing-7">Testing</a></h2>
<h3 id="unit-testing"><a class="header" href="#unit-testing">Unit Testing</a></h3>
<pre><code class="language-typescript">import { Test, TestingModule } from '@nestjs/testing';
import { UsersService } from './users.service';
import { getRepositoryToken } from '@nestjs/typeorm';
import { User } from './entities/user.entity';

describe('UsersService', () =&gt; {
  let service: UsersService;

  const mockUserRepository = {
    find: jest.fn(),
    findOne: jest.fn(),
    create: jest.fn(),
    save: jest.fn(),
    update: jest.fn(),
    delete: jest.fn(),
  };

  beforeEach(async () =&gt; {
    const module: TestingModule = await Test.createTestingModule({
      providers: [
        UsersService,
        {
          provide: getRepositoryToken(User),
          useValue: mockUserRepository,
        },
      ],
    }).compile();

    service = module.get&lt;UsersService&gt;(UsersService);
  });

  it('should be defined', () =&gt; {
    expect(service).toBeDefined();
  });

  describe('findAll', () =&gt; {
    it('should return an array of users', async () =&gt; {
      const users = [{ id: 1, name: 'John' }];
      mockUserRepository.find.mockResolvedValue(users);

      const result = await service.findAll();
      expect(result).toEqual(users);
      expect(mockUserRepository.find).toHaveBeenCalled();
    });
  });
});
</code></pre>
<h3 id="e2e-testing"><a class="header" href="#e2e-testing">E2E Testing</a></h3>
<pre><code class="language-typescript">import { Test, TestingModule } from '@nestjs/testing';
import { INestApplication } from '@nestjs/common';
import * as request from 'supertest';
import { AppModule } from './../src/app.module';

describe('UsersController (e2e)', () =&gt; {
  let app: INestApplication;

  beforeAll(async () =&gt; {
    const moduleFixture: TestingModule = await Test.createTestingModule({
      imports: [AppModule],
    }).compile();

    app = moduleFixture.createNestApplication();
    await app.init();
  });

  afterAll(async () =&gt; {
    await app.close();
  });

  it('/users (GET)', () =&gt; {
    return request(app.getHttpServer())
      .get('/users')
      .expect(200)
      .expect('Content-Type', /json/);
  });

  it('/users (POST)', () =&gt; {
    return request(app.getHttpServer())
      .post('/users')
      .send({
        name: 'John Doe',
        email: 'john@example.com',
      })
      .expect(201)
      .then(response =&gt; {
        expect(response.body).toHaveProperty('id');
        expect(response.body.name).toBe('John Doe');
      });
  });
});
</code></pre>
<hr />
<h2 id="best-practices-80"><a class="header" href="#best-practices-80">Best Practices</a></h2>
<h3 id="1-module-organization"><a class="header" href="#1-module-organization">1. Module Organization</a></h3>
<pre><code class="language-typescript">// Feature-based organization
src/
├── modules/
│   ├── users/
│   │   ├── dto/
│   │   ├── entities/
│   │   ├── users.controller.ts
│   │   ├── users.service.ts
│   │   ├── users.module.ts
│   │   └── users.controller.spec.ts
│   └── products/
└── common/
    ├── guards/
    ├── interceptors/
    ├── pipes/
    └── decorators/
</code></pre>
<h3 id="2-dtos-and-validation"><a class="header" href="#2-dtos-and-validation">2. DTOs and Validation</a></h3>
<pre><code class="language-typescript">import { IsString, IsEmail, IsOptional, MinLength } from 'class-validator';
import { ApiProperty, ApiPropertyOptional } from '@nestjs/swagger';

export class CreateUserDto {
  @ApiProperty({ example: 'John Doe' })
  @IsString()
  @MinLength(3)
  name: string;

  @ApiProperty({ example: 'john@example.com' })
  @IsEmail()
  email: string;

  @ApiPropertyOptional()
  @IsString()
  @IsOptional()
  bio?: string;
}
</code></pre>
<h3 id="3-environment-configuration"><a class="header" href="#3-environment-configuration">3. Environment Configuration</a></h3>
<pre><code class="language-typescript">import { ConfigModule, ConfigService } from '@nestjs/config';
import * as Joi from 'joi';

@Module({
  imports: [
    ConfigModule.forRoot({
      validationSchema: Joi.object({
        NODE_ENV: Joi.string()
          .valid('development', 'production', 'test')
          .default('development'),
        PORT: Joi.number().default(3000),
        DATABASE_URL: Joi.string().required(),
        JWT_SECRET: Joi.string().required(),
      }),
    }),
  ],
})
export class AppModule {}
</code></pre>
<h3 id="4-error-handling-1"><a class="header" href="#4-error-handling-1">4. Error Handling</a></h3>
<pre><code class="language-typescript">import { HttpException, HttpStatus } from '@nestjs/common';

export class UserNotFoundException extends HttpException {
  constructor(userId: number) {
    super(`User with ID ${userId} not found`, HttpStatus.NOT_FOUND);
  }
}

// Usage
throw new UserNotFoundException(id);
</code></pre>
<h3 id="5-logging"><a class="header" href="#5-logging">5. Logging</a></h3>
<pre><code class="language-typescript">import { Logger, Injectable } from '@nestjs/common';

@Injectable()
export class UsersService {
  private readonly logger = new Logger(UsersService.name);

  async findAll() {
    this.logger.log('Fetching all users');
    try {
      const users = await this.usersRepository.find();
      this.logger.log(`Found ${users.length} users`);
      return users;
    } catch (error) {
      this.logger.error('Failed to fetch users', error.stack);
      throw error;
    }
  }
}
</code></pre>
<hr />
<h2 id="production-deployment-1"><a class="header" href="#production-deployment-1">Production Deployment</a></h2>
<h3 id="environment-variables-3"><a class="header" href="#environment-variables-3">Environment Variables</a></h3>
<p><strong>.env.production:</strong></p>
<pre><code class="language-bash">NODE_ENV=production
PORT=3000
DATABASE_URL=postgresql://user:password@localhost:5432/mydb
JWT_SECRET=your-secret-key
REDIS_URL=redis://localhost:6379
</code></pre>
<h3 id="docker-deployment-1"><a class="header" href="#docker-deployment-1">Docker Deployment</a></h3>
<p><strong>Dockerfile:</strong></p>
<pre><code class="language-dockerfile">FROM node:18-alpine AS builder

WORKDIR /app

COPY package*.json ./
RUN npm ci

COPY . .
RUN npm run build

FROM node:18-alpine

WORKDIR /app

COPY package*.json ./
RUN npm ci --only=production

COPY --from=builder /app/dist ./dist

EXPOSE 3000

CMD ["node", "dist/main"]
</code></pre>
<p><strong>docker-compose.yml:</strong></p>
<pre><code class="language-yaml">version: '3.8'

services:
  app:
    build: .
    ports:
      - "3000:3000"
    environment:
      - NODE_ENV=production
      - DATABASE_URL=postgresql://postgres:password@db:5432/mydb
    depends_on:
      - db
      - redis

  db:
    image: postgres:15-alpine
    environment:
      POSTGRES_PASSWORD: password
      POSTGRES_DB: mydb
    volumes:
      - postgres_data:/var/lib/postgresql/data

  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"

volumes:
  postgres_data:
</code></pre>
<h3 id="pm2-deployment"><a class="header" href="#pm2-deployment">PM2 Deployment</a></h3>
<p><strong>ecosystem.config.js:</strong></p>
<pre><code class="language-javascript">module.exports = {
  apps: [{
    name: 'nest-app',
    script: 'dist/main.js',
    instances: 'max',
    exec_mode: 'cluster',
    env: {
      NODE_ENV: 'production',
    },
  }],
};
</code></pre>
<h3 id="health-checks"><a class="header" href="#health-checks">Health Checks</a></h3>
<pre><code class="language-typescript">import { Controller, Get } from '@nestjs/common';
import {
  HealthCheckService,
  HealthCheck,
  TypeOrmHealthIndicator,
  MemoryHealthIndicator
} from '@nestjs/terminus';

@Controller('health')
export class HealthController {
  constructor(
    private health: HealthCheckService,
    private db: TypeOrmHealthIndicator,
    private memory: MemoryHealthIndicator,
  ) {}

  @Get()
  @HealthCheck()
  check() {
    return this.health.check([
      () =&gt; this.db.pingCheck('database'),
      () =&gt; this.memory.checkHeap('memory_heap', 150 * 1024 * 1024),
    ]);
  }
}
</code></pre>
<h3 id="performance-optimization-8"><a class="header" href="#performance-optimization-8">Performance Optimization</a></h3>
<pre><code class="language-typescript">// Enable compression
import * as compression from 'compression';
app.use(compression());

// Enable helmet for security
import helmet from 'helmet';
app.use(helmet());

// Rate limiting
import { ThrottlerModule } from '@nestjs/throttler';
@Module({
  imports: [
    ThrottlerModule.forRoot({
      ttl: 60,
      limit: 10,
    }),
  ],
})

// Caching
import { CacheModule } from '@nestjs/cache-manager';
@Module({
  imports: [
    CacheModule.register({
      ttl: 5,
      max: 100,
    }),
  ],
})
</code></pre>
<hr />
<h2 id="resources-42"><a class="header" href="#resources-42">Resources</a></h2>
<p><strong>Official Documentation:</strong></p>
<ul>
<li><a href="https://docs.nestjs.com/">NestJS Documentation</a></li>
<li><a href="https://docs.nestjs.com/recipes/documentation">NestJS Recipes</a></li>
<li><a href="https://docs.nestjs.com/openapi/introduction">NestJS OpenAPI</a></li>
</ul>
<p><strong>Learning Resources:</strong></p>
<ul>
<li><a href="https://courses.nestjs.com/">NestJS Official Courses</a></li>
<li><a href="https://learn.nestjs.com/">NestJS Fundamentals</a></li>
<li><a href="https://github.com/nestjs/awesome-nestjs">Awesome NestJS</a></li>
</ul>
<p><strong>Community:</strong></p>
<ul>
<li><a href="https://discord.gg/nestjs">NestJS Discord</a></li>
<li><a href="https://stackoverflow.com/questions/tagged/nestjs">Stack Overflow</a></li>
<li><a href="https://github.com/nestjs/nest">GitHub Repository</a></li>
</ul>
<p><strong>Tools:</strong></p>
<ul>
<li><a href="https://docs.nestjs.com/cli/overview">NestJS CLI</a></li>
<li><a href="https://swagger.io/tools/swagger-ui/">Swagger UI</a></li>
<li><a href="https://typeorm.io/">TypeORM</a></li>
<li><a href="https://www.prisma.io/">Prisma</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="django"><a class="header" href="#django">Django</a></h1>
<p>Django is a high-level Python web framework that encourages rapid development and clean, pragmatic design. Built by experienced developers, it takes care of much of the hassle of web development, so you can focus on writing your app without needing to reinvent the wheel. It follows the "batteries-included" philosophy and provides a complete solution for web development.</p>
<h2 id="table-of-contents-49"><a class="header" href="#table-of-contents-49">Table of Contents</a></h2>
<ul>
<li><a href="web_development/django.html#introduction">Introduction</a></li>
<li><a href="web_development/django.html#installation-and-setup">Installation and Setup</a></li>
<li><a href="web_development/django.html#project-structure">Project Structure</a></li>
<li><a href="web_development/django.html#models-and-database">Models and Database</a></li>
<li><a href="web_development/django.html#views">Views</a></li>
<li><a href="web_development/django.html#url-routing">URL Routing</a></li>
<li><a href="web_development/django.html#templates">Templates</a></li>
<li><a href="web_development/django.html#forms">Forms</a></li>
<li><a href="web_development/django.html#authentication">Authentication</a></li>
<li><a href="web_development/django.html#django-rest-framework">Django REST Framework</a></li>
<li><a href="web_development/django.html#admin-interface">Admin Interface</a></li>
<li><a href="web_development/django.html#middleware">Middleware</a></li>
<li><a href="web_development/django.html#static-and-media-files">Static and Media Files</a></li>
<li><a href="web_development/django.html#testing">Testing</a></li>
<li><a href="web_development/django.html#best-practices">Best Practices</a></li>
<li><a href="web_development/django.html#production-deployment">Production Deployment</a></li>
</ul>
<hr />
<h2 id="introduction-29"><a class="header" href="#introduction-29">Introduction</a></h2>
<p><strong>Key Features:</strong></p>
<ul>
<li>Object-Relational Mapper (ORM) for database operations</li>
<li>Automatic admin interface</li>
<li>Clean, pragmatic URL design</li>
<li>Template engine for dynamic HTML</li>
<li>Built-in authentication and authorization</li>
<li>Form handling and validation</li>
<li>Security features (CSRF, XSS, SQL injection protection)</li>
<li>Scalable architecture</li>
<li>Excellent documentation</li>
<li>Large ecosystem of packages</li>
</ul>
<p><strong>Use Cases:</strong></p>
<ul>
<li>Content Management Systems (CMS)</li>
<li>E-commerce platforms</li>
<li>Social networks</li>
<li>Data-driven web applications</li>
<li>RESTful APIs</li>
<li>Real-time applications</li>
<li>Scientific computing platforms</li>
<li>Financial applications</li>
</ul>
<p><strong>Philosophy:</strong></p>
<ul>
<li>Don't Repeat Yourself (DRY)</li>
<li>Explicit is better than implicit</li>
<li>Loose coupling and tight cohesion</li>
<li>Convention over configuration</li>
</ul>
<hr />
<h2 id="installation-and-setup-7"><a class="header" href="#installation-and-setup-7">Installation and Setup</a></h2>
<h3 id="prerequisites-2"><a class="header" href="#prerequisites-2">Prerequisites</a></h3>
<pre><code class="language-bash"># Python 3.8+ required
python3 --version
pip --version
</code></pre>
<h3 id="virtual-environment-setup"><a class="header" href="#virtual-environment-setup">Virtual Environment Setup</a></h3>
<pre><code class="language-bash"># Create virtual environment
python3 -m venv venv

# Activate virtual environment
# On Linux/Mac:
source venv/bin/activate
# On Windows:
# venv\Scripts\activate

# Upgrade pip
pip install --upgrade pip
</code></pre>
<h3 id="install-django"><a class="header" href="#install-django">Install Django</a></h3>
<pre><code class="language-bash"># Install Django
pip install django

# Verify installation
django-admin --version

# Install additional packages
pip install python-decouple psycopg2-binary pillow django-cors-headers
</code></pre>
<h3 id="create-new-project-3"><a class="header" href="#create-new-project-3">Create New Project</a></h3>
<pre><code class="language-bash"># Create Django project
django-admin startproject myproject

# Navigate to project
cd myproject

# Create an app
python manage.py startapp myapp

# Run development server
python manage.py runserver

# Server runs on http://127.0.0.1:8000/
</code></pre>
<h3 id="initial-database-setup"><a class="header" href="#initial-database-setup">Initial Database Setup</a></h3>
<pre><code class="language-bash"># Create initial migrations
python manage.py makemigrations

# Apply migrations
python manage.py migrate

# Create superuser
python manage.py createsuperuser
</code></pre>
<hr />
<h2 id="project-structure-6"><a class="header" href="#project-structure-6">Project Structure</a></h2>
<pre><code>myproject/
├── manage.py                   # Command-line utility
├── myproject/                  # Project package
│   ├── __init__.py
│   ├── settings.py            # Project settings
│   ├── urls.py                # URL declarations
│   ├── asgi.py                # ASGI entry point
│   └── wsgi.py                # WSGI entry point
├── myapp/                     # Application package
│   ├── migrations/            # Database migrations
│   ├── __init__.py
│   ├── admin.py               # Admin configuration
│   ├── apps.py                # App configuration
│   ├── models.py              # Data models
│   ├── tests.py               # Tests
│   ├── views.py               # View functions/classes
│   └── urls.py                # App URL patterns
├── templates/                 # HTML templates
├── static/                    # Static files (CSS, JS, images)
├── media/                     # User-uploaded files
└── requirements.txt           # Project dependencies
</code></pre>
<h3 id="settings-configuration"><a class="header" href="#settings-configuration">Settings Configuration</a></h3>
<p><strong>settings.py:</strong></p>
<pre><code class="language-python">import os
from pathlib import Path
from decouple import config

BASE_DIR = Path(__file__).resolve().parent.parent

SECRET_KEY = config('SECRET_KEY', default='your-secret-key-here')

DEBUG = config('DEBUG', default=False, cast=bool)

ALLOWED_HOSTS = config('ALLOWED_HOSTS', default='localhost,127.0.0.1').split(',')

INSTALLED_APPS = [
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    'myapp',  # Your app
    'rest_framework',  # For APIs
    'corsheaders',     # CORS headers
]

MIDDLEWARE = [
    'django.middleware.security.SecurityMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'corsheaders.middleware.CorsMiddleware',
    'django.middleware.common.CommonMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
    'django.middleware.clickjacking.XFrameOptionsMiddleware',
]

ROOT_URLCONF = 'myproject.urls'

TEMPLATES = [
    {
        'BACKEND': 'django.template.backends.django.DjangoTemplates',
        'DIRS': [BASE_DIR / 'templates'],
        'APP_DIRS': True,
        'OPTIONS': {
            'context_processors': [
                'django.template.context_processors.debug',
                'django.template.context_processors.request',
                'django.contrib.auth.context_processors.auth',
                'django.contrib.messages.context_processors.messages',
            ],
        },
    },
]

DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.postgresql',
        'NAME': config('DB_NAME', default='mydb'),
        'USER': config('DB_USER', default='postgres'),
        'PASSWORD': config('DB_PASSWORD', default='password'),
        'HOST': config('DB_HOST', default='localhost'),
        'PORT': config('DB_PORT', default='5432'),
    }
}

STATIC_URL = '/static/'
STATIC_ROOT = BASE_DIR / 'staticfiles'
STATICFILES_DIRS = [BASE_DIR / 'static']

MEDIA_URL = '/media/'
MEDIA_ROOT = BASE_DIR / 'media'
</code></pre>
<hr />
<h2 id="models-and-database"><a class="header" href="#models-and-database">Models and Database</a></h2>
<h3 id="basic-model"><a class="header" href="#basic-model">Basic Model</a></h3>
<pre><code class="language-python">from django.db import models
from django.contrib.auth.models import User

class Category(models.Model):
    name = models.CharField(max_length=100)
    slug = models.SlugField(unique=True)
    description = models.TextField(blank=True)
    created_at = models.DateTimeField(auto_now_add=True)
    updated_at = models.DateTimeField(auto_now=True)

    class Meta:
        verbose_name_plural = "Categories"
        ordering = ['name']

    def __str__(self):
        return self.name

class Product(models.Model):
    STATUS_CHOICES = [
        ('draft', 'Draft'),
        ('published', 'Published'),
        ('archived', 'Archived'),
    ]

    name = models.CharField(max_length=200)
    slug = models.SlugField(unique=True)
    description = models.TextField()
    price = models.DecimalField(max_digits=10, decimal_places=2)
    category = models.ForeignKey(Category, on_delete=models.CASCADE, related_name='products')
    image = models.ImageField(upload_to='products/', blank=True, null=True)
    status = models.CharField(max_length=20, choices=STATUS_CHOICES, default='draft')
    stock = models.IntegerField(default=0)
    created_by = models.ForeignKey(User, on_delete=models.SET_NULL, null=True)
    created_at = models.DateTimeField(auto_now_add=True)
    updated_at = models.DateTimeField(auto_now=True)

    class Meta:
        ordering = ['-created_at']
        indexes = [
            models.Index(fields=['slug']),
            models.Index(fields=['status', 'created_at']),
        ]

    def __str__(self):
        return self.name

    @property
    def is_available(self):
        return self.stock &gt; 0 and self.status == 'published'
</code></pre>
<h3 id="advanced-models"><a class="header" href="#advanced-models">Advanced Models</a></h3>
<pre><code class="language-python">from django.db import models
from django.core.validators import MinValueValidator, MaxValueValidator
from django.utils.text import slugify

class TimestampedModel(models.Model):
    """Abstract base model with timestamp fields"""
    created_at = models.DateTimeField(auto_now_add=True)
    updated_at = models.DateTimeField(auto_now=True)

    class Meta:
        abstract = True

class Review(TimestampedModel):
    product = models.ForeignKey('Product', on_delete=models.CASCADE, related_name='reviews')
    user = models.ForeignKey(User, on_delete=models.CASCADE)
    rating = models.IntegerField(
        validators=[MinValueValidator(1), MaxValueValidator(5)]
    )
    title = models.CharField(max_length=200)
    comment = models.TextField()
    helpful_count = models.IntegerField(default=0)

    class Meta:
        unique_together = ['product', 'user']
        ordering = ['-created_at']

    def __str__(self):
        return f"{self.user.username} - {self.product.name} ({self.rating}★)"

class Order(TimestampedModel):
    ORDER_STATUS = [
        ('pending', 'Pending'),
        ('processing', 'Processing'),
        ('shipped', 'Shipped'),
        ('delivered', 'Delivered'),
        ('cancelled', 'Cancelled'),
    ]

    user = models.ForeignKey(User, on_delete=models.CASCADE, related_name='orders')
    status = models.CharField(max_length=20, choices=ORDER_STATUS, default='pending')
    total_amount = models.DecimalField(max_digits=10, decimal_places=2)
    shipping_address = models.TextField()
    tracking_number = models.CharField(max_length=100, blank=True)

    def __str__(self):
        return f"Order #{self.id} - {self.user.username}"

class OrderItem(models.Model):
    order = models.ForeignKey(Order, on_delete=models.CASCADE, related_name='items')
    product = models.ForeignKey(Product, on_delete=models.PROTECT)
    quantity = models.IntegerField(validators=[MinValueValidator(1)])
    price = models.DecimalField(max_digits=10, decimal_places=2)

    def __str__(self):
        return f"{self.quantity}x {self.product.name}"

    @property
    def subtotal(self):
        return self.quantity * self.price
</code></pre>
<h3 id="queryset-operations"><a class="header" href="#queryset-operations">QuerySet Operations</a></h3>
<pre><code class="language-python">from django.db.models import Q, Count, Avg, Sum

# Basic queries
products = Product.objects.all()
product = Product.objects.get(id=1)
products = Product.objects.filter(status='published')
products = Product.objects.exclude(stock=0)

# Complex queries
products = Product.objects.filter(
    Q(name__icontains='laptop') | Q(description__icontains='laptop'),
    price__gte=500,
    status='published'
).select_related('category').prefetch_related('reviews')

# Aggregation
from django.db.models import Count, Avg
stats = Product.objects.aggregate(
    total_products=Count('id'),
    avg_price=Avg('price'),
    total_stock=Sum('stock')
)

# Annotation
categories = Category.objects.annotate(
    product_count=Count('products'),
    avg_price=Avg('products__price')
).filter(product_count__gt=0)

# Custom managers
class PublishedManager(models.Manager):
    def get_queryset(self):
        return super().get_queryset().filter(status='published')

class Product(models.Model):
    # ... fields ...
    objects = models.Manager()
    published = PublishedManager()

# Usage
published_products = Product.published.all()
</code></pre>
<h3 id="migrations"><a class="header" href="#migrations">Migrations</a></h3>
<pre><code class="language-bash"># Create migrations
python manage.py makemigrations

# Apply migrations
python manage.py migrate

# Show migrations
python manage.py showmigrations

# Revert migration
python manage.py migrate myapp 0001

# Create empty migration
python manage.py makemigrations --empty myapp
</code></pre>
<hr />
<h2 id="views-4"><a class="header" href="#views-4">Views</a></h2>
<h3 id="function-based-views"><a class="header" href="#function-based-views">Function-Based Views</a></h3>
<pre><code class="language-python">from django.shortcuts import render, get_object_or_404, redirect
from django.http import HttpResponse, JsonResponse
from django.contrib.auth.decorators import login_required
from .models import Product, Category
from .forms import ProductForm

def product_list(request):
    products = Product.objects.filter(status='published')
    categories = Category.objects.all()

    context = {
        'products': products,
        'categories': categories,
    }
    return render(request, 'products/list.html', context)

def product_detail(request, slug):
    product = get_object_or_404(Product, slug=slug, status='published')
    related_products = Product.objects.filter(
        category=product.category,
        status='published'
    ).exclude(id=product.id)[:4]

    context = {
        'product': product,
        'related_products': related_products,
    }
    return render(request, 'products/detail.html', context)

@login_required
def product_create(request):
    if request.method == 'POST':
        form = ProductForm(request.POST, request.FILES)
        if form.is_valid():
            product = form.save(commit=False)
            product.created_by = request.user
            product.save()
            return redirect('product_detail', slug=product.slug)
    else:
        form = ProductForm()

    return render(request, 'products/form.html', {'form': form})

def api_products(request):
    products = Product.objects.filter(status='published').values(
        'id', 'name', 'price', 'slug'
    )
    return JsonResponse(list(products), safe=False)
</code></pre>
<h3 id="class-based-views"><a class="header" href="#class-based-views">Class-Based Views</a></h3>
<pre><code class="language-python">from django.views.generic import ListView, DetailView, CreateView, UpdateView, DeleteView
from django.contrib.auth.mixins import LoginRequiredMixin, UserPassesTestMixin
from django.urls import reverse_lazy
from .models import Product

class ProductListView(ListView):
    model = Product
    template_name = 'products/list.html'
    context_object_name = 'products'
    paginate_by = 12

    def get_queryset(self):
        queryset = Product.objects.filter(status='published')

        # Filter by category
        category_slug = self.request.GET.get('category')
        if category_slug:
            queryset = queryset.filter(category__slug=category_slug)

        # Search
        search_query = self.request.GET.get('q')
        if search_query:
            queryset = queryset.filter(
                Q(name__icontains=search_query) |
                Q(description__icontains=search_query)
            )

        return queryset.select_related('category')

    def get_context_data(self, **kwargs):
        context = super().get_context_data(**kwargs)
        context['categories'] = Category.objects.all()
        return context

class ProductDetailView(DetailView):
    model = Product
    template_name = 'products/detail.html'
    context_object_name = 'product'

    def get_queryset(self):
        return Product.objects.filter(status='published').select_related('category')

class ProductCreateView(LoginRequiredMixin, CreateView):
    model = Product
    form_class = ProductForm
    template_name = 'products/form.html'
    success_url = reverse_lazy('product_list')

    def form_valid(self, form):
        form.instance.created_by = self.request.user
        return super().form_valid(form)

class ProductUpdateView(LoginRequiredMixin, UserPassesTestMixin, UpdateView):
    model = Product
    form_class = ProductForm
    template_name = 'products/form.html'

    def test_func(self):
        product = self.get_object()
        return self.request.user == product.created_by or self.request.user.is_staff

    def get_success_url(self):
        return reverse_lazy('product_detail', kwargs={'slug': self.object.slug})

class ProductDeleteView(LoginRequiredMixin, UserPassesTestMixin, DeleteView):
    model = Product
    success_url = reverse_lazy('product_list')

    def test_func(self):
        product = self.get_object()
        return self.request.user == product.created_by or self.request.user.is_staff
</code></pre>
<hr />
<h2 id="url-routing"><a class="header" href="#url-routing">URL Routing</a></h2>
<h3 id="project-urls"><a class="header" href="#project-urls">Project URLs</a></h3>
<p><strong>myproject/urls.py:</strong></p>
<pre><code class="language-python">from django.contrib import admin
from django.urls import path, include
from django.conf import settings
from django.conf.urls.static import static

urlpatterns = [
    path('admin/', admin.site.urls),
    path('', include('myapp.urls')),
    path('api/', include('myapp.api.urls')),
    path('accounts/', include('django.contrib.auth.urls')),
]

if settings.DEBUG:
    urlpatterns += static(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT)
    urlpatterns += static(settings.STATIC_URL, document_root=settings.STATIC_ROOT)
</code></pre>
<h3 id="app-urls"><a class="header" href="#app-urls">App URLs</a></h3>
<p><strong>myapp/urls.py:</strong></p>
<pre><code class="language-python">from django.urls import path
from . import views

app_name = 'products'

urlpatterns = [
    path('', views.ProductListView.as_view(), name='list'),
    path('create/', views.ProductCreateView.as_view(), name='create'),
    path('&lt;slug:slug&gt;/', views.ProductDetailView.as_view(), name='detail'),
    path('&lt;slug:slug&gt;/edit/', views.ProductUpdateView.as_view(), name='edit'),
    path('&lt;slug:slug&gt;/delete/', views.ProductDeleteView.as_view(), name='delete'),

    # API endpoints
    path('api/products/', views.api_products, name='api_list'),
]
</code></pre>
<h3 id="url-parameters"><a class="header" href="#url-parameters">URL Parameters</a></h3>
<pre><code class="language-python">from django.urls import path, re_path
from . import views

urlpatterns = [
    # String parameter
    path('products/&lt;slug:slug&gt;/', views.product_detail),

    # Integer parameter
    path('products/&lt;int:id&gt;/', views.product_by_id),

    # UUID parameter
    path('orders/&lt;uuid:order_id&gt;/', views.order_detail),

    # Regular expression
    re_path(r'^articles/(?P&lt;year&gt;[0-9]{4})/$', views.year_archive),
]
</code></pre>
<hr />
<h2 id="templates-1"><a class="header" href="#templates-1">Templates</a></h2>
<h3 id="base-template"><a class="header" href="#base-template">Base Template</a></h3>
<p><strong>templates/base.html:</strong></p>
<pre><code class="language-django">{% load static %}
&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
    &lt;title&gt;{% block title %}My Site{% endblock %}&lt;/title&gt;
    &lt;link rel="stylesheet" href="{% static 'css/style.css' %}"&gt;
    {% block extra_css %}{% endblock %}
&lt;/head&gt;
&lt;body&gt;
    &lt;nav&gt;
        &lt;a href="{% url 'products:list' %}"&gt;Products&lt;/a&gt;
        {% if user.is_authenticated %}
            &lt;a href="{% url 'products:create' %}"&gt;Add Product&lt;/a&gt;
            &lt;span&gt;Hello, {{ user.username }}!&lt;/span&gt;
            &lt;a href="{% url 'logout' %}"&gt;Logout&lt;/a&gt;
        {% else %}
            &lt;a href="{% url 'login' %}"&gt;Login&lt;/a&gt;
        {% endif %}
    &lt;/nav&gt;

    &lt;main&gt;
        {% if messages %}
            {% for message in messages %}
                &lt;div class="alert alert-{{ message.tags }}"&gt;
                    {{ message }}
                &lt;/div&gt;
            {% endfor %}
        {% endif %}

        {% block content %}{% endblock %}
    &lt;/main&gt;

    &lt;footer&gt;
        &lt;p&gt;&amp;copy; 2024 My Site&lt;/p&gt;
    &lt;/footer&gt;

    &lt;script src="{% static 'js/main.js' %}"&gt;&lt;/script&gt;
    {% block extra_js %}{% endblock %}
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h3 id="list-template"><a class="header" href="#list-template">List Template</a></h3>
<p><strong>templates/products/list.html:</strong></p>
<pre><code class="language-django">{% extends 'base.html' %}
{% load static %}

{% block title %}Products{% endblock %}

{% block content %}
&lt;div class="products-container"&gt;
    &lt;h1&gt;Products&lt;/h1&gt;

    &lt;form method="get" class="search-form"&gt;
        &lt;input type="text" name="q" placeholder="Search products..." value="{{ request.GET.q }}"&gt;
        &lt;select name="category"&gt;
            &lt;option value=""&gt;All Categories&lt;/option&gt;
            {% for category in categories %}
                &lt;option value="{{ category.slug }}"
                    {% if request.GET.category == category.slug %}selected{% endif %}&gt;
                    {{ category.name }}
                &lt;/option&gt;
            {% endfor %}
        &lt;/select&gt;
        &lt;button type="submit"&gt;Search&lt;/button&gt;
    &lt;/form&gt;

    &lt;div class="products-grid"&gt;
        {% for product in products %}
            &lt;div class="product-card"&gt;
                {% if product.image %}
                    &lt;img src="{{ product.image.url }}" alt="{{ product.name }}"&gt;
                {% else %}
                    &lt;img src="{% static 'images/placeholder.png' %}" alt="No image"&gt;
                {% endif %}

                &lt;h3&gt;{{ product.name }}&lt;/h3&gt;
                &lt;p&gt;{{ product.description|truncatewords:20 }}&lt;/p&gt;
                &lt;p class="price"&gt;${{ product.price }}&lt;/p&gt;
                &lt;a href="{% url 'products:detail' product.slug %}" class="btn"&gt;View Details&lt;/a&gt;
            &lt;/div&gt;
        {% empty %}
            &lt;p&gt;No products found.&lt;/p&gt;
        {% endfor %}
    &lt;/div&gt;

    {% if is_paginated %}
        &lt;div class="pagination"&gt;
            {% if page_obj.has_previous %}
                &lt;a href="?page=1"&gt;&amp;laquo; First&lt;/a&gt;
                &lt;a href="?page={{ page_obj.previous_page_number }}"&gt;Previous&lt;/a&gt;
            {% endif %}

            &lt;span class="current-page"&gt;
                Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}
            &lt;/span&gt;

            {% if page_obj.has_next %}
                &lt;a href="?page={{ page_obj.next_page_number }}"&gt;Next&lt;/a&gt;
                &lt;a href="?page={{ page_obj.paginator.num_pages }}"&gt;Last &amp;raquo;&lt;/a&gt;
            {% endif %}
        &lt;/div&gt;
    {% endif %}
&lt;/div&gt;
{% endblock %}
</code></pre>
<h3 id="custom-template-tags"><a class="header" href="#custom-template-tags">Custom Template Tags</a></h3>
<p><strong>myapp/templatetags/custom_tags.py:</strong></p>
<pre><code class="language-python">from django import template
from django.utils.html import format_html
from django.utils.safestring import mark_safe

register = template.Library()

@register.filter
def currency(value):
    """Format number as currency"""
    return f"${value:,.2f}"

@register.simple_tag
def star_rating(rating):
    """Display star rating"""
    full_stars = int(rating)
    half_star = 1 if rating - full_stars &gt;= 0.5 else 0
    empty_stars = 5 - full_stars - half_star

    stars = '★' * full_stars + '½' * half_star + '☆' * empty_stars
    return format_html('&lt;span class="rating"&gt;{}&lt;/span&gt;', stars)

@register.inclusion_tag('includes/product_card.html')
def product_card(product):
    """Render product card"""
    return {'product': product}
</code></pre>
<hr />
<h2 id="forms-1"><a class="header" href="#forms-1">Forms</a></h2>
<h3 id="model-form"><a class="header" href="#model-form">Model Form</a></h3>
<pre><code class="language-python">from django import forms
from django.core.exceptions import ValidationError
from .models import Product, Review

class ProductForm(forms.ModelForm):
    class Meta:
        model = Product
        fields = ['name', 'description', 'price', 'category', 'image', 'stock', 'status']
        widgets = {
            'description': forms.Textarea(attrs={'rows': 4}),
            'price': forms.NumberInput(attrs={'step': '0.01'}),
        }

    def clean_price(self):
        price = self.cleaned_data.get('price')
        if price and price &lt; 0:
            raise ValidationError('Price cannot be negative')
        return price

    def clean_name(self):
        name = self.cleaned_data.get('name')
        if Product.objects.filter(name=name).exclude(pk=self.instance.pk).exists():
            raise ValidationError('Product with this name already exists')
        return name

class ReviewForm(forms.ModelForm):
    class Meta:
        model = Review
        fields = ['rating', 'title', 'comment']
        widgets = {
            'rating': forms.RadioSelect(choices=[(i, f'{i}★') for i in range(1, 6)]),
            'comment': forms.Textarea(attrs={'rows': 4, 'placeholder': 'Share your experience...'}),
        }

class SearchForm(forms.Form):
    query = forms.CharField(
        max_length=100,
        required=False,
        widget=forms.TextInput(attrs={'placeholder': 'Search products...'})
    )
    category = forms.ModelChoiceField(
        queryset=Category.objects.all(),
        required=False,
        empty_label='All Categories'
    )
    min_price = forms.DecimalField(required=False, min_value=0)
    max_price = forms.DecimalField(required=False, min_value=0)

    def clean(self):
        cleaned_data = super().clean()
        min_price = cleaned_data.get('min_price')
        max_price = cleaned_data.get('max_price')

        if min_price and max_price and min_price &gt; max_price:
            raise ValidationError('Minimum price cannot be greater than maximum price')

        return cleaned_data
</code></pre>
<h3 id="custom-validation"><a class="header" href="#custom-validation">Custom Validation</a></h3>
<pre><code class="language-python">from django import forms
from django.core.validators import EmailValidator, RegexValidator

class ContactForm(forms.Form):
    name = forms.CharField(
        max_length=100,
        validators=[
            RegexValidator(
                regex=r'^[a-zA-Z\s]+$',
                message='Name can only contain letters and spaces'
            )
        ]
    )
    email = forms.EmailField(validators=[EmailValidator()])
    phone = forms.CharField(
        validators=[
            RegexValidator(
                regex=r'^\+?1?\d{9,15}$',
                message='Enter a valid phone number'
            )
        ]
    )
    message = forms.CharField(widget=forms.Textarea)

    def clean_email(self):
        email = self.cleaned_data.get('email')
        if email and 'spam' in email.lower():
            raise forms.ValidationError('This email appears to be spam')
        return email

    def send_email(self):
        # Send email logic here
        pass
</code></pre>
<hr />
<h2 id="authentication-6"><a class="header" href="#authentication-6">Authentication</a></h2>
<h3 id="login-and-logout"><a class="header" href="#login-and-logout">Login and Logout</a></h3>
<pre><code class="language-python">from django.contrib.auth import authenticate, login, logout
from django.contrib.auth.forms import UserCreationForm
from django.shortcuts import render, redirect
from django.contrib import messages

def user_login(request):
    if request.method == 'POST':
        username = request.POST.get('username')
        password = request.POST.get('password')
        user = authenticate(request, username=username, password=password)

        if user is not None:
            login(request, user)
            messages.success(request, f'Welcome back, {user.username}!')
            return redirect('home')
        else:
            messages.error(request, 'Invalid username or password')

    return render(request, 'registration/login.html')

def user_logout(request):
    logout(request)
    messages.info(request, 'You have been logged out')
    return redirect('login')

def user_register(request):
    if request.method == 'POST':
        form = UserCreationForm(request.POST)
        if form.is_valid():
            user = form.save()
            login(request, user)
            messages.success(request, 'Registration successful!')
            return redirect('home')
    else:
        form = UserCreationForm()

    return render(request, 'registration/register.html', {'form': form})
</code></pre>
<h3 id="custom-user-model"><a class="header" href="#custom-user-model">Custom User Model</a></h3>
<pre><code class="language-python">from django.contrib.auth.models import AbstractUser
from django.db import models

class CustomUser(AbstractUser):
    email = models.EmailField(unique=True)
    bio = models.TextField(blank=True)
    avatar = models.ImageField(upload_to='avatars/', blank=True)
    birth_date = models.DateField(null=True, blank=True)
    phone = models.CharField(max_length=20, blank=True)

    def __str__(self):
        return self.username

# In settings.py
AUTH_USER_MODEL = 'myapp.CustomUser'
</code></pre>
<h3 id="permissions-1"><a class="header" href="#permissions-1">Permissions</a></h3>
<pre><code class="language-python">from django.contrib.auth.decorators import login_required, permission_required
from django.contrib.auth.mixins import PermissionRequiredMixin

# Function-based view
@login_required
@permission_required('myapp.add_product', raise_exception=True)
def create_product(request):
    # View logic
    pass

# Class-based view
class ProductCreateView(LoginRequiredMixin, PermissionRequiredMixin, CreateView):
    model = Product
    permission_required = 'myapp.add_product'
    # View logic

# Custom permission
class Product(models.Model):
    # ... fields ...

    class Meta:
        permissions = [
            ("can_publish", "Can publish products"),
            ("can_feature", "Can feature products"),
        ]

# Check permission in code
if request.user.has_perm('myapp.can_publish'):
    # User has permission
    pass
</code></pre>
<hr />
<h2 id="django-rest-framework"><a class="header" href="#django-rest-framework">Django REST Framework</a></h2>
<h3 id="installation-24"><a class="header" href="#installation-24">Installation</a></h3>
<pre><code class="language-bash">pip install djangorestframework
</code></pre>
<h3 id="configuration-6"><a class="header" href="#configuration-6">Configuration</a></h3>
<pre><code class="language-python"># settings.py
INSTALLED_APPS = [
    # ...
    'rest_framework',
]

REST_FRAMEWORK = {
    'DEFAULT_AUTHENTICATION_CLASSES': [
        'rest_framework.authentication.TokenAuthentication',
        'rest_framework.authentication.SessionAuthentication',
    ],
    'DEFAULT_PERMISSION_CLASSES': [
        'rest_framework.permissions.IsAuthenticatedOrReadOnly',
    ],
    'DEFAULT_PAGINATION_CLASS': 'rest_framework.pagination.PageNumberPagination',
    'PAGE_SIZE': 10,
}
</code></pre>
<h3 id="serializers"><a class="header" href="#serializers">Serializers</a></h3>
<pre><code class="language-python">from rest_framework import serializers
from .models import Product, Category, Review

class CategorySerializer(serializers.ModelSerializer):
    product_count = serializers.IntegerField(read_only=True)

    class Meta:
        model = Category
        fields = ['id', 'name', 'slug', 'description', 'product_count']

class ProductSerializer(serializers.ModelSerializer):
    category = CategorySerializer(read_only=True)
    category_id = serializers.IntegerField(write_only=True)
    reviews_count = serializers.SerializerMethodField()
    average_rating = serializers.SerializerMethodField()

    class Meta:
        model = Product
        fields = [
            'id', 'name', 'slug', 'description', 'price',
            'category', 'category_id', 'image', 'status', 'stock',
            'reviews_count', 'average_rating', 'created_at'
        ]
        read_only_fields = ['slug', 'created_at']

    def get_reviews_count(self, obj):
        return obj.reviews.count()

    def get_average_rating(self, obj):
        reviews = obj.reviews.all()
        if reviews:
            return sum(r.rating for r in reviews) / len(reviews)
        return None

    def validate_price(self, value):
        if value &lt; 0:
            raise serializers.ValidationError('Price cannot be negative')
        return value

class ReviewSerializer(serializers.ModelSerializer):
    user = serializers.StringRelatedField(read_only=True)

    class Meta:
        model = Review
        fields = ['id', 'user', 'rating', 'title', 'comment', 'created_at']
        read_only_fields = ['user', 'created_at']
</code></pre>
<h3 id="api-views"><a class="header" href="#api-views">API Views</a></h3>
<pre><code class="language-python">from rest_framework import viewsets, filters, status
from rest_framework.decorators import action, api_view, permission_classes
from rest_framework.response import Response
from rest_framework.permissions import IsAuthenticated, IsAuthenticatedOrReadOnly
from django_filters.rest_framework import DjangoFilterBackend
from .models import Product, Category
from .serializers import ProductSerializer, CategorySerializer

class ProductViewSet(viewsets.ModelViewSet):
    queryset = Product.objects.all()
    serializer_class = ProductSerializer
    permission_classes = [IsAuthenticatedOrReadOnly]
    filter_backends = [DjangoFilterBackend, filters.SearchFilter, filters.OrderingFilter]
    filterset_fields = ['category', 'status']
    search_fields = ['name', 'description']
    ordering_fields = ['price', 'created_at']
    lookup_field = 'slug'

    def perform_create(self, serializer):
        serializer.save(created_by=self.request.user)

    @action(detail=True, methods=['post'])
    def publish(self, request, slug=None):
        product = self.get_object()
        product.status = 'published'
        product.save()
        return Response({'status': 'product published'})

    @action(detail=False, methods=['get'])
    def featured(self, request):
        featured_products = self.queryset.filter(status='published', stock__gt=0)[:10]
        serializer = self.get_serializer(featured_products, many=True)
        return Response(serializer.data)

class CategoryViewSet(viewsets.ReadOnlyModelViewSet):
    queryset = Category.objects.annotate(product_count=Count('products'))
    serializer_class = CategorySerializer
    lookup_field = 'slug'

# Function-based API view
@api_view(['GET', 'POST'])
@permission_classes([IsAuthenticated])
def product_list_create(request):
    if request.method == 'GET':
        products = Product.objects.all()
        serializer = ProductSerializer(products, many=True)
        return Response(serializer.data)

    elif request.method == 'POST':
        serializer = ProductSerializer(data=request.data)
        if serializer.is_valid():
            serializer.save(created_by=request.user)
            return Response(serializer.data, status=status.HTTP_201_CREATED)
        return Response(serializer.errors, status=status.HTTP_400_BAD_REQUEST)
</code></pre>
<hr />
<h2 id="admin-interface"><a class="header" href="#admin-interface">Admin Interface</a></h2>
<h3 id="basic-admin-registration"><a class="header" href="#basic-admin-registration">Basic Admin Registration</a></h3>
<pre><code class="language-python">from django.contrib import admin
from .models import Product, Category, Review, Order

admin.site.register(Category)
admin.site.register(Review)
</code></pre>
<h3 id="custom-admin"><a class="header" href="#custom-admin">Custom Admin</a></h3>
<pre><code class="language-python">from django.contrib import admin
from django.utils.html import format_html
from .models import Product, Order, OrderItem

@admin.register(Category)
class CategoryAdmin(admin.ModelAdmin):
    list_display = ['name', 'slug', 'product_count', 'created_at']
    prepopulated_fields = {'slug': ('name',)}
    search_fields = ['name']

    def product_count(self, obj):
        return obj.products.count()
    product_count.short_description = 'Products'

@admin.register(Product)
class ProductAdmin(admin.ModelAdmin):
    list_display = ['name', 'category', 'price', 'stock', 'status', 'image_preview', 'created_at']
    list_filter = ['status', 'category', 'created_at']
    search_fields = ['name', 'description']
    prepopulated_fields = {'slug': ('name',)}
    list_editable = ['price', 'stock', 'status']
    readonly_fields = ['created_at', 'updated_at', 'image_preview']
    fieldsets = (
        ('Basic Information', {
            'fields': ('name', 'slug', 'description', 'category')
        }),
        ('Pricing and Inventory', {
            'fields': ('price', 'stock', 'status')
        }),
        ('Media', {
            'fields': ('image', 'image_preview')
        }),
        ('Metadata', {
            'fields': ('created_by', 'created_at', 'updated_at'),
            'classes': ('collapse',)
        }),
    )

    def image_preview(self, obj):
        if obj.image:
            return format_html('&lt;img src="{}" width="100" height="100" /&gt;', obj.image.url)
        return '-'
    image_preview.short_description = 'Preview'

class OrderItemInline(admin.TabularInline):
    model = OrderItem
    extra = 0
    readonly_fields = ['subtotal']

@admin.register(Order)
class OrderAdmin(admin.ModelAdmin):
    list_display = ['id', 'user', 'status', 'total_amount', 'created_at']
    list_filter = ['status', 'created_at']
    search_fields = ['user__username', 'user__email', 'tracking_number']
    inlines = [OrderItemInline]
    readonly_fields = ['created_at', 'updated_at']

    actions = ['mark_as_shipped']

    def mark_as_shipped(self, request, queryset):
        queryset.update(status='shipped')
    mark_as_shipped.short_description = 'Mark selected orders as shipped'
</code></pre>
<hr />
<h2 id="middleware-2"><a class="header" href="#middleware-2">Middleware</a></h2>
<pre><code class="language-python">import time
import logging
from django.utils.deprecation import MiddlewareMixin

logger = logging.getLogger(__name__)

class RequestLoggingMiddleware(MiddlewareMixin):
    def process_request(self, request):
        request.start_time = time.time()

    def process_response(self, request, response):
        if hasattr(request, 'start_time'):
            duration = time.time() - request.start_time
            logger.info(f'{request.method} {request.path} - {response.status_code} - {duration:.2f}s')
        return response

class CustomHeaderMiddleware:
    def __init__(self, get_response):
        self.get_response = get_response

    def __call__(self, request):
        response = self.get_response(request)
        response['X-Custom-Header'] = 'My Custom Value'
        return response
</code></pre>
<hr />
<h2 id="static-and-media-files"><a class="header" href="#static-and-media-files">Static and Media Files</a></h2>
<h3 id="settings-1"><a class="header" href="#settings-1">Settings</a></h3>
<pre><code class="language-python"># settings.py
STATIC_URL = '/static/'
STATIC_ROOT = BASE_DIR / 'staticfiles'
STATICFILES_DIRS = [
    BASE_DIR / 'static',
]

MEDIA_URL = '/media/'
MEDIA_ROOT = BASE_DIR / 'media'

# For production
STATICFILES_STORAGE = 'django.contrib.staticfiles.storage.ManifestStaticFilesStorage'
</code></pre>
<h3 id="collect-static-files"><a class="header" href="#collect-static-files">Collect Static Files</a></h3>
<pre><code class="language-bash">python manage.py collectstatic
</code></pre>
<hr />
<h2 id="testing-8"><a class="header" href="#testing-8">Testing</a></h2>
<h3 id="unit-tests-1"><a class="header" href="#unit-tests-1">Unit Tests</a></h3>
<pre><code class="language-python">from django.test import TestCase
from django.contrib.auth.models import User
from .models import Product, Category

class ProductModelTest(TestCase):
    def setUp(self):
        self.user = User.objects.create_user(username='testuser', password='12345')
        self.category = Category.objects.create(name='Electronics', slug='electronics')
        self.product = Product.objects.create(
            name='Laptop',
            slug='laptop',
            description='A great laptop',
            price=999.99,
            category=self.category,
            stock=10,
            created_by=self.user
        )

    def test_product_creation(self):
        self.assertEqual(self.product.name, 'Laptop')
        self.assertEqual(self.product.price, 999.99)

    def test_product_is_available(self):
        self.product.status = 'published'
        self.assertTrue(self.product.is_available)

    def test_product_str(self):
        self.assertEqual(str(self.product), 'Laptop')

class ProductViewTest(TestCase):
    def setUp(self):
        self.user = User.objects.create_user(username='testuser', password='12345')
        self.category = Category.objects.create(name='Electronics', slug='electronics')
        self.product = Product.objects.create(
            name='Laptop',
            slug='laptop',
            description='A great laptop',
            price=999.99,
            category=self.category,
            status='published',
            stock=10,
            created_by=self.user
        )

    def test_product_list_view(self):
        response = self.client.get('/products/')
        self.assertEqual(response.status_code, 200)
        self.assertContains(response, 'Laptop')
        self.assertTemplateUsed(response, 'products/list.html')

    def test_product_detail_view(self):
        response = self.client.get(f'/products/{self.product.slug}/')
        self.assertEqual(response.status_code, 200)
        self.assertContains(response, self.product.name)

    def test_product_create_requires_login(self):
        response = self.client.get('/products/create/')
        self.assertEqual(response.status_code, 302)

    def test_product_create_authenticated(self):
        self.client.login(username='testuser', password='12345')
        response = self.client.post('/products/create/', {
            'name': 'New Product',
            'slug': 'new-product',
            'description': 'Description',
            'price': 99.99,
            'category': self.category.id,
            'stock': 5,
            'status': 'draft'
        })
        self.assertEqual(response.status_code, 302)
        self.assertTrue(Product.objects.filter(name='New Product').exists())
</code></pre>
<hr />
<h2 id="best-practices-81"><a class="header" href="#best-practices-81">Best Practices</a></h2>
<h3 id="1-settings-organization"><a class="header" href="#1-settings-organization">1. Settings Organization</a></h3>
<pre><code class="language-python"># settings/
# ├── __init__.py
# ├── base.py
# ├── development.py
# ├── production.py
# └── testing.py

# base.py - Common settings
# development.py
from .base import *

DEBUG = True
ALLOWED_HOSTS = ['localhost', '127.0.0.1']

# production.py
from .base import *

DEBUG = False
ALLOWED_HOSTS = config('ALLOWED_HOSTS').split(',')
</code></pre>
<h3 id="2-use-environment-variables"><a class="header" href="#2-use-environment-variables">2. Use Environment Variables</a></h3>
<pre><code class="language-python">from decouple import config

SECRET_KEY = config('SECRET_KEY')
DEBUG = config('DEBUG', default=False, cast=bool)
DATABASE_URL = config('DATABASE_URL')
</code></pre>
<h3 id="3-query-optimization"><a class="header" href="#3-query-optimization">3. Query Optimization</a></h3>
<pre><code class="language-python"># Use select_related for foreign keys
products = Product.objects.select_related('category').all()

# Use prefetch_related for many-to-many and reverse foreign keys
products = Product.objects.prefetch_related('reviews').all()

# Only get needed fields
products = Product.objects.values('id', 'name', 'price')

# Use iterator for large querysets
for product in Product.objects.iterator():
    # Process product
    pass
</code></pre>
<h3 id="4-security"><a class="header" href="#4-security">4. Security</a></h3>
<pre><code class="language-python"># settings.py
SECURE_SSL_REDIRECT = True
SESSION_COOKIE_SECURE = True
CSRF_COOKIE_SECURE = True
SECURE_BROWSER_XSS_FILTER = True
SECURE_CONTENT_TYPE_NOSNIFF = True
X_FRAME_OPTIONS = 'DENY'

# Use Django's CSRF protection
# Always validate and sanitize user input
# Use parameterized queries (Django ORM does this by default)
</code></pre>
<hr />
<h2 id="production-deployment-2"><a class="header" href="#production-deployment-2">Production Deployment</a></h2>
<h3 id="requirements-file"><a class="header" href="#requirements-file">Requirements File</a></h3>
<pre><code class="language-bash">pip freeze &gt; requirements.txt
</code></pre>
<p><strong>requirements.txt:</strong></p>
<pre><code>Django==4.2.7
psycopg2-binary==2.9.9
python-decouple==3.8
Pillow==10.1.0
gunicorn==21.2.0
django-cors-headers==4.3.1
djangorestframework==3.14.0
</code></pre>
<h3 id="gunicorn-configuration"><a class="header" href="#gunicorn-configuration">Gunicorn Configuration</a></h3>
<p><strong>gunicorn.conf.py:</strong></p>
<pre><code class="language-python">bind = '0.0.0.0:8000'
workers = 4
threads = 2
worker_class = 'sync'
worker_connections = 1000
timeout = 30
keepalive = 2
accesslog = '-'
errorlog = '-'
loglevel = 'info'
</code></pre>
<h3 id="docker-deployment-2"><a class="header" href="#docker-deployment-2">Docker Deployment</a></h3>
<p><strong>Dockerfile:</strong></p>
<pre><code class="language-dockerfile">FROM python:3.11-slim

ENV PYTHONUNBUFFERED=1
ENV PYTHONDONTWRITEBYTECODE=1

WORKDIR /app

COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY . .

RUN python manage.py collectstatic --noinput

EXPOSE 8000

CMD ["gunicorn", "--config", "gunicorn.conf.py", "myproject.wsgi:application"]
</code></pre>
<p><strong>docker-compose.yml:</strong></p>
<pre><code class="language-yaml">version: '3.8'

services:
  web:
    build: .
    command: gunicorn myproject.wsgi:application --bind 0.0.0.0:8000
    volumes:
      - ./:/app
      - static_volume:/app/staticfiles
      - media_volume:/app/media
    ports:
      - "8000:8000"
    env_file:
      - .env
    depends_on:
      - db

  db:
    image: postgres:15-alpine
    volumes:
      - postgres_data:/var/lib/postgresql/data
    environment:
      - POSTGRES_DB=mydb
      - POSTGRES_USER=postgres
      - POSTGRES_PASSWORD=password

  nginx:
    image: nginx:alpine
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf
      - static_volume:/app/staticfiles
      - media_volume:/app/media
    ports:
      - "80:80"
    depends_on:
      - web

volumes:
  postgres_data:
  static_volume:
  media_volume:
</code></pre>
<h3 id="nginx-configuration-1"><a class="header" href="#nginx-configuration-1">Nginx Configuration</a></h3>
<p><strong>nginx.conf:</strong></p>
<pre><code class="language-nginx">upstream django {
    server web:8000;
}

server {
    listen 80;
    server_name example.com;

    location / {
        proxy_pass http://django;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    location /static/ {
        alias /app/staticfiles/;
    }

    location /media/ {
        alias /app/media/;
    }
}
</code></pre>
<hr />
<h2 id="resources-43"><a class="header" href="#resources-43">Resources</a></h2>
<p><strong>Official Documentation:</strong></p>
<ul>
<li><a href="https://docs.djangoproject.com/">Django Documentation</a></li>
<li><a href="https://docs.djangoproject.com/en/stable/intro/tutorial01/">Django Tutorial</a></li>
<li><a href="https://www.django-rest-framework.org/">Django REST Framework</a></li>
</ul>
<p><strong>Learning Resources:</strong></p>
<ul>
<li><a href="https://djangoforbeginners.com/">Django for Beginners</a></li>
<li><a href="https://www.feldroy.com/books/two-scoops-of-django-3-x">Two Scoops of Django</a></li>
<li><a href="https://realpython.com/tutorials/django/">Real Python Django Tutorials</a></li>
</ul>
<p><strong>Community:</strong></p>
<ul>
<li><a href="https://forum.djangoproject.com/">Django Forum</a></li>
<li><a href="https://discord.gg/xcRH6mN4fa">Django Discord</a></li>
<li><a href="https://stackoverflow.com/questions/tagged/django">Stack Overflow</a></li>
</ul>
<p><strong>Tools and Packages:</strong></p>
<ul>
<li><a href="https://djangopackages.org/">Django Packages</a></li>
<li><a href="https://github.com/wsvincent/awesome-django">Awesome Django</a></li>
<li><a href="https://django-debug-toolbar.readthedocs.io/">Django Debug Toolbar</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="flask"><a class="header" href="#flask">Flask</a></h1>
<p>Flask is a lightweight WSGI web application framework for Python. It's designed to make getting started quick and easy, with the ability to scale up to complex applications. Flask is often called a "microframework" because it doesn't require particular tools or libraries, giving developers flexibility in choosing their tools and architecture.</p>
<h2 id="table-of-contents-50"><a class="header" href="#table-of-contents-50">Table of Contents</a></h2>
<ul>
<li><a href="web_development/flask.html#introduction">Introduction</a></li>
<li><a href="web_development/flask.html#installation-and-setup">Installation and Setup</a></li>
<li><a href="web_development/flask.html#basic-application">Basic Application</a></li>
<li><a href="web_development/flask.html#routing">Routing</a></li>
<li><a href="web_development/flask.html#request-and-response">Request and Response</a></li>
<li><a href="web_development/flask.html#templates-with-jinja2">Templates with Jinja2</a></li>
<li><a href="web_development/flask.html#forms-and-validation">Forms and Validation</a></li>
<li><a href="web_development/flask.html#database-integration">Database Integration</a></li>
<li><a href="web_development/flask.html#authentication">Authentication</a></li>
<li><a href="web_development/flask.html#restful-apis">RESTful APIs</a></li>
<li><a href="web_development/flask.html#blueprints">Blueprints</a></li>
<li><a href="web_development/flask.html#error-handling">Error Handling</a></li>
<li><a href="web_development/flask.html#file-uploads">File Uploads</a></li>
<li><a href="web_development/flask.html#testing">Testing</a></li>
<li><a href="web_development/flask.html#best-practices">Best Practices</a></li>
<li><a href="web_development/flask.html#production-deployment">Production Deployment</a></li>
</ul>
<hr />
<h2 id="introduction-30"><a class="header" href="#introduction-30">Introduction</a></h2>
<p><strong>Key Features:</strong></p>
<ul>
<li>Minimal core with extensions for added functionality</li>
<li>Built-in development server and debugger</li>
<li>Integrated unit testing support</li>
<li>RESTful request dispatching</li>
<li>Jinja2 templating engine</li>
<li>Secure cookies for client-side sessions</li>
<li>WSGI 1.0 compliant</li>
<li>Unicode-based</li>
<li>Extensive documentation</li>
<li>Active community</li>
</ul>
<p><strong>Use Cases:</strong></p>
<ul>
<li>RESTful APIs</li>
<li>Microservices</li>
<li>Prototypes and MVPs</li>
<li>Small to medium web applications</li>
<li>Backend for single-page applications</li>
<li>Data science dashboards</li>
<li>Webhook handlers</li>
<li>Static sites with dynamic content</li>
</ul>
<p><strong>Philosophy:</strong></p>
<ul>
<li>Simplicity and flexibility</li>
<li>Explicit over implicit</li>
<li>Start small, scale when needed</li>
<li>No forced dependencies</li>
<li>Easy to extend</li>
</ul>
<hr />
<h2 id="installation-and-setup-8"><a class="header" href="#installation-and-setup-8">Installation and Setup</a></h2>
<h3 id="prerequisites-3"><a class="header" href="#prerequisites-3">Prerequisites</a></h3>
<pre><code class="language-bash"># Python 3.7+ required
python3 --version
pip --version
</code></pre>
<h3 id="virtual-environment"><a class="header" href="#virtual-environment">Virtual Environment</a></h3>
<pre><code class="language-bash"># Create virtual environment
python3 -m venv venv

# Activate virtual environment
# Linux/Mac:
source venv/bin/activate
# Windows:
# venv\Scripts\activate

# Upgrade pip
pip install --upgrade pip
</code></pre>
<h3 id="install-flask"><a class="header" href="#install-flask">Install Flask</a></h3>
<pre><code class="language-bash"># Install Flask
pip install Flask

# Install common extensions
pip install Flask-SQLAlchemy Flask-Migrate Flask-Login Flask-WTF
pip install Flask-CORS Flask-JWT-Extended python-dotenv
</code></pre>
<h3 id="project-structure-7"><a class="header" href="#project-structure-7">Project Structure</a></h3>
<pre><code>flask-app/
├── app/
│   ├── __init__.py
│   ├── models.py
│   ├── routes.py
│   ├── forms.py
│   ├── templates/
│   │   ├── base.html
│   │   └── index.html
│   ├── static/
│   │   ├── css/
│   │   ├── js/
│   │   └── images/
│   └── blueprints/
│       ├── auth/
│       └── api/
├── tests/
│   └── test_routes.py
├── migrations/
├── config.py
├── .env
├── .flaskenv
├── requirements.txt
└── run.py
</code></pre>
<hr />
<h2 id="basic-application-1"><a class="header" href="#basic-application-1">Basic Application</a></h2>
<h3 id="minimal-flask-app"><a class="header" href="#minimal-flask-app">Minimal Flask App</a></h3>
<pre><code class="language-python">from flask import Flask

app = Flask(__name__)

@app.route('/')
def hello():
    return 'Hello, World!'

if __name__ == '__main__':
    app.run(debug=True)
</code></pre>
<h3 id="application-factory-pattern"><a class="header" href="#application-factory-pattern">Application Factory Pattern</a></h3>
<p><strong>app/<strong>init</strong>.py:</strong></p>
<pre><code class="language-python">from flask import Flask
from flask_sqlalchemy import SQLAlchemy
from flask_migrate import Migrate
from flask_login import LoginManager
from config import Config

db = SQLAlchemy()
migrate = Migrate()
login_manager = LoginManager()

def create_app(config_class=Config):
    app = Flask(__name__)
    app.config.from_object(config_class)

    # Initialize extensions
    db.init_app(app)
    migrate.init_app(app, db)
    login_manager.init_app(app)
    login_manager.login_view = 'auth.login'

    # Register blueprints
    from app.blueprints.auth import auth_bp
    from app.blueprints.main import main_bp
    from app.blueprints.api import api_bp

    app.register_blueprint(auth_bp, url_prefix='/auth')
    app.register_blueprint(main_bp)
    app.register_blueprint(api_bp, url_prefix='/api')

    return app

from app import models
</code></pre>
<p><strong>config.py:</strong></p>
<pre><code class="language-python">import os
from dotenv import load_dotenv

basedir = os.path.abspath(os.path.dirname(__file__))
load_dotenv(os.path.join(basedir, '.env'))

class Config:
    SECRET_KEY = os.environ.get('SECRET_KEY') or 'dev-secret-key'
    SQLALCHEMY_DATABASE_URI = os.environ.get('DATABASE_URL') or \
        'sqlite:///' + os.path.join(basedir, 'app.db')
    SQLALCHEMY_TRACK_MODIFICATIONS = False

    # File upload settings
    UPLOAD_FOLDER = os.path.join(basedir, 'uploads')
    MAX_CONTENT_LENGTH = 16 * 1024 * 1024  # 16MB max file size

class DevelopmentConfig(Config):
    DEBUG = True

class ProductionConfig(Config):
    DEBUG = False

class TestingConfig(Config):
    TESTING = True
    SQLALCHEMY_DATABASE_URI = 'sqlite:///:memory:'
</code></pre>
<p><strong>run.py:</strong></p>
<pre><code class="language-python">from app import create_app, db
from app.models import User, Post

app = create_app()

@app.shell_context_processor
def make_shell_context():
    return {'db': db, 'User': User, 'Post': Post}

if __name__ == '__main__':
    app.run(debug=True)
</code></pre>
<hr />
<h2 id="routing-2"><a class="header" href="#routing-2">Routing</a></h2>
<h3 id="basic-routes-1"><a class="header" href="#basic-routes-1">Basic Routes</a></h3>
<pre><code class="language-python">from flask import Flask

app = Flask(__name__)

@app.route('/')
def index():
    return 'Home Page'

@app.route('/about')
def about():
    return 'About Page'

# Route with variable
@app.route('/user/&lt;username&gt;')
def show_user(username):
    return f'User: {username}'

# Route with type converter
@app.route('/post/&lt;int:post_id&gt;')
def show_post(post_id):
    return f'Post ID: {post_id}'

# Route with multiple types
@app.route('/path/&lt;path:subpath&gt;')
def show_subpath(subpath):
    return f'Subpath: {subpath}'
</code></pre>
<h3 id="http-methods-2"><a class="header" href="#http-methods-2">HTTP Methods</a></h3>
<pre><code class="language-python">from flask import request, jsonify

@app.route('/login', methods=['GET', 'POST'])
def login():
    if request.method == 'POST':
        username = request.form.get('username')
        password = request.form.get('password')
        # Process login
        return {'message': 'Login successful'}
    return 'Login form'

# Separate methods
@app.get('/users')
def get_users():
    return jsonify([])

@app.post('/users')
def create_user():
    data = request.get_json()
    return jsonify(data), 201

@app.put('/users/&lt;int:id&gt;')
def update_user(id):
    data = request.get_json()
    return jsonify(data)

@app.delete('/users/&lt;int:id&gt;')
def delete_user(id):
    return '', 204
</code></pre>
<h3 id="url-building"><a class="header" href="#url-building">URL Building</a></h3>
<pre><code class="language-python">from flask import url_for, redirect

@app.route('/admin')
def admin():
    return 'Admin Page'

@app.route('/redirect-to-admin')
def redirect_to_admin():
    return redirect(url_for('admin'))

@app.route('/user/&lt;username&gt;')
def profile(username):
    return f'Profile: {username}'

# Generate URL
with app.test_request_context():
    print(url_for('admin'))  # /admin
    print(url_for('profile', username='john'))  # /user/john
    print(url_for('static', filename='style.css'))  # /static/style.css
</code></pre>
<hr />
<h2 id="request-and-response-1"><a class="header" href="#request-and-response-1">Request and Response</a></h2>
<h3 id="request-object-1"><a class="header" href="#request-object-1">Request Object</a></h3>
<pre><code class="language-python">from flask import request, jsonify

@app.route('/search')
def search():
    # Query parameters
    query = request.args.get('q', '')
    page = request.args.get('page', 1, type=int)

    return f'Searching for: {query}, Page: {page}'

@app.route('/submit', methods=['POST'])
def submit():
    # Form data
    name = request.form.get('name')
    email = request.form.get('email')

    # JSON data
    if request.is_json:
        data = request.get_json()
        name = data.get('name')
        email = data.get('email')

    # Files
    if 'file' in request.files:
        file = request.files['file']
        if file.filename:
            file.save(f'uploads/{file.filename}')

    # Headers
    user_agent = request.headers.get('User-Agent')
    auth_token = request.headers.get('Authorization')

    # Cookies
    session_id = request.cookies.get('session_id')

    return jsonify({
        'name': name,
        'email': email,
        'user_agent': user_agent
    })
</code></pre>
<h3 id="response-object-1"><a class="header" href="#response-object-1">Response Object</a></h3>
<pre><code class="language-python">from flask import make_response, jsonify, render_template, send_file

@app.route('/json')
def json_response():
    return jsonify({
        'status': 'success',
        'data': {'id': 1, 'name': 'John'}
    })

@app.route('/custom')
def custom_response():
    response = make_response('Custom response', 200)
    response.headers['X-Custom-Header'] = 'Value'
    response.set_cookie('user_id', '123', max_age=3600)
    return response

@app.route('/download')
def download():
    return send_file('path/to/file.pdf', as_attachment=True)

@app.route('/stream')
def stream():
    def generate():
        for i in range(10):
            yield f'data: {i}\n\n'

    return app.response_class(generate(), mimetype='text/event-stream')
</code></pre>
<hr />
<h2 id="templates-with-jinja2"><a class="header" href="#templates-with-jinja2">Templates with Jinja2</a></h2>
<h3 id="base-template-1"><a class="header" href="#base-template-1">Base Template</a></h3>
<p><strong>templates/base.html:</strong></p>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
    &lt;title&gt;{% block title %}My App{% endblock %}&lt;/title&gt;
    &lt;link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}"&gt;
    {% block extra_css %}{% endblock %}
&lt;/head&gt;
&lt;body&gt;
    &lt;nav&gt;
        &lt;a href="{{ url_for('index') }}"&gt;Home&lt;/a&gt;
        {% if current_user.is_authenticated %}
            &lt;a href="{{ url_for('profile') }}"&gt;Profile&lt;/a&gt;
            &lt;a href="{{ url_for('logout') }}"&gt;Logout&lt;/a&gt;
        {% else %}
            &lt;a href="{{ url_for('login') }}"&gt;Login&lt;/a&gt;
            &lt;a href="{{ url_for('register') }}"&gt;Register&lt;/a&gt;
        {% endif %}
    &lt;/nav&gt;

    &lt;main&gt;
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    &lt;div class="alert alert-{{ category }}"&gt;{{ message }}&lt;/div&gt;
                {% endfor %}
            {% endif %}
        {% endwith %}

        {% block content %}{% endblock %}
    &lt;/main&gt;

    &lt;footer&gt;
        &lt;p&gt;&amp;copy; 2024 My App&lt;/p&gt;
    &lt;/footer&gt;

    &lt;script src="{{ url_for('static', filename='js/main.js') }}"&gt;&lt;/script&gt;
    {% block extra_js %}{% endblock %}
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h3 id="child-template"><a class="header" href="#child-template">Child Template</a></h3>
<p><strong>templates/index.html:</strong></p>
<pre><code class="language-html">{% extends 'base.html' %}

{% block title %}Home - {{ super() }}{% endblock %}

{% block content %}
&lt;h1&gt;Welcome to {{ app_name }}&lt;/h1&gt;

{% if users %}
    &lt;ul&gt;
    {% for user in users %}
        &lt;li&gt;
            &lt;a href="{{ url_for('show_user', username=user.username) }}"&gt;
                {{ user.username }}
            &lt;/a&gt;
            {% if user.is_admin %}
                &lt;span class="badge"&gt;Admin&lt;/span&gt;
            {% endif %}
        &lt;/li&gt;
    {% endfor %}
    &lt;/ul&gt;
{% else %}
    &lt;p&gt;No users found.&lt;/p&gt;
{% endif %}

&lt;!-- Macros --&gt;
{% macro render_user(user) %}
    &lt;div class="user-card"&gt;
        &lt;h3&gt;{{ user.username }}&lt;/h3&gt;
        &lt;p&gt;{{ user.email }}&lt;/p&gt;
    &lt;/div&gt;
{% endmacro %}

{% for user in users %}
    {{ render_user(user) }}
{% endfor %}
{% endblock %}
</code></pre>
<h3 id="template-filters-and-functions"><a class="header" href="#template-filters-and-functions">Template Filters and Functions</a></h3>
<pre><code class="language-python">from flask import Flask
from datetime import datetime

app = Flask(__name__)

@app.template_filter('datetimeformat')
def datetimeformat(value, format='%Y-%m-%d %H:%M'):
    return value.strftime(format)

@app.template_filter('currency')
def currency(value):
    return f'${value:,.2f}'

@app.context_processor
def utility_processor():
    def format_price(amount):
        return f'${amount:,.2f}'

    return dict(format_price=format_price)

# Usage in template:
# {{ order.created_at|datetimeformat }}
# {{ product.price|currency }}
# {{ format_price(100.50) }}
</code></pre>
<hr />
<h2 id="forms-and-validation"><a class="header" href="#forms-and-validation">Forms and Validation</a></h2>
<h3 id="flask-wtf-forms"><a class="header" href="#flask-wtf-forms">Flask-WTF Forms</a></h3>
<pre><code class="language-python">from flask_wtf import FlaskForm
from wtforms import StringField, PasswordField, TextAreaField, SelectField, BooleanField
from wtforms.validators import DataRequired, Email, Length, EqualTo, ValidationError
from app.models import User

class RegistrationForm(FlaskForm):
    username = StringField('Username',
                         validators=[DataRequired(), Length(min=3, max=20)])
    email = StringField('Email',
                       validators=[DataRequired(), Email()])
    password = PasswordField('Password',
                           validators=[DataRequired(), Length(min=8)])
    confirm_password = PasswordField('Confirm Password',
                                   validators=[DataRequired(), EqualTo('password')])

    def validate_username(self, username):
        user = User.query.filter_by(username=username.data).first()
        if user:
            raise ValidationError('Username already exists')

    def validate_email(self, email):
        user = User.query.filter_by(email=email.data).first()
        if user:
            raise ValidationError('Email already registered')

class LoginForm(FlaskForm):
    email = StringField('Email', validators=[DataRequired(), Email()])
    password = PasswordField('Password', validators=[DataRequired()])
    remember = BooleanField('Remember Me')

class PostForm(FlaskForm):
    title = StringField('Title', validators=[DataRequired(), Length(max=100)])
    content = TextAreaField('Content', validators=[DataRequired()])
    category = SelectField('Category', coerce=int)

    def __init__(self, *args, **kwargs):
        super(PostForm, self).__init__(*args, **kwargs)
        from app.models import Category
        self.category.choices = [(c.id, c.name) for c in Category.query.all()]
</code></pre>
<h3 id="form-handling-in-views"><a class="header" href="#form-handling-in-views">Form Handling in Views</a></h3>
<pre><code class="language-python">from flask import render_template, redirect, url_for, flash
from app import db
from app.forms import RegistrationForm, LoginForm
from app.models import User

@app.route('/register', methods=['GET', 'POST'])
def register():
    form = RegistrationForm()

    if form.validate_on_submit():
        user = User(username=form.username.data, email=form.email.data)
        user.set_password(form.password.data)
        db.session.add(user)
        db.session.commit()

        flash('Registration successful!', 'success')
        return redirect(url_for('login'))

    return render_template('register.html', form=form)

@app.route('/login', methods=['GET', 'POST'])
def login():
    form = LoginForm()

    if form.validate_on_submit():
        user = User.query.filter_by(email=form.email.data).first()

        if user and user.check_password(form.password.data):
            login_user(user, remember=form.remember.data)
            flash('Login successful!', 'success')

            next_page = request.args.get('next')
            return redirect(next_page) if next_page else redirect(url_for('index'))

        flash('Invalid email or password', 'danger')

    return render_template('login.html', form=form)
</code></pre>
<h3 id="form-template"><a class="header" href="#form-template">Form Template</a></h3>
<p><strong>templates/register.html:</strong></p>
<pre><code class="language-html">{% extends 'base.html' %}

{% block content %}
&lt;h2&gt;Register&lt;/h2&gt;
&lt;form method="POST" novalidate&gt;
    {{ form.hidden_tag() }}

    &lt;div class="form-group"&gt;
        {{ form.username.label }}
        {{ form.username(class='form-control') }}
        {% if form.username.errors %}
            &lt;div class="errors"&gt;
                {% for error in form.username.errors %}
                    &lt;span&gt;{{ error }}&lt;/span&gt;
                {% endfor %}
            &lt;/div&gt;
        {% endif %}
    &lt;/div&gt;

    &lt;div class="form-group"&gt;
        {{ form.email.label }}
        {{ form.email(class='form-control') }}
        {% if form.email.errors %}
            &lt;div class="errors"&gt;
                {% for error in form.email.errors %}
                    &lt;span&gt;{{ error }}&lt;/span&gt;
                {% endfor %}
            &lt;/div&gt;
        {% endif %}
    &lt;/div&gt;

    &lt;div class="form-group"&gt;
        {{ form.password.label }}
        {{ form.password(class='form-control') }}
        {% if form.password.errors %}
            &lt;div class="errors"&gt;
                {% for error in form.password.errors %}
                    &lt;span&gt;{{ error }}&lt;/span&gt;
                {% endfor %}
            &lt;/div&gt;
        {% endif %}
    &lt;/div&gt;

    &lt;div class="form-group"&gt;
        {{ form.confirm_password.label }}
        {{ form.confirm_password(class='form-control') }}
    &lt;/div&gt;

    &lt;button type="submit" class="btn btn-primary"&gt;Register&lt;/button&gt;
&lt;/form&gt;
{% endblock %}
</code></pre>
<hr />
<h2 id="database-integration-2"><a class="header" href="#database-integration-2">Database Integration</a></h2>
<h3 id="sqlalchemy-models"><a class="header" href="#sqlalchemy-models">SQLAlchemy Models</a></h3>
<p><strong>app/models.py:</strong></p>
<pre><code class="language-python">from app import db, login_manager
from datetime import datetime
from werkzeug.security import generate_password_hash, check_password_hash
from flask_login import UserMixin

@login_manager.user_loader
def load_user(user_id):
    return User.query.get(int(user_id))

class User(UserMixin, db.Model):
    id = db.Column(db.Integer, primary_key=True)
    username = db.Column(db.String(80), unique=True, nullable=False, index=True)
    email = db.Column(db.String(120), unique=True, nullable=False, index=True)
    password_hash = db.Column(db.String(128))
    created_at = db.Column(db.DateTime, default=datetime.utcnow)
    posts = db.relationship('Post', backref='author', lazy='dynamic')

    def set_password(self, password):
        self.password_hash = generate_password_hash(password)

    def check_password(self, password):
        return check_password_hash(self.password_hash, password)

    def __repr__(self):
        return f'&lt;User {self.username}&gt;'

class Post(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    title = db.Column(db.String(100), nullable=False)
    content = db.Column(db.Text, nullable=False)
    slug = db.Column(db.String(120), unique=True, index=True)
    published = db.Column(db.Boolean, default=False)
    created_at = db.Column(db.DateTime, default=datetime.utcnow)
    updated_at = db.Column(db.DateTime, default=datetime.utcnow, onupdate=datetime.utcnow)
    user_id = db.Column(db.Integer, db.ForeignKey('user.id'), nullable=False)
    category_id = db.Column(db.Integer, db.ForeignKey('category.id'))

    def __repr__(self):
        return f'&lt;Post {self.title}&gt;'

class Category(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    name = db.Column(db.String(50), unique=True, nullable=False)
    posts = db.relationship('Post', backref='category', lazy=True)
</code></pre>
<h3 id="database-operations-3"><a class="header" href="#database-operations-3">Database Operations</a></h3>
<pre><code class="language-python">from app import db
from app.models import User, Post

# Create
user = User(username='john', email='john@example.com')
user.set_password('password123')
db.session.add(user)
db.session.commit()

# Read
users = User.query.all()
user = User.query.filter_by(username='john').first()
user = User.query.get(1)
posts = Post.query.filter_by(published=True).order_by(Post.created_at.desc()).all()

# Update
user = User.query.get(1)
user.email = 'newemail@example.com'
db.session.commit()

# Delete
user = User.query.get(1)
db.session.delete(user)
db.session.commit()

# Complex queries
from sqlalchemy import or_, and_

posts = Post.query.filter(
    or_(
        Post.title.like('%python%'),
        Post.content.like('%python%')
    ),
    Post.published == True
).all()

# Pagination
page = request.args.get('page', 1, type=int)
posts = Post.query.order_by(Post.created_at.desc()).paginate(
    page=page, per_page=10, error_out=False
)
</code></pre>
<h3 id="migrations-1"><a class="header" href="#migrations-1">Migrations</a></h3>
<pre><code class="language-bash"># Initialize migrations
flask db init

# Create migration
flask db migrate -m "Add user table"

# Apply migration
flask db upgrade

# Rollback
flask db downgrade
</code></pre>
<hr />
<h2 id="authentication-7"><a class="header" href="#authentication-7">Authentication</a></h2>
<h3 id="flask-login-setup"><a class="header" href="#flask-login-setup">Flask-Login Setup</a></h3>
<pre><code class="language-python">from flask_login import LoginManager, login_user, logout_user, login_required, current_user
from app import app, db
from app.models import User

login_manager = LoginManager()
login_manager.init_app(app)
login_manager.login_view = 'login'
login_manager.login_message = 'Please log in to access this page.'

@login_manager.user_loader
def load_user(user_id):
    return User.query.get(int(user_id))

@app.route('/login', methods=['GET', 'POST'])
def login():
    if current_user.is_authenticated:
        return redirect(url_for('index'))

    form = LoginForm()
    if form.validate_on_submit():
        user = User.query.filter_by(email=form.email.data).first()

        if user and user.check_password(form.password.data):
            login_user(user, remember=form.remember.data)
            next_page = request.args.get('next')
            return redirect(next_page) if next_page else redirect(url_for('index'))

        flash('Invalid email or password', 'danger')

    return render_template('login.html', form=form)

@app.route('/logout')
@login_required
def logout():
    logout_user()
    flash('You have been logged out', 'info')
    return redirect(url_for('index'))

@app.route('/profile')
@login_required
def profile():
    return render_template('profile.html', user=current_user)
</code></pre>
<h3 id="jwt-authentication-2"><a class="header" href="#jwt-authentication-2">JWT Authentication</a></h3>
<pre><code class="language-python">from flask_jwt_extended import JWTManager, create_access_token, jwt_required, get_jwt_identity

app.config['JWT_SECRET_KEY'] = 'your-secret-key'
jwt = JWTManager(app)

@app.route('/api/auth/login', methods=['POST'])
def api_login():
    data = request.get_json()
    email = data.get('email')
    password = data.get('password')

    user = User.query.filter_by(email=email).first()

    if user and user.check_password(password):
        access_token = create_access_token(identity=user.id)
        return jsonify(access_token=access_token), 200

    return jsonify({'message': 'Invalid credentials'}), 401

@app.route('/api/protected', methods=['GET'])
@jwt_required()
def protected():
    current_user_id = get_jwt_identity()
    user = User.query.get(current_user_id)
    return jsonify(username=user.username), 200
</code></pre>
<hr />
<h2 id="restful-apis"><a class="header" href="#restful-apis">RESTful APIs</a></h2>
<h3 id="flask-restful"><a class="header" href="#flask-restful">Flask-RESTful</a></h3>
<pre><code class="language-python">from flask import Flask
from flask_restful import Resource, Api, reqparse, fields, marshal_with
from app import db
from app.models import Post

app = Flask(__name__)
api = Api(app)

# Request parser
post_parser = reqparse.RequestParser()
post_parser.add_argument('title', type=str, required=True, help='Title is required')
post_parser.add_argument('content', type=str, required=True)
post_parser.add_argument('category_id', type=int)

# Resource fields for serialization
post_fields = {
    'id': fields.Integer,
    'title': fields.String,
    'content': fields.String,
    'created_at': fields.DateTime(dt_format='iso8601'),
    'author': fields.Nested({
        'id': fields.Integer,
        'username': fields.String
    })
}

class PostListAPI(Resource):
    @marshal_with(post_fields)
    def get(self):
        posts = Post.query.all()
        return posts

    @marshal_with(post_fields)
    def post(self):
        args = post_parser.parse_args()
        post = Post(
            title=args['title'],
            content=args['content'],
            user_id=current_user.id,
            category_id=args.get('category_id')
        )
        db.session.add(post)
        db.session.commit()
        return post, 201

class PostAPI(Resource):
    @marshal_with(post_fields)
    def get(self, post_id):
        post = Post.query.get_or_404(post_id)
        return post

    @marshal_with(post_fields)
    def put(self, post_id):
        post = Post.query.get_or_404(post_id)
        args = post_parser.parse_args()
        post.title = args['title']
        post.content = args['content']
        db.session.commit()
        return post

    def delete(self, post_id):
        post = Post.query.get_or_404(post_id)
        db.session.delete(post)
        db.session.commit()
        return '', 204

api.add_resource(PostListAPI, '/api/posts')
api.add_resource(PostAPI, '/api/posts/&lt;int:post_id&gt;')
</code></pre>
<hr />
<h2 id="blueprints"><a class="header" href="#blueprints">Blueprints</a></h2>
<h3 id="creating-blueprints"><a class="header" href="#creating-blueprints">Creating Blueprints</a></h3>
<p><strong>app/blueprints/auth/<strong>init</strong>.py:</strong></p>
<pre><code class="language-python">from flask import Blueprint

auth_bp = Blueprint('auth', __name__)

from app.blueprints.auth import routes
</code></pre>
<p><strong>app/blueprints/auth/routes.py:</strong></p>
<pre><code class="language-python">from flask import render_template, redirect, url_for, flash, request
from flask_login import login_user, logout_user, login_required
from app.blueprints.auth import auth_bp
from app import db
from app.models import User
from app.forms import LoginForm, RegistrationForm

@auth_bp.route('/login', methods=['GET', 'POST'])
def login():
    form = LoginForm()
    if form.validate_on_submit():
        user = User.query.filter_by(email=form.email.data).first()
        if user and user.check_password(form.password.data):
            login_user(user, remember=form.remember.data)
            return redirect(url_for('main.index'))
        flash('Invalid credentials', 'danger')
    return render_template('auth/login.html', form=form)

@auth_bp.route('/logout')
@login_required
def logout():
    logout_user()
    return redirect(url_for('main.index'))

@auth_bp.route('/register', methods=['GET', 'POST'])
def register():
    form = RegistrationForm()
    if form.validate_on_submit():
        user = User(username=form.username.data, email=form.email.data)
        user.set_password(form.password.data)
        db.session.add(user)
        db.session.commit()
        flash('Registration successful!', 'success')
        return redirect(url_for('auth.login'))
    return render_template('auth/register.html', form=form)
</code></pre>
<h3 id="registering-blueprints"><a class="header" href="#registering-blueprints">Registering Blueprints</a></h3>
<p><strong>app/<strong>init</strong>.py:</strong></p>
<pre><code class="language-python">def create_app():
    app = Flask(__name__)

    # Register blueprints
    from app.blueprints.auth import auth_bp
    from app.blueprints.main import main_bp
    from app.blueprints.api import api_bp

    app.register_blueprint(auth_bp, url_prefix='/auth')
    app.register_blueprint(main_bp)
    app.register_blueprint(api_bp, url_prefix='/api')

    return app
</code></pre>
<hr />
<h2 id="error-handling-11"><a class="header" href="#error-handling-11">Error Handling</a></h2>
<pre><code class="language-python">from flask import render_template, jsonify

@app.errorhandler(404)
def not_found_error(error):
    if request.path.startswith('/api/'):
        return jsonify({'error': 'Not found'}), 404
    return render_template('errors/404.html'), 404

@app.errorhandler(500)
def internal_error(error):
    db.session.rollback()
    if request.path.startswith('/api/'):
        return jsonify({'error': 'Internal server error'}), 500
    return render_template('errors/500.html'), 500

@app.errorhandler(403)
def forbidden_error(error):
    return jsonify({'error': 'Forbidden'}), 403

# Custom exception
class ValidationError(Exception):
    pass

@app.errorhandler(ValidationError)
def handle_validation_error(error):
    return jsonify({'error': str(error)}), 400
</code></pre>
<hr />
<h2 id="file-uploads-1"><a class="header" href="#file-uploads-1">File Uploads</a></h2>
<pre><code class="language-python">import os
from werkzeug.utils import secure_filename
from flask import request, flash, redirect, url_for

ALLOWED_EXTENSIONS = {'txt', 'pdf', 'png', 'jpg', 'jpeg', 'gif'}

def allowed_file(filename):
    return '.' in filename and \
           filename.rsplit('.', 1)[1].lower() in ALLOWED_EXTENSIONS

@app.route('/upload', methods=['GET', 'POST'])
@login_required
def upload_file():
    if request.method == 'POST':
        if 'file' not in request.files:
            flash('No file part', 'danger')
            return redirect(request.url)

        file = request.files['file']

        if file.filename == '':
            flash('No selected file', 'danger')
            return redirect(request.url)

        if file and allowed_file(file.filename):
            filename = secure_filename(file.filename)
            filepath = os.path.join(app.config['UPLOAD_FOLDER'], filename)
            file.save(filepath)
            flash('File uploaded successfully', 'success')
            return redirect(url_for('index'))

    return render_template('upload.html')
</code></pre>
<hr />
<h2 id="testing-9"><a class="header" href="#testing-9">Testing</a></h2>
<pre><code class="language-python">import unittest
from app import create_app, db
from app.models import User, Post
from config import TestingConfig

class UserModelTestCase(unittest.TestCase):
    def setUp(self):
        self.app = create_app(TestingConfig)
        self.app_context = self.app.app_context()
        self.app_context.push()
        db.create_all()

    def tearDown(self):
        db.session.remove()
        db.drop_all()
        self.app_context.pop()

    def test_password_hashing(self):
        user = User(username='john', email='john@example.com')
        user.set_password('password')
        self.assertFalse(user.check_password('wrong'))
        self.assertTrue(user.check_password('password'))

class RoutesTestCase(unittest.TestCase):
    def setUp(self):
        self.app = create_app(TestingConfig)
        self.client = self.app.test_client()
        self.app_context = self.app.app_context()
        self.app_context.push()
        db.create_all()

    def tearDown(self):
        db.session.remove()
        db.drop_all()
        self.app_context.pop()

    def test_index_page(self):
        response = self.client.get('/')
        self.assertEqual(response.status_code, 200)

    def test_login(self):
        # Create user
        user = User(username='test', email='test@example.com')
        user.set_password('password')
        db.session.add(user)
        db.session.commit()

        # Test login
        response = self.client.post('/auth/login', data={
            'email': 'test@example.com',
            'password': 'password'
        }, follow_redirects=True)

        self.assertEqual(response.status_code, 200)

if __name__ == '__main__':
    unittest.main()
</code></pre>
<hr />
<h2 id="best-practices-82"><a class="header" href="#best-practices-82">Best Practices</a></h2>
<h3 id="1-application-factory"><a class="header" href="#1-application-factory">1. Application Factory</a></h3>
<pre><code class="language-python">def create_app(config_class=Config):
    app = Flask(__name__)
    app.config.from_object(config_class)

    db.init_app(app)
    migrate.init_app(app, db)

    return app
</code></pre>
<h3 id="2-configuration-management"><a class="header" href="#2-configuration-management">2. Configuration Management</a></h3>
<pre><code class="language-python"># Use environment variables
from dotenv import load_dotenv
load_dotenv()

SECRET_KEY = os.environ.get('SECRET_KEY')
DATABASE_URL = os.environ.get('DATABASE_URL')
</code></pre>
<h3 id="3-error-handling-1"><a class="header" href="#3-error-handling-1">3. Error Handling</a></h3>
<pre><code class="language-python"># Always handle exceptions
try:
    # Database operation
    db.session.commit()
except Exception as e:
    db.session.rollback()
    app.logger.error(f'Error: {str(e)}')
    flash('An error occurred', 'danger')
</code></pre>
<h3 id="4-security-1"><a class="header" href="#4-security-1">4. Security</a></h3>
<pre><code class="language-python"># CSRF protection
from flask_wtf.csrf import CSRFProtect
csrf = CSRFProtect(app)

# Security headers
from flask_talisman import Talisman
Talisman(app, content_security_policy=None)

# Rate limiting
from flask_limiter import Limiter
limiter = Limiter(app, key_func=lambda: request.remote_addr)

@app.route('/api/data')
@limiter.limit("5 per minute")
def api_data():
    return jsonify({'data': []})
</code></pre>
<hr />
<h2 id="production-deployment-3"><a class="header" href="#production-deployment-3">Production Deployment</a></h2>
<h3 id="requirements"><a class="header" href="#requirements">Requirements</a></h3>
<p><strong>requirements.txt:</strong></p>
<pre><code>Flask==3.0.0
Flask-SQLAlchemy==3.1.1
Flask-Migrate==4.0.5
Flask-Login==0.6.3
Flask-WTF==1.2.1
Flask-CORS==4.0.0
Flask-JWT-Extended==4.5.3
python-dotenv==1.0.0
gunicorn==21.2.0
psycopg2-binary==2.9.9
</code></pre>
<h3 id="gunicorn"><a class="header" href="#gunicorn">Gunicorn</a></h3>
<pre><code class="language-bash"># Install
pip install gunicorn

# Run
gunicorn -w 4 -b 0.0.0.0:8000 "app:create_app()"

# With config file
gunicorn -c gunicorn.conf.py "app:create_app()"
</code></pre>
<p><strong>gunicorn.conf.py:</strong></p>
<pre><code class="language-python">bind = '0.0.0.0:8000'
workers = 4
threads = 2
timeout = 30
accesslog = '-'
errorlog = '-'
loglevel = 'info'
</code></pre>
<h3 id="docker-3"><a class="header" href="#docker-3">Docker</a></h3>
<p><strong>Dockerfile:</strong></p>
<pre><code class="language-dockerfile">FROM python:3.11-slim

WORKDIR /app

COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY . .

CMD ["gunicorn", "-c", "gunicorn.conf.py", "app:create_app()"]
</code></pre>
<p><strong>docker-compose.yml:</strong></p>
<pre><code class="language-yaml">version: '3.8'

services:
  web:
    build: .
    ports:
      - "8000:8000"
    environment:
      - FLASK_ENV=production
      - DATABASE_URL=postgresql://user:pass@db:5432/mydb
    depends_on:
      - db

  db:
    image: postgres:15-alpine
    environment:
      POSTGRES_PASSWORD: password
      POSTGRES_DB: mydb
    volumes:
      - postgres_data:/var/lib/postgresql/data

volumes:
  postgres_data:
</code></pre>
<hr />
<h2 id="resources-44"><a class="header" href="#resources-44">Resources</a></h2>
<p><strong>Official Documentation:</strong></p>
<ul>
<li><a href="https://flask.palletsprojects.com/">Flask Documentation</a></li>
<li><a href="https://blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-i-hello-world">Flask Mega-Tutorial</a></li>
<li><a href="https://flask.palletsprojects.com/en/latest/extensions/">Flask Extensions</a></li>
</ul>
<p><strong>Extensions:</strong></p>
<ul>
<li><a href="https://flask-sqlalchemy.palletsprojects.com/">Flask-SQLAlchemy</a></li>
<li><a href="https://flask-login.readthedocs.io/">Flask-Login</a></li>
<li><a href="https://flask-wtf.readthedocs.io/">Flask-WTF</a></li>
<li><a href="https://flask-restful.readthedocs.io/">Flask-RESTful</a></li>
</ul>
<p><strong>Community:</strong></p>
<ul>
<li><a href="https://discord.gg/pallets">Flask Discord</a></li>
<li><a href="https://stackoverflow.com/questions/tagged/flask">Stack Overflow</a></li>
<li><a href="https://www.reddit.com/r/flask/">Reddit r/flask</a></li>
</ul>
<p><strong>Books:</strong></p>
<ul>
<li>Flask Web Development by Miguel Grinberg</li>
<li>Flask Framework Cookbook</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="fastapi"><a class="header" href="#fastapi">FastAPI</a></h1>
<p>FastAPI is a modern, fast (high-performance) web framework for building APIs with Python 3.7+ based on standard Python type hints. It's designed to be easy to use and learn while providing production-ready code with automatic API documentation, data validation, and serialization.</p>
<h2 id="table-of-contents-51"><a class="header" href="#table-of-contents-51">Table of Contents</a></h2>
<ul>
<li><a href="web_development/fastapi.html#introduction">Introduction</a></li>
<li><a href="web_development/fastapi.html#installation-and-setup">Installation and Setup</a></li>
<li><a href="web_development/fastapi.html#basic-application">Basic Application</a></li>
<li><a href="web_development/fastapi.html#path-operations">Path Operations</a></li>
<li><a href="web_development/fastapi.html#request-and-response-models">Request and Response Models</a></li>
<li><a href="web_development/fastapi.html#dependency-injection">Dependency Injection</a></li>
<li><a href="web_development/fastapi.html#database-integration">Database Integration</a></li>
<li><a href="web_development/fastapi.html#authentication-and-security">Authentication and Security</a></li>
<li><a href="web_development/fastapi.html#background-tasks">Background Tasks</a></li>
<li><a href="web_development/fastapi.html#websockets">WebSockets</a></li>
<li><a href="web_development/fastapi.html#file-operations">File Operations</a></li>
<li><a href="web_development/fastapi.html#testing">Testing</a></li>
<li><a href="web_development/fastapi.html#best-practices">Best Practices</a></li>
<li><a href="web_development/fastapi.html#production-deployment">Production Deployment</a></li>
</ul>
<hr />
<h2 id="introduction-31"><a class="header" href="#introduction-31">Introduction</a></h2>
<p><strong>Key Features:</strong></p>
<ul>
<li>Fast performance (on par with NodeJS and Go)</li>
<li>Automatic interactive API documentation (Swagger UI and ReDoc)</li>
<li>Based on standard Python type hints</li>
<li>Data validation using Pydantic</li>
<li>Asynchronous support with async/await</li>
<li>Dependency injection system</li>
<li>OAuth2 and JWT authentication built-in</li>
<li>WebSocket support</li>
<li>GraphQL support</li>
<li>Minimal boilerplate code</li>
<li>Production-ready with automatic error responses</li>
</ul>
<p><strong>Use Cases:</strong></p>
<ul>
<li>RESTful APIs</li>
<li>Microservices</li>
<li>Real-time applications</li>
<li>Machine learning model serving</li>
<li>Data science APIs</li>
<li>Backend for mobile/web applications</li>
<li>API gateways</li>
<li>WebSocket servers</li>
</ul>
<p><strong>Why FastAPI?</strong></p>
<ul>
<li>Fastest Python framework according to benchmarks</li>
<li>Reduces bugs by ~40% with type checking</li>
<li>Easy to learn, fast to code</li>
<li>Editor support with autocomplete</li>
<li>Reduces code duplication</li>
</ul>
<hr />
<h2 id="installation-and-setup-9"><a class="header" href="#installation-and-setup-9">Installation and Setup</a></h2>
<h3 id="prerequisites-4"><a class="header" href="#prerequisites-4">Prerequisites</a></h3>
<pre><code class="language-bash"># Python 3.7+ required
python3 --version
pip --version
</code></pre>
<h3 id="install-fastapi"><a class="header" href="#install-fastapi">Install FastAPI</a></h3>
<pre><code class="language-bash"># Create virtual environment
python3 -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate

# Install FastAPI and Uvicorn
pip install fastapi
pip install "uvicorn[standard]"

# Install additional dependencies
pip install python-multipart  # For file uploads
pip install python-jose[cryptography]  # For JWT
pip install passlib[bcrypt]  # For password hashing
pip install sqlalchemy  # For database
pip install alembic  # For migrations
pip install pydantic[email]  # For email validation
</code></pre>
<h3 id="project-structure-8"><a class="header" href="#project-structure-8">Project Structure</a></h3>
<pre><code>fastapi-app/
├── app/
│   ├── __init__.py
│   ├── main.py
│   ├── config.py
│   ├── database.py
│   ├── dependencies.py
│   ├── models/
│   │   ├── __init__.py
│   │   └── user.py
│   ├── schemas/
│   │   ├── __init__.py
│   │   └── user.py
│   ├── routers/
│   │   ├── __init__.py
│   │   ├── users.py
│   │   └── auth.py
│   ├── services/
│   │   └── auth.py
│   └── utils/
│       └── security.py
├── tests/
│   └── test_main.py
├── alembic/
├── .env
├── requirements.txt
└── README.md
</code></pre>
<hr />
<h2 id="basic-application-2"><a class="header" href="#basic-application-2">Basic Application</a></h2>
<h3 id="minimal-app"><a class="header" href="#minimal-app">Minimal App</a></h3>
<pre><code class="language-python">from fastapi import FastAPI

app = FastAPI()

@app.get("/")
def read_root():
    return {"message": "Hello World"}

@app.get("/items/{item_id}")
def read_item(item_id: int, q: str = None):
    return {"item_id": item_id, "q": q}

# Run with: uvicorn main:app --reload
</code></pre>
<h3 id="full-application-setup"><a class="header" href="#full-application-setup">Full Application Setup</a></h3>
<p><strong>app/main.py:</strong></p>
<pre><code class="language-python">from fastapi import FastAPI
from fastapi.middleware.cors import CORSMiddleware
from app.routers import users, auth, items
from app.database import engine
from app import models

models.Base.metadata.create_all(bind=engine)

app = FastAPI(
    title="My API",
    description="A production-ready FastAPI application",
    version="1.0.0",
    docs_url="/docs",
    redoc_url="/redoc"
)

# CORS middleware
app.add_middleware(
    CORSMiddleware,
    allow_origins=["*"],
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)

# Include routers
app.include_router(auth.router, prefix="/auth", tags=["auth"])
app.include_router(users.router, prefix="/users", tags=["users"])
app.include_router(items.router, prefix="/items", tags=["items"])

@app.get("/")
async def root():
    return {"message": "Welcome to FastAPI"}

@app.get("/health")
async def health_check():
    return {"status": "healthy"}
</code></pre>
<p><strong>app/config.py:</strong></p>
<pre><code class="language-python">from pydantic_settings import BaseSettings

class Settings(BaseSettings):
    app_name: str = "FastAPI App"
    database_url: str = "sqlite:///./test.db"
    secret_key: str = "your-secret-key-here"
    algorithm: str = "HS256"
    access_token_expire_minutes: int = 30

    class Config:
        env_file = ".env"

settings = Settings()
</code></pre>
<hr />
<h2 id="path-operations"><a class="header" href="#path-operations">Path Operations</a></h2>
<h3 id="http-methods-3"><a class="header" href="#http-methods-3">HTTP Methods</a></h3>
<pre><code class="language-python">from fastapi import FastAPI, HTTPException, status
from pydantic import BaseModel
from typing import List, Optional

app = FastAPI()

class Item(BaseModel):
    name: str
    description: Optional[str] = None
    price: float
    tax: Optional[float] = None

# GET
@app.get("/items")
async def get_items():
    return [{"id": 1, "name": "Item 1"}]

# GET with path parameter
@app.get("/items/{item_id}")
async def get_item(item_id: int):
    return {"item_id": item_id}

# POST
@app.post("/items", status_code=status.HTTP_201_CREATED)
async def create_item(item: Item):
    return item

# PUT
@app.put("/items/{item_id}")
async def update_item(item_id: int, item: Item):
    return {"item_id": item_id, **item.dict()}

# PATCH
@app.patch("/items/{item_id}")
async def partial_update_item(item_id: int, item: dict):
    return {"item_id": item_id, "updated_fields": item}

# DELETE
@app.delete("/items/{item_id}", status_code=status.HTTP_204_NO_CONTENT)
async def delete_item(item_id: int):
    return None
</code></pre>
<h3 id="query-parameters-1"><a class="header" href="#query-parameters-1">Query Parameters</a></h3>
<pre><code class="language-python">from typing import Optional, List
from enum import Enum

class SortOrder(str, Enum):
    asc = "asc"
    desc = "desc"

@app.get("/items")
async def list_items(
    skip: int = 0,
    limit: int = 10,
    q: Optional[str] = None,
    sort: SortOrder = SortOrder.asc,
    tags: List[str] = []
):
    return {
        "skip": skip,
        "limit": limit,
        "q": q,
        "sort": sort,
        "tags": tags
    }

# Required query parameter
@app.get("/search")
async def search(q: str):  # Required
    return {"q": q}
</code></pre>
<h3 id="path-parameters"><a class="header" href="#path-parameters">Path Parameters</a></h3>
<pre><code class="language-python">from uuid import UUID
from datetime import date

@app.get("/users/{user_id}")
async def get_user(user_id: int):
    return {"user_id": user_id}

@app.get("/orders/{order_id}")
async def get_order(order_id: UUID):
    return {"order_id": str(order_id)}

@app.get("/posts/{year}/{month}/{day}")
async def get_posts_by_date(year: int, month: int, day: int):
    post_date = date(year, month, day)
    return {"date": post_date}

# Path with validation
from fastapi import Path

@app.get("/items/{item_id}")
async def get_item(
    item_id: int = Path(..., title="The ID of the item", ge=1)
):
    return {"item_id": item_id}
</code></pre>
<hr />
<h2 id="request-and-response-models"><a class="header" href="#request-and-response-models">Request and Response Models</a></h2>
<h3 id="pydantic-models"><a class="header" href="#pydantic-models">Pydantic Models</a></h3>
<pre><code class="language-python">from pydantic import BaseModel, Field, EmailStr, validator
from typing import Optional, List
from datetime import datetime

class UserBase(BaseModel):
    email: EmailStr
    username: str = Field(..., min_length=3, max_length=50)
    full_name: Optional[str] = None

class UserCreate(UserBase):
    password: str = Field(..., min_length=8)

    @validator('password')
    def password_strength(cls, v):
        if not any(char.isdigit() for char in v):
            raise ValueError('Password must contain at least one digit')
        if not any(char.isupper() for char in v):
            raise ValueError('Password must contain at least one uppercase letter')
        return v

class UserUpdate(BaseModel):
    email: Optional[EmailStr] = None
    full_name: Optional[str] = None

class User(UserBase):
    id: int
    is_active: bool = True
    created_at: datetime

    class Config:
        from_attributes = True

class UserInDB(User):
    hashed_password: str

# Product models
class Product(BaseModel):
    name: str
    description: Optional[str] = None
    price: float = Field(..., gt=0, description="Price must be greater than zero")
    tax: Optional[float] = 0
    tags: List[str] = []

class ProductResponse(Product):
    id: int
    created_at: datetime

    class Config:
        from_attributes = True
</code></pre>
<h3 id="request-body"><a class="header" href="#request-body">Request Body</a></h3>
<pre><code class="language-python">from fastapi import Body

@app.post("/users")
async def create_user(user: UserCreate):
    return user

# Multiple body parameters
@app.post("/items")
async def create_item(
    item: Item,
    user: User,
    importance: int = Body(...)
):
    return {"item": item, "user": user, "importance": importance}

# Embed single body parameter
@app.post("/items/{item_id}")
async def update_item(
    item_id: int,
    item: Item = Body(..., embed=True)
):
    return {"item_id": item_id, "item": item}
</code></pre>
<h3 id="response-models"><a class="header" href="#response-models">Response Models</a></h3>
<pre><code class="language-python">from fastapi import Response, status

@app.post("/users", response_model=User, status_code=status.HTTP_201_CREATED)
async def create_user(user: UserCreate):
    # Don't return password in response
    return user

# Multiple response models
from fastapi.responses import JSONResponse

@app.get("/items/{item_id}")
async def get_item(item_id: int):
    if item_id == 0:
        return JSONResponse(
            status_code=404,
            content={"message": "Item not found"}
        )
    return {"item_id": item_id}

# Response with Union types
from typing import Union

@app.get("/items/{item_id}", response_model=Union[Product, dict])
async def get_item(item_id: int):
    if item_id &gt; 0:
        return product
    return {"message": "No item found"}
</code></pre>
<hr />
<h2 id="dependency-injection-1"><a class="header" href="#dependency-injection-1">Dependency Injection</a></h2>
<h3 id="basic-dependencies"><a class="header" href="#basic-dependencies">Basic Dependencies</a></h3>
<pre><code class="language-python">from fastapi import Depends, HTTPException, status
from typing import Optional

# Simple dependency
async def common_parameters(q: Optional[str] = None, skip: int = 0, limit: int = 100):
    return {"q": q, "skip": skip, "limit": limit}

@app.get("/items")
async def read_items(commons: dict = Depends(common_parameters)):
    return commons

# Class-based dependency
class CommonQueryParams:
    def __init__(self, q: Optional[str] = None, skip: int = 0, limit: int = 100):
        self.q = q
        self.skip = skip
        self.limit = limit

@app.get("/users")
async def read_users(commons: CommonQueryParams = Depends()):
    return commons
</code></pre>
<h3 id="database-dependency"><a class="header" href="#database-dependency">Database Dependency</a></h3>
<p><strong>app/database.py:</strong></p>
<pre><code class="language-python">from sqlalchemy import create_engine
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy.orm import sessionmaker, Session
from app.config import settings

engine = create_engine(
    settings.database_url,
    connect_args={"check_same_thread": False} if "sqlite" in settings.database_url else {}
)

SessionLocal = sessionmaker(autocommit=False, autoflush=False, bind=engine)
Base = declarative_base()

def get_db():
    db = SessionLocal()
    try:
        yield db
    finally:
        db.close()
</code></pre>
<h3 id="current-user-dependency"><a class="header" href="#current-user-dependency">Current User Dependency</a></h3>
<pre><code class="language-python">from fastapi import Depends, HTTPException, status
from fastapi.security import OAuth2PasswordBearer
from jose import JWTError, jwt
from sqlalchemy.orm import Session

oauth2_scheme = OAuth2PasswordBearer(tokenUrl="auth/token")

async def get_current_user(
    token: str = Depends(oauth2_scheme),
    db: Session = Depends(get_db)
):
    credentials_exception = HTTPException(
        status_code=status.HTTP_401_UNAUTHORIZED,
        detail="Could not validate credentials",
        headers={"WWW-Authenticate": "Bearer"},
    )

    try:
        payload = jwt.decode(token, settings.secret_key, algorithms=[settings.algorithm])
        user_id: int = payload.get("sub")
        if user_id is None:
            raise credentials_exception
    except JWTError:
        raise credentials_exception

    user = db.query(User).filter(User.id == user_id).first()
    if user is None:
        raise credentials_exception

    return user

# Use dependency
@app.get("/users/me", response_model=User)
async def read_users_me(current_user: User = Depends(get_current_user)):
    return current_user
</code></pre>
<hr />
<h2 id="database-integration-3"><a class="header" href="#database-integration-3">Database Integration</a></h2>
<h3 id="sqlalchemy-models-1"><a class="header" href="#sqlalchemy-models-1">SQLAlchemy Models</a></h3>
<p><strong>app/models/user.py:</strong></p>
<pre><code class="language-python">from sqlalchemy import Boolean, Column, Integer, String, DateTime, ForeignKey
from sqlalchemy.orm import relationship
from sqlalchemy.sql import func
from app.database import Base

class User(Base):
    __tablename__ = "users"

    id = Column(Integer, primary_key=True, index=True)
    email = Column(String, unique=True, index=True, nullable=False)
    username = Column(String, unique=True, index=True, nullable=False)
    full_name = Column(String)
    hashed_password = Column(String, nullable=False)
    is_active = Column(Boolean, default=True)
    is_superuser = Column(Boolean, default=False)
    created_at = Column(DateTime(timezone=True), server_default=func.now())
    updated_at = Column(DateTime(timezone=True), onupdate=func.now())

    items = relationship("Item", back_populates="owner")

class Item(Base):
    __tablename__ = "items"

    id = Column(Integer, primary_key=True, index=True)
    title = Column(String, index=True)
    description = Column(String)
    owner_id = Column(Integer, ForeignKey("users.id"))
    created_at = Column(DateTime(timezone=True), server_default=func.now())

    owner = relationship("User", back_populates="items")
</code></pre>
<h3 id="crud-operations-4"><a class="header" href="#crud-operations-4">CRUD Operations</a></h3>
<p><strong>app/services/user.py:</strong></p>
<pre><code class="language-python">from sqlalchemy.orm import Session
from app.models.user import User
from app.schemas.user import UserCreate, UserUpdate
from app.utils.security import get_password_hash

def get_user(db: Session, user_id: int):
    return db.query(User).filter(User.id == user_id).first()

def get_user_by_email(db: Session, email: str):
    return db.query(User).filter(User.email == email).first()

def get_users(db: Session, skip: int = 0, limit: int = 100):
    return db.query(User).offset(skip).limit(limit).all()

def create_user(db: Session, user: UserCreate):
    hashed_password = get_password_hash(user.password)
    db_user = User(
        email=user.email,
        username=user.username,
        full_name=user.full_name,
        hashed_password=hashed_password
    )
    db.add(db_user)
    db.commit()
    db.refresh(db_user)
    return db_user

def update_user(db: Session, user_id: int, user: UserUpdate):
    db_user = get_user(db, user_id)
    if db_user:
        update_data = user.dict(exclude_unset=True)
        for key, value in update_data.items():
            setattr(db_user, key, value)
        db.commit()
        db.refresh(db_user)
    return db_user

def delete_user(db: Session, user_id: int):
    db_user = get_user(db, user_id)
    if db_user:
        db.delete(db_user)
        db.commit()
    return db_user
</code></pre>
<h3 id="router-with-database"><a class="header" href="#router-with-database">Router with Database</a></h3>
<p><strong>app/routers/users.py:</strong></p>
<pre><code class="language-python">from fastapi import APIRouter, Depends, HTTPException, status
from sqlalchemy.orm import Session
from typing import List
from app.database import get_db
from app.schemas.user import User, UserCreate, UserUpdate
from app.services import user as user_service
from app.dependencies import get_current_active_user

router = APIRouter()

@router.get("/", response_model=List[User])
def read_users(
    skip: int = 0,
    limit: int = 100,
    db: Session = Depends(get_db)
):
    users = user_service.get_users(db, skip=skip, limit=limit)
    return users

@router.get("/{user_id}", response_model=User)
def read_user(user_id: int, db: Session = Depends(get_db)):
    db_user = user_service.get_user(db, user_id=user_id)
    if db_user is None:
        raise HTTPException(status_code=404, detail="User not found")
    return db_user

@router.post("/", response_model=User, status_code=status.HTTP_201_CREATED)
def create_user(user: UserCreate, db: Session = Depends(get_db)):
    db_user = user_service.get_user_by_email(db, email=user.email)
    if db_user:
        raise HTTPException(status_code=400, detail="Email already registered")
    return user_service.create_user(db=db, user=user)

@router.put("/{user_id}", response_model=User)
def update_user(
    user_id: int,
    user: UserUpdate,
    db: Session = Depends(get_db),
    current_user: User = Depends(get_current_active_user)
):
    if current_user.id != user_id and not current_user.is_superuser:
        raise HTTPException(status_code=403, detail="Not authorized")

    db_user = user_service.update_user(db, user_id=user_id, user=user)
    if db_user is None:
        raise HTTPException(status_code=404, detail="User not found")
    return db_user

@router.delete("/{user_id}", status_code=status.HTTP_204_NO_CONTENT)
def delete_user(
    user_id: int,
    db: Session = Depends(get_db),
    current_user: User = Depends(get_current_active_user)
):
    if current_user.id != user_id and not current_user.is_superuser:
        raise HTTPException(status_code=403, detail="Not authorized")

    db_user = user_service.delete_user(db, user_id=user_id)
    if db_user is None:
        raise HTTPException(status_code=404, detail="User not found")
</code></pre>
<hr />
<h2 id="authentication-and-security"><a class="header" href="#authentication-and-security">Authentication and Security</a></h2>
<h3 id="password-hashing-1"><a class="header" href="#password-hashing-1">Password Hashing</a></h3>
<p><strong>app/utils/security.py:</strong></p>
<pre><code class="language-python">from passlib.context import CryptContext
from datetime import datetime, timedelta
from jose import jwt
from app.config import settings

pwd_context = CryptContext(schemes=["bcrypt"], deprecated="auto")

def verify_password(plain_password: str, hashed_password: str) -&gt; bool:
    return pwd_context.verify(plain_password, hashed_password)

def get_password_hash(password: str) -&gt; str:
    return pwd_context.hash(password)

def create_access_token(data: dict, expires_delta: timedelta = None):
    to_encode = data.copy()
    if expires_delta:
        expire = datetime.utcnow() + expires_delta
    else:
        expire = datetime.utcnow() + timedelta(minutes=15)

    to_encode.update({"exp": expire})
    encoded_jwt = jwt.encode(to_encode, settings.secret_key, algorithm=settings.algorithm)
    return encoded_jwt
</code></pre>
<h3 id="jwt-authentication-3"><a class="header" href="#jwt-authentication-3">JWT Authentication</a></h3>
<p><strong>app/routers/auth.py:</strong></p>
<pre><code class="language-python">from fastapi import APIRouter, Depends, HTTPException, status
from fastapi.security import OAuth2PasswordBearer, OAuth2PasswordRequestForm
from sqlalchemy.orm import Session
from datetime import timedelta
from app.database import get_db
from app.schemas.auth import Token
from app.services import user as user_service
from app.utils.security import verify_password, create_access_token
from app.config import settings

router = APIRouter()

@router.post("/token", response_model=Token)
async def login(
    form_data: OAuth2PasswordRequestForm = Depends(),
    db: Session = Depends(get_db)
):
    user = user_service.get_user_by_email(db, email=form_data.username)

    if not user or not verify_password(form_data.password, user.hashed_password):
        raise HTTPException(
            status_code=status.HTTP_401_UNAUTHORIZED,
            detail="Incorrect email or password",
            headers={"WWW-Authenticate": "Bearer"},
        )

    if not user.is_active:
        raise HTTPException(status_code=400, detail="Inactive user")

    access_token_expires = timedelta(minutes=settings.access_token_expire_minutes)
    access_token = create_access_token(
        data={"sub": str(user.id)},
        expires_delta=access_token_expires
    )

    return {"access_token": access_token, "token_type": "bearer"}

@router.post("/register", response_model=User, status_code=status.HTTP_201_CREATED)
async def register(user: UserCreate, db: Session = Depends(get_db)):
    db_user = user_service.get_user_by_email(db, email=user.email)
    if db_user:
        raise HTTPException(status_code=400, detail="Email already registered")

    return user_service.create_user(db=db, user=user)
</code></pre>
<h3 id="api-key-authentication"><a class="header" href="#api-key-authentication">API Key Authentication</a></h3>
<pre><code class="language-python">from fastapi import Security, HTTPException, status
from fastapi.security.api_key import APIKeyHeader

API_KEY = "your-api-key-here"
api_key_header = APIKeyHeader(name="X-API-Key")

async def verify_api_key(api_key: str = Security(api_key_header)):
    if api_key != API_KEY:
        raise HTTPException(
            status_code=status.HTTP_401_UNAUTHORIZED,
            detail="Invalid API Key"
        )
    return api_key

@app.get("/secure-data")
async def get_secure_data(api_key: str = Depends(verify_api_key)):
    return {"data": "sensitive information"}
</code></pre>
<hr />
<h2 id="background-tasks"><a class="header" href="#background-tasks">Background Tasks</a></h2>
<pre><code class="language-python">from fastapi import BackgroundTasks
import smtplib
from email.mime.text import MIMEText

def send_email(email: str, subject: str, body: str):
    # Email sending logic
    print(f"Sending email to {email}: {subject}")

def write_log(message: str):
    with open("log.txt", mode="a") as log:
        log.write(message + "\n")

@app.post("/send-notification/{email}")
async def send_notification(
    email: str,
    background_tasks: BackgroundTasks
):
    background_tasks.add_task(send_email, email, "Welcome!", "Thanks for signing up")
    background_tasks.add_task(write_log, f"Notification sent to {email}")
    return {"message": "Notification sent in the background"}

# Multiple background tasks
@app.post("/users")
async def create_user(
    user: UserCreate,
    background_tasks: BackgroundTasks,
    db: Session = Depends(get_db)
):
    db_user = user_service.create_user(db, user)

    background_tasks.add_task(send_email, user.email, "Welcome", "Thanks for joining!")
    background_tasks.add_task(write_log, f"User created: {user.email}")

    return db_user
</code></pre>
<hr />
<h2 id="websockets"><a class="header" href="#websockets">WebSockets</a></h2>
<pre><code class="language-python">from fastapi import WebSocket, WebSocketDisconnect
from typing import List

class ConnectionManager:
    def __init__(self):
        self.active_connections: List[WebSocket] = []

    async def connect(self, websocket: WebSocket):
        await websocket.accept()
        self.active_connections.append(websocket)

    def disconnect(self, websocket: WebSocket):
        self.active_connections.remove(websocket)

    async def send_personal_message(self, message: str, websocket: WebSocket):
        await websocket.send_text(message)

    async def broadcast(self, message: str):
        for connection in self.active_connections:
            await connection.send_text(message)

manager = ConnectionManager()

@app.websocket("/ws/{client_id}")
async def websocket_endpoint(websocket: WebSocket, client_id: int):
    await manager.connect(websocket)
    try:
        while True:
            data = await websocket.receive_text()
            await manager.send_personal_message(f"You wrote: {data}", websocket)
            await manager.broadcast(f"Client #{client_id} says: {data}")
    except WebSocketDisconnect:
        manager.disconnect(websocket)
        await manager.broadcast(f"Client #{client_id} left the chat")
</code></pre>
<hr />
<h2 id="file-operations-4"><a class="header" href="#file-operations-4">File Operations</a></h2>
<h3 id="file-upload"><a class="header" href="#file-upload">File Upload</a></h3>
<pre><code class="language-python">from fastapi import File, UploadFile
from typing import List
import shutil
from pathlib import Path

UPLOAD_DIR = Path("uploads")
UPLOAD_DIR.mkdir(exist_ok=True)

@app.post("/upload")
async def upload_file(file: UploadFile = File(...)):
    file_path = UPLOAD_DIR / file.filename

    with file_path.open("wb") as buffer:
        shutil.copyfileobj(file.file, buffer)

    return {
        "filename": file.filename,
        "content_type": file.content_type,
        "size": file_path.stat().st_size
    }

@app.post("/upload-multiple")
async def upload_multiple_files(files: List[UploadFile] = File(...)):
    file_info = []

    for file in files:
        file_path = UPLOAD_DIR / file.filename
        with file_path.open("wb") as buffer:
            shutil.copyfileobj(file.file, buffer)

        file_info.append({
            "filename": file.filename,
            "size": file_path.stat().st_size
        })

    return {"files": file_info}
</code></pre>
<h3 id="file-download"><a class="header" href="#file-download">File Download</a></h3>
<pre><code class="language-python">from fastapi.responses import FileResponse, StreamingResponse
import io

@app.get("/download/{filename}")
async def download_file(filename: str):
    file_path = UPLOAD_DIR / filename

    if not file_path.exists():
        raise HTTPException(status_code=404, detail="File not found")

    return FileResponse(file_path, filename=filename)

@app.get("/stream")
async def stream_file():
    def iterfile():
        with open("large_file.txt", mode="rb") as file:
            yield from file

    return StreamingResponse(iterfile(), media_type="text/plain")
</code></pre>
<hr />
<h2 id="testing-10"><a class="header" href="#testing-10">Testing</a></h2>
<pre><code class="language-python">from fastapi.testclient import TestClient
from app.main import app
from app.database import Base, engine, get_db
from sqlalchemy import create_engine
from sqlalchemy.orm import sessionmaker

# Test database
SQLALCHEMY_DATABASE_URL = "sqlite:///./test.db"
test_engine = create_engine(SQLALCHEMY_DATABASE_URL, connect_args={"check_same_thread": False})
TestingSessionLocal = sessionmaker(autocommit=False, autoflush=False, bind=test_engine)

def override_get_db():
    try:
        db = TestingSessionLocal()
        yield db
    finally:
        db.close()

app.dependency_overrides[get_db] = override_get_db

client = TestClient(app)

# Test functions
def test_read_root():
    response = client.get("/")
    assert response.status_code == 200
    assert response.json() == {"message": "Welcome to FastAPI"}

def test_create_user():
    Base.metadata.create_all(bind=test_engine)

    response = client.post(
        "/users",
        json={
            "email": "test@example.com",
            "username": "testuser",
            "password": "TestPass123"
        }
    )
    assert response.status_code == 201
    data = response.json()
    assert data["email"] == "test@example.com"
    assert "id" in data

    Base.metadata.drop_all(bind=test_engine)

def test_login():
    Base.metadata.create_all(bind=test_engine)

    # Create user
    client.post(
        "/auth/register",
        json={
            "email": "test@example.com",
            "username": "testuser",
            "password": "TestPass123"
        }
    )

    # Login
    response = client.post(
        "/auth/token",
        data={
            "username": "test@example.com",
            "password": "TestPass123"
        }
    )
    assert response.status_code == 200
    assert "access_token" in response.json()

    Base.metadata.drop_all(bind=test_engine)

def test_authenticated_route():
    # Get token
    response = client.post("/auth/token", data={"username": "test@example.com", "password": "TestPass123"})
    token = response.json()["access_token"]

    # Access protected route
    response = client.get(
        "/users/me",
        headers={"Authorization": f"Bearer {token}"}
    )
    assert response.status_code == 200
</code></pre>
<hr />
<h2 id="best-practices-83"><a class="header" href="#best-practices-83">Best Practices</a></h2>
<h3 id="1-project-structure"><a class="header" href="#1-project-structure">1. Project Structure</a></h3>
<pre><code class="language-python"># Use modular structure with routers
app/
├── routers/
│   ├── users.py
│   ├── items.py
│   └── auth.py
├── models/
├── schemas/
├── services/
└── utils/
</code></pre>
<h3 id="2-environment-variables"><a class="header" href="#2-environment-variables">2. Environment Variables</a></h3>
<pre><code class="language-python">from pydantic_settings import BaseSettings

class Settings(BaseSettings):
    database_url: str
    secret_key: str

    class Config:
        env_file = ".env"
</code></pre>
<h3 id="3-error-handling-2"><a class="header" href="#3-error-handling-2">3. Error Handling</a></h3>
<pre><code class="language-python">from fastapi import HTTPException, Request
from fastapi.responses import JSONResponse

@app.exception_handler(ValueError)
async def value_error_handler(request: Request, exc: ValueError):
    return JSONResponse(
        status_code=400,
        content={"message": str(exc)}
    )
</code></pre>
<h3 id="4-async-operations"><a class="header" href="#4-async-operations">4. Async Operations</a></h3>
<pre><code class="language-python">import asyncio
import httpx

@app.get("/external-api")
async def call_external_api():
    async with httpx.AsyncClient() as client:
        response = await client.get("https://api.example.com/data")
        return response.json()
</code></pre>
<h3 id="5-middleware"><a class="header" href="#5-middleware">5. Middleware</a></h3>
<pre><code class="language-python">import time
from fastapi import Request

@app.middleware("http")
async def add_process_time_header(request: Request, call_next):
    start_time = time.time()
    response = await call_next(request)
    process_time = time.time() - start_time
    response.headers["X-Process-Time"] = str(process_time)
    return response
</code></pre>
<hr />
<h2 id="production-deployment-4"><a class="header" href="#production-deployment-4">Production Deployment</a></h2>
<h3 id="requirements-1"><a class="header" href="#requirements-1">Requirements</a></h3>
<p><strong>requirements.txt:</strong></p>
<pre><code>fastapi==0.104.1
uvicorn[standard]==0.24.0
sqlalchemy==2.0.23
alembic==1.12.1
pydantic[email]==2.5.0
python-jose[cryptography]==3.3.0
passlib[bcrypt]==1.7.4
python-multipart==0.0.6
python-dotenv==1.0.0
</code></pre>
<h3 id="uvicorn-with-workers"><a class="header" href="#uvicorn-with-workers">Uvicorn with Workers</a></h3>
<pre><code class="language-bash"># Development
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000

# Production
uvicorn app.main:app --host 0.0.0.0 --port 8000 --workers 4

# With Gunicorn
gunicorn app.main:app --workers 4 --worker-class uvicorn.workers.UvicornWorker --bind 0.0.0.0:8000
</code></pre>
<h3 id="docker-4"><a class="header" href="#docker-4">Docker</a></h3>
<p><strong>Dockerfile:</strong></p>
<pre><code class="language-dockerfile">FROM python:3.11-slim

WORKDIR /app

COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY ./app ./app

CMD ["uvicorn", "app.main:app", "--host", "0.0.0.0", "--port", "8000"]
</code></pre>
<p><strong>docker-compose.yml:</strong></p>
<pre><code class="language-yaml">version: '3.8'

services:
  api:
    build: .
    ports:
      - "8000:8000"
    environment:
      - DATABASE_URL=postgresql://user:password@db:5432/mydb
      - SECRET_KEY=${SECRET_KEY}
    depends_on:
      - db

  db:
    image: postgres:15-alpine
    environment:
      POSTGRES_PASSWORD: password
      POSTGRES_DB: mydb
    volumes:
      - postgres_data:/var/lib/postgresql/data

volumes:
  postgres_data:
</code></pre>
<hr />
<h2 id="resources-45"><a class="header" href="#resources-45">Resources</a></h2>
<p><strong>Official Documentation:</strong></p>
<ul>
<li><a href="https://fastapi.tiangolo.com/">FastAPI Documentation</a></li>
<li><a href="https://github.com/tiangolo/fastapi">FastAPI GitHub</a></li>
<li><a href="https://docs.pydantic.dev/">Pydantic Documentation</a></li>
</ul>
<p><strong>Learning Resources:</strong></p>
<ul>
<li><a href="https://fastapi.tiangolo.com/tutorial/">FastAPI Tutorial</a></li>
<li><a href="https://github.com/tiangolo/full-stack-fastapi-template">Full Stack FastAPI Template</a></li>
<li><a href="https://github.com/mjhea0/awesome-fastapi">Awesome FastAPI</a></li>
</ul>
<p><strong>Community:</strong></p>
<ul>
<li><a href="https://discord.com/invite/VQjSZaeJmf">FastAPI Discord</a></li>
<li><a href="https://stackoverflow.com/questions/tagged/fastapi">Stack Overflow</a></li>
<li><a href="https://github.com/tiangolo/fastapi/discussions">GitHub Discussions</a></li>
</ul>
<p><strong>Related Tools:</strong></p>
<ul>
<li><a href="https://sqlmodel.tiangolo.com/">SQLModel</a> - SQL databases with Python</li>
<li><a href="https://www.uvicorn.org/">Uvicorn</a> - ASGI server</li>
<li><a href="https://www.starlette.io/">Starlette</a> - Underlying framework</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="web-apis"><a class="header" href="#web-apis">Web APIs</a></h1>
<h2 id="overview-96"><a class="header" href="#overview-96">Overview</a></h2>
<p>Web APIs are interfaces provided by browsers that allow JavaScript to interact with browser features, device hardware, and web platform capabilities. These APIs enable rich, interactive web applications without requiring plugins or native code.</p>
<h2 id="storage-apis"><a class="header" href="#storage-apis">Storage APIs</a></h2>
<h3 id="web-storage-localstorage--sessionstorage"><a class="header" href="#web-storage-localstorage--sessionstorage">Web Storage (localStorage &amp; sessionStorage)</a></h3>
<p>Simple key-value storage for strings:</p>
<pre><code class="language-javascript">// LocalStorage (persists across sessions)
// Store data
localStorage.setItem('username', 'john_doe');
localStorage.setItem('theme', 'dark');

// Retrieve data
const username = localStorage.getItem('username');
console.log(username); // 'john_doe'

// Store objects (must serialize)
const user = { name: 'John', age: 30 };
localStorage.setItem('user', JSON.stringify(user));

// Retrieve objects (must parse)
const storedUser = JSON.parse(localStorage.getItem('user'));

// Remove item
localStorage.removeItem('username');

// Clear all
localStorage.clear();

// Get all keys
for (let i = 0; i &lt; localStorage.length; i++) {
  const key = localStorage.key(i);
  console.log(key, localStorage.getItem(key));
}

// SessionStorage (cleared when tab closes)
sessionStorage.setItem('sessionId', '12345');
sessionStorage.getItem('sessionId');

// Storage event (listen for changes in other tabs)
window.addEventListener('storage', (e) =&gt; {
  console.log('Storage changed:');
  console.log('Key:', e.key);
  console.log('Old value:', e.oldValue);
  console.log('New value:', e.newValue);
  console.log('URL:', e.url);
});

// Limitations:
// - 5-10 MB limit (varies by browser)
// - Strings only (must serialize objects)
// - Synchronous (blocks main thread)
// - No expiration mechanism
</code></pre>
<h3 id="indexeddb"><a class="header" href="#indexeddb">IndexedDB</a></h3>
<p>Powerful client-side database for structured data:</p>
<pre><code class="language-javascript">// Open database
const request = indexedDB.open('MyDatabase', 1);

// Create object stores (like tables)
request.onupgradeneeded = (event) =&gt; {
  const db = event.target.result;

  // Create object store
  const objectStore = db.createObjectStore('users', {
    keyPath: 'id',
    autoIncrement: true
  });

  // Create indexes
  objectStore.createIndex('email', 'email', { unique: true });
  objectStore.createIndex('name', 'name', { unique: false });

  console.log('Database upgraded');
};

request.onsuccess = (event) =&gt; {
  const db = event.target.result;
  console.log('Database opened successfully');

  // Add data
  const transaction = db.transaction(['users'], 'readwrite');
  const objectStore = transaction.objectStore('users');

  const user = {
    name: 'John Doe',
    email: 'john@example.com',
    age: 30
  };

  const addRequest = objectStore.add(user);

  addRequest.onsuccess = () =&gt; {
    console.log('User added with ID:', addRequest.result);
  };

  // Get data by key
  const getRequest = objectStore.get(1);
  getRequest.onsuccess = () =&gt; {
    console.log('User:', getRequest.result);
  };

  // Get by index
  const index = objectStore.index('email');
  const emailRequest = index.get('john@example.com');
  emailRequest.onsuccess = () =&gt; {
    console.log('User by email:', emailRequest.result);
  };

  // Update data
  const updateRequest = objectStore.put({
    id: 1,
    name: 'John Smith',
    email: 'john@example.com',
    age: 31
  });

  // Delete data
  const deleteRequest = objectStore.delete(1);

  // Get all data
  const getAllRequest = objectStore.getAll();
  getAllRequest.onsuccess = () =&gt; {
    console.log('All users:', getAllRequest.result);
  };

  // Cursor (iterate over records)
  const cursorRequest = objectStore.openCursor();
  cursorRequest.onsuccess = (event) =&gt; {
    const cursor = event.target.result;
    if (cursor) {
      console.log('Record:', cursor.value);
      cursor.continue(); // Move to next record
    }
  };
};

request.onerror = (event) =&gt; {
  console.error('Database error:', event.target.error);
};

// Promised-based wrapper (easier to use)
class IndexedDBHelper {
  constructor(dbName, version) {
    this.dbName = dbName;
    this.version = version;
    this.db = null;
  }

  async open(upgrade) {
    return new Promise((resolve, reject) =&gt; {
      const request = indexedDB.open(this.dbName, this.version);

      request.onupgradeneeded = (event) =&gt; {
        if (upgrade) {
          upgrade(event.target.result);
        }
      };

      request.onsuccess = (event) =&gt; {
        this.db = event.target.result;
        resolve(this.db);
      };

      request.onerror = () =&gt; reject(request.error);
    });
  }

  async add(storeName, data) {
    return new Promise((resolve, reject) =&gt; {
      const transaction = this.db.transaction([storeName], 'readwrite');
      const store = transaction.objectStore(storeName);
      const request = store.add(data);

      request.onsuccess = () =&gt; resolve(request.result);
      request.onerror = () =&gt; reject(request.error);
    });
  }

  async get(storeName, key) {
    return new Promise((resolve, reject) =&gt; {
      const transaction = this.db.transaction([storeName], 'readonly');
      const store = transaction.objectStore(storeName);
      const request = store.get(key);

      request.onsuccess = () =&gt; resolve(request.result);
      request.onerror = () =&gt; reject(request.error);
    });
  }

  async getAll(storeName) {
    return new Promise((resolve, reject) =&gt; {
      const transaction = this.db.transaction([storeName], 'readonly');
      const store = transaction.objectStore(storeName);
      const request = store.getAll();

      request.onsuccess = () =&gt; resolve(request.result);
      request.onerror = () =&gt; reject(request.error);
    });
  }

  async update(storeName, data) {
    return new Promise((resolve, reject) =&gt; {
      const transaction = this.db.transaction([storeName], 'readwrite');
      const store = transaction.objectStore(storeName);
      const request = store.put(data);

      request.onsuccess = () =&gt; resolve(request.result);
      request.onerror = () =&gt; reject(request.error);
    });
  }

  async delete(storeName, key) {
    return new Promise((resolve, reject) =&gt; {
      const transaction = this.db.transaction([storeName], 'readwrite');
      const store = transaction.objectStore(storeName);
      const request = store.delete(key);

      request.onsuccess = () =&gt; resolve();
      request.onerror = () =&gt; reject(request.error);
    });
  }
}

// Usage
const db = new IndexedDBHelper('MyApp', 1);

await db.open((database) =&gt; {
  const store = database.createObjectStore('users', { keyPath: 'id', autoIncrement: true });
  store.createIndex('email', 'email', { unique: true });
});

await db.add('users', { name: 'John', email: 'john@example.com' });
const users = await db.getAll('users');
console.log(users);
</code></pre>
<h3 id="cache-api"><a class="header" href="#cache-api">Cache API</a></h3>
<p>Store network requests and responses:</p>
<pre><code class="language-javascript">// Open cache
const cache = await caches.open('my-cache-v1');

// Add to cache
await cache.add('/api/data');
await cache.addAll([
  '/styles.css',
  '/script.js',
  '/image.png'
]);

// Put custom response in cache
const response = new Response(JSON.stringify({ data: 'cached' }), {
  headers: { 'Content-Type': 'application/json' }
});
await cache.put('/api/custom', response);

// Get from cache
const cachedResponse = await cache.match('/api/data');
if (cachedResponse) {
  const data = await cachedResponse.json();
  console.log('Cached data:', data);
}

// Delete from cache
await cache.delete('/api/data');

// Get all keys
const keys = await cache.keys();
console.log('Cached URLs:', keys.map(req =&gt; req.url));

// Delete old caches
const cacheWhitelist = ['my-cache-v2'];
const cacheNames = await caches.keys();
await Promise.all(
  cacheNames.map(cacheName =&gt; {
    if (!cacheWhitelist.includes(cacheName)) {
      return caches.delete(cacheName);
    }
  })
);

// Cache-first strategy
async function fetchWithCache(url) {
  const cachedResponse = await caches.match(url);
  if (cachedResponse) {
    return cachedResponse;
  }

  const response = await fetch(url);
  const cache = await caches.open('my-cache-v1');
  cache.put(url, response.clone());
  return response;
}

// Network-first strategy
async function fetchNetworkFirst(url) {
  try {
    const response = await fetch(url);
    const cache = await caches.open('my-cache-v1');
    cache.put(url, response.clone());
    return response;
  } catch (error) {
    const cachedResponse = await caches.match(url);
    if (cachedResponse) {
      return cachedResponse;
    }
    throw error;
  }
}
</code></pre>
<h2 id="web-workers"><a class="header" href="#web-workers">Web Workers</a></h2>
<h3 id="worker-background-threads"><a class="header" href="#worker-background-threads">Worker (Background Threads)</a></h3>
<p>Run JavaScript in background threads:</p>
<pre><code class="language-javascript">// main.js - Main thread
const worker = new Worker('worker.js');

// Send message to worker
worker.postMessage({ type: 'calculate', data: [1, 2, 3, 4, 5] });

// Receive message from worker
worker.onmessage = (event) =&gt; {
  console.log('Result from worker:', event.data);
};

worker.onerror = (error) =&gt; {
  console.error('Worker error:', error.message);
};

// Terminate worker
worker.terminate();

// ============================================
// worker.js - Worker thread
self.onmessage = (event) =&gt; {
  const { type, data } = event.data;

  if (type === 'calculate') {
    // Perform heavy computation
    const result = data.reduce((sum, num) =&gt; sum + num, 0);

    // Send result back to main thread
    self.postMessage(result);
  }
};

// Worker can't access:
// - DOM
// - window object
// - document object
// - parent object

// Worker can access:
// - navigator
// - location (read-only)
// - XMLHttpRequest / fetch
// - setTimeout / setInterval
// - IndexedDB
// - Cache API

// ============================================
// Advanced: Transferable objects (zero-copy)
const buffer = new ArrayBuffer(1024 * 1024); // 1 MB
worker.postMessage({ buffer }, [buffer]); // Transfer ownership
// buffer is now unusable in main thread

// ============================================
// Inline worker (no separate file)
const code = `
  self.onmessage = (e) =&gt; {
    self.postMessage(e.data * 2);
  };
`;

const blob = new Blob([code], { type: 'application/javascript' });
const workerUrl = URL.createObjectURL(blob);
const inlineWorker = new Worker(workerUrl);

inlineWorker.postMessage(5);
inlineWorker.onmessage = (e) =&gt; {
  console.log('Result:', e.data); // 10
};

// ============================================
// Shared Worker (shared across tabs)
const sharedWorker = new SharedWorker('shared-worker.js');

sharedWorker.port.postMessage('hello');
sharedWorker.port.onmessage = (event) =&gt; {
  console.log('From shared worker:', event.data);
};

// shared-worker.js
const connections = [];

self.onconnect = (event) =&gt; {
  const port = event.ports[0];
  connections.push(port);

  port.onmessage = (e) =&gt; {
    // Broadcast to all connections
    connections.forEach(conn =&gt; {
      conn.postMessage(`Broadcast: ${e.data}`);
    });
  };
};
</code></pre>
<h3 id="service-worker"><a class="header" href="#service-worker">Service Worker</a></h3>
<p>Powerful worker for offline capabilities and caching:</p>
<pre><code class="language-javascript">// Register service worker
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('/service-worker.js')
    .then(registration =&gt; {
      console.log('Service Worker registered:', registration.scope);

      // Check for updates
      registration.addEventListener('updatefound', () =&gt; {
        const newWorker = registration.installing;
        console.log('New service worker installing');

        newWorker.addEventListener('statechange', () =&gt; {
          if (newWorker.state === 'installed') {
            if (navigator.serviceWorker.controller) {
              console.log('New version available, please refresh');
            } else {
              console.log('Content cached for offline use');
            }
          }
        });
      });
    })
    .catch(error =&gt; {
      console.error('Service Worker registration failed:', error);
    });

  // Listen for messages from service worker
  navigator.serviceWorker.addEventListener('message', (event) =&gt; {
    console.log('Message from SW:', event.data);
  });
}

// ============================================
// service-worker.js
const CACHE_NAME = 'my-app-v1';
const urlsToCache = [
  '/',
  '/styles.css',
  '/script.js',
  '/offline.html'
];

// Install event - cache resources
self.addEventListener('install', (event) =&gt; {
  console.log('Service Worker installing');

  event.waitUntil(
    caches.open(CACHE_NAME)
      .then(cache =&gt; {
        console.log('Caching resources');
        return cache.addAll(urlsToCache);
      })
      .then(() =&gt; self.skipWaiting()) // Activate immediately
  );
});

// Activate event - clean up old caches
self.addEventListener('activate', (event) =&gt; {
  console.log('Service Worker activating');

  event.waitUntil(
    caches.keys().then(cacheNames =&gt; {
      return Promise.all(
        cacheNames.map(cacheName =&gt; {
          if (cacheName !== CACHE_NAME) {
            console.log('Deleting old cache:', cacheName);
            return caches.delete(cacheName);
          }
        })
      );
    }).then(() =&gt; self.clients.claim()) // Take control immediately
  );
});

// Fetch event - serve from cache
self.addEventListener('fetch', (event) =&gt; {
  event.respondWith(
    caches.match(event.request)
      .then(response =&gt; {
        // Return cached version or fetch from network
        return response || fetch(event.request)
          .then(fetchResponse =&gt; {
            // Cache new resources
            return caches.open(CACHE_NAME)
              .then(cache =&gt; {
                cache.put(event.request, fetchResponse.clone());
                return fetchResponse;
              });
          })
          .catch(() =&gt; {
            // Return offline page if fetch fails
            return caches.match('/offline.html');
          });
      })
  );
});

// Push notification event
self.addEventListener('push', (event) =&gt; {
  const data = event.data ? event.data.json() : {};

  event.waitUntil(
    self.registration.showNotification(data.title, {
      body: data.body,
      icon: '/icon.png',
      badge: '/badge.png',
      data: data.url
    })
  );
});

// Notification click event
self.addEventListener('notificationclick', (event) =&gt; {
  event.notification.close();

  event.waitUntil(
    clients.openWindow(event.notification.data)
  );
});

// Sync event (background sync)
self.addEventListener('sync', (event) =&gt; {
  if (event.tag === 'sync-messages') {
    event.waitUntil(syncMessages());
  }
});

async function syncMessages() {
  // Sync pending messages
  const messages = await getUnsyncedMessages();
  await Promise.all(
    messages.map(msg =&gt; fetch('/api/messages', {
      method: 'POST',
      body: JSON.stringify(msg)
    }))
  );
}

// Message from client
self.addEventListener('message', (event) =&gt; {
  if (event.data.type === 'SKIP_WAITING') {
    self.skipWaiting();
  }
});
</code></pre>
<h2 id="notification-api"><a class="header" href="#notification-api">Notification API</a></h2>
<p>Display system notifications:</p>
<pre><code class="language-javascript">// Request permission
async function requestNotificationPermission() {
  const permission = await Notification.requestPermission();

  if (permission === 'granted') {
    console.log('Notification permission granted');
  } else if (permission === 'denied') {
    console.log('Notification permission denied');
  }
}

// Check current permission
console.log('Permission:', Notification.permission);
// 'default', 'granted', or 'denied'

// Show notification (simple)
if (Notification.permission === 'granted') {
  new Notification('Hello!', {
    body: 'This is a notification',
    icon: '/icon.png',
    badge: '/badge.png'
  });
}

// Show notification (advanced)
const notification = new Notification('New Message', {
  body: 'You have 3 new messages',
  icon: '/icon.png',
  badge: '/badge.png',
  image: '/banner.png',
  tag: 'message-notification', // Replaces notifications with same tag
  renotify: true, // Notify even if same tag exists
  requireInteraction: false, // Auto-dismiss
  silent: false,
  vibrate: [200, 100, 200], // Vibration pattern
  timestamp: Date.now(),
  actions: [
    { action: 'view', title: 'View', icon: '/view.png' },
    { action: 'dismiss', title: 'Dismiss', icon: '/dismiss.png' }
  ],
  data: { url: '/messages' } // Custom data
});

// Event handlers
notification.onclick = (event) =&gt; {
  console.log('Notification clicked');
  window.focus();
  notification.close();
};

notification.onclose = () =&gt; {
  console.log('Notification closed');
};

notification.onerror = (error) =&gt; {
  console.error('Notification error:', error);
};

notification.onshow = () =&gt; {
  console.log('Notification shown');
};

// Close notification
setTimeout(() =&gt; {
  notification.close();
}, 5000);

// Service Worker notifications (recommended)
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.ready.then(registration =&gt; {
    registration.showNotification('Title', {
      body: 'Body text',
      icon: '/icon.png',
      actions: [
        { action: 'yes', title: 'Yes' },
        { action: 'no', title: 'No' }
      ]
    });
  });
}
</code></pre>
<h2 id="geolocation-api"><a class="header" href="#geolocation-api">Geolocation API</a></h2>
<p>Access device location:</p>
<pre><code class="language-javascript">// Check if available
if ('geolocation' in navigator) {
  console.log('Geolocation is available');
}

// Get current position (one-time)
navigator.geolocation.getCurrentPosition(
  // Success callback
  (position) =&gt; {
    console.log('Latitude:', position.coords.latitude);
    console.log('Longitude:', position.coords.longitude);
    console.log('Accuracy:', position.coords.accuracy, 'meters');
    console.log('Altitude:', position.coords.altitude);
    console.log('Altitude accuracy:', position.coords.altitudeAccuracy);
    console.log('Heading:', position.coords.heading); // Direction of travel
    console.log('Speed:', position.coords.speed); // meters/second
    console.log('Timestamp:', position.timestamp);
  },
  // Error callback
  (error) =&gt; {
    switch (error.code) {
      case error.PERMISSION_DENIED:
        console.error('User denied geolocation');
        break;
      case error.POSITION_UNAVAILABLE:
        console.error('Position unavailable');
        break;
      case error.TIMEOUT:
        console.error('Request timeout');
        break;
    }
  },
  // Options
  {
    enableHighAccuracy: true, // Use GPS (more battery)
    timeout: 5000, // 5 seconds
    maximumAge: 0 // Don't use cached position
  }
);

// Watch position (continuous updates)
const watchId = navigator.geolocation.watchPosition(
  (position) =&gt; {
    console.log('Position updated:', position.coords);
    updateMapMarker(position.coords.latitude, position.coords.longitude);
  },
  (error) =&gt; {
    console.error('Watch error:', error);
  },
  {
    enableHighAccuracy: true,
    timeout: 10000,
    maximumAge: 5000 // Use cached position if &lt; 5 seconds old
  }
);

// Stop watching
navigator.geolocation.clearWatch(watchId);

// Promised-based wrapper
function getPosition(options = {}) {
  return new Promise((resolve, reject) =&gt; {
    navigator.geolocation.getCurrentPosition(resolve, reject, options);
  });
}

// Usage
try {
  const position = await getPosition({ enableHighAccuracy: true });
  console.log('Position:', position.coords);
} catch (error) {
  console.error('Error getting position:', error);
}
</code></pre>
<h2 id="file-api"><a class="header" href="#file-api">File API</a></h2>
<p>Read and manipulate files:</p>
<pre><code class="language-javascript">// File input
const input = document.getElementById('fileInput');

input.addEventListener('change', async (event) =&gt; {
  const files = event.target.files;

  for (const file of files) {
    console.log('Name:', file.name);
    console.log('Size:', file.size, 'bytes');
    console.log('Type:', file.type);
    console.log('Last modified:', new Date(file.lastModified));

    // Read as text
    const text = await file.text();
    console.log('Content:', text);

    // Read as ArrayBuffer
    const buffer = await file.arrayBuffer();
    console.log('Buffer:', new Uint8Array(buffer));

    // Read as Data URL (base64)
    const reader = new FileReader();
    reader.onload = (e) =&gt; {
      console.log('Data URL:', e.target.result);
      // Can use as img src
      document.getElementById('preview').src = e.target.result;
    };
    reader.readAsDataURL(file);

    // Read as text with FileReader
    reader.onload = (e) =&gt; {
      console.log('Text:', e.target.result);
    };
    reader.readAsText(file);

    // Read as ArrayBuffer with FileReader
    reader.onload = (e) =&gt; {
      const buffer = e.target.result;
      console.log('Buffer:', new Uint8Array(buffer));
    };
    reader.readAsArrayBuffer(file);

    // Progress event
    reader.onprogress = (e) =&gt; {
      if (e.lengthComputable) {
        const percent = (e.loaded / e.total) * 100;
        console.log('Progress:', percent.toFixed(2) + '%');
      }
    };
  }
});

// Drag and drop
const dropZone = document.getElementById('dropZone');

dropZone.addEventListener('dragover', (e) =&gt; {
  e.preventDefault();
  dropZone.classList.add('drag-over');
});

dropZone.addEventListener('dragleave', () =&gt; {
  dropZone.classList.remove('drag-over');
});

dropZone.addEventListener('drop', async (e) =&gt; {
  e.preventDefault();
  dropZone.classList.remove('drag-over');

  const files = e.dataTransfer.files;
  for (const file of files) {
    console.log('Dropped file:', file.name);
  }
});

// Create Blob
const blob = new Blob(['Hello, World!'], { type: 'text/plain' });
console.log('Blob size:', blob.size);
console.log('Blob type:', blob.type);

// Read Blob
const text = await blob.text();
console.log('Blob text:', text);

// Blob to URL
const url = URL.createObjectURL(blob);
console.log('Blob URL:', url);
// Don't forget to revoke
URL.revokeObjectURL(url);

// Download file
function downloadFile(content, filename, type) {
  const blob = new Blob([content], { type });
  const url = URL.createObjectURL(blob);

  const a = document.createElement('a');
  a.href = url;
  a.download = filename;
  a.click();

  URL.revokeObjectURL(url);
}

downloadFile('Hello, World!', 'hello.txt', 'text/plain');

// File from Blob
const file = new File([blob], 'example.txt', {
  type: 'text/plain',
  lastModified: Date.now()
});
</code></pre>
<h2 id="clipboard-api"><a class="header" href="#clipboard-api">Clipboard API</a></h2>
<p>Read and write clipboard:</p>
<pre><code class="language-javascript">// Write text to clipboard
async function copyText(text) {
  try {
    await navigator.clipboard.writeText(text);
    console.log('Text copied to clipboard');
  } catch (error) {
    console.error('Failed to copy:', error);
  }
}

copyText('Hello, clipboard!');

// Read text from clipboard
async function pasteText() {
  try {
    const text = await navigator.clipboard.readText();
    console.log('Pasted text:', text);
    return text;
  } catch (error) {
    console.error('Failed to read clipboard:', error);
  }
}

// Write images/rich content
async function copyImage(blob) {
  try {
    const item = new ClipboardItem({ 'image/png': blob });
    await navigator.clipboard.write([item]);
    console.log('Image copied');
  } catch (error) {
    console.error('Failed to copy image:', error);
  }
}

// Read images/rich content
async function pasteImage() {
  try {
    const items = await navigator.clipboard.read();

    for (const item of items) {
      for (const type of item.types) {
        const blob = await item.getType(type);

        if (type.startsWith('image/')) {
          const url = URL.createObjectURL(blob);
          const img = document.createElement('img');
          img.src = url;
          document.body.appendChild(img);
        }
      }
    }
  } catch (error) {
    console.error('Failed to paste:', error);
  }
}

// Copy button example
document.getElementById('copyBtn').addEventListener('click', async () =&gt; {
  const text = document.getElementById('text').textContent;
  await copyText(text);
  alert('Copied!');
});

// Legacy approach (fallback)
function copyTextLegacy(text) {
  const textarea = document.createElement('textarea');
  textarea.value = text;
  textarea.style.position = 'fixed';
  textarea.style.opacity = '0';
  document.body.appendChild(textarea);
  textarea.select();
  document.execCommand('copy');
  document.body.removeChild(textarea);
}
</code></pre>
<h2 id="intersection-observer-api"><a class="header" href="#intersection-observer-api">Intersection Observer API</a></h2>
<p>Detect element visibility:</p>
<pre><code class="language-javascript">// Create observer
const observer = new IntersectionObserver(
  (entries, observer) =&gt; {
    entries.forEach(entry =&gt; {
      if (entry.isIntersecting) {
        console.log('Element is visible:', entry.target);

        // Lazy load image
        if (entry.target.tagName === 'IMG') {
          entry.target.src = entry.target.dataset.src;
          observer.unobserve(entry.target); // Stop observing
        }

        // Animation on scroll
        entry.target.classList.add('animate-in');
      } else {
        console.log('Element is hidden:', entry.target);
      }
    });
  },
  {
    root: null, // viewport
    rootMargin: '0px', // margin around root
    threshold: 0.5 // 50% visible
  }
);

// Observe elements
const images = document.querySelectorAll('img[data-src]');
images.forEach(img =&gt; observer.observe(img));

// Multiple thresholds
const detailedObserver = new IntersectionObserver(
  (entries) =&gt; {
    entries.forEach(entry =&gt; {
      console.log('Visibility:', entry.intersectionRatio);
      // 0 = not visible, 1 = fully visible
    });
  },
  {
    threshold: [0, 0.25, 0.5, 0.75, 1.0]
  }
);

// Infinite scroll example
const loadMore = document.getElementById('loadMore');

const infiniteObserver = new IntersectionObserver(
  (entries) =&gt; {
    if (entries[0].isIntersecting) {
      console.log('Load more items');
      loadMoreItems().then(items =&gt; {
        appendItems(items);
      });
    }
  },
  { threshold: 1.0 }
);

infiniteObserver.observe(loadMore);

// Unobserve element
observer.unobserve(element);

// Disconnect observer
observer.disconnect();
</code></pre>
<h2 id="mutation-observer-api"><a class="header" href="#mutation-observer-api">Mutation Observer API</a></h2>
<p>Watch for DOM changes:</p>
<pre><code class="language-javascript">// Create observer
const mutationObserver = new MutationObserver((mutations) =&gt; {
  mutations.forEach(mutation =&gt; {
    console.log('Type:', mutation.type);

    if (mutation.type === 'childList') {
      console.log('Children changed');
      console.log('Added:', mutation.addedNodes);
      console.log('Removed:', mutation.removedNodes);
    }

    if (mutation.type === 'attributes') {
      console.log('Attribute changed:', mutation.attributeName);
      console.log('Old value:', mutation.oldValue);
    }

    if (mutation.type === 'characterData') {
      console.log('Text content changed');
      console.log('Old value:', mutation.oldValue);
    }
  });
});

// Observe element
const targetNode = document.getElementById('target');

mutationObserver.observe(targetNode, {
  childList: true, // Watch for child additions/removals
  attributes: true, // Watch for attribute changes
  characterData: true, // Watch for text content changes
  subtree: true, // Watch descendants too
  attributeOldValue: true, // Record old attribute value
  characterDataOldValue: true, // Record old text value
  attributeFilter: ['class', 'style'] // Only watch specific attributes
});

// Disconnect observer
mutationObserver.disconnect();

// Example: Watch for dynamically added elements
const bodyObserver = new MutationObserver((mutations) =&gt; {
  mutations.forEach(mutation =&gt; {
    mutation.addedNodes.forEach(node =&gt; {
      if (node.classList &amp;&amp; node.classList.contains('dynamic-content')) {
        console.log('Dynamic content added:', node);
        initializeDynamicContent(node);
      }
    });
  });
});

bodyObserver.observe(document.body, {
  childList: true,
  subtree: true
});
</code></pre>
<h2 id="resize-observer-api"><a class="header" href="#resize-observer-api">Resize Observer API</a></h2>
<p>Detect element size changes:</p>
<pre><code class="language-javascript">// Create observer
const resizeObserver = new ResizeObserver((entries) =&gt; {
  entries.forEach(entry =&gt; {
    console.log('Element:', entry.target);
    console.log('Content box:', entry.contentBoxSize);
    console.log('Border box:', entry.borderBoxSize);
    console.log('Device pixel box:', entry.devicePixelContentBoxSize);

    const width = entry.contentRect.width;
    const height = entry.contentRect.height;
    console.log('Size:', width, 'x', height);

    // Responsive behavior
    if (width &lt; 600) {
      entry.target.classList.add('mobile');
    } else {
      entry.target.classList.remove('mobile');
    }
  });
});

// Observe element
const element = document.getElementById('resizable');
resizeObserver.observe(element);

// Observe multiple elements
const elements = document.querySelectorAll('.resizable');
elements.forEach(el =&gt; resizeObserver.observe(el));

// Unobserve
resizeObserver.unobserve(element);

// Disconnect
resizeObserver.disconnect();

// Example: Canvas responsive rendering
const canvas = document.getElementById('canvas');

const canvasObserver = new ResizeObserver((entries) =&gt; {
  const entry = entries[0];
  const width = entry.contentRect.width;
  const height = entry.contentRect.height;

  // Update canvas size
  canvas.width = width * devicePixelRatio;
  canvas.height = height * devicePixelRatio;

  // Re-render
  renderCanvas();
});

canvasObserver.observe(canvas);
</code></pre>
<h2 id="page-visibility-api"><a class="header" href="#page-visibility-api">Page Visibility API</a></h2>
<p>Detect when page is visible:</p>
<pre><code class="language-javascript">// Check current visibility
console.log('Hidden:', document.hidden);
console.log('Visibility state:', document.visibilityState);
// 'visible', 'hidden', 'prerender'

// Listen for visibility changes
document.addEventListener('visibilitychange', () =&gt; {
  if (document.hidden) {
    console.log('Page is hidden');

    // Pause video
    video.pause();

    // Stop animations
    stopAnimations();

    // Reduce network activity
    clearInterval(pollingInterval);
  } else {
    console.log('Page is visible');

    // Resume video
    video.play();

    // Resume animations
    startAnimations();

    // Resume polling
    startPolling();
  }
});

// Example: Pause game when tab is hidden
document.addEventListener('visibilitychange', () =&gt; {
  if (document.hidden) {
    game.pause();
  } else {
    game.resume();
  }
});

// Example: Analytics
let startTime = Date.now();

document.addEventListener('visibilitychange', () =&gt; {
  if (document.hidden) {
    const visibleTime = Date.now() - startTime;
    analytics.track('time-visible', visibleTime);
  } else {
    startTime = Date.now();
  }
});
</code></pre>
<h2 id="broadcast-channel-api"><a class="header" href="#broadcast-channel-api">Broadcast Channel API</a></h2>
<p>Communicate between tabs/windows:</p>
<pre><code class="language-javascript">// Create channel
const channel = new BroadcastChannel('my-channel');

// Send message
channel.postMessage('Hello from tab 1');
channel.postMessage({ type: 'update', data: { count: 5 } });

// Receive messages
channel.onmessage = (event) =&gt; {
  console.log('Received message:', event.data);

  if (event.data.type === 'update') {
    updateUI(event.data.data);
  }
};

channel.onerror = (error) =&gt; {
  console.error('Channel error:', error);
};

// Close channel
channel.close();

// Example: Sync state across tabs
const stateChannel = new BroadcastChannel('app-state');

// Tab 1: Update state
function updateState(newState) {
  state = newState;
  localStorage.setItem('state', JSON.stringify(state));
  stateChannel.postMessage({ type: 'state-update', state });
}

// All tabs: Listen for updates
stateChannel.onmessage = (event) =&gt; {
  if (event.data.type === 'state-update') {
    state = event.data.state;
    renderUI();
  }
};

// Example: Logout all tabs
const authChannel = new BroadcastChannel('auth');

// Tab with logout button
function logout() {
  clearAuthToken();
  authChannel.postMessage({ type: 'logout' });
  redirectToLogin();
}

// All tabs
authChannel.onmessage = (event) =&gt; {
  if (event.data.type === 'logout') {
    clearAuthToken();
    redirectToLogin();
  }
};
</code></pre>
<h2 id="history-api"><a class="header" href="#history-api">History API</a></h2>
<p>Manipulate browser history:</p>
<pre><code class="language-javascript">// Push new state
history.pushState(
  { page: 1 }, // State object
  'Title',     // Title (ignored by most browsers)
  '/page/1'    // URL
);

// Replace current state
history.replaceState({ page: 2 }, 'Title', '/page/2');

// Go back
history.back();

// Go forward
history.forward();

// Go to specific point
history.go(-2); // Go back 2 pages
history.go(1);  // Go forward 1 page

// Listen for state changes
window.addEventListener('popstate', (event) =&gt; {
  console.log('State:', event.state);
  console.log('URL:', location.pathname);

  // Restore page state
  if (event.state &amp;&amp; event.state.page) {
    loadPage(event.state.page);
  }
});

// Get current state
console.log('Current state:', history.state);

// Length of history
console.log('History length:', history.length);

// Example: Single Page App navigation
function navigateTo(url, state = {}) {
  history.pushState(state, '', url);
  loadContent(url);
}

document.querySelectorAll('a[data-link]').forEach(link =&gt; {
  link.addEventListener('click', (e) =&gt; {
    e.preventDefault();
    navigateTo(link.href);
  });
});

window.addEventListener('popstate', () =&gt; {
  loadContent(location.pathname);
});
</code></pre>
<h2 id="performance-api"><a class="header" href="#performance-api">Performance API</a></h2>
<p>Measure performance:</p>
<pre><code class="language-javascript">// Mark time points
performance.mark('start-task');

// Do some work
await doSomethingExpensive();

performance.mark('end-task');

// Measure duration
performance.measure('task-duration', 'start-task', 'end-task');

// Get measurements
const measures = performance.getEntriesByName('task-duration');
console.log('Duration:', measures[0].duration, 'ms');

// Navigation timing
const navTiming = performance.getEntriesByType('navigation')[0];
console.log('DNS lookup:', navTiming.domainLookupEnd - navTiming.domainLookupStart);
console.log('TCP connect:', navTiming.connectEnd - navTiming.connectStart);
console.log('Request time:', navTiming.responseEnd - navTiming.requestStart);
console.log('DOM load:', navTiming.domContentLoadedEventEnd - navTiming.domContentLoadedEventStart);
console.log('Page load:', navTiming.loadEventEnd - navTiming.loadEventStart);

// Resource timing
const resources = performance.getEntriesByType('resource');
resources.forEach(resource =&gt; {
  console.log('Resource:', resource.name);
  console.log('Duration:', resource.duration);
  console.log('Size:', resource.transferSize);
});

// Paint timing
const paintTiming = performance.getEntriesByType('paint');
paintTiming.forEach(entry =&gt; {
  console.log(`${entry.name}:`, entry.startTime);
});
// first-paint, first-contentful-paint

// Clear marks and measures
performance.clearMarks();
performance.clearMeasures();

// Observer for performance entries
const perfObserver = new PerformanceObserver((list) =&gt; {
  list.getEntries().forEach(entry =&gt; {
    console.log('Entry:', entry.name, entry.duration);
  });
});

perfObserver.observe({ entryTypes: ['measure', 'navigation', 'resource'] });

// Memory usage (Chrome only)
if (performance.memory) {
  console.log('Used heap:', performance.memory.usedJSHeapSize);
  console.log('Total heap:', performance.memory.totalJSHeapSize);
  console.log('Heap limit:', performance.memory.jsHeapSizeLimit);
}

// Current time (high-resolution)
const start = performance.now();
// Do work
const end = performance.now();
console.log('Elapsed:', end - start, 'ms');
</code></pre>
<h2 id="battery-status-api"><a class="header" href="#battery-status-api">Battery Status API</a></h2>
<p>Get battery information:</p>
<pre><code class="language-javascript">if ('getBattery' in navigator) {
  const battery = await navigator.getBattery();

  console.log('Charging:', battery.charging);
  console.log('Level:', battery.level * 100 + '%');
  console.log('Charging time:', battery.chargingTime, 'seconds');
  console.log('Discharging time:', battery.dischargingTime, 'seconds');

  // Listen for changes
  battery.addEventListener('chargingchange', () =&gt; {
    console.log('Charging:', battery.charging);
  });

  battery.addEventListener('levelchange', () =&gt; {
    console.log('Battery level:', battery.level * 100 + '%');

    if (battery.level &lt; 0.2 &amp;&amp; !battery.charging) {
      alert('Low battery! Please charge your device.');
    }
  });

  battery.addEventListener('chargingtimechange', () =&gt; {
    console.log('Charging time:', battery.chargingTime);
  });

  battery.addEventListener('dischargingtimechange', () =&gt; {
    console.log('Discharging time:', battery.dischargingTime);
  });

  // Adaptive features based on battery
  if (battery.level &lt; 0.2 &amp;&amp; !battery.charging) {
    // Reduce animations, polling, etc.
    enablePowerSavingMode();
  }
}
</code></pre>
<h2 id="web-share-api"><a class="header" href="#web-share-api">Web Share API</a></h2>
<p>Share content from web app:</p>
<pre><code class="language-javascript">// Check if supported
if (navigator.share) {
  console.log('Web Share API supported');
}

// Share text
async function shareText() {
  try {
    await navigator.share({
      title: 'Check this out!',
      text: 'This is amazing content',
      url: 'https://example.com'
    });
    console.log('Shared successfully');
  } catch (error) {
    console.error('Error sharing:', error);
  }
}

// Share files
async function shareFiles(files) {
  if (navigator.canShare &amp;&amp; navigator.canShare({ files })) {
    try {
      await navigator.share({
        files: files,
        title: 'Shared files',
        text: 'Check out these files'
      });
      console.log('Files shared successfully');
    } catch (error) {
      console.error('Error sharing files:', error);
    }
  } else {
    console.log('File sharing not supported');
  }
}

// Example: Share button
document.getElementById('shareBtn').addEventListener('click', async () =&gt; {
  if (navigator.share) {
    await shareText();
  } else {
    // Fallback: Copy link
    await navigator.clipboard.writeText(window.location.href);
    alert('Link copied to clipboard');
  }
});

// Example: Share image
const canvas = document.getElementById('canvas');
canvas.toBlob(async (blob) =&gt; {
  const file = new File([blob], 'image.png', { type: 'image/png' });
  await shareFiles([file]);
});
</code></pre>
<h2 id="browser-support-and-feature-detection"><a class="header" href="#browser-support-and-feature-detection">Browser Support and Feature Detection</a></h2>
<p>Always check for API availability:</p>
<pre><code class="language-javascript">// Feature detection
const features = {
  serviceWorker: 'serviceWorker' in navigator,
  pushNotifications: 'PushManager' in window,
  notifications: 'Notification' in window,
  geolocation: 'geolocation' in navigator,
  webWorker: typeof Worker !== 'undefined',
  indexedDB: 'indexedDB' in window,
  webRTC: 'RTCPeerConnection' in window,
  webGL: (() =&gt; {
    const canvas = document.createElement('canvas');
    return !!(canvas.getContext('webgl') || canvas.getContext('experimental-webgl'));
  })(),
  mediaDevices: 'mediaDevices' in navigator,
  clipboard: 'clipboard' in navigator,
  share: 'share' in navigator,
  battery: 'getBattery' in navigator
};

console.table(features);

// Polyfill loading
if (!window.IntersectionObserver) {
  await import('intersection-observer');
}

// Progressive enhancement
if ('serviceWorker' in navigator) {
  // Enable offline support
  registerServiceWorker();
} else {
  // Gracefully degrade
  console.log('Service Worker not supported');
}
</code></pre>
<h2 id="best-practices-84"><a class="header" href="#best-practices-84">Best Practices</a></h2>
<pre><code class="language-javascript">// 1. Always check feature support
if ('geolocation' in navigator) {
  // Use geolocation
}

// 2. Handle errors gracefully
try {
  await navigator.clipboard.writeText('text');
} catch (error) {
  // Fallback
  fallbackCopyMethod('text');
}

// 3. Request permissions appropriately
// Don't request permission immediately on page load
document.getElementById('enableNotifications').addEventListener('click', async () =&gt; {
  await Notification.requestPermission();
});

// 4. Clean up resources
const observer = new IntersectionObserver(callback);
// When done:
observer.disconnect();

const worker = new Worker('worker.js');
// When done:
worker.terminate();

// 5. Use Promises/async-await for better readability
// Instead of callbacks
async function loadData() {
  const data = await fetch('/api/data').then(r =&gt; r.json());
  return data;
}

// 6. Respect user privacy
// Check permission status before requesting
const status = await navigator.permissions.query({ name: 'geolocation' });
if (status.state === 'granted') {
  // Already have permission
}

// 7. Optimize performance
// Debounce expensive operations
function debounce(func, wait) {
  let timeout;
  return function (...args) {
    clearTimeout(timeout);
    timeout = setTimeout(() =&gt; func.apply(this, args), wait);
  };
}

window.addEventListener('resize', debounce(() =&gt; {
  console.log('Resized');
}, 250));
</code></pre>
<h2 id="further-resources-43"><a class="header" href="#further-resources-43">Further Resources</a></h2>
<h3 id="documentation-7"><a class="header" href="#documentation-7">Documentation</a></h3>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/API">MDN Web APIs</a></li>
<li><a href="https://caniuse.com/">Can I Use</a> - Browser support tables</li>
<li><a href="https://web.dev/">Web.dev</a> - Modern web development guides</li>
</ul>
<h3 id="specifications-4"><a class="header" href="#specifications-4">Specifications</a></h3>
<ul>
<li><a href="https://www.w3.org/TR/">W3C Web APIs</a></li>
<li><a href="https://spec.whatwg.org/">WHATWG Standards</a></li>
</ul>
<h3 id="tools-15"><a class="header" href="#tools-15">Tools</a></h3>
<ul>
<li><a href="https://developers.google.com/web/tools/lighthouse">Lighthouse</a> - Performance auditing</li>
<li><a href="https://developers.google.com/web/tools/workbox">Workbox</a> - Service Worker library</li>
</ul>
<h3 id="libraries-3"><a class="header" href="#libraries-3">Libraries</a></h3>
<ul>
<li><a href="https://dexie.org/">Dexie.js</a> - IndexedDB wrapper</li>
<li><a href="https://localforage.github.io/localForage/">localForage</a> - Unified storage API</li>
<li><a href="https://github.com/GoogleChromeLabs/comlink">Comlink</a> - Web Worker RPC</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rest-apis"><a class="header" href="#rest-apis">REST APIs</a></h1>
<h2 id="overview-97"><a class="header" href="#overview-97">Overview</a></h2>
<p>REST (Representational State Transfer) is an architectural style for building web services using HTTP.</p>
<h2 id="core-principles-1"><a class="header" href="#core-principles-1">Core Principles</a></h2>
<ol>
<li><strong>Client-Server</strong>: Separation of concerns</li>
<li><strong>Stateless</strong>: Each request contains all info</li>
<li><strong>Uniform Interface</strong>: Consistent API design</li>
<li><strong>Cacheable</strong>: Responses can be cached</li>
<li><strong>Layered</strong>: Client unaware of layers</li>
</ol>
<h2 id="http-methods-4"><a class="header" href="#http-methods-4">HTTP Methods</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Method</th><th>Purpose</th><th>Idempotent</th></tr></thead><tbody>
<tr><td><strong>GET</strong></td><td>Retrieve resource</td><td>✓</td></tr>
<tr><td><strong>POST</strong></td><td>Create resource</td><td>✗</td></tr>
<tr><td><strong>PUT</strong></td><td>Replace resource</td><td>✓</td></tr>
<tr><td><strong>PATCH</strong></td><td>Partial update</td><td>✗</td></tr>
<tr><td><strong>DELETE</strong></td><td>Remove resource</td><td>✓</td></tr>
</tbody></table>
</div>
<h2 id="status-codes-1"><a class="header" href="#status-codes-1">Status Codes</a></h2>
<ul>
<li><strong>2xx</strong>: Success (200 OK, 201 Created)</li>
<li><strong>3xx</strong>: Redirection (301, 304)</li>
<li><strong>4xx</strong>: Client error (400, 404, 401)</li>
<li><strong>5xx</strong>: Server error (500, 503)</li>
</ul>
<h2 id="resource-oriented-design"><a class="header" href="#resource-oriented-design">Resource-Oriented Design</a></h2>
<pre><code>✓ GET /users          - List users
✓ POST /users         - Create user
✓ GET /users/123      - Get user 123
✓ PUT /users/123      - Replace user 123
✓ PATCH /users/123    - Partial update
✓ DELETE /users/123   - Delete user 123

✗ GET /getUser?id=123 - Procedural (bad)
</code></pre>
<h2 id="requestresponse"><a class="header" href="#requestresponse">Request/Response</a></h2>
<pre><code class="language-python"># Request
GET /api/v1/users/123 HTTP/1.1
Host: api.example.com
Authorization: Bearer token
Content-Type: application/json

# Response
HTTP/1.1 200 OK
Content-Type: application/json

{
  "id": 123,
  "name": "John",
  "email": "john@example.com"
}
</code></pre>
<h2 id="error-handling-12"><a class="header" href="#error-handling-12">Error Handling</a></h2>
<pre><code class="language-json">{
  "error": "Validation failed",
  "details": {
    "email": "Invalid email format"
  },
  "status": 400
}
</code></pre>
<h2 id="pagination-1"><a class="header" href="#pagination-1">Pagination</a></h2>
<pre><code>GET /users?page=2&amp;limit=20
GET /users?offset=40&amp;limit=20
GET /users?cursor=abc123
</code></pre>
<h2 id="versioning"><a class="header" href="#versioning">Versioning</a></h2>
<pre><code>/api/v1/users    (stable)
/api/v2/users    (new version)
/api/beta/users  (experimental)
</code></pre>
<h2 id="best-practices-85"><a class="header" href="#best-practices-85">Best Practices</a></h2>
<ol>
<li><strong>Use appropriate methods</strong> for operations</li>
<li><strong>Meaningful status codes</strong> for responses</li>
<li><strong>Consistent naming</strong> conventions</li>
<li><strong>Pagination</strong> for large datasets</li>
<li><strong>Rate limiting</strong> to protect API</li>
<li><strong>Authentication/Authorization</strong></li>
<li><strong>Documentation</strong> (Swagger/OpenAPI)</li>
</ol>
<h2 id="expressjs-example"><a class="header" href="#expressjs-example">Express.js Example</a></h2>
<pre><code class="language-javascript">const express = require('express');
const app = express();

// Get all users
app.get('/users', (req, res) =&gt; {
  res.json(users);
});

// Get user by ID
app.get('/users/:id', (req, res) =&gt; {
  const user = users.find(u =&gt; u.id == req.params.id);
  res.json(user);
});

// Create user
app.post('/users', (req, res) =&gt; {
  const user = req.body;
  users.push(user);
  res.status(201).json(user);
});

// Update user
app.patch('/users/:id', (req, res) =&gt; {
  const user = users.find(u =&gt; u.id == req.params.id);
  Object.assign(user, req.body);
  res.json(user);
});

// Delete user
app.delete('/users/:id', (req, res) =&gt; {
  users = users.filter(u =&gt; u.id != req.params.id);
  res.status(204).send();
});

app.listen(3000);
</code></pre>
<h2 id="testing-11"><a class="header" href="#testing-11">Testing</a></h2>
<pre><code class="language-bash"># Using curl
curl -X GET http://localhost:3000/users
curl -X POST http://localhost:3000/users -H "Content-Type: application/json" -d '{"name":"John"}'
</code></pre>
<h2 id="eli10-30"><a class="header" href="#eli10-30">ELI10</a></h2>
<p>REST API is like a restaurant menu:</p>
<ul>
<li><strong>GET</strong>: View menu/food</li>
<li><strong>POST</strong>: Place new order</li>
<li><strong>PUT</strong>: Replace entire order</li>
<li><strong>PATCH</strong>: Modify order slightly</li>
<li><strong>DELETE</strong>: Cancel order</li>
</ul>
<p>Standard ways to order without confusion!</p>
<h2 id="further-resources-44"><a class="header" href="#further-resources-44">Further Resources</a></h2>
<ul>
<li><a href="https://restfulapi.net/">REST API Best Practices</a></li>
<li><a href="https://httpstat.us/">HTTP Status Codes</a></li>
<li><a href="https://swagger.io/">OpenAPI/Swagger</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="graphql-1"><a class="header" href="#graphql-1">GraphQL</a></h1>
<h2 id="overview-98"><a class="header" href="#overview-98">Overview</a></h2>
<p>GraphQL is a query language for APIs. Request exactly what data you need, no more, no less.</p>
<h2 id="key-differences-from-rest"><a class="header" href="#key-differences-from-rest">Key Differences from REST</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Aspect</th><th>REST</th><th>GraphQL</th></tr></thead><tbody>
<tr><td><strong>Endpoints</strong></td><td>Multiple (/users, /posts, /comments)</td><td>Single (/graphql)</td></tr>
<tr><td><strong>Data</strong></td><td>Fixed shape</td><td>Client specifies shape</td></tr>
<tr><td><strong>Over-fetching</strong></td><td>Get extra fields</td><td>Only requested fields</td></tr>
<tr><td><strong>Under-fetching</strong></td><td>Need multiple requests</td><td>Single request</td></tr>
</tbody></table>
</div>
<h2 id="schema"><a class="header" href="#schema">Schema</a></h2>
<p>Define types and their relationships:</p>
<pre><code class="language-graphql">type User {
  id: ID!
  name: String!
  email: String!
  posts: [Post!]!
  age: Int
}

type Post {
  id: ID!
  title: String!
  content: String!
  author: User!
  createdAt: String!
}

type Query {
  user(id: ID!): User
  users: [User!]!
  post(id: ID!): Post
}

type Mutation {
  createUser(name: String!, email: String!): User!
  updateUser(id: ID!, name: String): User
  deleteUser(id: ID!): Boolean!
}
</code></pre>
<h2 id="queries"><a class="header" href="#queries">Queries</a></h2>
<p>Request exactly what you need:</p>
<pre><code class="language-graphql"># Simple query
query {
  user(id: "1") {
    name
    email
  }
}

# Nested query
query {
  user(id: "1") {
    name
    posts {
      title
      createdAt
    }
  }
}

# Multiple queries
query {
  user1: user(id: "1") {
    name
  }
  user2: user(id: "2") {
    name
  }
}

# With variables
query GetUser($userId: ID!) {
  user(id: $userId) {
    name
    email
    posts {
      title
    }
  }
}
</code></pre>
<h2 id="mutations"><a class="header" href="#mutations">Mutations</a></h2>
<p>Modify data:</p>
<pre><code class="language-graphql">mutation CreateUser($name: String!, $email: String!) {
  createUser(name: $name, email: $email) {
    id
    name
    email
  }
}

mutation UpdateUser($id: ID!, $name: String) {
  updateUser(id: $id, name: $name) {
    id
    name
  }
}
</code></pre>
<h2 id="resolvers"><a class="header" href="#resolvers">Resolvers</a></h2>
<p>Implement schema with resolvers:</p>
<pre><code class="language-javascript">const resolvers = {
  Query: {
    user: (parent, args) =&gt; {
      return db.users.find(u =&gt; u.id === args.id);
    },
    users: () =&gt; {
      return db.users;
    }
  },

  Mutation: {
    createUser: (parent, args) =&gt; {
      const user = { id: uuidv4(), ...args };
      db.users.push(user);
      return user;
    }
  },

  User: {
    posts: (parent) =&gt; {
      return db.posts.filter(p =&gt; p.authorId === parent.id);
    }
  }
};
</code></pre>
<h2 id="apollo-server-nodejs"><a class="header" href="#apollo-server-nodejs">Apollo Server (Node.js)</a></h2>
<pre><code class="language-javascript">const { ApolloServer, gql } = require('apollo-server');

const typeDefs = gql`
  type Query {
    hello: String
    user(id: ID!): User
  }

  type User {
    id: ID!
    name: String!
  }
`;

const resolvers = {
  Query: {
    hello: () =&gt; 'Hello world!',
    user: (_, args) =&gt; ({ id: args.id, name: 'John' })
  }
};

const server = new ApolloServer({
  typeDefs,
  resolvers
});

server.listen();
</code></pre>
<h2 id="advantages-2"><a class="header" href="#advantages-2">Advantages</a></h2>
<p>✅ Request only needed data (no over-fetching)
✅ Single request for related data (no under-fetching)
✅ Strong typing with schema
✅ Introspection (explore API automatically)
✅ Development tools (GraphQL Explorer)</p>
<h2 id="disadvantages-1"><a class="header" href="#disadvantages-1">Disadvantages</a></h2>
<p>❌ More complex than REST
❌ Query complexity attacks
❌ Caching is harder
❌ Monitoring harder
❌ Learning curve</p>
<h2 id="best-practices-86"><a class="header" href="#best-practices-86">Best Practices</a></h2>
<ol>
<li><strong>Limit query depth</strong> (prevent abuse)</li>
<li><strong>Implement timeout</strong> on queries</li>
<li><strong>Use pagination</strong> for large result sets</li>
<li><strong>Combine with REST</strong> if needed</li>
<li><strong>Monitor query performance</strong></li>
</ol>
<h2 id="pagination-2"><a class="header" href="#pagination-2">Pagination</a></h2>
<pre><code class="language-graphql">query {
  users(first: 10, after: "cursor123") {
    edges {
      node {
        id
        name
      }
      cursor
    }
    pageInfo {
      hasNextPage
      endCursor
    }
  }
}
</code></pre>
<h2 id="eli10-31"><a class="header" href="#eli10-31">ELI10</a></h2>
<p>GraphQL is like ordering food:</p>
<ul>
<li><strong>REST</strong>: Get whole menu as-is</li>
<li><strong>GraphQL</strong>: Ask for exactly what you want</li>
</ul>
<p>"I'll take pasta with sauce on the side, hold the onions"</p>
<h2 id="further-resources-45"><a class="header" href="#further-resources-45">Further Resources</a></h2>
<ul>
<li><a href="https://graphql.org/">GraphQL Official</a></li>
<li><a href="https://www.howtographql.com/">How to GraphQL</a></li>
<li><a href="https://www.apollographql.com/docs/">Apollo Documentation</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="grpc"><a class="header" href="#grpc">gRPC</a></h1>
<p>gRPC is a high-performance, open-source universal RPC framework. It uses HTTP/2 for transport, Protocol Buffers as the interface description language, and provides features like authentication, load balancing, and more.</p>
<h2 id="overview-99"><a class="header" href="#overview-99">Overview</a></h2>
<p><strong>Key Features:</strong></p>
<ul>
<li>HTTP/2 based transport</li>
<li>Protocol Buffers for serialization</li>
<li>Bidirectional streaming</li>
<li>Pluggable auth, tracing, load balancing</li>
<li>Language-agnostic</li>
</ul>
<h2 id="protocol-buffers"><a class="header" href="#protocol-buffers">Protocol Buffers</a></h2>
<pre><code class="language-protobuf">// user.proto
syntax = "proto3";

package user;

service UserService {
  rpc GetUser(UserRequest) returns (UserResponse);
  rpc ListUsers(ListUsersRequest) returns (stream UserResponse);
}

message UserRequest {
  int32 id = 1;
}

message UserResponse {
  int32 id = 1;
  string name = 2;
  string email = 3;
}

message ListUsersRequest {
  int32 page = 1;
  int32 page_size = 2;
}
</code></pre>
<h2 id="server-implementation-python"><a class="header" href="#server-implementation-python">Server Implementation (Python)</a></h2>
<pre><code class="language-python">import grpc
from concurrent import futures
import user_pb2
import user_pb2_grpc

class UserServiceServicer(user_pb2_grpc.UserServiceServicer):
    def GetUser(self, request, context):
        # Fetch user from database
        return user_pb2.UserResponse(
            id=request.id,
            name="John Doe",
            email="john@example.com"
        )

    def ListUsers(self, request, context):
        # Stream users
        for user in get_users():
            yield user_pb2.UserResponse(
                id=user.id,
                name=user.name,
                email=user.email
            )

def serve():
    server = grpc.server(futures.ThreadPoolExecutor(max_workers=10))
    user_pb2_grpc.add_UserServiceServicer_to_server(
        UserServiceServicer(), server
    )
    server.add_insecure_port('[::]:50051')
    server.start()
    server.wait_for_termination()
</code></pre>
<h2 id="client-implementation-1"><a class="header" href="#client-implementation-1">Client Implementation</a></h2>
<pre><code class="language-python">import grpc
import user_pb2
import user_pb2_grpc

def run():
    with grpc.insecure_channel('localhost:50051') as channel:
        stub = user_pb2_grpc.UserServiceStub(channel)

        # Unary call
        response = stub.GetUser(user_pb2.UserRequest(id=1))
        print(f"User: {response.name}")

        # Server streaming
        for user in stub.ListUsers(user_pb2.ListUsersRequest(page=1)):
            print(f"User: {user.name}")
</code></pre>
<h2 id="stream-types"><a class="header" href="#stream-types">Stream Types</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td>Unary</td><td>Single request/response</td></tr>
<tr><td>Server streaming</td><td>Client sends one request, server streams responses</td></tr>
<tr><td>Client streaming</td><td>Client streams requests, server sends one response</td></tr>
<tr><td>Bidirectional</td><td>Both stream</td></tr>
</tbody></table>
</div>
<p>gRPC provides efficient, type-safe communication between services, ideal for microservices architectures.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="devops--cicd"><a class="header" href="#devops--cicd">DevOps &amp; CI/CD</a></h1>
<p>DevOps practices, tools, and methodologies for continuous integration, delivery, and deployment.</p>
<h2 id="topics-covered-2"><a class="header" href="#topics-covered-2">Topics Covered</a></h2>
<ul>
<li><strong><a href="devops/cicd.html">CI/CD</a></strong>: Continuous integration and deployment pipelines, automation, workflows</li>
<li><strong><a href="devops/docker.html">Docker</a></strong>: Containerization, images, containers, Docker Compose</li>
<li><strong><a href="devops/kubernetes.html">Kubernetes</a></strong>: Container orchestration, deployments, services, scaling</li>
<li><strong>Terraform</strong>: Infrastructure as code, cloud provisioning</li>
<li><strong>GitHub Actions</strong>: CI/CD workflows, automation</li>
<li><strong>Monitoring</strong>: Logging, metrics, observability</li>
<li><strong>Cloud Deployment</strong>: AWS, GCP, Azure</li>
<li><strong>Infrastructure</strong>: Networking, security, scaling</li>
</ul>
<h2 id="key-concepts-34"><a class="header" href="#key-concepts-34">Key Concepts</a></h2>
<ul>
<li><strong>Continuous Integration</strong>: Automated testing on every commit</li>
<li><strong>Continuous Delivery</strong>: Automated deployment ready</li>
<li><strong>Continuous Deployment</strong>: Automated production releases</li>
<li><strong>Infrastructure as Code</strong>: Define infra with code</li>
</ul>
<h2 id="tools-16"><a class="header" href="#tools-16">Tools</a></h2>
<ul>
<li><strong>CI/CD</strong>: Jenkins, GitHub Actions, GitLab CI, CircleCI</li>
<li><strong>Container</strong>: Docker, Podman</li>
<li><strong>Orchestration</strong>: Kubernetes, Docker Swarm</li>
<li><strong>IaC</strong>: Terraform, CloudFormation, Pulumi</li>
<li><strong>Monitoring</strong>: Prometheus, ELK Stack, Datadog</li>
</ul>
<h2 id="navigation-2"><a class="header" href="#navigation-2">Navigation</a></h2>
<p>Explore each tool and practice to master DevOps.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="docker-5"><a class="header" href="#docker-5">Docker</a></h1>
<h2 id="overview-100"><a class="header" href="#overview-100">Overview</a></h2>
<p>Docker packages applications into containers - lightweight, isolated environments with all dependencies. Build once, run anywhere.</p>
<h2 id="core-concepts-7"><a class="header" href="#core-concepts-7">Core Concepts</a></h2>
<h3 id="images-vs-containers"><a class="header" href="#images-vs-containers">Images vs Containers</a></h3>
<ul>
<li><strong>Image</strong>: Blueprint (read-only template)</li>
<li><strong>Container</strong>: Running instance of image</li>
</ul>
<pre><code class="language-bash"># Build image
docker build -t myapp:1.0 .

# Run container from image
docker run myapp:1.0
</code></pre>
<h3 id="dockerfile-1"><a class="header" href="#dockerfile-1">Dockerfile</a></h3>
<pre><code class="language-dockerfile"># Base image
FROM python:3.9-slim

# Set working directory
WORKDIR /app

# Copy files
COPY requirements.txt .

# Install dependencies
RUN pip install -r requirements.txt

# Copy application
COPY . .

# Expose port
EXPOSE 5000

# Run command
CMD ["python", "app.py"]
</code></pre>
<h2 id="docker-commands"><a class="header" href="#docker-commands">Docker Commands</a></h2>
<pre><code class="language-bash"># Build
docker build -t myapp:1.0 .

# Run
docker run -p 8000:5000 myapp:1.0
docker run -d -p 8000:5000 myapp:1.0  # Detached

# View containers
docker ps          # Running
docker ps -a       # All

# View images
docker images

# Logs
docker logs container_id

# Stop container
docker stop container_id

# Remove
docker rm container_id
docker rmi image_name
</code></pre>
<h2 id="docker-compose-1"><a class="header" href="#docker-compose-1">Docker Compose</a></h2>
<p>Multiple containers together:</p>
<pre><code class="language-yaml">version: '3.8'

services:
  web:
    build: .
    ports:
      - "8000:5000"
    environment:
      DATABASE_URL: postgres://db:5432/mydb
    depends_on:
      - db

  db:
    image: postgres:13
    environment:
      POSTGRES_PASSWORD: secret
    volumes:
      - postgres_data:/var/lib/postgresql/data

volumes:
  postgres_data:
</code></pre>
<pre><code class="language-bash">docker-compose up         # Start all services
docker-compose down       # Stop all services
docker-compose logs -f    # Follow logs
</code></pre>
<h2 id="best-practices-87"><a class="header" href="#best-practices-87">Best Practices</a></h2>
<ol>
<li><strong>Small images</strong>: Use minimal base images (alpine)</li>
<li><strong>Layer caching</strong>: Order commands by change frequency</li>
<li><strong>Security</strong>: Don't run as root, use secrets</li>
<li><strong>Health checks</strong>: Monitor container health</li>
</ol>
<pre><code class="language-dockerfile"># Good: Minimal image
FROM python:3.9-slim
RUN pip install --no-cache-dir -r requirements.txt

# Health check
HEALTHCHECK --interval=30s CMD curl -f http://localhost/health
</code></pre>
<h2 id="volumes-1"><a class="header" href="#volumes-1">Volumes</a></h2>
<pre><code class="language-bash"># Mount host directory
docker run -v /host/path:/container/path myapp

# Named volume
docker run -v myvolume:/data myapp

# View volumes
docker volume ls
</code></pre>
<h2 id="eli10-32"><a class="header" href="#eli10-32">ELI10</a></h2>
<p>Docker is like shipping containers for code:</p>
<ul>
<li>Package everything needed (dependencies, code, config)</li>
<li>Send it anywhere (laptop, server, cloud)</li>
<li>Runs the same everywhere!</li>
</ul>
<p>No more "it works on my machine" problems!</p>
<h2 id="further-resources-46"><a class="header" href="#further-resources-46">Further Resources</a></h2>
<ul>
<li><a href="https://docs.docker.com/">Docker Documentation</a></li>
<li><a href="https://hub.docker.com/">Docker Hub Images</a></li>
<li><a href="https://docs.docker.com/develop/dev-best-practices/">Docker Best Practices</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="kubernetes"><a class="header" href="#kubernetes">Kubernetes</a></h1>
<h2 id="overview-101"><a class="header" href="#overview-101">Overview</a></h2>
<p>Kubernetes (K8s) orchestrates containerized applications at scale, handling deployment, scaling, and networking.</p>
<h2 id="core-concepts-8"><a class="header" href="#core-concepts-8">Core Concepts</a></h2>
<h3 id="pods"><a class="header" href="#pods">Pods</a></h3>
<p>Smallest deployable unit (usually one container):</p>
<pre><code class="language-yaml">apiVersion: v1
kind: Pod
metadata:
  name: my-pod
spec:
  containers:
  - name: app
    image: myapp:1.0
    ports:
    - containerPort: 8000
</code></pre>
<h3 id="deployments"><a class="header" href="#deployments">Deployments</a></h3>
<p>Manages replicas of pods:</p>
<pre><code class="language-yaml">apiVersion: apps/v1
kind: Deployment
metadata:
  name: myapp
spec:
  replicas: 3
  selector:
    matchLabels:
      app: myapp
  template:
    metadata:
      labels:
        app: myapp
    spec:
      containers:
      - name: myapp
        image: myapp:1.0
        ports:
        - containerPort: 8000
</code></pre>
<h3 id="services"><a class="header" href="#services">Services</a></h3>
<p>Expose pods to network:</p>
<pre><code class="language-yaml">apiVersion: v1
kind: Service
metadata:
  name: myapp-service
spec:
  selector:
    app: myapp
  ports:
  - protocol: TCP
    port: 80
    targetPort: 8000
  type: LoadBalancer
</code></pre>
<h2 id="kubectl-commands"><a class="header" href="#kubectl-commands">kubectl Commands</a></h2>
<pre><code class="language-bash"># Create/update
kubectl apply -f deployment.yaml

# View resources
kubectl get pods
kubectl get deployments
kubectl get services

# Describe
kubectl describe pod my-pod

# Logs
kubectl logs my-pod

# Execute
kubectl exec -it my-pod -- bash

# Delete
kubectl delete pod my-pod
kubectl delete deployment myapp

# Scale
kubectl scale deployment myapp --replicas=5

# Port forwarding
kubectl port-forward myapp-pod 8000:8000
</code></pre>
<h2 id="architecture-6"><a class="header" href="#architecture-6">Architecture</a></h2>
<pre><code>┌─────────────────────────┐
│   Control Plane         │
│  - API Server           │
│  - etcd (store)         │
│  - Scheduler            │
│  - Controller Manager   │
└─────────────────────────┘
          ↓
┌─────────────────────────────────────┐
│  Worker Nodes                       │
│  ┌──────┐  ┌──────┐  ┌──────┐     │
│  │ Pod  │  │ Pod  │  │ Pod  │     │
│  └──────┘  └──────┘  └──────┘     │
└─────────────────────────────────────┘
</code></pre>
<h2 id="configmap--secrets"><a class="header" href="#configmap--secrets">ConfigMap &amp; Secrets</a></h2>
<pre><code class="language-yaml"># ConfigMap (non-sensitive)
apiVersion: v1
kind: ConfigMap
metadata:
  name: app-config
data:
  LOG_LEVEL: "info"
  DATABASE_HOST: "db.example.com"

---
# Secret (sensitive)
apiVersion: v1
kind: Secret
metadata:
  name: db-secret
type: Opaque
data:
  password: cGFzc3dvcmQxMjM=  # Base64 encoded
</code></pre>
<h2 id="namespaces"><a class="header" href="#namespaces">Namespaces</a></h2>
<p>Logical cluster partitions:</p>
<pre><code class="language-bash">kubectl create namespace development
kubectl apply -f deployment.yaml -n development
kubectl get pods -n development
</code></pre>
<h2 id="scaling--updates"><a class="header" href="#scaling--updates">Scaling &amp; Updates</a></h2>
<pre><code class="language-bash"># Manual scaling
kubectl scale deployment myapp --replicas=10

# Rolling update
kubectl set image deployment/myapp myapp=myapp:2.0
kubectl rollout status deployment/myapp
kubectl rollout undo deployment/myapp  # Revert
</code></pre>
<h2 id="resource-limits"><a class="header" href="#resource-limits">Resource Limits</a></h2>
<pre><code class="language-yaml">spec:
  containers:
  - name: myapp
    resources:
      requests:
        memory: "64Mi"
        cpu: "250m"
      limits:
        memory: "128Mi"
        cpu: "500m"
</code></pre>
<h2 id="eli10-33"><a class="header" href="#eli10-33">ELI10</a></h2>
<p>Kubernetes is like a smart warehouse manager:</p>
<ul>
<li>Receives orders (deployments)</li>
<li>Assigns workers (pods)</li>
<li>Keeps right number working</li>
<li>Fixes broken ones automatically</li>
<li>Spreads load across workers</li>
</ul>
<p>Imagine managing 1000 containers automatically!</p>
<h2 id="further-resources-47"><a class="header" href="#further-resources-47">Further Resources</a></h2>
<ul>
<li><a href="https://kubernetes.io/docs/">Kubernetes Docs</a></li>
<li><a href="https://kubernetes.io/docs/tutorials/kubernetes-basics/">Interactive Tutorial</a></li>
<li><a href="https://kubernetes.io/docs/reference/kubectl/cheatsheet/">kubectl Cheatsheet</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cicd-fundamentals"><a class="header" href="#cicd-fundamentals">CI/CD Fundamentals</a></h1>
<h2 id="overview-102"><a class="header" href="#overview-102">Overview</a></h2>
<p><strong>CI (Continuous Integration)</strong>: Automatically test code on every commit
<strong>CD (Continuous Deployment)</strong>: Automatically deploy to production</p>
<h2 id="pipeline-stages"><a class="header" href="#pipeline-stages">Pipeline Stages</a></h2>
<pre><code>Code Commit
    ↓
Build (compile, package)
    ↓
Test (unit, integration, e2e)
    ↓
Deploy to Staging
    ↓
Manual/Automated Approval
    ↓
Deploy to Production
</code></pre>
<h2 id="tools-17"><a class="header" href="#tools-17">Tools</a></h2>
<h3 id="github-actions"><a class="header" href="#github-actions">GitHub Actions</a></h3>
<pre><code class="language-yaml">name: CI/CD

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2

    - name: Set up Node.js
      uses: actions/setup-node@v2
      with:
        node-version: '16'

    - name: Install dependencies
      run: npm install

    - name: Run tests
      run: npm test

    - name: Run linter
      run: npm run lint

    - name: Deploy to production
      if: github.ref == 'refs/heads/main'
      run: npm run deploy
</code></pre>
<h3 id="gitlab-ci"><a class="header" href="#gitlab-ci">GitLab CI</a></h3>
<pre><code class="language-yaml">stages:
  - build
  - test
  - deploy

build:
  stage: build
  script:
    - npm install
    - npm run build
  artifacts:
    paths:
      - dist/

test:
  stage: test
  script:
    - npm install
    - npm test

deploy:
  stage: deploy
  script:
    - npm run deploy
  only:
    - main
</code></pre>
<h2 id="best-practices-88"><a class="header" href="#best-practices-88">Best Practices</a></h2>
<ol>
<li><strong>Automated Testing</strong>: Every commit</li>
<li><strong>Fast Feedback</strong>: Minutes, not hours</li>
<li><strong>Deploy Often</strong>: Small, frequent changes</li>
<li><strong>Monitoring</strong>: Alert on failures</li>
<li><strong>Rollback Ready</strong>: Revert quickly if needed</li>
</ol>
<h2 id="pipeline-as-code"><a class="header" href="#pipeline-as-code">Pipeline as Code</a></h2>
<p>Define pipeline in version control:</p>
<pre><code class="language-yaml"># .github/workflows/deploy.yml
name: Deploy
on: [push]
jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - run: docker build -t myapp .
      - run: docker push myapp:latest
      - run: kubectl apply -f deployment.yaml
</code></pre>
<h2 id="deployment-strategies"><a class="header" href="#deployment-strategies">Deployment Strategies</a></h2>
<h3 id="blue-green"><a class="header" href="#blue-green">Blue-Green</a></h3>
<pre><code>Blue (current):  Production v1
Green (new):     Production v2

Switch traffic instantly to v2
If issue: Switch back to v1
</code></pre>
<h3 id="canary"><a class="header" href="#canary">Canary</a></h3>
<pre><code>Release to 5% of users first
Monitor metrics
If healthy: 10% → 25% → 50% → 100%
If issues: Rollback at any stage
</code></pre>
<h3 id="rolling"><a class="header" href="#rolling">Rolling</a></h3>
<pre><code>Stop pod, deploy new version
Repeat for each pod
Zero downtime
</code></pre>
<h2 id="monitoring-in-cicd"><a class="header" href="#monitoring-in-cicd">Monitoring in CI/CD</a></h2>
<pre><code class="language-yaml"># Check metrics after deploy
- name: Health check
  run: |
    curl -f https://api.example.com/health || exit 1

- name: Performance check
  run: |
    response_time=$(curl -w '%{time_total}' https://api.example.com)
    if (( $(echo "$response_time &gt; 2.0" | bc -l) )); then
      echo "Slow response: $response_time seconds"
      exit 1
    fi
</code></pre>
<h2 id="common-issues-25"><a class="header" href="#common-issues-25">Common Issues</a></h2>
<h3 id="flaky-tests"><a class="header" href="#flaky-tests">Flaky Tests</a></h3>
<p>Tests that pass/fail randomly
<strong>Solution</strong>: Fix test, increase timeout, isolate dependencies</p>
<h3 id="deployment-failures"><a class="header" href="#deployment-failures">Deployment Failures</a></h3>
<p><strong>Solution</strong>: Pre-deployment checks, canary deployments, rollback procedures</p>
<h3 id="security-vulnerabilities"><a class="header" href="#security-vulnerabilities">Security Vulnerabilities</a></h3>
<p><strong>Solution</strong>: Dependency scanning, static code analysis, container scanning</p>
<h2 id="eli10-34"><a class="header" href="#eli10-34">ELI10</a></h2>
<p>CI/CD is like an assembly line:</p>
<ol>
<li><strong>CI</strong>: Test each part as made</li>
<li><strong>CD</strong>: Automatically package and ship</li>
<li><strong>Monitoring</strong>: Check if delivery was successful</li>
</ol>
<p>Catch problems BEFORE customers see them!</p>
<h2 id="further-resources-48"><a class="header" href="#further-resources-48">Further Resources</a></h2>
<ul>
<li><a href="https://docs.github.com/en/actions">GitHub Actions Documentation</a></li>
<li><a href="https://docs.gitlab.com/ee/ci/">GitLab CI/CD</a></li>
<li><a href="https://www.jenkins.io/doc/">Jenkins Guide</a></li>
<li><a href="https://12factor.net/">The Twelve-Factor App</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="system-design"><a class="header" href="#system-design">System Design</a></h1>
<p>Designing large-scale distributed systems for performance, scalability, and reliability.</p>
<h2 id="topics-covered-3"><a class="header" href="#topics-covered-3">Topics Covered</a></h2>
<ul>
<li><strong><a href="system_design/scalability.html">Scalability</a></strong>: Horizontal vs vertical scaling, load balancing strategies</li>
<li><strong><a href="system_design/caching.html">Caching</a></strong>: Cache strategies, invalidation, distributed caching</li>
<li><strong><a href="system_design/rpc.html">RPC</a></strong>: Remote Procedure Call frameworks and patterns</li>
<li><strong><a href="system_design/microservices.html">Microservices</a></strong>: Microservices architecture patterns, service decomposition, communication patterns</li>
<li><strong>Databases</strong>: SQL vs NoSQL, sharding, replication</li>
<li><strong>Message Queues</strong>: Asynchronous processing, event-driven architecture</li>
<li><strong>Distributed Consensus</strong>: Consistency models, CAP theorem</li>
<li><strong>Design Patterns</strong>: Common solutions for distributed systems</li>
</ul>
<h2 id="key-concepts-35"><a class="header" href="#key-concepts-35">Key Concepts</a></h2>
<ul>
<li><strong>Throughput</strong>: Requests per second</li>
<li><strong>Latency</strong>: Response time</li>
<li><strong>Availability</strong>: Uptime percentage</li>
<li><strong>Consistency</strong>: Data correctness</li>
<li><strong>Partition Tolerance</strong>: Handling failures</li>
</ul>
<h2 id="design-goals"><a class="header" href="#design-goals">Design Goals</a></h2>
<ol>
<li><strong>Reliability</strong>: Surviving failures</li>
<li><strong>Scalability</strong>: Growing with demand</li>
<li><strong>Performance</strong>: Fast responses</li>
<li><strong>Maintainability</strong>: Easy to update</li>
</ol>
<h2 id="steps-to-design-system"><a class="header" href="#steps-to-design-system">Steps to Design System</a></h2>
<ol>
<li>Understand requirements and constraints</li>
<li>High-level architecture</li>
<li>Detailed design of components</li>
<li>Identify bottlenecks</li>
<li>Trade-offs and optimization</li>
</ol>
<h2 id="navigation-3"><a class="header" href="#navigation-3">Navigation</a></h2>
<p>Learn principles for designing systems at scale.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="scalability"><a class="header" href="#scalability">Scalability</a></h1>
<h2 id="overview-103"><a class="header" href="#overview-103">Overview</a></h2>
<p>Scalability is the ability to handle increased load by adding more resources.</p>
<h2 id="vertical-scaling"><a class="header" href="#vertical-scaling">Vertical Scaling</a></h2>
<p>Add more power to existing machines:</p>
<pre><code>1 machine: 8 cores, 32GB RAM
→ Upgrade to: 16 cores, 128GB RAM
</code></pre>
<p><strong>Pros</strong>: Simple, less complexity
<strong>Cons</strong>: Hardware limits, single point of failure</p>
<h2 id="horizontal-scaling"><a class="header" href="#horizontal-scaling">Horizontal Scaling</a></h2>
<p>Add more machines:</p>
<pre><code>Machine 1: Handle requests
Machine 2: Handle requests
Machine 3: Handle requests
↓ Load Balancer ↓
     Clients
</code></pre>
<p><strong>Pros</strong>: Unlimited growth, fault tolerance
<strong>Cons</strong>: More complexity, state management</p>
<h2 id="load-balancing"><a class="header" href="#load-balancing">Load Balancing</a></h2>
<pre><code>    Client Request
         ↓
   ┌─ Load Balancer ─┐
   ↓        ↓        ↓
Server1  Server2  Server3
</code></pre>
<p><strong>Algorithms</strong>:</p>
<ul>
<li><strong>Round Robin</strong>: Rotate servers</li>
<li><strong>Least Connections</strong>: Route to least busy</li>
<li><strong>IP Hash</strong>: Same client to same server</li>
<li><strong>Weighted</strong>: Distribute by capacity</li>
</ul>
<h2 id="database-scaling"><a class="header" href="#database-scaling">Database Scaling</a></h2>
<h3 id="replication-1"><a class="header" href="#replication-1">Replication</a></h3>
<p>Master-slave setup:</p>
<ul>
<li>Master: Writes</li>
<li>Slaves: Read copies</li>
</ul>
<pre><code>      Master (R/W)
      ↙    ↓    ↘
   Slave1 Slave2 Slave3 (R only)
</code></pre>
<h3 id="sharding"><a class="header" href="#sharding">Sharding</a></h3>
<p>Partition data across databases:</p>
<pre><code>Shard 1: Users 1-1M
Shard 2: Users 1M-2M
Shard 3: Users 2M-3M

By User ID % 3 → Route to correct shard
</code></pre>
<h2 id="caching-1"><a class="header" href="#caching-1">Caching</a></h2>
<p>Store frequently accessed data:</p>
<pre><code>Client Request
     ↓
Check Cache (fast)
  ↓ miss ↓ hit
Database → Client
(slow)
</code></pre>
<p><strong>Cache Invalidation</strong>:</p>
<ul>
<li><strong>TTL</strong>: Expire after time</li>
<li><strong>Event-based</strong>: Invalidate on update</li>
<li><strong>LRU</strong>: Remove least used items</li>
</ul>
<h2 id="common-patterns-21"><a class="header" href="#common-patterns-21">Common Patterns</a></h2>
<h3 id="cdn-content-delivery-network"><a class="header" href="#cdn-content-delivery-network">CDN (Content Delivery Network)</a></h3>
<p>Distributed servers for static content:</p>
<pre><code>User in Asia → Asia CDN Server (fast)
User in US → US CDN Server (fast)
</code></pre>
<h3 id="queue-systems"><a class="header" href="#queue-systems">Queue Systems</a></h3>
<p>Handle spikes asynchronously:</p>
<pre><code>Request → Queue → Worker Pool → Database
(fast)              (slow processing)
</code></pre>
<h3 id="read-replicas"><a class="header" href="#read-replicas">Read Replicas</a></h3>
<p>Separate read and write:</p>
<pre><code>Write (slow): Direct to master
Read (fast): From replicas
</code></pre>
<h2 id="metrics"><a class="header" href="#metrics">Metrics</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Metric</th><th>Target</th></tr></thead><tbody>
<tr><td><strong>Response Time</strong></td><td>&lt;100ms</td></tr>
<tr><td><strong>Throughput</strong></td><td>&gt;1000 req/s</td></tr>
<tr><td><strong>Uptime</strong></td><td>&gt;99.9%</td></tr>
<tr><td><strong>Availability</strong></td><td>5-9s</td></tr>
</tbody></table>
</div>
<h2 id="eli10-35"><a class="header" href="#eli10-35">ELI10</a></h2>
<p>Scalability is like growing a restaurant:</p>
<ul>
<li><strong>Vertical</strong>: Make kitchen bigger (limited)</li>
<li><strong>Horizontal</strong>: Open more locations (unlimited)</li>
<li><strong>Load balancer</strong>: Customers split between locations</li>
<li><strong>Caching</strong>: Keep popular dishes ready</li>
<li><strong>Queues</strong>: Don't overwhelm kitchen</li>
</ul>
<p>Design for growth from day one!</p>
<h2 id="further-resources-49"><a class="header" href="#further-resources-49">Further Resources</a></h2>
<ul>
<li><a href="https://dataintensive.app/">Designing Data-Intensive Applications</a></li>
<li><a href="https://www.systemdesigninterview.com/">System Design Interview</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="caching-strategies-1"><a class="header" href="#caching-strategies-1">Caching Strategies</a></h1>
<h2 id="overview-104"><a class="header" href="#overview-104">Overview</a></h2>
<p>Caching stores frequently accessed data in fast memory to reduce latency and database load.</p>
<h2 id="cache-levels-1"><a class="header" href="#cache-levels-1">Cache Levels</a></h2>
<pre><code>L1: Browser cache (browser memory)
  ↓
L2: CDN cache (edge servers)
  ↓
L3: Application cache (Redis)
  ↓
L4: Database cache (MySQL buffer pool)
  ↓
Database (disk, slowest)
</code></pre>
<h2 id="caching-policies"><a class="header" href="#caching-policies">Caching Policies</a></h2>
<h3 id="cache-aside-lazy-loading-1"><a class="header" href="#cache-aside-lazy-loading-1">Cache-Aside (Lazy Loading)</a></h3>
<pre><code>1. Check cache
2. If miss: Load from database
3. Store in cache
4. Return to client
</code></pre>
<pre><code class="language-python">def get_user(user_id):
    # Check cache
    cached = redis.get(f"user:{user_id}")
    if cached:
        return cached

    # Load from DB
    user = db.get_user(user_id)

    # Store in cache
    redis.set(f"user:{user_id}", user, ex=3600)

    return user
</code></pre>
<h3 id="write-through"><a class="header" href="#write-through">Write-Through</a></h3>
<p>Write to cache AND database simultaneously:</p>
<pre><code>Update Request
  ↓
Cache ← updated
  ↓
Database ← updated
</code></pre>
<p>Ensures consistency but slower writes.</p>
<h3 id="write-behind-write-back"><a class="header" href="#write-behind-write-back">Write-Behind (Write-Back)</a></h3>
<p>Write to cache, asynchronously to database:</p>
<pre><code>Update Request
  ↓
Cache ← updated (fast)
  ↓
Queue for DB
  ↓
Database ← updated (later)
</code></pre>
<p>Fast but risk of data loss.</p>
<h2 id="invalidation-strategies"><a class="header" href="#invalidation-strategies">Invalidation Strategies</a></h2>
<h3 id="ttl-time-to-live-3"><a class="header" href="#ttl-time-to-live-3">TTL (Time-To-Live)</a></h3>
<pre><code class="language-python">redis.set("key", value, ex=3600)  # Expires in 1 hour
</code></pre>
<p><strong>Pros</strong>: Simple
<strong>Cons</strong>: Stale data until expiry</p>
<h3 id="event-based"><a class="header" href="#event-based">Event-Based</a></h3>
<p>Invalidate when data changes:</p>
<pre><code class="language-python">def update_user(user_id, data):
    db.update_user(user_id, data)
    redis.delete(f"user:{user_id}")  # Invalidate
</code></pre>
<p><strong>Pros</strong>: Fresh data
<strong>Cons</strong>: Complex logic</p>
<h3 id="lru-least-recently-used"><a class="header" href="#lru-least-recently-used">LRU (Least Recently Used)</a></h3>
<p>Remove least used items when full:</p>
<pre><code>[recent] A B C D E [old]
Remove E if memory full
</code></pre>
<h2 id="cache-eviction-policies"><a class="header" href="#cache-eviction-policies">Cache Eviction Policies</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Policy</th><th>Behavior</th></tr></thead><tbody>
<tr><td><strong>LRU</strong></td><td>Remove least recently used</td></tr>
<tr><td><strong>LFU</strong></td><td>Remove least frequently used</td></tr>
<tr><td><strong>FIFO</strong></td><td>Remove oldest</td></tr>
<tr><td><strong>Random</strong></td><td>Remove random</td></tr>
</tbody></table>
</div>
<h2 id="distributed-caching"><a class="header" href="#distributed-caching">Distributed Caching</a></h2>
<p>Using Redis for distributed cache:</p>
<pre><code class="language-python">import redis

cache = redis.Redis(host='localhost', port=6379)

# Set
cache.set('key', 'value')
cache.setex('key', 3600, 'value')  # With TTL

# Get
value = cache.get('key')

# Delete
cache.delete('key')

# Multi-key
cache.mget(['key1', 'key2', 'key3'])
</code></pre>
<h2 id="cache-stampede"><a class="header" href="#cache-stampede">Cache Stampede</a></h2>
<p>Problem: Multiple requests load same expired key</p>
<pre><code>3 requests arrive
Cache expired for key X
All 3 hit database (thundering herd)
</code></pre>
<p><strong>Solution</strong>: Lock pattern</p>
<pre><code class="language-python">def get_cached(key):
    value = cache.get(key)
    if value:
        return value

    if cache.get(f"{key}:lock"):
        # Wait, someone loading
        return wait_for_cache(key)

    # Set lock, load data
    cache.set(f"{key}:lock", "1", ex=5)
    value = load_from_db(key)
    cache.set(key, value)
    cache.delete(f"{key}:lock")
    return value
</code></pre>
<h2 id="common-caching-patterns"><a class="header" href="#common-caching-patterns">Common Caching Patterns</a></h2>
<h3 id="cache-coherence"><a class="header" href="#cache-coherence">Cache Coherence</a></h3>
<p>Multiple caches have same data</p>
<h3 id="cache-penetration"><a class="header" href="#cache-penetration">Cache Penetration</a></h3>
<p>Request for non-existent key hits DB repeatedly</p>
<p><strong>Solution</strong>: Cache negative results</p>
<pre><code class="language-python">cache.set(f"user:{id}", None, ex=60)
</code></pre>
<h3 id="cache-avalanche"><a class="header" href="#cache-avalanche">Cache Avalanche</a></h3>
<p>Many keys expire simultaneously</p>
<p><strong>Solution</strong>: Randomize TTLs</p>
<pre><code class="language-python">ttl = 3600 + random(0, 600)
cache.set(key, value, ex=ttl)
</code></pre>
<h2 id="when-not-to-cache"><a class="header" href="#when-not-to-cache">When NOT to Cache</a></h2>
<ul>
<li>Constantly changing data</li>
<li>Very frequently read, rarely write</li>
<li>Small datasets</li>
<li>Rare access patterns</li>
</ul>
<h2 id="eli10-36"><a class="header" href="#eli10-36">ELI10</a></h2>
<p>Cache is like keeping your favorite book on your desk:</p>
<ul>
<li>Fast access (don't go to library)</li>
<li>Runs out of space (limited shelf)</li>
<li>Need to replace old books (eviction)</li>
<li>Book gets outdated (invalidation)</li>
</ul>
<p>Trade memory for speed!</p>
<h2 id="further-resources-50"><a class="header" href="#further-resources-50">Further Resources</a></h2>
<ul>
<li><a href="https://redis.io/docs/">Redis Documentation</a></li>
<li><a href="https://codeahoy.com/2017/08/11/caching-strategies-and-patterns/">Caching Patterns</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rpc-remote-procedure-call"><a class="header" href="#rpc-remote-procedure-call">RPC (Remote Procedure Call)</a></h1>
<p>RPC is a protocol that allows a program to execute a procedure on another computer as if it were a local procedure call.</p>
<h2 id="overview-105"><a class="header" href="#overview-105">Overview</a></h2>
<p>RPC abstracts network communication, making distributed computing appear like local function calls.</p>
<p><strong>Key Concepts:</strong></p>
<ul>
<li>Client-Server model</li>
<li>Stub generation</li>
<li>Marshalling/Unmarshalling</li>
<li>Synchronous or asynchronous calls</li>
</ul>
<h2 id="common-rpc-frameworks"><a class="header" href="#common-rpc-frameworks">Common RPC Frameworks</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Framework</th><th>Protocol</th><th>Language</th></tr></thead><tbody>
<tr><td>gRPC</td><td>HTTP/2, Protobuf</td><td>Multi-language</td></tr>
<tr><td>JSON-RPC</td><td>HTTP, JSON</td><td>Multi-language</td></tr>
<tr><td>XML-RPC</td><td>HTTP, XML</td><td>Multi-language</td></tr>
<tr><td>Apache Thrift</td><td>Binary</td><td>Multi-language</td></tr>
</tbody></table>
</div>
<h2 id="grpc-example"><a class="header" href="#grpc-example">gRPC Example</a></h2>
<pre><code class="language-protobuf">// service.proto
service Calculator {
  rpc Add(Numbers) returns (Result);
}

message Numbers {
  int32 a = 1;
  int32 b = 2;
}

message Result {
  int32 value = 1;
}
</code></pre>
<h2 id="json-rpc-example"><a class="header" href="#json-rpc-example">JSON-RPC Example</a></h2>
<pre><code class="language-json">// Request
{
  "jsonrpc": "2.0",
  "method": "add",
  "params": {"a": 5, "b": 3},
  "id": 1
}

// Response
{
  "jsonrpc": "2.0",
  "result": 8,
  "id": 1
}
</code></pre>
<h2 id="advantages-3"><a class="header" href="#advantages-3">Advantages</a></h2>
<ul>
<li>Simple interface (like local calls)</li>
<li>Language-agnostic</li>
<li>Abstraction of network details</li>
<li>Type safety (with IDL)</li>
</ul>
<h2 id="challenges"><a class="header" href="#challenges">Challenges</a></h2>
<ul>
<li>Network failures</li>
<li>Latency</li>
<li>Versioning</li>
<li>Error handling complexity</li>
</ul>
<p>RPC simplifies distributed system development by providing procedure call semantics over network communication.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="microservices-architecture"><a class="header" href="#microservices-architecture">Microservices Architecture</a></h1>
<p>Microservices is an architectural style that structures an application as a collection of loosely coupled, independently deployable services. Each service is self-contained, implements a specific business capability, and communicates with other services through well-defined APIs.</p>
<h2 id="table-of-contents-52"><a class="header" href="#table-of-contents-52">Table of Contents</a></h2>
<ul>
<li><a href="system_design/microservices.html#introduction">Introduction</a></li>
<li><a href="system_design/microservices.html#core-principles">Core Principles</a></li>
<li><a href="system_design/microservices.html#service-design">Service Design</a></li>
<li><a href="system_design/microservices.html#communication-patterns">Communication Patterns</a></li>
<li><a href="system_design/microservices.html#service-discovery">Service Discovery</a></li>
<li><a href="system_design/microservices.html#api-gateway">API Gateway</a></li>
<li><a href="system_design/microservices.html#data-management">Data Management</a></li>
<li><a href="system_design/microservices.html#deployment-and-devops">Deployment and DevOps</a></li>
<li><a href="system_design/microservices.html#best-practices">Best Practices</a></li>
<li><a href="system_design/microservices.html#challenges-and-solutions">Challenges and Solutions</a></li>
</ul>
<hr />
<h2 id="introduction-32"><a class="header" href="#introduction-32">Introduction</a></h2>
<p><strong>What are Microservices?</strong>
Microservices break down a large application into smaller, independent services that:</p>
<ul>
<li>Run in their own processes</li>
<li>Communicate via lightweight protocols (HTTP, message queues)</li>
<li>Can be deployed independently</li>
<li>Can use different technologies</li>
<li>Are organized around business capabilities</li>
</ul>
<p><strong>Benefits:</strong></p>
<ul>
<li>Independent deployment and scaling</li>
<li>Technology diversity</li>
<li>Fault isolation</li>
<li>Team autonomy</li>
<li>Faster development cycles</li>
<li>Easier to understand and maintain small services</li>
</ul>
<p><strong>Challenges:</strong></p>
<ul>
<li>Distributed system complexity</li>
<li>Network latency and failures</li>
<li>Data consistency</li>
<li>Testing complexity</li>
<li>Operational overhead</li>
<li>Service coordination</li>
</ul>
<hr />
<h2 id="core-principles-2"><a class="header" href="#core-principles-2">Core Principles</a></h2>
<h3 id="1-single-responsibility"><a class="header" href="#1-single-responsibility">1. Single Responsibility</a></h3>
<p>Each service handles one business capability.</p>
<pre><code>❌ Monolith: One service handles users, orders, payments, inventory
✅ Microservices:
   - User Service: Authentication, profiles
   - Order Service: Order management
   - Payment Service: Payment processing
   - Inventory Service: Stock management
</code></pre>
<h3 id="2-decentralized-data-management"><a class="header" href="#2-decentralized-data-management">2. Decentralized Data Management</a></h3>
<p>Each service owns its data store.</p>
<pre><code class="language-javascript">// Each service has its own database
User Service → Users DB (PostgreSQL)
Order Service → Orders DB (MongoDB)
Inventory Service → Inventory DB (MySQL)
</code></pre>
<h3 id="3-smart-endpoints-dumb-pipes"><a class="header" href="#3-smart-endpoints-dumb-pipes">3. Smart Endpoints, Dumb Pipes</a></h3>
<p>Services are intelligent; communication is simple.</p>
<pre><code class="language-javascript">// Services handle business logic
// Communication uses simple protocols (HTTP, AMQP)
</code></pre>
<h3 id="4-design-for-failure"><a class="header" href="#4-design-for-failure">4. Design for Failure</a></h3>
<p>Expect services to fail; build resilience.</p>
<pre><code class="language-javascript">// Circuit breakers
// Retries
// Fallbacks
// Timeouts
</code></pre>
<hr />
<h2 id="service-design"><a class="header" href="#service-design">Service Design</a></h2>
<h3 id="domain-driven-design"><a class="header" href="#domain-driven-design">Domain-Driven Design</a></h3>
<pre><code class="language-javascript">// Bounded Contexts
Order Context {
  - Order
  - OrderItem
  - OrderStatus
}

User Context {
  - User
  - Profile
  - Authentication
}

Payment Context {
  - Payment
  - Transaction
  - PaymentMethod
}
</code></pre>
<h3 id="service-size"><a class="header" href="#service-size">Service Size</a></h3>
<pre><code class="language-javascript">// Small enough to:
// - Be maintained by a small team (2-pizza team)
// - Be rewritten in 2-4 weeks
// - Have a clear purpose

// Large enough to:
// - Provide business value
// - Minimize inter-service communication
// - Have a clear domain boundary
</code></pre>
<h3 id="example-service-structure"><a class="header" href="#example-service-structure">Example Service Structure</a></h3>
<pre><code>order-service/
├── src/
│   ├── api/
│   │   ├── routes/
│   │   └── controllers/
│   ├── domain/
│   │   ├── models/
│   │   └── services/
│   ├── infrastructure/
│   │   ├── database/
│   │   └── messaging/
│   ├── config/
│   └── main.ts
├── tests/
├── Dockerfile
├── package.json
└── README.md
</code></pre>
<hr />
<h2 id="communication-patterns"><a class="header" href="#communication-patterns">Communication Patterns</a></h2>
<h3 id="synchronous-communication-resthttp"><a class="header" href="#synchronous-communication-resthttp">Synchronous Communication (REST/HTTP)</a></h3>
<p><strong>Example: Order Service calling User Service</strong></p>
<pre><code class="language-javascript">// order-service/userClient.js
const axios = require('axios');

class UserServiceClient {
  constructor(baseURL) {
    this.client = axios.create({
      baseURL: baseURL || process.env.USER_SERVICE_URL,
      timeout: 5000
    });
  }

  async getUser(userId) {
    try {
      const response = await this.client.get(`/users/${userId}`);
      return response.data;
    } catch (error) {
      if (error.code === 'ECONNABORTED') {
        throw new Error('User service timeout');
      }
      throw error;
    }
  }
}

// Usage in order service
async function createOrder(orderData) {
  const userClient = new UserServiceClient();
  const user = await userClient.getUser(orderData.userId);

  if (!user) {
    throw new Error('User not found');
  }

  // Create order logic...
}
</code></pre>
<h3 id="asynchronous-communication-message-queues"><a class="header" href="#asynchronous-communication-message-queues">Asynchronous Communication (Message Queues)</a></h3>
<p><strong>Example: Event-Driven Communication</strong></p>
<pre><code class="language-javascript">// order-service/publisher.js
const { Kafka } = require('kafkajs');

const kafka = new Kafka({
  clientId: 'order-service',
  brokers: ['kafka:9092']
});

const producer = kafka.producer();

async function publishOrderCreated(order) {
  await producer.send({
    topic: 'order.created',
    messages: [{
      key: `order:${order.id}`,
      value: JSON.stringify({
        orderId: order.id,
        userId: order.userId,
        items: order.items,
        total: order.total,
        timestamp: Date.now()
      })
    }]
  });
}

// inventory-service/consumer.js
const consumer = kafka.consumer({
  groupId: 'inventory-service'
});

async function start() {
  await consumer.subscribe({ topic: 'order.created' });

  await consumer.run({
    eachMessage: async ({ message }) =&gt; {
      const order = JSON.parse(message.value.toString());

      console.log('Reserving inventory for order:', order.orderId);

      await reserveInventory(order.items);

      // Publish inventory.reserved event
      await publishInventoryReserved(order.orderId);
    }
  });
}
</code></pre>
<h3 id="api-composition-pattern"><a class="header" href="#api-composition-pattern">API Composition Pattern</a></h3>
<pre><code class="language-javascript">// api-gateway/orderComposer.js
class OrderComposer {
  constructor(userService, orderService, inventoryService) {
    this.userService = userService;
    this.orderService = orderService;
    this.inventoryService = inventoryService;
  }

  async getOrderDetails(orderId) {
    // Parallel requests
    const [order, user, inventory] = await Promise.all([
      this.orderService.getOrder(orderId),
      this.userService.getUser(order.userId),
      this.inventoryService.checkAvailability(order.items)
    ]);

    return {
      order,
      user: {
        id: user.id,
        name: user.name,
        email: user.email
      },
      inventory
    };
  }
}
</code></pre>
<hr />
<h2 id="service-discovery"><a class="header" href="#service-discovery">Service Discovery</a></h2>
<h3 id="client-side-discovery"><a class="header" href="#client-side-discovery">Client-Side Discovery</a></h3>
<pre><code class="language-javascript">// service-registry.js
class ServiceRegistry {
  constructor() {
    this.services = new Map();
  }

  register(serviceName, instance) {
    if (!this.services.has(serviceName)) {
      this.services.set(serviceName, []);
    }
    this.services.get(serviceName).push(instance);
  }

  discover(serviceName) {
    const instances = this.services.get(serviceName) || [];
    if (instances.length === 0) {
      throw new Error(`No instances available for ${serviceName}`);
    }
    // Round-robin load balancing
    return instances[Math.floor(Math.random() * instances.length)];
  }
}

// Usage
const registry = new ServiceRegistry();
registry.register('user-service', { host: 'localhost', port: 3001 });
registry.register('user-service', { host: 'localhost', port: 3002 });

const instance = registry.discover('user-service');
</code></pre>
<h3 id="consul-integration"><a class="header" href="#consul-integration">Consul Integration</a></h3>
<pre><code class="language-javascript">const Consul = require('consul');

const consul = new Consul({
  host: 'consul-server',
  port: 8500
});

// Register service
async function registerService() {
  await consul.agent.service.register({
    name: 'order-service',
    id: `order-service-${process.env.INSTANCE_ID}`,
    address: process.env.SERVICE_HOST,
    port: parseInt(process.env.SERVICE_PORT),
    check: {
      http: `http://${process.env.SERVICE_HOST}:${process.env.SERVICE_PORT}/health`,
      interval: '10s'
    }
  });
}

// Discover service
async function discoverService(serviceName) {
  const result = await consul.health.service({
    service: serviceName,
    passing: true
  });

  const instances = result.map(item =&gt; ({
    address: item.Service.Address,
    port: item.Service.Port
  }));

  return instances;
}
</code></pre>
<hr />
<h2 id="api-gateway-1"><a class="header" href="#api-gateway-1">API Gateway</a></h2>
<h3 id="basic-api-gateway"><a class="header" href="#basic-api-gateway">Basic API Gateway</a></h3>
<pre><code class="language-javascript">const express = require('express');
const proxy = require('express-http-proxy');

const app = express();

// Service URLs
const USER_SERVICE = process.env.USER_SERVICE_URL;
const ORDER_SERVICE = process.env.ORDER_SERVICE_URL;
const PRODUCT_SERVICE = process.env.PRODUCT_SERVICE_URL;

// Authentication middleware
app.use(async (req, res, next) =&gt; {
  const token = req.headers.authorization;

  if (!token) {
    return res.status(401).json({ error: 'Unauthorized' });
  }

  try {
    const user = await verifyToken(token);
    req.user = user;
    next();
  } catch (error) {
    res.status(401).json({ error: 'Invalid token' });
  }
});

// Rate limiting
const rateLimit = require('express-rate-limit');

const limiter = rateLimit({
  windowMs: 15 * 60 * 1000,
  max: 100
});

app.use(limiter);

// Route to services
app.use('/api/users', proxy(USER_SERVICE));
app.use('/api/orders', proxy(ORDER_SERVICE));
app.use('/api/products', proxy(PRODUCT_SERVICE));

// Aggregation endpoint
app.get('/api/dashboard', async (req, res) =&gt; {
  try {
    const [user, orders, recommendations] = await Promise.all([
      axios.get(`${USER_SERVICE}/users/${req.user.id}`),
      axios.get(`${ORDER_SERVICE}/users/${req.user.id}/orders`),
      axios.get(`${PRODUCT_SERVICE}/recommendations/${req.user.id}`)
    ]);

    res.json({
      user: user.data,
      recentOrders: orders.data,
      recommendations: recommendations.data
    });
  } catch (error) {
    res.status(500).json({ error: 'Failed to load dashboard' });
  }
});

app.listen(3000);
</code></pre>
<hr />
<h2 id="data-management"><a class="header" href="#data-management">Data Management</a></h2>
<h3 id="database-per-service"><a class="header" href="#database-per-service">Database Per Service</a></h3>
<pre><code class="language-javascript">// Each service has its own database
services/
├── user-service/
│   └── database: PostgreSQL
├── order-service/
│   └── database: MongoDB
└── inventory-service/
    └── database: MySQL
</code></pre>
<h3 id="saga-pattern-distributed-transactions"><a class="header" href="#saga-pattern-distributed-transactions">Saga Pattern (Distributed Transactions)</a></h3>
<p><strong>Choreography-Based Saga:</strong></p>
<pre><code class="language-javascript">// Order Service
async function createOrder(orderData) {
  const order = await Order.create({
    ...orderData,
    status: 'PENDING'
  });

  // Publish event
  await publishEvent('order.created', order);

  return order;
}

// Inventory Service
consumer.on('order.created', async (order) =&gt; {
  try {
    await reserveInventory(order.items);
    await publishEvent('inventory.reserved', { orderId: order.id });
  } catch (error) {
    await publishEvent('inventory.failed', {
      orderId: order.id,
      error: error.message
    });
  }
});

// Payment Service
consumer.on('inventory.reserved', async ({ orderId }) =&gt; {
  try {
    await processPayment(orderId);
    await publishEvent('payment.completed', { orderId });
  } catch (error) {
    await publishEvent('payment.failed', { orderId, error: error.message });
  }
});

// Order Service - Handle success/failure
consumer.on('payment.completed', async ({ orderId }) =&gt; {
  await Order.update({ id: orderId }, { status: 'CONFIRMED' });
});

consumer.on('payment.failed', async ({ orderId }) =&gt; {
  await Order.update({ id: orderId }, { status: 'CANCELLED' });
  await publishEvent('order.cancelled', { orderId });
});

// Inventory Service - Compensating transaction
consumer.on('order.cancelled', async ({ orderId }) =&gt; {
  await releaseInventory(orderId);
});
</code></pre>
<h3 id="cqrs-command-query-responsibility-segregation"><a class="header" href="#cqrs-command-query-responsibility-segregation">CQRS (Command Query Responsibility Segregation)</a></h3>
<pre><code class="language-javascript">// Write Model (Commands)
class OrderWriteService {
  async createOrder(command) {
    const order = await Order.create(command);

    // Publish event
    await eventBus.publish('OrderCreated', {
      orderId: order.id,
      userId: order.userId,
      items: order.items
    });

    return order.id;
  }
}

// Read Model (Queries)
class OrderReadService {
  constructor(readDatabase) {
    this.db = readDatabase;
  }

  async getOrderById(orderId) {
    return await this.db.orders.findOne({ id: orderId });
  }

  async getOrdersByUser(userId) {
    return await this.db.orders.find({ userId });
  }
}

// Event Handler (updates read model)
eventBus.on('OrderCreated', async (event) =&gt; {
  await readDatabase.orders.insert({
    id: event.orderId,
    userId: event.userId,
    items: event.items,
    createdAt: new Date()
  });
});
</code></pre>
<hr />
<h2 id="deployment-and-devops"><a class="header" href="#deployment-and-devops">Deployment and DevOps</a></h2>
<h3 id="docker-compose-2"><a class="header" href="#docker-compose-2">Docker Compose</a></h3>
<pre><code class="language-yaml">version: '3.8'

services:
  api-gateway:
    build: ./api-gateway
    ports:
      - "3000:3000"
    environment:
      USER_SERVICE_URL: http://user-service:3001
      ORDER_SERVICE_URL: http://order-service:3002
    depends_on:
      - user-service
      - order-service

  user-service:
    build: ./user-service
    environment:
      DATABASE_URL: postgresql://postgres:password@user-db:5432/users
    depends_on:
      - user-db

  order-service:
    build: ./order-service
    environment:
      DATABASE_URL: mongodb://order-db:27017/orders
      KAFKA_BROKERS: kafka:9092
    depends_on:
      - order-db
      - kafka

  user-db:
    image: postgres:15
    environment:
      POSTGRES_PASSWORD: password

  order-db:
    image: mongo:6

  kafka:
    image: confluentinc/cp-kafka:latest
</code></pre>
<h3 id="kubernetes-1"><a class="header" href="#kubernetes-1">Kubernetes</a></h3>
<pre><code class="language-yaml"># order-service-deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: order-service
spec:
  replicas: 3
  selector:
    matchLabels:
      app: order-service
  template:
    metadata:
      labels:
        app: order-service
    spec:
      containers:
      - name: order-service
        image: myregistry/order-service:1.0.0
        ports:
        - containerPort: 3000
        env:
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: order-service-secrets
              key: database-url
        resources:
          requests:
            memory: "128Mi"
            cpu: "100m"
          limits:
            memory: "512Mi"
            cpu: "500m"
        livenessProbe:
          httpGet:
            path: /health
            port: 3000
          initialDelaySeconds: 30
          periodSeconds: 10
        readinessProbe:
          httpGet:
            path: /ready
            port: 3000
          initialDelaySeconds: 5
          periodSeconds: 5
---
apiVersion: v1
kind: Service
metadata:
  name: order-service
spec:
  selector:
    app: order-service
  ports:
  - port: 80
    targetPort: 3000
  type: ClusterIP
</code></pre>
<hr />
<h2 id="best-practices-89"><a class="header" href="#best-practices-89">Best Practices</a></h2>
<h3 id="1-circuit-breaker-pattern"><a class="header" href="#1-circuit-breaker-pattern">1. Circuit Breaker Pattern</a></h3>
<pre><code class="language-javascript">const CircuitBreaker = require('opossum');

const options = {
  timeout: 3000,
  errorThresholdPercentage: 50,
  resetTimeout: 30000
};

const breaker = new CircuitBreaker(callExternalService, options);

breaker.fallback(() =&gt; ({ fallback: 'value' }));

breaker.on('open', () =&gt; console.log('Circuit opened'));
breaker.on('halfOpen', () =&gt; console.log('Circuit half-open'));
breaker.on('close', () =&gt; console.log('Circuit closed'));

async function callExternalService() {
  const response = await axios.get('http://external-service/api');
  return response.data;
}

// Usage
try {
  const result = await breaker.fire();
  console.log(result);
} catch (error) {
  console.error('Service call failed');
}
</code></pre>
<h3 id="2-health-checks"><a class="header" href="#2-health-checks">2. Health Checks</a></h3>
<pre><code class="language-javascript">const express = require('express');
const app = express();

app.get('/health', async (req, res) =&gt; {
  const health = {
    uptime: process.uptime(),
    message: 'OK',
    timestamp: Date.now()
  };

  try {
    // Check database connection
    await database.ping();
    health.database = 'connected';
  } catch (error) {
    health.database = 'disconnected';
    health.message = 'Degraded';
    return res.status(503).json(health);
  }

  res.json(health);
});

app.get('/ready', async (req, res) =&gt; {
  try {
    // Check if service is ready to accept traffic
    await database.ping();
    await cache.ping();

    res.json({ status: 'ready' });
  } catch (error) {
    res.status(503).json({ status: 'not ready' });
  }
});
</code></pre>
<h3 id="3-distributed-tracing"><a class="header" href="#3-distributed-tracing">3. Distributed Tracing</a></h3>
<pre><code class="language-javascript">const { trace } = require('@opentelemetry/api');
const { NodeTracerProvider } = require('@opentelemetry/sdk-trace-node');

const provider = new NodeTracerProvider();
provider.register();

const tracer = trace.getTracer('order-service');

async function createOrder(orderData) {
  const span = tracer.startSpan('createOrder');

  try {
    // Add attributes
    span.setAttribute('user.id', orderData.userId);
    span.setAttribute('order.total', orderData.total);

    // Business logic
    const order = await Order.create(orderData);

    span.setStatus({ code: 0 }); // OK
    return order;
  } catch (error) {
    span.setStatus({
      code: 2, // ERROR
      message: error.message
    });
    throw error;
  } finally {
    span.end();
  }
}
</code></pre>
<h3 id="4-logging"><a class="header" href="#4-logging">4. Logging</a></h3>
<pre><code class="language-javascript">const winston = require('winston');

const logger = winston.createLogger({
  level: 'info',
  format: winston.format.json(),
  defaultMeta: {
    service: 'order-service',
    version: '1.0.0'
  },
  transports: [
    new winston.transports.File({ filename: 'error.log', level: 'error' }),
    new winston.transports.File({ filename: 'combined.log' })
  ]
});

// Structured logging
logger.info('Order created', {
  orderId: order.id,
  userId: order.userId,
  total: order.total,
  timestamp: Date.now()
});
</code></pre>
<hr />
<h2 id="challenges-and-solutions"><a class="header" href="#challenges-and-solutions">Challenges and Solutions</a></h2>
<h3 id="challenge-1-data-consistency"><a class="header" href="#challenge-1-data-consistency">Challenge 1: Data Consistency</a></h3>
<p><strong>Solution:</strong> Use eventual consistency with event-driven architecture</p>
<pre><code class="language-javascript">// Use events to propagate data changes
await publishEvent('user.updated', { userId, email: newEmail });

// Other services listen and update their local views
consumer.on('user.updated', async (event) =&gt; {
  await updateLocalUserCache(event.userId, event.email);
});
</code></pre>
<h3 id="challenge-2-service-communication-failures"><a class="header" href="#challenge-2-service-communication-failures">Challenge 2: Service Communication Failures</a></h3>
<p><strong>Solution:</strong> Implement retry logic with exponential backoff</p>
<pre><code class="language-javascript">async function callServiceWithRetry(fn, maxRetries = 3) {
  for (let i = 0; i &lt; maxRetries; i++) {
    try {
      return await fn();
    } catch (error) {
      if (i === maxRetries - 1) throw error;
      await sleep(Math.pow(2, i) * 1000);
    }
  }
}
</code></pre>
<h3 id="challenge-3-testing"><a class="header" href="#challenge-3-testing">Challenge 3: Testing</a></h3>
<p><strong>Solution:</strong> Use contract testing and integration tests</p>
<pre><code class="language-javascript">// Contract test (using Pact)
const { Pact } = require('@pact-foundation/pact');

const provider = new Pact({
  consumer: 'order-service',
  provider: 'user-service'
});

describe('User Service Contract', () =&gt; {
  it('should get user by ID', async () =&gt; {
    await provider.addInteraction({
      state: 'user 123 exists',
      uponReceiving: 'a request for user 123',
      withRequest: {
        method: 'GET',
        path: '/users/123'
      },
      willRespondWith: {
        status: 200,
        body: { id: 123, name: 'John' }
      }
    });

    // Test your client code
    const user = await userClient.getUser(123);
    expect(user.id).toBe(123);
  });
});
</code></pre>
<hr />
<h2 id="resources-46"><a class="header" href="#resources-46">Resources</a></h2>
<p><strong>Books:</strong></p>
<ul>
<li>Building Microservices by Sam Newman</li>
<li>Microservices Patterns by Chris Richardson</li>
<li>Release It! by Michael Nygard</li>
</ul>
<p><strong>Frameworks:</strong></p>
<ul>
<li><a href="https://expressjs.com/">Express.js</a></li>
<li><a href="https://nestjs.com/">NestJS</a></li>
<li><a href="https://spring.io/projects/spring-boot">Spring Boot</a></li>
<li><a href="https://gokit.io/">Go Kit</a></li>
</ul>
<p><strong>Tools:</strong></p>
<ul>
<li><a href="https://kubernetes.io/">Kubernetes</a></li>
<li><a href="https://istio.io/">Istio</a> - Service Mesh</li>
<li><a href="https://www.consul.io/">Consul</a> - Service Discovery</li>
<li><a href="https://www.jaegertracing.io/">Jaeger</a> - Distributed Tracing</li>
</ul>
<p><strong>Learning:</strong></p>
<ul>
<li><a href="https://microservices.io/">Microservices.io</a></li>
<li><a href="https://martinfowler.com/articles/microservices.html">Martin Fowler's Blog</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="mobile-development"><a class="header" href="#mobile-development">Mobile Development</a></h1>
<p>Cross-platform and native mobile application development frameworks and best practices.</p>
<h2 id="topics-covered-4"><a class="header" href="#topics-covered-4">Topics Covered</a></h2>
<h3 id="cross-platform-frameworks"><a class="header" href="#cross-platform-frameworks">Cross-Platform Frameworks</a></h3>
<ul>
<li>
<p><strong><a href="mobile_development/react_native.html">React Native</a></strong>: Build native mobile apps using React and JavaScript/TypeScript</p>
<ul>
<li>Component architecture and navigation</li>
<li>Platform-specific code</li>
<li>Native modules and bridges</li>
<li>Performance optimization</li>
<li>State management</li>
<li>Testing and debugging</li>
</ul>
</li>
<li>
<p><strong><a href="mobile_development/flutter.html">Flutter</a></strong>: Google's UI toolkit for building natively compiled applications</p>
<ul>
<li>Dart programming language</li>
<li>Widget-based architecture</li>
<li>State management (Provider, Riverpod, Bloc)</li>
<li>Platform channels for native code</li>
<li>Material Design and Cupertino widgets</li>
<li>Hot reload and development workflow</li>
</ul>
</li>
</ul>
<h2 id="platform-comparison"><a class="header" href="#platform-comparison">Platform Comparison</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Feature</th><th>React Native</th><th>Flutter</th></tr></thead><tbody>
<tr><td><strong>Language</strong></td><td>JavaScript/TypeScript</td><td>Dart</td></tr>
<tr><td><strong>Performance</strong></td><td>Near-native</td><td>Native</td></tr>
<tr><td><strong>UI</strong></td><td>Native components</td><td>Custom rendering</td></tr>
<tr><td><strong>Community</strong></td><td>Very large</td><td>Growing rapidly</td></tr>
<tr><td><strong>Learning Curve</strong></td><td>Easier (if you know React)</td><td>Moderate</td></tr>
<tr><td><strong>Hot Reload</strong></td><td>Yes</td><td>Yes</td></tr>
<tr><td><strong>Code Sharing</strong></td><td>High (with web)</td><td>High</td></tr>
</tbody></table>
</div>
<h2 id="development-workflow-1"><a class="header" href="#development-workflow-1">Development Workflow</a></h2>
<ol>
<li><strong>Setup</strong>: Install development environment and tools</li>
<li><strong>Design</strong>: Create UI/UX mockups</li>
<li><strong>Development</strong>: Write code with hot reload</li>
<li><strong>Testing</strong>: Unit, integration, and E2E tests</li>
<li><strong>Debugging</strong>: Use developer tools</li>
<li><strong>Deployment</strong>: Build and publish to app stores</li>
</ol>
<h2 id="key-concepts-36"><a class="header" href="#key-concepts-36">Key Concepts</a></h2>
<ul>
<li><strong>Cross-platform</strong>: Write once, run on iOS and Android</li>
<li><strong>Native modules</strong>: Access platform-specific features</li>
<li><strong>State management</strong>: Handle app state efficiently</li>
<li><strong>Navigation</strong>: Implement screen transitions</li>
<li><strong>Performance</strong>: Optimize for mobile devices</li>
<li><strong>Platform differences</strong>: Handle iOS and Android specifics</li>
</ul>
<h2 id="mobile-app-architecture"><a class="header" href="#mobile-app-architecture">Mobile App Architecture</a></h2>
<ul>
<li><strong>MVVM</strong> (Model-View-ViewModel): Separate UI from business logic</li>
<li><strong>Clean Architecture</strong>: Layered approach with dependency inversion</li>
<li><strong>BLoC</strong> (Business Logic Component): Event-driven architecture</li>
<li><strong>Redux/MobX</strong>: Centralized state management</li>
</ul>
<h2 id="best-practices-90"><a class="header" href="#best-practices-90">Best Practices</a></h2>
<ol>
<li>
<p><strong>Performance</strong></p>
<ul>
<li>Optimize images and assets</li>
<li>Use lazy loading</li>
<li>Minimize re-renders</li>
<li>Profile and monitor performance</li>
</ul>
</li>
<li>
<p><strong>User Experience</strong></p>
<ul>
<li>Follow platform guidelines (iOS HIG, Material Design)</li>
<li>Handle offline mode gracefully</li>
<li>Provide feedback for actions</li>
<li>Optimize for different screen sizes</li>
</ul>
</li>
<li>
<p><strong>Security</strong></p>
<ul>
<li>Secure storage for sensitive data</li>
<li>API authentication and authorization</li>
<li>SSL pinning</li>
<li>Code obfuscation</li>
</ul>
</li>
<li>
<p><strong>Testing</strong></p>
<ul>
<li>Write unit tests for business logic</li>
<li>Integration tests for features</li>
<li>E2E tests for critical flows</li>
<li>Test on multiple devices</li>
</ul>
</li>
</ol>
<h2 id="navigation-4"><a class="header" href="#navigation-4">Navigation</a></h2>
<p>Explore each framework to build production-ready mobile applications for iOS and Android.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="react-native"><a class="header" href="#react-native">React Native</a></h1>
<p>React Native is a popular JavaScript framework for building native mobile applications using React. It allows developers to use React along with native platform capabilities to build iOS and Android apps from a single codebase, with the ability to share code between platforms.</p>
<h2 id="table-of-contents-53"><a class="header" href="#table-of-contents-53">Table of Contents</a></h2>
<ul>
<li><a href="mobile_development/react_native.html#introduction">Introduction</a></li>
<li><a href="mobile_development/react_native.html#setup-and-installation">Setup and Installation</a></li>
<li><a href="mobile_development/react_native.html#core-components">Core Components</a></li>
<li><a href="mobile_development/react_native.html#styling">Styling</a></li>
<li><a href="mobile_development/react_native.html#navigation">Navigation</a></li>
<li><a href="mobile_development/react_native.html#state-management">State Management</a></li>
<li><a href="mobile_development/react_native.html#api-and-data-fetching">API and Data Fetching</a></li>
<li><a href="mobile_development/react_native.html#native-modules">Native Modules</a></li>
<li><a href="mobile_development/react_native.html#performance-optimization">Performance Optimization</a></li>
<li><a href="mobile_development/react_native.html#testing">Testing</a></li>
<li><a href="mobile_development/react_native.html#deployment">Deployment</a></li>
</ul>
<hr />
<h2 id="introduction-33"><a class="header" href="#introduction-33">Introduction</a></h2>
<p><strong>Key Features:</strong></p>
<ul>
<li>Cross-platform development (iOS and Android)</li>
<li>Native performance</li>
<li>Hot reloading for fast development</li>
<li>Large ecosystem and community</li>
<li>Code reusability with web React</li>
<li>Native API access</li>
<li>Over-the-air (OTA) updates</li>
</ul>
<p><strong>Use Cases:</strong></p>
<ul>
<li>Cross-platform mobile apps</li>
<li>MVP development</li>
<li>Apps requiring frequent updates</li>
<li>Teams with JavaScript/React expertise</li>
<li>Apps with shared business logic</li>
</ul>
<hr />
<h2 id="setup-and-installation-1"><a class="header" href="#setup-and-installation-1">Setup and Installation</a></h2>
<h3 id="prerequisites-5"><a class="header" href="#prerequisites-5">Prerequisites</a></h3>
<pre><code class="language-bash"># Install Node.js (14+)
node --version
npm --version

# Install Watchman (macOS)
brew install watchman

# Install Xcode (macOS, for iOS development)
# Install Android Studio (for Android development)
</code></pre>
<h3 id="create-new-project-4"><a class="header" href="#create-new-project-4">Create New Project</a></h3>
<pre><code class="language-bash"># Using React Native CLI
npx react-native init MyApp
cd MyApp

# Using Expo (recommended for beginners)
npx create-expo-app MyApp
cd MyApp
npx expo start
</code></pre>
<h3 id="running-the-app"><a class="header" href="#running-the-app">Running the App</a></h3>
<pre><code class="language-bash"># React Native CLI
# iOS
npx react-native run-ios

# Android
npx react-native run-android

# Expo
npx expo start
# Then press 'i' for iOS or 'a' for Android
</code></pre>
<hr />
<h2 id="core-components-4"><a class="header" href="#core-components-4">Core Components</a></h2>
<h3 id="view-and-text"><a class="header" href="#view-and-text">View and Text</a></h3>
<pre><code class="language-javascript">import React from 'react';
import { View, Text, StyleSheet } from 'react-native';

export default function App() {
  return (
    &lt;View style={styles.container}&gt;
      &lt;Text style={styles.title}&gt;Hello React Native!&lt;/Text&gt;
      &lt;Text style={styles.subtitle}&gt;Welcome to mobile development&lt;/Text&gt;
    &lt;/View&gt;
  );
}

const styles = StyleSheet.create({
  container: {
    flex: 1,
    justifyContent: 'center',
    alignItems: 'center',
    backgroundColor: '#fff',
  },
  title: {
    fontSize: 24,
    fontWeight: 'bold',
    marginBottom: 10,
  },
  subtitle: {
    fontSize: 16,
    color: '#666',
  },
});
</code></pre>
<h3 id="button-and-touchableopacity"><a class="header" href="#button-and-touchableopacity">Button and TouchableOpacity</a></h3>
<pre><code class="language-javascript">import { Button, TouchableOpacity, Alert } from 'react-native';

function MyComponent() {
  const handlePress = () =&gt; {
    Alert.alert('Button Pressed', 'You clicked the button!');
  };

  return (
    &lt;View&gt;
      {/* Basic Button */}
      &lt;Button title="Click Me" onPress={handlePress} color="#007AFF" /&gt;

      {/* Custom Touchable */}
      &lt;TouchableOpacity
        style={styles.customButton}
        onPress={handlePress}
        activeOpacity={0.7}
      &gt;
        &lt;Text style={styles.buttonText}&gt;Custom Button&lt;/Text&gt;
      &lt;/TouchableOpacity&gt;
    &lt;/View&gt;
  );
}

const styles = StyleSheet.create({
  customButton: {
    backgroundColor: '#007AFF',
    padding: 15,
    borderRadius: 8,
    alignItems: 'center',
    marginTop: 10,
  },
  buttonText: {
    color: 'white',
    fontSize: 16,
    fontWeight: 'bold',
  },
});
</code></pre>
<h3 id="textinput"><a class="header" href="#textinput">TextInput</a></h3>
<pre><code class="language-javascript">import { useState } from 'react';
import { TextInput } from 'react-native';

function LoginForm() {
  const [email, setEmail] = useState('');
  const [password, setPassword] = useState('');

  return (
    &lt;View style={styles.form}&gt;
      &lt;TextInput
        style={styles.input}
        placeholder="Email"
        value={email}
        onChangeText={setEmail}
        keyboardType="email-address"
        autoCapitalize="none"
        autoCorrect={false}
      /&gt;

      &lt;TextInput
        style={styles.input}
        placeholder="Password"
        value={password}
        onChangeText={setPassword}
        secureTextEntry
        autoCapitalize="none"
      /&gt;

      &lt;Button
        title="Login"
        onPress={() =&gt; handleLogin(email, password)}
      /&gt;
    &lt;/View&gt;
  );
}
</code></pre>
<h3 id="scrollview-and-flatlist"><a class="header" href="#scrollview-and-flatlist">ScrollView and FlatList</a></h3>
<pre><code class="language-javascript">import { ScrollView, FlatList } from 'react-native';

// ScrollView - for small lists
function SimpleList() {
  return (
    &lt;ScrollView&gt;
      {items.map((item) =&gt; (
        &lt;View key={item.id} style={styles.item}&gt;
          &lt;Text&gt;{item.name}&lt;/Text&gt;
        &lt;/View&gt;
      ))}
    &lt;/ScrollView&gt;
  );
}

// FlatList - for large lists (better performance)
function OptimizedList() {
  const DATA = [
    { id: '1', title: 'Item 1' },
    { id: '2', title: 'Item 2' },
    { id: '3', title: 'Item 3' },
  ];

  const renderItem = ({ item }) =&gt; (
    &lt;View style={styles.item}&gt;
      &lt;Text style={styles.title}&gt;{item.title}&lt;/Text&gt;
    &lt;/View&gt;
  );

  return (
    &lt;FlatList
      data={DATA}
      renderItem={renderItem}
      keyExtractor={(item) =&gt; item.id}
      onRefresh={() =&gt; refreshData()}
      refreshing={loading}
    /&gt;
  );
}
</code></pre>
<h3 id="image"><a class="header" href="#image">Image</a></h3>
<pre><code class="language-javascript">import { Image } from 'react-native';

function ImageExample() {
  return (
    &lt;View&gt;
      {/* Local Image */}
      &lt;Image
        source={require('./assets/logo.png')}
        style={{ width: 100, height: 100 }}
        resizeMode="contain"
      /&gt;

      {/* Remote Image */}
      &lt;Image
        source={{ uri: 'https://example.com/image.jpg' }}
        style={{ width: 200, height: 200 }}
        resizeMode="cover"
      /&gt;
    &lt;/View&gt;
  );
}
</code></pre>
<hr />
<h2 id="styling"><a class="header" href="#styling">Styling</a></h2>
<h3 id="stylesheet"><a class="header" href="#stylesheet">StyleSheet</a></h3>
<pre><code class="language-javascript">import { StyleSheet } from 'react-native';

const styles = StyleSheet.create({
  container: {
    flex: 1,
    padding: 20,
    backgroundColor: '#f5f5f5',
  },
  card: {
    backgroundColor: 'white',
    borderRadius: 8,
    padding: 15,
    marginBottom: 10,
    shadowColor: '#000',
    shadowOffset: { width: 0, height: 2 },
    shadowOpacity: 0.1,
    shadowRadius: 4,
    elevation: 3, // Android shadow
  },
  title: {
    fontSize: 18,
    fontWeight: 'bold',
    marginBottom: 5,
  },
});
</code></pre>
<h3 id="flexbox-layout"><a class="header" href="#flexbox-layout">Flexbox Layout</a></h3>
<pre><code class="language-javascript">// Flex Direction
&lt;View style={{ flex: 1, flexDirection: 'row' }}&gt;
  &lt;View style={{ flex: 1, backgroundColor: 'red' }} /&gt;
  &lt;View style={{ flex: 2, backgroundColor: 'blue' }} /&gt;
&lt;/View&gt;

// Justify Content
&lt;View style={{ flex: 1, justifyContent: 'space-between' }}&gt;
  &lt;Text&gt;Top&lt;/Text&gt;
  &lt;Text&gt;Middle&lt;/Text&gt;
  &lt;Text&gt;Bottom&lt;/Text&gt;
&lt;/View&gt;

// Align Items
&lt;View style={{ flex: 1, alignItems: 'center' }}&gt;
  &lt;Text&gt;Centered Horizontally&lt;/Text&gt;
&lt;/View&gt;
</code></pre>
<h3 id="responsive-design"><a class="header" href="#responsive-design">Responsive Design</a></h3>
<pre><code class="language-javascript">import { Dimensions, Platform } from 'react-native';

const { width, height } = Dimensions.get('window');

const styles = StyleSheet.create({
  container: {
    width: width * 0.9, // 90% of screen width
    padding: width &lt; 350 ? 10 : 20, // Conditional padding
  },
  image: {
    width: width - 40,
    height: (width - 40) * 0.6, // Aspect ratio
  },
  platformSpecific: {
    ...Platform.select({
      ios: {
        shadowColor: '#000',
        shadowOffset: { width: 0, height: 2 },
        shadowOpacity: 0.3,
        shadowRadius: 4,
      },
      android: {
        elevation: 5,
      },
    }),
  },
});
</code></pre>
<hr />
<h2 id="navigation-5"><a class="header" href="#navigation-5">Navigation</a></h2>
<h3 id="react-navigation"><a class="header" href="#react-navigation">React Navigation</a></h3>
<pre><code class="language-bash">npm install @react-navigation/native
npm install react-native-screens react-native-safe-area-context
npm install @react-navigation/stack
</code></pre>
<p><strong>Stack Navigator:</strong></p>
<pre><code class="language-javascript">import { NavigationContainer } from '@react-navigation/native';
import { createStackNavigator } from '@react-navigation/stack';

const Stack = createStackNavigator();

function HomeScreen({ navigation }) {
  return (
    &lt;View style={styles.container}&gt;
      &lt;Text&gt;Home Screen&lt;/Text&gt;
      &lt;Button
        title="Go to Details"
        onPress={() =&gt; navigation.navigate('Details', { itemId: 42 })}
      /&gt;
    &lt;/View&gt;
  );
}

function DetailsScreen({ route, navigation }) {
  const { itemId } = route.params;

  return (
    &lt;View style={styles.container}&gt;
      &lt;Text&gt;Details Screen&lt;/Text&gt;
      &lt;Text&gt;Item ID: {itemId}&lt;/Text&gt;
      &lt;Button title="Go Back" onPress={() =&gt; navigation.goBack()} /&gt;
    &lt;/View&gt;
  );
}

export default function App() {
  return (
    &lt;NavigationContainer&gt;
      &lt;Stack.Navigator
        initialRouteName="Home"
        screenOptions={{
          headerStyle: { backgroundColor: '#007AFF' },
          headerTintColor: '#fff',
          headerTitleStyle: { fontWeight: 'bold' },
        }}
      &gt;
        &lt;Stack.Screen
          name="Home"
          component={HomeScreen}
          options={{ title: 'Welcome' }}
        /&gt;
        &lt;Stack.Screen name="Details" component={DetailsScreen} /&gt;
      &lt;/Stack.Navigator&gt;
    &lt;/NavigationContainer&gt;
  );
}
</code></pre>
<p><strong>Tab Navigator:</strong></p>
<pre><code class="language-javascript">import { createBottomTabNavigator } from '@react-navigation/bottom-tabs';
import Ionicons from 'react-native-vector-icons/Ionicons';

const Tab = createBottomTabNavigator();

export default function App() {
  return (
    &lt;NavigationContainer&gt;
      &lt;Tab.Navigator
        screenOptions={({ route }) =&gt; ({
          tabBarIcon: ({ focused, color, size }) =&gt; {
            let iconName;

            if (route.name === 'Home') {
              iconName = focused ? 'home' : 'home-outline';
            } else if (route.name === 'Settings') {
              iconName = focused ? 'settings' : 'settings-outline';
            }

            return &lt;Ionicons name={iconName} size={size} color={color} /&gt;;
          },
          tabBarActiveTintColor: '#007AFF',
          tabBarInactiveTintColor: 'gray',
        })}
      &gt;
        &lt;Tab.Screen name="Home" component={HomeScreen} /&gt;
        &lt;Tab.Screen name="Settings" component={SettingsScreen} /&gt;
      &lt;/Tab.Navigator&gt;
    &lt;/NavigationContainer&gt;
  );
}
</code></pre>
<hr />
<h2 id="state-management-1"><a class="header" href="#state-management-1">State Management</a></h2>
<h3 id="context-api"><a class="header" href="#context-api">Context API</a></h3>
<pre><code class="language-javascript">import React, { createContext, useContext, useState } from 'react';

const AuthContext = createContext();

export function AuthProvider({ children }) {
  const [user, setUser] = useState(null);

  const login = async (email, password) =&gt; {
    // API call
    const response = await fetch('/api/login', {
      method: 'POST',
      body: JSON.stringify({ email, password }),
    });
    const data = await response.json();
    setUser(data.user);
  };

  const logout = () =&gt; {
    setUser(null);
  };

  return (
    &lt;AuthContext.Provider value={{ user, login, logout }}&gt;
      {children}
    &lt;/AuthContext.Provider&gt;
  );
}

export function useAuth() {
  return useContext(AuthContext);
}

// Usage
function ProfileScreen() {
  const { user, logout } = useAuth();

  return (
    &lt;View&gt;
      &lt;Text&gt;Welcome, {user?.name}&lt;/Text&gt;
      &lt;Button title="Logout" onPress={logout} /&gt;
    &lt;/View&gt;
  );
}
</code></pre>
<h3 id="redux-toolkit"><a class="header" href="#redux-toolkit">Redux Toolkit</a></h3>
<pre><code class="language-bash">npm install @reduxjs/toolkit react-redux
</code></pre>
<pre><code class="language-javascript">import { createSlice, configureStore } from '@reduxjs/toolkit';
import { Provider, useSelector, useDispatch } from 'react-redux';

// Slice
const counterSlice = createSlice({
  name: 'counter',
  initialState: { value: 0 },
  reducers: {
    increment: (state) =&gt; {
      state.value += 1;
    },
    decrement: (state) =&gt; {
      state.value -= 1;
    },
  },
});

export const { increment, decrement } = counterSlice.actions;

// Store
const store = configureStore({
  reducer: {
    counter: counterSlice.reducer,
  },
});

// Component
function Counter() {
  const count = useSelector((state) =&gt; state.counter.value);
  const dispatch = useDispatch();

  return (
    &lt;View&gt;
      &lt;Text&gt;{count}&lt;/Text&gt;
      &lt;Button title="+" onPress={() =&gt; dispatch(increment())} /&gt;
      &lt;Button title="-" onPress={() =&gt; dispatch(decrement())} /&gt;
    &lt;/View&gt;
  );
}

// App
export default function App() {
  return (
    &lt;Provider store={store}&gt;
      &lt;Counter /&gt;
    &lt;/Provider&gt;
  );
}
</code></pre>
<hr />
<h2 id="api-and-data-fetching"><a class="header" href="#api-and-data-fetching">API and Data Fetching</a></h2>
<h3 id="fetch-api"><a class="header" href="#fetch-api">Fetch API</a></h3>
<pre><code class="language-javascript">import { useState, useEffect } from 'react';

function UserProfile({ userId }) {
  const [user, setUser] = useState(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);

  useEffect(() =&gt; {
    fetchUser();
  }, [userId]);

  const fetchUser = async () =&gt; {
    try {
      setLoading(true);
      const response = await fetch(`https://api.example.com/users/${userId}`);

      if (!response.ok) {
        throw new Error('Failed to fetch user');
      }

      const data = await response.json();
      setUser(data);
    } catch (err) {
      setError(err.message);
    } finally {
      setLoading(false);
    }
  };

  if (loading) return &lt;Text&gt;Loading...&lt;/Text&gt;;
  if (error) return &lt;Text&gt;Error: {error}&lt;/Text&gt;;

  return (
    &lt;View&gt;
      &lt;Text&gt;{user.name}&lt;/Text&gt;
      &lt;Text&gt;{user.email}&lt;/Text&gt;
    &lt;/View&gt;
  );
}
</code></pre>
<h3 id="axios"><a class="header" href="#axios">Axios</a></h3>
<pre><code class="language-bash">npm install axios
</code></pre>
<pre><code class="language-javascript">import axios from 'axios';

const api = axios.create({
  baseURL: 'https://api.example.com',
  timeout: 10000,
  headers: {
    'Content-Type': 'application/json',
  },
});

// Interceptors
api.interceptors.request.use(
  (config) =&gt; {
    const token = getToken();
    if (token) {
      config.headers.Authorization = `Bearer ${token}`;
    }
    return config;
  },
  (error) =&gt; Promise.reject(error)
);

api.interceptors.response.use(
  (response) =&gt; response,
  (error) =&gt; {
    if (error.response?.status === 401) {
      // Handle unauthorized
      logout();
    }
    return Promise.reject(error);
  }
);

// Usage
const fetchUsers = async () =&gt; {
  const response = await api.get('/users');
  return response.data;
};

const createUser = async (userData) =&gt; {
  const response = await api.post('/users', userData);
  return response.data;
};
</code></pre>
<hr />
<h2 id="native-modules"><a class="header" href="#native-modules">Native Modules</a></h2>
<h3 id="accessing-device-features"><a class="header" href="#accessing-device-features">Accessing Device Features</a></h3>
<pre><code class="language-javascript">// Camera
import { Camera } from 'expo-camera';

function CameraScreen() {
  const [hasPermission, setHasPermission] = useState(null);

  useEffect(() =&gt; {
    (async () =&gt; {
      const { status } = await Camera.requestCameraPermissionsAsync();
      setHasPermission(status === 'granted');
    })();
  }, []);

  if (hasPermission === null) {
    return &lt;View /&gt;;
  }

  return (
    &lt;Camera style={{ flex: 1 }} type={Camera.Constants.Type.back}&gt;
      {/* Camera UI */}
    &lt;/Camera&gt;
  );
}

// Location
import * as Location from 'expo-location';

const getLocation = async () =&gt; {
  const { status } = await Location.requestForegroundPermissionsAsync();

  if (status !== 'granted') {
    return;
  }

  const location = await Location.getCurrentPositionAsync({});
  console.log(location.coords);
};

// Notifications
import * as Notifications from 'expo-notifications';

const sendNotification = async () =&gt; {
  await Notifications.scheduleNotificationAsync({
    content: {
      title: "You've got mail!",
      body: 'Here is the notification body',
    },
    trigger: { seconds: 2 },
  });
};
</code></pre>
<hr />
<h2 id="performance-optimization-9"><a class="header" href="#performance-optimization-9">Performance Optimization</a></h2>
<h3 id="memoization"><a class="header" href="#memoization">Memoization</a></h3>
<pre><code class="language-javascript">import React, { useMemo, useCallback } from 'react';

function ExpensiveComponent({ data }) {
  // Memoize expensive calculations
  const processedData = useMemo(() =&gt; {
    return data.map((item) =&gt; {
      // Expensive operation
      return processItem(item);
    });
  }, [data]);

  // Memoize callbacks
  const handlePress = useCallback(() =&gt; {
    console.log('Button pressed');
  }, []);

  return (
    &lt;View&gt;
      {processedData.map((item) =&gt; (
        &lt;Item key={item.id} data={item} onPress={handlePress} /&gt;
      ))}
    &lt;/View&gt;
  );
}

// Memo component
const Item = React.memo(({ data, onPress }) =&gt; {
  return (
    &lt;TouchableOpacity onPress={onPress}&gt;
      &lt;Text&gt;{data.name}&lt;/Text&gt;
    &lt;/TouchableOpacity&gt;
  );
});
</code></pre>
<h3 id="flatlist-optimization"><a class="header" href="#flatlist-optimization">FlatList Optimization</a></h3>
<pre><code class="language-javascript">&lt;FlatList
  data={data}
  renderItem={renderItem}
  keyExtractor={(item) =&gt; item.id}
  // Performance optimizations
  removeClippedSubviews={true}
  maxToRenderPerBatch={10}
  updateCellsBatchingPeriod={50}
  initialNumToRender={10}
  windowSize={10}
  getItemLayout={(data, index) =&gt; ({
    length: ITEM_HEIGHT,
    offset: ITEM_HEIGHT * index,
    index,
  })}
/&gt;
</code></pre>
<hr />
<h2 id="testing-12"><a class="header" href="#testing-12">Testing</a></h2>
<h3 id="jest-and-react-native-testing-library"><a class="header" href="#jest-and-react-native-testing-library">Jest and React Native Testing Library</a></h3>
<pre><code class="language-bash">npm install --save-dev @testing-library/react-native
</code></pre>
<pre><code class="language-javascript">import { render, fireEvent } from '@testing-library/react-native';
import Counter from './Counter';

describe('Counter', () =&gt; {
  it('renders correctly', () =&gt; {
    const { getByText } = render(&lt;Counter /&gt;);
    expect(getByText('Count: 0')).toBeTruthy();
  });

  it('increments counter', () =&gt; {
    const { getByText, getByTestId } = render(&lt;Counter /&gt;);
    const button = getByTestId('increment-button');

    fireEvent.press(button);

    expect(getByText('Count: 1')).toBeTruthy();
  });
});
</code></pre>
<hr />
<h2 id="deployment-3"><a class="header" href="#deployment-3">Deployment</a></h2>
<h3 id="ios"><a class="header" href="#ios">iOS</a></h3>
<pre><code class="language-bash"># Build for release
npx react-native run-ios --configuration Release

# Or with Xcode
# Open ios/YourApp.xcworkspace
# Select Generic iOS Device
# Product &gt; Archive
# Upload to App Store
</code></pre>
<h3 id="android"><a class="header" href="#android">Android</a></h3>
<pre><code class="language-bash"># Generate release APK
cd android
./gradlew assembleRelease

# APK location:
# android/app/build/outputs/apk/release/app-release.apk

# Generate AAB (App Bundle)
./gradlew bundleRelease
</code></pre>
<hr />
<h2 id="resources-47"><a class="header" href="#resources-47">Resources</a></h2>
<p><strong>Official Documentation:</strong></p>
<ul>
<li><a href="https://reactnative.dev/">React Native Docs</a></li>
<li><a href="https://docs.expo.dev/">Expo Documentation</a></li>
<li><a href="https://reactnavigation.org/">React Navigation</a></li>
</ul>
<p><strong>Learning:</strong></p>
<ul>
<li><a href="https://www.reactnative.express/">React Native Express</a></li>
<li><a href="https://www.reactnativeschool.com/">React Native School</a></li>
</ul>
<p><strong>Tools:</strong></p>
<ul>
<li><a href="https://github.com/jhen0409/react-native-debugger">React Native Debugger</a></li>
<li><a href="https://fbflipper.com/">Flipper</a></li>
<li><a href="https://github.com/infinitered/reactotron">Reactotron</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="flutter"><a class="header" href="#flutter">Flutter</a></h1>
<p>Flutter is Google's UI toolkit for building natively compiled applications for mobile, web, and desktop from a single codebase. It uses the Dart programming language and provides a rich set of pre-designed widgets for creating beautiful, high-performance applications.</p>
<h2 id="table-of-contents-54"><a class="header" href="#table-of-contents-54">Table of Contents</a></h2>
<ul>
<li><a href="mobile_development/flutter.html#introduction">Introduction</a></li>
<li><a href="mobile_development/flutter.html#setup-and-installation">Setup and Installation</a></li>
<li><a href="mobile_development/flutter.html#dart-basics">Dart Basics</a></li>
<li><a href="mobile_development/flutter.html#widgets">Widgets</a></li>
<li><a href="mobile_development/flutter.html#layouts">Layouts</a></li>
<li><a href="mobile_development/flutter.html#state-management">State Management</a></li>
<li><a href="mobile_development/flutter.html#navigation-and-routing">Navigation and Routing</a></li>
<li><a href="mobile_development/flutter.html#networking">Networking</a></li>
<li><a href="mobile_development/flutter.html#local-storage">Local Storage</a></li>
<li><a href="mobile_development/flutter.html#testing">Testing</a></li>
<li><a href="mobile_development/flutter.html#deployment">Deployment</a></li>
</ul>
<hr />
<h2 id="introduction-34"><a class="header" href="#introduction-34">Introduction</a></h2>
<p><strong>Key Features:</strong></p>
<ul>
<li>Single codebase for iOS, Android, web, and desktop</li>
<li>Fast development with hot reload</li>
<li>Beautiful, customizable widgets</li>
<li>Native performance</li>
<li>Rich animation support</li>
<li>Strong typing with Dart</li>
<li>Extensive package ecosystem</li>
</ul>
<p><strong>Use Cases:</strong></p>
<ul>
<li>Cross-platform mobile apps</li>
<li>Material Design and Cupertino (iOS-style) apps</li>
<li>High-performance UIs</li>
<li>Apps with complex animations</li>
<li>MVPs and startups</li>
<li>Enterprise applications</li>
</ul>
<hr />
<h2 id="setup-and-installation-2"><a class="header" href="#setup-and-installation-2">Setup and Installation</a></h2>
<h3 id="install-flutter"><a class="header" href="#install-flutter">Install Flutter</a></h3>
<p><strong>macOS:</strong></p>
<pre><code class="language-bash"># Download Flutter SDK
# https://flutter.dev/docs/get-started/install/macos

# Add to PATH
export PATH="$PATH:`pwd`/flutter/bin"

# Run doctor
flutter doctor

# Install Xcode
# Install Android Studio
</code></pre>
<p><strong>Windows:</strong></p>
<pre><code class="language-bash"># Download Flutter SDK
# https://flutter.dev/docs/get-started/install/windows

# Add to PATH
# Run flutter doctor
</code></pre>
<h3 id="create-new-project-5"><a class="header" href="#create-new-project-5">Create New Project</a></h3>
<pre><code class="language-bash"># Create project
flutter create my_app
cd my_app

# Run on iOS
flutter run -d ios

# Run on Android
flutter run -d android

# Run on web
flutter run -d chrome
</code></pre>
<h3 id="project-structure-9"><a class="header" href="#project-structure-9">Project Structure</a></h3>
<pre><code>my_app/
├── android/          # Android-specific code
├── ios/              # iOS-specific code
├── lib/              # Dart source code
│   ├── main.dart    # Entry point
│   ├── screens/     # Screen widgets
│   ├── widgets/     # Reusable widgets
│   ├── models/      # Data models
│   ├── services/    # API services
│   └── utils/       # Utilities
├── test/            # Tests
├── pubspec.yaml     # Dependencies
└── README.md
</code></pre>
<hr />
<h2 id="dart-basics"><a class="header" href="#dart-basics">Dart Basics</a></h2>
<h3 id="variables-and-types"><a class="header" href="#variables-and-types">Variables and Types</a></h3>
<pre><code class="language-dart">// Variables
var name = 'John';
String city = 'New York';
int age = 30;
double height = 5.9;
bool isActive = true;

// Final and const
final String country = 'USA';        // Runtime constant
const double pi = 3.14159;           // Compile-time constant

// Null safety
String? nullableName;                // Can be null
String nonNullName = 'John';         // Cannot be null

// Late initialization
late String description;
</code></pre>
<h3 id="functions-10"><a class="header" href="#functions-10">Functions</a></h3>
<pre><code class="language-dart">// Basic function
String greet(String name) {
  return 'Hello, $name!';
}

// Arrow function
String greet(String name) =&gt; 'Hello, $name!';

// Optional parameters
String greet(String name, [String? title]) {
  return title != null ? 'Hello, $title $name!' : 'Hello, $name!';
}

// Named parameters
String greet({required String name, String title = 'Mr.'}) {
  return 'Hello, $title $name!';
}

// Async function
Future&lt;String&gt; fetchData() async {
  await Future.delayed(Duration(seconds: 2));
  return 'Data loaded';
}
</code></pre>
<h3 id="classes-1"><a class="header" href="#classes-1">Classes</a></h3>
<pre><code class="language-dart">class User {
  String name;
  int age;

  // Constructor
  User(this.name, this.age);

  // Named constructor
  User.guest() : name = 'Guest', age = 0;

  // Method
  String introduce() {
    return 'I am $name, $age years old';
  }

  // Getter
  bool get isAdult =&gt; age &gt;= 18;

  // Setter
  set updateAge(int newAge) {
    if (newAge &gt; 0) age = newAge;
  }
}

// Usage
var user = User('John', 30);
print(user.introduce());
print(user.isAdult);
</code></pre>
<h3 id="lists-and-maps"><a class="header" href="#lists-and-maps">Lists and Maps</a></h3>
<pre><code class="language-dart">// Lists
List&lt;String&gt; names = ['John', 'Jane', 'Bob'];
names.add('Alice');
names.remove('Bob');

// Maps
Map&lt;String, int&gt; ages = {
  'John': 30,
  'Jane': 28,
};
ages['Bob'] = 35;

// Iteration
names.forEach((name) =&gt; print(name));
ages.forEach((key, value) =&gt; print('$key: $value'));
</code></pre>
<hr />
<h2 id="widgets"><a class="header" href="#widgets">Widgets</a></h2>
<h3 id="stateless-widget"><a class="header" href="#stateless-widget">Stateless Widget</a></h3>
<pre><code class="language-dart">import 'package:flutter/material.dart';

class WelcomeScreen extends StatelessWidget {
  final String title;

  const WelcomeScreen({Key? key, required this.title}) : super(key: key);

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text(title),
      ),
      body: Center(
        child: Text(
          'Welcome to Flutter!',
          style: TextStyle(fontSize: 24),
        ),
      ),
    );
  }
}
</code></pre>
<h3 id="stateful-widget"><a class="header" href="#stateful-widget">Stateful Widget</a></h3>
<pre><code class="language-dart">class CounterScreen extends StatefulWidget {
  @override
  _CounterScreenState createState() =&gt; _CounterScreenState();
}

class _CounterScreenState extends State&lt;CounterScreen&gt; {
  int _counter = 0;

  void _incrementCounter() {
    setState(() {
      _counter++;
    });
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text('Counter'),
      ),
      body: Center(
        child: Column(
          mainAxisAlignment: MainAxisAlignment.center,
          children: [
            Text('Count:'),
            Text(
              '$_counter',
              style: TextStyle(fontSize: 48, fontWeight: FontWeight.bold),
            ),
          ],
        ),
      ),
      floatingActionButton: FloatingActionButton(
        onPressed: _incrementCounter,
        child: Icon(Icons.add),
      ),
    );
  }
}
</code></pre>
<h3 id="common-widgets"><a class="header" href="#common-widgets">Common Widgets</a></h3>
<pre><code class="language-dart">// Text
Text(
  'Hello Flutter',
  style: TextStyle(
    fontSize: 24,
    fontWeight: FontWeight.bold,
    color: Colors.blue,
  ),
)

// Image
Image.network('https://example.com/image.jpg')
Image.asset('assets/logo.png')

// Button
ElevatedButton(
  onPressed: () {
    print('Button pressed');
  },
  child: Text('Click Me'),
)

// TextField
TextField(
  decoration: InputDecoration(
    labelText: 'Email',
    hintText: 'Enter your email',
    border: OutlineInputBorder(),
  ),
  onChanged: (value) {
    print(value);
  },
)

// Container
Container(
  width: 200,
  height: 100,
  padding: EdgeInsets.all(16),
  margin: EdgeInsets.all(8),
  decoration: BoxDecoration(
    color: Colors.blue,
    borderRadius: BorderRadius.circular(12),
    boxShadow: [
      BoxShadow(
        color: Colors.grey.withOpacity(0.5),
        spreadRadius: 2,
        blurRadius: 5,
        offset: Offset(0, 3),
      ),
    ],
  ),
  child: Text('Styled Container'),
)
</code></pre>
<hr />
<h2 id="layouts-1"><a class="header" href="#layouts-1">Layouts</a></h2>
<h3 id="column-and-row"><a class="header" href="#column-and-row">Column and Row</a></h3>
<pre><code class="language-dart">Column(
  mainAxisAlignment: MainAxisAlignment.center,
  crossAxisAlignment: CrossAxisAlignment.start,
  children: [
    Text('First'),
    Text('Second'),
    Text('Third'),
  ],
)

Row(
  mainAxisAlignment: MainAxisAlignment.spaceEvenly,
  children: [
    Icon(Icons.star),
    Icon(Icons.favorite),
    Icon(Icons.thumb_up),
  ],
)
</code></pre>
<h3 id="stack"><a class="header" href="#stack">Stack</a></h3>
<pre><code class="language-dart">Stack(
  children: [
    Container(
      width: 200,
      height: 200,
      color: Colors.blue,
    ),
    Positioned(
      top: 20,
      left: 20,
      child: Text('Overlayed Text'),
    ),
  ],
)
</code></pre>
<h3 id="listview"><a class="header" href="#listview">ListView</a></h3>
<pre><code class="language-dart">// Simple ListView
ListView(
  children: [
    ListTile(
      leading: Icon(Icons.person),
      title: Text('John Doe'),
      subtitle: Text('john@example.com'),
      trailing: Icon(Icons.arrow_forward),
      onTap: () {
        print('Tapped');
      },
    ),
    ListTile(
      leading: Icon(Icons.person),
      title: Text('Jane Smith'),
    ),
  ],
)

// ListView.builder (for large lists)
ListView.builder(
  itemCount: items.length,
  itemBuilder: (context, index) {
    return ListTile(
      title: Text(items[index].name),
    );
  },
)

// ListView.separated
ListView.separated(
  itemCount: items.length,
  itemBuilder: (context, index) =&gt; ListTile(
    title: Text(items[index]),
  ),
  separatorBuilder: (context, index) =&gt; Divider(),
)
</code></pre>
<h3 id="gridview"><a class="header" href="#gridview">GridView</a></h3>
<pre><code class="language-dart">GridView.count(
  crossAxisCount: 2,
  children: List.generate(20, (index) {
    return Card(
      child: Center(
        child: Text('Item $index'),
      ),
    );
  }),
)

GridView.builder(
  gridDelegate: SliverGridDelegateWithFixedCrossAxisCount(
    crossAxisCount: 3,
    crossAxisSpacing: 10,
    mainAxisSpacing: 10,
  ),
  itemCount: items.length,
  itemBuilder: (context, index) {
    return Card(
      child: Image.network(items[index].imageUrl),
    );
  },
)
</code></pre>
<hr />
<h2 id="state-management-2"><a class="header" href="#state-management-2">State Management</a></h2>
<h3 id="provider"><a class="header" href="#provider">Provider</a></h3>
<pre><code class="language-yaml"># pubspec.yaml
dependencies:
  provider: ^6.0.0
</code></pre>
<pre><code class="language-dart">import 'package:provider/provider.dart';

// Model
class Counter with ChangeNotifier {
  int _count = 0;

  int get count =&gt; _count;

  void increment() {
    _count++;
    notifyListeners();
  }

  void decrement() {
    _count--;
    notifyListeners();
  }
}

// Main app
void main() {
  runApp(
    ChangeNotifierProvider(
      create: (context) =&gt; Counter(),
      child: MyApp(),
    ),
  );
}

// Consumer widget
class CounterScreen extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: Text('Counter')),
      body: Center(
        child: Consumer&lt;Counter&gt;(
          builder: (context, counter, child) {
            return Text(
              '${counter.count}',
              style: TextStyle(fontSize: 48),
            );
          },
        ),
      ),
      floatingActionButton: FloatingActionButton(
        onPressed: () {
          context.read&lt;Counter&gt;().increment();
        },
        child: Icon(Icons.add),
      ),
    );
  }
}
</code></pre>
<h3 id="riverpod"><a class="header" href="#riverpod">Riverpod</a></h3>
<pre><code class="language-yaml">dependencies:
  flutter_riverpod: ^2.0.0
</code></pre>
<pre><code class="language-dart">import 'package:flutter_riverpod/flutter_riverpod.dart';

// Provider
final counterProvider = StateProvider&lt;int&gt;((ref) =&gt; 0);

// Main app
void main() {
  runApp(
    ProviderScope(
      child: MyApp(),
    ),
  );
}

// Consumer widget
class CounterScreen extends ConsumerWidget {
  @override
  Widget build(BuildContext context, WidgetRef ref) {
    final counter = ref.watch(counterProvider);

    return Scaffold(
      body: Center(
        child: Text('$counter'),
      ),
      floatingActionButton: FloatingActionButton(
        onPress: () {
          ref.read(counterProvider.notifier).state++;
        },
        child: Icon(Icons.add),
      ),
    );
  }
}
</code></pre>
<hr />
<h2 id="navigation-and-routing"><a class="header" href="#navigation-and-routing">Navigation and Routing</a></h2>
<h3 id="basic-navigation"><a class="header" href="#basic-navigation">Basic Navigation</a></h3>
<pre><code class="language-dart">// Navigate to new screen
Navigator.push(
  context,
  MaterialPageRoute(builder: (context) =&gt; SecondScreen()),
);

// Navigate back
Navigator.pop(context);

// Navigate with data
Navigator.push(
  context,
  MaterialPageRoute(
    builder: (context) =&gt; DetailScreen(id: 123),
  ),
);

// Return data
final result = await Navigator.push(
  context,
  MaterialPageRoute(builder: (context) =&gt; SecondScreen()),
);
</code></pre>
<h3 id="named-routes"><a class="header" href="#named-routes">Named Routes</a></h3>
<pre><code class="language-dart">// Define routes
MaterialApp(
  initialRoute: '/',
  routes: {
    '/': (context) =&gt; HomeScreen(),
    '/details': (context) =&gt; DetailsScreen(),
    '/profile': (context) =&gt; ProfileScreen(),
  },
)

// Navigate
Navigator.pushNamed(context, '/details');

// With arguments
Navigator.pushNamed(
  context,
  '/details',
  arguments: {'id': 123},
);

// Extract arguments
class DetailsScreen extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    final args = ModalRoute.of(context)!.settings.arguments as Map;
    final id = args['id'];

    return Scaffold(
      appBar: AppBar(title: Text('Details $id')),
    );
  }
}
</code></pre>
<hr />
<h2 id="networking-5"><a class="header" href="#networking-5">Networking</a></h2>
<h3 id="http-package"><a class="header" href="#http-package">HTTP Package</a></h3>
<pre><code class="language-yaml">dependencies:
  http: ^0.13.0
</code></pre>
<pre><code class="language-dart">import 'package:http/http.dart' as http;
import 'dart:convert';

// GET request
Future&lt;List&lt;User&gt;&gt; fetchUsers() async {
  final response = await http.get(
    Uri.parse('https://api.example.com/users'),
  );

  if (response.statusCode == 200) {
    List&lt;dynamic&gt; data = jsonDecode(response.body);
    return data.map((json) =&gt; User.fromJson(json)).toList();
  } else {
    throw Exception('Failed to load users');
  }
}

// POST request
Future&lt;User&gt; createUser(String name, String email) async {
  final response = await http.post(
    Uri.parse('https://api.example.com/users'),
    headers: {'Content-Type': 'application/json'},
    body: jsonEncode({
      'name': name,
      'email': email,
    }),
  );

  if (response.statusCode == 201) {
    return User.fromJson(jsonDecode(response.body));
  } else {
    throw Exception('Failed to create user');
  }
}

// FutureBuilder
class UsersList extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return FutureBuilder&lt;List&lt;User&gt;&gt;(
      future: fetchUsers(),
      builder: (context, snapshot) {
        if (snapshot.connectionState == ConnectionState.waiting) {
          return CircularProgressIndicator();
        } else if (snapshot.hasError) {
          return Text('Error: ${snapshot.error}');
        } else if (snapshot.hasData) {
          return ListView.builder(
            itemCount: snapshot.data!.length,
            itemBuilder: (context, index) {
              return ListTile(
                title: Text(snapshot.data![index].name),
              );
            },
          );
        } else {
          return Text('No data');
        }
      },
    );
  }
}
</code></pre>
<hr />
<h2 id="local-storage"><a class="header" href="#local-storage">Local Storage</a></h2>
<h3 id="shared-preferences"><a class="header" href="#shared-preferences">Shared Preferences</a></h3>
<pre><code class="language-yaml">dependencies:
  shared_preferences: ^2.0.0
</code></pre>
<pre><code class="language-dart">import 'package:shared_preferences/shared_preferences.dart';

// Save data
Future&lt;void&gt; saveData() async {
  final prefs = await SharedPreferences.getInstance();
  await prefs.setString('username', 'John');
  await prefs.setInt('age', 30);
  await prefs.setBool('isLoggedIn', true);
}

// Read data
Future&lt;String?&gt; readData() async {
  final prefs = await SharedPreferences.getInstance();
  return prefs.getString('username');
}

// Remove data
Future&lt;void&gt; removeData() async {
  final prefs = await SharedPreferences.getInstance();
  await prefs.remove('username');
}
</code></pre>
<h3 id="sqlite-1"><a class="header" href="#sqlite-1">SQLite</a></h3>
<pre><code class="language-yaml">dependencies:
  sqflite: ^2.0.0
  path: ^1.8.0
</code></pre>
<pre><code class="language-dart">import 'package:sqflite/sqflite.dart';
import 'package:path/path.dart';

class DatabaseHelper {
  static final DatabaseHelper instance = DatabaseHelper._init();
  static Database? _database;

  DatabaseHelper._init();

  Future&lt;Database&gt; get database async {
    if (_database != null) return _database!;
    _database = await _initDB('users.db');
    return _database!;
  }

  Future&lt;Database&gt; _initDB(String filePath) async {
    final dbPath = await getDatabasesPath();
    final path = join(dbPath, filePath);

    return await openDatabase(
      path,
      version: 1,
      onCreate: _createDB,
    );
  }

  Future _createDB(Database db, int version) async {
    await db.execute('''
      CREATE TABLE users (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        name TEXT NOT NULL,
        email TEXT NOT NULL
      )
    ''');
  }

  Future&lt;int&gt; insert(Map&lt;String, dynamic&gt; row) async {
    final db = await database;
    return await db.insert('users', row);
  }

  Future&lt;List&lt;Map&lt;String, dynamic&gt;&gt;&gt; queryAll() async {
    final db = await database;
    return await db.query('users');
  }

  Future&lt;int&gt; update(Map&lt;String, dynamic&gt; row) async {
    final db = await database;
    int id = row['id'];
    return await db.update('users', row, where: 'id = ?', whereArgs: [id]);
  }

  Future&lt;int&gt; delete(int id) async {
    final db = await database;
    return await db.delete('users', where: 'id = ?', whereArgs: [id]);
  }
}
</code></pre>
<hr />
<h2 id="testing-13"><a class="header" href="#testing-13">Testing</a></h2>
<h3 id="unit-tests-2"><a class="header" href="#unit-tests-2">Unit Tests</a></h3>
<pre><code class="language-dart">// test/counter_test.dart
import 'package:flutter_test/flutter_test.dart';
import 'package:my_app/counter.dart';

void main() {
  test('Counter increments', () {
    final counter = Counter();
    counter.increment();
    expect(counter.count, 1);
  });

  test('Counter decrements', () {
    final counter = Counter();
    counter.decrement();
    expect(counter.count, -1);
  });
}
</code></pre>
<h3 id="widget-tests"><a class="header" href="#widget-tests">Widget Tests</a></h3>
<pre><code class="language-dart">import 'package:flutter/material.dart';
import 'package:flutter_test/flutter_test.dart';
import 'package:my_app/main.dart';

void main() {
  testWidgets('Counter increments smoke test', (WidgetTester tester) async {
    // Build the widget
    await tester.pumpWidget(MyApp());

    // Verify initial state
    expect(find.text('0'), findsOneWidget);
    expect(find.text('1'), findsNothing);

    // Tap the '+' icon and trigger a frame
    await tester.tap(find.byIcon(Icons.add));
    await tester.pump();

    // Verify counter incremented
    expect(find.text('0'), findsNothing);
    expect(find.text('1'), findsOneWidget);
  });
}
</code></pre>
<hr />
<h2 id="deployment-4"><a class="header" href="#deployment-4">Deployment</a></h2>
<h3 id="android-1"><a class="header" href="#android-1">Android</a></h3>
<pre><code class="language-bash"># Build APK
flutter build apk --release

# Build App Bundle (recommended)
flutter build appbundle --release

# Split APKs by ABI
flutter build apk --split-per-abi
</code></pre>
<h3 id="ios-1"><a class="header" href="#ios-1">iOS</a></h3>
<pre><code class="language-bash"># Build for iOS
flutter build ios --release

# Or use Xcode
# Open ios/Runner.xcworkspace
# Product &gt; Archive
# Upload to App Store
</code></pre>
<h3 id="configuration-7"><a class="header" href="#configuration-7">Configuration</a></h3>
<p><strong>android/app/build.gradle:</strong></p>
<pre><code class="language-gradle">android {
    defaultConfig {
        applicationId "com.example.myapp"
        minSdkVersion 21
        targetSdkVersion 33
        versionCode 1
        versionName "1.0.0"
    }

    signingConfigs {
        release {
            storeFile file("upload-keystore.jks")
            storePassword System.getenv("KEYSTORE_PASSWORD")
            keyAlias "upload"
            keyPassword System.getenv("KEY_PASSWORD")
        }
    }
}
</code></pre>
<p><strong>ios/Runner/Info.plist:</strong></p>
<pre><code class="language-xml">&lt;key&gt;CFBundleDisplayName&lt;/key&gt;
&lt;string&gt;My App&lt;/string&gt;
&lt;key&gt;CFBundleVersion&lt;/key&gt;
&lt;string&gt;1&lt;/string&gt;
&lt;key&gt;CFBundleShortVersionString&lt;/key&gt;
&lt;string&gt;1.0.0&lt;/string&gt;
</code></pre>
<hr />
<h2 id="resources-48"><a class="header" href="#resources-48">Resources</a></h2>
<p><strong>Official Documentation:</strong></p>
<ul>
<li><a href="https://flutter.dev/docs">Flutter Documentation</a></li>
<li><a href="https://dart.dev/guides">Dart Documentation</a></li>
<li><a href="https://flutter.dev/docs/cookbook">Flutter Cookbook</a></li>
</ul>
<p><strong>Packages:</strong></p>
<ul>
<li><a href="https://pub.dev/">pub.dev</a> - Official package repository</li>
<li><a href="https://flutterawesome.com/">Flutter Awesome</a> - Curated packages</li>
</ul>
<p><strong>Learning:</strong></p>
<ul>
<li><a href="https://flutter.dev/docs/codelabs">Flutter Codelabs</a></li>
<li><a href="https://www.youtube.com/playlist?list=PLjxrf2q8roU23XGwz3Km7sQZFTdB996iG">Flutter Widget of the Week</a></li>
<li><a href="https://flutter.dev/community">Flutter Community</a></li>
</ul>
<p><strong>Tools:</strong></p>
<ul>
<li><a href="https://flutter.dev/docs/development/tools/devtools/overview">Flutter DevTools</a></li>
<li><a href="https://dartpad.dev/">DartPad</a> - Online IDE</li>
<li><a href="https://firebase.flutter.dev/">FlutterFire</a> - Firebase integration</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="testing--quality"><a class="header" href="#testing--quality">Testing &amp; Quality</a></h1>
<p>Testing strategies, frameworks, and best practices for ensuring code quality and reliability.</p>
<h2 id="topics-covered-5"><a class="header" href="#topics-covered-5">Topics Covered</a></h2>
<ul>
<li><strong><a href="testing/unit_testing.html">Unit Testing</a></strong>: Testing individual functions and classes in isolation</li>
<li><strong><a href="testing/integration.html">Integration Testing</a></strong>: Testing component interactions and APIs</li>
<li><strong><a href="testing/pytest.html">pytest</a></strong>: Python testing framework with fixtures and parametrization</li>
<li><strong><a href="testing/tdd.html">TDD</a></strong>: Test-driven development approaches and best practices</li>
<li><strong>Test Frameworks</strong>: pytest, Jest, unittest</li>
<li><strong>Mocking</strong>: Isolating code under test</li>
<li><strong>Coverage</strong>: Measuring test completeness</li>
<li><strong>Debugging</strong>: Finding and fixing issues</li>
<li><strong>Code Quality</strong>: Linting, formatting, static analysis</li>
<li><strong>Performance Testing</strong>: Load and stress testing</li>
</ul>
<h2 id="testing-pyramid"><a class="header" href="#testing-pyramid">Testing Pyramid</a></h2>
<pre><code>       E2E Tests (few)
      Integration Tests (more)
    Unit Tests (many)
</code></pre>
<p>Ratio: 70% unit, 20% integration, 10% e2e</p>
<h2 id="test-types"><a class="header" href="#test-types">Test Types</a></h2>
<ul>
<li><strong>Unit</strong>: Individual functions/classes</li>
<li><strong>Integration</strong>: Multiple components together</li>
<li><strong>End-to-End</strong>: Full user workflows</li>
<li><strong>Performance</strong>: Load and speed</li>
<li><strong>Security</strong>: Vulnerability detection</li>
</ul>
<h2 id="best-practices-91"><a class="header" href="#best-practices-91">Best Practices</a></h2>
<ol>
<li><strong>Fast</strong>: Tests run quickly</li>
<li><strong>Independent</strong>: No dependencies between tests</li>
<li><strong>Repeatable</strong>: Consistent results</li>
<li><strong>Self-checking</strong>: Pass/fail obvious</li>
<li><strong>Timely</strong>: Written with code</li>
</ol>
<h2 id="navigation-6"><a class="header" href="#navigation-6">Navigation</a></h2>
<p>Learn strategies to build reliable, quality software.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="unit-testing-1"><a class="header" href="#unit-testing-1">Unit Testing</a></h1>
<h2 id="overview-106"><a class="header" href="#overview-106">Overview</a></h2>
<p>Unit testing verifies individual functions or classes work correctly in isolation.</p>
<h2 id="python---pytest"><a class="header" href="#python---pytest">Python - pytest</a></h2>
<pre><code class="language-python"># test_calculator.py
import pytest
from calculator import add, divide

def test_add():
    assert add(2, 3) == 5
    assert add(-1, 1) == 0

def test_add_floats():
    assert add(0.1, 0.2) == pytest.approx(0.3)

def test_divide_by_zero():
    with pytest.raises(ValueError):
        divide(10, 0)

@pytest.fixture
def calculator():
    """Setup fixture"""
    return Calculator()

def test_with_fixture(calculator):
    assert calculator.add(2, 3) == 5

@pytest.mark.parametrize("x,y,expected", [
    (2, 3, 5),
    (0, 0, 0),
    (-1, 1, 0),
])
def test_add_multiple(x, y, expected):
    assert add(x, y) == expected
</code></pre>
<h2 id="javascript---jest"><a class="header" href="#javascript---jest">JavaScript - Jest</a></h2>
<pre><code class="language-javascript">// calculator.test.js
describe('Calculator', () =&gt; {
  test('add function', () =&gt; {
    expect(add(2, 3)).toBe(5);
  });

  test('divide by zero throws error', () =&gt; {
    expect(() =&gt; divide(10, 0)).toThrow();
  });

  test('floating point', () =&gt; {
    expect(add(0.1, 0.2)).toBeCloseTo(0.3);
  });
});
</code></pre>
<h2 id="java---junit"><a class="header" href="#java---junit">Java - JUnit</a></h2>
<pre><code class="language-java">import org.junit.jupiter.api.Test;
import static org.junit.jupiter.api.Assertions.*;

class CalculatorTest {
    private Calculator calc = new Calculator();

    @Test
    void testAdd() {
        assertEquals(5, calc.add(2, 3));
    }

    @Test
    void testDivideByZero() {
        assertThrows(ArithmeticException.class,
            () -&gt; calc.divide(10, 0));
    }

    @BeforeEach
    void setup() {
        calc = new Calculator();
    }
}
</code></pre>
<h2 id="mocking"><a class="header" href="#mocking">Mocking</a></h2>
<p>Isolate code under test:</p>
<pre><code class="language-python">from unittest.mock import Mock, patch

@patch('module.external_api')
def test_with_mock(mock_api):
    mock_api.return_value = {"status": "ok"}
    result = my_function()
    assert result == "success"
    mock_api.assert_called_once()
</code></pre>
<h2 id="best-practices-92"><a class="header" href="#best-practices-92">Best Practices</a></h2>
<ol>
<li><strong>One assertion per test</strong> (or related)</li>
<li><strong>Arrange-Act-Assert pattern</strong></li>
<li><strong>Descriptive names</strong>: <code>test_add_positive_numbers</code></li>
<li><strong>Test behavior, not implementation</strong></li>
<li><strong>Test edge cases and errors</strong></li>
</ol>
<h2 id="coverage"><a class="header" href="#coverage">Coverage</a></h2>
<pre><code class="language-bash"># Python coverage
pytest --cov=myapp tests/

# JavaScript coverage
npm test -- --coverage
</code></pre>
<p><strong>Target</strong>: 80%+ coverage</p>
<h2 id="common-assertions"><a class="header" href="#common-assertions">Common Assertions</a></h2>
<pre><code class="language-python">assert x == y           # Equality
assert x &gt; y            # Comparison
assert x is None        # Identity
assert x in list        # Membership
with raises(Exception): # Exception
    function()
</code></pre>
<h2 id="eli10-37"><a class="header" href="#eli10-37">ELI10</a></h2>
<p>Unit tests are like checking individual pieces:</p>
<ul>
<li>Test each part separately</li>
<li>Make sure it works alone</li>
<li>Catch problems early!</li>
</ul>
<p>Like quality control in a factory!</p>
<h2 id="further-resources-51"><a class="header" href="#further-resources-51">Further Resources</a></h2>
<ul>
<li><a href="https://docs.pytest.org/">pytest Documentation</a></li>
<li><a href="https://jestjs.io/">Jest Documentation</a></li>
<li><a href="https://junit.org/junit5/docs/current/user-guide/">JUnit 5 Guide</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="integration-testing"><a class="header" href="#integration-testing">Integration Testing</a></h1>
<p>Integration testing verifies that different modules or services work together correctly. Unlike unit tests that test individual components in isolation, integration tests validate interactions between components.</p>
<h2 id="overview-107"><a class="header" href="#overview-107">Overview</a></h2>
<p>Integration tests validate:</p>
<ul>
<li>API endpoints</li>
<li>Database interactions</li>
<li>External service integrations</li>
<li>Component interactions</li>
<li>End-to-end workflows</li>
</ul>
<h2 id="testing-strategies"><a class="header" href="#testing-strategies">Testing Strategies</a></h2>
<h3 id="bottom-up-approach"><a class="header" href="#bottom-up-approach">Bottom-Up Approach</a></h3>
<pre><code class="language-python"># Test data layer
def test_database_connection():
    db = connect_to_database()
    assert db.is_connected()

# Test service layer with real database
def test_user_service():
    service = UserService(real_database)
    user = service.create_user("test@example.com")
    assert user.email == "test@example.com"

# Test API layer with real services
def test_api_endpoint():
    response = client.post("/users", json={"email": "test@example.com"})
    assert response.status_code == 201
</code></pre>
<h3 id="top-down-approach"><a class="header" href="#top-down-approach">Top-Down Approach</a></h3>
<pre><code class="language-python"># Test API first with mocked services
def test_api_with_mocks():
    with mock_user_service():
        response = client.post("/users", json={"email": "test@example.com"})
        assert response.status_code == 201

# Then test with real services
def test_api_with_real_services():
    response = client.post("/users", json={"email": "test@example.com"})
    user = db.query("SELECT * FROM users WHERE email = ?", "test@example.com")
    assert user is not None
</code></pre>
<h2 id="api-testing"><a class="header" href="#api-testing">API Testing</a></h2>
<pre><code class="language-python"># Flask example
from flask import Flask
from flask.testing import FlaskClient

def test_api_endpoints(client: FlaskClient):
    # POST request
    response = client.post('/api/users', json={
        'username': 'testuser',
        'email': 'test@example.com'
    })
    assert response.status_code == 201
    data = response.get_json()
    user_id = data['id']

    # GET request
    response = client.get(f'/api/users/{user_id}')
    assert response.status_code == 200
    assert response.json['username'] == 'testuser'

    # PUT request
    response = client.put(f'/api/users/{user_id}', json={
        'email': 'newemail@example.com'
    })
    assert response.status_code == 200

    # DELETE request
    response = client.delete(f'/api/users/{user_id}')
    assert response.status_code == 204
</code></pre>
<h2 id="database-testing"><a class="header" href="#database-testing">Database Testing</a></h2>
<pre><code class="language-python">import pytest
from sqlalchemy import create_engine
from sqlalchemy.orm import sessionmaker

@pytest.fixture(scope="function")
def db_session():
    # Create test database
    engine = create_engine('sqlite:///:memory:')
    Base.metadata.create_all(engine)
    Session = sessionmaker(bind=engine)
    session = Session()

    yield session

    session.close()

def test_user_crud(db_session):
    # Create
    user = User(username="test", email="test@example.com")
    db_session.add(user)
    db_session.commit()

    # Read
    retrieved = db_session.query(User).filter_by(username="test").first()
    assert retrieved.email == "test@example.com"

    # Update
    retrieved.email = "updated@example.com"
    db_session.commit()

    # Delete
    db_session.delete(retrieved)
    db_session.commit()
    assert db_session.query(User).count() == 0
</code></pre>
<h2 id="docker-compose-for-testing"><a class="header" href="#docker-compose-for-testing">Docker Compose for Testing</a></h2>
<pre><code class="language-yaml"># docker-compose.test.yml
version: '3.8'
services:
  postgres:
    image: postgres:15
    environment:
      POSTGRES_DB: testdb
      POSTGRES_USER: test
      POSTGRES_PASSWORD: test
    ports:
      - "5432:5432"

  redis:
    image: redis:7
    ports:
      - "6379:6379"

  app:
    build: .
    depends_on:
      - postgres
      - redis
    environment:
      DATABASE_URL: postgresql://test:test@postgres:5432/testdb
      REDIS_URL: redis://redis:6379
    command: pytest tests/integration/
</code></pre>
<pre><code class="language-bash"># Run integration tests
docker-compose -f docker-compose.test.yml up --abort-on-container-exit
</code></pre>
<h2 id="test-fixtures-and-setup"><a class="header" href="#test-fixtures-and-setup">Test Fixtures and Setup</a></h2>
<pre><code class="language-python">import pytest

@pytest.fixture(scope="session")
def app():
    """Create application for testing"""
    app = create_app('testing')
    return app

@pytest.fixture(scope="session")
def client(app):
    """Create test client"""
    return app.test_client()

@pytest.fixture(scope="function")
def clean_database(db_session):
    """Clean database before each test"""
    db_session.query(User).delete()
    db_session.query(Order).delete()
    db_session.commit()
    yield
    db_session.rollback()

def test_with_clean_db(client, clean_database):
    response = client.post('/users', json={'username': 'test'})
    assert response.status_code == 201
</code></pre>
<h2 id="mocking-external-services"><a class="header" href="#mocking-external-services">Mocking External Services</a></h2>
<pre><code class="language-python">from unittest.mock import patch, Mock

def test_external_api_integration():
    with patch('requests.get') as mock_get:
        mock_response = Mock()
        mock_response.status_code = 200
        mock_response.json.return_value = {'data': 'test'}
        mock_get.return_value = mock_response

        result = fetch_external_data()
        assert result['data'] == 'test'
        mock_get.assert_called_once()
</code></pre>
<h2 id="best-practices-93"><a class="header" href="#best-practices-93">Best Practices</a></h2>
<ol>
<li><strong>Isolate tests</strong>: Each test should be independent</li>
<li><strong>Use test databases</strong>: Never test against production</li>
<li><strong>Clean state</strong>: Reset database/state between tests</li>
<li><strong>Test realistic scenarios</strong>: Use production-like data</li>
<li><strong>Fast feedback</strong>: Keep tests reasonably fast</li>
<li><strong>CI/CD integration</strong>: Run automatically on commits</li>
<li><strong>Test error cases</strong>: Not just happy paths</li>
<li><strong>Use containers</strong>: Docker for consistent environments</li>
</ol>
<h2 id="quick-reference-20"><a class="header" href="#quick-reference-20">Quick Reference</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Aspect</th><th>Approach</th></tr></thead><tbody>
<tr><td>Database</td><td>Use test DB or transactions</td></tr>
<tr><td>External APIs</td><td>Mock or use test endpoints</td></tr>
<tr><td>File system</td><td>Use temp directories</td></tr>
<tr><td>Time</td><td>Mock datetime</td></tr>
<tr><td>Network</td><td>Use test servers or mocks</td></tr>
</tbody></table>
</div>
<p>Integration tests ensure your system components work together correctly, catching issues that unit tests might miss.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="test-driven-development-tdd"><a class="header" href="#test-driven-development-tdd">Test-Driven Development (TDD)</a></h1>
<h2 id="overview-108"><a class="header" href="#overview-108">Overview</a></h2>
<p>TDD: Write tests BEFORE writing code. Red → Green → Refactor cycle.</p>
<h2 id="red-green-refactor-cycle"><a class="header" href="#red-green-refactor-cycle">Red-Green-Refactor Cycle</a></h2>
<h3 id="1-red-write-failing-test"><a class="header" href="#1-red-write-failing-test">1. Red: Write Failing Test</a></h3>
<pre><code class="language-python">def test_add_positive_numbers():
    assert add(2, 3) == 5
</code></pre>
<h3 id="2-green-write-minimal-code"><a class="header" href="#2-green-write-minimal-code">2. Green: Write Minimal Code</a></h3>
<pre><code class="language-python">def add(a, b):
    return 5  # Hardcoded to pass test
</code></pre>
<h3 id="3-refactor-improve-code"><a class="header" href="#3-refactor-improve-code">3. Refactor: Improve Code</a></h3>
<pre><code class="language-python">def add(a, b):
    return a + b  # Proper implementation
</code></pre>
<h2 id="benefits-1"><a class="header" href="#benefits-1">Benefits</a></h2>
<p>✅ Better design (code written to be testable)
✅ Fewer bugs (test before shipping)
✅ Confidence (safe to refactor)
✅ Documentation (tests show usage)
✅ Less debugging (catch issues early)</p>
<h2 id="example-calculator"><a class="header" href="#example-calculator">Example: Calculator</a></h2>
<h3 id="step-1-red"><a class="header" href="#step-1-red">Step 1: Red</a></h3>
<pre><code class="language-python">class TestCalculator:
    def test_add(self):
        calc = Calculator()
        assert calc.add(2, 3) == 5
</code></pre>
<h3 id="step-2-green"><a class="header" href="#step-2-green">Step 2: Green</a></h3>
<pre><code class="language-python">class Calculator:
    def add(self, a, b):
        return a + b
</code></pre>
<h3 id="step-3-refactor"><a class="header" href="#step-3-refactor">Step 3: Refactor</a></h3>
<pre><code class="language-python">class Calculator:
    def add(self, a, b):
        """Add two numbers"""
        if not isinstance(a, (int, float)):
            raise TypeError("a must be number")
        return a + b
</code></pre>
<h2 id="tdd-best-practices"><a class="header" href="#tdd-best-practices">TDD Best Practices</a></h2>
<ol>
<li><strong>Start simple</strong>: Test one behavior</li>
<li><strong>One assertion</strong> per test (usually)</li>
<li><strong>Clear names</strong>: <code>test_add_positive_numbers</code></li>
<li><strong>Arrange-Act-Assert</strong></li>
</ol>
<pre><code class="language-python">def test_withdraw():
    # Arrange
    account = Account(1000)
    # Act
    account.withdraw(200)
    # Assert
    assert account.balance == 800
</code></pre>
<ol start="5">
<li><strong>Don't skip red phase</strong>: Ensures test can fail</li>
</ol>
<h2 id="working-test-example"><a class="header" href="#working-test-example">Working Test Example</a></h2>
<pre><code class="language-python"># calculator.py - EMPTY (start)

# test_calculator.py
def test_multiply():
    # Test fails: function doesn't exist (RED)
    assert multiply(3, 4) == 12
</code></pre>
<pre><code class="language-python"># calculator.py - implement
def multiply(a, b):
    return a * b
</code></pre>
<pre><code class="language-python"># test passes (GREEN)

# Refactor if needed
</code></pre>
<h2 id="anti-patterns"><a class="header" href="#anti-patterns">Anti-patterns</a></h2>
<p>❌ Writing all tests at once
❌ Over-engineering the implementation
❌ Ignoring red phase
❌ Poorly named tests
❌ Testing implementation, not behavior</p>
<h2 id="coverage-with-tdd"><a class="header" href="#coverage-with-tdd">Coverage with TDD</a></h2>
<p>TDD naturally leads to high coverage:</p>
<pre><code class="language-python"># Typical TDD: 90%+ coverage
# Non-TDD: 20-40% coverage
</code></pre>
<h2 id="tdd-vs-bdd"><a class="header" href="#tdd-vs-bdd">TDD vs BDD</a></h2>
<p><strong>TDD</strong>: Tests focus on unit behavior</p>
<pre><code class="language-python">test_add_positive_numbers()
test_add_negative_numbers()
</code></pre>
<p><strong>BDD</strong>: Tests focus on business behavior</p>
<pre><code class="language-python">test_user_can_withdraw_money()
test_system_prevents_overdraft()
</code></pre>
<h2 id="tools-18"><a class="header" href="#tools-18">Tools</a></h2>
<ul>
<li><strong>pytest</strong>: Python testing</li>
<li><strong>Jest</strong>: JavaScript testing</li>
<li><strong>JUnit</strong>: Java testing</li>
<li><strong>RSpec</strong>: Ruby testing</li>
</ul>
<h2 id="eli10-38"><a class="header" href="#eli10-38">ELI10</a></h2>
<p>TDD is like building with blueprints:</p>
<ol>
<li>Draw blueprint (write test)</li>
<li>Build to match (write code)</li>
<li>Improve design (refactor)</li>
</ol>
<p>Never start building without a plan!</p>
<h2 id="further-resources-52"><a class="header" href="#further-resources-52">Further Resources</a></h2>
<ul>
<li><a href="https://www.amazon.com/Test-Driven-Development-Kent-Beck/dp/0321146530">TDD by Example - Kent Beck</a></li>
<li><a href="https://testdriven.io/blog/what-is-tdd/">What is TDD</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="pytest"><a class="header" href="#pytest">pytest</a></h1>
<p>pytest is a mature, feature-rich testing framework for Python that makes it easy to write simple tests, yet scales to support complex functional testing.</p>
<h2 id="installation-25"><a class="header" href="#installation-25">Installation</a></h2>
<pre><code class="language-bash">pip install pytest
pip install pytest pytest-cov pytest-mock pytest-xdist

# Verify
pytest --version
</code></pre>
<h2 id="basic-usage-13"><a class="header" href="#basic-usage-13">Basic Usage</a></h2>
<pre><code class="language-bash"># Run all tests
pytest

# Run specific file
pytest test_example.py

# Run specific test
pytest test_example.py::test_function

# Run with verbose output
pytest -v

# Run with coverage
pytest --cov=myapp tests/

# Parallel execution
pytest -n 4
</code></pre>
<h2 id="writing-tests"><a class="header" href="#writing-tests">Writing Tests</a></h2>
<pre><code class="language-python"># test_example.py

# Simple test
def test_addition():
    assert 1 + 1 == 2

# Test with setup
def test_list():
    my_list = [1, 2, 3]
    assert len(my_list) == 3
    assert 2 in my_list

# Test exceptions
import pytest

def test_division_by_zero():
    with pytest.raises(ZeroDivisionError):
        1 / 0

# Parametrized test
@pytest.mark.parametrize("input,expected", [
    (1, 2),
    (2, 3),
    (3, 4),
])
def test_increment(input, expected):
    assert input + 1 == expected
</code></pre>
<h2 id="fixtures"><a class="header" href="#fixtures">Fixtures</a></h2>
<pre><code class="language-python">import pytest

# Basic fixture
@pytest.fixture
def sample_data():
    return [1, 2, 3, 4, 5]

def test_sum(sample_data):
    assert sum(sample_data) == 15

# Fixture with setup/teardown
@pytest.fixture
def database_connection():
    # Setup
    conn = create_connection()
    yield conn
    # Teardown
    conn.close()

# Scope: function (default), class, module, package, session
@pytest.fixture(scope="module")
def expensive_resource():
    return load_expensive_data()

# Autouse fixture
@pytest.fixture(autouse=True)
def setup_test():
    print("Setting up test")
    yield
    print("Tearing down test")
</code></pre>
<h2 id="markers"><a class="header" href="#markers">Markers</a></h2>
<pre><code class="language-python">import pytest

# Skip test
@pytest.mark.skip(reason="Not implemented yet")
def test_feature():
    pass

# Skip conditionally
@pytest.mark.skipif(sys.version_info &lt; (3, 8), reason="Requires Python 3.8+")
def test_modern_feature():
    pass

# Expected to fail
@pytest.mark.xfail
def test_known_bug():
    assert False

# Custom marker
@pytest.mark.slow
def test_slow_operation():
    pass

# Run specific markers
# pytest -m slow
# pytest -m "not slow"
</code></pre>
<h2 id="mocking-1"><a class="header" href="#mocking-1">Mocking</a></h2>
<pre><code class="language-python">from unittest.mock import Mock, patch, MagicMock

def test_with_mock():
    mock_obj = Mock()
    mock_obj.method.return_value = 42
    assert mock_obj.method() == 42

# Patch function
def test_with_patch():
    with patch('module.function') as mock_func:
        mock_func.return_value = 'mocked'
        result = module.function()
        assert result == 'mocked'

# pytest-mock plugin
def test_with_mocker(mocker):
    mock = mocker.patch('module.function')
    mock.return_value = 'mocked'
    assert module.function() == 'mocked'
</code></pre>
<h2 id="quick-reference-21"><a class="header" href="#quick-reference-21">Quick Reference</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody>
<tr><td><code>pytest</code></td><td>Run all tests</td></tr>
<tr><td><code>pytest -v</code></td><td>Verbose output</td></tr>
<tr><td><code>pytest -k pattern</code></td><td>Run tests matching pattern</td></tr>
<tr><td><code>pytest -m marker</code></td><td>Run tests with marker</td></tr>
<tr><td><code>pytest --cov</code></td><td>Coverage report</td></tr>
<tr><td><code>pytest -x</code></td><td>Stop on first failure</td></tr>
<tr><td><code>pytest --pdb</code></td><td>Drop into debugger on failure</td></tr>
</tbody></table>
</div>
<p>pytest is the de facto standard for Python testing with its simple syntax, powerful features, and extensive plugin ecosystem.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="debugging-8"><a class="header" href="#debugging-8">Debugging</a></h1>
<p>This directory contains guides for debugging software at various levels.</p>
<h2 id="contents-1"><a class="header" href="#contents-1">Contents</a></h2>
<ul>
<li><strong><a href="debugging/gdb.html">GDB</a></strong> - GNU Debugger for C/C++ applications</li>
<li><strong><a href="debugging/core_dump.html">Core Dumps</a></strong> - Analyzing program crashes</li>
<li><strong><a href="debugging/linux_kernel.html">Linux Kernel</a></strong> - Kernel-level debugging techniques</li>
</ul>
<h2 id="common-debugging-workflow"><a class="header" href="#common-debugging-workflow">Common Debugging Workflow</a></h2>
<ol>
<li><strong>Reproduce the issue</strong> - Consistent reproduction is key</li>
<li><strong>Gather information</strong> - Logs, error messages, core dumps</li>
<li><strong>Isolate the problem</strong> - Narrow down the scope</li>
<li><strong>Form hypothesis</strong> - What could cause this?</li>
<li><strong>Test hypothesis</strong> - Use debuggers, logs, tests</li>
<li><strong>Fix and verify</strong> - Implement fix and confirm</li>
</ol>
<h2 id="tools-overview"><a class="header" href="#tools-overview">Tools Overview</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Tool</th><th>Purpose</th><th>Level</th></tr></thead><tbody>
<tr><td>gdb</td><td>Interactive debugging</td><td>Application</td></tr>
<tr><td>valgrind</td><td>Memory errors</td><td>Application</td></tr>
<tr><td>strace</td><td>System call tracing</td><td>Application/Kernel</td></tr>
<tr><td>ltrace</td><td>Library call tracing</td><td>Application</td></tr>
<tr><td>perf</td><td>Performance profiling</td><td>Application/Kernel</td></tr>
<tr><td>ftrace</td><td>Function tracing</td><td>Kernel</td></tr>
<tr><td>dmesg</td><td>Kernel messages</td><td>Kernel</td></tr>
</tbody></table>
</div>
<p>Effective debugging combines tools, techniques, and systematic thinking.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="gdb-gnu-debugger"><a class="header" href="#gdb-gnu-debugger">GDB (GNU Debugger)</a></h1>
<p>GDB is the GNU Project debugger, allowing you to see what is going on inside a program while it executes or what it was doing at the moment it crashed. It's an essential tool for debugging C, C++, and other compiled languages.</p>
<h2 id="overview-109"><a class="header" href="#overview-109">Overview</a></h2>
<p>GDB provides extensive facilities for tracing and altering program execution, including breakpoints, watchpoints, examining variables, and manipulating program state.</p>
<p><strong>Key Features:</strong></p>
<ul>
<li>Set breakpoints and watchpoints</li>
<li>Step through code line by line</li>
<li>Examine and modify variables</li>
<li>Analyze core dumps</li>
<li>Remote debugging</li>
<li>Multi-threaded debugging</li>
<li>Reverse debugging</li>
<li>Python scripting support</li>
</ul>
<h2 id="installation-26"><a class="header" href="#installation-26">Installation</a></h2>
<pre><code class="language-bash"># Ubuntu/Debian
sudo apt update
sudo apt install gdb

# macOS (or use lldb)
brew install gdb

# CentOS/RHEL
sudo yum install gdb

# Arch Linux
sudo pacman -S gdb

# Verify installation
gdb --version
</code></pre>
<h2 id="compiling-for-debugging"><a class="header" href="#compiling-for-debugging">Compiling for Debugging</a></h2>
<pre><code class="language-bash"># Compile with debug symbols (-g flag)
gcc -g program.c -o program
g++ -g program.cpp -o program

# Disable optimization for better debugging
gcc -g -O0 program.c -o program

# With all warnings
gcc -g -O0 -Wall -Wextra program.c -o program

# For C++ with debug symbols
g++ -g -std=c++17 program.cpp -o program
</code></pre>
<h2 id="basic-usage-14"><a class="header" href="#basic-usage-14">Basic Usage</a></h2>
<h3 id="starting-gdb"><a class="header" href="#starting-gdb">Starting GDB</a></h3>
<pre><code class="language-bash"># Start GDB with program
gdb ./program

# With arguments
gdb --args ./program arg1 arg2

# Attach to running process
gdb -p &lt;pid&gt;
gdb attach &lt;pid&gt;

# Analyze core dump
gdb ./program core

# Quiet mode (no intro message)
gdb -q ./program
</code></pre>
<h3 id="basic-commands-3"><a class="header" href="#basic-commands-3">Basic Commands</a></h3>
<pre><code class="language-gdb"># Running the program
(gdb) run                    # Start program
(gdb) run arg1 arg2          # Start with arguments
(gdb) start                  # Start and break at main()
(gdb) continue               # Continue execution (c)
(gdb) kill                   # Kill running program
(gdb) quit                   # Exit GDB (q)

# Breakpoints
(gdb) break main             # Break at function
(gdb) break main.c:42        # Break at line in file
(gdb) break *0x400500        # Break at address
(gdb) tbreak main            # Temporary breakpoint
(gdb) info breakpoints       # List breakpoints (info b)
(gdb) delete 1               # Delete breakpoint 1 (d 1)
(gdb) delete                 # Delete all breakpoints
(gdb) disable 1              # Disable breakpoint 1
(gdb) enable 1               # Enable breakpoint 1

# Stepping
(gdb) step                   # Step into (s)
(gdb) next                   # Step over (n)
(gdb) finish                 # Run until function returns
(gdb) until 50               # Run until line 50
(gdb) stepi                  # Step one instruction (si)
(gdb) nexti                  # Next instruction (ni)

# Examining code
(gdb) list                   # Show source code (l)
(gdb) list main              # List function
(gdb) list 42                # List around line 42
(gdb) disassemble            # Show assembly
(gdb) disassemble main       # Disassemble function

# Stack and frames
(gdb) backtrace              # Show call stack (bt)
(gdb) frame 0                # Switch to frame 0 (f 0)
(gdb) up                     # Move up stack frame
(gdb) down                   # Move down stack frame
(gdb) info frame             # Current frame info
(gdb) info args              # Function arguments
(gdb) info locals            # Local variables
</code></pre>
<h2 id="examining-variables"><a class="header" href="#examining-variables">Examining Variables</a></h2>
<pre><code class="language-gdb"># Print variables
(gdb) print variable         # Print variable (p)
(gdb) print *pointer         # Dereference pointer
(gdb) print array[5]         # Array element
(gdb) print struct.member    # Structure member

# Different formats
(gdb) print/x variable       # Hexadecimal
(gdb) print/d variable       # Decimal
(gdb) print/t variable       # Binary
(gdb) print/c variable       # Character
(gdb) print/f variable       # Float
(gdb) print/s string_ptr     # String

# Display (auto-print on each stop)
(gdb) display variable       # Auto-display variable
(gdb) info display           # Show display list
(gdb) undisplay 1            # Remove display 1

# Examine memory
(gdb) x/10x $rsp             # Examine 10 hex words at stack pointer
(gdb) x/10i main             # Examine 10 instructions at main
(gdb) x/s string_ptr         # Examine string
(gdb) x/10b buffer           # Examine 10 bytes

# Format: x/[count][format][size] address
# Format: x=hex, d=decimal, i=instruction, s=string, c=char
# Size: b=byte, h=halfword, w=word, g=giant (8 bytes)

# Set variables
(gdb) set variable x = 42    # Set variable value
(gdb) set $i = 0             # Set convenience variable
</code></pre>
<h2 id="watchpoints"><a class="header" href="#watchpoints">Watchpoints</a></h2>
<pre><code class="language-gdb"># Watch for changes
(gdb) watch variable         # Break when variable changes
(gdb) rwatch variable        # Break when variable is read
(gdb) awatch variable        # Break on read or write

# Conditional watchpoint
(gdb) watch x if x &gt; 100

# Info and delete
(gdb) info watchpoints       # List watchpoints
(gdb) delete 2               # Delete watchpoint 2
</code></pre>
<h2 id="conditional-breakpoints"><a class="header" href="#conditional-breakpoints">Conditional Breakpoints</a></h2>
<pre><code class="language-gdb"># Set conditional breakpoint
(gdb) break main.c:42 if x == 5

# Add condition to existing breakpoint
(gdb) condition 1 x == 5

# Remove condition
(gdb) condition 1

# Commands to execute at breakpoint
(gdb) commands 1
&gt; print x
&gt; continue
&gt; end

# Ignore breakpoint N times
(gdb) ignore 1 10            # Ignore first 10 hits
</code></pre>
<h2 id="thread-debugging"><a class="header" href="#thread-debugging">Thread Debugging</a></h2>
<pre><code class="language-gdb"># Thread information
(gdb) info threads           # List all threads
(gdb) thread 3               # Switch to thread 3
(gdb) thread apply all bt    # Backtrace all threads
(gdb) thread apply all print x

# Thread-specific breakpoints
(gdb) break main.c:42 thread 2

# Non-stop mode (continue while other threads stop)
(gdb) set non-stop on
</code></pre>
<h2 id="core-dump-analysis"><a class="header" href="#core-dump-analysis">Core Dump Analysis</a></h2>
<pre><code class="language-bash"># Generate core dump
ulimit -c unlimited          # Enable core dumps

# Debug core dump
gdb ./program core

# In GDB
(gdb) bt                     # See where it crashed
(gdb) frame 0                # Examine crash frame
(gdb) print variable         # Check variable values
(gdb) info registers         # CPU registers at crash
</code></pre>
<h2 id="advanced-features-8"><a class="header" href="#advanced-features-8">Advanced Features</a></h2>
<h3 id="reverse-debugging"><a class="header" href="#reverse-debugging">Reverse Debugging</a></h3>
<pre><code class="language-gdb"># Record execution
(gdb) record                 # Start recording
(gdb) record stop            # Stop recording

# Reverse execution
(gdb) reverse-step           # Step backward (rs)
(gdb) reverse-next           # Next backward (rn)
(gdb) reverse-continue       # Continue backward (rc)
(gdb) reverse-finish         # Reverse to function call
</code></pre>
<h3 id="checkpoints"><a class="header" href="#checkpoints">Checkpoints</a></h3>
<pre><code class="language-gdb"># Save program state
(gdb) checkpoint             # Create checkpoint
(gdb) info checkpoints       # List checkpoints
(gdb) restart 1              # Restore checkpoint 1
(gdb) delete checkpoint 1    # Delete checkpoint
</code></pre>
<h3 id="python-scripting"><a class="header" href="#python-scripting">Python Scripting</a></h3>
<pre><code class="language-gdb"># Python in GDB
(gdb) python print("Hello from GDB")

# Load Python script
(gdb) source script.py

# Python example
(gdb) python
&gt; for i in range(5):
&gt;     gdb.execute("print $i++")
&gt; end
</code></pre>
<h2 id="gdb-configuration"><a class="header" href="#gdb-configuration">GDB Configuration</a></h2>
<h3 id="gdbinit-file"><a class="header" href="#gdbinit-file">.gdbinit File</a></h3>
<pre><code class="language-bash"># ~/.gdbinit
set history save on
set history size 10000
set history filename ~/.gdb_history
set print pretty on
set print array on
set print array-indexes on
set python print-stack full

# Auto-load local .gdbinit
set auto-load safe-path /

# Custom commands
define phead
    print *($arg0)-&gt;head
end

define ptail
    print *($arg0)-&gt;tail
end
</code></pre>
<h3 id="gdb-dashboard"><a class="header" href="#gdb-dashboard">GDB Dashboard</a></h3>
<pre><code class="language-bash"># Install GDB Dashboard
wget -P ~ https://git.io/.gdbinit

# Or with curl
curl -sSL https://git.io/.gdbinit &gt; ~/.gdbinit

# Customization in ~/.gdbinit.d/init
</code></pre>
<h2 id="common-patterns-22"><a class="header" href="#common-patterns-22">Common Patterns</a></h2>
<h3 id="debugging-segmentation-fault"><a class="header" href="#debugging-segmentation-fault">Debugging Segmentation Fault</a></h3>
<pre><code class="language-gdb"># Run program
(gdb) run

# When it crashes
Program received signal SIGSEGV, Segmentation fault.

# Check where it crashed
(gdb) backtrace

# Examine the failing instruction
(gdb) frame 0
(gdb) list

# Check variables
(gdb) print pointer
(gdb) print *pointer          # This might fail if NULL

# Check registers
(gdb) info registers
</code></pre>
<h3 id="finding-memory-leaks"><a class="header" href="#finding-memory-leaks">Finding Memory Leaks</a></h3>
<pre><code class="language-gdb"># Set breakpoint at allocation
(gdb) break malloc
(gdb) commands
&gt; backtrace
&gt; continue
&gt; end

# Set breakpoint at free
(gdb) break free
(gdb) commands
&gt; backtrace
&gt; continue
&gt; end

# Or use Valgrind instead
</code></pre>
<h3 id="debugging-infinite-loop"><a class="header" href="#debugging-infinite-loop">Debugging Infinite Loop</a></h3>
<pre><code class="language-gdb"># Start program
(gdb) run

# Interrupt (Ctrl+C)
^C
Program received signal SIGINT

# Check where it's stuck
(gdb) backtrace
(gdb) list

# Set breakpoint and check variable changes
(gdb) break main.c:loop_line
(gdb) commands
&gt; print loop_var
&gt; continue
&gt; end
</code></pre>
<h3 id="catching-signals"><a class="header" href="#catching-signals">Catching Signals</a></h3>
<pre><code class="language-gdb"># Catch specific signal
(gdb) catch signal SIGSEGV

# Catch all signals
(gdb) catch signal all

# Info signals
(gdb) info signals

# Handle signal (pass, nopass, stop, nostop, print, noprint)
(gdb) handle SIGINT nostop print pass
</code></pre>
<h2 id="remote-debugging"><a class="header" href="#remote-debugging">Remote Debugging</a></h2>
<h3 id="gdb-server"><a class="header" href="#gdb-server">GDB Server</a></h3>
<pre><code class="language-bash"># On remote machine
gdbserver :1234 ./program

# Or attach to running process
gdbserver :1234 --attach &lt;pid&gt;

# On local machine
gdb ./program
(gdb) target remote remote-host:1234
(gdb) continue
</code></pre>
<h3 id="serialuart-debugging"><a class="header" href="#serialuart-debugging">Serial/UART Debugging</a></h3>
<pre><code class="language-bash"># Connect via serial port
gdb ./program
(gdb) target remote /dev/ttyUSB0

# Set baud rate (if needed, in .gdbinit)
set serial baud 115200
</code></pre>
<h2 id="tui-mode-text-user-interface"><a class="header" href="#tui-mode-text-user-interface">TUI Mode (Text User Interface)</a></h2>
<pre><code class="language-gdb"># Start TUI mode
(gdb) tui enable
(gdb) Ctrl+X A               # Toggle TUI

# TUI layouts
(gdb) layout src             # Source code
(gdb) layout asm             # Assembly
(gdb) layout split           # Source and assembly
(gdb) layout regs            # Registers

# Window focus
(gdb) focus cmd              # Focus command window
(gdb) focus src              # Focus source window

# Refresh display
(gdb) Ctrl+L                 # Refresh screen
</code></pre>
<h2 id="useful-tricks"><a class="header" href="#useful-tricks">Useful Tricks</a></h2>
<h3 id="pretty-printing"><a class="header" href="#pretty-printing">Pretty Printing</a></h3>
<pre><code class="language-gdb"># Enable pretty printing
(gdb) set print pretty on
(gdb) set print array on
(gdb) set print array-indexes on

# STL pretty printers (C++)
(gdb) python
import sys
sys.path.insert(0, '/usr/share/gcc/python')
from libstdcxx.v6.printers import register_libstdcxx_printers
register_libstdcxx_printers(None)
end

# Now print STL containers nicely
(gdb) print my_vector
(gdb) print my_map
</code></pre>
<h3 id="logging-2"><a class="header" href="#logging-2">Logging</a></h3>
<pre><code class="language-gdb"># Enable logging
(gdb) set logging on          # Logs to gdb.txt
(gdb) set logging file mylog.txt
(gdb) set logging overwrite on

# Log and display
(gdb) set logging redirect off
</code></pre>
<h3 id="macros"><a class="header" href="#macros">Macros</a></h3>
<pre><code class="language-bash"># ~/.gdbinit
define plist
    set $node = $arg0
    while $node != 0
        print *$node
        set $node = $node-&gt;next
    end
end

# Usage
(gdb) plist head
</code></pre>
<h3 id="function-breakpoints"><a class="header" href="#function-breakpoints">Function Breakpoints</a></h3>
<pre><code class="language-gdb"># Break on all functions matching pattern
(gdb) rbreak ^my_.*          # All functions starting with my_

# Break on exception throw (C++)
(gdb) catch throw

# Break on system calls
(gdb) catch syscall write
</code></pre>
<h2 id="debugging-optimized-code"><a class="header" href="#debugging-optimized-code">Debugging Optimized Code</a></h2>
<pre><code class="language-gdb"># Problems with -O2, -O3
# Variables optimized away
# Inlining makes stepping difficult

# Solutions:
# 1. Compile with -Og (optimize for debugging)
gcc -g -Og program.c -o program

# 2. Disable specific optimizations
gcc -g -O2 -fno-inline program.c -o program

# 3. Use volatile for critical variables
volatile int debug_var;

# In GDB, skip inlined functions
(gdb) skip -rfu ^std::
</code></pre>
<h2 id="integration-with-other-tools"><a class="header" href="#integration-with-other-tools">Integration with Other Tools</a></h2>
<h3 id="valgrind-and-gdb"><a class="header" href="#valgrind-and-gdb">Valgrind and GDB</a></h3>
<pre><code class="language-bash"># Run program under Valgrind with GDB server
valgrind --vgdb=yes --vgdb-error=0 ./program

# In another terminal
gdb ./program
(gdb) target remote | vgdb
</code></pre>
<h3 id="gdb-with-make"><a class="header" href="#gdb-with-make">GDB with Make</a></h3>
<pre><code class="language-makefile"># Makefile
debug: program
	gdb ./program

.PHONY: debug
</code></pre>
<h3 id="gdb-in-vscode"><a class="header" href="#gdb-in-vscode">GDB in VSCode</a></h3>
<pre><code class="language-json">// .vscode/launch.json
{
    "version": "0.2.0",
    "configurations": [
        {
            "name": "GDB Debug",
            "type": "cppdbg",
            "request": "launch",
            "program": "${workspaceFolder}/program",
            "args": [],
            "stopAtEntry": false,
            "cwd": "${workspaceFolder}",
            "environment": [],
            "externalConsole": false,
            "MIMode": "gdb",
            "setupCommands": [
                {
                    "description": "Enable pretty-printing",
                    "text": "-enable-pretty-printing",
                    "ignoreFailures": true
                }
            ]
        }
    ]
}
</code></pre>
<h2 id="troubleshooting-24"><a class="header" href="#troubleshooting-24">Troubleshooting</a></h2>
<pre><code class="language-gdb"># Can't see source code
(gdb) directory /path/to/source

# Symbols not loaded
# Ensure compiled with -g
# Check symbols loaded
(gdb) info sources

# Can't set breakpoint
# Check function exists
(gdb) info functions pattern

# Program behavior different in GDB
# Try without breakpoints
# Timing-sensitive bugs

# GDB hangs
# Check for infinite loops in pretty printers
(gdb) set print elements 100

# Can't debug strip binary
# Need unstripped version or separate debug symbols
</code></pre>
<h2 id="quick-reference-22"><a class="header" href="#quick-reference-22">Quick Reference</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Command</th><th>Description</th></tr></thead><tbody>
<tr><td><code>run</code></td><td>Start program</td></tr>
<tr><td><code>break</code></td><td>Set breakpoint</td></tr>
<tr><td><code>continue</code></td><td>Continue execution</td></tr>
<tr><td><code>step</code></td><td>Step into</td></tr>
<tr><td><code>next</code></td><td>Step over</td></tr>
<tr><td><code>print</code></td><td>Print variable</td></tr>
<tr><td><code>backtrace</code></td><td>Show stack</td></tr>
<tr><td><code>frame</code></td><td>Select frame</td></tr>
<tr><td><code>info locals</code></td><td>Show local variables</td></tr>
<tr><td><code>info args</code></td><td>Show function arguments</td></tr>
<tr><td><code>watch</code></td><td>Set watchpoint</td></tr>
<tr><td><code>list</code></td><td>Show source code</td></tr>
<tr><td><code>disassemble</code></td><td>Show assembly</td></tr>
<tr><td><code>quit</code></td><td>Exit GDB</td></tr>
</tbody></table>
</div>
<h2 id="keyboard-shortcuts"><a class="header" href="#keyboard-shortcuts">Keyboard Shortcuts</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Key</th><th>Action</th></tr></thead><tbody>
<tr><td><code>Ctrl+C</code></td><td>Interrupt program</td></tr>
<tr><td><code>Ctrl+D</code></td><td>Exit GDB</td></tr>
<tr><td><code>Enter</code></td><td>Repeat last command</td></tr>
<tr><td><code>Ctrl+X A</code></td><td>Toggle TUI mode</td></tr>
<tr><td><code>Ctrl+L</code></td><td>Refresh screen</td></tr>
<tr><td><code>Ctrl+P</code></td><td>Previous command</td></tr>
<tr><td><code>Ctrl+N</code></td><td>Next command</td></tr>
</tbody></table>
</div>
<p>GDB is an indispensable tool for debugging compiled programs, offering powerful features for understanding program behavior, finding bugs, and analyzing crashes.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="core-dump-analysis-1"><a class="header" href="#core-dump-analysis-1">Core Dump Analysis</a></h1>
<p>Core dumps are memory snapshots of a process at the moment it crashed, essential for post-mortem debugging.</p>
<h2 id="enable-core-dumps"><a class="header" href="#enable-core-dumps">Enable Core Dumps</a></h2>
<pre><code class="language-bash"># Check current limit
ulimit -c

# Enable unlimited core dumps
ulimit -c unlimited

# Make persistent (add to ~/.bashrc)
echo "ulimit -c unlimited" &gt;&gt; ~/.bashrc

# System-wide core dump configuration
sudo vim /etc/security/limits.conf
# Add: * soft core unlimited
</code></pre>
<h2 id="configure-core-dump-location"><a class="header" href="#configure-core-dump-location">Configure Core Dump Location</a></h2>
<pre><code class="language-bash"># Set core dump pattern
sudo sysctl -w kernel.core_pattern=/tmp/core-%e-%p-%t

# Options:
# %e - executable name
# %p - PID
# %t - timestamp
# %s - signal number
# %h - hostname

# Or use systemd-coredump
sudo sysctl -w kernel.core_pattern=|/lib/systemd/systemd-coredump %P %u %g %s %t %c %h
</code></pre>
<h2 id="generate-test-core-dump"><a class="header" href="#generate-test-core-dump">Generate Test Core Dump</a></h2>
<pre><code class="language-bash"># From running process
kill -SEGV &lt;pid&gt;

# From code
#include &lt;signal.h&gt;
raise(SIGSEGV);

# Trigger with gdb
gdb ./program
(gdb) run
(gdb) generate-core-file
</code></pre>
<h2 id="analyze-core-dump-with-gdb"><a class="header" href="#analyze-core-dump-with-gdb">Analyze Core Dump with GDB</a></h2>
<pre><code class="language-bash"># Load core dump
gdb ./program core

# Or
gdb ./program core.12345

# GDB commands
(gdb) bt                 # Backtrace
(gdb) info threads       # List threads
(gdb) thread 2           # Switch to thread 2
(gdb) frame 0            # Select frame
(gdb) info locals        # Local variables
(gdb) print variable     # Print variable
(gdb) info registers     # CPU registers
(gdb) disassemble        # Disassemble current function
</code></pre>
<h2 id="example-analysis-session"><a class="header" href="#example-analysis-session">Example Analysis Session</a></h2>
<pre><code class="language-gdb">$ gdb ./myapp core.12345
(gdb) bt
#0  0x00007f8b9c5a7428 in __GI_raise ()
#1  0x00007f8b9c5a902a in __GI_abort ()
#2  0x0000000000401234 in my_function () at myapp.c:42
#3  0x0000000000401567 in main () at myapp.c:100

(gdb) frame 2
(gdb) list
37      int *ptr = NULL;
38      int value = 0;
39
40      // This will crash
41      value = *ptr;
42
43      return value;

(gdb) print ptr
$1 = (int *) 0x0

(gdb) info locals
ptr = 0x0
value = 0
</code></pre>
<h2 id="extract-information"><a class="header" href="#extract-information">Extract Information</a></h2>
<pre><code class="language-bash"># File information
file core.12345

# Strings in core
strings core.12345 | less

# Binary that produced core
file core.12345
# Look for "execfn:" in output

# All loaded libraries
gdb -batch -ex "info sharedlibrary" ./program core
</code></pre>
<h2 id="automated-analysis"><a class="header" href="#automated-analysis">Automated Analysis</a></h2>
<pre><code class="language-bash"># Generate backtrace
gdb -batch -ex "bt" ./program core &gt; backtrace.txt

# All threads backtrace
gdb -batch -ex "thread apply all bt" ./program core &gt; all_threads.txt
</code></pre>
<h2 id="core-dump-with-containers"><a class="header" href="#core-dump-with-containers">Core Dump with Containers</a></h2>
<pre><code class="language-bash"># Docker - enable core dumps
docker run --ulimit core=-1 myimage

# Kubernetes - configure pod
spec:
  containers:
  - name: myapp
    resources:
      limits:
        core: "-1"
</code></pre>
<h2 id="best-practices-94"><a class="header" href="#best-practices-94">Best Practices</a></h2>
<ol>
<li>Always compile with debug symbols: <code>gcc -g</code></li>
<li>Keep matching binaries for core analysis</li>
<li>Configure appropriate core dump location</li>
<li>Set reasonable ulimit to prevent disk filling</li>
<li>Use systemd-coredump for centralized management</li>
<li>Strip production binaries but keep debug symbols separate</li>
</ol>
<p>Core dumps are invaluable for debugging crashes in production systems.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="linux-kernel-debugging"><a class="header" href="#linux-kernel-debugging">Linux Kernel Debugging</a></h1>
<p>Debugging the Linux kernel requires specialized tools and techniques due to its low-level nature.</p>
<h2 id="kernel-log-dmesg"><a class="header" href="#kernel-log-dmesg">Kernel Log (dmesg)</a></h2>
<pre><code class="language-bash"># View kernel messages
dmesg

# Follow kernel log
dmesg -w
dmesg --follow

# Filter by level
dmesg -l err,warn

# Human-readable timestamps
dmesg -T

# Clear ring buffer
sudo dmesg -C
</code></pre>
<h2 id="kernel-parameters"><a class="header" href="#kernel-parameters">Kernel Parameters</a></h2>
<pre><code class="language-bash"># View boot parameters
cat /proc/cmdline

# Add debug parameters (GRUB)
# Edit /etc/default/grub
GRUB_CMDLINE_LINUX="... debug ignore_loglevel"

# Update GRUB
sudo update-grub
</code></pre>
<h2 id="printk-debugging"><a class="header" href="#printk-debugging">printk Debugging</a></h2>
<pre><code class="language-c">// In kernel code
#include &lt;linux/printk.h&gt;

printk(KERN_INFO "Debug: value = %d\n", value);
printk(KERN_ERR "Error occurred\n");

// Log levels
KERN_EMERG, KERN_ALERT, KERN_CRIT, KERN_ERR,
KERN_WARNING, KERN_NOTICE, KERN_INFO, KERN_DEBUG
</code></pre>
<h2 id="kgdb-kernel-debugger"><a class="header" href="#kgdb-kernel-debugger">KGDB (Kernel Debugger)</a></h2>
<pre><code class="language-bash"># Kernel configuration
CONFIG_KGDB=y
CONFIG_KGDB_SERIAL_CONSOLE=y

# Boot with kgdb
kgdboc=ttyS0,115200 kgdbwait

# Connect with GDB
gdb ./vmlinux
(gdb) target remote /dev/ttyS0
(gdb) continue
</code></pre>
<h2 id="kernel-oops-analysis"><a class="header" href="#kernel-oops-analysis">Kernel Oops Analysis</a></h2>
<pre><code class="language-bash"># When kernel oops occurs, check dmesg
dmesg | tail -100

# Decode with scripts
./scripts/decode_stacktrace.sh vmlinux &lt; oops.txt

# addr2line for addresses
addr2line -e vmlinux -f -i 0xffffffffc0123456
</code></pre>
<h2 id="systemtap-1"><a class="header" href="#systemtap-1">SystemTap</a></h2>
<pre><code class="language-bash"># Install
sudo apt install systemtap

# Simple script
stap -e 'probe kernel.function("sys_open") { println("open called") }'

# Trace system calls
stap -e 'probe syscall.* { printf("%s\n", name) }'
</code></pre>
<h2 id="ftrace"><a class="header" href="#ftrace">ftrace</a></h2>
<pre><code class="language-bash"># Enable function tracing
cd /sys/kernel/debug/tracing
echo function &gt; current_tracer
echo 1 &gt; tracing_on
cat trace

# Trace specific function
echo sys_open &gt; set_ftrace_filter
echo function &gt; current_tracer

# Disable
echo 0 &gt; tracing_on
</code></pre>
<h2 id="kernel-crash-dumps-kdump"><a class="header" href="#kernel-crash-dumps-kdump">Kernel Crash Dumps (kdump)</a></h2>
<pre><code class="language-bash"># Install kdump
sudo apt install kdump-tools

# Configure /etc/default/kdump-tools
USE_KDUMP=1

# Test
echo c | sudo tee /proc/sysrq-trigger

# Analyze with crash
crash /usr/lib/debug/boot/vmlinux-$(uname -r) /var/crash/*/dump.* 
</code></pre>
<p>Kernel debugging requires patience and specialized knowledge, but these tools make it manageable.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="real-time-operating-systems-rtos"><a class="header" href="#real-time-operating-systems-rtos">Real-Time Operating Systems (RTOS)</a></h1>
<p>This directory contains guides for real-time operating systems used in embedded development.</p>
<h2 id="contents-2"><a class="header" href="#contents-2">Contents</a></h2>
<ul>
<li><strong><a href="rtos/freertos.html">FreeRTOS</a></strong> - Popular open-source RTOS</li>
<li><strong><a href="rtos/threadx.html">ThreadX</a></strong> - Commercial RTOS (now open-source)</li>
</ul>
<h2 id="rtos-concepts"><a class="header" href="#rtos-concepts">RTOS Concepts</a></h2>
<p><strong>Real-Time</strong>: Guarantees task execution within specified time constraints</p>
<p><strong>Deterministic</strong>: Predictable behavior and timing</p>
<p><strong>Scheduling</strong>: Priority-based task execution</p>
<p><strong>Inter-Task Communication</strong>:</p>
<ul>
<li>Queues: Message passing</li>
<li>Semaphores: Synchronization</li>
<li>Mutexes: Mutual exclusion</li>
<li>Event flags: Thread synchronization</li>
</ul>
<h2 id="comparison-4"><a class="header" href="#comparison-4">Comparison</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Feature</th><th>FreeRTOS</th><th>ThreadX</th></tr></thead><tbody>
<tr><td>License</td><td>MIT</td><td>MIT (since 2019)</td></tr>
<tr><td>Footprint</td><td>Very small</td><td>Small</td></tr>
<tr><td>Scheduling</td><td>Preemptive</td><td>Preemptive</td></tr>
<tr><td>Priority levels</td><td>Configurable</td><td>32 levels</td></tr>
<tr><td>Use cases</td><td>IoT, embedded</td><td>Industrial, IoT</td></tr>
</tbody></table>
</div>
<p>RTOS systems provide deterministic task scheduling essential for time-critical embedded applications.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="freertos"><a class="header" href="#freertos">FreeRTOS</a></h1>
<p>FreeRTOS is a real-time operating system kernel for embedded devices. It's designed to be small, simple, and easy to use.</p>
<h2 id="core-concepts-9"><a class="header" href="#core-concepts-9">Core Concepts</a></h2>
<p><strong>Tasks</strong>: Independent threads of execution
<strong>Queues</strong>: Inter-task communication
<strong>Semaphores</strong>: Synchronization
<strong>Mutexes</strong>: Mutual exclusion
<strong>Timers</strong>: Software timers
<strong>Event Groups</strong>: Synchronization</p>
<h2 id="task-creation"><a class="header" href="#task-creation">Task Creation</a></h2>
<pre><code class="language-c">#include "FreeRTOS.h"
#include "task.h"

void vTaskFunction(void *pvParameters) {
    for(;;) {
        // Task code
        vTaskDelay(pdMS_TO_TICKS(1000));  // Delay 1 second
    }
}

void main(void) {
    xTaskCreate(
        vTaskFunction,      // Function
        "TaskName",         // Name
        128,                // Stack size
        NULL,               // Parameters
        1,                  // Priority
        NULL                // Task handle
    );

    vTaskStartScheduler();  // Start scheduler

    for(;;);  // Should never reach here
}
</code></pre>
<h2 id="queues-1"><a class="header" href="#queues-1">Queues</a></h2>
<pre><code class="language-c">#include "queue.h"

QueueHandle_t xQueue;

void vSenderTask(void *pvParameters) {
    int value = 42;
    xQueue = xQueueCreate(10, sizeof(int));

    for(;;) {
        xQueueSend(xQueue, &amp;value, portMAX_DELAY);
        vTaskDelay(pdMS_TO_TICKS(1000));
    }
}

void vReceiverTask(void *pvParameters) {
    int received;

    for(;;) {
        if(xQueueReceive(xQueue, &amp;received, portMAX_DELAY)) {
            printf("Received: %d\n", received);
        }
    }
}
</code></pre>
<h2 id="semaphores"><a class="header" href="#semaphores">Semaphores</a></h2>
<pre><code class="language-c">#include "semphr.h"

SemaphoreHandle_t xSemaphore;

void vTask1(void *pvParameters) {
    for(;;) {
        if(xSemaphoreTake(xSemaphore, portMAX_DELAY)) {
            // Critical section
            xSemaphoreGive(xSemaphore);
        }
    }
}
</code></pre>
<h2 id="priority-levels"><a class="header" href="#priority-levels">Priority Levels</a></h2>
<ul>
<li>Higher number = higher priority</li>
<li>Idle task = priority 0</li>
<li>Typical range: 0-31</li>
<li>Preemptive scheduling (default)</li>
</ul>
<p>FreeRTOS provides essential RTOS functionality in a small footprint, ideal for resource-constrained embedded systems.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="threadx"><a class="header" href="#threadx">ThreadX</a></h1>
<p>ThreadX is a real-time operating system (RTOS) designed for deeply embedded applications. It's known for its small footprint and fast execution.</p>
<h2 id="core-concepts-10"><a class="header" href="#core-concepts-10">Core Concepts</a></h2>
<p><strong>Threads</strong>: Execution contexts
<strong>Message Queues</strong>: Inter-thread communication<br />
<strong>Semaphores</strong>: Synchronization
<strong>Mutexes</strong>: Resource protection
<strong>Event Flags</strong>: Thread synchronization
<strong>Memory Pools</strong>: Dynamic memory management</p>
<h2 id="thread-creation"><a class="header" href="#thread-creation">Thread Creation</a></h2>
<pre><code class="language-c">#include "tx_api.h"

TX_THREAD my_thread;
UCHAR thread_stack[1024];

void my_thread_entry(ULONG thread_input) {
    while(1) {
        // Thread logic
        tx_thread_sleep(100);  // Sleep 100 ticks
    }
}

void tx_application_define(void *first_unused_memory) {
    tx_thread_create(
        &amp;my_thread,              // Thread control block
        "My Thread",             // Name
        my_thread_entry,         // Entry function
        0,                       // Input
        thread_stack,            // Stack start
        sizeof(thread_stack),    // Stack size
        16,                      // Priority (0-31)
        16,                      // Preemption threshold
        TX_NO_TIME_SLICE,        // Time slice
        TX_AUTO_START            // Auto start
    );
}
</code></pre>
<h2 id="message-queues"><a class="header" href="#message-queues">Message Queues</a></h2>
<pre><code class="language-c">TX_QUEUE my_queue;
UCHAR queue_area[100 * sizeof(ULONG)];

// Create queue
tx_queue_create(
    &amp;my_queue,
    "My Queue",
    TX_1_ULONG,              // Message size
    queue_area,
    sizeof(queue_area)
);

// Send message
ULONG message = 0x12345678;
tx_queue_send(&amp;my_queue, &amp;message, TX_WAIT_FOREVER);

// Receive message
ULONG received;
tx_queue_receive(&amp;my_queue, &amp;received, TX_WAIT_FOREVER);
</code></pre>
<h2 id="semaphores-1"><a class="header" href="#semaphores-1">Semaphores</a></h2>
<pre><code class="language-c">TX_SEMAPHORE my_semaphore;

// Create counting semaphore
tx_semaphore_create(&amp;my_semaphore, "My Semaphore", 1);

// Get semaphore
tx_semaphore_get(&amp;my_semaphore, TX_WAIT_FOREVER);

// Put semaphore
tx_semaphore_put(&amp;my_semaphore);
</code></pre>
<h2 id="mutex"><a class="header" href="#mutex">Mutex</a></h2>
<pre><code class="language-c">TX_MUTEX my_mutex;

// Create mutex
tx_mutex_create(&amp;my_mutex, "My Mutex", TX_NO_INHERIT);

// Get mutex
tx_mutex_get(&amp;my_mutex, TX_WAIT_FOREVER);

// Release mutex
tx_mutex_put(&amp;my_mutex);
</code></pre>
<p>ThreadX is widely used in embedded systems, particularly in IoT and industrial applications, offering deterministic real-time performance.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            MathJax.Hub.Register.StartupHook('End', function() {
                window.setTimeout(window.print, 100);
            });
        });
        </script>


    </div>
    </body>
</html>
